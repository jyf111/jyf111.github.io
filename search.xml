<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>è™šå‡½æ•°æ·±å…¥</title>
      <link href="/2024/03/09/%E8%99%9A%E5%87%BD%E6%95%B0%E6%B7%B1%E5%85%A5/"/>
      <url>/2024/03/09/%E8%99%9A%E5%87%BD%E6%95%B0%E6%B7%B1%E5%85%A5/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>C++æœªå®šä¹‰è¡Œä¸ºç½—åˆ—</title>
      <link href="/2024/03/09/C-%E6%9C%AA%E5%AE%9A%E4%B9%89%E8%A1%8C%E4%B8%BA%E7%BD%97%E5%88%97/"/>
      <url>/2024/03/09/C-%E6%9C%AA%E5%AE%9A%E4%B9%89%E8%A1%8C%E4%B8%BA%E7%BD%97%E5%88%97/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡å·ä¸æ§½</title>
      <link href="/2024/03/09/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E6%A7%BD/"/>
      <url>/2024/03/09/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E6%A7%BD/</url>
      
        <content type="html"><![CDATA[<p>è§‚å¯Ÿè€…æ¨¡å¼ã€‚å½“æŸä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå°±ä¼šäº§ç”Ÿï¼ˆemitï¼‰ä¸€ä¸ªä¿¡å·ï¼ˆsignalï¼‰ï¼Œå¯¹è¯¥ä¿¡å·æ„Ÿå…´è¶£çš„å¯¹è±¡å¯ä»¥å°†è‡ªå·±çš„ä¸€ä¸ªå‡½æ•°ï¼ˆæ§½ï¼Œslotï¼‰ä¸è¯¥ä¿¡å·è¿æ¥ã€‚åˆ™æ¯å½“è¯¥ä¿¡å·å‘å‡ºæ—¶ï¼Œè¢«è¿æ¥çš„æ§½å‡½æ•°å°±ä¼šè‡ªåŠ¨è¢«å›è°ƒã€‚</p><p>ä¿¡å·ä¸æ§½å¯ä»¥è®©ä¸¤ä¸ªä¸ç›¸å…³çš„å¯¹è±¡å»ºç«‹è”ç³»ï¼Œå®ç°å¯¹è±¡é—´çš„é€šä¿¡ã€‚</p><p>ä¿¡å·å’Œæ§½æœºåˆ¶æ˜¯QTä¸­ç”¨äºä»£æ›¿å›è°ƒçš„ä¸€ç§æŠ€æœ¯ï¼Œå®ƒæ˜¯ç±»å‹å®‰å…¨çš„ï¼šä¸€ä¸ªä¿¡å·çš„å‡½æ•°ç­¾åå¿…é¡»ä¸æ¥æ”¶å®ƒçš„æ§½å‡½æ•°çš„ç­¾åç›¸åŒ¹é…ï¼ˆå‚æ•°ç±»å‹ä¸€è‡´ï¼Œä¸è¿‡å…è®¸æ§½å¿½ç•¥ä¸€äº›ä¿¡å·ä¸­çš„å‚æ•°ï¼‰ï¼›å®ƒæ˜¯æ¾è€¦åˆçš„ï¼Œæ›´åŠ çµæ´»ï¼Œä¿¡å·ä¸éœ€è¦å…³æ³¨å“ªäº›æ§½ä¼šä¸å…¶è¿æ¥ã€‚ä¸è¿‡å®ƒçš„æ€§èƒ½ç›¸æ¯”ç›´æ¥å›è°ƒæ›´å·®ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QObject::<span class="built_in">connect</span>(&amp;button, &amp;QPushButton::clicked,</span><br><span class="line">       &amp;app, &amp;QApplication::quit);</span><br><span class="line"><span class="comment">// connect(sender, signal, receiver, slot);</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªä¿¡å·å¯ä»¥è¿æ¥å¤šä¸ªæ§½å‡½æ•°ï¼Œä½†ä¿¡å·å‘ç”Ÿæ—¶ï¼Œè¿™äº›æ§½å‡½æ•°çš„æ‰§è¡Œé¡ºåºæ˜¯éšæœºä¸å¯æ§çš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŠ¶æ€æœºä¸è¡Œä¸ºæ ‘</title>
      <link href="/2024/03/09/%E7%8A%B6%E6%80%81%E6%9C%BA%E4%B8%8E%E8%A1%8C%E4%B8%BA%E6%A0%91/"/>
      <url>/2024/03/09/%E7%8A%B6%E6%80%81%E6%9C%BA%E4%B8%8E%E8%A1%8C%E4%B8%BA%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h2 id="çŠ¶æ€æœº"><a class="header-anchor" href="#çŠ¶æ€æœº">Â¶</a>çŠ¶æ€æœº</h2><ul><li>çŠ¶æ€ã€äº‹ä»¶ã€è½¬æ¢ã€è¡Œä¸º</li><li>æ‰©å±•çŠ¶æ€ï¼ˆå…è®¸é¢å¤–çš„å˜é‡ï¼‰ã€å±‚çº§çŠ¶æ€ã€å®ˆå«æ¡ä»¶</li><li>äº‹ä»¶è§¦å‘ã€å‘¨æœŸæ¡ä»¶è§¦å‘</li></ul><p>çŠ¶æ€æœºå¯ä»¥å°†é—®é¢˜åˆ†è§£ä¸ºè‹¥å¹²ä¸ªçŠ¶æ€ï¼Œåªéœ€è¦è€ƒè™‘å¤„äºæŸä¸ªçŠ¶æ€æ—¶çš„äº‹ä»¶ã€è½¬æ¢ä»¥åŠè¡Œä¸ºå³å¯ï¼Œæ›´å®¹æ˜“æ€è€ƒã€‚</p><h2 id="è¡Œä¸ºæ ‘"><a class="header-anchor" href="#è¡Œä¸ºæ ‘">Â¶</a>è¡Œä¸ºæ ‘</h2><p>Behavior Trees (BTs)</p><p>è¡Œä¸ºæ ‘æ˜¯ä¸€æ£µåŒ…å«æ§åˆ¶èŠ‚ç‚¹ï¼ˆéå¶èŠ‚ç‚¹ï¼‰å’Œè¡Œä¸ºèŠ‚ç‚¹ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰çš„æ ‘ï¼ˆç±»ä¼¼å†³ç­–æ ‘ï¼Œé€šè¿‡æ§åˆ¶èŠ‚ç‚¹é€‰æ‹©æ‰§è¡Œå“ªä¸ªå¶å­èŠ‚ç‚¹ï¼‰ã€‚</p><p>æ¯ä¸€æ¬¡æ›´æ–°ç§°ä¸ºä¸€æ¬¡tickï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ä¼ æ’­ã€‚æ”¶åˆ°tickçš„èŠ‚ç‚¹ä¼šè¿è¡Œå¹¶è¿”å›æˆåŠŸã€å¤±è´¥ã€è¿è¡Œä¸­çš„çŠ¶æ€ä¿¡æ¯ç»™çˆ¶èŠ‚ç‚¹ã€‚</p><ul><li>æ‰§è¡ŒèŠ‚ç‚¹åŒ…æ‹¬åŠ¨ä½œèŠ‚ç‚¹ï¼ˆå¯ä»¥æ‰§è¡Œå¤æ‚çš„åŠ¨ä½œï¼‰å’Œæ¡ä»¶èŠ‚ç‚¹ï¼ˆä»…ä»…åªæ˜¯æ£€æŸ¥æ¡ä»¶ç„¶åè¿”å›æˆåŠŸæˆ–å¤±è´¥çš„çŠ¶æ€ï¼‰ã€‚æ‰§è¡ŒèŠ‚ç‚¹æ˜¯è¿æ¥è¡Œä¸ºæ ‘å’Œå…·ä½“åº”ç”¨ä»£ç çš„åœ°æ–¹ã€‚</li><li>æ§åˆ¶èŠ‚ç‚¹ï¼Œå®šä¹‰äº†è‡ªé¡¶å‘ä¸‹éå†çš„æ–¹å¼ï¼Œé€šè¿‡æ¥å—å­èŠ‚ç‚¹çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶åº”ç”¨è‡ªå·±çš„è§„åˆ™æ¥å†³å®šæ¥ä¸‹å»çš„éå†æ–¹å¼ï¼Œå…·ä½“åŒ…æ‹¬é¡ºåºï¼ˆæŒ‰åºæ‰§è¡Œå„ä¸ªå­èŠ‚ç‚¹ï¼Œç›´åˆ°å…¨éƒ¨æˆåŠŸæˆ–ä¸€ä¸ªå¤±è´¥ï¼‰ã€å¤‡é€‰ï¼ˆæŒ‰åºæ‰§è¡Œå„ä¸ªå­èŠ‚ç‚¹ï¼Œç›´åˆ°ä¸€ä¸ªæˆåŠŸæˆ–å…¨éƒ¨å¤±è´¥ï¼‰ã€å¹¶è¡Œï¼ˆåŒæ—¶æ‰§è¡Œå„ä¸ªå­èŠ‚ç‚¹ï¼Œç›´åˆ°Mä¸ªæˆåŠŸæˆ–å…¨éƒ¨å¤±è´¥ï¼‰ã€è£…é¥°èŠ‚ç‚¹ï¼ˆä¿®æ”¹å”¯ä¸€çš„å­èŠ‚ç‚¹çš„è¡Œä¸ºï¼Œå¦‚åè½¬çŠ¶æ€ï¼‰ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span>* xml_text = <span class="string">R&quot;(</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> &lt;root BTCPP_format=&quot;4&quot; &gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     &lt;BehaviorTree ID=&quot;MainTree&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;Sequence name=&quot;root_sequence&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;CheckBattery   name=&quot;battery_ok&quot;/&gt;</span></span><br><span class="line"><span class="string">            &lt;OpenGripper    name=&quot;open_gripper&quot;/&gt;</span></span><br><span class="line"><span class="string">            &lt;ApproachObject name=&quot;approach_object&quot;/&gt;</span></span><br><span class="line"><span class="string">            &lt;CloseGripper   name=&quot;close_gripper&quot;/&gt;</span></span><br><span class="line"><span class="string">        &lt;/Sequence&gt;</span></span><br><span class="line"><span class="string">     &lt;/BehaviorTree&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> &lt;/root&gt;</span></span><br><span class="line"><span class="string"> )&quot;</span>;</span><br><span class="line"></span><br><span class="line">BehaviorTreeFactory factory;</span><br><span class="line">factory.<span class="built_in">registerNodeType</span>&lt;ApproachObject&gt;(<span class="string">&quot;ApproachObject&quot;</span>);</span><br><span class="line">factory.<span class="built_in">registerSimpleCondition</span>(<span class="string">&quot;CheckBattery&quot;</span>,</span><br><span class="line">                              [&amp;](TreeNode&amp;) &#123; <span class="keyword">return</span> <span class="built_in">CheckBattery</span>(); &#125;);</span><br><span class="line">GripperInterface gripper;</span><br><span class="line">factory.<span class="built_in">registerSimpleAction</span>(<span class="string">&quot;OpenGripper&quot;</span>, [&amp;](TreeNode&amp;) &#123; <span class="keyword">return</span> gripper.<span class="built_in">open</span>(); &#125;);</span><br><span class="line">factory.<span class="built_in">registerSimpleAction</span>(<span class="string">&quot;CloseGripper&quot;</span>,</span><br><span class="line">                           [&amp;](TreeNode&amp;) &#123; <span class="keyword">return</span> gripper.<span class="built_in">close</span>(); &#125;);</span><br><span class="line"><span class="keyword">auto</span> tree = factory.<span class="built_in">createTreeFromText</span>(xml_text);</span><br><span class="line"><span class="comment">// To &quot;execute&quot; a Tree you need to &quot;tick&quot; it.</span></span><br><span class="line"><span class="comment">// The tick is propagated to the children based on the logic of the tree.</span></span><br><span class="line"><span class="comment">// In this case, the entire sequence is executed, because all the children</span></span><br><span class="line"><span class="comment">// of the Sequence return SUCCESS.</span></span><br><span class="line">tree.<span class="built_in">tickWhileRunning</span>();</span><br></pre></td></tr></table></figure><h2 id="å¯¹æ¯”"><a class="header-anchor" href="#å¯¹æ¯”">Â¶</a>å¯¹æ¯”</h2><p>è¡Œä¸ºæ ‘å’ŒçŠ¶æ€æœºçš„è¡¨è¾¾èƒ½åŠ›æ˜¯ç›¸åŒçš„ï¼Œä½†è¡Œä¸ºæ ‘æ›´ä¾¿äºç»„åˆä¿®æ”¹ï¼Œåå‘æ¨¡å—åŒ–ï¼›è€ŒçŠ¶æ€æœºæ›´ä¾¿äºååº”å¼è®¾è®¡ï¼ˆif event then actionï¼‰ï¼Œåå‘ååº”å¼ã€‚</p><p><a data-fancybox="gallery" data-src="/post-images/bt-fsm.png" data-caption="bt-fsm"><img src="/post-images/bt-fsm.png" alt="bt-fsm"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…å­˜å¯¹é½</title>
      <link href="/2024/03/09/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/"/>
      <url>/2024/03/09/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/</url>
      
        <content type="html"><![CDATA[<h2 id="pragma"><a class="header-anchor" href="#pragma">Â¶</a>pragma</h2><p>æŒ‡ç¤ºç¼–è¯‘å™¨ä»¥ç‰¹å®šå¯¹é½æ–¹å¼å¯¹é½ç»“æ„ä½“æˆå‘˜ï¼Œå…¶ä¸­å¯¹é½å•ä½=min(n, ç»“æ„ä½“æˆå‘˜çš„æœ€å¤§å¤§å°)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> pack(n)</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">alignof</span>(A); <span class="comment">// æŸ¥çœ‹ç»“æ„ä½“çš„å¯¹é½å•ä½</span></span><br></pre></td></tr></table></figure><h2 id="attribute"><a class="header-anchor" href="#attribute">Â¶</a>attribute</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__attribute((packed)); <span class="comment">// è®¾ç½®ç´§å‡‘æ’å¸ƒï¼Œå³å¯¹é½å•ä½ä¸º1</span></span><br><span class="line">__attribute((<span class="built_in">aligned</span>(x))); <span class="comment">// è®¾ç½®ç»“æ„ä½“çš„èµ·å§‹åœ°å€ä»¥åŠæ•´ä½“å¤§å°å‡ä¸ºxçš„å€æ•°ï¼ˆä¿è¯ç»“æ„ä½“çš„æ•´ä½“å¤§å°æ˜¯xçš„å€æ•°å¯ä»¥åœ¨ä½¿ç”¨ç»“æ„ä½“æ•°ç»„æ—¶ä½¿å¾—æ¯ä¸ªç»“æ„ä½“éƒ½æ˜¯å¯¹é½çš„ï¼‰</span></span><br></pre></td></tr></table></figure><h2 id="alignas"><a class="header-anchor" href="#alignas">Â¶</a>alignas</h2><p>ä½œç”¨ç±»ä¼¼äº<code>__attribute((aligned(x)))</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alignas</span>(x);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>visibility attribute</title>
      <link href="/2024/03/07/visibility-attribute/"/>
      <url>/2024/03/07/visibility-attribute/</url>
      
        <content type="html"><![CDATA[<p>åœ¨GCCä¸­å¯ä»¥ä½¿ç”¨visibilityå±æ€§æ§åˆ¶ç¬¦å·æ˜¯å¦å¯¼å‡ºåˆ°åŠ¨æ€åº“ä¸­ã€‚</p><p>å¦‚æœå¤šä¸ªåŠ¨æ€åº“ä¸­åŒ…å«ç›¸åŒç¬¦å·ï¼ˆä¾‹å¦‚åŒä¸€ä¸ªåº“çš„ä¸åŒç‰ˆæœ¬ï¼‰ï¼Œåˆ™C++ä¼šæŒ‰ç…§é“¾æ¥é¡ºåºä¸­ç¬¬ä¸€ä¸ªåŒ…å«è¯¥ç¬¦å·çš„åŠ¨æ€åº“ä¸ºå‡†ã€‚å¦‚æœæä¾›çš„é“¾æ¥é¡ºåºä¸ç¬¦åˆé¢„æœŸï¼Œå°±ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚å½“ç„¶ï¼Œæƒ³è¦åŒæ—¶è°ƒç”¨å¤šä¸ªåŠ¨æ€åº“ä¸­ç›¸åŒç¬¦å·çš„å‡½æ•°è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚ï¼ˆå•ä¸€å®šä¹‰è§„åˆ™ï¼‰</p><p>ä½¿ç”¨<code>-fvisibility=hidden</code>ç¼–è¯‘é€‰é¡¹å¯ä»¥é»˜è®¤éšè—æ‰€æœ‰ç¬¦å·ï¼Œé™¤äº†æ˜¾ç¤ºé€šè¿‡defaultè¿›è¡Œæš´éœ²çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__attribute__((__visibility__(<span class="string">&quot;default&quot;</span>))) <span class="comment">// -fvisibility=hidden</span></span><br><span class="line">__attribute__((__visibility__(<span class="string">&quot;hidden&quot;</span>)))</span><br></pre></td></tr></table></figure><p>æ³¨ï¼švisibilityçš„å¯è§æ€§ä»¥ä¸€ä¸ªå…±äº«åº“ä¸ºå•ä½ï¼ˆused only within a shared libraryï¼‰ï¼Œè€Œstaticåˆ™ä»¥ä¸€ä¸ªç¼–è¯‘æ–‡ä»¶ä¸ºå•ä½ï¼ˆused only within a compile unitï¼‰ï¼Œä¹Ÿå°±æ˜¯staticä¼šæ›´åŠ ä¸¥æ ¼ã€‚hiddenç¬¦å·æ˜¯å¯¹åŒä¸€ä¸ªå…±äº«åº“ä¸­çš„å…¶å®ƒæ–‡ä»¶å¯è§çš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Morriséå†</title>
      <link href="/2024/03/04/Morris%E9%81%8D%E5%8E%86/"/>
      <url>/2024/03/04/Morris%E9%81%8D%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<p>éé€’å½’äºŒå‰æ ‘éå†ï¼Œæ—¶é—´å¤æ‚åº¦$O(n)$ï¼Œç©ºé—´å¤æ‚åº¦$O(1)$ã€‚</p><p>æ ¸å¿ƒæ˜¯åˆ©ç”¨æ ‘çš„å¶å­èŠ‚ç‚¹çš„å·¦å³å„¿å­ä¸ºç©ºæŒ‡é’ˆã€‚</p><ul><li>å½“å‰èŠ‚ç‚¹æ— å·¦å­æ ‘ï¼Œåˆ™ç§»åŠ¨åˆ°å³å­æ ‘</li><li>å½“å‰èŠ‚ç‚¹æœ‰å·¦å­æ ‘ï¼Œåˆ™æ‰¾åˆ°å·¦å­æ ‘ä¸­æœ€å³çš„èŠ‚ç‚¹ï¼ˆå› ä¸ºè¿™æ˜¯æœ€åéå†çš„ç‚¹ï¼‰<ul><li>å¦‚æœè¯¥æœ€å³èŠ‚ç‚¹çš„å³æŒ‡é’ˆä¸ºç©ºï¼Œè®©å…¶æŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œå¹¶è®©å½“å‰èŠ‚ç‚¹è¿›å…¥å·¦å­æ ‘</li><li>å¦‚æœè¯¥æœ€å³èŠ‚ç‚¹çš„å³æŒ‡é’ˆå·²ç»æŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼ˆè¯´æ˜è¯¥å·¦å­æ ‘å·²ç»éå†å®Œæˆï¼‰ï¼Œæ¸…ç©ºæœ€å³èŠ‚ç‚¹çš„å³æŒ‡é’ˆï¼Œå¹¶è®©å½“å‰èŠ‚ç‚¹è¿›å…¥å³å­æ ‘</li></ul></li></ul><p>å‰åºéå†ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">morrisPre</span><span class="params">(Node* head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Node* cur = head;</span><br><span class="line">    Node* mostRight = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        mostRight = cur.left;</span><br><span class="line">        <span class="keyword">if</span> (mostRight != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (mostRight.right != <span class="literal">NULL</span> &amp;&amp; mostRight.right != cur) &#123;</span><br><span class="line">                mostRight = mostRight.right;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (mostRight.right == <span class="literal">NULL</span>) &#123;</span><br><span class="line">                mostRight.right = cur;</span><br><span class="line">                cout &lt;&lt; cur.val &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">                cur = cur.left;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mostRight.right = <span class="literal">NULL</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; cur.val &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur.right;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢„ç¼–è¯‘å¤´æ–‡ä»¶PCH</title>
      <link href="/2024/02/19/%E9%A2%84%E7%BC%96%E8%AF%91%E5%A4%B4%E6%96%87%E4%BB%B6PCH/"/>
      <url>/2024/02/19/%E9%A2%84%E7%BC%96%E8%AF%91%E5%A4%B4%E6%96%87%E4%BB%B6PCH/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>justå‘½ä»¤è¿è¡Œå™¨</title>
      <link href="/2024/02/06/just%E5%91%BD%E4%BB%A4%E8%BF%90%E8%A1%8C%E5%99%A8/"/>
      <url>/2024/02/06/just%E5%91%BD%E4%BB%A4%E8%BF%90%E8%A1%8C%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>æ¯”Makefileæ›´äººæ€§åŒ–ï¼Œä¸“æ³¨äºè¿è¡Œä¸€ç»„å‘½ä»¤ï¼ˆç§°ä¸ºé…æ–¹ï¼Œrecipeï¼‰ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ„å»ºï¼ˆå…·ä½“åœ°ï¼ŒMakeä¸“æ³¨äº<br>è¿›è¡Œå¢é‡å¼æ„å»ºï¼Œå¦‚æœå‘ç°ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å·²ç»æ˜¯æœ€æ–°çš„ï¼Œå°±ä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œäº†ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªå‘½ä»¤è¿è¡Œå™¨<br>åº”è¯¥åšçš„ï¼‰ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo install just</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>åªéœ€åˆ›å»ºä¸€ä¸ªåä¸º<code>justfile</code>çš„æ–‡ä»¶ã€‚</p><p>åœ¨è°ƒç”¨<code>just</code>æ—¶ï¼Œå®ƒä¼šåœ¨å½“å‰ç›®å½•å’Œçˆ¶ç›®å½•ä¸­å¯»æ‰¾<code>justfile</code>ã€‚</p><p>å½“æœ‰ä¸€æ¡å‘½ä»¤è¿è¡Œå¤±è´¥ï¼Œé…æ–¹å°±ä¼šåœæ­¢è¿è¡Œã€‚</p><p>åœ¨è°ƒç”¨<code>just</code>ä½†æ²¡æœ‰ä¼ å…¥ä»»ä½•é…æ–¹æ—¶ï¼Œä¼šè¿è¡Œç¬¬ä¸€ä¸ªé…æ–¹ï¼Œå³é»˜è®¤é…æ–¹ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªé…æ–¹é€šå¸¸é€‰æ‹©é¡¹ç›®ä¸­<br>æœ€å¸¸è¿è¡Œçš„å‘½ä»¤ã€‚</p><p>ç´§æ¥ç€é…æ–¹å‰é¢çš„æ³¨é‡Šå°†å‡ºç°åœ¨<code>ust --list</code>ä¸­ã€‚</p><ul><li><code>just --list</code></li><li><code>just --summary</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> b := build</span><br><span class="line"></span><br><span class="line">host := `<span class="built_in">uname</span> -a`</span><br><span class="line"></span><br><span class="line"><span class="comment"># build main</span></span><br><span class="line">build:</span><br><span class="line">    cc *.c -o main</span><br><span class="line"></span><br><span class="line"><span class="comment"># test everything</span></span><br><span class="line">test-all: build</span><br><span class="line">    ./test --all</span><br><span class="line"></span><br><span class="line"><span class="comment"># run a specific test</span></span><br><span class="line"><span class="built_in">test</span> TEST: build</span><br><span class="line">    ./test --<span class="built_in">test</span> &#123;&#123;TEST&#125;&#125;</span><br></pre></td></tr></table></figure><p>ä»¥<code>#!</code>å¼€å¤´çš„é…æ–¹è¢«ç§°ä¸º<code>Shebang</code>é…æ–¹ï¼Œå®ƒé€šè¿‡å°†é…æ–¹ä¸»ä½“ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¹¶è¿è¡Œå®ƒæ¥æ‰§è¡Œã€‚<br>è¿™è®©ä½ å¯ä»¥ç”¨ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™é…æ–¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">python:</span><br><span class="line">  <span class="comment">#!/usr/bin/env python3</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Hello from python!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sh:</span><br><span class="line">  <span class="comment">#!/usr/bin/env sh</span></span><br><span class="line">  hello=<span class="string">&#x27;Yo&#x27;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$hello</span> from a shell script!&quot;</span></span><br><span class="line"></span><br><span class="line">foo:</span><br><span class="line">  <span class="comment">#!/usr/bin/env bash</span></span><br><span class="line">  <span class="built_in">set</span> -euxo pipefail</span><br><span class="line">  hello=<span class="string">&#x27;Yo&#x27;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$hello</span> from Bash!&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨bashä¸­ï¼Œ<code>set -e</code>ä½¿bashåœ¨å‘½ä»¤å¤±è´¥æ—¶é€€å‡ºï¼Œ<code>set -u</code>ä½¿bashåœ¨å˜é‡æœªå®šä¹‰æ—¶é€€å‡ºï¼Œ<br><code>set -x</code>ä½¿bashåœ¨è¿è¡Œå‰æ‰“å°æ¯ä¸€è¡Œè„šæœ¬ï¼Œ<code>set -o pipefail</code>ä½¿bashåœ¨ç®¡é“ä¸­çš„ä¸€ä¸ªå‘½ä»¤å¤±è´¥æ—¶é€€å‡ºã€‚</p><blockquote><p>æˆ‘ä¸ªäººè®¤ä¸ºä¸ºå‡ ä¹æ¯ä¸ªé¡¹ç›®å†™ä¸€ä¸ª<code>justfile</code>éå¸¸æœ‰ç”¨ï¼Œæ— è®ºå¤§å°ã€‚</p><p>åœ¨ä¸€ä¸ªæœ‰å¤šä¸ªè´¡çŒ®è€…çš„å¤§é¡¹ç›®ä¸­ï¼Œæœ‰ä¸€ä¸ªåŒ…å«é¡¹ç›®å·¥ä½œæ‰€éœ€çš„æ‰€æœ‰å‘½ä»¤çš„æ–‡ä»¶æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œè¿™æ ·æ‰€æœ‰å‘½ä»¤å”¾æ‰‹å¯å¾—ã€‚</p><p>å¯èƒ½æœ‰ä¸åŒçš„å‘½ä»¤æ¥æµ‹è¯•ã€æ„å»ºã€æ£€æŸ¥ã€éƒ¨ç½²ç­‰ç­‰ï¼ŒæŠŠå®ƒä»¬éƒ½æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œå¯ä»¥å‡å°‘ä½ èŠ±åœ¨å‘Šè¯‰äººä»¬è¦è¿è¡Œå“ªäº›å‘½ä»¤å’Œå¦‚ä½•è¾“å…¥è¿™äº›å‘½ä»¤çš„æ—¶é—´ã€‚</p><p>è€Œä¸”ï¼Œæœ‰äº†ä¸€ä¸ªå®¹æ˜“æ”¾ç½®å‘½ä»¤çš„åœ°æ–¹ï¼Œä½ å¾ˆå¯èƒ½ä¼šæƒ³å‡ºå…¶ä»–æœ‰ç”¨çš„ä¸œè¥¿ï¼Œè¿™äº›ä¸œè¥¿æ˜¯é¡¹ç›®é›†ä½“æ™ºæ…§çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ²¡æœ‰å†™åœ¨ä»»ä½•åœ°æ–¹ï¼Œæ¯”å¦‚ä¿®è®¢æ§åˆ¶å·¥ä½œæµç¨‹çš„æŸäº›éƒ¨åˆ†éœ€è¦çš„ç¥ç§˜å‘½ä»¤ï¼Œå®‰è£…ä½ é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–ï¼Œæˆ–è€…æ‰€æœ‰ä½ å¯èƒ½éœ€è¦ä¼ é€’ç»™æ„å»ºç³»ç»Ÿçš„ä»»æ„æ ‡å¿—ç­‰ã€‚</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>follyåº“</title>
      <link href="/2024/02/05/folly%E5%BA%93/"/>
      <url>/2024/02/05/folly%E5%BA%93/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bazel</title>
      <link href="/2024/02/05/bazel/"/>
      <url>/2024/02/05/bazel/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>io_uring</title>
      <link href="/2024/01/28/io-uring/"/>
      <url>/2024/01/28/io-uring/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 365. æ°´å£¶é—®é¢˜</title>
      <link href="/2024/01/28/Leetcode-365-%E6%B0%B4%E5%A3%B6%E9%97%AE%E9%A2%98/"/>
      <url>/2024/01/28/Leetcode-365-%E6%B0%B4%E5%A3%B6%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h2><p>ä¸€ä¸ªæ°´æ¯å®¹é‡ä¸º$x$ï¼Œå¦ä¸€ä¸ªæ°´æ¯å®¹é‡ä¸º$y$ï¼Œæ¯æ¬¡åªèƒ½è£…æ»¡æˆ–è€…æ¸…ç©ºï¼Œ<br>é—®èƒ½å¦å‡‘å‡º$z$å‡æ°´ï¼ˆä¸€ä¸ªæ°´æ¯ä¸º$z$ï¼Œæˆ–ä¸¤ä¸ªæ°´æ¯åŠ èµ·æ¥ä¸º$z$ï¼‰ã€‚</p><h2 id="åšæ³•"><a href="#åšæ³•" class="headerlink" title="åšæ³•"></a>åšæ³•</h2><p>è¿™è¾¹æœ‰ä¸€ä¸ªéå¸¸å…³é”®çš„è§‚å¯Ÿç‚¹æ˜¯ï¼š</p><ul><li>æ°´é‡çš„å˜åŒ–åªå¯èƒ½æ˜¯$+x, -x, +y, -y$ã€‚</li></ul><p>è€ƒè™‘ä¸€ä¸ªæ°´æ¯å¤„äºåŠæ»¡çŠ¶æ€ï¼Œæ­¤æ—¶ä¸ç®¡æ˜¯è£…æ»¡è¿˜æ˜¯æ¸…ç©ºéƒ½æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚</p><p>æ‰€ä»¥é¢˜ç›®å°±å˜æˆäº†$ax + by = z$ï¼Œæ‰¾å‡º$a$å’Œ$b$ï¼Œæ³¨æ„$z$æ˜¾ç„¶è¦$\le x + y$ã€‚<br>æ˜¾ç„¶æ ¹æ®<strong>è£´èœ€</strong>å®šç†ï¼Œåªéœ€è¦$z \% gcd(x, y) == 0$å³å¯ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">gcd</span>(x: <span class="type">i32</span>, y : <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">i32</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> y == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">gcd</span>(y, x % y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">can_measure_water</span>(jug1_capacity: <span class="type">i32</span>, jug2_capacity: <span class="type">i32</span>, target_capacity: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">bool</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> target_capacity &gt; jug1_capacity + jug2_capacity &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        target_capacity % <span class="title function_ invoke__">gcd</span>(jug1_capacity, jug2_capacity) == <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äº$z\le x + y$ï¼Œç›´æ¥è®°å¿†åŒ–æœç´¢ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜²æŠ–ä¸èŠ‚æµ</title>
      <link href="/2024/01/24/%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/"/>
      <url>/2024/01/24/%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<p>ç”¨äºä¼˜åŒ–é«˜é¢‘ç‡æ‰§è¡Œä»£ç ã€‚<br>æ¯”å¦‚åœ¨æµè§ˆå™¨ä¸­<code>scroll</code>ç­‰äº‹ä»¶ä¼šé¢‘ç¹è§¦å‘ï¼Œå¯¼è‡´ä¸æ–­åœ°è°ƒç”¨è¯¥æ—¶é—´ä¸Šçš„å›è°ƒå‡½æ•°ï¼Œ<br>é™ä½å‰ç«¯çš„æ€§èƒ½ã€‚</p><h2 id="Debounce"><a href="#Debounce" class="headerlink" title="Debounce"></a>Debounce</h2><p>ä»…åœ¨ä¸€ä¸ªæ—¶é—´å‘¨æœŸç»“æŸæ—¶æ‰æ‰§è¡Œï¼Œå¦‚æœé‡å¤è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">func, wait</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="variable language_">this</span>; <span class="comment">// ä¿å­˜thisæŒ‡å‘</span></span><br><span class="line">        <span class="keyword">let</span> args = <span class="variable language_">arguments</span>; <span class="comment">// æ‹¿åˆ°eventå¯¹è±¡</span></span><br><span class="line"> </span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout)</span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            func.<span class="title function_">apply</span>(context, args)</span><br><span class="line">        &#125;, wait);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>çª—å£å¤§å°<code>resize</code>ï¼Œåªéœ€åœ¨è°ƒæ•´å®Œæ¯•åï¼Œè®¡ç®—ä¸€æ¬¡æœ€ç»ˆçš„çª—å£å¤§å°ï¼Œæ‰§è¡Œæ¸²æŸ“å³å¯ã€‚</li><li>ç½‘ç«™æäº¤è®¢å•ï¼Œç”¨æˆ·åŒå‡»æŒ‰é’®ï¼Œé˜²æŠ–å¯ä»¥ç¡®ä¿åªæäº¤ä¸€æ¬¡è®¢å•ã€‚</li></ul><p>æ­¤å¤–é˜²æŠ–ä¹Ÿæ˜¯ä¸€ç§ä¿éšœæ•°æ®ç¨³å®šçš„æ‰‹æ®µï¼Œå¯ä»¥è¿‡æ»¤æ‰æ— æ•ˆæˆ–ä¸ç¨³å®šçš„æ•°æ®ï¼Œä»è€Œé™ä½æ•°æ®è¯¯æŠ¥çš„å½±å“ã€‚</p><p>åœ¨ç¡¬ä»¶å¼€å…³ä¸­ï¼Œä¿¡å·å¯èƒ½å‘ç”Ÿè·³å˜ï¼Œå› æ­¤é€šå¸¸éœ€è¦å¯¹ä¿¡å·çš„å€¼è¿›ä¸€æ­¥åšä¸€ä¸ªç‰¹æ®Šçš„å¤„ç†ï¼Œæ¯”å¦‚</p><ul><li>åªæœ‰åœ¨è¿ç»­ä¸€æ®µæ—¶é—´å†…éƒ½æ˜¯1ï¼ˆä»ä¸Šå‡æ²¿ï¼Œå³0å˜1å¼€å§‹è®¡æ—¶ï¼‰ï¼Œæ‰ä¸º1ï¼Œé™ä½æŠ–åŠ¨çš„å½±å“</li><li>æ¯æ¬¡å˜æˆ1ï¼Œå°±ä¿æŒä¸€æ®µæ—¶é—´ï¼Œä¸€ç›´è¿”å›1ï¼Œç”¨äºå»¶é•¿æˆ–æˆªæ–­ä¿¡å·çš„å‘é€</li></ul><p><img src="/post-images/debounce.png" alt="switch-debound"></p><h2 id="Throttle"><a href="#Throttle" class="headerlink" title="Throttle"></a>Throttle</h2><p>åœ¨ä¸€ä¸ªæ—¶é—´å‘¨æœŸå†…ï¼Œä»…åœ¨ç¬¬ä¸€æ¬¡è§¦å‘æ—¶æ‰§è¡Œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throttled</span>(<span class="params">fn, delay = <span class="number">500</span></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> timer = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...args</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!timer) &#123;</span><br><span class="line">            timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args)</span><br><span class="line">                timer = <span class="literal">null</span></span><br><span class="line">            &#125;, delay);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>æ»šåŠ¨åŠ è½½ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œä¸€æ¬¡ã€‚</li></ul><h2 id="æ»¤æ³¢"><a href="#æ»¤æ³¢" class="headerlink" title="æ»¤æ³¢"></a>æ»¤æ³¢</h2><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è¿‡æ»¤æ‰ä¸€äº›ç‰¹å®šçš„æ³¢ï¼ˆå»æ‰ä¸æƒ³è¦çš„å™ªå£°ï¼Œä¿ç•™æƒ³è¦çš„ï¼‰ã€‚</p><p>å¡å°”æ›¼æ»¤æ³¢ï¼Œåˆå«äºŒæ¬¡å‹ä¼°è®¡ï¼Œèƒ½ä»å…ˆå‰ä¸€ç³»åˆ—åŒ…å«å™ªå£°çš„è§‚æµ‹é‡ä¸­ï¼Œæä¾›å¯¹ç³»ç»Ÿå½“å‰çŠ¶æ€çš„ç›¸å¯¹å‡†ç¡®ä¸”å¹³æ»‘çš„ä¼°è®¡ã€‚<br>ä¹‹æ‰€ä»¥ç§°ä¸ºæ»¤æ³¢ï¼Œå°±æ˜¯å› ä¸ºå®ƒä¼šè¿‡æ»¤æ‰ä¹‹å‰è§‚æµ‹é‡ä¸­çš„å™ªå£°å’Œä¸ç¡®å®šæ€§ã€‚</p><p>å‰é¢æåˆ°çš„é˜²æŠ–ä¹Ÿå¯ä»¥ç®—ä¸€ç§æ¶ˆæŠ–æ»¤æ³¢ï¼Œåœ¨åµŒå…¥å¼å¼€å‘ä¿¡å·å¤„ç†ä¸­ä¼šç”¨ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>xmake</title>
      <link href="/2024/01/21/xmake/"/>
      <url>/2024/01/21/xmake/</url>
      
        <content type="html"><![CDATA[<p>XMakeæ˜¯ä¸€ä¸ªåŸºäºLuaçš„ç°ä»£åŒ–C/C++æ„å»ºç³»ç»Ÿã€‚</p><p>XMake = Build backend + Project generator + Package manager ï¼ˆåŒ…ç®¡ç†å™¨æ˜¯ç›¸æ¯”äºCMakeæœ€å¤§çš„ä¼˜åŠ¿ï¼‰</p><h2 id="Install"><a class="header-anchor" href="#Install">Â¶</a>Install</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://xmake.io/shget.text | bash</span><br><span class="line">xmake --version</span><br><span class="line">xmake update</span><br><span class="line">xmake uninstall</span><br></pre></td></tr></table></figure><h2 id="Use"><a class="header-anchor" href="#Use">Â¶</a>Use</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xmake create hello</span><br><span class="line"><span class="built_in">cd</span> hello</span><br><span class="line">xmake [build]</span><br><span class="line">xmake run</span><br></pre></td></tr></table></figure><p>xmake.lua:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add_rules(<span class="string">&quot;mode.debug&quot;</span>, <span class="string">&quot;mode.release&quot;</span>)</span><br><span class="line">target(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line">    set_kind(<span class="string">&quot;binary&quot;</span>)</span><br><span class="line">    add_files(<span class="string">&quot;src/main.cpp&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="Commands"><a class="header-anchor" href="#Commands">Â¶</a>Commands</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">xmake create</span><br><span class="line">xmake config</span><br><span class="line">xmake build</span><br><span class="line">xmake install</span><br><span class="line">xmake run</span><br><span class="line">xmake clean</span><br><span class="line"></span><br><span class="line">xmake config -m debug <span class="comment"># debug mode</span></span><br><span class="line">xmake config --toolchain=clang</span><br><span class="line">xmake project -k compile_commands</span><br><span class="line">xmake project -k cmake</span><br><span class="line">xmake -v <span class="comment"># verbose output</span></span><br></pre></td></tr></table></figure><h2 id="Code"><a class="header-anchor" href="#Code">Â¶</a>Code</h2><p>å¸¸ç”¨é€‰é¡¹ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">add_cxxflags(<span class="string">&quot;-fno-strict-aliasing&quot;</span>, <span class="string">&quot;-fno-implicit-templates&quot;</span>)</span><br><span class="line">set_languages(<span class="string">&quot;c11&quot;</span>, <span class="string">&quot;cxx20&quot;</span>) <span class="comment">-- è®¾ç½®è®¡æ ‡å‡†</span></span><br><span class="line">add_includedirs(<span class="string">&quot;include&quot;</span>) <span class="comment">-- æ·»åŠ å¤´æ–‡ä»¶æœç´¢ç›®å½•</span></span><br><span class="line">add_linkdirs(<span class="string">&quot;ext/lib&quot;</span>) <span class="comment">-- æ·»åŠ åº“æœç´¢ç›®å½•</span></span><br><span class="line">add_links(<span class="string">&quot;myext&quot;</span>) <span class="comment">-- æ·»åŠ é“¾æ¥åº“</span></span><br><span class="line">add_defines(<span class="string">&quot;MYMACRO=hello&quot;</span>)</span><br><span class="line">set_warnings(<span class="string">&quot;all&quot;</span>)</span><br><span class="line">is_plat()</span><br><span class="line">is_arch()</span><br><span class="line">is_host()</span><br><span class="line">is_mode()</span><br></pre></td></tr></table></figure><p>main + é™æ€åº“ç¤ºä¾‹ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">add_rules(<span class="string">&quot;mode.debug&quot;</span>, <span class="string">&quot;mode.release&quot;</span>)</span><br><span class="line">set_languages(<span class="string">&quot;cxx20&quot;</span>)</span><br><span class="line">target(<span class="string">&quot;mylib&quot;</span>)</span><br><span class="line">    set_kind(<span class="string">&quot;static&quot;</span>)</span><br><span class="line">    add_includedirs(<span class="string">&quot;include&quot;</span>, &#123;public = <span class="literal">true</span>&#125;)</span><br><span class="line">    add_files(<span class="string">&quot;src/mylib.cpp&quot;</span>)</span><br><span class="line">target(<span class="string">&quot;myexe&quot;</span>)</span><br><span class="line">    set_kind(<span class="string">&quot;binary&quot;</span>)</span><br><span class="line">    add_files(<span class="string">&quot;src/myexe.cpp&quot;</span>)</span><br><span class="line">    add_deps(<span class="string">&quot;mylib&quot;</span>, &#123;inherit = <span class="literal">false</span>&#125;) <span class="comment">-- å¯ä»¥ç»§æ‰¿ç›®æ ‡ä¾èµ–çš„é…ç½®ä¿¡æ¯ï¼Œé»˜è®¤çš„privateä¸ä¼šè¢«ç»§æ‰¿ï¼Œpublicä¼šè¢«ç»§æ‰¿ï¼Œinterfaceåˆ™åªä½œç”¨äºç»§æ‰¿çš„å­targetï¼Œè€Œä¸ä½œç”¨ä¸å½“å‰target</span></span><br></pre></td></tr></table></figure><p>main + åŠ¨æ€åº“ç¤ºä¾‹ï¼šï¼ˆå’Œé™æ€åº“å‡ ä¹ä¸€æ ·ï¼Œåªéœ€è¦æ”¹ä¸‹libçš„kindå³å¯ï¼‰</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">target(<span class="string">&quot;foo&quot;</span>)</span><br><span class="line">    set_kind(<span class="string">&quot;shared&quot;</span>)</span><br><span class="line">    add_files(<span class="string">&quot;src/interface.cpp&quot;</span>)</span><br><span class="line">    add_defines(<span class="string">&quot;TEST&quot;</span>, &#123;public = <span class="literal">true</span>&#125;)</span><br><span class="line">    add_includedirs(<span class="string">&quot;src&quot;</span>, &#123;interface = <span class="literal">true</span>&#125;)</span><br><span class="line"> </span><br><span class="line">target(<span class="string">&quot;foo_demo&quot;</span>)</span><br><span class="line">    set_kind(<span class="string">&quot;binary&quot;</span>)</span><br><span class="line">    add_deps(<span class="string">&quot;foo&quot;</span>)</span><br><span class="line">    add_files(<span class="string">&quot;src/main.cpp&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ–¹åº“ä¾èµ–ï¼šï¼ˆé»˜è®¤å®‰è£…åœ¨<code>~/.xmake</code>ç›®å½•ä¸‹ï¼‰</p><ul><li><code>xrepo search/info/fetch/install/remove &lt;package&gt;</code></li><li><code>xrepo clean</code></li><li><code>xrepo scan</code></li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">add_rules(<span class="string">&quot;mode.debug&quot;</span>, <span class="string">&quot;mode.release&quot;</span>)</span><br><span class="line">add_requires(<span class="string">&quot;imgui 1.88&quot;</span>, &#123;configs = &#123;glfw_opengl3 = <span class="literal">true</span>&#125;&#125;)</span><br><span class="line">target(<span class="string">&quot;imgui-demo&quot;</span>)</span><br><span class="line">    set_kind(<span class="string">&quot;binary&quot;</span>)</span><br><span class="line">    add_files(<span class="string">&quot;src/main.cpp&quot;</span>)</span><br><span class="line">    add_packages(<span class="string">&quot;imgui&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add_requires(<span class="string">&quot;boost&quot;</span>, &#123;configs = &#123;filesystem = <span class="literal">true</span>, serialization = <span class="literal">true</span>, ...&#125;&#125;)</span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰é€‰é¡¹ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">option(<span class="string">&quot;myopt&quot;</span>)</span><br><span class="line">    set_showmenu(<span class="literal">true</span>)</span><br><span class="line">    set_description(<span class="string">&quot;The test config option&quot;</span>)</span><br><span class="line">option_end()</span><br><span class="line"></span><br><span class="line">target(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">    set_kind(<span class="string">&quot;binary&quot;</span>)</span><br><span class="line">    add_files(<span class="string">&quot;src/*.cpp&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> is_config(<span class="string">&quot;myopt&quot;</span>, <span class="string">&quot;hello&quot;</span>) <span class="keyword">then</span></span><br><span class="line">        add_defines(<span class="string">&quot;HELLO&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>å†…ç½®å˜é‡ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(projectdir)</span><br><span class="line">$(buildir)</span><br><span class="line">$(curdir)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hazard Pointers</title>
      <link href="/2024/01/20/Hazard-Pointers/"/>
      <url>/2024/01/20/Hazard-Pointers/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 2809. ä½¿æ•°ç»„å’Œå°äºç­‰äºxçš„æœ€å°‘æ—¶é—´</title>
      <link href="/2024/01/20/Leetcode-2809-%E4%BD%BF%E6%95%B0%E7%BB%84%E5%92%8C%E5%B0%8F%E4%BA%8E%E7%AD%89%E4%BA%8Ex%E7%9A%84%E6%9C%80%E5%B0%91%E6%97%B6%E9%97%B4/"/>
      <url>/2024/01/20/Leetcode-2809-%E4%BD%BF%E6%95%B0%E7%BB%84%E5%92%8C%E5%B0%8F%E4%BA%8E%E7%AD%89%E4%BA%8Ex%E7%9A%84%E6%9C%80%E5%B0%91%E6%97%B6%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>ç»™å®šé•¿åº¦ä¸º$n$çš„æ•°ç»„<code>nums1</code>å’Œ<code>nums2</code>ï¼Œåœ¨æ¯ä¸€ç§’ï¼Œæ¯ä¸ª<code>nums1[i]</code>ä¼šå¢åŠ <code>nums2[i]</code>ï¼Œç„¶åä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ•°å°†å…¶ç½®0ï¼Œé—®ä½ ä½¿<code>nums1</code>ä¸­æ‰€æœ‰æ•°çš„å’Œå°äºç­‰äº$x$çš„æœ€å°‘ç”¨æ—¶ã€‚</p><p>$1\le n \le 1000, 1\le nums1[i] \le 1000, 0\le nums2[i] \le 1000, 0\le x \le 10^6$</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>æ¯æ—¥ä¸€é¢˜æ²¡åšå‡ºæ¥ğŸ˜­ã€‚</p><p>æ˜¾ç„¶å¯¹ä¸€ä¸ªä½ç½®$i$è‡³å¤šåªä¼šæ“ä½œ1æ¬¡ï¼Œå› ä¸ºå¦‚æœæ“ä½œå¤šæ¬¡ï¼Œé‚£ä¹ˆé™¤äº†æœ€åä¸€æ¬¡ï¼Œå‰å‡ æ¬¡éƒ½æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè¿˜ä¸å¦‚ç”¨æ¥æ“ä½œåˆ«çš„ä½ç½®ã€‚å› æ­¤ç”¨æ—¶ä¸Šé™æ˜¯$n$ï¼Œå¦åˆ™å°±æ˜¯æ°¸è¿œä¸è¡Œï¼ˆ-1ï¼‰ã€‚</p><p>å¦‚æœå›ºå®šæ“ä½œçš„$t$ä¸ªä½ç½®ï¼Œæ˜¾ç„¶åº”è¯¥æŒ‰ç…§<code>nums2</code>ä»å°åˆ°å¤§ç½®0çš„æ”¶ç›Šæ˜¯æœ€å¤§çš„ã€‚</p><p>ç°åœ¨çš„é—®é¢˜å°±æ˜¯è¿™$t$ä¸ªä½ç½®æ€ä¹ˆé€‰ï¼Ÿè¿™ä¸€æ­¥æˆ‘æ²¡æƒ³å‡ºæ¥ï¼Œä¸€ç›´åœ¨æƒ³è´ªå¿ƒçš„æ–¹æ³•ï¼Œå½“æ—¶è„‘å­ä¹Ÿæ™•æ™•çš„ğŸ¤¡ã€‚</p><p>è€ƒè™‘å°†æ‰€æœ‰æ•°æŒ‰ç…§<code>nums2</code>ä»å°åˆ°å¤§æ’åºï¼Œé‚£ä¹ˆç¬¬$i$ä¸ªé€‰æ‹©çš„æ•°$j$å°±åº”è¯¥åœ¨ç¬¬$i$å¤©æ“ä½œï¼Œå®ƒèƒ½å¸¦æ¥çš„è´¡çŒ®å°±æ˜¯çœä¸‹$nums1[j] + i * nums2[j]$ã€‚æƒ³åˆ°è¿™é‡Œåº”è¯¥å¾ˆå®¹æ˜“æƒ³åˆ°$dp[i][j]$è¡¨ç¤ºè€ƒè™‘äº†å‰$i$ä¸ªæ•°ï¼Œé€‰æ‹©äº†$j$ä¸ªèƒ½å¸¦æ¥çš„æœ€å¤§è´¡çŒ®ã€‚ç„¶åå°±åšå®Œäº†ã€‚ã€‚ã€‚$O(n^2)$</p><p><s>ä»£ç éƒ½ä¸æ˜¯æˆ‘è‡ªå·±å†™çš„ï¼Œå·æ‡’CVçš„</s></p><p>notesï¼šrustå†™ç®—æ³•é¢˜ä¼˜å…ˆé€‰ç”¨<code>sort_unstable</code>ã€‚è¿™ä¸ªDPå°±æ˜¯ä¸ª01èƒŒåŒ…ï¼Œæ‰€ä»¥å¯ä»¥çœæ‰ç¬¬ä¸€ç»´ï¼Œç„¶åå€’åºDPã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">minimum_time</span>(nums1: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt;, nums2: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt;, x: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">i32</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">pairs</span> = nums1.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">zip</span>(nums2.<span class="title function_ invoke__">iter</span>()).collect::&lt;<span class="type">Vec</span>&lt;_&gt;&gt;();</span><br><span class="line">        pairs.<span class="title function_ invoke__">sort_unstable_by</span>(|a, b| a.<span class="number">1</span>.<span class="title function_ invoke__">cmp</span>(b.<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">n</span> = pairs.<span class="title function_ invoke__">len</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">f</span> = <span class="built_in">vec!</span>[<span class="number">0</span>; n + <span class="number">1</span>];</span><br><span class="line">        <span class="title function_ invoke__">for</span> (i, (a, b)) <span class="keyword">in</span> pairs.<span class="title function_ invoke__">into_iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">            <span class="keyword">for</span> <span class="variable">j</span> <span class="keyword">in</span> (<span class="number">1</span>..=(i + <span class="number">1</span>)).<span class="title function_ invoke__">rev</span>() &#123;</span><br><span class="line">                f[j] = f[j].<span class="title function_ invoke__">max</span>(f[j - <span class="number">1</span>] + a + b * j <span class="keyword">as</span> <span class="type">i32</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">s1</span> = nums1.<span class="title function_ invoke__">iter</span>().sum::&lt;<span class="type">i32</span>&gt;();</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">s2</span> = nums2.<span class="title function_ invoke__">iter</span>().sum::&lt;<span class="type">i32</span>&gt;();</span><br><span class="line">        <span class="title function_ invoke__">for</span> (t, v) <span class="keyword">in</span> f.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">            <span class="keyword">if</span> s1 + s2 * t <span class="keyword">as</span> <span class="type">i32</span> - v &lt;= x &#123;</span><br><span class="line">                <span class="keyword">return</span> t <span class="keyword">as</span> <span class="type">i32</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        -<span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcodeå‘¨èµ›374</title>
      <link href="/2024/01/16/Leetcode%E5%91%A8%E8%B5%9B374/"/>
      <url>/2024/01/16/Leetcode%E5%91%A8%E8%B5%9B374/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯ç›®å‰ç¬¬ä¸€æ¬¡å‘¨èµ›éƒ½æ²¡AKğŸ˜­ï¼ˆ<s>å½“ç„¶ä¹‹å‰ç¬¬ä¸€æ¬¡æ‰“å‘¨èµ›å°±ç»å†äº†FSTğŸ¤¡</s>ï¼‰</p><p>è¿™åœºä¸»è¦æ˜¯ç¬¬ä¸‰é¢˜æ²¡æƒ³åˆ°å¥½çš„æ–¹æ³•ï¼Œå†™æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œæµªè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚ç¬¬å››é¢˜ä¸€æ—¶é—´ä¹Ÿæ²¡æƒ³å‡ºæ¥ï¼Œå¤„äºåŠæ”¾å¼ƒçŠ¶æ€äº†ã€‚</p><h2 id="2953-ç»Ÿè®¡å®Œå…¨å­å­—ç¬¦ä¸²"><a class="header-anchor" href="#2953-ç»Ÿè®¡å®Œå…¨å­å­—ç¬¦ä¸²">Â¶</a>2953. ç»Ÿè®¡å®Œå…¨å­å­—ç¬¦ä¸²</h2><h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šå­—ç¬¦ä¸²<code>word</code>å’Œæ•´æ•°$k$ï¼Œ<code>word</code>çš„ä¸€ä¸ªå­å­—ç¬¦ä¸²<code>s</code>è¢«ç§°ä¸ºå®Œå…¨å­—ç¬¦ä¸²ï¼Œä»…å½“ï¼š</p><ul><li><code>s</code>ä¸­æ¯ä¸ªå­—ç¬¦<strong>æ°å¥½</strong>å‡ºç°$k$æ¬¡</li><li><code>s</code>ä¸­ç›¸é‚»å­—ç¬¦åœ¨å­—æ¯è¡¨ä¸­é¡ºåºè‡³å¤šç›¸å·®2</li></ul><p>æ±‚wordä¸­å®Œå…¨å­å­—ç¬¦ä¸²çš„æ•°é‡ã€‚</p><p>$len(word) \le 10^5, 1\le k \le len(word)$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>ç¬¬äºŒä¸ªæ¡ä»¶æ˜¯å¾ˆå®¹æ˜“æƒ³åˆ°å¯ä»¥å°ºå–çš„ï¼Œå…³é”®æ˜¯å¯¹äºå­åŒºé—´$[i, j]$æ€ä¹ˆå¿«é€Ÿç»Ÿè®¡æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶çš„å­å­—ç¬¦ä¸²ã€‚</p><p>é¦–å…ˆæšä¸¾èµ·å§‹ç‚¹$i$ï¼Œæ˜¾ç„¶æœ€å¤šåªæœ‰26ä¸ªå¯è¡Œçš„å­å­—ç¬¦ä¸²ï¼Œå³æœ€åä¸€ä¸ªå­—ç¬¦æ˜¯ç¬¬$k$æ¬¡å‡ºç°çš„aã€bã€cã€â€¦ã€zï¼Œä¾æ¬¡æ£€æŸ¥å³å¯ã€‚å¦ä¸€ç§åšæ³•æ˜¯æšä¸¾è¿™ä¸ªå­å­—ç¬¦ä¸²ä¸­åŒ…å«çš„å­—æ¯ä¸ªæ•°ï¼Œå­—æ¯ä¸ªæ•°å¦‚æœæ˜¯$x$ï¼Œé‚£ä¹ˆé•¿åº¦å°±æ˜¯$kx$ã€‚å…¶å®ä»¥ä¸Šä¸¤ç§æ–¹å¼æ˜¯ç›¸ä¼¼çš„ï¼Œæœ¬è´¨éƒ½æ˜¯åªéœ€è¦æ£€æŸ¥26ä¸ªå­ä¸²å³å¯ã€‚å¤æ‚åº¦ä¸º$O(n<em>26</em>26)$ã€‚</p><p>æˆ‘æ¯”èµ›æ—¶çš„åšæ³•æ˜¯å…ˆæšä¸¾é¦–å­—ç¬¦ï¼Œè¿™æ ·ç»“å°¾ä¸€å®šè½åœ¨è¯¥å­—ç¬¦ç¬¬$k$æ¬¡å‡ºç°åˆ°ç¬¬$k+1$å‡ºç°è¿™ä¸ªåŒºé—´é‡Œï¼Œè¿™ä¸ªå¯ä»¥å°ºå–ã€‚å¤æ‚åº¦å¯ä»¥æ˜¯$O(n<em>26)$ï¼Œä½†æ˜¯å¾ˆéš¾å†™ï¼Œè¿˜ä¸å¦‚å†™æˆ$O(n</em>26*26)$çš„äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countCompleteSubstrings</span><span class="params">(string word, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = word.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ) &#123;</span><br><span class="line">            <span class="type">int</span> j = i + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (j &lt; n &amp;&amp; <span class="built_in">abs</span>(word[j] - word[j - <span class="number">1</span>]) &lt;= <span class="number">2</span>) ++j;</span><br><span class="line">            array&lt;<span class="type">int</span>, 26&gt; cnt&#123;&#125;;</span><br><span class="line">            vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">pos</span>(<span class="number">26</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = i; k &lt; j; k++) pos[word[k] - <span class="string">&#x27;a&#x27;</span>].<span class="built_in">push_back</span>(k);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> c = <span class="number">0</span>; c &lt; <span class="number">26</span>; c++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (pos[c].<span class="built_in">size</span>() &lt; k) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="type">int</span> bad = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> l = pos[c][<span class="number">0</span>], r = l, t = <span class="number">0</span>; l &lt; j; t++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">                        cnt[word[r] - <span class="string">&#x27;a&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">if</span> (cnt[word[r] - <span class="string">&#x27;a&#x27;</span>] != k) ++bad;</span><br><span class="line">                        <span class="keyword">if</span> (!bad) ++ans;</span><br><span class="line">                        ++r;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">int</span> nxt = j;</span><br><span class="line">                    <span class="keyword">if</span> (t + k &lt; pos[c].<span class="built_in">size</span>()) nxt = pos[c][t + k];</span><br><span class="line">                    <span class="keyword">while</span> (r &lt; nxt) &#123;</span><br><span class="line">                        cnt[word[r] - <span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">                        <span class="keyword">if</span> (cnt[word[r] - <span class="string">&#x27;a&#x27;</span>] != k) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (cnt[word[r] - <span class="string">&#x27;a&#x27;</span>] == <span class="number">1</span> || cnt[word[r] - <span class="string">&#x27;a&#x27;</span>] == k + <span class="number">1</span>) ++bad;</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k &gt; <span class="number">1</span>) --bad;</span><br><span class="line">                        ++r;</span><br><span class="line">                        <span class="keyword">if</span> (!bad) &#123;</span><br><span class="line">                            ++ans;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">int</span> nxt2 = j;</span><br><span class="line">                    <span class="keyword">if</span> (t + <span class="number">1</span> &lt; pos[c].<span class="built_in">size</span>()) nxt2 = pos[c][t + <span class="number">1</span>];</span><br><span class="line">                    <span class="keyword">while</span> (l &lt; nxt2) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (cnt[word[l] - <span class="string">&#x27;a&#x27;</span>] == k) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (k!=<span class="number">1</span>) ++bad;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span> (cnt[word[l] - <span class="string">&#x27;a&#x27;</span>] == <span class="number">1</span> || cnt[word[l] - <span class="string">&#x27;a&#x27;</span>] == k + <span class="number">1</span>) --bad;</span><br><span class="line">                        cnt[word[l] - <span class="string">&#x27;a&#x27;</span>]--;</span><br><span class="line">                        ++l;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            i = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="2954-ç»Ÿè®¡æ„Ÿå†’åºåˆ—çš„æ•°ç›®"><a class="header-anchor" href="#2954-ç»Ÿè®¡æ„Ÿå†’åºåˆ—çš„æ•°ç›®">Â¶</a>2954. ç»Ÿè®¡æ„Ÿå†’åºåˆ—çš„æ•°ç›®</h2><p>ç»™å®šæ•´æ•°$n$å’Œå‡åºæ•°ç»„<code>sick</code>ï¼Œè¯¥æ•°ç»„åŒ…å«äº†æ‰€æœ‰åˆå§‹è¢«æ„ŸæŸ“çš„å°å­©çš„ä¸‹æ ‡ï¼Œåœ¨æ¯ä¸€ç§’å°å­©$i$ä¼šè¿›ä¸€æ­¥æ„ŸæŸ“$i - 1$<strong>æˆ–</strong>$i + 1$ï¼Œæ¯ç§’è‡³å¤šä¸€ä¸ªå°å­©ä¼šè¢«æ„ŸæŸ“ã€‚é—®æ‰€æœ‰å¯èƒ½çš„æ„ŸæŸ“åºåˆ—ã€‚ç­”æ¡ˆæ¨¡1e9 + 7ã€‚</p><p>$n \le 10^5$</p><h2 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h2><p>å½“æ—¶ç¬¬ä¸€æƒ³æ³•ä»¥ä¸ºæ˜¯å¡«å‘DPï¼Œä½†çœ‹äº†ä¸€çœ¼è‡³å°‘å¾—$O(n^2)$ï¼Œç„¶åå°±æ²¡æœ‰ç„¶åäº†ã€‚ã€‚å¯„äº†ï¼Œæ‘†äº†</p><p>ä¸€ä¸ªå¾ˆé‡è¦çš„è§‚å¯Ÿæ˜¯åˆå§‹çš„sickæŠŠ$[0, n - 1]$åˆ’åˆ†æˆäº†è‹¥å¹²çš„æ®µï¼Œå®ƒä»¬æ˜¯äº’ä¸å¹²æ‰°çš„ã€‚è€ƒè™‘å°å­©$i$ï¼Œå®ƒå·¦ä¾§æœ€è¿‘çš„æ„ŸæŸ“è€…æ˜¯$j$ï¼Œå³ä¾§æœ€è¿‘çš„æ„ŸæŸ“è€…æ˜¯$k$ï¼Œ$i$è¦ä¹ˆè¢«$j$æ„ŸæŸ“ï¼Œè¦ä¹ˆè¢«$k$æ„ŸæŸ“ã€‚ä¸‹é¢ç‹¬ç«‹è€ƒè™‘æ¯ä¸ªæ®µï¼Œå¦‚æœå¼€å¤´æˆ–ç»“å°¾çš„æ®µï¼Œåˆ™åªæœ‰ä¸€ç§æ„ŸæŸ“æ–¹å¼ï¼Œå¦åˆ™å°±æœ‰$2^{k-j-1}$ç§ã€‚æœ€ååªéœ€è¦å°†æ¯ä¸ªæ®µä¾æ¬¡ä¸¤ä¸¤åˆå¹¶å³å¯ã€‚è€ƒè™‘ä¸€ä¸ªé•¿åº¦ä¸º$x$å’Œä¸€ä¸ªé•¿åº¦ä¸º$y$çš„æ®µï¼Œæ€»å…±æœ‰$x+1$ä¸ªç©ºä½ï¼Œæ’å…¥$y$ä¸ªæ•°ï¼Œç›¸å½“äº$x+1$ä¸ªå¤§äºç­‰äº0çš„å˜é‡æ±‚å’Œç­‰äº$y$ï¼Œæ–¹æ¡ˆæ•°ä¸º$C(x+y, x)$ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> fac[N], ifac[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Pow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line"><span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (b) &#123;</span><br><span class="line"><span class="keyword">if</span> (b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%MOD;</span><br><span class="line">a = <span class="number">1ll</span>*a*a%MOD;</span><br><span class="line">b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%MOD;</span><br><span class="line">ifac[n] = <span class="built_in">Pow</span>(fac[n], MOD<span class="number">-2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=n<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (a&lt;b||b&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1ll</span>*fac[a]*ifac[b]%MOD*ifac[a-b]%MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">numberOfSequence</span><span class="params">(<span class="type">int</span> n, vector&lt;<span class="type">int</span>&gt;&amp; sick)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">init</span>(n + <span class="number">1</span>);</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">two</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">        two[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) two[i] = (two[i - <span class="number">1</span>] &lt;&lt; <span class="number">1</span>) % MOD;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> pre = sick[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i + <span class="number">1</span> &lt; sick.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="type">int</span> cur = sick[i + <span class="number">1</span>] - sick[i] - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (!cur) <span class="keyword">continue</span>;</span><br><span class="line">            ans = <span class="number">1ll</span>*ans*two[cur - <span class="number">1</span>]%MOD*<span class="built_in">C</span>(cur + pre, pre)%MOD;</span><br><span class="line">            pre += cur;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="number">1ll</span>*ans*<span class="built_in">C</span>(n - <span class="number">1</span> - sick.<span class="built_in">back</span>() + pre, pre)%MOD;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°ä½DPæ¨¡æ¿æ€»ç»“</title>
      <link href="/2024/01/16/%E6%95%B0%E4%BD%8DDP%E6%A8%A1%E6%9D%BF%E6%80%BB%E7%BB%93/"/>
      <url>/2024/01/16/%E6%95%B0%E4%BD%8DDP%E6%A8%A1%E6%9D%BF%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>å‡ ä¸ªç»†èŠ‚ï¼š</p><ul><li>åªæœ‰å½“limå’Œzeroéƒ½ä¸º0æ—¶æ‰æ‰§è¡Œè®°å¿†åŒ–ï¼Œå› ä¸ºåªæœ‰è¿™æ—¶çŠ¶æ€æ‰ä¸ä¾èµ–äºå½“å‰çš„æ•°å­—ï¼›å¦åˆ™å¯¹äºæ¯ä¸ªæ•°å­—éƒ½å¾—memsetä¸€æ¬¡</li><li>ä»é«˜ä½å‘ä½ä½dpï¼Œå¹¶ä¸”é«˜ä½åº”è¯¥ç›¸åº”çš„å­˜åœ¨æ•°ç»„çš„é«˜ä½ä¸Šï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®è®°å¿†åŒ–; æ¯”å¦‚123åº”è¯¥è½¬æˆ<code>s=&quot;321&quot;</code></li><li>zeroè¿™ä¸ªæ ‡å¿—ä½æœ‰æ—¶å€™æ˜¯ä¸éœ€è¦çš„ï¼Œæœ‰æ—¶å€™å¯ä»¥ç¨å¾®æ€è€ƒä¸‹å¯ä¸å¯ä»¥å»æ‰ï¼Œå½“ç„¶åŠ ç€ä¹Ÿä¸ä¼šé”™</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">DP</span><span class="params">(<span class="type">int</span> d, <span class="type">bool</span> lim, <span class="type">bool</span> zero)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d == <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> &amp;v = dp[d];</span><br><span class="line">    <span class="keyword">if</span>(!lim &amp;&amp; !zero &amp;&amp; v != <span class="number">-1</span>) <span class="keyword">return</span> v;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, up = (lim ? s[d] - <span class="string">&#x27;0&#x27;</span> : <span class="number">9</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;=up; i++) <span class="built_in">Add</span>(ans, <span class="built_in">DP</span>(d - <span class="number">1</span>, lim &amp;&amp; i==up, zero &amp;&amp; i==<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">if</span>(!lim &amp;&amp; !zero) v = ans;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *s, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(s, s + n);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">DP</span>(n - <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆå¤šæ—¶å€™æ˜¯æœ‰ä¸Šä¸‹é™è¦æ±‚çš„ï¼Œ<code>[low, high]</code>ï¼Œä¸€ç§æ–¹å¼æ˜¯<code>get(high) - get(low - 1)</code>ï¼ˆç¼ºç‚¹æ˜¯å¦‚æœæ•°å­—å¾ˆå¤§ï¼Œä»¥å­—ç¬¦ä¸²å½¢å¼ç»™å‡ºï¼Œé‚£è¿˜å¾—æ‰‹å†™ä¸€ä¸ªå¤§æ•°å‡æ³•ï¼Œè™½ç„¶ä¹Ÿä¸éš¾ï¼‰ï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥ä¸€æ¬¡dpï¼Œå†™èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠæ ‡å¿—ä½limæ”¹æˆ<code>lim_l</code>å’Œ<code>lim_r</code>å°±å¯ä»¥äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">DP</span><span class="params">(<span class="type">int</span> d, <span class="type">bool</span> lim_l, <span class="type">bool</span> lim_r, <span class="type">bool</span> zero)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d == <span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> &amp;v = dp[d];</span><br><span class="line">    <span class="keyword">if</span>(!lim_l &amp;&amp; !lim_r &amp;&amp; !zero &amp;&amp; v != <span class="number">-1</span>) <span class="keyword">return</span> v;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, dn = (lim_l ? s[d] - <span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>), up = (lim_r ? s[d] - <span class="string">&#x27;0&#x27;</span> : <span class="number">9</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = dn; i&lt;=up; i++) <span class="built_in">Add</span>(ans, <span class="built_in">DP</span>(d - <span class="number">1</span>, lim_l &amp;&amp; i==dn, lim_r &amp;&amp; i==up, zero &amp;&amp; i==<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">if</span>(!lim_l &amp;&amp; !lim_r &amp;&amp; !zero) v = ans;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>automatic-cache-DP</title>
      <link href="/2024/01/14/automatic-cache-DP/"/>
      <url>/2024/01/14/automatic-cache-DP/</url>
      
        <content type="html"><![CDATA[<p><a href="https://codeforces.com/blog/entry/124683">https://codeforces.com/blog/entry/124683</a></p><p>ä¸ªäººè®¤ä¸ºä¸æ˜¯å¾ˆä½¿ç”¨ï¼Œä»…ä½œä¸ºå¼€æ‹“è§†é‡ï¼ˆğŸ§åŸæ¥è¿˜å¯ä»¥è¿™æ ·ï¼‰ã€‚</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨Pythonä¸­å­˜åœ¨<code>@cache</code>è¿™ä¸ªè£…é¥°å™¨ï¼Œä»è€Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„å†™ä¸€äº›é€’å½’å¼çš„DPã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> cache</span><br><span class="line"><span class="meta">@cache</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorial</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">return</span> n * factorial(n - <span class="number">1</span>) <span class="keyword">if</span> n <span class="keyword">else</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢åœ¨C++ä¸­å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚</p><p><code>use_cache</code>çš„ç¬¬ä¸€ä¸ªæ¨¡æ¿å‚æ•°<code>Signature</code>æ˜¯å‡½æ•°ç­¾åï¼Œç¬¬äºŒä¸ªæ¨¡æ¿å‚æ•°<code>Lambda</code>åˆ™æ˜¯è¢«åŒ…è£…çš„lambdaå‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªä»¿å‡½æ•°<code>Cache</code>ï¼Œå…¶æˆå‘˜åŒ…æ‹¬è¯¥lambdaå‡½æ•°<code>f</code>ï¼Œä»¥åŠç”¨äºè®°å¿†åŒ–çš„å“ˆå¸Œè¡¨<code>memo</code>ã€‚æ‰€æœ‰<code>f</code>çš„å‚æ•°ä¼šæ‰“åŒ…æˆä¸€ä¸ªtupleä½œä¸º<code>memo</code>çš„keyï¼Œè€Œ<code>f</code>çš„è¿”å›å€¼åˆ™ä½œä¸º<code>memo</code>çš„valueã€‚</p><p>æ˜¾ç„¶æ‰€æœ‰å‚æ•°éƒ½æ˜¯å€¼æ‹·è´çš„ï¼Œè¦ä½¿ç”¨å¼•ç”¨ï¼Œéœ€è¦ç”¨<code>std::reference_wrapper</code>è¿›è¡ŒåŒ…è£¹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Signature, <span class="keyword">typename</span> Lambda&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Cache</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReturnType, <span class="keyword">typename</span>... Args, <span class="keyword">typename</span> Lambda&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Cache</span>&lt;<span class="built_in">ReturnType</span>(Args...), Lambda&gt; &#123;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... DummyArgs&gt;</span><br><span class="line">    <span class="function">ReturnType <span class="title">operator</span><span class="params">()</span><span class="params">(DummyArgs&amp;&amp;... args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> tied_args = std::<span class="built_in">tie</span>(args...);</span><br><span class="line">        <span class="keyword">auto</span> it = memo.<span class="built_in">find</span>(tied_args);</span><br><span class="line">        <span class="keyword">if</span> (it == memo.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            <span class="keyword">auto</span>&amp;&amp; ans = <span class="built_in">f</span>(*<span class="keyword">this</span>, std::forward&lt;DummyArgs&gt;(args)...);</span><br><span class="line">            memo[tied_args] = ans;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> it-&gt;second;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">_Lambda</span>&gt;</span><br><span class="line">    <span class="built_in">Cache</span>(std::tuple&lt;&gt;, _Lambda&amp;&amp; _f) : <span class="built_in">f</span>(std::forward&lt;_Lambda&gt;(_f)) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    Lambda f;</span><br><span class="line">    <span class="keyword">using</span> TiedArgs = std::tuple&lt;std::<span class="type">decay_t</span>&lt;Args&gt;...&gt;;</span><br><span class="line">    pbds::unordered_map&lt;TiedArgs, ReturnType, hashing::custom_hash&lt;TiedArgs&gt;&gt; memo;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">Signature</span>, <span class="keyword">class</span> <span class="title class_">Lambda</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">use_cache</span><span class="params">(Lambda&amp;&amp; f)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Cache</span>&lt;Signature, Lambda&gt;(std::tuple&#123;&#125;, std::forward&lt;Lambda&gt;(f));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ”¯æŒè¾ƒå¤šçš„å‚æ•°ç±»å‹ï¼Œå¦‚<code>tuple</code>ã€<code>container</code>ç­‰ï¼Œéœ€è¦æ‰‹å†™hashã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„ç¤ºä¾‹ï¼Œå…¶å®å…³é”®å°±æ˜¯å†™ä¸€ä¸ªå¥½çš„<code>hash_combine</code>å‡½æ•°ï¼ˆæ˜¾ç„¶å¼‚æˆ–æ˜¯ä¸å¥½çš„ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> hashing &#123;</span><br><span class="line">    <span class="keyword">using</span> i64 = std::<span class="type">int64_t</span>;</span><br><span class="line">    <span class="keyword">using</span> u64 = std::<span class="type">uint64_t</span>;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> u64 FIXED_RANDOM = std::chrono::steady_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> USE_AES</span></span><br><span class="line">    <span class="function">std::mt19937 <span class="title">rd</span><span class="params">(FIXED_RANDOM)</span></span>;</span><br><span class="line">    <span class="type">const</span> __m128i KEY1&#123;(i64)<span class="built_in">rd</span>(), (i64)<span class="built_in">rd</span>()&#125;;</span><br><span class="line">    <span class="type">const</span> __m128i KEY2&#123;(i64)<span class="built_in">rd</span>(), (i64)<span class="built_in">rd</span>()&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">D</span> = <span class="type">void</span>&gt;</span><br><span class="line">    <span class="keyword">struct</span> custom_hash &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// https://www.boost.org/doc/libs/1_55_0/doc/html/hash/combine.html</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">hash_combine</span><span class="params">(u64&amp; seed, <span class="type">const</span> T&amp; v)</span> </span>&#123;</span><br><span class="line">        custom_hash&lt;T&gt; hasher;</span><br><span class="line">        seed ^= <span class="built_in">hasher</span>(v) + <span class="number">0x9e3779b97f4a7c15</span> + (seed &lt;&lt; <span class="number">12</span>) + (seed &gt;&gt; <span class="number">4</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// http://xorshift.di.unimi.it/splitmix64.c</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">custom_hash</span>&lt;T, <span class="keyword">typename</span> std::enable_if&lt;std::is_integral&lt;T&gt;::value&gt;::type&gt; &#123;</span><br><span class="line">        <span class="function">u64 <span class="title">operator</span><span class="params">()</span><span class="params">(T _x)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">            u64 x = _x;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> USE_AES</span></span><br><span class="line">            <span class="comment">// implementation defined till C++17, defined from C++20</span></span><br><span class="line">            __m128i m&#123;<span class="built_in">i64</span>(<span class="built_in">u64</span>(x) * <span class="number">0xbf58476d1ce4e5b9</span>u64), (i64)FIXED_RANDOM&#125;;</span><br><span class="line">            __m128i y = _mm_aesenc_si128(m, KEY1);</span><br><span class="line">            __m128i z = _mm_aesenc_si128(y, KEY2);</span><br><span class="line">            <span class="keyword">return</span> z[<span class="number">0</span>];</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">            x += <span class="number">0x9e3779b97f4a7c15</span> + FIXED_RANDOM;</span><br><span class="line">            x = (x ^ (x &gt;&gt; <span class="number">30</span>)) * <span class="number">0xbf58476d1ce4e5b9</span>;</span><br><span class="line">            x = (x ^ (x &gt;&gt; <span class="number">27</span>)) * <span class="number">0x94d049bb133111eb</span>;</span><br><span class="line">            <span class="keyword">return</span> x ^ (x &gt;&gt; <span class="number">31</span>);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">custom_hash</span>&lt;T, std::<span class="type">void_t</span>&lt;<span class="keyword">decltype</span>(std::<span class="built_in">begin</span>(std::<span class="built_in">declval</span>&lt;T&gt;()))&gt;&gt; &#123;</span><br><span class="line">        <span class="function">u64 <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; a)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">            u64 value = FIXED_RANDOM;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; x : a) <span class="built_in">hash_combine</span>(value, x);</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span>... T&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">custom_hash</span>&lt;std::tuple&lt;T...&gt;&gt; &#123;</span><br><span class="line">        <span class="function">u64 <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> std::tuple&lt;T...&gt;&amp; a)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">            u64 value = FIXED_RANDOM;</span><br><span class="line">            std::<span class="built_in">apply</span>([&amp;value](T <span class="type">const</span>&amp;... args) &#123; (<span class="built_in">hash_combine</span>(value, args), ...); &#125;, a);</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>, <span class="keyword">class</span> <span class="title class_">U</span>&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">custom_hash</span>&lt;std::pair&lt;T, U&gt;&gt; &#123;</span><br><span class="line">        <span class="function">u64 <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> std::pair&lt;T, U&gt;&amp; a)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">            u64 value = FIXED_RANDOM;</span><br><span class="line">            <span class="built_in">hash_combine</span>(value, a.first);</span><br><span class="line">            <span class="built_in">hash_combine</span>(value, a.second);</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">&#125;;  <span class="comment">// namespace hashing</span></span><br></pre></td></tr></table></figure><p>æœ€åï¼Œä¼—æ‰€å‘¨çŸ¥<code>std::unordered_map</code>çš„è®¿å­˜å¾ˆå·®ï¼Œæ€§èƒ½ä¸å¥½ï¼Œæ‰€ä»¥ä½œè€…é€‰æ‹©äº†<code>gp_hash_table</code>ï¼Œå¹¶æä¾›äº†ä¸€äº›ç”¨æˆ·å‹å¥½çš„aliasã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ext/pb_ds/assoc_container.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ext/pb_ds/tree_policy.hpp&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> pbds &#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PB_DS_ASSOC_CNTNR_HPP</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">Key</span>, <span class="keyword">class</span> <span class="title class_">Value</span>, <span class="keyword">class</span> <span class="title class_">Hash</span>&gt;</span><br><span class="line">    <span class="keyword">using</span> unordered_map = gp_hash_table&lt;Key, Value, Hash, std::equal_to&lt;Key&gt;, direct_mask_range_hashing&lt;&gt;, linear_probe_fn&lt;&gt;,</span><br><span class="line">                                        hash_standard_resize_policy&lt;hash_exponential_size_policy&lt;&gt;, hash_load_check_resize_trigger&lt;&gt;, <span class="literal">true</span>&gt;&gt;;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">Key</span>, <span class="keyword">class</span> <span class="title class_">Hash</span>&gt;</span><br><span class="line">    <span class="keyword">using</span> unordered_set = pbds::unordered_map&lt;Key, null_type, Hash&gt;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> PB_DS_TREE_POLICY_HPP</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">using</span> ordered_set = tree&lt;T, null_type, std::less&lt;T&gt;, rb_tree_tag, tree_order_statistics_node_update&gt;;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">using</span> ordered_multiset = tree&lt;T, null_type, std::less_equal&lt;T&gt;, rb_tree_tag, tree_order_statistics_node_update&gt;;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">Key</span>, <span class="keyword">class</span> <span class="title class_">Value</span>, <span class="keyword">class</span> <span class="title class_">Compare</span> = std::less&lt;Key&gt;&gt;</span><br><span class="line">    <span class="keyword">using</span> ordered_map = tree&lt;Key, Value, Compare, rb_tree_tag, tree_order_statistics_node_update&gt;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;  <span class="comment">// namespace pbds</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> factorial = <span class="built_in">use_cache</span>&lt;<span class="built_in">int</span>(<span class="type">int</span>)&gt;([](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> n) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n) <span class="keyword">return</span> n * <span class="built_in">self</span>(n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;    </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> solve = use_cache&lt;<span class="built_in">bool</span>(<span class="type">char</span>, pair&lt;<span class="type">int</span>, string&gt;)&gt;([&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">char</span> c, pair&lt;<span class="type">int</span>, string&gt; p) -&gt; <span class="type">bool</span> &#123;</span><br><span class="line">    <span class="comment">// note that v was captured by &amp;</span></span><br><span class="line">    <span class="comment">// use c, p, v as needed</span></span><br><span class="line">    <span class="comment">// let&#x27;s say you have c1 and p1 as arguments for a recursive call</span></span><br><span class="line">    <span class="keyword">auto</span> x = <span class="built_in">self</span>(c1, p1); <span class="comment">// recursive call - do as many of them as needed</span></span><br><span class="line">    <span class="comment">// use c, p, v as needed</span></span><br><span class="line">    <span class="keyword">return</span> y; <span class="comment">// return something</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‚æœµè‰æ ‘â€”â€”ç»´æŠ¤è¿ç»­åŒºé—´</title>
      <link href="/2024/01/13/%E7%8F%82%E6%9C%B5%E8%8E%89%E6%A0%91%E2%80%94%E2%80%94%E7%BB%B4%E6%8A%A4%E8%BF%9E%E7%BB%AD%E5%8C%BA%E9%97%B4/"/>
      <url>/2024/01/13/%E7%8F%82%E6%9C%B5%E8%8E%89%E6%A0%91%E2%80%94%E2%80%94%E7%BB%B4%E6%8A%A4%E8%BF%9E%E7%BB%AD%E5%8C%BA%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<h2 id="éšæœºæ•°æ®åŒºé—´èµ‹å€¼"><a class="header-anchor" href="#éšæœºæ•°æ®åŒºé—´èµ‹å€¼">Â¶</a>éšæœºæ•°æ®åŒºé—´èµ‹å€¼</h2><p>ç”¨setç»´æŠ¤æ‰€æœ‰ä¸ç›¸äº¤çš„å€¼ç›¸åŒçš„åŒºé—´æ®µã€‚åˆå§‹æ—¶ï¼Œéœ€è¦<code>for (i = 1; i &lt;= n; i++) odt.emplace(i, i, a[i])</code>ã€‚</p><p><code>split(x)</code>è¿”å›ä»¥xèµ·å§‹çš„åŒºé—´å¯¹åº”çš„è¿­ä»£å™¨ã€‚</p><p><code>split(r + 1)</code>, <code>split(l)</code>å°±å¯ä»¥å¾—åˆ°[l, r]åŒºé—´å¯¹åº”çš„è¿­ä»£å™¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="keyword">mutable</span> <span class="type">int</span> v;</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Node</span><span class="params">(<span class="type">int</span> l_, <span class="type">int</span> r_=<span class="number">-1</span>, <span class="type">int</span> v_=<span class="number">0</span>)</span> : l(l_), r(r_), v(v_) &#123;</span>&#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Node&amp; oth) <span class="type">const</span> &#123; <span class="keyword">return</span> l &lt; oth.l; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;Node&gt; odt;</span><br><span class="line">set&lt;Node&gt;::<span class="function">iterator <span class="title">split</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; n) <span class="keyword">return</span> odt.<span class="built_in">end</span>();</span><br><span class="line">    <span class="keyword">auto</span> it = --odt.<span class="built_in">upper_bound</span>(<span class="built_in">Node</span>(x));</span><br><span class="line">    <span class="keyword">if</span> (it-&gt;l == x) <span class="keyword">return</span> it;</span><br><span class="line">    <span class="type">int</span> l = it-&gt;l, r = it-&gt;r, v = it-&gt;v;</span><br><span class="line">    odt.<span class="built_in">erase</span>(it);</span><br><span class="line">    odt.<span class="built_in">emplace</span>(l, x - <span class="number">1</span>, v);</span><br><span class="line">    <span class="keyword">return</span> odt.<span class="built_in">emplace</span>(x, r, v).first;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŒºé—´æ’å…¥ã€åˆ é™¤"><a class="header-anchor" href="#åŒºé—´æ’å…¥ã€åˆ é™¤">Â¶</a>åŒºé—´æ’å…¥ã€åˆ é™¤</h2><p>Leetcode 2276. ç»Ÿè®¡åŒºé—´ä¸­çš„æ•´æ•°æ•°ç›®ã€‚</p><p>æ’å…¥åŒºé—´ï¼ŒæŸ¥è¯¢å½“å‰åŒºé—´è¦†ç›–çš„æ•´æ•°ä¸ªæ•°ã€‚</p><p>æ€è·¯ï¼šå¥—ç”¨ç‚æœµè‰æ ‘çš„æ¡†æ¶ï¼Œç”¨<code>split(x)</code>å¾—åˆ°å·¦ç«¯ç‚¹<strong>å¤§äºç­‰äº</strong><code>x</code>çš„ç¬¬ä¸€ä¸ªåŒºé—´ï¼ˆå› ä¸ºåˆå§‹åŒºé—´æ˜¯ç©ºçš„ï¼Œä¸èƒ½ä¿è¯å­˜åœ¨åŒ…å«<code>x</code>çš„åŒºé—´ï¼‰ã€‚</p><ul><li>æ’å…¥ï¼šä¸æ–­å¾€å‰éå†åˆ é™¤ä¸æ’å…¥åŒºé—´æœ‰äº¤é›†çš„åŒºé—´ï¼ˆæ³¨æ„å®Œå…¨åŒ…å«å’Œæœ‰äº¤é›†ä¸¤ç§caseï¼‰ï¼Œæœ€åå†æ’å…¥å³å¯</li><li>åˆ é™¤ï¼šä¸æ–­å¾€å‰éå†åˆ é™¤ä¸æ’å…¥åŒºé—´æœ‰äº¤é›†çš„åŒºé—´ï¼ˆæ³¨æ„å®Œå…¨åŒ…å«å’Œæœ‰äº¤é›†ä¸¤ç§caseï¼‰</li></ul><p>ç»´æŠ¤è¿ç»­åŒºé—´ï¼Œå¹¶æ”¯æŒå¿«é€Ÿæ’å…¥å’Œåˆ é™¤çš„é¢˜ç›®éƒ½å¯ä»¥å°è¯•å¥—ç”¨<code>split</code>è¿™ä¸ªæŠ½è±¡å‡½æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CountIntervals</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">CountIntervals</span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> left, <span class="type">int</span> right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> it2 = <span class="built_in">split</span>(right + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">auto</span> it1 = it2;</span><br><span class="line">        <span class="keyword">while</span> (it1 != st.<span class="built_in">begin</span>() &amp;&amp; <span class="built_in">prev</span>(it1)-&gt;second &lt;= right &amp;&amp; <span class="built_in">prev</span>(it1)-&gt;second &gt;= left) &#123;</span><br><span class="line">            --it1;</span><br><span class="line">            sz -= it1-&gt;second - it1-&gt;first + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (it1-&gt;first &lt; left) &#123;</span><br><span class="line">                left = it1-&gt;first;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;   </span><br><span class="line">        st.<span class="built_in">erase</span>(it1, it2);</span><br><span class="line">        st.<span class="built_in">emplace</span>(left, right);</span><br><span class="line">        sz += right - left + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sz;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    set&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;::<span class="function">iterator <span class="title">split</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> it = st.<span class="built_in">upper_bound</span>(&#123;x, <span class="number">-1</span>&#125;);</span><br><span class="line">        <span class="keyword">if</span> (it == st.<span class="built_in">begin</span>()) <span class="keyword">return</span> it;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">prev</span>(it)-&gt;first == x || <span class="built_in">prev</span>(it)-&gt;second &lt; x) <span class="keyword">return</span> it;</span><br><span class="line">        --it;</span><br><span class="line">        <span class="type">int</span> l = it-&gt;first, r = it-&gt;second;</span><br><span class="line">        st.<span class="built_in">erase</span>(it);</span><br><span class="line">        st.<span class="built_in">emplace</span>(l, x - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> st.<span class="built_in">emplace</span>(x, r).first;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; st;</span><br><span class="line">    <span class="type">int</span> sz&#123;<span class="number">0</span>&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Parquetå­˜å‚¨æ ¼å¼</title>
      <link href="/2024/01/06/Parquet%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F/"/>
      <url>/2024/01/06/Parquet%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MVPæ¶æ„æ¨¡å¼</title>
      <link href="/2024/01/05/MVP%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/"/>
      <url>/2024/01/05/MVP%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="MVC"><a class="header-anchor" href="#MVC">Â¶</a>MVC</h2><ul><li>Modelï¼šæ¨¡å‹ï¼Œå­˜å–æ•°æ®ï¼ˆDBï¼‰</li><li>Viewï¼šè§†å›¾ï¼Œç”¨æˆ·æ¥å£ã€äº¤äº’ã€å±•ç¤ºï¼ˆUIï¼‰</li><li>Controllerï¼šæ§åˆ¶å™¨ï¼Œå®Œæˆä¸»è¦ä¸šåŠ¡é€»è¾‘ã€‚å“åº”è§†å›¾å±‚çš„è¯·æ±‚ï¼Œæ“ä½œæ¨¡å‹å±‚çš„æ•°æ®ï¼Œå®Œæˆç›¸åº”çš„æ“ä½œï¼Œæ•°æ®å±‚å†é€šçŸ¥è§†å›¾å±‚æ›´æ–°ã€‚</li></ul><p>View-&gt;Controller-&gt;Model-&gt;View</p><p>å°†åº”ç”¨ä»£ç åˆ’åˆ†ä¸åŒçš„éƒ¨åˆ†ï¼ˆæ¨¡å—åŒ–ï¼‰ï¼Œå®ç°å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œç®€åŒ–ä»£ç çš„ç»´æŠ¤ã€‚</p><h2 id="MVP"><a class="header-anchor" href="#MVP">Â¶</a>MVP</h2><ul><li>Model</li><li>View</li><li>Presenter</li></ul><p>åœ¨MVCçš„åŸºç¡€ä¸Šï¼Œå°†Controlleræ”¹åä¸ºPresenterï¼Œå¹¶ä¼˜åŒ–äº†é€šä¿¡æ–¹å¼ã€‚è¿›ä¸€æ­¥å¼ºè°ƒæ‰€æœ‰ä¸šåŠ¡é€»è¾‘éƒ½åœ¨Presenterå±‚å®Œæˆï¼Œè§†å›¾å±‚å’Œæ¨¡å‹å±‚åˆ™å‡ ä¹ä¸åŒ…å«é€»è¾‘ã€‚è§†å›¾å±‚ä¸æ¨¡å‹å±‚ä¸è¿›è¡Œç›´æ¥é€šä¿¡ï¼Œè€Œæ˜¯é€šè¿‡ä¸Presenteräº¤äº’ä»¥ä¼ é€’ä¿¡æ¯ï¼Œè¿›ä¸€æ­¥è§£è€¦äº†è§†å›¾å±‚å’Œæ¨¡å‹å±‚ã€‚</p><p>View&lt;=&gt;Presenter&lt;=&gt;Model</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>vcpkgåŒ…ç®¡ç†</title>
      <link href="/2024/01/04/vcpkg%E5%8C%85%E7%AE%A1%E7%90%86/"/>
      <url>/2024/01/04/vcpkg%E5%8C%85%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">Â¶</a>å®‰è£…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Microsoft/vcpkg.git</span><br><span class="line">./vcpkg/bootstrap-vcpkg.sh</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">Â¶</a>ä½¿ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./vcpkg/vcpkg search</span><br><span class="line">./vcpkg/vcpkg help triplet # åˆ—å‡ºæ‰€æœ‰æ¶æ„åˆ—è¡¨ï¼Œå¦‚x64-linux</span><br><span class="line">./vcpkg/vcpkg install [package_name[:triplet]]</span><br><span class="line">./vcpkg/vcpkg remove</span><br><span class="line">./vcpkg/vcpkg list # æŸ¥çœ‹å·²å®‰è£…çš„åº“</span><br><span class="line">./vcpkg/vcpkg update</span><br><span class="line">./vcpkg/vcpkg upgrade</span><br></pre></td></tr></table></figure><p>vcpkgé»˜è®¤ç¼–è¯‘åŠ¨æ€åº“ï¼Œå¯ä»¥åœ¨tripletä¸­æŒ‡å®š-staticä»¥ç¼–è¯‘é™æ€åº“ã€‚</p><h2 id="CMakeé›†æˆ"><a class="header-anchor" href="#CMakeé›†æˆ">Â¶</a>CMakeé›†æˆ</h2><p>TODO</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 1185/1154. ä¸€å‘¨/ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©</title>
      <link href="/2024/01/01/Leetcode-1185-1154-%E4%B8%80%E5%91%A8-%E4%B8%80%E5%B9%B4%E4%B8%AD%E7%9A%84%E7%AC%AC%E5%87%A0%E5%A4%A9/"/>
      <url>/2024/01/01/Leetcode-1185-1154-%E4%B8%80%E5%91%A8-%E4%B8%80%E5%B9%B4%E4%B8%AD%E7%9A%84%E7%AC%AC%E5%87%A0%E5%A4%A9/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>ç»™å®šå¹´æœˆæ—¥ï¼Œæ±‚è¿™æ˜¯ä¸€å‘¨ä¸­çš„æ˜ŸæœŸå‡ ï¼Œä»¥åŠè¿™æ˜¯ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ã€‚</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å…³é”®å°±æ˜¯é—°å¹´è¿™ä¸ªç‰¹æ®Šæƒ…å†µï¼Œé—°å¹´çš„ä¸€å¤©æœ‰366å¤©ï¼ˆ2æœˆä¼šæœ‰29å¤©ï¼‰ã€‚</p><ul><li>æ™®é€šé—°å¹´ï¼š4çš„å€æ•°ï¼Œä¸”ä¸æ˜¯100çš„å€æ•°</li><li>ä¸–çºªé—°å¹´ï¼š400çš„å€æ•°</li></ul><p>è”¡å‹’å…¬å¼ï¼ŒçŸ¥é“å³å¯ï¼Œä¸ç”¨è®°å¿†ã€‚</p><p>å…¬å…ƒ1å¹´1æœˆ1æ—¥è¢«å®šä¹‰ä¸ºæ˜ŸæœŸä¸€ï¼Œæ‰€ä»¥åªéœ€è¦ç®—è·ç¦»è¯¥æ—¥çš„å¤©æ•°å³å¯çŸ¥é“æ˜¯æ˜ŸæœŸå‡ ã€‚</p><p>ä¸è¿‡äº‹å®ä¸Šé‚£å¤©é‡‡ç”¨çš„æ˜¯å„’ç•¥å†ï¼Œè€Œä¸æ˜¯ç°åœ¨çš„æ ¼é‡Œå†ï¼ˆå…¬å†ï¼‰ï¼Œåœ¨æ ¼é‡Œå†ä¸­1582å¹´10æœˆ5æ—¥åˆ°1582å¹´10æœˆ14æ—¥è¿™10å¤©æ˜¯æ¶ˆå¤±çš„ï¼ˆä¸ºäº†è°ƒæ•´ä¹‹å‰4å¹´1æ¶¦çš„è¯¯å·®ï¼‰ï¼Œæ­¤å¤–å„’ç•¥å†ä¸æ ¼é‡Œå†åœ¨é—°å¹´ä¸Šçš„å·®å¼‚ï¼ˆå¤šäº†12å¤©ï¼‰ï¼Œç»¼åˆè¿™äº›å·®å¼‚ï¼Œå„’ç•¥å†ä¼šæ¯”æ ¼é‡Œå†åœ¨å½“æ—¶å¤š2å¤©ï¼Œå› æ­¤1å¹´1æœˆ1æ—¥åœ¨å„’ç•¥å†ä¸Šæ˜¯æ˜ŸæœŸå…­ã€‚</p><h2 id="è¡¥å……çŸ¥è¯†"><a class="header-anchor" href="#è¡¥å……çŸ¥è¯†">Â¶</a>è¡¥å……çŸ¥è¯†</h2><p>å®é™…å…¬è½¬æ—¶é—´å…¶å®æ˜¯365.25æ—¥ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡é—°å¹´æ¥è¡¥è¶³ç¼ºå°‘çš„å¤©æ•°ã€‚</p><p>å››å¹´ä¸€é—°ï¼Œç™¾å¹´ä¸é—°ï¼Œå››ç™¾å¹´å†é—°ã€‚ï¼ˆæ¯å››å¹´å°‘ä¸€å¤©ï¼Œæ‰€ä»¥è¦è¡¥è¶³ï¼›è¡¥å®Œåï¼Œæ¯ä¸€ç™¾å¹´åˆå¤šä¸€å¤©ï¼Œæ‰€ä»¥ä¸è¡¥ï¼‰</p><p>æœ€åˆè®¡ç®—æœºç³»ç»Ÿåªæœ‰32ä½ï¼Œåªèƒ½å­˜å‚¨68å¹´ï¼ŒUNIXé€‰æ‹©äº†1970.01.01ä½œä¸ºçºªå…ƒæ—¶é—´ã€‚åˆç”±äºUNIXçš„ç»Ÿæ²»åœ°ä½ï¼Œè¯¥é€‰æ‹©æˆä¸ºäº†POSIXæ ‡å‡†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 162/1901. å¯»æ‰¾å³°å€¼I/II</title>
      <link href="/2023/12/21/Leetcode-162-1901-%E5%AF%BB%E6%89%BE%E5%B3%B0%E5%80%BCI-II/"/>
      <url>/2023/12/21/Leetcode-162-1901-%E5%AF%BB%E6%89%BE%E5%B3%B0%E5%80%BCI-II/</url>
      
        <content type="html"><![CDATA[<h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>ä¸€ä¸ªå…ƒç´ <strong>äº’ä¸ç›¸åŒ</strong>çš„ä¸€ç»´æ•°ç»„ï¼Œè¦æ±‚$O(\log n)$æ‰¾åˆ°ä¸€ä¸ªå³°å€¼ï¼Œå³å¤§äºå·¦å³ä¸¤è¾¹å€¼çš„ä½ç½®ã€‚a[-1]å’Œa[n]å¯è®¤ä¸ºæ˜¯$-\infty$ã€‚</p><p>è€ƒè™‘äºŒåˆ†ç­”æ¡ˆmidï¼Œå¦‚æœa[mid] &gt; a[mid + 1]ï¼Œåœ¨[l, mid - 1]é—´è‚¯å®šå­˜åœ¨ç­”æ¡ˆï¼Œå› ä¸ºå¯ä»¥æŠŠmid + 1è§†ä½œnè¿™ä¸ªè§’è‰²ï¼›åŒç†a[mid] &lt; a[mid + 1]ï¼Œåœ¨[mid + 1, r - 1]é—´è‚¯å®šæœ‰ç­”æ¡ˆã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">find_peak_element</span>(nums: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt;) <span class="punctuation">-&gt;</span> <span class="type">i32</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">n</span> = nums.<span class="title function_ invoke__">len</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">l</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">r</span> = n - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">ans</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> l &lt;= r &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">mid</span> = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">left</span> = <span class="keyword">if</span> mid == <span class="number">0</span> &#123;</span><br><span class="line">                <span class="literal">true</span>   </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                nums[mid] &gt; nums[mid - <span class="number">1</span>]</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">right</span> = <span class="keyword">if</span> mid == n - <span class="number">1</span> &#123;</span><br><span class="line">                <span class="literal">true</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                nums[mid] &gt; nums[mid + <span class="number">1</span>]</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">if</span> left &amp;&amp; right &#123;</span><br><span class="line">                ans = mid;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> left &#123;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> right &#123;</span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans <span class="keyword">as</span> <span class="type">i32</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="II"><a class="header-anchor" href="#II">Â¶</a>II</h2><p>äºŒç»´ç‰ˆæœ¬ï¼Œè¦æ±‚$O(n \log m)$ã€‚æ²¡åšå‡ºæ¥0.0ï¼Œå¥½èœ</p><p>è€ƒè™‘äºŒåˆ†è¡Œmidï¼Œå†è€ƒè™‘è¿™ä¸€è¡Œä¸­çš„æœ€å¤§å€¼a[mid][j]ï¼Œå¦‚æœa[mid][j] &lt; a[mid + 1][j]ï¼Œåˆ™è¡Œ[mid + 1, r - 1]è‚¯å®šæœ‰ç­”æ¡ˆï¼Œå› ä¸ºa[mid + 1][j]å¤§äºmidè¡Œçš„æ‰€æœ‰å…ƒç´ ï¼Œè€Œç”±äºä¸æ–­å¾€æ¯”è‡ªå·±å¤§çš„é‚»å±…ç§»åŠ¨ä¸€å®šèƒ½æ‰¾åˆ°è§£ï¼ŒæŒ‰è¿™ç§æ–¹æ¡ˆä¸€å®šä¸ä¼šç©¿è¶Šmidè¡Œï¼›åŒç†a[mid][j] &lt; a[mid - 1][j]ï¼Œåˆ™è¡Œ[l, mid - 1]è‚¯å®šæœ‰ç­”æ¡ˆã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">find_peak_grid</span>(mat: <span class="type">Vec</span>&lt;<span class="type">Vec</span>&lt;<span class="type">i32</span>&gt;&gt;) <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">l</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">r</span> = mat.<span class="title function_ invoke__">len</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> l &lt;= r &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">mid</span> = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">index</span> = mat[mid].<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>()</span><br><span class="line">            .<span class="title function_ invoke__">max_by</span>(|(_, a), (_, b)| a.<span class="title function_ invoke__">partial_cmp</span>(b).<span class="title function_ invoke__">unwrap_or</span>(std::cmp::Ordering::Equal))</span><br><span class="line">            .<span class="title function_ invoke__">map</span>(|(index, _)| index).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">            <span class="keyword">if</span> mid &gt;= <span class="number">1</span> &amp;&amp; mat[mid][index] &lt; mat[mid - <span class="number">1</span>][index] &#123;</span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> mid + <span class="number">1</span> &lt; mat.<span class="title function_ invoke__">len</span>() &amp;&amp; mat[mid][index] &lt; mat[mid + <span class="number">1</span>][index] &#123;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">vec!</span>[mid <span class="keyword">as</span> <span class="type">i32</span>, index <span class="keyword">as</span> <span class="type">i32</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vec!</span>[]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VSCode</title>
      <link href="/2023/12/21/VSCode/"/>
      <url>/2023/12/21/VSCode/</url>
      
        <content type="html"><![CDATA[<h2 id="å¿«æ·é”®"><a href="#å¿«æ·é”®" class="headerlink" title="å¿«æ·é”®"></a>å¿«æ·é”®</h2><ul><li>Ctrl-Shift-Pï¼šå‘½ä»¤é¢æ¿<ul><li>Develop Reload Windowï¼šé‡æ–°åŠ è½½çª—å£</li></ul></li><li>Altï¼šå¤šå…‰æ ‡</li><li>Ctrlï¼šè·³è½¬</li><li>&lt;-ï¼šè¿”å›</li><li>Ctrl-Fï¼šæœç´¢</li><li>Ctrl-Hï¼šæ›¿æ¢</li><li>Ctrl-/ï¼šå•è¡Œæ³¨é‡Š</li><li>Alt-Shift-Aï¼šå¤šè¡Œæ³¨é‡Š</li><li>Ctrl-`ï¼šåˆ‡æ¢ç»ˆç«¯æ˜¾ç¤º</li><li>Ctrl-=/-ï¼šæ”¾å¤§/ç¼©å°</li><li>Ctrl-,ï¼šæ‰“å¼€è®¾ç½®</li><li>é¼ æ ‡åŒå‡»ï¼šé«˜äº®å½“å‰å˜é‡</li></ul><p>font size = 13</p><h2 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h2><ul><li>Error Lens</li><li>Eva Themeï¼šEva Light Bold</li><li>Remote</li><li>Dev Containers</li><li>Material Icon Theme</li><li>Output Colorizerï¼šé«˜äº®æ—¥å¿—æ–‡æœ¬</li><li>Project Manager</li><li>TODO Highlight</li><li>WSL</li><li>Docker<ul><li>éœ€è¦è®©érootç”¨æˆ·ä¸ç”¨sudoæ‰§è¡Œdockerå‘½ä»¤</li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo groupadd docker</span><br><span class="line">sudo gpasswd -a <span class="variable">$&#123;USER&#125;</span> docker</span><br><span class="line">sudo systemctl restart docker</span><br><span class="line">sudo <span class="built_in">chmod</span> a+rw /var/run/docker.sock</span><br></pre></td></tr></table></figure><ul><li>Clang-Format</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clang-format off</span></span><br><span class="line"><span class="keyword">this</span> code is <span class="keyword">not</span> formatted</span><br><span class="line"><span class="comment">// clang-format on</span></span><br></pre></td></tr></table></figure><ul><li>clangd or C/C++<ul><li>clangdéœ€è¦<code>compile_commands.json</code>æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡<code>CMake</code>è‡ªåŠ¨ç”Ÿæˆï¼Œæˆ–è€…é€šè¿‡<code>bear make</code></li><li>C/C++éœ€è¦åœ¨<code>c_cpp_properties.json</code>ä¸­è®¾ç½®ç¼–è¯‘æŒ‡ä»¤ï¼Œä¸»è¦æ˜¯æœ‰æ—¶å€™éœ€è¦è®¾ç½®<code>-I</code>ä»¥é¿å…æ‰¾ä¸åˆ°å¤´æ–‡ä»¶</li></ul></li><li>cpplint<ul><li>æ³¨æ„è®¾ç½®Cpplintçš„è·¯å¾„</li></ul></li><li>CMake</li><li>XMake</li><li>Color Highlight</li><li>CommentAnchors</li><li>Cpp Referenceï¼šctrl+shift+Aæœç´¢</li><li>Doxygen Documentation</li><li>EditorConfig for VS Code</li><li>filesize</li><li>Git History</li><li>GitLens</li><li>GitHub Markdown Preview</li><li>Image preview</li><li>JSON</li><li>Live Server</li><li>Makefile Tools</li><li>Path Intellisense</li><li>Rainbow CSV</li><li>Syntax Highlighter</li><li>Trailing Spaces</li><li>YAML</li><li>Code Spell Checker</li><li>Hex Editor</li><li>Shell Check</li><li>Markdown Lint</li><li>Local History</li><li>Regex Previewer</li><li>Codelf<ul><li>æœç´¢ä¸€ä¸ªå˜é‡ååœ¨å„ç§é¡¹ç›®ä¸­çš„ä½¿ç”¨æƒ…å†µ</li></ul></li></ul><h2 id="è®¾ç½®"><a href="#è®¾ç½®" class="headerlink" title="è®¾ç½®"></a>è®¾ç½®</h2><p>å…³é—­<code>Security&gt;Workspace&gt;Trust:Enabled</code></p><p><code>Editor: Font Family</code>è®¾ç½®ä¸º<code>FiraCode Nerd Font</code></p><p>æ‰“å¼€<code>Editor&gt;Guides: Bracket Pairs</code></p><p>æ‰“å¼€<code>Editor: Cursor Smooth Caret Animation</code>ã€<code>Editor: Smooth Scrolling</code>ã€<code>Terminal&gt;intergrated: Smooth Scrolling</code></p><p><code>Editor: Cursor Blinking</code>è®¾ç½®ä¸º<code>smooth</code></p><p>æ‰“å¼€<code>Editor&gt;Suggest: Preview</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ConanåŒ…ç®¡ç†</title>
      <link href="/2023/12/13/Conan%E5%8C%85%E7%AE%A1%E7%90%86/"/>
      <url>/2023/12/13/Conan%E5%8C%85%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç³»ç»Ÿç¼–ç¨‹</title>
      <link href="/2023/12/01/Linux%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/"/>
      <url>/2023/12/01/Linux%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>cppç¬”è®°</title>
      <link href="/2023/12/01/cpp%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/12/01/cpp%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="std-ref"><a class="header-anchor" href="#std-ref">Â¶</a>std::ref</h2><p>åœ¨ä¼ å‚æ—¶é»˜è®¤æ˜¯æ‹·è´ï¼Œé€šè¿‡æ·»åŠ <code>std::ref</code>æ¥ä½¿ç”¨å¼•ç”¨ã€‚è¿™åœ¨<code>std::bind</code>ã€<code>std::thread</code>ä»¥åŠæ¨¡æ¿ï¼ˆ<code>std::make_pair</code>ã€<code>std::make_tuple</code>ï¼‰ç­‰é—´æ¥è¿›è¡Œå‡½æ•°è°ƒç”¨çš„åœ°æ–¹æœ‰ç”¨ã€‚</p><h2 id="std-reference-wrapper"><a class="header-anchor" href="#std-reference-wrapper">Â¶</a>std::reference_wrapper</h2><p><code>std::ref</code>äº§ç”Ÿçš„å°±æ˜¯ä¸€ä¸ªåŒ…å«å¼•ç”¨çš„<code>std::reference_wrapper</code>çš„å¯¹è±¡ã€‚ä»è€Œèƒ½å¤Ÿå£°æ˜ä¸€ä¸ªå¼•ç”¨æ•°ç»„ã€‚</p><p><code>reference_wrapper&lt;int&gt; arr[] &#123;x,y,z&#125;;</code></p><h2 id="this-nullptr"><a class="header-anchor" href="#this-nullptr">Â¶</a>this = nullptr</h2><p>è¿™é‡Œç±»å‡½æ•°ä¸­æ²¡æœ‰ä½¿ç”¨ä»»ä½•ç±»æˆå‘˜å’Œç±»å‡½æ•°ï¼Œä¹Ÿå³ä¸thisçš„å–å€¼æ— å…³ï¼Œé€šå¸¸ä¼šæ­£å¸¸è¿è¡Œï¼Œä½†è¿™ä»ç„¶æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</p><p>ç¼–è¯‘å™¨å…¶å®ä¼šå°†ç±»å‡½æ•°<code>ABC::print()</code>è½¬åŒ–ä¸ºä¸€ä¸ªå…¨å±€çš„å‡½æ•°<code>void _ABC_print(ABC *this)</code>ã€‚</p><p>ç¼–è¯‘å™¨ä¼˜åŒ–ä¼šå‡è®¾ç¨‹åºä¸åŒ…å«UBï¼Œå› æ­¤ä¼šå‡è®¾<code>this != nullptr</code>ï¼Œä»è€Œè¿›è¡ŒæŸäº›ä¼˜åŒ–ï¼Œå¯¼è‡´ä¸ç¬¦åˆé¢„æœŸã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ABC</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">        <span class="type">int</span> a;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;cout&lt;&lt;<span class="string">&quot;hello&quot;</span>&lt;&lt;endl;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ABC *ptr = <span class="literal">NULL</span>:</span><br><span class="line">        ptr-&gt;<span class="built_in">print</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>delete this</code>æ˜¯åˆæ³•çš„ï¼Œåªè¦è¯¥å¯¹è±¡æ—¶åŠ¨æ€åˆ†é…çš„ï¼Œå¹¶ä¸”ä¹‹åä¸å†ä½¿ç”¨</p><h2 id="ä¸¥æ ¼åˆ«å"><a class="header-anchor" href="#ä¸¥æ ¼åˆ«å">Â¶</a>ä¸¥æ ¼åˆ«å</h2><p><code>-fstrict-aliasing</code></p><p>ä¸¥æ ¼åˆ«åè§„åˆ™æŒ‡ç¼–è¯‘å™¨åœ¨çœ‹åˆ°å¤šä¸ªåˆ«åæ—¶ï¼Œå¦‚æœå®ƒä»¬ä¸æ»¡è¶³ä¸¥æ ¼åˆ«åè¦æ±‚ï¼Œå°±è®¤ä¸ºå®ƒä»¬æŒ‡å‘ä¸åŒçš„å†…å­˜åŒºåŸŸï¼Œä»è€Œè¿›è¡Œä¼˜åŒ–ï¼Œå¯¼è‡´äº§ç”Ÿä¸æˆ‘ä»¬é¢„æœŸä¸ç¬¦çš„ä»£ç ã€‚</p><p>ä¸¥æ ¼åˆ«åè¦æ±‚ï¼ˆè¿™æ˜¯Cè¯­è¨€çš„å®šä¹‰ï¼Œç›¸å¯¹ç®€å•ä¸€äº›ï¼‰ï¼šå¯¹è±¡çš„å€¼åªèƒ½é€šè¿‡ä¸è¯¥å¯¹è±¡ç±»å‹ï¼ˆ1ï¼‰å…¼å®¹çš„ç±»å‹åŠå…¶CVé™å®šã€ï¼ˆ2ï¼‰æœ‰æ— ç¬¦å·ç‰ˆæœ¬åŠå…¶CVé™å®šã€ï¼ˆ3ï¼‰æˆå‘˜ä¸­æœ‰è¯¥ç±»å‹çš„unionå’Œèšåˆç»“æ„ä½“ã€ï¼ˆ4ï¼‰å­—ç¬¦ç±»å‹è®¿é—®ã€‚</p><p>è¿™é‡Œçš„ç±»å‹å…¼å®¹æ˜¯Cè¯­è¨€çš„æ¦‚å¿µï¼Œ å°±æ˜¯è€ƒè™‘typedefï¼Œæ•°ç»„é€€åŒ–æŒ‡é’ˆåç±»å‹éœ€è¦ä¸€è‡´ã€‚</p><p><code>restrict</code>æ˜¯Cè¯­è¨€çš„ä¸€ä¸ªå…³é”®å­—ï¼Œè¡¨æ˜ä¸¤ä¸ªæŒ‡é’ˆä¸ä¼šæŒ‡å‘ç›¸åŒåŒºåŸŸï¼Œä½†C++æ²¡æœ‰è¿™ä¸ªå…³é”®å­—ã€‚C++å¯ä»¥ä½¿ç”¨<code>__restrict</code>ã€‚</p><p>æ­£å› ä¸ºè¿™ä¸ªï¼Œ<code>reinterpret_cast&lt;double*&gt;(char*)</code>åœ¨æ ‡å‡†ä¸­å…¶å®æ˜¯æœªå®šä¹‰çš„ï¼Œä½†å½“å‰çš„ç¼–è¯‘å™¨éƒ½ä¿è¯ç”Ÿæˆçš„ä»£ç æ˜¯æ­£ç¡®çš„ã€‚æ ‡å‡†åšæ³•åˆ™åªèƒ½ç”¨memcpyæ¥è¿›è¡Œï¼Œæ‰€ä»¥C++20å¼•å…¥äº†constexprçš„<code>byte_cast</code>ã€‚</p><p>åŒæ ·åœ°ï¼ŒCè¯­è¨€çš„å®<code>offset</code>åœ¨C++é‡Œå…¶å®ä¹Ÿæ˜¯ä¸ªæœªå®šä¹‰è¡Œä¸ºã€‚</p><p><code>static_cast</code>å¯¹æŒ‡é’ˆç±»å‹çš„è½¬æ¢æ˜¯å¾ˆä¸¥æ ¼çš„ï¼Œåªèƒ½æ˜¯ç›¸åŒç±»å‹çš„CVé™å®šã€‚</p><p><a data-fancybox="gallery" data-src="/post-images/cpp-argument-passing.png" data-caption="cpp-argument-passing"><img src="/post-images/cpp-argument-passing.png" alt="cpp-argument-passing"></a></p><p><a data-fancybox="gallery" data-src="/post-images/cpp-argument-passing.png" data-caption="cpp-performace"><img src="/post-images/cpp-argument-passing.png" alt="cpp-performace"></a></p><h2 id="åˆå§‹åŒ–åˆ—è¡¨æ‹·è´"><a class="header-anchor" href="#åˆå§‹åŒ–åˆ—è¡¨æ‹·è´">Â¶</a>åˆå§‹åŒ–åˆ—è¡¨æ‹·è´</h2><p>std::initializer_list may be implemented as a pair of pointers or pointer and length.Copying a std::initializer_list does not copy the backing array of the corresponding initializer list.</p><p>æ³¨æ„åˆå§‹åŒ–åˆ—è¡¨çš„æ‹·è´æ˜¯æµ…æ‹·è´ï¼Œå¯ä»¥æŠŠå®ƒå½“åšæ˜¯æ•°ç»„ä¸Šçš„è§†å›¾ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">f</span><span class="params">(Args... args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> list = &#123;args...&#125;;</span><br><span class="line">    <span class="keyword">return</span> list; <span class="comment">// è¿™é‡Œè¿”å›åˆå§‹åŒ–åˆ—è¡¨ä½¿æœ‰é—®é¢˜çš„ï¼Œç”Ÿå‘½å‘¨æœŸé”™è¯¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¼ªææ„å‡½æ•°"><a class="header-anchor" href="#ä¼ªææ„å‡½æ•°">Â¶</a>ä¼ªææ„å‡½æ•°</h2><p>ç”±äºä¼ªææ„å‡½æ•°ï¼Œæ‰€æœ‰æ ‡é‡ç±»å‹éƒ½æ»¡è¶³å¯ææ„è¦æ±‚ï¼Œæ•°ç»„å’Œå¼•ç”¨ç±»å‹åˆ™ä¸æ»¡è¶³ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">concept</span> is_destruct = <span class="built_in">requires</span>(T v) &#123; v.~<span class="built_in">T</span>(); &#125;;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥ä¸éœ€è¦è€ƒè™‘ç»™å®šç±»å‹æ˜¯å¦çœŸçš„æœ‰ææ„å‡½æ•°ã€‚å½“ç„¶ï¼Œå³ä½¿æ˜¯ä¼ªææ„å‡½æ•°ï¼Œè°ƒç”¨åè¯¥å˜é‡çš„ç”Ÿå‘½å‘¨æœŸç†è®ºä¸Šåº”è¯¥æ˜¯ç»“æŸäº†ï¼Œæ‰€ä»¥åç»­å¯¹å…¶çš„æ“ä½œå‡æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>deferè¯­å¥</title>
      <link href="/2023/11/30/defer%E8%AF%AD%E5%8F%A5/"/>
      <url>/2023/11/30/defer%E8%AF%AD%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<p>GOå’ŒZigéƒ½è‡ªå¸¦äº†<code>defer</code>è¯­å¥ï¼Œåœ¨æ¶‰åŠåˆ°èµ„æºç®¡ç†æ—¶ï¼Œå¯ä»¥åœ¨ä¸‹ä¸€è¡Œç«‹å³åŠ ä¸Šå¯¹åº”çš„<code>defer é‡Šæ”¾èµ„æº</code>è¯­å¥ã€‚è¿™æ ·åœ¨æ¯æ¬¡<strong>returnå</strong>éƒ½ä¼šåå‘è°ƒç”¨å„ä¸ª<code>defer</code></p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>è¦åœ¨Cè¯­è¨€é‡Œå®ç°deferï¼Œåªèƒ½é€šè¿‡<code>setjmp</code>æˆ–è€…<code>goto</code>è¿™ç§è·³è½¬ï¼Œå¹¶ä¸”åªèƒ½åœ¨<strong>returnå‰</strong>è¿›è¡Œã€‚</p><h2 id="C-s2"><a class="header-anchor" href="#C-s2">Â¶</a>C++</h2><p>å¯ä»¥ç”¨<code>std::unique_ptr</code>åŒ…è£…èµ„æºï¼Œéœ€è¦è‡ªè¡Œå®ç°<code>deleter</code>ã€‚</p><p><code>defer</code>æˆ–<a href="https://github.com/Neargye/scope_guard/blob/master/include/scope_guard.hpp"><code>scope_exit</code></a>çš„å®ç°å°±æ˜¯åˆ©ç”¨RAIIï¼Œåœ¨å½“å‰ä½ç½®åˆ›å»ºä¸€ä¸ªç±»ï¼Œææ„çš„æ—¶å€™æ‰§è¡Œã€‚</p><p><code>SCOPE_EXIT&#123; file.close(); &#125;;</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ThreadPool</title>
      <link href="/2023/11/22/ThreadPool/"/>
      <url>/2023/11/22/ThreadPool/</url>
      
        <content type="html"><![CDATA[<blockquote><p>A thread pool maintains multiple threads waiting for tasks to be allocated for concurrent execution by the supervising program.<br>By maintaining a pool of threads, the model increases performance and avoids latency in execution due to frequent creation and destruction of threads for short-lived tasks.</p></blockquote><p><img src="/post-images/threadpool.png" alt="thread-pool"></p><p>é€šè¿‡æå‰åˆ›å»ºå¥½è‹¥å¹²ä¸ªçº¿ç¨‹ï¼Œç„¶åå°†è¿™äº›çº¿ç¨‹ç»Ÿä¸€ç®¡ç†ï¼Œæ”¾åœ¨ä¸€ä¸ªå®¹å™¨ä¸­ã€‚<br>å½“æœ‰å¼‚æ­¥ä»»åŠ¡éœ€è¦æ‰§è¡Œçš„æ—¶å€™ï¼Œä»è¯¥å®¹å™¨ä¸­å–å¾—ç©ºé—²ï¼ˆå½“å‰ä¸å¤„äºæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„çŠ¶æ€ï¼‰çš„çº¿ç¨‹ï¼Œ<br>å°†è¿™ä¸ªå¼‚æ­¥ä»»åŠ¡äº¤ç»™è¿™ä¸ªçº¿ç¨‹ï¼ˆå”¤é†’ï¼‰è¿›è¡Œå¤„ç†ã€‚<br>å½“è¿™ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆä¹‹åï¼Œè¯¥çº¿ç¨‹ä¸è¿›è¡Œé”€æ¯ï¼Œé‡æ–°å›åˆ°ç©ºé—²çŠ¶æ€ï¼ˆé˜»å¡ï¼‰ï¼Œç­‰å¾…æ–°çš„ä»»åŠ¡åˆ°æ¥ã€‚</p><p>é¿å…äº†çº¿ç¨‹é¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚</p><h2 id="progschj-ThreadPool"><a href="#progschj-ThreadPool" class="headerlink" title="progschj/ThreadPool"></a><a href="https://github.com/progschj/ThreadPool">progschj/ThreadPool</a></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadPool</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ThreadPool</span>(<span class="type">size_t</span>);</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> F, <span class="keyword">class</span>... Args&gt;</span></span><br><span class="line"><span class="function">    <span class="keyword">auto</span> <span class="title">enqueue</span><span class="params">(F&amp;&amp; f, Args&amp;&amp;... args)</span> </span></span><br><span class="line"><span class="function">        -&gt; std::future&lt;<span class="keyword">typename</span> std::result_of&lt;<span class="title">F</span><span class="params">(Args...)</span>&gt;::type&gt;</span>;</span><br><span class="line">    ~<span class="built_in">ThreadPool</span>();</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// need to keep track of threads so we can join them</span></span><br><span class="line">    std::vector&lt; std::thread &gt; workers;</span><br><span class="line">    <span class="comment">// the task queue</span></span><br><span class="line">    std::queue&lt; std::function&lt;<span class="type">void</span>()&gt; &gt; tasks; <span class="comment">// ç»Ÿä¸€ä¸ºæ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•°</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// synchronization</span></span><br><span class="line">    std::mutex queue_mutex;</span><br><span class="line">    std::condition_variable condition;</span><br><span class="line">    <span class="type">bool</span> stop;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// the constructor just launches some amount of workers</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="title">ThreadPool::ThreadPool</span><span class="params">(<span class="type">size_t</span> threads)</span></span></span><br><span class="line"><span class="function">    :   stop(false)</span></span><br><span class="line"><span class="function">&#123;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">size_t</span> i = <span class="number">0</span>;i&lt;threads;++i)</span><br><span class="line">        workers.<span class="built_in">emplace_back</span>(</span><br><span class="line">            [<span class="keyword">this</span>]</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(;;)</span><br><span class="line">                &#123;</span><br><span class="line">                    std::function&lt;<span class="built_in">void</span>()&gt; task;</span><br><span class="line"></span><br><span class="line">                    &#123;</span><br><span class="line">                        std::unique_lock&lt;std::mutex&gt; <span class="built_in">lock</span>(<span class="keyword">this</span>-&gt;queue_mutex);</span><br><span class="line">                        <span class="keyword">this</span>-&gt;condition.<span class="built_in">wait</span>(lock,</span><br><span class="line">                            [<span class="keyword">this</span>]&#123; <span class="keyword">return</span> <span class="keyword">this</span>-&gt;stop || !<span class="keyword">this</span>-&gt;tasks.<span class="built_in">empty</span>(); &#125;);</span><br><span class="line">                        <span class="comment">// ç­‰ä»·äºï¼Œstd::waitä¼šæ£€æŸ¥å¹¶é¿å…å‡é†’æƒ…å†µ</span></span><br><span class="line">                        <span class="comment">// while (!stop_waiting()) &#123;</span></span><br><span class="line">                        <span class="comment">//     wait(lock);</span></span><br><span class="line">                        <span class="comment">// &#125;</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="keyword">this</span>-&gt;stop &amp;&amp; <span class="keyword">this</span>-&gt;tasks.<span class="built_in">empty</span>())</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        task = std::<span class="built_in">move</span>(<span class="keyword">this</span>-&gt;tasks.<span class="built_in">front</span>());</span><br><span class="line">                        <span class="keyword">this</span>-&gt;tasks.<span class="built_in">pop</span>();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">task</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// add new work item to the pool</span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> F, <span class="keyword">class</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">ThreadPool::enqueue</span><span class="params">(F&amp;&amp; f, Args&amp;&amp;... args)</span> </span></span><br><span class="line"><span class="function">    -&gt; std::future&lt;<span class="keyword">typename</span> std::result_of&lt;<span class="title">F</span><span class="params">(Args...)</span>&gt;::type&gt;</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> return_type = <span class="keyword">typename</span> std::result_of&lt;<span class="built_in">F</span>(Args...)&gt;::type;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> task = std::make_shared&lt; std::packaged_task&lt;<span class="built_in">return_type</span>()&gt; &gt;( <span class="comment">// è¿™é‡Œä½¿ç”¨shared_ptråº”è¯¥æ˜¯ä¸ºäº†ä¿æ´»ï¼Œå¦åˆ™emplaceåˆ°tasksä¸­çš„lambdaè¿˜æ²¡æ‰§è¡Œï¼Œæ•è·çš„taskåœ°å€å°±è¢«ææ„è°ƒç”¨äº†</span></span><br><span class="line">                                                                       <span class="comment">// è€Œå¦‚æœç”¨æ‹·è´çš„è¯ï¼Œåˆä¸æ˜¯å¯¹åº”å‰é¢æå‰å–åˆ°çš„futrueäº†</span></span><br><span class="line">                                                                       <span class="comment">// æ­¤å¤–ï¼Œshared_ptrçš„åŒ…è£…ä½¿å¾—packaged_taskå¯ä»¥è¢«æ‹·è´å’Œç§»åŠ¨</span></span><br><span class="line">                                                                       <span class="comment">// packaged_taskæœ¬èº«æ˜¯ä¸å¯æ‹·è´ï¼Œåªèƒ½ç§»åŠ¨çš„ï¼Œä½†æ˜¯std::functionåˆåªèƒ½æ¥æ”¶å¯æ‹·è´çš„lambda</span></span><br><span class="line">            std::<span class="built_in">bind</span>(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...)</span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">    std::future&lt;return_type&gt; res = task-&gt;<span class="built_in">get_future</span>();</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(queue_mutex)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// don&#x27;t allow enqueueing after stopping the pool</span></span><br><span class="line">        <span class="keyword">if</span>(stop)</span><br><span class="line">            <span class="keyword">throw</span> std::<span class="built_in">runtime_error</span>(<span class="string">&quot;enqueue on stopped ThreadPool&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// packaged_taskå†…éƒ¨æœ‰ä¸€ä¸ªstd::promiseï¼Œåœ¨æ‰§è¡Œå®ŒåŒ…è£…çš„taskåä¼šè°ƒç”¨promiseçš„set_valueï¼Œä»è€Œfutureå¯ä»¥é€šè¿‡getæ‹¿åˆ°ç»“æœ</span></span><br><span class="line">        tasks.<span class="built_in">emplace</span>([task]()&#123; (*task)(); &#125;); <span class="comment">// é¢å¤–ç”¨ä¸€ä¸ªlambdaåŒ…è£…æˆæ— è¿”å›å€¼çš„</span></span><br><span class="line">    &#125;</span><br><span class="line">    condition.<span class="built_in">notify_one</span>();</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// the destructor joins all threads</span></span><br><span class="line"><span class="keyword">inline</span> ThreadPool::~<span class="built_in">ThreadPool</span>()</span><br><span class="line">&#123;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(queue_mutex)</span></span>;</span><br><span class="line">        stop = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    condition.<span class="built_in">notify_all</span>();</span><br><span class="line">    <span class="keyword">for</span>(std::thread &amp;worker: workers)</span><br><span class="line">        worker.<span class="built_in">join</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦ä¸€ä¸ªç±»ä¼¼çš„C++ç‰ˆæœ¬ï¼š<a href="https://github.com/mtrebi/thread-pool">https://github.com/mtrebi/thread-pool</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“ˆå¸Œ</title>
      <link href="/2023/11/22/%E5%93%88%E5%B8%8C/"/>
      <url>/2023/11/22/%E5%93%88%E5%B8%8C/</url>
      
        <content type="html"><![CDATA[<p>$O(1)$å•ç‚¹æ’å…¥ã€åˆ é™¤ã€æŸ¥è¯¢ã€‚åœ¨æ•°æ®åº“é‡Œä¸»è¦ç”¨åœ¨<code>join</code>å’Œ<code>group by</code>ä¸­ã€‚</p><h2 id="é™æ€å“ˆå¸Œè¡¨"><a class="header-anchor" href="#é™æ€å“ˆå¸Œè¡¨">Â¶</a>é™æ€å“ˆå¸Œè¡¨</h2><p><a href="https://martin.ankerl.com/2022/08/27/hashmap-bench-01/">benchmark1</a></p><p><a href="https://martin.ankerl.com/2019/04/01/hashmap-benchmarks-01-overview/">benchmark2</a></p><p>æœ‰äº›å“ˆå¸Œè¡¨æ˜¯ä¸ç¨³å®šçš„ï¼ˆ<code>flat_map</code>ï¼‰ï¼Œå­˜å‚¨åœ¨å…¶ä¸­çš„valueçš„åœ°å€å¯èƒ½å› ä¸ºæ’å…¥å’Œåˆ é™¤è€Œå¤±æ•ˆï¼ˆå› ä¸ºå‘ç”Ÿäº†rehashï¼‰ã€‚ç¨³å®šçš„æ–¹æ³•é€šå¸¸éœ€è¦é€šè¿‡é—´æ¥å¯»å€ï¼ˆ<code>node_map</code>ï¼‰ã€‚</p><p><code>node_map</code>å’Œ<code>flat_map</code>çš„åŒºåˆ«æ˜¯<code>flat_map</code>å°†valueç›´æ¥å­˜åˆ°æ•°ç»„ä¸­ï¼Œå› æ­¤åœ¨rehashæ—¶åœ°å€ä¼šæ”¹å˜ï¼Œè€Œ<code>node_map</code>å°†valueå­˜åœ¨å¦ä¸€ä¸ªä¿æŒä¸å˜çš„æ•°ç»„ä¸­ï¼Œå…¶ä¼˜ç‚¹æ˜¯æä¾›äº†ç¨³å®šæ€§ï¼Œå¹¶ä¸”å¯ä»¥å­˜å‚¨ä¸å¯ç§»åŠ¨æˆ–ä¸å¯å¤åˆ¶çš„å…ƒç´ ï¼Œå¹¶ä¸”ä¹Ÿæ›´é€‚åˆå¤§valueå¯¹è±¡ï¼ˆå› ä¸ºæŠŠå¤§å¯¹è±¡ç›´æ¥å­˜åˆ°æ•°ç»„ä¸­ä¼šç ´åcacheï¼‰ï¼Œä½†ä¹Ÿå¯¼è‡´äº†é¢å¤–å¼€é”€ã€‚</p><p>å…³é”®ç‚¹ï¼šå“ˆå¸Œå‡½æ•°ã€å†²çªè§£å†³æ–¹æ³•ã€‚</p><p>MurmurHashã€Facebook XXHash</p><h3 id="å¼€æ”¾å¯»å€"><a class="header-anchor" href="#å¼€æ”¾å¯»å€">Â¶</a>å¼€æ”¾å¯»å€</h3><ul><li>çº¿æ€§æ¢æµ‹ï¼šå¦‚æœæ˜ å°„ä½ç½®å·²ç»è¢«å ç”¨ï¼Œå°±æ£€æŸ¥ç´§æ¥ç€çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œä¸æ–­é‡å¤</li><li>äºŒæ¬¡æ¢æµ‹ï¼šå¦‚æœè¢«å ç”¨ï¼Œåˆ™æ£€æŸ¥+1^2, -1^2, +2^2, -2^2â€¦</li></ul><p>åˆ é™¤çš„æ—¶å€™ä¸€ç§æ˜¯æ‰€æœ‰å…ƒç´ éƒ½é‡hashï¼Œå¦ä¸€ç§æ˜¯ç”¨tombstomeæ ‡è®°ã€‚</p><h3 id="å¸ƒè°·é¸Ÿå“ˆå¸Œ"><a class="header-anchor" href="#å¸ƒè°·é¸Ÿå“ˆå¸Œ">Â¶</a>å¸ƒè°·é¸Ÿå“ˆå¸Œ</h3><p>å¸ƒè°·é¸Ÿåœ¨å­µåŒ–æ—¶ä¼šå°†ä¸€äº›è›‹/å¹¼é¸Ÿæ¨å‡ºå·¢å¤–ï¼Œå¸ƒè°·é¸Ÿå“ˆå¸Œåœ¨æ’å…¥æ–°keyæ—¶ï¼Œå¯èƒ½æŠŠæ—§keyç§»åŠ¨åˆ°å…¶å®ƒä½ç½®ã€‚</p><p>é€šç”¨çš„è®²ï¼šå¸ƒè°·é¸Ÿå“ˆå¸Œä½¿ç”¨nä¸ªå“ˆå¸Œå‡½æ•°ï¼Œç„¶åå°†keyæ’å…¥åˆ°å…¶ä¸­ç¬¬ä¸€ä¸ªç©ºé—²çš„å“ˆå¸Œä½ç½®ï¼Œå¦‚æœéƒ½éç©ºï¼Œå°±é€‰æ‹©è¸¢æ‰ä¸€ä¸ªå†²çªçš„keyï¼Œå¹¶é‡æ–°æ’å…¥è¿™ä¸ªå†²çªçš„keyã€‚</p><p>è¿™é‡Œä»‹ç»ä½¿ç”¨ä¸¤ä¸ªå“ˆå¸Œè¡¨$T_1$å’Œ$T_2$ï¼Œä»¥åŠä¸¤ä¸ªå“ˆå¸Œå‡½æ•°$h_1$å’Œ$h_2$çš„ç‰ˆæœ¬ã€‚</p><h4 id="æŸ¥æ‰¾"><a class="header-anchor" href="#æŸ¥æ‰¾">Â¶</a>æŸ¥æ‰¾</h4><p>æŸ¥æ‰¾$T_1[h_1(x)]$å’Œ$T_2[h_2(x)]$å³å¯ã€‚</p><h4 id="åˆ é™¤"><a class="header-anchor" href="#åˆ é™¤">Â¶</a>åˆ é™¤</h4><p>åŒç†ã€‚</p><h4 id="æ’å…¥"><a class="header-anchor" href="#æ’å…¥">Â¶</a>æ’å…¥</h4><p>å¦‚æœ$T_1[h_1(x)]$ä¸ºç©ºï¼Œå°±æ’å…¥ï¼›å¦åˆ™æ›¿æ¢ä¸º$x$ï¼ˆè¸¢æ‰æ—§å€¼$xâ€™$ï¼‰ï¼Œå¹¶å°†åŸæœ‰çš„$xâ€™$æ’å…¥åˆ°$T_2$ï¼Œä¸æ–­é‡å¤è‡³å¤šMAX_LOOPæ¬¡ï¼ˆè¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿæ­»å¾ªç¯ï¼‰ã€‚è¶…è¿‡å›ºå®šé˜ˆå€¼ï¼Œå°±æ‰©å±•ä¸¤ä¸ªå“ˆå¸Œè¡¨ï¼Œè¿›è¡Œé‡å“ˆå¸Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">insert</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> lookup(x):</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(MAX_LOOP):</span><br><span class="line">        <span class="keyword">if</span> T1[h1(x)] <span class="keyword">is</span> empty:</span><br><span class="line">            T1[h1(x)] = x</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        swap(x, T1[h1(x)])</span><br><span class="line">        <span class="keyword">if</span> T2[h2(x)] <span class="keyword">is</span> empty:</span><br><span class="line">            T2[h2(x)] = x</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        swap(x, T2[h2(x)])</span><br><span class="line">    rehash()</span><br><span class="line">    insert(x)</span><br></pre></td></tr></table></figure><p>å¦‚æœå°†$T_1[h_1(x)]$å’Œ$T_2[h_2(x)]$çœ‹ä½œä¸€æ¡è¾¹ï¼Œå°±æ„æˆä¸€å¼ å›¾ã€‚</p><p>å…¶ä¼˜ç‚¹æ˜¯æœ€åå¤æ‚åº¦æœ‰ä¿è¯ï¼Œå¹¶ä¸”æŸ¥æ‰¾è¿‡ç¨‹å¯ä»¥å®Œå…¨å‘é‡åŒ–ï¼Œé€‚ç”¨äºå¤§é‡å•ç‚¹æŸ¥è¯¢çš„åœºæ™¯ã€‚</p><p>å…¶ç¼ºç‚¹æ˜¯ç¼“å­˜ä¸å‹å¥½ã€‚rocksdbçš„ä¸€ä¸ªä¼˜åŒ–æ–¹æ¡ˆæ˜¯åœ¨æŸä¸ªå“ˆå¸Œæ˜ å°„å†²çªæ—¶ï¼Œè¿›ä¸€æ­¥å°è¯•è¿ç»­çš„è‹¥å¹²ä½ç½®ï¼ˆ+1,+2,â€¦ï¼‰ï¼Œè¿™è¢«ç§°ä½œå¸ƒè°·é¸Ÿå—ï¼Œè¿™æ ·å¯ä»¥é€šè¿‡é¢„å–è¿™ä¸ªå—æ¥åŠ é€Ÿï¼ˆ85%çš„keyéƒ½åœ¨ç¬¬ä¸€ä¸ªå¸ƒè°·é¸Ÿå—ä¸­ï¼‰ã€‚</p><h4 id="å¸ƒè°·é¸Ÿè¿‡æ»¤å™¨"><a class="header-anchor" href="#å¸ƒè°·é¸Ÿè¿‡æ»¤å™¨">Â¶</a>å¸ƒè°·é¸Ÿè¿‡æ»¤å™¨</h4><p>ç›¸æ¯”äºå¸ƒéš†è¿‡æ»¤å™¨ï¼Œèƒ½å¤Ÿæ”¯æŒåˆ é™¤æ“ä½œã€‚</p><h3 id="std-unordered-map"><a class="header-anchor" href="#std-unordered-map">Â¶</a>std::unordered_map</h3><p>ä½¿ç”¨æ‹‰é“¾æ³•å®ç°ï¼Œæœ‰å¤šä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚<code>max_load_factor</code>æ˜¯å…ƒç´ ä¸ªæ•°é™¤ä»¥æ¡¶ä¸ªæ•°çš„ä¸Šé™ï¼ˆé»˜è®¤ä¸º1ï¼‰ï¼Œå½“è¶…è¿‡è¿™ä¸ªä¸Šé™æ—¶ï¼Œè¯´æ˜æ¡¶çš„ä¸ªæ•°è¿‡å°‘äº†ï¼Œå°±ä¼šå°†<code>bucket_size</code>æ‰©å¤§2å€ï¼Œç„¶åé‡æ–°è¿›è¡Œhashã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">unordered_map</span> &#123;</span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    list&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; *buckets;</span><br><span class="line">    <span class="type">int</span> bucket_size;</span><br><span class="line">    <span class="type">int</span> total_elements;</span><br><span class="line">    <span class="type">float</span> max_load_factor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§å®ç°æ–¹å¼æ˜¯å¾ˆæ…¢çš„ï¼Œå› ä¸ºæ•°æ®å±€éƒ¨æ€§å¾ˆå·®ï¼Œcacheä¸å‹å¥½ã€‚ä½†å› ä¸ºC++æ ‡å‡†è§„å®šåœ¨æ’å…¥æˆ–åˆ é™¤å…ƒç´ æ—¶å…¶ä»–å…ƒç´ å¿…é¡»æœ‰æ•ˆï¼Œå› æ­¤é€‰æ‹©äº†æ‹‰é“¾æ³•ï¼Œä½†æ›´ç°ä»£çš„hashmapé€šå¸¸é‡‡ç”¨çº¿æ€§æ¢æµ‹æˆ–å…¶å˜ç§ã€‚</p><h3 id="robin-hood-unordered-flat-map"><a class="header-anchor" href="#robin-hood-unordered-flat-map">Â¶</a>robin_hood::unordered_flat_map</h3><p>robin hoodæ˜¯çº¿æ€§æ¢æµ‹çš„å˜ç§ã€‚é€šè¿‡åŠ«å¯Œæµè´«æ¥ä¼˜åŒ–æ¯ä¸ªå…ƒç´ çš„å®é™…ä½ç½®ä¸å…¶å“ˆå¸Œä½ç½®çš„è·ç¦»ã€‚åœ¨æ’å…¥æ—¶ï¼Œå¦‚æœå½“å‰å…ƒç´ çš„è·ç¦»å·²ç»æ¯”å ç”¨å…ƒç´ çš„è·ç¦»å¤§ï¼ˆå ç”¨å…ƒç´ æ›´å¯Œæœ‰ï¼‰ï¼Œé‚£å°±å–ä»£è¿™ä¸ªå ç”¨å…ƒç´ ï¼Œè®©å ç”¨å…ƒç´ ç»§ç»­æ‰¾ä¸‹ä¸€ä¸ªç©ºçš„ä½ç½®ã€‚é¿å…äº†çº¿æ€§æ¢æµ‹ä¸­æŸäº›å…ƒç´ æåº¦è´«å›°çš„é—®é¢˜ï¼Œéœ€è¦è¿ç»­å¤šæ¬¡æ¢æµ‹ã€‚</p><h3 id="slotmap"><a class="header-anchor" href="#slotmap">Â¶</a>slotmap</h3><p>ä¸å¸¸è§„çš„hashmapéœ€è¦è‡ªå·±æä¾›keyå’Œvalueä¸åŒï¼Œslotmapåªåœ¨æ’å…¥æ—¶åªéœ€è¦æä¾›valueï¼Œç„¶åä¼šè‡ªåŠ¨è¿”å›ä¸€ä¸ªå”¯ä¸€ä¸”æ°¸ä¹…æœ‰æ•ˆçš„keyã€‚</p><h3 id="ä¼˜åŒ–"><a class="header-anchor" href="#ä¼˜åŒ–">Â¶</a>ä¼˜åŒ–</h3><ul><li>é€šå¸¸ä¼šæ ¹æ®é”®å€¼çš„ç±»å‹ã€å¤§å°ä»¥åŠå–å€¼åˆ†å¸ƒé€‰æ‹©åˆé€‚çš„å“ˆå¸Œå‡½æ•°å’Œè§£å†³å†²çªæ–¹å¼</li><li>ä½¿ç”¨ç‰ˆæœ¬å·å®ç°å¿«é€Ÿçš„æ¸…ç©ºæ“ä½œ</li></ul><h2 id="åŠ¨æ€å“ˆå¸Œè¡¨"><a class="header-anchor" href="#åŠ¨æ€å“ˆå¸Œè¡¨">Â¶</a>åŠ¨æ€å“ˆå¸Œè¡¨</h2><h3 id="æ‹‰é“¾æ³•"><a class="header-anchor" href="#æ‹‰é“¾æ³•">Â¶</a>æ‹‰é“¾æ³•</h3><p>æ‹‰é“¾æ³•å¯ä»¥ç®—ä½œä¸€ç§åŠ¨æ€å“ˆå¸Œè¡¨çš„ç±»å‹ã€‚å› ä¸ºçº¿æ€§æ¢æµ‹ä¸­å…ƒç´ çš„ä¸ªæ•°åªèƒ½å›ºå®šåœ¨é¢„è®¾çš„Nä¸ªï¼Œè¦æ‰©å¤§åªèƒ½rehashï¼Œè€Œæ‹‰é“¾æ³•ä¸­é“¾è¡¨æ²¡æœ‰å¤§å°é™åˆ¶ï¼Œä½†å®é™…ä¼šé€šè¿‡è´Ÿè½½å› å­æ¥è¿›è¡Œå¹³è¡¡ã€‚</p><p>å¯ä»¥å¥—ä¸Šå¸ƒéš†è¿‡æ»¤å™¨é¿å…æ— ç”¨çš„æŸ¥æ‰¾ã€‚</p><h3 id="å¯æ‰©å±•å“ˆå¸Œ"><a class="header-anchor" href="#å¯æ‰©å±•å“ˆå¸Œ">Â¶</a>å¯æ‰©å±•å“ˆå¸Œ</h3>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…«è‚¡è®°å½•</title>
      <link href="/2023/11/20/%E5%85%AB%E8%82%A1%E8%AE%B0%E5%BD%95/"/>
      <url>/2023/11/20/%E5%85%AB%E8%82%A1%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="C-C"><a class="header-anchor" href="#C-C">Â¶</a>C/C++</h2><h3 id="ç¼–è¯‘è¿‡ç¨‹"><a class="header-anchor" href="#ç¼–è¯‘è¿‡ç¨‹">Â¶</a>ç¼–è¯‘è¿‡ç¨‹</h3><ul><li>é¢„å¤„ç†ï¼š<code>-E</code></li><li>ç¼–è¯‘ï¼šç”Ÿæˆæ±‡ç¼–ä»£ç  <code>-S</code></li><li>æ±‡ç¼–ï¼šç”ŸæˆåŒ…å«æœºå™¨ç çš„ç›®æ ‡æ–‡ä»¶ <code>-c</code></li><li>é“¾æ¥ï¼šå°†å¤šä¸ªç›®æ ‡æ–‡ä»¶å’Œåº“æ–‡ä»¶ç»„åˆæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆéœ€è¦è¿›è¡Œç¬¦å·è§£æå’Œé‡å®šä½ï¼‰<ul><li>é™æ€é“¾æ¥ï¼šåœ¨ç¼–è¯‘é˜¶æ®µå°†é™æ€åº“ç›´æ¥åŠ å…¥åˆ°ç›®æ ‡æ–‡ä»¶ä¸­ï¼ˆé™æ€åº“å…¶å®å°±æ˜¯ä¸€ç»„ç›®æ ‡æ–‡ä»¶ï¼‰</li><li>åŠ¨æ€é“¾æ¥ï¼šåªæ˜¯åŠ å…¥ä¸€äº›æè¿°æ€§ä¿¡æ¯ï¼Œåœ¨è¿è¡Œæ—¶ï¼ˆç¨‹åºå…¥å£å‡½æ•°æ‰§è¡Œä¹‹å‰ï¼‰æ‰çœŸæ­£å®šä½ç¬¦å·è¿è¡Œæ—¶æ‰åŠ è½½å…±äº«åº“åˆ°ç¨‹åºçš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼Œåˆ©ç”¨PLTé—´æ¥è°ƒç”¨</li></ul></li></ul><h3 id="å­—èŠ‚åº"><a class="header-anchor" href="#å­—èŠ‚åº">Â¶</a>å­—èŠ‚åº</h3><ul><li>å¤§ç«¯åºï¼šé«˜ä½åœ¨ä½åœ°å€</li><li>å°ç«¯åºï¼šé«˜ä½åœ¨é«˜åœ°å€</li></ul><p>x86é‡‡ç”¨å°ç«¯åºã€‚ç½‘ç»œå­—èŠ‚åºç»Ÿä¸€ä¸ºå¤§ç«¯åºã€‚</p><h3 id="lambda"><a class="header-anchor" href="#lambda">Â¶</a>lambda</h3><p>lambdaæ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå¯¹åº”ä¸€ä¸ªä»¿å‡½æ•°ï¼ˆé‡è½½äº†<code>operator()</code>çš„ç±»ï¼‰ã€‚</p><ul><li>ç®€åŒ–äº†ç¼–å†™</li><li>æ–¹ä¾¿ä¼ å…¥å‡½æ•°ç±»å‹å‚æ•°</li><li>å¯ä»¥æ•è·ä¸Šä¸‹æ–‡å˜é‡ï¼Œå¯ä»¥å†™åœ¨å‡½æ•°ä½“å†…</li></ul><p>lambdaç”Ÿæˆçš„<code>operator()</code>æ°¸è¿œå¸¦æœ‰consté™å®šï¼ˆä»è€Œä¿è¯æ¯æ¬¡è°ƒç”¨çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼‰ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹æ‹·è´æ•è·çš„å˜é‡ï¼Œåº”è¯¥æ·»åŠ <code>mutable</code>ï¼Œæ­¤æ—¶ä¿®æ”¹çš„å½±å“æ˜¯æ°¸ä¹…çš„ã€‚</p><p>C++14æ³›å‹lambdaï¼Œå‚æ•°ç±»å‹å†™æˆ<code>auto</code>å³å¯ã€‚ä¸è¿‡æ¯ä¸ª<code>auto</code>éƒ½å¯¹åº”ä¸€ä¸ªæ¨¡æ¿å‚æ•°ï¼ˆå¯ä»¥ç†è§£æˆæ˜¯é€šè¿‡autoæ¨å¯¼çš„å‚æ•°ç±»å‹ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> U&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">operator</span><span class="params">()</span><span class="params">(T x, U y)</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> x + y; &#125;</span><br></pre></td></tr></table></figure><p>é€’å½’lambda</p><ul><li>C++11ï¼Œä½¿ç”¨<code>std::function</code>ï¼Œè¿™æ ·æ¯æ¬¡éƒ½è¦å…ˆç»è¿‡<code>std::function</code>ï¼Œæ€§èƒ½å¾ˆå·®</li><li>C++14ï¼Œä½¿ç”¨ä¸€ä¸ªé¢å¤–çš„å³å€¼å¼•ç”¨è‡ªèº«çš„å‚æ•°ï¼Œæ³¨æ„å¿…é¡»å†™æ˜è¿”å›ç±»å‹</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> fib = [](<span class="keyword">auto</span> &amp;&amp;fib, <span class="type">int</span> n)  -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= <span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">fib</span>(fib, n - <span class="number">1</span>) + <span class="built_in">fib</span>(fib, n - <span class="number">2</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">fib</span>(fib, <span class="number">5</span>);</span><br></pre></td></tr></table></figure><h3 id="volatile"><a class="header-anchor" href="#volatile">Â¶</a>volatile</h3><p>volatileå…³é”®å­—ç”¨äºè¡¨æ˜å¯¹åº”å˜é‡çš„å€¼å¯èƒ½è¢«ä¸ç»æ„çš„ä¿®æ”¹ï¼ˆç¡¬ä»¶ã€å¤šçº¿ç¨‹ã€ä¿¡å·ï¼‰ï¼Œå› æ­¤è®©ç¼–è¯‘å™¨ä¸è¦åšå‡ºè¯¥å˜é‡ä¸ä¼šè¢«è‡ªå·±ä¿®æ”¹çš„å‡è®¾ï¼Œä»è€Œä¸è¿›è¡Œè¿‡åº¦çš„ä¼˜åŒ–ï¼ˆä¸ä¼šä¼˜åŒ–æ‰ä»»ä½•ä¸€æ¬¡è¯»å†™ï¼Œä¸ä¼šç¼“å­˜åˆ°å¯„å­˜å™¨ä¸­ï¼Œä¹Ÿä¸ä¼šå¯¹æŒ‡ä»¤é¡ºåºè¿›è¡Œé‡æ’ï¼‰</p><p>é¿å…ç¼–è¯‘å™¨æŒ‡ä»¤é‡æ’ï¼Œå¤„ç†å™¨ä¹±åºæ‰§è¡Œã€‚</p><h3 id="static"><a class="header-anchor" href="#static">Â¶</a>static</h3><ul><li>åœ¨å…¨å±€æ˜¯è®¾ç½®é™æ€ç”Ÿå‘½å‘¨æœŸå’Œå†…éƒ¨é“¾æ¥</li><li>åœ¨å±€éƒ¨æ˜¯è®¾ç½®é™æ€ç”Ÿå‘½å‘¨æœŸå’Œåˆå§‹åŒ–ä¸€æ¬¡</li><li>åœ¨ç±»å†…æ˜¯è®¾ç½®å±äºæ•´ä¸ªç±»ï¼Œæ‰€æœ‰ç±»å…±äº«ï¼Œè€Œä¸æ˜¯ç»‘å®šåˆ°å…·ä½“çš„å¯¹è±¡å®ä¾‹</li></ul><h3 id="inline"><a class="header-anchor" href="#inline">Â¶</a>inline</h3><p>inlineæœ€åˆç”¨äºæç¤ºç¼–è¯‘å™¨å°†å‡½æ•°å†…è”ä¼˜å…ˆäºå‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥ç”¨<code>__attribute__((always_inline))</code>ã€‚</p><p>ç°åœ¨inlineç”¨äºè¡¨æ˜ä¿®é¥°çš„å˜é‡å’Œå‡½æ•°åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œç”±ç¼–è¯‘å™¨ä¿è¯è¿™ä¸€ç‚¹ä¸»è¦ç”¨åœ¨å¤´æ–‡ä»¶ä¸­ï¼ˆç±»æ¯”ä¹‹é—´çš„<code>extern</code>å£°æ˜å’Œå®šä¹‰åˆ†å¼€çš„æ–¹å¼ï¼‰ã€‚</p><p>åœ¨ç±»å†…å®šä¹‰çš„å‡½æ•°éƒ½ä¼šéšå¼å†…è”ã€‚constexprå‡½æ•°ä¼šéšå¼å†…è”ã€‚</p><h3 id="explicit"><a class="header-anchor" href="#explicit">Â¶</a>explicit</h3><p>ä½œç”¨åœ¨å•å‚æ•°æ„é€ å‡½æ•°æ˜¯é¿å…éšå¼è½¬æ¢ã€‚ä¹Ÿå¯ä»¥ä½œç”¨åœ¨å¤šå‚æ•°æ„é€ å‡½æ•°ä¸Šï¼Œè¡¨ç¤ºç¦æ­¢ä½¿ç”¨<code>&#123;&#125;</code>è¿›è¡Œåˆå§‹åŒ–ã€‚</p><p><code>()</code>åœ¨ç©ºæ—¶ä¸ºå€¼åˆå§‹åŒ–ï¼Œéç©ºæ—¶ä¸ºç›´æ¥åˆå§‹åŒ–ï¼ˆå³é€šè¿‡æ„é€ å‡½æ•°ï¼‰ã€‚<code>&#123;&#125;</code>ä½¿ç”¨åˆ—è¡¨åˆå§‹åŒ–ï¼Œåœ¨ç©ºæ—¶å³å€¼åˆå§‹åŒ–ï¼Œéç©ºæ—¶ä¸ºèšåˆåˆå§‹åŒ–ã€‚</p><h3 id="std-function"><a class="header-anchor" href="#std-function">Â¶</a>std::function</h3><p>åŒ…è£…ä»»æ„å¯è°ƒç”¨å¯¹è±¡ï¼ŒåŒ…æ‹¬å‡½æ•°æŒ‡é’ˆã€lambdaå’Œfunctorsã€‚</p><p><code>std::any</code>å’Œ<code>std::function</code>çš„ä¸€ç§å®ç°æ–¹å¼æ˜¯åˆ©ç”¨ä¸€ä¸ªåŸºç±»æŒ‡é’ˆï¼Œç„¶åå­ç±»æ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»ï¼Œä¸ç®¡ä¼ å…¥ä»€ä¹ˆï¼Œéƒ½æ„é€ ä¸€ä¸ªæ¨¡æ¿ç±»ï¼Œç„¶åç”¨åŸºç±»æŒ‡é’ˆæŒ‡å‘å®ƒï¼Œè¦æ“ä½œçš„æ—¶å€™å†å‘ä¸‹è½¬å‹å³å¯ã€‚</p><p>æœ¬è´¨è¿˜æ˜¯ç”¨ä¸€ä¸ªæ¨¡æ¿ç±»å®¹çº³ä¸€åˆ‡ï¼Œåªä¸è¿‡<code>std::any</code>å’Œ<code>std::function</code>æœ‰è‡ªå·±çš„æ¨¡æ¿å‚æ•°è¦æ±‚ï¼Œæ‰€ä»¥åªèƒ½æŠŠè¿™ä¸ªæ¨¡æ¿ç±»åŒ…è£…åœ¨é‡Œé¢ï¼Œç„¶ååˆ©ç”¨åŸºç±»æŒ‡é’ˆèµ·åˆ°ä¸€ä¸ªvoid*çš„ä½œç”¨ã€‚</p><p>è¿™é‡Œä¹Ÿæœ‰ç‚¹PimplèŒƒå¼çš„æ„æ€ï¼Œ<code>std::any</code>å’Œ<code>std::function</code>åªæä¾›æ¥å£å’ŒåŒ…å«ä¸€ä¸ªæŒ‡å‘å…·ä½“å®ç°ç±»çš„æŒ‡é’ˆã€‚</p><p>å¯¹äº<code>std::function</code>ä¼šæ¶‰åŠåˆ°è™šå‡½æ•°è°ƒç”¨ï¼Œå¯¹äºlambdaè¿˜ä¼šæ¶‰åŠåˆ°åŠ¨æ€å†…å­˜åˆ†é…ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Any</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="title">Any</span><span class="params">(<span class="type">const</span> T&amp; t)</span> : ptr&#123;</span> <span class="keyword">new</span> <span class="built_in">Data</span>&lt;T&gt;(t) &#125; &#123;&#125;;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Base</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Data</span> : Base &#123;</span><br><span class="line">        T data;</span><br><span class="line">        <span class="built_in">Data</span>(<span class="type">const</span> T&amp; t) : <span class="built_in">data</span>(t) &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    Base *ptr;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">    T&amp; <span class="title">get_data</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ((Data&lt;T&gt;*)ptr)-&gt;data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="std-vector"><a class="header-anchor" href="#std-vector">Â¶</a>std::vector</h3><p>2å€æ‰©å®¹æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºåªéœ€è¦è¿›è¡Œä½è¿ç®—ã€‚1.5å€æ‰©å®¹å¯ä»¥å‡å°‘å†…å­˜ç¢ç‰‡ã€‚</p><p>åªæœ‰ä»¥å€ç‡æ‰©å®¹æ‰èƒ½ä½¿å¾—å¤æ‚åº¦å‡æ‘Š$O(1)$ï¼Œè€Œ2å€æ‰©å®¹çš„é—®é¢˜æ˜¯æ— æ³•å¤ç”¨å·²ç»é‡Šæ”¾çš„ç©ºé—´ï¼Œå› ä¸ºå‰é¢åŠ èµ·æ¥çš„ç©ºé—´éƒ½æ¯”å½“å‰éœ€è¦çš„ç©ºé—´å°ï¼Œè€Œ1.5å€æ‰©å®¹åˆ™å¯èƒ½å¯ä»¥æœç”¨ä¹‹å‰çš„ç©ºé—´ã€‚</p><h3 id="é¢å‘å¯¹è±¡"><a class="header-anchor" href="#é¢å‘å¯¹è±¡">Â¶</a>é¢å‘å¯¹è±¡</h3><ul><li>å°è£…ï¼šå°†æ•°æ®å’Œæ“ä½œæ•°æ®çš„å‡½æ•°ç»„åˆåœ¨ä¸€èµ·ï¼Œéšè—å®ç°ç»†èŠ‚ï¼Œåªæš´éœ²è¡Œä¸ºï¼Œå‡å°‘è€¦åˆ</li><li>ç»§æ‰¿ï¼šå¯ä»¥ç»§æ‰¿å·²æœ‰ç±»çš„æ•°æ®å’Œå‡½æ•°ï¼Œè¿˜å¯ä»¥é‡å†™ï¼Œæé«˜ä»£ç é‡ç”¨</li><li>å¤šæ€ï¼šä¸»è¦æŒ‡çš„æ˜¯å­ç±»å‹å¤šæ€ï¼Œå³å¯ä»¥ç”¨åŸºç±»æŒ‡é’ˆå’Œå¼•ç”¨ä½¿ç”¨æ´¾ç”Ÿç±»çš„å‡½æ•°ã€‚æ­¤å¤–è¿˜åŒ…æ‹¬å‚æ•°å¤šæ€ï¼Œå³æ³›å‹ï¼Œä»¥åŠç‰¹è®¾å¤šæ€ï¼Œå³é‡è½½ï¼Œç›¸åŒå‡½æ•°å¯¹ä¸åŒç±»å‹æ‰§è¡Œä¸åŒæ“ä½œã€‚</li></ul><p>æ¨¡æ¿ã€ç±»å‹æ“¦é™¤ã€è™šå‡½æ•°è¡¨ã€å­—å…¸</p><h3 id="ç±»çš„å†…å­˜å¸ƒå±€"><a class="header-anchor" href="#ç±»çš„å†…å­˜å¸ƒå±€">Â¶</a>ç±»çš„å†…å­˜å¸ƒå±€</h3><p>é™æ€æˆå‘˜ä¸å ç”¨ç±»å¯¹è±¡çš„å†…å­˜ã€‚æˆå‘˜å‡½æ•°ä¸å ç”¨ç±»å¯¹è±¡çš„å†…å­˜ã€‚æ•°æ®æˆå‘˜è®¿é—®çº§åˆ«ä¸å½±å“å†…å­˜æ’å¸ƒï¼Œå‡æŒ‰ç…§å£°æ˜é¡ºåºï¼Œå¹¶è¿›è¡Œé€‚å½“å¯¹é½ã€‚</p><p>å½“æœ‰è™šå‡½æ•°æ—¶ï¼Œä¼šæœ‰è™šå‡½æ•°æŒ‡é’ˆï¼Œä¸”æ°¸è¿œä½äºèµ·å§‹ä½ç½®ã€‚ï¼ˆä¸€ä¸ªç±»å‘ä¸Šè½¬å‹ä¹‹åï¼Œä½†æ˜¯è™šå‡½æ•°æŒ‡é’ˆè¿˜æ˜¯æŒ‡å‘è‡ªå·±çš„é‚£ä»½è™šå‡½æ•°è¡¨ï¼‰</p><p>è™šå‡½æ•°è¡¨åœ¨å¸¸é‡åŒºã€‚</p><p>å½“æœ‰ç»§æ‰¿å…³ç³»æ—¶ï¼Œèµ·å§‹ä½ç½®æ˜¯åŸºç±»ã€‚</p><p>å½“æœ‰å¤šä¸ªç»§æ‰¿å…³ç³»æ—¶ï¼Œä¼šä»èµ·å§‹ä½ç½®å¼€å§‹ä¾æ¬¡å­˜æ”¾å„ä¸ªåŸºç±»ï¼ˆæ­¤æ—¶å‘ä¸Šè½¬å‹å¯èƒ½å­˜åœ¨åç§»ï¼Œ<code>static_cast</code>ä¼šè‡ªåŠ¨å¤„ç†è¿™ä¸€ç‚¹ï¼Œä½†<code>reinterpret_cast</code>ä¸ä¼šï¼‰ã€‚</p><h3 id="å¤šæ€çš„å®ç°"><a class="header-anchor" href="#å¤šæ€çš„å®ç°">Â¶</a>å¤šæ€çš„å®ç°</h3><ul><li>è¿è¡Œæ—¶å¤šæ€</li></ul><p>è™šå‡½æ•°è¡¨åŒ…å«äº†ä¸€ä¸ªç±»çš„æ‰€æœ‰è™šå‡½æ•°çš„åœ°å€ã€‚å½“æ´¾ç”Ÿç±»é‡å†™äº†åŸºç±»çš„è™šå‡½æ•°æ—¶ï¼Œæ´¾ç”Ÿç±»çš„è™šå‡½æ•°è¡¨ä¼šä½¿ç”¨è‡ªå·±çš„å‡½æ•°åœ°å€ï¼Œå¦åˆ™ç»§æ‰¿å‡½æ•°åœ°å€ã€‚</p><p>æ¯ä¸ªåŒ…å«è™šå‡½æ•°çš„ç±»çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªè™šå‡½æ•°æŒ‡é’ˆã€‚</p><p>æ˜¾ç„¶æ„é€ å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°ï¼Œå› ä¸ºæ­¤æ—¶å¯¹è±¡è¿˜æ²¡æœ‰å®ä¾‹åŒ–ï¼Œè¿˜æ²¡æœ‰è™šå‡½æ•°æŒ‡é’ˆã€‚</p><p>å¯¹äºæŒ‡å‘finalç±»å‹çš„æŒ‡é’ˆï¼Œå› ä¸ºä¸å­˜åœ¨æŒ‡å‘çš„å­ç±»å¯èƒ½ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨å¾ˆå®¹æ˜“è¿›è¡Œå»è™šå‡½æ•°ã€‚</p><ul><li>ç¼–è¯‘æ—¶å¤šæ€</li></ul><p>CRTP</p><p>æœ¬è´¨ä¸Šå°±æ˜¯æŠŠç±»å‹ä¿¡æ¯å­˜åœ¨æ¨¡æ¿é‡Œäº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> specific_animal&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">animal</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">who</span><span class="params">()</span> </span>&#123; <span class="built_in">static_cast</span>&lt;specific_animal*&gt;(<span class="keyword">this</span>)-&gt;<span class="built_in">who</span>(); &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å‡½æ•°é‡å†™ä¸ä¼šè€ƒè™‘è®¿é—®æ§åˆ¶æ˜¯å¦ä¸åŒï¼Œå­ç±»å¯ä»¥ä¿®æ”¹çˆ¶ç±»çš„è®¿é—®æ§åˆ¶ï¼Œå¹¶ä¸”è™šå‡½æ•°ä»ç„¶èµ·ä½œç”¨ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®è°ƒç”¨å‡½æ•°çš„ç±»å‹åˆ¤æ–­æ˜¯å¦ç¬¦åˆè®¿é—®æ§åˆ¶ï¼Œä¸ä¼šå»è€ƒè™‘å¤šæ€é—®é¢˜ã€‚</p><h3 id="RTTI-è¿è¡Œæ—¶ç±»å‹è¯†åˆ«"><a class="header-anchor" href="#RTTI-è¿è¡Œæ—¶ç±»å‹è¯†åˆ«">Â¶</a>RTTI è¿è¡Œæ—¶ç±»å‹è¯†åˆ«</h3><ul><li>typeidæ“ä½œç¬¦ï¼šè¿”å›å”¯ä¸€æ ‡è¯†å¯¹åº”ç±»å‹çš„ç±»å‹ä¿¡æ¯å¯¹è±¡<code>type_info</code>ï¼ˆ<code>typeid(A).name()</code>ï¼‰</li><li>å¼‚å¸¸å¤„ç†catchåŒ¹é…</li><li>åŠ¨æ€ç±»å‹è½¬æ¢dynamic_cast</li></ul><p>ä¸ºäº†è§£å†³è™šå‡½æ•°å¤šæ€ï¼Œä¼šåœ¨è™šå‡½æ•°è¡¨çš„èµ·å§‹ä½ç½®çš„å‰ä¸€é¡¹ä¿å­˜ä¸€ä¸ªæŒ‡å‘<code>type_info</code>å¯¹è±¡çš„æŒ‡é’ˆã€‚</p><h3 id="newå’Œmalloc"><a class="header-anchor" href="#newå’Œmalloc">Â¶</a>newå’Œmalloc</h3><ul><li>newä¼šè¿”å›å¯¹åº”ç±»å‹çš„æŒ‡é’ˆï¼Œå¹¶ä¸”ä¼šè°ƒç”¨æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œè€Œmallocåªä¼šè¿”å›void*</li><li>newæ˜¯C++ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œè€Œmallocæ˜¯ä¸€ä¸ªåº“å‡½æ•°</li><li>newåªéœ€è¦ä¼ å…¥ç±»å‹ä¿¡æ¯ï¼Œä¼šè‡ªåŠ¨è®¡ç®—éœ€è¦åˆ†é…çš„å†…å­˜å¤§å°</li><li>å¤±è´¥æ—¶newä¼šæŠ›å‡º<code>bad_alloc</code>çš„å¼‚å¸¸ï¼Œè€Œmallocè¿”å›NULL</li></ul><p>newè°ƒç”¨äº†<code>operator new()</code>ï¼Œå…¶ä¸­å¤§æ¦‚ç‡ä¼šè°ƒç”¨<code>malloc()</code>ï¼Œæœ€åè°ƒç”¨æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ã€‚</p><p>placement newï¼šåœ¨å·²åˆ†é…å†…å­˜ä¸Šåˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼ˆ<code>std::vector</code>å°±éœ€è¦è¿™ä¸ªï¼‰<code>new(address)A()</code></p><p><code>new[n]</code>ä¼šé¢å¤–å­˜å‚¨æ•°ç»„å¤§å°ï¼Œç„¶åè°ƒç”¨næ¬¡æ„é€ å‡½æ•°ï¼Œ<code>delete[]</code>æ—¶è°ƒç”¨næ¬¡ææ„ã€‚</p><h3 id="mainå‡½æ•°å¯åŠ¨"><a class="header-anchor" href="#mainå‡½æ•°å¯åŠ¨">Â¶</a>mainå‡½æ•°å¯åŠ¨</h3><ul><li>å°†argcã€argvå‚æ•°å…¥æ ˆ</li><li>è°ƒç”¨<code>_start</code>å‡½æ•°</li><li>è°ƒç”¨<code>__libc_start_main</code></li><li>è°ƒç”¨<code>__libc_csu_init</code></li><li>è°ƒç”¨<code>_init</code>å‡½æ•°</li></ul><h3 id="std-swap"><a class="header-anchor" href="#std-swap">Â¶</a>std::swap</h3><p>å¯ä»¥æŠŠswapå½“æˆä¸€ä¸ªæ°¸è¿œä¸ä¼šå¤±è´¥ä¸”ä¸ä¼šæŠ›å‡ºå¼‚å¸¸çš„æ“ä½œã€‚ä¸»è¦ç”¨äºå®ç°æ‹·è´èµ‹å€¼å‡½æ•°ã€‚å¦‚æœä¸ç”¨<code>std::swap</code>å°±éœ€è¦åˆ†æ­¥è¿›è¡Œ<code>new</code>ä¸€ä¸ªæ–°çš„ï¼Œ<code>delete</code>æ—§çš„ï¼Œè¿™ä¼šæ¶‰åŠå¼‚å¸¸å¤±è´¥çš„é—®é¢˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(T &amp;a,T &amp;b)</span> <span class="keyword">noexcept</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T temp = std::<span class="built_in">move</span>(a);</span><br><span class="line">    a = std::<span class="built_in">move</span>(b);</span><br><span class="line">    b = std::<span class="built_in">move</span>(temp);</span><br><span class="line">&#125;</span><br><span class="line">dumb_array&amp; <span class="keyword">operator</span>=(<span class="type">const</span> dumb_array&amp; other)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> != &amp;other) <span class="comment">// (1)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// get the new data ready before we replace the old</span></span><br><span class="line">        std::<span class="type">size_t</span> newSize = other.mSize;</span><br><span class="line">        <span class="type">int</span>* newArray = newSize ? <span class="keyword">new</span> <span class="type">int</span>[newSize]() : <span class="literal">nullptr</span>; <span class="comment">// (3)</span></span><br><span class="line">        std::<span class="built_in">copy</span>(other.mArray, other.mArray + newSienze, newArray); <span class="comment">// (3)</span></span><br><span class="line">        <span class="comment">// replace the old data (all are non-throwing)</span></span><br><span class="line">        <span class="keyword">delete</span> [] mArray;</span><br><span class="line">        mSize = newSize;</span><br><span class="line">        mArray = newArray;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ³¨æ„å‚æ•°æ”¹æˆä¼ å€¼äº†</span></span><br><span class="line">dumb_array&amp; <span class="keyword">operator</span>=(dumb_array other) <span class="comment">// (1)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">swap</span>(*<span class="keyword">this</span>, other); <span class="comment">// (2)</span></span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç§»åŠ¨æ„é€ ä¹Ÿå¾ˆç®€å•</span></span><br><span class="line"><span class="built_in">dumb_array</span>(dumb_array&amp;&amp; other) <span class="keyword">noexcept</span></span><br><span class="line">    : <span class="built_in">dumb_array</span>() <span class="comment">// initialize via default constructor, C++11 only</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">swap</span>(*<span class="keyword">this</span>, other);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‹å…ƒè¿ç®—ç¬¦"><a class="header-anchor" href="#å‹å…ƒè¿ç®—ç¬¦">Â¶</a>å‹å…ƒè¿ç®—ç¬¦</h3><p>å¯¹äºæµè¿ç®—ç¬¦ç­‰ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯è¯¥ç±»ï¼Œå› æ­¤åªèƒ½é€šè¿‡å‹å…ƒæ¥å®ç°ã€‚</p><p>å‹å…ƒæ˜¯å•å‘çš„ï¼Œä¸”ä¸å…·æœ‰ä¼ é€’æ€§ã€‚</p><h3 id="ç©ºç±»å¤§å°"><a class="header-anchor" href="#ç©ºç±»å¤§å°">Â¶</a>ç©ºç±»å¤§å°</h3><p>åœ¨C++ä¸­ä¸ä¸º0ï¼Œå› ä¸ºC++æ ‡å‡†è¦æ±‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ç‹¬ä¸€æ— äºŒçš„åœ°å€ã€‚</p><p>ç©ºåŸºç±»ä¼˜åŒ–ï¼šå¦‚æœåŸºç±»æ˜¯ç©ºçš„ï¼ˆå³ä¸åŒ…å«éé™æ€çš„æˆå‘˜ï¼‰ï¼Œé‚£ä¹ˆåœ¨å­ç±»çš„å†…å­˜å¸ƒå±€ä¸­ä¸ä¼šåŒ…å«è¯¥åŸºç±»ï¼Œè€Œå¦‚æœä½¿ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ï¼Œåˆ™ä¼šé¢å¤–å¤š1ä¸ªå­—èŠ‚ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Base</span> &#123;&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Derived</span> : Base &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">assert</span>(<span class="built_in">sizeof</span>(Derived) == <span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨è‡ªåŠ¨ä¸ºç©ºç±»ç”Ÿæˆä»¥ä¸‹å‡½æ•°ï¼Œå¦‚æœéœ€è¦è¢«ä½¿ç”¨åˆ°ï¼š</p><ul><li>æ— å‚æ„é€ </li><li>æ‹·è´æ„é€ </li><li>ç§»åŠ¨æ„é€ </li><li>æ‹·è´èµ‹å€¼</li><li>ç§»åŠ¨èµ‹å€¼</li><li>ææ„</li></ul><p>è™½ç„¶æ„é€ å‡½æ•°å’Œææ„å‡½æ•°éƒ½å¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼Œä½†æœ€å¥½ä¸è¦è¿™ä¹ˆåšã€‚å¦‚æœåœ¨æ„é€ å‡½æ•°ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œè¯´æ˜è¯¥å¯¹è±¡æ²¡æœ‰æ„é€ æˆåŠŸï¼Œå°±ä¸ä¼šè°ƒç”¨å¯¹åº”çš„ææ„å‡½æ•°ã€‚</p><h3 id="å‘½åç©ºé—´"><a class="header-anchor" href="#å‘½åç©ºé—´">Â¶</a>å‘½åç©ºé—´</h3><ul><li>é¿å…åç§°å†²çª</li><li>ç»„ç»‡ä»£ç </li><li>åŒ¿åå‘½åç©ºé—´å…·æœ‰å†…éƒ¨é“¾æ¥ï¼Œå…¶æ•ˆæœç­‰ä»·äºstaticçš„å…¨å±€å˜é‡å’Œå‡½æ•°ï¼Œå¹¶ä¸”è¿˜å¯ä»¥ä½œç”¨åœ¨ç±»ä¸Šã€‚åŒ¿åå‘½åç©ºé—´ç›¸å½“äºç”Ÿæˆä¸€ä¸ªå…¨å±€å”¯ä¸€çš„åå­—ï¼Œå¹¶åœ¨å½“å‰æ–‡ä»¶ä¸‹æ·»åŠ usingæŒ‡ç¤ºï¼Œä»è€Œåªæœ‰åœ¨å½“å‰æ–‡ä»¶ä¸­å¯ä»¥è®¿é—®è¿™äº›å˜é‡ã€å‡½æ•°å’Œç±»ã€‚æ˜¾ç„¶è¿™ç”¨åœ¨å¤´æ–‡ä»¶é‡Œæ˜¯æ²¡ç”¨çš„ã€‚</li><li>å†…è”å‘½åç©ºé—´ï¼Œè¿™ä¸ªå‘½åç©ºé—´å¯å­˜åœ¨ä¹Ÿå¯ä¸å­˜åœ¨</li></ul><h3 id="ç±»å‹è½¬æ¢"><a class="header-anchor" href="#ç±»å‹è½¬æ¢">Â¶</a>ç±»å‹è½¬æ¢</h3><ul><li>static_cast</li></ul><p>ç”¨æ¥å¤„ç†å¸¸è§„è½¬å‹ï¼ŒåŒ…æ‹¬ç±»çš„å‘ä¸Šè½¬å‹ï¼ˆä¼šæ·»åŠ åç§»ï¼‰ï¼Œæ·»åŠ constã€‚</p><p>ç›¸æ¯”äºCé£æ ¼è½¬æ¢ï¼Œstatic_castä¼šåšä¸€äº›æ£€æŸ¥ï¼Œå¹¶ä¸”åœ¨ä»£ç ä¸­æ›´å®¹æ˜“è¢«æ³¨æ„åˆ°ã€‚</p><p><code>error: invalid â€˜static_castâ€™ from type â€˜char*â€™ to type â€˜int*â€™</code></p><ul><li>const_cast</li></ul><p>ç”¨æ¥ç§»é™¤CVé™å®šç¬¦ã€‚æŠŠconstçš„å˜é‡å˜æˆéconstæ˜¯æœªå®šä¹‰çš„ï¼Œå»æ‰constä¸»è¦ç”¨åœ¨æŒ‡é’ˆå’Œå¼•ç”¨ä¸Šã€‚</p><ul><li>dynamic_cast</li></ul><p>ç”¨æ¥å¤„ç†æŒ‡é’ˆä¸å¼•ç”¨å¼•èµ·çš„å¤šæ€ï¼Œå‘ä¸‹è½¬å‹ã€‚</p><ul><li>reinterpret_cast</li></ul><p>ç”¨æ¥å¤„ç†æ¯”ç‰¹çº§åˆ«çš„è½¬å‹ï¼ŒæŒ‰ç…§å¦ä¸€ç§ç±»å‹é‡æ–°è§£é‡Šè¿™æ®µæ¯”ç‰¹ã€‚åœ¨æŒ‡é’ˆä¹‹é—´è½¬åŒ–ä¸ä¼šæ”¹å˜åœ°å€ï¼Œåœ¨æŒ‡é’ˆä¸æ•°å€¼é—´è½¬æ¢ã€‚</p><ul><li>bit_cast</li></ul><p>éµå®ˆå¼ºåˆ¶åˆ«åè§„åˆ™ï¼Œæ›´åŠ å®‰å…¨ï¼Œä¸”æ˜¯constexprçš„ï¼ŒåŒæ—¶ä¹Ÿæœ‰æ›´å¤šé™åˆ¶ï¼ˆå¿…é¡»æ˜¯ç›¸åŒå¤§å°ï¼Œtrivially copyç­‰ï¼‰ã€‚</p><h3 id="æŒ‡é’ˆå’Œå¼•ç”¨çš„åŒºåˆ«"><a class="header-anchor" href="#æŒ‡é’ˆå’Œå¼•ç”¨çš„åŒºåˆ«">Â¶</a>æŒ‡é’ˆå’Œå¼•ç”¨çš„åŒºåˆ«</h3><p>è¿™é‡Œé»˜è®¤è¯´çš„æ˜¯å·¦å€¼å¼•ç”¨ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æŒ‡é’ˆå¸¸é‡ï¼ˆé¡¶å±‚constï¼‰çš„è¯­æ³•ç³–ã€‚è™½ç„¶åº•å±‚é»˜è®¤é€šè¿‡æŒ‡é’ˆã€åœ°å€å®ç°ï¼Œä½†åº”è¯¥æŠŠå¼•ç”¨è§†ä½œåˆ«åï¼Œå®ƒä¸å ç”¨ç©ºé—´ã€‚</p><ul><li><p>æŒ‡é’ˆå­˜å‚¨åœ°å€ï¼Œå¼•ç”¨æ˜¯åˆ«å</p></li><li><p>æŒ‡é’ˆå¯ä»¥ä¸ºç©ºï¼Œå¼•ç”¨å¿…é¡»è¢«åˆå§‹åŒ–ä¸”ä¸èƒ½ä¸ºç©º</p></li><li><p>æŒ‡é’ˆå¯ä»¥è¢«é‡æ–°èµ‹å€¼ï¼Œå¼•ç”¨ä¸å¯ä»¥</p></li><li><p>æŒ‡é’ˆæœ‰è‡ªå·±çš„åœ°å€ï¼Œå¯ä»¥ç”¨sizeofè®¡ç®—å¤§å°</p></li><li><p>æŒ‡é’ˆå¯ä»¥æœ‰å¤šçº§ï¼Œå¼•ç”¨åªæœ‰ä¸€çº§</p></li><li><p>æœ‰æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡å‘å¼•ç”¨çš„æŒ‡é’ˆ</p></li><li><p>æœ‰æŒ‡é’ˆæ•°ç»„ï¼Œä½†æ²¡æœ‰å¼•ç”¨æ•°ç»„</p></li><li><p>constå¼•ç”¨å¯ä»¥ç»‘å®šåˆ°å¸¸é‡</p></li><li><p>é‡æŒ‡é’ˆï¼šæœªç»åˆå§‹åŒ–çš„æŒ‡é’ˆï¼Œå¯èƒ½æŒ‡å‘ä»»ä½•åœ°æ–¹</p></li><li><p>ç©ºæŒ‡é’ˆ</p></li><li><p>æ‚¬æŒ‚æŒ‡é’ˆï¼šæŒ‡å‘å·²é”€æ¯çš„å¯¹è±¡</p></li><li><p>æŒ‡é’ˆå¸¸é‡ï¼šæŒ‡é’ˆæœ¬èº«æ˜¯ä¸€ä¸ªå¸¸é‡</p></li><li><p>å¸¸é‡æŒ‡é’ˆï¼šæŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆ</p></li></ul><h3 id="å•ä¾‹æ¨¡å¼"><a class="header-anchor" href="#å•ä¾‹æ¨¡å¼">Â¶</a>å•ä¾‹æ¨¡å¼</h3><p>ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚ç”¨å±€éƒ¨é™æ€å˜é‡å³å¯ï¼Œé™æ€å˜é‡çš„åˆå§‹åŒ–æ˜¯ä¼šåŠ é”çš„ï¼Œå¹¶ä¸”è‡ªå¸¦äº†æ‡’åˆå§‹åŒ–ç‰¹æ€§ã€‚</p><p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå¥—ä¸€å±‚<code>shared_ptr</code>å¯ä»¥æ›´å¥½åœ°é¿å…æå‰ææ„çš„é—®é¢˜ã€‚</p><p>é¥¿æ±‰ï¼šåœ¨ç¨‹åºåŠ è½½æ—¶å°±å®ä¾‹åŒ–å¯¹è±¡ã€‚æ‡’æ±‰ï¼šä»…åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰å®ä¾‹åŒ–ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>(Singleton <span class="type">const</span>&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(Singleton <span class="type">const</span>&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton&amp; <span class="title">instance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">static</span> Singleton INSTANCE;</span><br><span class="line">        <span class="keyword">return</span> INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>(Singleton <span class="type">const</span>&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(Singleton <span class="type">const</span>&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> std::shared_ptr&lt;Singleton&gt; <span class="title">instance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">static</span> std::shared_ptr&lt;Singleton&gt; s&#123;<span class="keyword">new</span> Singleton&#125;;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ™ºèƒ½æŒ‡é’ˆ"><a class="header-anchor" href="#æ™ºèƒ½æŒ‡é’ˆ">Â¶</a>æ™ºèƒ½æŒ‡é’ˆ</h3><ul><li><code>shared_ptr</code></li><li><code>unique_ptr</code></li><li><code>weak_ptr</code></li></ul><p><code>unique_ptr&lt;T&gt;</code>è¦æ±‚åœ¨é‡åˆ°ææ„å‡½æ•°æ—¶Tæ˜¯å®Œæ•´ç±»å‹ï¼Œä½†ä¸è¦æ±‚æ„é€ å‡½æ•°ï¼›è€Œ<code>shared_ptr&lt;T&gt;</code>è¦æ±‚åœ¨é‡åˆ°æ„é€ å‡½æ•°æ—¶Tæ˜¯å®Œæ•´ç±»å‹ï¼Œä½†ä¸è¦æ±‚ææ„å‡½æ•°ã€‚</p><p><code>shared_ptr</code>çš„å¼•ç”¨è®¡æ•°æ˜¯åœ¨å †ä¸Šä¸Šï¼Œè¿™æ ·æ‰èƒ½è¢«å¤šä¸ª<code>shared_ptr</code>å…±äº«ã€‚</p><p>æ‰‹å†™<code>shared_ptr</code>ã€‚</p><p>å…³é”®å°±æ˜¯æ‹·è´æ„é€ ã€æ‹·è´èµ‹å€¼ã€ç§»åŠ¨æ„é€ ã€ç§»åŠ¨èµ‹å€¼è¿™ä¸ªå‡½æ•°çš„å†™æ³•ã€‚</p><p>å› ä¸ºç§»åŠ¨é€šå¸¸åªçªƒå–èµ„æºï¼Œä¸æ¶‰åŠèµ„æºåˆ†é…ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸æ¶‰åŠå¼‚å¸¸ã€‚æ˜¾ç¤ºæ ‡è®°<code>noexcept</code>çš„å¥½å¤„æ˜¯æ€§èƒ½çš„æå‡ã€‚ç‰¹åˆ«åœ°ï¼Œåœ¨<code>std::vector</code>çš„æ‰©å®¹ä¸­ï¼Œå¦‚æœå…¶ç§»åŠ¨æ„é€ ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™<code>std::vector</code>ä¼šè½¬è€Œé€‰æ‹©æ‹·è´æ„é€ ï¼Œä»¥ä¿è¯å®ƒçš„å¼ºå¼‚å¸¸å®‰å…¨æ€§ã€‚å› ä¸ºç§»åŠ¨æ„é€ å¦‚æœå¤±è´¥ï¼Œä¼šå‡ºç°vectorä¸­éƒ¨åˆ†å¯¹è±¡æ— æ•ˆçš„æƒ…å†µã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SharedPtr</span> &#123;</span><br><span class="line"> <span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">explicit</span> <span class="title">SharedPtr</span><span class="params">(T *ptr)</span> : ptr_(ptr), ref_count_(new std::atomic&lt;uint32_t&gt;(<span class="number">1</span>)) &#123;</span>&#125;</span><br><span class="line">  <span class="built_in">SharedPtr</span>(<span class="type">const</span> SharedPtr &amp;rhs) &#123;</span><br><span class="line">    ptr_ = rhs.ptr_;</span><br><span class="line">    ref_count_ = rhs.ref_count_;</span><br><span class="line">    <span class="keyword">if</span> (ptr_ != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">      (*ref_count_)++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">SharedPtr</span>(SharedPtr &amp;&amp;rhs) <span class="keyword">noexcept</span> &#123;</span><br><span class="line">    ptr_ = rhs.ptr_;</span><br><span class="line">    ref_count_ = rhs.ref_count_;</span><br><span class="line">    rhs.ptr_ = <span class="literal">nullptr</span>;</span><br><span class="line">    rhs.ref_count_ = <span class="literal">nullptr</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  SharedPtr&amp; <span class="keyword">operator</span>=(SharedPtr rhs) &#123;</span><br><span class="line">    std::<span class="built_in">swap</span>(rhs, *<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  SharedPtr&amp; <span class="keyword">operator</span>=(SharedPtr &amp;&amp;rhs) <span class="keyword">noexcept</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;rhs) &#123;</span><br><span class="line">      <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cleanup</span>();</span><br><span class="line">    ptr_ = rhs.ptr_;</span><br><span class="line">    ref_count_ = rhs.ref_count_;</span><br><span class="line">    rhs.ptr_ = <span class="literal">nullptr</span>;</span><br><span class="line">    rhs.ref_count_ = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ~<span class="built_in">SharedPtr</span>() &#123;</span><br><span class="line">    <span class="built_in">cleanup</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  T* <span class="keyword">operator</span>-&gt;() <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ptr_;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  T&amp; <span class="keyword">operator</span>*() <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> *ptr_;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function">T* <span class="title">get</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ptr_;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">uint32_t</span> <span class="title">ref_count</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ref_count_-&gt;<span class="built_in">load</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">private</span>:</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">cleanup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ref_count_ != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">      (*ref_count_)--;</span><br><span class="line">      <span class="keyword">if</span> ((*ref_count_) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ptr_ != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">          <span class="keyword">delete</span> ptr_;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">delete</span> ref_count_;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  T *ptr_;</span><br><span class="line">  std::atomic&lt;<span class="type">uint32_t</span>&gt; *ref_count_;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å¹¶å‘ç¼–ç¨‹"><a class="header-anchor" href="#å¹¶å‘ç¼–ç¨‹">Â¶</a>å¹¶å‘ç¼–ç¨‹</h3><p>å¹¶å‘ã€å¹¶è¡Œ</p><p>çº¿ç¨‹ï¼š</p><p><code>std::thread</code></p><ul><li><p><code>join</code></p></li><li><p><code>detach</code></p></li><li><p><code>yield</code></p></li><li><p><code>get_id</code></p></li><li><p><code>sleep_for</code>, <code>sleep_until</code></p></li><li><p><code>call_once</code></p></li><li><p><code>once_flag</code></p></li><li><p><code>thread::hardware_concurrency</code></p></li></ul><p><a data-fancybox="gallery" data-src="/post-images/cpu-cache.png" data-caption="cpu-cache"><img src="/post-images/cpu-cache.png" alt="cpu-cache"></a></p><p>äº’æ–¥é”ï¼š</p><ul><li><p><code>mutex</code></p></li><li><p><code>lock</code>ï¼šä»¥æ— æ­»é”çš„æ–¹å¼åŠ å¤šä¸ªé”</p></li><li><p><code>unique_lock</code>ï¼šåœ¨éœ€è¦è‡ªè¡ŒåŠ é”å’Œè§£é”æ—¶ä½¿ç”¨</p></li><li><p><code>shared_lock</code></p></li><li><p><code>lock_guard</code>ï¼šRAIIï¼Œåœ¨æ„é€ æ—¶é”å®šï¼Œåœ¨ææ„æ—¶è§£é”ï¼Œç”¨äºå•ä¸ªé”ï¼Œæ¯”unique_lockçš„æ¥å£æ›´å°‘ï¼Œæ€§èƒ½æ›´å¥½ä¸€äº›</p></li><li><p><code>scoped_lock</code>ï¼šRAIIï¼Œä»¥æ— æ­»é”çš„æ–¹å¼åŠ å¤šä¸ªé”</p></li><li><p><code>std::defer_lock</code></p></li><li><p><code>std::adopt_lock</code></p></li></ul><p>æ¡ä»¶å˜é‡ï¼š</p><ul><li><code>condition_variable</code><ul><li><code>wait</code>, <code>notify_one</code>, <code>notify_all</code></li></ul></li></ul><p>ç”±äºå­˜åœ¨è™šå‡å”¤é†’é—®é¢˜ï¼Œå¿…é¡»ä½¿ç”¨whileæ¥æ£€æŸ¥æ¡ä»¶æ˜¯å¦çœŸçš„æ»¡è¶³ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (!condition) &#123;</span><br><span class="line">    cond.<span class="built_in">wait</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼‚æ­¥</p><ul><li><code>async</code></li><li><code>future</code></li><li><code>packaged_task</code></li><li><code>promise</code></li></ul><h3 id="å†…å­˜æ¨¡å‹"><a class="header-anchor" href="#å†…å­˜æ¨¡å‹">Â¶</a>å†…å­˜æ¨¡å‹</h3><p>ä¸»è¦æ˜¯ä¸ºäº†å®ç°æ— é”ç¼–ç¨‹ã€‚</p><ul><li>åŸå­æ“ä½œ</li><li>æ“ä½œçš„é¡ºåº</li><li>æ“ä½œçš„å¯è§æ€§</li></ul><p>ç¼–è¯‘å™¨ä¹±åºã€å¤„ç†å™¨ä¹±åºï¼Œè¿™äº›ä¹±åºéƒ½åªä¿è¯<strong>ä¸ä¼šä¿®æ”¹å•çº¿ç¨‹çš„è¡Œä¸º</strong>ã€‚</p><p><code>asm volatile(&quot;&quot; ::: &quot;memory&quot;);</code>ç”¨äºé˜»æ­¢ç¼–è¯‘å™¨ä¹±åºã€‚</p><p><a data-fancybox="gallery" data-src="/post-images/cache.png" data-caption="cache"><img src="/post-images/cache.png" alt="cache"></a></p><p>ç¼“å­˜ä¸€è‡´æ€§ã€‚</p><p>å½“å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå†…å­˜ä½ç½®ï¼Œå¹¶ä¸”å…¶ä¸­åªè¦æœ‰ä¸€ä¸ªçº¿ç¨‹åŒ…å«äº†å†™æ“ä½œï¼Œå¦‚æœè¿™äº›è®¿é—®æ²¡æœ‰ä¸€è‡´çš„ä¿®æ”¹é¡ºåºï¼Œé‚£ä¹ˆç»“æœå°±æ˜¯æœªå®šä¹‰çš„ã€‚</p><h3 id="å†…å­˜æ³„éœ²"><a class="header-anchor" href="#å†…å­˜æ³„éœ²">Â¶</a>å†…å­˜æ³„éœ²</h3><p><code>malloc</code>å’Œ<code>new</code>æ²¡æœ‰é…å¯¹<code>free</code>å’Œ<code>delete</code>ã€‚</p><p><code>shared_ptr</code>å¾ªç¯å¼•ç”¨ã€‚</p><h3 id="C-å’ŒCçš„åŒºåˆ«"><a class="header-anchor" href="#C-å’ŒCçš„åŒºåˆ«">Â¶</a>C++å’ŒCçš„åŒºåˆ«</h3><p>C++æ˜¯Cçš„æ‰©å±•ï¼Œæ€»ä½“ä¸Šå…¼å®¹Cï¼Œè¿˜æä¾›äº†æ›´å¤šçš„ç¼–ç¨‹èŒƒå¼ï¼ˆé¢å‘å¯¹è±¡ã€é‡è½½ã€æ³›å‹ã€å¼‚å¸¸ç­‰ç­‰ï¼‰ï¼Œä½†å®ƒä»¬ä¹‹é—´ä¹Ÿå­˜åœ¨åˆ†æ­§ï¼ˆABIï¼‰ã€‚</p><h3 id="å †å’Œæ ˆ"><a class="header-anchor" href="#å †å’Œæ ˆ">Â¶</a>å †å’Œæ ˆ</h3><ul><li>æ ˆï¼šæ¯æ¬¡è¿›å…¥å‡½æ•°æ—¶å¼€è¾Ÿæ ˆå¸§ï¼Œç¦»å¼€æ—¶é‡Šæ”¾æ ˆå¸§ï¼Œè‡ªåŠ¨ç®¡ç†ï¼Œé€Ÿåº¦å¿«ï¼Œä½†æ˜¯ç©ºé—´æ¯”è¾ƒå°</li><li>å †ï¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ†é…å’Œé‡Šæ”¾ï¼Œéœ€è¦æ‰‹åŠ¨ç®¡ç†ï¼Œé€Ÿåº¦æ…¢ï¼Œä½†æ˜¯ç©ºé—´å¤§</li></ul><p>æ ˆè¿ç»­ï¼Œå †ä¸ä¸€å®šè¿ç»­ï¼ˆå†…éƒ¨ç¢ç‰‡ã€å¤–éƒ¨ç¢ç‰‡ï¼‰ã€‚ç”³è¯·æ–¹å¼ä¸€ä¸ªè‡ªåŠ¨ä¸€ä¸ªæ‰‹åŠ¨ã€‚ç”Ÿé•¿æ–¹å‘ä¸åŒã€‚</p><h3 id="å®¹å™¨é€‚é…å™¨"><a class="header-anchor" href="#å®¹å™¨é€‚é…å™¨">Â¶</a>å®¹å™¨é€‚é…å™¨</h3><p>å®¹å™¨é€‚é…å™¨åœ¨ä¸€èˆ¬å®¹å™¨çš„åŸºç¡€ä¸Šæä¾›äº†ä¸åŒçš„åŠŸèƒ½ï¼ˆé™åˆ¶äº†ä¸€äº›æ¥å£ï¼‰ã€‚</p><p><code>queue</code>ã€<code>stack</code>éƒ½æ˜¯åŸºäº<code>deque</code>å®ç°çš„ã€‚<code>priority_queue</code>æ˜¯åŸºäº<code>vector</code>å®ç°çš„ã€‚</p><p><code>shrink_to_fit()</code>è¯·æ±‚å°†<code>capcity</code>ç¼©å°ä¸º<code>size()</code>ï¼Œå¯èƒ½è§¦å‘reallocationã€‚è¿™æ˜¯å®ç°å®šä¹‰çš„ï¼Œä¸ä¸€å®šä¿è¯ä¼šåšã€‚</p><p>ä¸€ç§å¯è¡Œçš„æ–¹æ³•æ˜¯ç”¨<code>swap</code>ï¼š<code>vector&lt;Person&gt;(persons).swap(persons);</code></p><h3 id="å‰ç½®å’Œåç½®é€’å¢"><a class="header-anchor" href="#å‰ç½®å’Œåç½®é€’å¢">Â¶</a>å‰ç½®å’Œåç½®é€’å¢</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A&amp; <span class="keyword">operator</span>++() &#123;&#125; <span class="comment">// ++A</span></span><br><span class="line"><span class="type">const</span> A <span class="keyword">operator</span>++(<span class="type">int</span>) &#123;&#125; <span class="comment">// A++</span></span><br></pre></td></tr></table></figure><h3 id="è®¾è®¡åŸåˆ™"><a class="header-anchor" href="#è®¾è®¡åŸåˆ™">Â¶</a>è®¾è®¡åŸåˆ™</h3><ul><li>å¼€é—­åŸåˆ™ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚åœ¨ä¸ä¿®æ”¹å·²æœ‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å¢åŠ æ–°åŠŸèƒ½è¿›è¡Œæ‰©å±•</li><li>å•ä¸€èŒè´£ï¼šæ¯ä¸ªç±»åªè´Ÿè´£ä¸€ä»¶äº‹ï¼Œé«˜å†…èšä½è€¦åˆ</li><li>ä¾èµ–å€’ç½®ï¼šé«˜å±‚æ¨¡å—ä¸ä¾èµ–åº•å±‚æ¨¡å—ã€‚é€šè¿‡ä¾èµ–æŠ½è±¡è¿›è¡Œè§£è€¦</li><li>é‡Œæ°æ›¿æ¢ï¼šå­ç±»åº”è¯¥èƒ½å¤Ÿæ›¿ä»£çˆ¶ç±»ï¼Œå³éœ€è¦å®Œå…¨ç»§æ‰¿å’Œéµå¾ªçˆ¶ç±»çš„è§„å®šå’Œçº¦æŸ</li></ul><h3 id="è®¾è®¡æ¨¡å¼"><a class="header-anchor" href="#è®¾è®¡æ¨¡å¼">Â¶</a>è®¾è®¡æ¨¡å¼</h3><ul><li>å•ä¾‹</li><li>å·¥å‚</li><li>è¿­ä»£å™¨</li><li>é€‚é…å™¨</li></ul><h3 id="æµ‹è¯•"><a class="header-anchor" href="#æµ‹è¯•">Â¶</a>æµ‹è¯•</h3><ul><li>é»‘ç›’æµ‹è¯•ï¼šæ£€æŸ¥å¤–éƒ¨åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼ˆç³»ç»Ÿæµ‹è¯•ï¼‰</li><li>ç°ç›’æµ‹è¯•ï¼šæ£€æŸ¥å¤šä¸ªæ¨¡å—ç»„åˆæ˜¯å¦æ­£å¸¸ï¼ˆé›†æˆæµ‹è¯•ï¼‰</li><li>ç™½ç›’æµ‹è¯•ï¼šæ£€æŸ¥å†…éƒ¨å®ç°æ˜¯å¦æ­£ç¡®ï¼ˆå•å…ƒæµ‹è¯•ï¼‰</li></ul><h2 id="æ“ä½œç³»ç»Ÿ"><a class="header-anchor" href="#æ“ä½œç³»ç»Ÿ">Â¶</a>æ“ä½œç³»ç»Ÿ</h2><h3 id="å†…å­˜å¸ƒå±€"><a class="header-anchor" href="#å†…å­˜å¸ƒå±€">Â¶</a>å†…å­˜å¸ƒå±€</h3><ul><li>ä»£ç æ®µï¼ˆtextï¼‰<ul><li>åªè¯»</li><li>æŒ‡ä»¤</li></ul></li><li>åˆå§‹åŒ–æ•°æ®æ®µï¼ˆdataï¼‰<ul><li>æ‰‹åŠ¨åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡</li></ul></li><li>æœªåˆå§‹åŒ–æ•°æ®æ®µï¼ˆbssï¼‰<ul><li>æœªæ‰‹åŠ¨åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡</li></ul></li><li>å †ï¼ˆheapï¼‰</li><li>æ ˆï¼ˆstackï¼‰</li></ul><p>ä»£ç æ®µå’Œæ•°æ®æ®µç»Ÿç§°ä¸ºé™æ€å­˜å‚¨åŒºï¼Œæ ˆå’Œå †åˆ™æ˜¯åŠ¨æ€å­˜å‚¨åŒºã€‚æ­¤å¤–è¿˜æœ‰åªè¯»æ•°æ®æ®µã€‚</p><h3 id="Bufferå’ŒCache"><a class="header-anchor" href="#Bufferå’ŒCache">Â¶</a>Bufferå’ŒCache</h3><p>Bufferï¼ˆç¼“å†²åŒºï¼‰æ˜¯ç³»ç»Ÿä¸¤ç«¯å¤„ç†é€Ÿåº¦å¹³è¡¡ï¼ˆä»é•¿æ—¶é—´å°ºåº¦ä¸Šçœ‹ï¼‰æ—¶ä½¿ç”¨çš„ã€‚å®ƒçš„å¼•å…¥æ˜¯ä¸ºäº†å‡å°çŸ­æœŸå†…çªå‘I/Oçš„å½±å“ï¼Œèµ·åˆ°æµé‡æ•´å½¢çš„ä½œç”¨ã€‚æ¯”å¦‚ç”Ÿäº§è€…â€”â€”æ¶ˆè´¹è€…é—®é¢˜ï¼Œä»–ä»¬äº§ç”Ÿå’Œæ¶ˆè€—èµ„æºçš„é€Ÿåº¦å¤§ä½“æ¥è¿‘ï¼ŒåŠ ä¸€ä¸ªbufferå¯ä»¥æŠµæ¶ˆæ‰èµ„æºåˆšäº§ç”Ÿ/æ¶ˆè€—æ—¶çš„çªç„¶å˜åŒ–ã€‚</p><p>Cacheï¼ˆç¼“å­˜ï¼‰åˆ™æ˜¯ç³»ç»Ÿä¸¤ç«¯å¤„ç†é€Ÿåº¦ä¸åŒ¹é…æ—¶çš„ä¸€ç§æŠ˜è¡·ç­–ç•¥ã€‚å› ä¸ºCPUå’Œmemoryä¹‹é—´çš„é€Ÿåº¦å·®å¼‚è¶Šæ¥è¶Šå¤§ï¼Œæ‰€ä»¥äººä»¬å……åˆ†åˆ©ç”¨æ•°æ®çš„å±€éƒ¨æ€§ï¼ˆlocalityï¼‰ç‰¹å¾ï¼Œé€šè¿‡ä½¿ç”¨å­˜å‚¨ç³»ç»Ÿåˆ†çº§ï¼ˆmemory hierarchyï¼‰çš„ç­–ç•¥æ¥å‡å°è¿™ç§å·®å¼‚å¸¦æ¥çš„å½±å“ã€‚</p><h3 id="åŸå­æ“ä½œ"><a class="header-anchor" href="#åŸå­æ“ä½œ">Â¶</a>åŸå­æ“ä½œ</h3><p>Cacheä»¥Cache Lineï¼ˆ64 bytesï¼‰ä¸ºå•ä½è¿›è¡Œè¯»å†™æ“ä½œã€‚</p><p>å†™å›ï¼šå†™åˆ°ç¼“å­˜ï¼Œæ ‡è®°ä¸ºè„å†™ç›´è¾¾ï¼šå†™åˆ°ç¼“å­˜å’Œå†…å­˜</p><p>å¤šæ ¸å­˜åœ¨ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚</p><p>æ€»çº¿å—…æ¢å¹¿æ’­å†™æ“ä½œï¼Œä»£ä»·è¾ƒé«˜ã€‚</p><p>MESIï¼šç¼“å­˜ä¸€è‡´æ€§åè®®ã€‚</p><p>åœ¨å•æ ¸ä¸ŠåŸå­æ“ä½œåªéœ€è¦ä¸´æ—¶ç¦ç”¨ä¸­æ–­æ¥é¿å…æ‰“æ–­ã€‚</p><p>åœ¨å¤šæ ¸ä¸Šéœ€è¦å€ŸåŠ©ç‰¹æ®Šçš„ç¡¬ä»¶æœºåˆ¶æˆ–è€…åŒæ­¥åŸè¯­ã€‚</p><ul><li>ç¡¬ä»¶åŸå­æŒ‡ä»¤ï¼šCAS</li><li>é”å’ŒåŒæ­¥æºäºï¼šæ€»çº¿é”ã€ç¼“å­˜é”</li></ul><h3 id="è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹çš„åŒºåˆ«"><a class="header-anchor" href="#è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹çš„åŒºåˆ«">Â¶</a>è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹çš„åŒºåˆ«</h3><ul><li>è¿›ç¨‹ï¼šä¸€ä¸ªç¨‹åºè¿è¡Œæ—¶çš„å®ä½“ï¼Œæœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€å †ã€æ ˆã€å¯„å­˜å™¨ã€ç³»ç»Ÿèµ„æº</li><li>çº¿ç¨‹ï¼šæ‰§è¡Œä»»åŠ¡å’Œè°ƒåº¦çš„æœ€å°å•å…ƒï¼ŒåŒ…å«åœ¨è¿›ç¨‹ä¹‹ä¸­ï¼Œå…±äº«çš„èµ„æºæ¯”è¿›ç¨‹å¤šï¼ŒåŒ…æ‹¬æŒ‡ä»¤æŒ‡é’ˆã€å¯„å­˜å™¨ã€æ ˆ</li><li>åç¨‹ï¼šä¸€ä¸ªå¯ä»¥è‡ªè¡Œæš‚åœæ‰§è¡Œå’Œæ¢å¤æ‰§è¡Œçš„å‡½æ•°</li></ul><p>åœ¨Linuxä¸­ï¼Œç”¨æˆ·æ€çº¿ç¨‹è¢«è¡¨ç¤ºä¸ºè½»é‡çº§è¿›ç¨‹ï¼Œä¸è¿›ç¨‹çš„åŒºåˆ«æ˜¯èµ„æºå…±äº«çš„ç¨‹åº¦ä¸åŒï¼Œçº¿ç¨‹å…±äº«äº†åœ°å€ç©ºé—´å’Œç³»ç»Ÿèµ„æºï¼Œä½†åœ¨å†…æ ¸è°ƒåº¦ä¸Šæ²¡æœ‰åŒºåˆ«ã€‚</p><p>å¤šè¿›ç¨‹ç›¸æ¯”å¤šçº¿ç¨‹æ›´å®‰å…¨ï¼Œå› ä¸ºéš”ç¦»çš„èµ„æºå¤šï¼Œäº’ç›¸çš„å½±å“ç¨‹åº¦å°ã€‚</p><h3 id="è¿›ç¨‹çš„çŠ¶æ€"><a class="header-anchor" href="#è¿›ç¨‹çš„çŠ¶æ€">Â¶</a>è¿›ç¨‹çš„çŠ¶æ€</h3><ul><li>Rï¼šå¯æ‰§è¡ŒçŠ¶æ€ï¼ˆåŒ…æ‹¬æ­£åœ¨è¿è¡Œå’Œå¯è¢«è°ƒåº¦è¿è¡Œï¼‰</li><li>Sï¼šå¯ä¸­æ–­ç¡çœ ï¼Œå› ç­‰å¾…è€ŒæŒ‚èµ·ï¼Œå¦‚I/Oã€ç½‘ç»œè¯·æ±‚ã€ä»¥åŠæ‰‹åŠ¨çš„sleep</li><li>Dï¼šä¸å¯ä¸­æ–­ç¡çœ ï¼Œå¾ˆå°‘è§ï¼Œé€šå¸¸åœ¨è¿›è¡Œä¸å¯æ‰“æ–­çš„åŸå­æ“ä½œ</li><li>Tï¼šæš‚åœæˆ–è¢«è·Ÿè¸ª</li><li>Zï¼šé€€å‡ºï¼Œæˆä¸ºåƒµå°¸è¿›ç¨‹</li><li>Xï¼šé€€å‡ºï¼Œå³å°†è¢«é”€æ¯ã€‚å½“çº¿ç¨‹è¢«detachï¼Œå°±ä¸ä¼šåƒåƒµå°¸è¿›ç¨‹é‚£æ ·åœ¨è¿›ç¨‹æè¿°è¡¨ä¸­ä¿ç•™å…ƒä¿¡æ¯</li></ul><h3 id="è¿›ç¨‹ä¼˜å…ˆçº§"><a class="header-anchor" href="#è¿›ç¨‹ä¼˜å…ˆçº§">Â¶</a>è¿›ç¨‹ä¼˜å…ˆçº§</h3><p>å½±å“è°ƒåº¦çš„ã€‚</p><p><code>ps</code>, <code>top</code>, <code>nice</code></p><h3 id="è¿›ç¨‹é€šä¿¡æ–¹å¼"><a class="header-anchor" href="#è¿›ç¨‹é€šä¿¡æ–¹å¼">Â¶</a>è¿›ç¨‹é€šä¿¡æ–¹å¼</h3><p>æ¶ˆæ¯ä¼ é€’ï¼š</p><ul><li>ç®¡é“ï¼ˆpipeï¼Œå†…æ ¸ä¼šåœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªæœ‰é™å®¹é‡çš„ç¼“å†²å™¨ï¼‰ã€å‘½åç®¡é“ï¼ˆFIFOï¼‰</li><li>å¥—æ¥å­—ï¼ˆsocketï¼‰</li><li>æ¶ˆæ¯é˜Ÿåˆ—</li><li>ä¿¡å·ï¼ˆsignalï¼‰</li><li>æ–‡ä»¶</li></ul><p>å…±äº«å†…å­˜ï¼š</p><ul><li>å…±äº«å†…å­˜ï¼ˆshmemï¼‰</li><li>å†…å­˜æ˜ å°„ï¼ˆmmapï¼‰</li></ul><p>è¿›ç¨‹é—´åŒæ­¥ï¼š</p><ul><li>ä¿¡å·é‡</li><li>æ–‡ä»¶é”</li></ul><h3 id="çº¿ç¨‹é€šä¿¡æ–¹å¼"><a class="header-anchor" href="#çº¿ç¨‹é€šä¿¡æ–¹å¼">Â¶</a>çº¿ç¨‹é€šä¿¡æ–¹å¼</h3><ul><li>ä¿¡å·</li><li>äº’æ–¥é”ã€è‡ªæ—‹é”<ul><li>è‡ªæ—‹é”ä¼šä¸æ–­å¿™ç­‰å¾…ï¼Œè€Œäº’æ–¥é”ç”±å†…æ ¸å®Œæˆï¼Œåœ¨å¤±è´¥æ—¶ä¼šæŒ‚èµ·ï¼Œä»è€Œå…è®¸è¢«è°ƒåº¦èµ°ï¼Œå› æ­¤å¦‚æœæ˜ç¡®é”çš„æ—¶é—´æ¯”è¾ƒçŸ­ï¼Œå¯ä»¥ç”¨è‡ªæ—‹é”ï¼Œå› ä¸ºäº’æ–¥é”éœ€è¦åˆ‡æ¢åˆ°å†…æ ¸</li></ul></li><li>æ¡ä»¶å˜é‡</li><li>ä¿¡å·é‡<ul><li>å°±æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¯ä»¥åŸå­åŠ 1å’Œå‡1ï¼ŒäºŒå…ƒä¿¡å·é‡å…¶å®å°±å¯ä»¥ä½œä¸ºäº’æ–¥é”</li></ul></li><li>å±éšœ</li></ul><h3 id="æ‚²è§‚é”ä¸ä¹è§‚é”"><a class="header-anchor" href="#æ‚²è§‚é”ä¸ä¹è§‚é”">Â¶</a>æ‚²è§‚é”ä¸ä¹è§‚é”</h3><p>æ‚²è§‚é”è®¤ä¸ºå¤šçº¿ç¨‹åŒæ—¶ä¿®æ”¹å…±äº«èµ„æºçš„æ¦‚ç‡å¾ˆé«˜ï¼Œæ‰€ä»¥æ¯æ¬¡è®¿é—®èµ„æºéƒ½ä¼šä¸Šé”ã€‚</p><p>ä¹è§‚é”åˆ™è®¤ä¸ºæ¦‚ç‡å¾ˆä½ï¼Œå…ˆä¿®æ”¹èµ„æºï¼Œå†æ£€æŸ¥æ˜¯å¦å‘ç”Ÿå†²çªï¼Œå‘ç”Ÿå†²çªåˆ™æ”¾å¼ƒæœ¬æ¬¡æ“ä½œã€‚Gitå…¶å®ä¹Ÿå¯ä»¥ç®—ï¼Œåˆ©ç”¨ç‰ˆæœ¬å·æ£€æŸ¥æ˜¯å¦å†²çªã€‚</p><h3 id="æ­»é”"><a class="header-anchor" href="#æ­»é”">Â¶</a>æ­»é”</h3><p>å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…å¯¹é¢é‡Šæ”¾èµ„æºï¼Œä½†éƒ½ä¸ä¼šé‡Šæ”¾èµ„æºã€‚</p><p>è¿˜æœ‰å¯èƒ½æ˜¯å¯¹ä¸€ä¸ªä¸å¯é‡å…¥çš„äº’æ–¥é”å¤šæ¬¡åŠ é”ã€‚</p><p>å››ä¸ªå¿…è¦æ¡ä»¶ï¼š</p><ul><li><p>äº’æ–¥ï¼šä¸€ä¸ªè¿›ç¨‹è¯·æ±‚èµ„æºï¼Œå…¶å®ƒè¿›ç¨‹åªèƒ½ç­‰å¾…</p></li><li><p>ä¸å¯å‰¥å¤ºï¼šä¸èƒ½å¼ºè¡Œå¤ºèµ°å…¶å®ƒè¿›ç¨‹æœªé‡Šæ”¾çš„èµ„æº</p></li><li><p>è¯·æ±‚å’Œä¿æŒï¼šå…¶å®ƒè¿›ç¨‹è¯·æ±‚æ—¶ç»§ç»­å æœ‰</p></li><li><p>å¾ªç¯ç­‰å¾…ï¼šå½¢æˆç¯ç­‰å¾…</p></li><li><p>é¸µé¸Ÿç­–ç•¥</p></li><li><p>æ­»é”æ£€æµ‹ä¸æ¢å¤</p></li><li><p>æ­»é”é¢„é˜²</p></li><li><p>æ­»é”é¿å…</p></li></ul><p>æ³¨æ„åŠ é”å’Œè§£é”çš„é¡ºåºã€‚</p><p>æŸ¥çœ‹offcpuï¼Œé‡‡æ ·ï¼ˆå®šæœŸpstackï¼‰</p><h3 id="I-Oæ¨¡å‹"><a class="header-anchor" href="#I-Oæ¨¡å‹">Â¶</a>I/Oæ¨¡å‹</h3><ul><li>åŒæ­¥é˜»å¡</li><li>åŒæ­¥éé˜»å¡</li><li>IOå¤šè·¯å¤ç”¨<ul><li>å¤šä¸ªè¯·æ±‚å¤ç”¨ä¸€ä¸ªè¿›ç¨‹ï¼Œç±»æ¯”CPUå¹¶å‘æ‰§è¡Œå¤šä¸ªè¿›ç¨‹ï¼Œè¿™é‡Œä¸€ä¸ªè¿›ç¨‹å¤„ç†å¤šä¸ªè¯·æ±‚</li><li><code>select/poll</code>ï¼šæ–‡ä»¶æè¿°ç¬¦é›†åˆï¼ˆselectç”¨ä¸€ä¸ªbitmapï¼Œpollç”¨ä¸€ä¸ªé“¾è¡¨ï¼‰</li><li><code>epoll</code>ï¼šä½¿ç”¨çº¢é»‘æ ‘</li></ul></li><li>ä¿¡å·é©±åŠ¨</li><li>å¼‚æ­¥ï¼šå‘èµ·è¯·æ±‚åç«‹å³è¿”å›ï¼Œç­‰å†…æ ¸å®Œæˆåä»¥ä¿¡å·çš„æ–¹å¼è¿›è¡Œé€šçŸ¥</li></ul><h3 id="ç”¨æˆ·æ€å’Œå†…æ ¸æ€"><a class="header-anchor" href="#ç”¨æˆ·æ€å’Œå†…æ ¸æ€">Â¶</a>ç”¨æˆ·æ€å’Œå†…æ ¸æ€</h3><p>è¿›è¡Œæƒé™æ§åˆ¶è€Œè®¾è®¡çš„ä¸¤ç§CPUè¿è¡Œçº§åˆ«ã€‚</p><p>å†…æ ¸æ€å¯ä»¥æ‰§è¡Œæ‰€æœ‰æŒ‡ä»¤ã€è®¿é—®æ‰€æœ‰ç©ºé—´å’Œèµ„æºã€‚è€Œå†…æ ¸æ€ä¸èƒ½è®¿é—®å†…æ ¸åœ°å€ç©ºé—´æˆ–æ‰§è¡Œç‰¹æƒæŒ‡ä»¤ã€‚å†…æ ¸æ€ä¸»è¦æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„å†…æ ¸ä»£ç ï¼Œè€Œç”¨æˆ·æ€ä¸»è¦æ‰§è¡Œç”¨æˆ·çš„åº”ç”¨ç¨‹åºã€‚</p><p>åˆ‡æ¢è¿‡ç¨‹ï¼š</p><ol><li>è®¾ç½®CPUçŠ¶æ€ä¸ºå†…æ ¸æ€</li><li>ä¿å­˜å¯„å­˜å™¨</li><li>è®¾ç½®æ ˆæŒ‡é’ˆä¸ºå†…æ ¸æ ˆ</li><li>è®¾ç½®ç¨‹åºè®¡æ•°å™¨</li></ol><p>ç³»ç»Ÿè°ƒç”¨ã€å¼‚å¸¸ã€å¤–éƒ¨ä¸­æ–­</p><p>ä¸­æ–­æ˜¯ç³»ç»Ÿç”¨æ¥å“åº”ç¡¬ä»¶è®¾å¤‡è¯·æ±‚çš„ä¸€ç§æœºåˆ¶ã€‚</p><p>åœ¨æ‰§è¡Œä¸­æ–­å¤„ç†ç¨‹åºæ—¶ï¼Œæ— æ³•å“åº”å…¶å®ƒä¸­æ–­ã€‚</p><p>æ”¹æˆç¨‹åºçš„æ‰§è¡Œæµã€‚</p><p>é™·é˜±ï¼ˆtrapï¼‰ï¼šæ‰§è¡ŒæŒ‡ä»¤æœ‰æ„é€ æˆçš„å¼‚å¸¸</p><p>ä¸­æ–­</p><ul><li>ç¡¬ä»¶ä¸­æ–­ï¼šç”±å¤–éƒ¨ç¡¬ä»¶å¼‚æ­¥å‘èµ·</li><li>è½¯ä»¶ä¸­æ–­ï¼šç”±è½¯ä»¶æ‰§è¡Œä¸­è‡ªè¡Œå‘èµ·</li></ul><p>å¼‚å¸¸ï¼šæ‰§è¡ŒæŒ‡ä»¤äº§ç”Ÿé”™è¯¯ï¼ˆé™¤0ï¼Œç¼ºé¡µï¼‰</p><p>ä¿¡å·ï¼šé€šçŸ¥è¿›ç¨‹å‘ç”Ÿäº†æŸä¸ªç³»ç»Ÿäº‹ä»¶</p><h3 id="MMU"><a class="header-anchor" href="#MMU">Â¶</a>MMU</h3><p>å†…å­˜ç®¡ç†å•å…ƒï¼Œå°†ç”¨æˆ·è®¿é—®çš„è™šæ‹Ÿåœ°å€ç¿»è¯‘ä¸ºå®é™…çš„ç‰©ç†åœ°å€ã€‚</p><h3 id="è¿›ç¨‹ç±»åˆ«"><a class="header-anchor" href="#è¿›ç¨‹ç±»åˆ«">Â¶</a>è¿›ç¨‹ç±»åˆ«</h3><ul><li>å®ˆæŠ¤è¿›ç¨‹ï¼šåœ¨åå°è¿è¡Œï¼Œæä¾›æŸç§æœåŠ¡æˆ–é•¿æœŸæ‰§è¡Œä»»åŠ¡</li><li>å­¤å„¿è¿›ç¨‹ï¼šçˆ¶è¿›ç¨‹æ¯”å­è¿›ç¨‹å…ˆç»“æŸï¼Œå­è¿›ç¨‹ç”±initè¿›ç¨‹æ¥ç®¡</li><li>åƒµå°¸è¿›ç¨‹ï¼šå­è¿›ç¨‹å·²ç»ç»“æŸï¼Œä½†çˆ¶è¿›ç¨‹è¿˜æ²¡æœ‰æ‰§è¡Œwait()è·å–å…¶ç»ˆæ­¢çŠ¶æ€ã€‚ä¸ºäº†è®©çˆ¶è¿›ç¨‹èƒ½é€šè¿‡wait()è·å–å…¶å­è¿›ç¨‹çš„çŠ¶æ€ï¼Œå­è¿›ç¨‹ç»“æŸåä¼šé‡Šæ”¾å¤§éƒ¨åˆ†èµ„æºï¼Œä½†ä»ç„¶ä¼šåœ¨å†…æ ¸è¿›ç¨‹è¡¨ä¸­ä¿ç•™ä¸€æ¡è®°å½•ï¼Œå…¶ä¸­åŒ…æ‹¬å­è¿›ç¨‹IDã€ç»ˆæ­¢çŠ¶æ€ç­‰ä¿¡æ¯ã€‚æ— æ³•é€šè¿‡ä¿¡å·æ€æ­»åƒµå°¸è¿›ç¨‹ã€‚å½“çˆ¶è¿›ç¨‹é€€å‡ºåï¼Œä¼šç”±initè¿›ç¨‹æ¥ç®¡è¿›è¡Œæ¸…ç†</li></ul><h3 id="å›æ”¶çº¿ç¨‹"><a class="header-anchor" href="#å›æ”¶çº¿ç¨‹">Â¶</a>å›æ”¶çº¿ç¨‹</h3><p><code>pthread_join</code>ã€<code>pthread_exit</code>ã€<code>pthread_detach</code></p><p>çº¿ç¨‹æ± ï¼šæ¯ä¸ªçº¿ç¨‹ä¸æ–­æŸ¥çœ‹å·¥ä½œé˜Ÿåˆ—ï¼Œæå–å·¥ä½œç„¶åæ‰§è¡Œå³å¯</p><h3 id="æ–‡ä»¶"><a class="header-anchor" href="#æ–‡ä»¶">Â¶</a>æ–‡ä»¶</h3><p>ç¡¬é“¾æ¥ï¼ˆæŒ‡å‘åŒä¸€ä¸ªinodeï¼Œä¸å¯è·¨æ–‡ä»¶ç³»ç»Ÿï¼‰ã€è½¯é“¾æ¥ï¼ˆä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯é“¾æ¥æ–‡ä»¶çš„è·¯å¾„ï¼‰</p><p>åˆ é™¤æ­£åœ¨ä½¿ç”¨çš„æ–‡ä»¶ï¼šinodeä¼šç»´æŠ¤é“¾æ¥è®¡æ•°ï¼Œè¿˜ä¼šç»´æŠ¤æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ä¸ªæ•°ã€‚åœ¨åˆ é™¤æœ€åä¸€ä¸ªé“¾æ¥æ—¶ï¼Œå¦‚æœè¿˜æœ‰æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå°±ä¸ä¼šåˆ é™¤è¯¥æ–‡ä»¶ã€‚</p><h2 id="è®¡ç®—æœºç½‘ç»œ"><a class="header-anchor" href="#è®¡ç®—æœºç½‘ç»œ">Â¶</a>è®¡ç®—æœºç½‘ç»œ</h2><h3 id="ç½‘ç»œæ¨¡å‹"><a class="header-anchor" href="#ç½‘ç»œæ¨¡å‹">Â¶</a>ç½‘ç»œæ¨¡å‹</h3><p>ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ï¼ˆä»¥å¤ªç½‘ï¼‰ã€ç½‘ç»œå±‚ï¼ˆIPï¼‰ã€ä¼ è¾“å±‚ï¼ˆTCPã€UDPï¼‰ã€åº”ç”¨å±‚ï¼ˆHTTPï¼‰</p><p>ä¸ƒå±‚ç½‘ç»œæ¨¡å‹åœ¨ä¼ è¾“å±‚ä¹‹ä¸Šè¿˜æœ‰ä¼šè¯å±‚å’Œè¡¨ç¤ºå±‚ã€‚</p><h3 id="TCPå’ŒUDP"><a class="header-anchor" href="#TCPå’ŒUDP">Â¶</a>TCPå’ŒUDP</h3><p>TCPæ˜¯é¢å‘è¿æ¥çš„å¯é æµå¼åè®®ï¼Œè€ŒUDPæ˜¯é¢å‘æ— è¿æ¥çš„ä¸å¯é æŠ¥æ–‡åè®®ã€‚TCPä¼šé€šè¿‡ç¡®è®¤å’Œé‡ä¼ ç­‰æœºåˆ¶ä¿è¯æ•°æ®è¢«å‡†ç¡®æ”¶åˆ°ã€‚</p><p>æºç«¯å£å’Œç›®çš„ç«¯å£è®°å½•åœ¨TCPæŠ¥æ–‡ä¸­ï¼Œè€ŒæºIPå’Œç›®çš„IPè®°å½•åœ¨IPæ•°æ®åŒ…ä¸­ã€‚</p><p>MTUï¼šç½‘ç»œå±‚æœ€å¤§ä¼ è¾“å•æºMSSï¼šTCPæœ€å¤§åˆ†æ®µå¤§å°</p><p>TCPä¼šè¿›è¡Œåˆ†æ®µï¼Œè€ŒUDPä¸ä¼šè¿›è¡Œåˆ†æ®µã€‚</p><p>TCPé€šè¿‡åˆ†æ®µæ¥é¿å…ä¸‹å±‚IPåˆ†ç‰‡çš„å‘ç”Ÿï¼Œé¿å…åœ¨æ¥æ”¶ç«¯è¿›è¡ŒIPé‡ç»„ã€‚åŒæ—¶é¿å…é‡ä¼ å¤§ä»½æ•°æ®ã€‚</p><h3 id="ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹"><a class="header-anchor" href="#ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹">Â¶</a>ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹</h3><p>ä¸‰æ¬¡æ¡æ‰‹ï¼š</p><ul><li>å®¢æˆ·ç«¯éšæœºåˆå§‹åŒ–ä¸€ä¸ªseqï¼Œå‘é€SYN</li><li>æœåŠ¡ç«¯å›åº”ACKã€SYNï¼Œä»¥åŠä¸€ä¸ªéšæœºçš„seq</li><li>å®¢æˆ·ç«¯å›åº”ACKï¼Œacknoä¸ºæœåŠ¡ç«¯seq+1ï¼Œè¿™é‡Œæ˜¯å¯ä»¥æºå¸¦æ•°æ®çš„</li></ul><p>å¦‚æœåªè¿›è¡Œä¸¤æ¬¡è¿æ¥ï¼ŒæœåŠ¡ç«¯å¯èƒ½ä¼šé”™è¯¯çš„å»ºç«‹ä¸€ä¸ªå†å²è¿æ¥ã€‚ä¸‰æ¬¡è¿æ¥åˆ™å¯ä»¥ç»™å‘èµ·è¿æ¥çš„å®¢æˆ·ç«¯è¿›è¡Œåˆ¤æ–­è¿‡æ»¤çš„æœºä¼šã€‚</p><p>å››æ¬¡æŒ¥æ‰‹ï¼š</p><ul><li>å®¢æˆ·ç«¯å‘é€å¸¦æœ‰FINæ ‡å¿—çš„æŠ¥æ–‡ï¼ˆè¡¨ç¤ºè‡ªå·±ä¸å†å‘é€æ•°æ®ï¼‰</li><li>æœåŠ¡ç«¯å›åº”ACK</li><li>æœåŠ¡ç«¯å†å‘é€å¸¦æœ‰FINæ ‡å¿—çš„æŠ¥æ–‡ï¼ˆè¡¨ç¤ºæœåŠ¡ç«¯ä¹Ÿä¸å†å‘é€æ•°æ®ï¼‰</li><li>å®¢æˆ·ç«¯å†å›åº”ACK</li></ul><p>è¢«åŠ¨æ–­å¼€æ–¹å¯ä»¥ç›´æ¥å…³é—­ã€‚è€Œä¸»åŠ¨æ–­å¼€æ–¹éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´åå…³é—­ï¼Œç­‰å¾…æ—¶é—´ä¸€èˆ¬æ˜¯2MSLï¼Œå…¶ä¸­MSLæ˜¯æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´ï¼Œä¸»åŠ¨æ–­å¼€æ–¹æ— æ³•åˆ¤æ–­å¯¹æ–¹æ˜¯å¦æ”¶åˆ°ACKï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°ï¼Œä¼šé‡æ–°å‘é€ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹çš„FINã€‚</p><p>è¿™é‡Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªæŠ¥æ–‡å¯ä»¥åˆåœ¨ä¸€èµ·ï¼Œæ­¤æ—¶å°±å˜æˆäº†ä¸‰æ¬¡æŒ¥æ‰‹ã€‚</p><ul><li><p>ä½¿ç”¨æ»‘åŠ¨çª—å£è¿›è¡Œæµé‡æ§åˆ¶ï¼Œé¿å…å‘é€è€…å‘é€æ•°æ®è¿‡å¿«</p></li><li><p>è¶…æ—¶é‡ä¼ ï¼šè¶…æ—¶é‡ä¼ æ—¶é—´RTOï¼Œè‚¯å®šè¦å¤§äºå¾€è¿”æ—¶é—´ï¼Œä¸€èˆ¬å–RTO=2RTT</p></li><li><p>æ‹¥å¡æ§åˆ¶ï¼šé¿å…ç½‘ç»œè´Ÿè½½è¿‡å¤§</p></li><li><p>æ…¢å¯åŠ¨ï¼šçª—å£å¤§å°ä»1å¼€å§‹ï¼Œé€æ¸ç¿»å€ï¼Œé¿å…ç¬æ—¶çš„å¤§é‡æ•°æ®</p></li><li><p>æ‹¥å¡é¿å…</p></li><li><p>å¿«é‡ä¼ </p></li><li><p>å¿«æ¢å¤</p></li></ul><p>SYNéšæœºçš„åŸå› ï¼šé¿å…æ—§çš„æŠ¥æ–‡è¢«é”™è¯¯æ¥æ”¶ã€é¿å…è¢«ä¼ªé€ æ”»å‡»</p><p>TCP SYNæ”»å‡»ï¼šæ”»å‡»è€…ä¼ªé€ å¤§é‡ä¸åŒIPçš„SYNæŠ¥æ–‡å‘èµ·è¿æ¥ï¼ŒæœåŠ¡å™¨åº”ç­”ACK+SYNåï¼Œæ”»å‡»è€…ä¸ç»§ç»­å›åº”ï¼Œä¼šå æ»¡æœåŠ¡å™¨çš„åŠè¿æ¥é˜Ÿåˆ—ã€‚</p><p>æ¥æ”¶åˆ°SYNï¼Œå°±ä¼šå°†å®¢æˆ·ç«¯æ”¾åˆ°åŠè¿æ¥é˜Ÿåˆ—ä¸­ï¼ˆåœ¨Linuxä¸­ç§°ä½œincomplete connectionï¼Œéœ€è¦åœ¨è™šæ‹Ÿæ–‡ä»¶ä¸­è®¾ç½®ï¼‰ï¼›æ¥æ”¶åˆ°åº”ç­”ï¼Œå°±æ”¾åˆ°Accepté˜Ÿåˆ—ä¸­ï¼ˆåœ¨Linuxä¸­ç§°ä½œcompletely established sockets waiting to be acceptedï¼Œå¯ä»¥åœ¨<code>listen()</code>ä¸­çš„<code>backlog</code>å‚æ•°è®¾ç½®ï¼‰ã€‚è°ƒç”¨<code>accpet()</code>ä»Accepté˜Ÿåˆ—ä¸­å–å‡ºè¿æ¥å¯¹è±¡ã€‚</p><p>RTT (Round-Trip Time)ï¼šå¾€è¿”æ—¶å»¶ï¼Œæ•°æ®ä»å‘é€ç«¯åˆ°æ¥æ”¶ç«¯å†è¿”å›åˆ°å‘é€ç«¯æ‰€éœ€çš„æ—¶é—´ã€‚ä¸€å®šç¨‹åº¦ä¸Šåæ˜ äº†ç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ã€‚</p><p>KCPå’ŒQUICæ˜¯åŸºäºUDPçš„å¯é åè®®ã€‚</p><h3 id="ç²˜åŒ…"><a class="header-anchor" href="#ç²˜åŒ…">Â¶</a>ç²˜åŒ…</h3><p>å­—èŠ‚æµæ˜¯æ²¡æœ‰è¾¹ç•Œçš„.Nagleç®—æ³•ç”¨äºæ”¹å–„ç½‘ç»œä¼ è¾“æ•ˆç‡ï¼Œä¼šå°†å¤šä¸ªå°æ¶ˆæ¯ç»„åˆèµ·æ¥ä¸€èµ·å‘é€ã€‚</p><h3 id="HTTPå’ŒHTTPS"><a class="header-anchor" href="#HTTPå’ŒHTTPS">Â¶</a>HTTPå’ŒHTTPS</h3><p>HTTPæ˜¯æ˜æ–‡ä¼ è¾“çš„ç½‘ç»œåè®®ï¼Œè€ŒHTTPSå¢åŠ äº†æ•°æ®åŠ å¯†ï¼Œè¿˜éœ€è¦éªŒè¯èº«ä»½ï¼Œæ›´åŠ å®‰å…¨ã€‚HTTPSçš„ç«¯å£æ—¶443ï¼Œè€ŒHTTPæ˜¯80ã€‚</p><p>ä¸­é—´äººæ”»å‡»ï¼šæ”»å‡»è€…ä¸é€šè®¯åŒæ–¹åˆ†åˆ«åˆ›å»ºç‹¬ç«‹çš„è¿æ¥ï¼Œå¹¶æ§åˆ¶é€šè®¯åŒæ–¹çš„äº¤äº’ï¼Œä½†é€šè®¯åŒæ–¹ä»¥ä¸ºæ˜¯åœ¨ç›´æ¥é€šä¿¡ã€‚</p><p>SSLåŠ«æŒ</p><p>TLSï¼šä¼ è¾“å±‚å®‰å…¨åè®®ï¼Œæ˜¯SSLçš„å‡çº§ç‰ˆ</p><h3 id="NAT-DNS-ARP"><a class="header-anchor" href="#NAT-DNS-ARP">Â¶</a>NAT DNS ARP</h3><ul><li>NATï¼šå°†å†…éƒ¨ç§ç½‘IPæ˜ å°„ä¸ºå¤–éƒ¨å…¬ç½‘IP</li><li>DNSï¼šIPåˆ°åŸŸåçš„æ˜ å°„ï¼ˆDNSæœåŠ¡å™¨ï¼‰</li><li>ARPï¼šIPåˆ°MACçš„æ˜ å°„ï¼ˆARPå¹¿æ’­ï¼‰</li></ul><h3 id="æµè§ˆå™¨è¾“å…¥URL"><a class="header-anchor" href="#æµè§ˆå™¨è¾“å…¥URL">Â¶</a>æµè§ˆå™¨è¾“å…¥URL</h3><ul><li>å°†URLï¼Œå³åŸŸåè§£æä¸ºIPåœ°å€</li><li>ä¸è¯¥IPå¯¹åº”çš„æœåŠ¡å™¨é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹TCPè¿æ¥</li><li>å‘é€è¯·æ±‚</li><li>æ¥æ”¶åˆ°å“åº”</li><li>è§£ææ”¶åˆ°çš„HTMLæ–‡ä»¶</li></ul><h2 id="ç®—æ³•"><a class="header-anchor" href="#ç®—æ³•">Â¶</a>ç®—æ³•</h2><h3 id="é“¾è¡¨åˆ¤ç¯"><a class="header-anchor" href="#é“¾è¡¨åˆ¤ç¯">Â¶</a>é“¾è¡¨åˆ¤ç¯</h3><p>å¿«æ…¢æŒ‡é’ˆå¦‚æœç›¸é‡åˆ™æœ‰ç¯ã€‚</p><p>æ‰¾å…¥ç¯ç‚¹ï¼šä¸€ä¸ªæŒ‡é’ˆä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œå¦ä¸€ä¸ªæŒ‡é’ˆä»ç›¸é‡ç‚¹å¼€å§‹ï¼Œåˆ™å®ƒä»¬ä¼šåœ¨å…¥ç¯ç‚¹ç›¸é‡ã€‚</p><p>2L + 2x = L + x + n * c</p><p>L = (n - 1) * c + c - x</p><h3 id="é“¾è¡¨åè½¬"><a class="header-anchor" href="#é“¾è¡¨åè½¬">Â¶</a>é“¾è¡¨åè½¬</h3><p>é€’å½’çš„å†™æ³•æœ€ç›´ç™½ã€‚</p><h3 id="æœ€é•¿å›æ–‡å­ä¸²"><a class="header-anchor" href="#æœ€é•¿å›æ–‡å­ä¸²">Â¶</a>æœ€é•¿å›æ–‡å­ä¸²</h3><h3 id="ä¸‹ä¸€ä¸ªæ’åˆ—"><a class="header-anchor" href="#ä¸‹ä¸€ä¸ªæ’åˆ—">Â¶</a>ä¸‹ä¸€ä¸ªæ’åˆ—</h3><p>ä»¥3,7,6,2,5,4,3,1ä¸ºä¾‹ï¼Œä»åå¾€å‰æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‡åºå¯¹(2, 5)ï¼Œç„¶åå°†2ç”¨åé¢æœ€å°çš„å¤§äºå®ƒçš„æ•°(3)æ›¿æ¢ï¼Œåé¢çš„æ•°å†å‡åºæ’åˆ—å³å¯ã€‚</p><h3 id="ä¸­ä½æ•°"><a class="header-anchor" href="#ä¸­ä½æ•°">Â¶</a>ä¸­ä½æ•°</h3><p>å¯¹é¡¶å †ï¼Œä¸€ä¸ªå¤§é¡¶å †å’Œä¸€ä¸ªå°é¡¶å †ï¼Œä¸»è¦å¤„ç†åŠ¨æ€ä¸­ä½æ•°é—®é¢˜ã€‚</p><p>æ ¹æ®æœ€é«˜ä½åˆ’åˆ†ï¼Œæ˜¾ç„¶æœ€é«˜ä½ä¸º0çš„éƒ½å°äºæœ€é«˜ä½ä¸º1çš„ï¼Œæ ¹æ®æ•°é‡å¯ä»¥ç¡®å®šä¸­ä½æ•°åœ¨å“ªä¸€å †é‡Œï¼Œä¸æ–­åˆ†æ²»å³å¯ï¼ˆè¿™ä¸ªtrickæŒºæœ‰ç”¨çš„ï¼‰ã€‚</p><h2 id="æ™ºåŠ›-æ‚é¢˜"><a class="header-anchor" href="#æ™ºåŠ›-æ‚é¢˜">Â¶</a>æ™ºåŠ›/æ‚é¢˜</h2><h3 id="éšæœºæ´—ç‰Œç®—æ³•"><a class="header-anchor" href="#éšæœºæ´—ç‰Œç®—æ³•">Â¶</a>éšæœºæ´—ç‰Œç®—æ³•</h3><p>$O(n)$</p><p>ä»åå¾€å‰æ˜¯knuthç®—æ³•ï¼Œä»å‰å¾€åæ˜¯inside-outç®—æ³•ï¼Œéƒ½æ˜¯æ­£ç¡®çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">    j = random.randint(<span class="number">0</span>, i)</span><br><span class="line">    a[i], a[j] = a[j], a[i]</span><br></pre></td></tr></table></figure><p>æ­£ç¡®çš„æ´—ç‰Œç®—æ³•åº”è¯¥äº§ç”Ÿ$n!$ç§ç»“æœã€‚è¿›ä¸€æ­¥å†é€šè¿‡è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿæ¯ç§ç»“æœçš„æ¦‚ç‡æ˜¯å¦ä¸€æ ·ã€‚</p><p><code>std::random_shuffle</code>ä½¿ç”¨<code>std::rand()</code>è¿›è¡Œéšæœºæ‰“ä¹±ï¼Œè€Œ<code>std::shuffle</code>ä½¿ç”¨æ›´å¥½çš„éšæœºæ•°ç”Ÿæˆå™¨<code>urng</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> RandomIt, <span class="keyword">class</span> URNG &gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">shuffle</span><span class="params">( RandomIt first, RandomIt last, URNG&amp;&amp; g )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> RandomIt, <span class="keyword">class</span> RandomFunc &gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">random_shuffle</span><span class="params">( RandomIt first, RandomIt last, RandomFunc&amp;&amp; r )</span></span>;</span><br></pre></td></tr></table></figure><h3 id="éšæœºçº¢åŒ…ç®—æ³•"><a class="header-anchor" href="#éšæœºçº¢åŒ…ç®—æ³•">Â¶</a>éšæœºçº¢åŒ…ç®—æ³•</h3><p>äºŒå€å‡å€¼æ³•ï¼šæ¯ä¸ªäººçš„é‡‘é¢åœ¨0.01åˆ°å‰©ä½™å‡å€¼ï¼ˆå‰©ä½™é’±æ•°/å‰©ä½™äººæ•°ï¼‰çš„ä¸¤å€ä¹‹é—´éšæœº</p><h3 id="25åŒ¹é©¬5ä¸ªèµ›é“æ‰¾å‡ºå‰3å¿«"><a class="header-anchor" href="#25åŒ¹é©¬5ä¸ªèµ›é“æ‰¾å‡ºå‰3å¿«">Â¶</a>25åŒ¹é©¬5ä¸ªèµ›é“æ‰¾å‡ºå‰3å¿«</h3><p>éœ€è¦æ¯”èµ›7æ¬¡ã€‚</p><p>é¦–å…ˆéšä¾¿åˆ†æˆ5ç»„å„æ¯”1æ¬¡ã€‚ç„¶åæ¯ç»„æœ€å¿«çš„ä¸€èµ·æ¯”1æ¬¡ï¼Œè¿™æ ·å°±çŸ¥é“æœ€å¿«çš„äº†ã€‚æ¥ç€ï¼Œç¬¬2åå’Œç¬¬3ååªæœ‰5ç§å¯èƒ½ï¼Œæ‰€ä»¥å†æ¯”1æ¬¡å³å¯ã€‚</p><h3 id="10åªè€é¼ åœ¨1000ç“¶æ°´é‡Œæ‰¾å‡ºæ¯’è¯"><a class="header-anchor" href="#10åªè€é¼ åœ¨1000ç“¶æ°´é‡Œæ‰¾å‡ºæ¯’è¯">Â¶</a>10åªè€é¼ åœ¨1000ç“¶æ°´é‡Œæ‰¾å‡ºæ¯’è¯</h3><p>æ˜¾ç„¶ç”¨äºŒè¿›åˆ¶ï¼Œç¬¬iå·çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­çš„ç¬¬jä½ä¸º1ï¼Œå°±ç»™ç¬¬jåªè€é¼ å–ï¼Œæœ€åæ ¹æ®æ­»äº¡æƒ…å†µå°±çŸ¥é“äº†ã€‚</p><h3 id="é«˜æ¥¼æ‰”é¸¡è›‹ï¼Œåªæœ‰2æšé¸¡è›‹"><a class="header-anchor" href="#é«˜æ¥¼æ‰”é¸¡è›‹ï¼Œåªæœ‰2æšé¸¡è›‹">Â¶</a>é«˜æ¥¼æ‰”é¸¡è›‹ï¼Œåªæœ‰2æšé¸¡è›‹</h3><p>æ•´ä½“æ–¹æ¡ˆæ˜¯é—´éš”ç€å°è¯•ï¼Œå› ä¸ºä¸€æ—¦ç¬¬ä¸€æšé¸¡è›‹ç¢äº†ï¼Œåé¢å°±åªèƒ½ä¸€å±‚ä¸€å±‚æ¥äº†ã€‚</p><p>è®¾ç¬¬ä¸€æ¬¡åœ¨Xæ¥¼æ‰”ï¼Œå¦‚æœç¢äº†éœ€è¦Xæ¬¡ï¼›å¦åˆ™ï¼Œåº”è¯¥åœ¨X+X-1æ¥¼æ‰”ï¼Œå¦‚æœç¢äº†ä»ç„¶æ˜¯Xæ¬¡ï¼ŒåŒç†ã€‚ã€‚ã€‚</p><p>ä¹Ÿå°±æ˜¯1+â€¦+(X-1)+X&gt;=100ï¼ŒX&gt;=14ã€‚</p><h3 id="ç”¨rand-7-ç”Ÿæˆrand-10"><a class="header-anchor" href="#ç”¨rand-7-ç”Ÿæˆrand-10">Â¶</a>ç”¨rand(7)ç”Ÿæˆrand(10)</h3><p>æ‹’ç»é‡‡æ ·æ³•ã€‚</p><p>åªè¦èƒ½æ„é€ è¶³å¤Ÿå¤šçš„ç»“æœï¼Œç„¶åé€‰æ‹©å…¶ä¸­10ä¸ªæ¦‚ç‡ç›¸åŒçš„ç»“æœå³å¯ã€‚æ¯”å¦‚<code>rand(7) * rand(7)</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> first, second;</span><br><span class="line"><span class="keyword">while</span> ((first = <span class="built_in">rand7</span>()) &gt; <span class="number">6</span>);</span><br><span class="line"><span class="keyword">while</span> ((second = <span class="built_in">rand7</span>()) &gt; <span class="number">5</span>);</span><br><span class="line"><span class="keyword">return</span> (first&amp;<span class="number">1</span>) == <span class="number">1</span> ? second : <span class="number">5</span>+second;</span><br></pre></td></tr></table></figure><h3 id="çŒ´å­æ¬é¦™è•‰"><a class="header-anchor" href="#çŒ´å­æ¬é¦™è•‰">Â¶</a>çŒ´å­æ¬é¦™è•‰</h3><p>100æ ¹é¦™è•‰ï¼Œæ¬åˆ°50ç±³è¿œçš„å®¶ï¼Œæ¯èµ°ä¸€ç±³å°±å¿…é¡»åƒä¸€æ ¹ï¼Œé—®æœ€åæœ€å¤šå‰©å‡ æ ¹ã€‚</p><p>ç­–ç•¥æ˜¯å…ˆæ¬50æ ¹é¦™è•‰èµ°xç±³ï¼Œç„¶åè¿”å›åˆ°åŸå¤„ï¼Œå†æ¬50æ ¹é¦™è•‰åˆ°åˆšæ‰çš„ä½ç½®ï¼Œç„¶ååˆå¹¶ä¸€èµ·æ¬å›å»ã€‚</p><p>50 - 2x + 50 - x &lt;= 50, x &gt;= 17</p><p>ç­”æ¡ˆæ˜¯100-50-2x = 16ã€‚</p><h3 id="Nä¸ªå¼ºç›—åˆ†Mä¸ªé‡‘å¸"><a class="header-anchor" href="#Nä¸ªå¼ºç›—åˆ†Mä¸ªé‡‘å¸">Â¶</a>Nä¸ªå¼ºç›—åˆ†Mä¸ªé‡‘å¸</h3><p>æ¯ä¸ªå¼ºç›—ä¾æ¬¡æå‡ºä¸€ç§åˆ†é…æ–¹æ¡ˆï¼Œå¦‚æœè¶…è¿‡åŠæ•°çš„äººåŒæ„å°±æ‰§è¡Œï¼Œå¦åˆ™æ€æ­»è¿™ä¸ªå¼ºç›—ã€‚</p><p>ä»åå‰æ¨ã€‚</p><p>æœ€åä¸€ä¸ªå¼ºç›—æ°¸è¿œéƒ½æ˜¯åå¯¹ã€‚å€’æ•°ç¬¬äºŒä¸ªå¼ºç›—åªæœ‰æ­»çš„å¯èƒ½ã€‚å€’æ•°ç¬¬ä¸‰ä¸ªå¼ºç›—å¯ä»¥é€‰æ‹©(M, 0, 0)ï¼Œè¿™æ ·å€’æ•°ç¬¬äºŒä¸ªå¼ºç›—ä¸ç”¨æ­»ï¼Œè‚¯å®šä¼šåŒæ„ã€‚å€’æ•°ç¬¬å››ä¸ªå¼ºç›—å¯ä»¥é€‰æ‹©(M - 2, 0, 1, 1)ï¼Œè¿™æ ·æœ€åä¸¤ä¸ªå¼ºç›—å¯ä»¥å¤šå¾—åˆ°1å—é’±ï¼Œè‚¯å®šä¼šåŒæ„ã€‚å€’æ•°ç¬¬äº”ä¸ªå¼ºç›—å¯ä»¥é€‰æ‹©(M - 3, 0, 1, 2, 0)ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> çŸ¥è¯†ç‚¹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€è‡´æ€§hash</title>
      <link href="/2023/11/19/%E4%B8%80%E8%87%B4%E6%80%A7hash/"/>
      <url>/2023/11/19/%E4%B8%80%E8%87%B4%E6%80%A7hash/</url>
      
        <content type="html"><![CDATA[<p>å°†å¤§é‡è¯·æ±‚å‡åŒ€åˆ†é…åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¯¹åº”çš„æœºå™¨ä¸Šã€‚</p><p>éœ€è¦è§£å†³æœºå™¨æ‰©å®¹ç¼©å®¹çš„é—®é¢˜ã€‚</p><p>ç”¨$2^{32}$ä½œä¸ºæ¨¡æ•°ã€‚</p><p>æœºå™¨ç”¨IPåœ°å€è¿›è¡Œå“ˆå¸Œï¼Œæ•°æ®ä¹Ÿè¿›è¡Œå“ˆå¸Œï¼Œæ„æˆä¸€ä¸ªå“ˆå¸Œç¯ã€‚</p><p>æ¯ä¸ªæ•°æ®æŒ‰ç…§é¡ºæ—¶é’ˆæ‰¾åˆ°ç¬¬ä¸€ä¸ªæœºå™¨ã€‚è¿™æ ·æ’å…¥å’Œåˆ é™¤æœºå™¨åªä¼šå½±å“åˆ°é€†æ—¶é’ˆçš„ä¸€éƒ¨åˆ†æ•°æ®ã€‚</p><p>é€šè¿‡è™šæ‹ŸèŠ‚ç‚¹æ¥æå‡å¹³è¡¡æ€§ã€‚</p><p>æ¯ä¸ªæœºå™¨å¯¹åº”å¤šä¸ªé€»è¾‘ä¸Šçš„ä½äºå“ˆå¸Œç¯ä¸Šä¸åŒä½ç½®çš„è™šæ‹ŸèŠ‚ç‚¹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>doxygen</title>
      <link href="/2023/11/18/doxygen/"/>
      <url>/2023/11/18/doxygen/</url>
      
        <content type="html"><![CDATA[<p><code>doxygen -s -g</code> # ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶ Doxyfile</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@file</span><br><span class="line">@author</span><br><span class="line">@brief</span><br><span class="line">@param[in/out]</span><br><span class="line">@return</span><br><span class="line">@retval</span><br><span class="line">@details</span><br><span class="line">@see</span><br><span class="line">@note</span><br><span class="line">@warning</span><br><span class="line"></span><br><span class="line">å¤šè¡Œæ³¨é‡Šï¼š</span><br><span class="line">/**</span><br><span class="line"> * </span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">å•è¡Œæ³¨é‡Šï¼š</span><br><span class="line">/** */</span><br><span class="line"></span><br><span class="line">ä¸ä»£ç åŒåœ¨ä¸€è¡Œçš„æ³¨é‡Š:</span><br><span class="line">/**&lt; */</span><br></pre></td></tr></table></figure><p><code>doxygen Doxyfile</code>ç”Ÿæˆæ–‡æ¡£</p><p>Doxyfileä¸­æœ‰ç”¨çš„è®¾ç½®</p><ul><li><code>OUTPUT_DIRECTORY</code></li><li><code>OUTPUT_LANGUAGE</code></li><li><code>EXTRACT_ALL</code></li><li><code>HAVE_DOT</code></li><li><code>CALL_GRAPH</code></li><li><code>RECURSIVE</code></li><li><code>INPUT</code></li><li><code>EXCLUDE</code></li><li><code>EXCLUDE_PATTERNS = */doc/* \</code></li><li><code>                   */benchmarks/*</code></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MessagePack</title>
      <link href="/2023/11/17/MessagePack/"/>
      <url>/2023/11/17/MessagePack/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ä¸ªäºŒè¿›åˆ¶å¯¹è±¡åºåˆ—åŒ–åº“ï¼Œç±»ä¼¼äºJSONï¼Œä½†æ˜¯æ›´å¿«ã€æ›´ç´§å‡‘ã€‚</p><p>å¯¹å°æ•´æ•°ã€å°å­—ç¬¦ä¸²ã€å°æ•°ç»„çš„å­˜å‚¨ä½œäº†ä¼˜åŒ–ã€‚</p><p>é¦–å…ˆä¼šæœ‰è‹¥å¹²bitè¡¨ç¤ºç±»å‹ä¿¡æ¯ï¼Œå¯¹äºå˜é•¿æ•°æ®ï¼Œå†ç”¨è‹¥å¹²bitè¡¨ç¤ºé•¿åº¦ä¿¡æ¯ï¼Œæœ€åæ˜¯å€¼ä¿¡æ¯ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Zshé…ç½®</title>
      <link href="/2023/11/15/Zsh%E9%85%8D%E7%BD%AE/"/>
      <url>/2023/11/15/Zsh%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install zsh -y</span><br><span class="line">chsh -s $(which zsh)</span><br><span class="line"></span><br><span class="line">curl -fsSL https://raw.githubusercontent.com/zimfw/install/master/install.zsh | zsh</span><br></pre></td></tr></table></figure><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>é€‰æ‹©zimfwä½œä¸ºæ¡†æ¶ï¼Œè€Œä¸æ˜¯oh-my-zshï¼Œé€Ÿåº¦æ›´å¿«ï¼Œä¹Ÿæ›´ç®€å•ã€‚</p><p>åœ¨<code>.zshrc</code>ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ZIM_HOME=$&#123;ZDOTDIR:-$&#123;HOME&#125;&#125;/.zim</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Download zimfw plugin manager <span class="keyword">if</span> missing.</span></span><br><span class="line">if [[ ! -e $&#123;ZIM_HOME&#125;/zimfw.zsh ]]; then</span><br><span class="line">  if (( $&#123;+commands[curl]&#125; )); then</span><br><span class="line">    curl -fsSL --create-dirs -o $&#123;ZIM_HOME&#125;/zimfw.zsh \</span><br><span class="line">        https://github.com/zimfw/zimfw/releases/latest/download/zimfw.zsh</span><br><span class="line">  else</span><br><span class="line">    mkdir -p $&#123;ZIM_HOME&#125; &amp;&amp; wget -nv -O $&#123;ZIM_HOME&#125;/zimfw.zsh \</span><br><span class="line">        https://github.com/zimfw/zimfw/releases/latest/download/zimfw.zsh</span><br><span class="line">  fi</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install missing modules, and update <span class="variable">$&#123;ZIM_HOME&#125;</span>/init.zsh <span class="keyword">if</span> missing or outdated.</span></span><br><span class="line">if [[ ! $&#123;ZIM_HOME&#125;/init.zsh -nt $&#123;ZDOTDIR:-$&#123;HOME&#125;&#125;/.zimrc ]]; then</span><br><span class="line">  source $&#123;ZIM_HOME&#125;/zimfw.zsh init -q</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Initialize modules.</span></span><br><span class="line">source $&#123;ZIM_HOME&#125;/init.zsh</span><br></pre></td></tr></table></figure><p>å†åˆ›å»º<code>.zimrc</code>ï¼Œè¯¥æ–‡ä»¶æ¯è¡Œæ˜¯ä¸€ä¸ªzmoduleï¼Œå³ä¸€ä¸ªæ’ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start configuration added by Zim install &#123;&#123;&#123;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This is not sourced during shell startup, and it&#x27;s only used to configure the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zimfw plugin manager.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"></span><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Modules</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"></span><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Sets sane Zsh built-in environment options.</span></span><br><span class="line">zmodule environment</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Provides handy git aliases and <span class="built_in">functions</span>.</span></span><br><span class="line">zmodule git</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Applies correct bindkeys <span class="keyword">for</span> input events.</span></span><br><span class="line">zmodule input</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Sets a custom terminal title.</span></span><br><span class="line">zmodule termtitle</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Utility aliases and <span class="built_in">functions</span>. Adds colour to <span class="built_in">ls</span>, grep and less.</span></span><br><span class="line">zmodule utility</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Prompt</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"></span><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Exposes to prompts how long the last <span class="built_in">command</span> took to execute, used by asciiship.</span></span><br><span class="line">zmodule duration-info</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Exposes git repository status information to prompts, used by asciiship.</span></span><br><span class="line">zmodule git-info</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">A heavily reduced, ASCII-only version of the Spaceship and Starship prompts.</span></span><br><span class="line">zmodule asciiship</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Completion</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"></span><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Additional completion definitions <span class="keyword">for</span> Zsh.</span></span><br><span class="line">zmodule zsh-users/zsh-completions --fpath src</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enables and configures smart and extensive tab completion.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">completion must be sourced after all modules that add completion definitions.</span></span><br><span class="line">zmodule completion</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Modules that must be initialized last</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"></span><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fish-like syntax highlighting <span class="keyword">for</span> Zsh.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zsh-users/zsh-syntax-highlighting must be sourced after completion</span></span><br><span class="line">zmodule zsh-users/zsh-syntax-highlighting</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fish-like <span class="built_in">history</span> search (up arrow) <span class="keyword">for</span> Zsh.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zsh-users/zsh-history-substring-search must be sourced after zsh-users/zsh-syntax-highlighting</span></span><br><span class="line">zmodule zsh-users/zsh-history-substring-search</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fish-like autosuggestions <span class="keyword">for</span> Zsh.</span></span><br><span class="line">zmodule zsh-users/zsh-autosuggestions</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&#125;&#125;&#125; End configuration added by Zim install</span></span><br><span class="line"></span><br><span class="line">zmodule romkatv/powerlevel10k</span><br><span class="line">zmodule fzf</span><br></pre></td></tr></table></figure><p>å¤§éƒ¨åˆ†æ’ä»¶æ˜¯é»˜è®¤å°±æ·»åŠ çš„ã€‚æˆ‘åªé¢å¤–åŠ äº†ä¸€äº›ã€‚</p><ul><li><code>powerlevel10k</code>ï¼šä¸€ä¸ªè‡ªå®šä¹‰çš„ä¸»é¢˜<code>p10k configure</code></li><li><p><code>fzf</code></p></li><li><p><code>zimfw install/uninstall</code></p></li><li><code>zimfw update</code></li><li><code>zimfw upgrade</code>ï¼šæ›´æ–°zimfwè‡ªå·±</li></ul><p>æœ€è¿‘ï¼Œåœ¨WSL2ä¸Šå¦‚æœä¸å¯åŠ¨Docker Desktopä¼šæŠ¥ä¸€ä¸ªå…³äºdockerå‘½ä»¤è¡¥å…¨æ–‡ä»¶æ‰¾ä¸åˆ°çš„é”™ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼šéœ€è¦å…ˆæ‰“å¼€Docker Desktop</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -rf /usr/share/zsh/vendor-completions/_docker</span><br><span class="line">sudo cp /mnt/wsl/docker-desktop/cli-tools/usr/share/zsh/vendor-completions/_docker /usr/share/zsh/vendor-completions/</span><br><span class="line">sudo chattr +i /usr/share/zsh/vendor-completions/_docker</span><br></pre></td></tr></table></figure><h3 id="Starship"><a href="#Starship" class="headerlink" title="Starship"></a>Starship</h3><p><a href="https://starship.rs/">starship</a>æ˜¯ä¸€ä¸ªé«˜åº¦è‡ªå®šä¹‰çš„promptï¼Œå¯ä»¥å¹³æ›¿<code>p10k</code>ã€‚</p><h4 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -sS https://starship.rs/install.sh | sh</span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="subst">$(starship init zsh)</span>&quot;</span> <span class="comment"># æ·»åŠ åˆ°~/.zshrc</span></span><br></pre></td></tr></table></figure><h4 id="é…ç½®-1"><a href="#é…ç½®-1" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><p>æ·»åŠ <code>~/.config/starship.toml</code>æ–‡ä»¶ã€‚<code>format</code>ç”±è‹¥å¹²ä¸ªmoduleç»„æˆï¼Œ<br>å¯¹éœ€è¦çš„moduleè¿›è¡Œé…ç½®å³å¯ï¼Œå„ä¸ªå­—æ®µçš„å«ä¹‰åœ¨æ–‡æ¡£ä¸­éƒ½æœ‰è§£é‡Šã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inserts a blank line between shell prompts</span></span><br><span class="line">add_newline = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">format = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"><span class="variable">$directory</span>\</span></span><br><span class="line"><span class="string"><span class="variable">$git_branch</span>\</span></span><br><span class="line"><span class="string"><span class="variable">$git_commit</span>\</span></span><br><span class="line"><span class="string"><span class="variable">$git_state</span>\</span></span><br><span class="line"><span class="string"><span class="variable">$git_status</span>\</span></span><br><span class="line"><span class="string"><span class="variable">$sudo</span>\</span></span><br><span class="line"><span class="string"><span class="variable">$character</span>\</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">right_format = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"><span class="variable">$cmd_duration</span>\</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">[directory]</span><br><span class="line">truncate_to_repo = <span class="literal">false</span></span><br><span class="line">truncation_symbol = <span class="string">&quot;.../&quot;</span></span><br><span class="line"></span><br><span class="line">[sudo]</span><br><span class="line">symbol = <span class="string">&quot;with ğŸ’ª &quot;</span></span><br><span class="line">allow_windows = <span class="literal">true</span></span><br><span class="line">disabled = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">[cmd_duration]</span><br><span class="line">min_time = 10_000 <span class="comment"># Show command duration over 10,000 milliseconds (=10 sec)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Make prompt a single line instead of two lines</span></span><br><span class="line">[line_break]</span><br><span class="line">disabled = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Disable the package module, hiding it from the prompt completely</span></span><br><span class="line">[package]</span><br><span class="line">disabled = <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="å¿«æ·é”®"><a href="#å¿«æ·é”®" class="headerlink" title="å¿«æ·é”®"></a>å¿«æ·é”®</h2><ul><li><code>C-a</code>ï¼šç§»åŠ¨åˆ°è¡Œé¦–</li><li><code>C-e</code>ï¼šç§»åŠ¨åˆ°è¡Œå°¾</li><li><code>C-r</code>ï¼šæœç´¢å†å²å‘½ä»¤</li><li><code>C-u</code>ï¼šå‰ªåˆ‡å½“å‰è¡Œ</li><li><code>C-k</code>ï¼šå‰ªåˆ‡å…‰æ ‡åˆ°è¡Œå°¾çš„å†…å®¹</li><li><code>C-y</code>ï¼šç²˜è´´å‰ªè´´çš„å†…å®¹</li></ul><h2 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf $HOME/.zim</span><br><span class="line">rm $HOME/.zimrc</span><br></pre></td></tr></table></figure><p>å¹¶ç§»é™¤åœ¨<code>.zshrc</code>ä¸­æ·»åŠ çš„è¡Œã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CS144</title>
      <link href="/2023/11/14/CS144/"/>
      <url>/2023/11/14/CS144/</url>
      
        <content type="html"><![CDATA[<h2 id="check0"><a class="header-anchor" href="#check0">Â¶</a>check0</h2><h3 id="webget"><a class="header-anchor" href="#webget">Â¶</a>webget</h3><p>ç†Ÿæ‚‰Socketã€FileDescriptorã€Addressè¿™å‡ ä¸ªç±»åŠå…¶æ¥å£å³å¯ï¼Œä¸»è¦æ˜¯connectï¼Œwriteã€readã€eofã€shutdownè¿™å‡ ä¸ªå‡½æ•°ã€‚</p><p>ä½œä¸ºå®¢æˆ·ç«¯ï¼Œå³è¿æ¥çš„å‘èµ·æ–¹ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªsocketï¼Œç„¶åè°ƒç”¨connectï¼Œå†é€šè¿‡readå’Œwriteè¯»å†™ï¼Œæœ€åshutdownå…³é—­ã€‚æ³¨æ„ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦æ˜¾å¼åœ°bindåœ°å€ï¼Œåœ¨connectå†…éƒ¨ä¼šè¿›è¡Œbindæ“ä½œï¼Œå®¢æˆ·ç«¯çš„IPåœ°å€å’Œç«¯å£è®¾ç½®ç”±å†…æ ¸å®Œæˆï¼Œæ˜¾ç„¶å®ƒçŸ¥é“å“ªä¸ªç«¯å£æ˜¯ä¸è¢«å ç”¨çš„ï¼Œä¹ŸçŸ¥é“å“ªä¸ªIPä¼šæ›´å¥½ï¼ˆæ ¹æ®è·¯ç”±è¡¨ï¼‰ã€‚</p><p>webgetè¿˜æ˜¯å€¼å¾—çœ‹ä¸€ä¸‹æºç çš„ï¼Œäº†è§£ä¸€ä¸‹Linuxä¸‹TCP socketç”¨modern C++æ€ä¹ˆå†™ã€‚</p><ul><li>ç”¨<code>CheckSystemCall</code>æŠŠæ‰€æœ‰ç³»ç»Ÿè°ƒç”¨éƒ½åŒ…è£…äº†èµ·æ¥ï¼Œç»Ÿä¸€è¿›è¡Œé”™è¯¯å¤„ç†</li><li>ç”¨<code>std::unique_ptr&lt;T, deleter&gt;</code>åŒ…è£…äº†æ‰€æœ‰éœ€è¦è‡ªè¡Œfreeç©ºé—´çš„å‡½æ•°è°ƒç”¨</li></ul><h4 id="span"><a class="header-anchor" href="#span">Â¶</a>span</h4><p>ä¸€æ®µè¿ç»­æ•°ç»„ä¸Šçš„è§†å›¾ï¼ˆ<code>std::string_view</code>åªèƒ½æ˜¯char*ä¸Šçš„ï¼‰ã€‚å½“Extendä¸ºstaticæ—¶ï¼Œåœ¨æ¨¡æ¿ä¸­å­˜å‚¨æ•°ç»„çš„å¤§å°ï¼Œæ­¤æ—¶åªéœ€è¦ä¸€ä¸ªæŒ‡å‘æ•°ç»„å¼€å¤´çš„æŒ‡é’ˆï¼›è€Œå½“Extendä¸ºdynamicæ—¶ï¼Œè¿˜éœ€è¦å­˜å‚¨æ•°ç»„çš„å¤§å°ã€‚</p><h4 id="address"><a class="header-anchor" href="#address">Â¶</a>address</h4><p><code>getaddrinfo</code>è¿”å›ä¸€ä¸ª<code>addrinfo</code>çš„ç»“æ„ä½“ï¼ŒåŒ…å«IPåœ°å€å’Œç«¯å£ä¿¡æ¯ã€‚<code>getnameinfo</code>ä¸<code>getaddrinfo</code>ç›¸åï¼Œé€šè¿‡<code>addrinfo</code>ç»“æ„ä½“å¾—åˆ°å¯¹åº”çš„hostï¼ˆå³nodeï¼‰å’Œservï¼ˆå³serviceï¼‰ä¿¡æ¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">getaddrinfo</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *node, <span class="type">const</span> <span class="type">char</span> *service,</span></span></span><br><span class="line"><span class="params"><span class="function">                       <span class="type">const</span> <span class="keyword">struct</span> addrinfo *hints,</span></span></span><br><span class="line"><span class="params"><span class="function">                       <span class="keyword">struct</span> addrinfo **res)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getnameinfo</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> addrlen,</span></span></span><br><span class="line"><span class="params"><span class="function">                       <span class="type">char</span> *host, <span class="type">socklen_t</span> hostlen,</span></span></span><br><span class="line"><span class="params"><span class="function">                       <span class="type">char</span> *serv, <span class="type">socklen_t</span> servlen, <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></table></figure><h4 id="file-descriptor"><a class="header-anchor" href="#file-descriptor">Â¶</a>file_descriptor</h4><p>åŒ…è£…äº†ä¸€ä¸‹fdä¸Šçš„æ“ä½œï¼Œå¦‚<code>read</code>ã€<code>write</code>ã€<code>close</code>ï¼Œè®¾ç½®é˜»å¡ï¼ŒæŸ¥çœ‹æ˜¯å¦å…³é—­ï¼Œæ˜¯å¦EOFã€‚</p><h5 id="readv-writev"><a class="header-anchor" href="#readv-writev">Â¶</a>readv/writev</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">iovec</span> &#123;</span><br><span class="line">    <span class="type">ptr_t</span> iov_base; <span class="comment">/* Starting address */</span></span><br><span class="line">    <span class="type">size_t</span> iov_len; <span class="comment">/* Length in bytes */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">readv</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> iovec *iov, <span class="type">int</span> iovcnt)</span></span>;</span><br><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">writev</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> iovec *iov, <span class="type">int</span> iovcnt)</span></span>;</span><br></pre></td></tr></table></figure><p>ç»“æ„ä½“iovecä»£è¡¨ä¸€ä¸ªç¼“å†²åŒºï¼ˆå¯ä»¥ç±»æ¯”string_viewï¼‰ã€‚readvå’Œwritevç”¨äºè¯»å†™å¤šæ®µéè¿ç»­çš„ç¼“å†²åŒºã€‚</p><h4 id="socket"><a class="header-anchor" href="#socket">Â¶</a>socket</h4><p>æ„é€ socketã€‚è·å–å½“å‰socketçš„åœ°å€ä¿¡æ¯ã€‚è·å–å¯¹ç«¯socketçš„åœ°å€ä¿¡æ¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">socket</span><span class="params">(<span class="type">int</span> domain, <span class="type">int</span> type, <span class="type">int</span> protocol)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getsockname</span><span class="params">(<span class="type">int</span> sockfd, <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> *addrlen)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getpeername</span><span class="params">(<span class="type">int</span> sockfd, <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> *addrlen)</span></span>;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºTCPSocketï¼š<code>AF_INET</code>è¡¨ç¤ºIPV4åè®®ï¼Œ<code>AF_UNIX</code>å’Œ<code>AF_LOCAL</code>è¡¨ç¤ºæœ¬åœ°é€šä¿¡</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">socket</span>(AF_INET, SOCK_STREAM, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><h5 id="bind"><a class="header-anchor" href="#bind">Â¶</a>bind</h5><p>ä¸ºsocketç»‘å®šä¸€ä¸ªåœ°å€ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">bind</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr,</span></span></span><br><span class="line"><span class="params"><span class="function">                <span class="type">socklen_t</span> addrlen)</span></span>;</span><br></pre></td></tr></table></figure><h5 id="connect"><a class="header-anchor" href="#connect">Â¶</a>connect</h5><p>å‘addrå¯¹åº”çš„socketå‘èµ·è¿æ¥ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">connect</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr,</span></span></span><br><span class="line"><span class="params"><span class="function">                   <span class="type">socklen_t</span> addrlen)</span></span>;</span><br></pre></td></tr></table></figure><h5 id="shutdown"><a class="header-anchor" href="#shutdown">Â¶</a>shutdown</h5><p>å…³é—­è¿æ¥ã€‚howåˆ†ä¸º<code>SHUT_RD</code>ã€<code>SHUT_WR</code>ã€<code>SHUT_RDWR</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºä¸å…è®¸è¿›ä¸€æ­¥è¯»ã€å†™ã€è¯»/å†™ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">shutdown</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">int</span> how)</span></span>;</span><br></pre></td></tr></table></figure><h5 id="listen"><a class="header-anchor" href="#listen">Â¶</a>listen</h5><p>è®©socketè¢«åŠ¨ç›‘å¬ã€‚<code>backlog</code>ç”¨äºæŒ‡å®šç­‰å¾…é˜Ÿåˆ—ä¸­è¯·æ±‚è¿æ¥çš„socketçš„ä¸ªæ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">listen</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">int</span> backlog)</span></span>;</span><br></pre></td></tr></table></figure><h5 id="accept"><a class="header-anchor" href="#accept">Â¶</a>accept</h5><p>ä¸ç­‰å¾…é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªsocketå»ºç«‹è¿æ¥ã€‚å¦‚æœç­‰å¾…é˜Ÿåˆ—ä¸ºç©ºï¼Œä¸”socketçš„å±æ€§ä¸ºé˜»å¡ï¼Œåˆ™ä¼šä¸€ç›´ç­‰å¾…ã€‚éé˜»å¡åˆ™å¯ä»¥ä½¿ç”¨<code>select</code>ã€<code>poll</code>ã€<code>epoll</code>æ¥è·å–è¯·æ±‚è¿æ¥äº‹ä»¶ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">accept</span><span class="params">(<span class="type">int</span> sockfd, <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> *addrlen)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="in-memory-byte-stream"><a class="header-anchor" href="#in-memory-byte-stream">Â¶</a>in-memory byte stream</h3><p>å®ç°ä¸€ä¸ªå®šé•¿çš„bufferï¼Œå…¶å®å°±æ˜¯ç»å…¸çš„ring bufferã€‚</p><p>å¦‚æœå†™å…¥è¿‡å¤šï¼Œbufferæ”¾ä¸ä¸‹ï¼Œç›´æ¥ä¸¢å¼ƒã€‚</p><p>æœ€ç®€å•çš„å†™æ³•æ˜¯ç”¨<code>std::deque&lt;char&gt;</code>ï¼Œä½†æ›´å¥½çš„å†™æ³•åº”è¯¥æ˜¯ç”¨ä¸€ä¸ªchar*æ•°ç»„ï¼ˆæˆ–<code>std::string</code>ï¼‰åŠ ä¸¤ä¸ªå¤´å°¾æŒ‡é’ˆå®ç°ã€‚</p><p>å¦‚æœåªä½¿ç”¨å¤´å°¾æŒ‡é’ˆï¼Œéš¾ç‚¹æ˜¯å¦‚ä½•åŒºåˆ†ç©ºå’Œæ»¡çŠ¶æ€ï¼Œå¯ä»¥ç•™ä¸€ä¸ªç©ºä½ï¼Œä¹Ÿå¯ä»¥å¼•å…¥ä¸€ä¸ª<code>size_</code>æ¥è¡¨ç¤ºå½“å‰çš„å¤§å°ã€‚</p><p>åœ¨å†™å…¥çš„æ—¶å€™é€‰æ‹©<code>std::string::copy</code>ï¼Œè€Œ<code>std::string::replace</code>æ›´é€‚åˆå¤„ç†srcå’Œdsté•¿åº¦ä¸ä¸€æ ·çš„æƒ…å†µã€‚</p><p>åœ¨æœ€æ–°ç‰ˆæœ¬çš„å®éªŒä»£ç ä¸­è¿½åŠ å‡½æ•°çš„å‚æ•°æ”¹ä¸ºäº†<code>std::string data</code>ï¼Œè€Œä¸æ˜¯å¼•ç”¨ç±»å‹ï¼Œå› æ­¤åº”è¯¥å……åˆ†åˆ©ç”¨ç§»åŠ¨è¯­ä¹‰ã€‚ä¸€ç§æ›´é«˜æ•ˆçš„å†™æ³•æ˜¯ä½¿ç”¨<code>std::queue&lt;std::string&gt;</code>åŠ <code>std::queue&lt;std::string_view&gt;</code>å®ç°ã€‚æ–°ç‰ˆæœ¬çš„<code>peek</code>å‡½æ•°åªä¼šæŸ¥çœ‹é¦–å­—ç¬¦ï¼Œè€Œä¸æ˜¯å¤šä¸ªå­—ç¬¦ï¼Œå› æ­¤ç”¨<code>std::queue</code>å³å¯ã€‚</p><p>ä¸€ä¸ªç»†èŠ‚æ˜¯å¤„äºé”™è¯¯çŠ¶æ€æ—¶<code>Writer::is_closed</code>å’Œ<code>Reader::is_finished</code>çš„åˆ¤æ–­ï¼Œæ ¹æ®æµ‹è¯•ç”¨ä¾‹ï¼Œåº”è¯¥ä¸è€ƒè™‘é”™è¯¯ã€‚</p><h4 id="buffer"><a class="header-anchor" href="#buffer">Â¶</a>buffer</h4><p>Bufferæ˜¯ä¸€ä¸ªæŒ‡å‘std::stringçš„å…±äº«æ™ºèƒ½æŒ‡é’ˆï¼Œè¿™æ ·å¤šä¸ªBufferåº•å±‚å¯ä»¥æ˜¯åŒä¸€ä¸ªstringã€‚åœ¨æ—§ç‰ˆä»£ç ä¸­ï¼Œä¼ å…¥çš„å‚æ•°æ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œæ‰€ä»¥ä¸å¥½ç›´æ¥ä½¿ç”¨string_viewï¼Œå¯ä»¥å€ŸåŠ©è¿™ä¸ªBufferï¼Œæ¥é¿å…åº•å±‚çš„stringæå‰è¢«é‡Šæ”¾ã€‚</p><p>æ—§ç‰ˆä»£ç è¿˜æä¾›äº†ä¸€ä¸ª<code>BufferViewList</code>ï¼Œæœ¬æ„åº”è¯¥æ˜¯ç”¨è¿™ä¸ªæ¥å®ç°ring bufferçš„ã€‚è¿™æ˜¯ä¸€ä¸ª<code>std::deque&lt;std::string_view&gt;</code>ï¼Œå…¶æ ¸å¿ƒæ˜¯<code>remove_prefix</code>æ“ä½œã€‚</p><h2 id="check1"><a class="header-anchor" href="#check1">Â¶</a>check1</h2><h3 id="reassembler"><a class="header-anchor" href="#reassembler">Â¶</a>reassembler</h3><p>è®©å¯èƒ½ä¹±åºã€é‡å ï¼ˆè¿™é‡Œä¸è€ƒè™‘ä¿®æ”¹ï¼‰çš„dataæŒ‰æ­£ç¡®é¡ºåºåŠ å…¥åˆ°ring bufferä¸­ã€‚</p><p>ä¸»è¦æ˜¯å®ç°ä»¥ä¸‹æ¥å£ï¼Œæ’å…¥ä¸€ä¸ªåœ¨<code>first_idnex</code>ä½ç½®å¼€å§‹çš„dataã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">( <span class="type">uint64_t</span> first_index, std::string data,</span></span></span><br><span class="line"><span class="params"><span class="function"><span class="type">bool</span> is_last_substring, Writer&amp; output )</span></span>;</span><br></pre></td></tr></table></figure><p>éœ€è¦ç»´æŠ¤ä¸‹ä¸€ä¸ªåŠ å…¥åˆ°ring bufferä¸­çš„indexï¼ˆ<code>next_index_</code>ï¼‰ï¼Œä»¥åŠæ­£åœ¨ç­‰å¾…çš„æš‚å­˜å­—ç¬¦åºåˆ—ï¼ˆ<code>pending_</code>ï¼Œåªè€ƒè™‘åç»­ring bufferçš„available capacityä¸ªå­—ç¬¦ï¼Œä»¥æ§åˆ¶ååé‡ï¼‰ã€‚</p><p>æ¯æ¬¡åŠ å…¥ä¸€ä¸ªdataï¼š</p><ul><li>è®¡ç®—å‡ºéœ€è¦è€ƒè™‘çš„åŒºé—´</li><li>å¦‚æœè¯¥åŒºé—´ä»<code>next_index_</code>å¼€å§‹ï¼Œä¸æ–­å°†è¿ç»­çš„æš‚å­˜å­—ç¬¦åºåˆ—çš„é˜Ÿé¦–å†™å…¥åˆ°ring bufferä¸­ï¼ˆä¸€ç§å†™æ³•æ˜¯æŠŠdataå…ˆæ”¾åˆ°æš‚å­˜å­—ç¬¦åºåˆ—é‡Œï¼Œç„¶åå†ä¸æ–­å¼¹å‡ºï¼Œå¦ä¸€ç§æ˜¯å…ˆåˆ æ‰æš‚å­˜å­—ç¬¦åºåˆ—é‡Œå’Œdataé‡åˆçš„ï¼Œç„¶åå†ä¸æ–­å¼¹å‡ºï¼Œæ­£å¸¸æƒ…å†µä¸‹é¡ºåºçš„dataè¿˜æ˜¯å å¤§å¤šæ•°ï¼Œå› æ­¤åä¸€ç§å¯ä»¥åˆ©ç”¨ç§»åŠ¨è¯­ä¹‰ï¼Œæ›´å¥½ï¼‰</li><li>å¦åˆ™å­˜åˆ°å­—ç¬¦åºåˆ—çš„å¯¹åº”ä½ç½®</li></ul><p>éš¾ç‚¹åº”è¯¥æ˜¯å­—ç¬¦åºåˆ—ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„ï¼Œè¦æ±‚èƒ½å¤Ÿä»é¦–éƒ¨åˆ é™¤ï¼Œæœ€å¥½èƒ½æ”¯æŒéšæœºè®¿é—®ã€‚</p><p>ä¸€å¼€å§‹æˆ‘ç”¨çš„æ˜¯<code>std::deque&lt;std::optional&lt;char&gt;&gt;</code>ï¼Œåæ¥æ”¹æˆäº†<code>std::unordered_map&lt;uint64_t, char&gt;</code>ï¼Œæ„Ÿè§‰æ›´åˆé€‚ä¸€äº›ï¼Œä½†å®é™…æµ‹å‡ºæ¥è¿˜æ˜¯dequeæ›´å¿«ï¼Œunordered_mapç”šè‡³ç›´æ¥TLEäº†ï¼Œåœ¨å¤§æ•°æ®ä¸‹æ€§èƒ½è¿˜æ˜¯å¤ªä¸ç¨³å®šäº†ã€‚æˆ‘ä¹Ÿå°è¯•äº†<code>std::list&lt;char&gt;</code>ï¼Œä½†æ„Ÿè§‰ä¹Ÿä¸€èˆ¬ï¼Œå› ä¸ºæ·»åŠ åˆ°å­—ç¬¦åºåˆ—æ—¶æ¯æ¬¡éƒ½è¦å®Œæ•´æ‰«ä¸€éã€‚æˆ‘è®¤ä¸ºæœ€åˆé€‚çš„åº”è¯¥æ˜¯ç±»ä¼¼å—çŠ¶æ•°ç»„ï¼ˆ<code>std::deque</code>å°±å±äºè¿™ç§ï¼‰æˆ–å—çŠ¶é“¾è¡¨çš„å½¢å¼ã€‚</p><p>å¦‚æœç”¨çš„æ˜¯<code>std::deque&lt;std::optional&lt;char&gt;&gt;</code>ï¼Œè¿˜éœ€è¦å®æ—¶ç»´æŠ¤<code>unassembled_bytes</code>ï¼Œè¿™ä¸ªå‡½æ•°æœ€å¥½èƒ½<code>O(1)</code>å›ç­”ã€‚è¿™åœ¨æ–°ç‰ˆæœ¬é‡Œä½“ä¼šä¸åˆ°ï¼Œä½†æ˜¯åœ¨æ—§ç‰ˆçš„<code>TCPConnection</code>ä¸­æ£€æŸ¥è¿æ¥æ˜¯å¦activeä¼šé¢‘ç¹è°ƒç”¨ï¼Œå¾ˆå½±å“æ€§èƒ½ã€‚</p><p>ä¸€ä¸ªç»†èŠ‚æ˜¯<code>is_last_substring</code>è¢«è®¾ç½®ï¼Œä½†ç”±äºavailable capacityè¿‡å°ï¼Œdataæ²¡å†™å®Œï¼Œæ­¤æ—¶<code>is_last_</code>ä»ç„¶åº”ä¿æŒfalseï¼ˆè¿™åœ¨æœ€æ–°ç‰ˆå®éªŒçš„æµ‹è¯•ç”¨ä¾‹é‡Œæ²¡æœ‰è¦†ç›–åˆ°ï¼‰ã€‚</p><h2 id="check2"><a class="header-anchor" href="#check2">Â¶</a>check2</h2><p><code>next_index_</code>å…¶å®å°±æ˜¯TCPä¸­çš„æœ¯è¯­acknoï¼Œè€Œ<code>available capacity</code>å…¶å®å°±æ˜¯window sizeã€‚</p><h3 id="64-bit-index-to-32-bit-ackno"><a class="header-anchor" href="#64-bit-index-to-32-bit-ackno">Â¶</a>64-bit index to 32-bit ackno</h3><p>åœ¨TCPä¸­acknoåªæœ‰32ä½ï¼Œä½†æ˜¯bytestreamçš„ä¸‹æ ‡æ˜¯64ä½çš„ï¼Œè€Œä¸”acknoä»ä¸€ä¸ªéšæœºå€¼å¼€å§‹ã€‚</p><ul><li>ISNï¼šinitial sequence number</li><li>SYNï¼šbeginning of stream</li><li>FINï¼šend of strea</li></ul><p>SYNå’ŒFINåˆ†åˆ«ä¼šå ç”¨ä¸€ä¸ªåºåˆ—å·ï¼Œè¡¨ç¤ºå­—ç¬¦æµçš„å¼€å§‹å’Œç»“æŸã€‚</p><p>sequence numberå°±æ˜¯ä»ISNå¼€å§‹çš„32ä½æ•°ï¼Œabsolute numberæ˜¯ä»0å¼€å§‹çš„64ä½æ•°ï¼Œè€Œstream indexåˆ™æ˜¯åœ¨absolute numberçš„åŸºç¡€ä¸Šå¿½ç•¥SYNå’ŒFINã€‚</p><p>éš¾ç‚¹ä¸»è¦æ˜¯å‰ä¸¤ä¸ªçš„äº’ç›¸è½¬åŒ–ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> Wrap32 <span class="title">Wrap32::wrap</span><span class="params">( uint64 t n, Wrap32 zero point )</span></span>;</span><br><span class="line"><span class="function">uint64 t <span class="title">unwrap</span><span class="params">( Wrap32 zero point, uint64 t checkpoint )</span> <span class="type">const</span></span>;</span><br></pre></td></tr></table></figure><p>Wrap32æ˜¯uint32çš„åŒ…è£…ç±»ï¼Œæ— ç¬¦å·æ•°çš„æº¢å‡ºå°±æ˜¯å–æ¨¡ï¼Œæ˜¯æ­£å¸¸è¡Œä¸ºã€‚</p><p>ä¸€ä¸ªsequence numberä¼šå¯¹åº”å¤šä¸ªabsolute numberï¼ˆè‹¥xæ»¡è¶³ï¼Œåˆ™x+2^32ä¹Ÿæ»¡è¶³ï¼‰ï¼Œå› æ­¤checkpointç”¨äºæ‰¾åˆ°è·ç¦»å®ƒæœ€è¿‘çš„é‚£ä¸ªabsolute numberã€‚</p><p>æˆ‘çš„åšæ³•æ˜¯å…ˆåŠ è¶³å¤Ÿå¤šçš„2^32ï¼Œè®©å…¶å¤§äºç­‰äºcheckpointï¼Œç„¶åå†æ£€æŸ¥å‡æ‰ä¸€ä¸ª2^32ä¼šä¸ä¼šæ›´æ¥è¿‘ã€‚</p><h3 id="TCP-receiver"><a class="header-anchor" href="#TCP-receiver">Â¶</a>TCP receiver</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">TCPSenderMessage</span></span><br><span class="line">&#123;</span><br><span class="line">    Wrap32 seqno &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">bool</span> SYN &#123; <span class="literal">false</span> &#125;;</span><br><span class="line">    Buffer payload &#123;&#125;;</span><br><span class="line">    <span class="type">bool</span> FIN &#123; <span class="literal">false</span> &#125;;</span><br><span class="line">    <span class="comment">// How many sequence numbers does this segment use?</span></span><br><span class="line">    <span class="function"><span class="type">size_t</span> <span class="title">sequence_length</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> SYN + payload.<span class="built_in">size</span>() + FIN; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TCPReceiverMessage</span></span><br><span class="line">&#123;</span><br><span class="line">    std::optional&lt;Wrap32&gt; ackno &#123;&#125;;</span><br><span class="line">    <span class="type">uint16_t</span> window_size &#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TCPReceiver</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/* The TCPReceiver receives TCPSenderMessages, inserting their payload</span></span><br><span class="line"><span class="comment">    * into the Reassemble at the correct stream index. */</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">receive</span><span class="params">( TCPSenderMessage message, Reassembler&amp; reassembler, Writer&amp; inbound_stream )</span></span>;</span><br><span class="line">    <span class="comment">/* The TCPReceiver sends TCPReceiverMessages back to the TCPSender. */</span></span><br><span class="line">    <span class="function">TCPReceiverMessage <span class="title">send</span><span class="params">( <span class="type">const</span> Writer&amp; inbound_stream )</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>TCP receiveræ¥æ”¶ä¸€ä¸ªTCPæ¶ˆæ¯ï¼Œéœ€è¦ç»´æŠ¤ISNï¼ˆå³å¸¦æœ‰SYNæ ‡å¿—çš„TCPæ¶ˆæ¯çš„seqnoï¼›ä»è€Œå¯ä»¥åœ¨SNå’ŒASNä¹‹é—´è½¬æ¢ï¼‰ï¼Œç„¶åæ”¾åˆ°Reassembleré‡Œé‡ç»„åˆ°ring bufferä¸­çš„æ­£ç¡®ä½ç½®ã€‚å¦‚æœè¯¥TCPæ®µå¸¦æœ‰FINæ ‡å¿—ï¼Œåˆ™å…³é—­bufferã€‚</p><p>å‘é€è€…éœ€è¦ç»´æŠ¤acknoï¼ˆè¿™é‡Œé‡‡ç”¨çš„æ˜¯ç´¯è®¡ç¡®è®¤ï¼Œå·²ç»é‡ç»„å®ŒåŠ å…¥åˆ°byte_streamçš„å­—èŠ‚æ•°+1ï¼Œè¿˜è¦è€ƒè™‘SYNå’ŒFINï¼‰å’Œwindow_sizeï¼ˆbyte_streamçš„availabel_capacityï¼‰ã€‚</p><p>ä¸€ä¸ªç»†èŠ‚æ˜¯TCPä¸­window_sizeåªæœ‰16ä½ï¼Œæ‰€ä»¥æœ€å¤§åªèƒ½æ˜¯65536ã€‚ï¼ˆæ—§ç‰ˆçš„å®éªŒä»£ç ä¸­ï¼Œreceiverè¿”å›çš„window_sizeæ˜¯<code>size_t</code>çš„ï¼Œè€Œæˆªæ–­é€»è¾‘ä¸¢ç»™äº†<code>TCPConnect</code>å¤„ç†ï¼Œæœ‰ç‚¹å‘ï¼‰</p><h2 id="check3"><a class="header-anchor" href="#check3">Â¶</a>check3</h2><h3 id="TCP-sender"><a class="header-anchor" href="#TCP-sender">Â¶</a>TCP sender</h3><p>TCP senderä¸æ–­å‘é€TCPæ¶ˆæ¯ï¼ˆåˆ†æˆä¸€ä¸ªä¸ªsegmentï¼Œç¡®ä¿æ¯ä¸ªsegmentä¸è¶…è¿‡æ¥æ”¶æ–¹çš„window_sizeï¼Œå¹¶ä¸”paylodçš„é•¿åº¦ä¸è¶…è¿‡ç»™å®šçš„MTUï¼ˆæ–‡æ¡£å†™çš„æ˜¯1492ï¼Œä½†ä»£ç é‡Œæ˜¯1000ï¼‰ï¼‰ï¼Œç„¶åæ ¹æ®æ¥æ”¶æ–¹å›åº”çš„acknoè¿½è¸ªå“ªäº›segmentè¢«æ­£ç¡®æ”¶åˆ°ï¼Œå“ªäº›segmentéœ€è¦è¶…æ—¶é‡ä¼ ã€‚</p><p>å¦‚æœæŸä¸ªsegmentè¢«éƒ¨åˆ†æ”¶åˆ°ï¼Œæ­¤æ—¶éœ€è¦åˆ†å‰²è¯¥segmentã€‚ç±»ä¼¼åœ°ï¼ŒæŸäº›è¿ç»­çš„segmentå¯ä»¥åˆå¹¶èµ·æ¥é‡ä¼ ã€‚ä½†æ˜¯æœ¬å®éªŒä¸è€ƒè™‘è¿™äº›ã€‚</p><p>åœ¨è¿˜æœªæ”¶åˆ°æ¥æ”¶æ–¹çš„window_sizeæ—¶ï¼Œé»˜è®¤windows_sizeä¸º1ã€‚</p><p>éœ€è¦ç»´æŠ¤ç­‰å¾…å‘é€çš„segmentsï¼ˆ<code>pending_segments_</code>ï¼Œä¸€ä¸ªé˜Ÿåˆ—ï¼‰å’Œæ­£åœ¨å‘é€ï¼ˆå°šæœªç¡®è®¤é€è¾¾ï¼‰çš„segmentsï¼ˆ<code>in_flight_segments_</code>ï¼Œä¸€ä¸ªæŒ‰ç…§seqnoå‡åºçš„ä¼˜å…ˆé˜Ÿåˆ—ï¼‰å½“å‰çš„æ¥æ”¶çª—å£ä¸º<code>[ackno_, ackno_ + window_size_)</code></p><p>éš¾ç‚¹ä¸»è¦æ˜¯å¾ˆå¤šç»†èŠ‚é—®é¢˜ã€‚</p><ul><li>å°†bufferåˆ†å‰²ä¸ºè‹¥å¹²segment<ul><li>å…ˆæ ¹æ®å·²å‘é€çš„seqnoå’Œæ¥æ”¶çª—å£çš„å³ä¾§è®¡ç®—è¿˜å¯ä»¥å‘é€çš„å¤§å°<code>window_space</code></li><li>æ ¹æ®<code>window_space</code>å’Œ<code>TCPConfig::MAX_PAYLOAD_SIZE</code>è®¡ç®—å½“å‰segmentçš„é•¿åº¦</li><li><code>window_space</code>éœ€è¦è€ƒè™‘SYNå’ŒFINçš„å ç”¨ï¼Œè€Œ<code>TCPConfig::MAX_PAYLOAD_SIZE</code>åªæ˜¯é™åˆ¶payloadçš„å¤§å°</li><li>å½“<code>window_space</code>ä¸º0æ—¶ï¼Œå¦‚æœæ²¡æœ‰åœ¨å‘é€ä¸­çš„æ®µï¼Œå¹¶ä¸”bufferè¿˜ä¸ä¸ºç©ºæˆ–è€…bufferå·²ç»ç»“æŸï¼ˆbufferä¸ºç©ºä¸”å·²ç»å…³é—­ï¼‰ä½†è¿˜æ²¡å‘é€FINï¼ˆæ¢å¥è¯è¯´å°±æ˜¯å½“å‰è¿˜æœ‰è¦å‘é€çš„ä¸œè¥¿ï¼‰ï¼Œåˆ™åº”å°†window_spaceè®¾ä¸º1ï¼Œå¦åˆ™å°±å¾—ä¸åˆ°æ¥æ”¶æ–¹çš„acknoåé¦ˆï¼Œæ— æ³•æ›´æ–°äº†</li><li>å¦‚æœbufferå·²ç»ç»“æŸï¼Œæ­¤æ—¶éœ€è¦è®¾ç½®FINï¼Œä½†è¿˜è¦è€ƒè™‘window_spaceçš„é™åˆ¶</li><li>å¦‚ä½•åˆ¤æ–­æ˜¯å¦è¿˜æœ‰è¦å‘é€çš„segment<ul><li>bufferä¸ºç©ºï¼Œä½†æ˜¯è¿˜æ²¡å‘SYNã€‚SYNæ˜¯ä¸€å®šè¦å‘é€çš„</li><li>bufferå·²ç»ç»“æŸï¼Œä½†æ˜¯è¿˜æ²¡å‘FINï¼Œè¿™ç§æƒ…å†µæ˜¯å› ä¸º<code>window_space</code>çš„é™åˆ¶ï¼Œæ²¡èƒ½åœ¨å‰ä¸€ä¸ªsegmentè®¾ç½®FIN</li><li>bufferéç©ºï¼Œè‚¯å®šè¿˜å¾—å‘</li></ul></li></ul></li><li>å‘é€segment<ul><li>å–å‡ºseqnoæœ€å°çš„é‚£ä¸ªsegmentï¼Œå¦‚æœé‡ä¼ è®¡æ—¶æœªå¼€å§‹ï¼Œå°±åˆå§‹åŒ–è®¡æ—¶</li></ul></li><li>æ¥æ”¶åˆ°TCPReceiverMessage<ul><li>acknoå¯èƒ½å¤§äºå·²ç»å‘é€çš„æœ€å¤§çš„seqno+1ï¼Œå³è¯¥acknoæ˜¯å¼‚å¸¸çš„ï¼Œæ­¤æ—¶åº”è¯¥å¿½ç•¥</li><li>acknoå¯èƒ½ä¸ºç©ºï¼Œä½†å·²ç»æ”¶åˆ°è¿‡éç©ºçš„acknoï¼Œè¯´æ˜æ˜¯é‡ä¼ è¿‡çš„å»¶è¿Ÿæ®µï¼Œå¿½ç•¥</li><li>å¦åˆ™æ›´æ–°window_sizeå’Œackno</li><li>åˆ æ‰æ­£åœ¨å‘é€é˜Ÿåˆ—ä¸­ç¡®è®¤è¢«æ”¶åˆ°çš„segments</li><li>å¦‚æœå­˜åœ¨æˆåŠŸæ¥æ”¶çš„segmentsï¼Œåˆ™é‡ç½®è¶…æ—¶é‡ä¼ ï¼Œå¦‚æœæ²¡æœ‰æ­£åœ¨å‘é€çš„segmentsäº†ï¼Œè¿˜åº”è¯¥å…³é—­è®¡æ—¶å™¨</li></ul></li><li>å¢åŠ æ—¶é—´<ul><li>åœ¨è¾¾åˆ°é‡ä¼ æ—¶é—´æ—¶ï¼Œä»…é‡ä¼ åºåˆ—å·æœ€å°çš„é‚£ä¸ªsegmentï¼ˆä»<code>in_flight</code>ç§»åŠ¨åˆ°<code>pending</code>é‡Œï¼‰ï¼Œå¹¶é‡ç½®è®¡æ—¶</li><li>ä»…åœ¨<code>window_size</code>å¤§äº0æ—¶ï¼Œæ‰ç¿»å€é‡ä¼ æ—¶é—´</li></ul></li></ul><h2 id="TCP-Connection"><a class="header-anchor" href="#TCP-Connection">Â¶</a>TCP Connection</h2><p>å°è£…äº†å‰é¢çš„<code>TCPReceiver</code>å’Œ<code>TCPSender</code>ã€‚</p><p>è™½ç„¶æ˜¯å®ç°äº†TCPçš„çŠ¶æ€æœºï¼Œä½†æˆ‘åœ¨å†™çš„æ—¶å€™å®Œå…¨æ²¡æœ‰ç”¨ä»»ä½•<code>state</code>ï¼Œä¸è¿‡è¿˜æ˜¯æ€»ç»“ä¸€ä¸‹TCPçš„çŠ¶æ€ä»¥åŠè½¬æ¢ã€‚</p><ul><li>LISTENï¼šç­‰å¾…å¯¹æ–¹è¿æ¥</li><li>SYN_RCVDï¼šæ”¶åˆ°å¯¹æ–¹çš„SYN</li><li>SYN_SENTï¼šæœ¬æ–¹å‘é€äº†SYN</li><li>ESTABLISHEDï¼šå®Œæˆä¸‰æ¬¡æ¡æ‰‹</li><li>CLOSE_WAITï¼šå¯¹æ–¹å‘é€äº†FIN</li><li>LAST_ACKï¼šCLOSE_WAITåï¼Œæœ¬æ–¹å‘é€äº†FIN</li><li>FIN_WAIT_1ï¼šæœ¬æ–¹å‘é€äº†FINï¼Œè¿˜æœªæ”¶åˆ°ACK</li><li>FIN_WAIT_2ï¼šæ”¶åˆ°äº†ä¹‹å‰å‘é€çš„FINçš„ACK</li><li>CLOSINGï¼šåœ¨æœ¬æ–¹å‘é€äº†FINåï¼Œä¹Ÿæ”¶åˆ°äº†å¯¹æ–¹çš„FIN</li><li>TIME_WAITï¼šåŒæ–¹éƒ½å‘é€äº†FINå’ŒACKï¼Œç­‰å¾…2 MSL</li><li>CLOSEDï¼šè¿æ¥æ­£å¸¸å…³é—­</li><li>RESETï¼šè¿æ¥å¼‚å¸¸å…³é—­</li></ul><p>åœ¨spongeä¸­Receiverå’ŒSenderæ˜¯åˆ†å¼€å®ç°çš„ï¼Œå› æ­¤å„è‡ªæœ‰ç‹¬ç«‹çš„çŠ¶æ€ï¼š</p><p>Receiverï¼š</p><ul><li>ERRORï¼šbufferè¢«è®¾ä¸ºerror</li><li>LISTENï¼šè¿˜æœªæ”¶åˆ°ackno</li><li>SYN_RECVï¼šæ”¶åˆ°acknoï¼Œä½†bufferè¿˜æ²¡ç»“æŸ</li><li>FIN_RECVï¼šæ”¶åˆ°acknoï¼Œbufferå·²ç»ç»“æŸ</li></ul><p>Senderï¼š</p><ul><li>ERRORï¼šbufferè¢«è®¾ä¸ºerror</li><li>CLOSEDï¼šnext_seqä¸º0</li><li>SYN_SENTï¼šnext_seq &gt; 0ï¼Œnext_seq = bytes_in_flightï¼Œå³è¿˜æ²¡æœ‰åº”ç­”</li><li>SYN_ACKEDï¼šbufferè¿˜æ²¡ç©ºæˆ–è¿˜æ²¡ç»“æŸï¼Œæˆ–è€…bufferçš„å¤§å°+2å°äºnext_seqï¼ˆç”±äºçª—å£å¤§å°è¿˜æœ‰æ²¡å‘çš„TCPæ®µï¼‰ï¼Œè¯´æ˜è¿˜æœ‰æ²¡æ”¶åˆ°çš„ack</li><li>FIN_SENTï¼šè¿˜æœ‰bytes_in_flight</li><li>FIN_ACKEDï¼šæ²¡æœ‰bytes_in_flight</li></ul><p>Senderå’ŒReceiverå„è‡ªçš„çŠ¶æ€ç»„åˆå¯¹åº”äº†TCPæ•´ä½“çš„çŠ¶æ€ã€‚</p><p><a data-fancybox="gallery" data-src="/post-images/receiver-state.png" data-caption="receiver-state"><img src="/post-images/receiver-state.png" alt="receiver-state"></a><a data-fancybox="gallery" data-src="/post-images/sender-state.png" data-caption="sender-state"><img src="/post-images/sender-state.png" alt="sender-state"></a><a data-fancybox="gallery" data-src="/post-images/tcp-state.png" data-caption="tcp-state"><img src="/post-images/tcp-state.png" alt="tcp-state"></a></p><p>è¿™é‡Œçš„éš¾ç‚¹ä¸»è¦æ˜¯åˆ¤æ–­è¿æ¥æ˜¯å¦æ´»è·ƒä¸Šã€‚</p><ul><li>å‘èµ·è¿æ¥<ul><li>å‘é€ä¸€ä¸ªå¸¦SYNæ ‡è®°çš„TCPæ®µï¼Œå› ä¸ºæ˜¯ä¸»åŠ¨å‘èµ·æ–¹ï¼Œæ²¡æœ‰ackï¼Œä½†ä»éœ€è¦è®¾ç½®window_size</li></ul></li><li>å‘é€æ•°æ®<ul><li>å†™åˆ°senderçš„bufferé‡Œï¼Œå¦‚æœæœ‰å‘é€çš„æ®µï¼Œåˆ™<ul><li>è¡¥å……acknoå’Œwindow_size</li></ul></li></ul></li><li>æ¥æ”¶TCPæ®µ<ul><li>æ”¶åˆ°çš„å¸¦æœ‰RSTæ ‡è®°ï¼Œè®¾ç½®ä¸æ´»è·ƒå³å¯</li><li>å¸¦æœ‰ACKæ ‡è®°ï¼Œéœ€è¦é€šçŸ¥receiveræ›´æ–°acknoå’Œwindow_sizeï¼Œæ­¤æ—¶å¦‚æœå·²ç»å‘é€è¿‡SYNï¼Œåˆ™å¯èƒ½æœ‰æ–°çš„æ®µå¯ä»¥å‘é€ï¼Œæ‰€ä»¥è°ƒç”¨<code>write(&quot;&quot;)</code></li><li>å‘ç»™receiverè¿›è¡Œé‡ç»„</li><li>å¦‚æœè¯¥æ®µå æœ‰æ•°æ®ï¼Œåˆ™éœ€è¦å›å¤ä¸€ä¸ªackè¡¨ç¤ºæ”¶åˆ°ï¼Œå¦‚æœä¸å æ•°æ®å°±ä¸éœ€è¦å›äº†ï¼Œå¦åˆ™ä¼šæ— é™pingpong<ul><li>å¦‚æœè¯¥æ®µå¸¦æœ‰FINï¼Œå¹¶ä¸”æœ¬æ–¹è¿˜æœªå‘é€FINï¼Œè¿™è¯´æ˜æœ¬æ³•æ˜¯è¢«åŠ¨å…³é—­è¿æ¥çš„ï¼Œæ­¤æ—¶ä¸å†éœ€è¦lingerï¼Œåªæœ‰ä¸»åŠ¨æ–¹éœ€è¦</li><li>å¦‚æœè¿˜æ²¡å‘é€è¿‡SYNï¼Œåˆ™éœ€è¦è®¾ç½®SYNï¼Œæ­¤æ—¶å¤„äºä¸‰æ¬¡æ¡æ‰‹çš„ç¬¬äºŒæ­¥</li><li>è®¾ç½®acknoå’Œwindow_size</li></ul></li></ul></li><li>è¿æ¥æ˜¯å¦æ´»è·ƒ<ul><li>å¦‚æœæ”¶å‘è¿‡RSTæ ‡è®°çš„æ®µï¼Œæ­¤æ—¶å·²ç»è®¾ç½®ä¸ºä¸æ´»è·ƒäº†</li><li>å¦‚æœè¿˜æœ‰æœªé‡ç»„çš„å­—èŠ‚ï¼Œæˆ–è€…è¾“å…¥è¿˜æ²¡æœ‰ç»“æŸï¼Œè¯´æ˜æ´»è·ƒ</li><li>å¦‚æœè¿˜æ²¡å‘é€FINï¼Œè¯´æ˜æ´»è·ƒ</li><li>å¦‚æœæœ‰æ­£åœ¨å‘é€çš„å­—èŠ‚ï¼Œè¯´æ˜æ´»è·ƒ</li><li>å¦‚æœéœ€è¦lingerï¼Œåˆ™åœ¨10å€çš„åˆå§‹é‡ä¼ æ—¶é—´åä¸æ´»è·ƒ</li><li>ä¸éœ€è¦lingerï¼Œåˆ™ç›´æ¥ä¸æ´»è·ƒ</li></ul></li><li>å¢åŠ æ—¶é—´<ul><li>ç»™senderå¢åŠ æ—¶é—´ï¼Œå¦‚æœæœ‰é‡ä¼ çš„æ®µï¼Œåˆ™<ul><li>è®¾ç½®å®ƒçš„acknoå’Œwindow_size</li><li>å¦‚æœé‡ä¼ æ—¶é—´è¶…è¿‡8æ¬¡ï¼Œè®¾ç½®RSTæ ‡è®°ï¼Œå¹¶è®¾ç½®è¿æ¥ä¸æ´»è·ƒ</li></ul></li></ul></li><li>å…³é—­è¾“å…¥<ul><li>å…³é—­åè¿˜éœ€è¦å‘é€FINæ ‡è®°çš„TCPæ®µï¼Œè°ƒç”¨write(â€œâ€)å³å¯</li></ul></li><li>å…³é—­è¿æ¥<ul><li>å¦‚æœææ„çš„æ—¶å€™è¿æ¥è¿˜å¤„äºæ´»è·ƒçŠ¶æ€ï¼Œåˆ™å‘é€ä¸€ä¸ªRSTæ ‡è®°çš„TCPæ®µï¼Œå¹¶è®¾ç½®è¿æ¥ä¸æ´»è·ƒã€‚</li></ul></li></ul><h3 id="TCPPeer"><a class="header-anchor" href="#TCPPeer">Â¶</a>TCPPeer</h3><p>æ–°ç‰ˆå®éªŒæ²¡æœ‰è¿™éƒ¨åˆ†å†…å®¹ï¼Œä½†æ˜¯æä¾›äº†ä¸€ä¸ª<code>TCPPeer</code>çš„ç±»ã€‚</p><h2 id="CS144TCPSocket"><a class="header-anchor" href="#CS144TCPSocket">Â¶</a>CS144TCPSocket</h2><p>å­¦ä¹ æ€ä¹ˆæŠŠå‰é¢çš„ä¸œè¥¿åŒ…è£…ä¸ºä¸€ä¸ªçœŸæ­£å¯ç”¨çš„socketçš„ã€‚</p><h3 id="tcp-over-ip"><a class="header-anchor" href="#tcp-over-ip">Â¶</a>tcp_over_ip</h3><p>è´Ÿè´£åœ¨TCPæ®µå’ŒIPæ•°æ®åŒ…ä¹‹é—´è½¬æ¢ã€‚</p><p>TCPæ®µé€šè¿‡æ·»åŠ IPå¤´å˜æˆIPæ•°æ®åŒ…ï¼ŒIPå¤´åŒ…æ‹¬æºIPã€å’Œç›®çš„IPã€‚æºç«¯å£å’Œç›®çš„ç«¯å£åˆ™åœ¨TCPæ®µå¤´ä¸­è®¾ç½®ã€‚</p><p>å°†IPæ•°æ®åŒ…æ‹†è§£ä¸ºTCPæ®µæ—¶ï¼Œéœ€è¦æ£€æŸ¥æºå’Œç›®çš„åœ°å€ï¼Œå¦‚æœä¸ç¬¦åˆå°±ä¸¢å¼ƒã€‚</p><h3 id="tun"><a class="header-anchor" href="#tun">Â¶</a>tun</h3><p>TUN/TAPæ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸æä¾›çš„å®Œå…¨ç”±è½¯ä»¶å®ç°çš„è™šæ‹Ÿç½‘ç»œè®¾å¤‡ï¼Œå…¶ä¸­TAPç­‰åŒäºä¸€ä¸ªä»¥å¤ªç½‘è®¾å¤‡ï¼Œæ“ä½œä»¥å¤ªç½‘æ•°æ®å¸§ï¼›TUNæ˜¯ç½‘ç»œå±‚è®¾å¤‡ï¼Œæ“ä½œIPæ•°æ®åŒ…ã€‚</p><p>TUNè®¾å¤‡å¯ä»¥é€šè¿‡<code>ioctl</code>åˆ›å»ºï¼Œåç»­åªè¦ç”¨<code>read</code>/<code>write</code>è¯»å†™å³å¯ã€‚</p><h3 id="tuntap-adapter"><a class="header-anchor" href="#tuntap-adapter">Â¶</a>tuntap_adapter</h3><p>åŒ…è£…äº†å¯¹TUNè®¾å¤‡çš„è¯»å†™æ“ä½œã€‚</p><p>è¯»å–çš„æ—¶å€™æ˜¯è¯»åˆ°ä¸€ä¸ªIPæ•°æ®åŒ…ï¼ŒæŠŠä»–æ‹†è§£æˆTCPæ®µè¿”å›ã€‚</p><p>å†™å…¥çš„æ—¶å€™æ˜¯åœ¨æŠŠTCPæ®µå°è£…æˆIPæ•°æ®åŒ…ã€‚</p><h3 id="LocalStreamSocket"><a class="header-anchor" href="#LocalStreamSocket">Â¶</a>LocalStreamSocket</h3><p>æ˜¯<code>socket(AF_UNIX, SOCK_STREAM, 0)</code>çš„ä¸€ä¸ªåŒ…è£…ã€‚</p><h3 id="eventloop"><a class="header-anchor" href="#eventloop">Â¶</a>eventloop</h3><p>å¯¹<code>poll</code>çš„åŒ…è£…ï¼Œæ¯æ¬¡äº§ç”Ÿäº‹ä»¶å°±æ‰§è¡Œæ³¨å†Œçš„å›è°ƒå‡½æ•°ã€‚</p><h3 id="TCPSpongeSocket"><a class="header-anchor" href="#TCPSpongeSocket">Â¶</a>TCPSpongeSocket</h3><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ç”¨æˆ·æ€TCPSocketå®ç°ä¸­ï¼Œåªèƒ½è‡ªå·±åœ¨connectå‡½æ•°é‡Œè®¾ç½®æºIPå’Œç«¯å£ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> TCPOverIPv4SpongeSocket = TCPSpongeSocket&lt;TCPOverIPv4OverTunFdAdapter&gt;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CS144TCPSocket</span> : <span class="keyword">public</span> TCPOverIPv4SpongeSocket;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CS144TCPSocket::connect</span><span class="params">(<span class="type">const</span> Address &amp;address)</span> </span>&#123;</span><br><span class="line">    TCPConfig tcp_config;</span><br><span class="line">    tcp_config.rt_timeout = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    FdAdapterConfig multiplexer_config;</span><br><span class="line">    multiplexer_config.source = &#123;<span class="string">&quot;169.254.144.9&quot;</span>, <span class="built_in">to_string</span>(<span class="built_in">uint16_t</span>(<span class="built_in">random_device</span>()()))&#125;;</span><br><span class="line">    multiplexer_config.destination = address;</span><br><span class="line"></span><br><span class="line">    TCPOverIPv4SpongeSocket::<span class="built_in">connect</span>(tcp_config, multiplexer_config);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="check4"><a class="header-anchor" href="#check4">Â¶</a>check4</h2><h3 id="ARP"><a class="header-anchor" href="#ARP">Â¶</a>ARP</h3><p>NetworkInterfaceè´Ÿè´£å°†IPæ•°æ®åŒ…å°è£…æˆä»¥å¤ªç½‘æ•°æ®å¸§å‘é€åˆ°ä¸‹ä¸€è·³ï¼Œå¹¶åœ¨æ¥æ”¶åˆ°ä»¥å¤ªç½‘æ•°æ®å¸§æ—¶æ‹†å°ä¸ºåº•å±‚çš„IPæ•°æ®åŒ…ã€‚</p><p>å…³é”®æ˜¯éœ€è¦çŸ¥é“ä¸€ä¸ªIPåœ°å€å¯¹åº”çš„MACåœ°å€ï¼Œè¿™éœ€è¦ç”¨åˆ°ARPåè®®ã€‚</p><ul><li>å¦‚æœä¸çŸ¥é“ä¸‹ä¸€è·³IPçš„æ˜ å°„ï¼Œå°±å¹¿æ’­ä¸€æ¡ARPè¯·æ±‚ï¼ŒARPè¯·æ±‚çš„ç›®çš„IPä¸ºä¸‹ä¸€è·³IPï¼ŒæºIPå’ŒæºMACä¸ºè‡ªå·±çš„IPå’ŒMACï¼›å°è£…çš„ä»¥å¤ªç½‘å¸§çš„æºMACä¸ºè‡ªå·±çš„MACï¼Œç›®çš„MACä¸ºå¹¿æ’­MACã€‚å¹¶å°†è¦å‘é€çš„IPæ•°æ®åŒ…æ”¾åˆ°å¾…å‘é€é˜Ÿåˆ—ä¸­ï¼ˆ<code>pending_dgrams_</code>ï¼‰</li><li>å¿½ç•¥ç›®çš„MACä¸å±äºè‡ªå·±çš„ä»¥å¤ªç½‘å¸§</li><li>å¦‚æœæ”¶åˆ°çš„æ˜¯IPæ•°æ®åŒ…ï¼Œå°±è§£å°è¿”å›</li><li>å¦‚æœæ”¶åˆ°çš„æ˜¯ARPè¯·æ±‚ä¸”ç›®çš„IPä¸è‡ªå·±IPç›¸åŒï¼Œå°±å›å¤ä¸€æ¡ARPåº”ç­”ï¼Œå°†è‡ªå·±çš„IPåœ°å€å’ŒMACåœ°å€å¡«å…¥æºIPå’ŒæºMACä¸­ï¼Œç›®çš„IPå’ŒMACåˆ™æ˜¯å‘é€è¯·æ±‚è€…çš„IPå’ŒMAC</li><li>åŒæ—¶ï¼Œå¯¹äºæ”¶åˆ°çš„ARPè¯·æ±‚ï¼Œå¯ä»¥å­¦ä¹ å®ƒçš„æºIPå’ŒMACæ˜ å°„ï¼Œå­˜åˆ°ä¸€ä¸ªcacheä¸­ï¼Œå¹¶å°†å¯¹åº”IPç­‰å¾…çš„IPæ•°æ®åŒ…å‘é€å‡ºå»</li><li>IPå’ŒMACæ˜ å°„å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤cacheæœ‰ä¸€ä¸ªæ—¶é™ï¼ˆ30sï¼‰ï¼Œä¸ºäº†é¿å…ARPè¯·æ±‚æ³›æ´ªï¼Œåœ¨ä¸€å®šæ—¶é—´å†…ï¼ˆ5sï¼‰ä¸é‡å¤å¹¿æ’­</li></ul><p>ARPè¯·æ±‚å¯èƒ½æ°¸è¿œå¾—ä¸åˆ°å›å¤ï¼Œå¯¹åº”å‘é€çš„IPæ•°æ®åŒ…å°±æ°¸è¿œå‘ä¸å‡ºå»ï¼Œåœ¨æœ¬å®éªŒä¸­ä¸éœ€è¦è€ƒè™‘è¯¥é—®é¢˜ã€‚</p><p>cacheå¯ä»¥ç”¨<code>std::unordered_map</code>ï¼Œç”¨ä¸¤ä¸ª<code>std::queue</code>å­˜ç­‰å¾…å‘é€çš„ä»¥å¤ªç½‘å¸§å’Œç­‰å¾…ARPå›å¤åå°è£…çš„æ•°æ®åŒ…ï¼Œå†ç”¨ä¸¤ä¸ª<code>std::map</code>è®°å½•æ¯æ¬¡ARPè¯·æ±‚çš„æ—¶é—´ä»¥åŠä¿å­˜cacheçš„æ—¶é—´ã€‚</p><h2 id="check5"><a class="header-anchor" href="#check5">Â¶</a>check5</h2><h3 id="IPè·¯ç”±è¡¨"><a class="header-anchor" href="#IPè·¯ç”±è¡¨">Â¶</a>IPè·¯ç”±è¡¨</h3><p>æ·»åŠ ä¸€æ¡è·¯ç”±ä¿¡æ¯ï¼ŒåŒ…æ‹¬IPå‰ç¼€ï¼Œå‰ç¼€é•¿åº¦ï¼Œä¸‹ä¸€è·³åœ°å€ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ˜¯ç›´è¿åœ°å€ï¼‰ï¼Œå¯¹åº”çš„NetworkInterfaceã€‚</p><p>è·¯ç”±è¡¨ç”¨<code>std::array&lt;std::unordered_map&lt;uint32_t, std::pair&lt;std::optional&lt;Address&gt;, uint32_t&gt;&gt;, 33&gt;</code>å®ç°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_route</span><span class="params">(<span class="type">uint32_t</span> route_prefix,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">uint8_t</span> prefix_length,</span></span></span><br><span class="line"><span class="params"><span class="function">    optional&lt;Address&gt; next_hop,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="type">size_t</span> interface_num)</span></span>;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æœ€é•¿åŒ¹é…åŸåˆ™æŸ¥æ‰¾å¯¹åº”çš„è·¯ç”±ï¼Œå°†IPæ•°æ®åŒ…è½¬äº¤ç»™å¯¹åº”çš„NetworkInterfaceå‘é€ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">route</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªç»†èŠ‚æ˜¯prefix_lengthä¸º0éœ€è¦ç‰¹æ®Šè€ƒè™‘ï¼Œå› ä¸ºä½ç§»32ä½æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>WALé¢„å†™æ—¥å¿—</title>
      <link href="/2023/11/13/WAL%E9%A2%84%E5%86%99%E6%97%A5%E5%BF%97/"/>
      <url>/2023/11/13/WAL%E9%A2%84%E5%86%99%E6%97%A5%E5%BF%97/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>minidb</title>
      <link href="/2023/11/13/minidb/"/>
      <url>/2023/11/13/minidb/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>smallchat</title>
      <link href="/2023/11/13/smallchat/"/>
      <url>/2023/11/13/smallchat/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>cppæ¨¡æ¿</title>
      <link href="/2023/11/11/cpp%E6%A8%A1%E6%9D%BF/"/>
      <url>/2023/11/11/cpp%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h2 id="decltype"><a class="header-anchor" href="#decltype">Â¶</a>decltype</h2><p><code>decltype(x)</code>å’Œ<code>decltype((x))</code>æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p><p>ç¬¬ä¸€ä¸ªå…¶å®æ˜¯<code>decltype(identifier)</code>ï¼Œç¬¬äºŒä¸ªåˆ™æ˜¯<code>decltype(expression)</code>ã€‚</p><h2 id="std-decay"><a class="header-anchor" href="#std-decay">Â¶</a>std::decay</h2><p>æ‰§è¡Œä¸å‡½æ•°å‚æ•°å€¼ä¼ é€’æ—¶ç›¸åŒçš„ç±»å‹é€€åŒ–ã€‚</p><ul><li>æ•°ç»„å’Œæ•°ç»„çš„å¼•ç”¨é€€åŒ–ä¸ºæŒ‡é’ˆ</li><li>å‡½æ•°å’Œå‡½æ•°çš„å¼•ç”¨ä¼šæ·»åŠ æŒ‡é’ˆ</li><li>å¦åˆ™æ‰§è¡Œ<code>std::remove_cvref</code>ï¼ˆå³<code>std::remove_cv&lt;std::remove_reference&lt;T&gt;&gt;</code>ï¼Œå…ˆç§»é™¤å¼•ç”¨ï¼Œå†ç§»é™¤é¡¶å±‚CVï¼‰</li></ul><h2 id="void-t"><a class="header-anchor" href="#void-t">Â¶</a>void_t</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt; <span class="keyword">class</span>... &gt;</span><br><span class="line"><span class="keyword">using</span> <span class="type">void_t</span> = <span class="type">void</span>;</span><br></pre></td></tr></table></figure><h2 id="constant"><a class="header-anchor" href="#constant">Â¶</a>constant</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt; <span class="keyword">class</span> <span class="title class_">T</span>, T v &gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">integral_constant</span>;</span><br><span class="line"><span class="keyword">template</span>&lt; <span class="type">bool</span> B &gt;</span><br><span class="line"><span class="keyword">using</span> bool_constant = integral_constant&lt;<span class="type">bool</span>, B&gt;;</span><br></pre></td></tr></table></figure><h2 id="type-identity"><a class="header-anchor" href="#type-identity">Â¶</a>type_identity</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt; <span class="keyword">class</span> <span class="title class_">T</span> &gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">type_identity</span>;</span><br></pre></td></tr></table></figure><h2 id="is-aggregate"><a class="header-anchor" href="#is-aggregate">Â¶</a>is_aggregate</h2><p>èšåˆç±»å‹æ˜¯ï¼š</p><ul><li>æ•°ç»„</li><li>ç±»<ul><li>æ²¡æœ‰ç”¨æˆ·å®šä¹‰æˆ–é›†æˆçš„æ„é€ å‡½æ•°</li><li>æ²¡æœ‰ç§æœ‰æˆ–ä¿æŠ¤çš„éé™æ€æˆå‘˜</li><li>æ²¡æœ‰è™šå‡½æ•°</li></ul></li></ul><p>èšåˆç±»å‹å¯ä»¥é€šè¿‡èšåˆåˆå§‹åŒ–ï¼ˆå³å¤§æ‹¬å·ï¼‰ã€‚æ­¤å¤–åµŒå¥—çš„å¤§æ‹¬å·å¯ä»¥çœç•¥ã€‚</p><h2 id="declval"><a class="header-anchor" href="#declval">Â¶</a>declval</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt; <span class="keyword">class</span> <span class="title class_">T</span> &gt;</span><br><span class="line"><span class="keyword">typename</span> std::add_rvalue_reference&lt;T&gt;::<span class="function">type <span class="title">declval</span><span class="params">()</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure><p>å°†ç±»å‹è½¬ä¸ºå¼•ç”¨ç±»å‹ï¼Œä»è€Œå¯ä»¥ä½¿ç”¨å®ƒçš„ç±»æˆå‘˜å‡½æ•°ï¼Œè€Œä¸éœ€è¦ç»è¿‡æ„é€ ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ˆå›æº¯</title>
      <link href="/2023/11/05/%E6%A0%88%E5%9B%9E%E6%BA%AF/"/>
      <url>/2023/11/05/%E6%A0%88%E5%9B%9E%E6%BA%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="x86-64å¸¸ç”¨å¯„å­˜å™¨"><a class="header-anchor" href="#x86-64å¸¸ç”¨å¯„å­˜å™¨">Â¶</a>x86-64å¸¸ç”¨å¯„å­˜å™¨</h2><ul><li><code>%rax</code>ï¼ˆç´¯åŠ ï¼‰ï¼šå‡½æ•°è¿”å›å€¼</li><li><code>%rsp</code>ï¼šæ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼ˆæŒ‡å‘æ ˆé¡¶ï¼‰</li><li><code>%rbp</code>ï¼šæ ˆåŸºå€å¯„å­˜å™¨ï¼ˆæŒ‡å‘æ ˆåº•ï¼‰</li><li><code>%rip</code>ï¼šæŒ‡ä»¤å¯„å­˜å™¨ï¼ŒæŒ‡å‘è¦è¯»å–æŒ‡ä»¤çš„åœ°å€</li><li><code>%rdi</code>ï¼ˆç›®çš„ç´¢å¼•ï¼‰ã€<code>%rsi</code>ï¼ˆæºç´¢å¼•ï¼‰ã€<code>%rdx</code>ï¼ˆæ•°æ®ï¼‰ã€<code>%rcx</code>ï¼ˆè®¡æ•°ï¼‰ã€<code>%r8</code>ã€<code>%r9</code>ï¼šåˆ†åˆ«å¯¹åº”1ã€2â€¦ä¸ªå‡½æ•°å‚æ•°</li><li><code>%rbx</code>ï¼ˆåŸºå€ï¼‰ã€<code>%rbp</code>ã€<code>%r12</code>ã€<code>%r13</code>ã€<code>%r14</code>ã€<code>%r15</code>ï¼šæ•°æ®å­˜å‚¨ï¼Œéµå®ˆè¢«è°ƒç”¨è€…ä¿å­˜å½’çº¦</li><li><code>%r10</code>ã€<code>%r11</code>ï¼šæ•°æ®å­˜å‚¨ï¼Œéµå®ˆè°ƒç”¨è€…ä¿å­˜å½’çº¦</li></ul><p>å…¶ä¸­<code>%rxx</code>çš„ä½32ä½å¯ä»¥ç”¨ç›¸åº”çš„<code>%exx</code>è®¿é—®ï¼Œ<code>%rx</code>çš„ä½32ä½å¯ä»¥ç”¨<code>%rxd</code>è®¿é—®ã€‚</p><h2 id="å‡½æ•°è°ƒç”¨è¿‡ç¨‹"><a class="header-anchor" href="#å‡½æ•°è°ƒç”¨è¿‡ç¨‹">Â¶</a>å‡½æ•°è°ƒç”¨è¿‡ç¨‹</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 421. æ•°ç»„ä¸­ä¸¤ä¸ªæ•°çš„æœ€å¤§å¼‚æˆ–å€¼</title>
      <link href="/2023/11/04/Leetcode-421-%E6%95%B0%E7%BB%84%E4%B8%AD%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%9A%84%E6%9C%80%E5%A4%A7%E5%BC%82%E6%88%96%E5%80%BC/"/>
      <url>/2023/11/04/Leetcode-421-%E6%95%B0%E7%BB%84%E4%B8%AD%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%9A%84%E6%9C%80%E5%A4%A7%E5%BC%82%E6%88%96%E5%80%BC/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>æ±‚æ•°ç»„<code>num</code>ä¸­ä»»æ„ä¸¤ä¸ªæ•°å¼‚æˆ–çš„æœ€å¤§å€¼ã€‚</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>æ˜¾ç„¶å¯ä»¥ç”¨01å­—å…¸æ ‘ã€‚</p><p>Leetcodeé¢˜ä¸€èˆ¬ä¸éœ€è¦è€ƒè™‘deleteé—®é¢˜ï¼Œè¿™ç§é¢˜è¿˜æ˜¯å®šä¹‰ä¸€ä¸ªå…¨å±€çš„æ•°æ®ç»“æ„å’Œä¸€ä¸ªå…¨å±€çš„å†…å­˜æ± æ¯”è¾ƒæ–¹ä¾¿ã€‚</p><p>ä½†æ˜¯Leetcodeæœ‰ä¸€ä¸ªå‘æ˜¯æ‰€æœ‰æµ‹ä¾‹æ˜¯åœ¨ä¸€ä»½ä»£ç é‡Œä¸€èµ·è¿è¡Œçš„ï¼Œå› æ­¤è¿˜éœ€è¦è€ƒè™‘æ¸…ç©ºé—®é¢˜ï¼Œå½“æ—¶å‘ç°å…¨å±€é›¶åˆå§‹åŒ–çš„<code>nxt</code>æ•°ç»„çš„å€¼éé›¶ï¼Œdebugäº†å¥½ä¹…æ‰æ„è¯†åˆ°æ˜¯è¿™ä¸ªåŸå› ï¼Œè¿˜ä»¥ä¸ºæ˜¯ä»€ä¹ˆå¥‡å¥‡æ€ªæ€ªçš„æœªå®šä¹‰è¡Œä¸ºã€‚</p><p>è¿˜æœ‰ä¸€ç‚¹æ˜¯å­—å…¸æ ‘çš„å¤§å°åº”è¯¥æ˜¯<code>N * BIT_NUM</code>çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">7e6</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    Node* nxt[<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="type">static</span> Node* <span class="title">newNode</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> x = (v &gt;&gt; b) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (!nxt[x]) nxt[x] = Node::<span class="built_in">newNode</span>();</span><br><span class="line">        <span class="keyword">if</span> (b) nxt[x]-&gt;<span class="built_in">insert</span>(v, b - <span class="number">1</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (b &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> x = (v &gt;&gt; b) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (nxt[!x]) &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; b) | nxt[!x]-&gt;<span class="built_in">ask</span>(v, b - <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nxt[x]) &#123;</span><br><span class="line">            <span class="keyword">return</span> nxt[x]-&gt;<span class="built_in">ask</span>(v, b - <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; nodes[N];</span><br><span class="line"></span><br><span class="line"><span class="function">Node* <span class="title">Node::newNode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> nodes + (++tot);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">findMaximumXOR</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        Node* root = nodes;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">            ans = <span class="built_in">max</span>(ans, root-&gt;<span class="built_in">ask</span>(num, <span class="number">30</span>));</span><br><span class="line">            root-&gt;<span class="built_in">insert</span>(num, <span class="number">30</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= tot; i++) &#123;</span><br><span class="line">            nodes[i].nxt[<span class="number">0</span>] = nodes[i].nxt[<span class="number">1</span>] = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        tot = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™é¢˜è¿˜æœ‰æ›´ç®€å•çš„åšæ³•ï¼Œä»é«˜ä½å¾€ä½ä½æšä¸¾ï¼Œå¿½ç•¥ä½ä½ï¼Œç„¶åçœ‹å½“å‰ä½èƒ½ä¸èƒ½å–1ï¼ˆç”¨unordered_setæ£€æŸ¥å³å¯ï¼‰ï¼Œå…¶å®å’ŒäºŒåˆ†å·®ä¸å¤šã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¿«é€Ÿå­—ç¬¦ä¸²å‹ç¼©</title>
      <link href="/2023/11/04/%E5%BF%AB%E9%80%9F%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8E%8B%E7%BC%A9/"/>
      <url>/2023/11/04/%E5%BF%AB%E9%80%9F%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8E%8B%E7%BC%A9/</url>
      
        <content type="html"><![CDATA[<h2 id="é€šç”¨å‹ç¼©ç®—æ³•"><a href="#é€šç”¨å‹ç¼©ç®—æ³•" class="headerlink" title="é€šç”¨å‹ç¼©ç®—æ³•"></a>é€šç”¨å‹ç¼©ç®—æ³•</h2><p>zstdã€snappyã€lz4ã€‚</p><h2 id="å¸¸é‡ç¼–ç "><a href="#å¸¸é‡ç¼–ç " class="headerlink" title="å¸¸é‡ç¼–ç "></a>å¸¸é‡ç¼–ç </h2><h2 id="æ¸¸ç¨‹ç¼–ç "><a href="#æ¸¸ç¨‹ç¼–ç " class="headerlink" title="æ¸¸ç¨‹ç¼–ç "></a>æ¸¸ç¨‹ç¼–ç </h2><h2 id="ä½æ‰“åŒ…"><a href="#ä½æ‰“åŒ…" class="headerlink" title="ä½æ‰“åŒ…"></a>ä½æ‰“åŒ…</h2><h2 id="å‚ç…§å¸§"><a href="#å‚ç…§å¸§" class="headerlink" title="å‚ç…§å¸§"></a>å‚ç…§å¸§</h2><h2 id="å­—å…¸ç¼–ç "><a href="#å­—å…¸ç¼–ç " class="headerlink" title="å­—å…¸ç¼–ç "></a>å­—å…¸ç¼–ç </h2><p>å°†æ¯ä¸ªå­—ç¬¦ä¸²ä½œä¸ºkeyæ˜ å°„æˆä¸€ä¸ªæ›´ç®€çŸ­çš„valueã€‚</p><h2 id="Fast-Static-Symbol-Table-FSST"><a href="#Fast-Static-Symbol-Table-FSST" class="headerlink" title="Fast Static Symbol Table (FSST)"></a>Fast Static Symbol Table (FSST)</h2><p>å¿«é€Ÿçš„å­—ç¬¦ä¸²å‹ç¼©ç®—æ³•ï¼Œå¹¶å…è®¸éšæœºè®¿é—®ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‹ç¼©ä½å›¾</title>
      <link href="/2023/11/04/%E5%8E%8B%E7%BC%A9%E4%BD%8D%E5%9B%BE/"/>
      <url>/2023/11/04/%E5%8E%8B%E7%BC%A9%E4%BD%8D%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<p>æ™®é€šä½å›¾çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œåœ¨é¢å¯¹ç¨€ç–å­˜å‚¨æ—¶ä¼šæµªè´¹å¾ˆå¤šç©ºé—´ã€‚ï¼Œå› æ­¤äº§ç”Ÿäº†å‹ç¼©ä½å›¾</p><p>å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆåˆ¤é‡ï¼‰å’Œhyperloglogï¼ˆåŸºæ•°ï¼‰éƒ½æ˜¯è¿‘ä¼¼ç®—æ³•ï¼Œå¹¶ä¸”åªæ”¯æŒå¢åŠ ï¼Œä¸æ”¯æŒåˆ é™¤ã€‚</p><h2 id="roaring-bit-map"><a class="header-anchor" href="#roaring-bit-map">Â¶</a>roaring bit map</h2><p>roaring bit mapç”±ä¸€ä¸ªroaring arrayç»„æˆï¼Œå…¶åŒ…æ‹¬ä¸‰ä¸ªæˆå‘˜ï¼š</p><ul><li><code>short[] keys</code></li><li><code>Container[] values</code></li><li><code>int size</code></li></ul><p>ä¸€ä¸ªæ’å…¥çš„32ä½intä¼šè¢«åˆ†ä¸ºé«˜16ä½å’Œä½16ä½ï¼Œé«˜16ä½ç”¨äºç´¢å¼•keysï¼ˆä¿æŒæœ‰åºï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾ï¼‰ï¼Œä½16ä½ç”¨äºåœ¨Containerä¸­ç´¢å¼•ï¼ˆç±»ä¼¼åœ°ï¼Œ64ä½ä¼šåˆ†ä¸ºé«˜32ä½å’Œä½32ä½ï¼‰ã€‚</p><p>Containeråˆ†ä¸ºArrayContainerï¼ˆæœ‰åºæ•°ç»„ï¼Œæ•°æ®é‡å°äº4096æ—¶ä½¿ç”¨ï¼‰ã€BitMapContainerï¼ˆæœªå‹ç¼©çš„ä½å›¾ï¼‰å’ŒRunContainerï¼ˆä½¿ç”¨è¡Œç¨‹é•¿åº¦å‹ç¼©ç®—æ³•ï¼Œå¯¹è¿ç»­æ•°æ®æœ‰è¾ƒå¥½çš„å‹ç¼©æ•ˆæœï¼Œå¦‚æœè¿ç»­æ€§å·®ï¼Œåè€Œå¯èƒ½éœ€è¦æ›´å¤šçš„ç©ºé—´ï¼‰ã€‚</p><p><code>11,12,13,14,15,21,22</code>ä¼šå‹ç¼©ä¸º<code>11,4,21,1</code>ã€‚</p><p>ArrayContainerå’ŒRunContaineråœ¨ç´¢å¼•æ—¶éœ€è¦å†äºŒåˆ†ä¸€æ¬¡ã€‚</p><p>æ˜¾ç„¶ï¼Œåœ¨æ•°æ®å°‘æ—¶é€‰æ‹©ArrayContainerï¼Œä¹‹åé€‰æ‹©BitMapContainerå’ŒRunContainerä¸­æ›´ä¼˜çš„é‚£ä¸ªã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ’åºç®—æ³•æ€»ç»“</title>
      <link href="/2023/11/02/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/"/>
      <url>/2023/11/02/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="æ’å…¥æ’åº"><a class="header-anchor" href="#æ’å…¥æ’åº">Â¶</a>æ’å…¥æ’åº</h2><p>ä»å‰å¾€åä¾æ¬¡æŠŠå½“å‰å…ƒç´ æ’å…¥åˆ°å‰ç¼€çš„æœ‰åºåºåˆ—çš„ç›¸åº”ä½ç½®å³å¯ã€‚</p><p>$O(n^2)$ï¼Œç¨³å®š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">    <span class="type">int</span> key = a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span> &amp;&amp; a[j] &gt; key; j--) &#123;</span><br><span class="line">        a[j + <span class="number">1</span>] = a[j];</span><br><span class="line">    &#125;</span><br><span class="line">    a[j + <span class="number">1</span>] = key;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¸Œå°”æ’åº"><a class="header-anchor" href="#å¸Œå°”æ’åº">Â¶</a>å¸Œå°”æ’åº</h2><p>å¯¹æ’å…¥æ’åºçš„ä¼˜åŒ–ï¼Œç›´è§‚æ€æƒ³æ˜¯å½“æ•°ç»„åŸºæœ¬æœ‰åºæ—¶ï¼Œæ’å…¥æ’åºæ˜¯å¾ˆå¿«çš„ã€‚</p><p>å°†ä¸€å®šé—´éš”çš„å…ƒç´ ç»„æˆä¸€ç»„è¿›è¡Œæ’å…¥æ’åºï¼Œç„¶åæ¯ä¸€è½®ç¼©å°é—´éš”ï¼Œç›´è‡³é—´éš”ä¸º1ã€‚ï¼ˆå‰æœŸï¼Œä¹±åºçš„å…ƒç´ å¯ä»¥å¤§è·¨æ­¥åœ°å½’ä½ï¼‰ã€‚</p><p>é€šå¸¸å¢é‡åºåˆ—é€‰æ‹©$n/2, n/4, \dots, 1$ï¼ˆæœ€åä»ç„¶æ˜¯$O(n^2)$ï¼‰ï¼Œ$2^k+1$/$3^k+1$ï¼ˆæœ€åæ˜¯$O(n^{3/2}$ï¼‰ï¼Œ$2^p3^q$ï¼ˆæœ€åæ—¶$O(n\log^2 n$ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> gap = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span> (gap &lt; n / <span class="number">3</span>) &#123;</span><br><span class="line">    gap = <span class="number">3</span> * gap + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (gap &gt;= <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = gap; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> key = a[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i - gap; j &gt;= <span class="number">0</span> &amp;&amp; a[j] &gt; key; j -= gap) &#123;</span><br><span class="line">            a[j + gap] = a[j];</span><br><span class="line">        &#125;</span><br><span class="line">        a[j + gap] = key;</span><br><span class="line">    &#125;</span><br><span class="line">    gap /= <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é€‰æ‹©æ’åº"><a class="header-anchor" href="#é€‰æ‹©æ’åº">Â¶</a>é€‰æ‹©æ’åº</h2><p>æŒ‰ç…§æ•°å€¼ä»å°åˆ°å¤§ä¾æ¬¡å½’ä½ã€‚$O(n^2)$ï¼Œç¨³å®š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">    <span class="type">int</span> mn = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">        <span class="keyword">if</span> (a[j] &lt; a[mn])</span><br><span class="line">                mn = j;</span><br><span class="line">    std::<span class="built_in">swap</span>(a[i], a[mn]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å†’æ³¡æ’åº"><a class="header-anchor" href="#å†’æ³¡æ’åº">Â¶</a>å†’æ³¡æ’åº</h2><p>æ‰«æn-1è½®ï¼Œåœ¨æ¯ä¸€è½®ä¸­ï¼Œå¦‚æœå‰ä¸€ä¸ªæ•°å¤§äºåä¸€ä¸ªæ•°ï¼ˆå³é€†åºï¼‰ï¼Œå°±è¿›è¡Œäº¤æ¢ï¼Œè¿™æ ·ç¬¬iè½®ï¼Œç¬¬iå¤§çš„æ•°å°±å½’ä½äº†ã€‚ $O(n^2)$ï¼Œç¨³å®š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n - <span class="number">1</span> - i; j++)</span><br><span class="line">        <span class="keyword">if</span> (a[j] &gt; a[j + <span class="number">1</span>])</span><br><span class="line">            std::<span class="built_in">swap</span>(a[j], a[j + <span class="number">1</span>]);</span><br></pre></td></tr></table></figure><h2 id="å †æ’åº"><a class="header-anchor" href="#å †æ’åº">Â¶</a>å †æ’åº</h2><p>å‡åºéœ€è¦å…ˆæ„å»ºå¤§é¡¶å †ï¼Œç„¶åä¸æ–­æŠŠå †é¡¶ç§»åŠ¨æ•°ç»„çš„æœ«å°¾ï¼Œå¹¶ç»´æŒå¤§é¡¶å †ã€‚$O(n\log n)$ï¼Œä¸ç¨³å®š</p><p>å…³é”®æ˜¯å †çš„ä¸€äº›æ“ä½œã€‚</p><p>ä½ç½®<code>i</code>çš„å·¦å„¿å­å’Œå³å„¿å­åˆ†åˆ«æ˜¯<code>i&lt;&lt;1</code>å’Œ<code>i&lt;&lt;1|1</code></p><h3 id="åŸåœ°å»ºå †"><a class="header-anchor" href="#åŸåœ°å»ºå †">Â¶</a>åŸåœ°å»ºå †</h3><p>ä»æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹å¾€å‰è°ƒæ•´ï¼ŒæŠŠå½“å‰ç‚¹å’Œå„¿å­èŠ‚ç‚¹ä¸­æœ€å¤§çš„é‚£ä¸ªäº¤æ¢ä¸Šæ¥ã€‚$O(n)$</p><h3 id="è¿½åŠ å…ƒç´ "><a class="header-anchor" href="#è¿½åŠ å…ƒç´ ">Â¶</a>è¿½åŠ å…ƒç´ </h3><p>å…ˆæ”¾åœ¨æ•°ç»„æœ«å°¾ï¼Œç„¶åä»ä¸‹å¾€ä¸Šäº¤æ¢è°ƒæ•´å³å¯ã€‚$O(\log n)$</p><h3 id="åˆ é™¤å †é¡¶"><a class="header-anchor" href="#åˆ é™¤å †é¡¶">Â¶</a>åˆ é™¤å †é¡¶</h3><p>ä»ä¸Šå¾€ä¸‹äº¤æ¢è°ƒæ•´å³å¯ã€‚$O(\log n)$</p><h2 id="å¿«é€Ÿæ’åº"><a class="header-anchor" href="#å¿«é€Ÿæ’åº">Â¶</a>å¿«é€Ÿæ’åº</h2><p>é€‰æ‹©ä¸€ä¸ªpivotï¼Œå°†å°äºpivotçš„å…ƒç´ ç§»åˆ°å‰é¢ï¼Œå¤§äºpivotçš„å…ƒç´ ç§»åˆ°åé¢ï¼Œç„¶åé€’å½’åˆ†æ²»å³å¯ã€‚</p><p>å…³é”®ç‚¹æ˜¯pivotçš„é€‰æ‹©ï¼Œæœ€åå¯èƒ½å¯¼è‡´$O(n^2)$ï¼Œä¸€èˆ¬ä¼šç”¨éšæœºçš„æ–¹å¼é€‰æ‹©ã€‚</p><p>ä¸€ä¸ªç»†èŠ‚æ˜¯æ‰€æœ‰æ•°å­—éƒ½ç›¸åŒï¼Œè¿™æ—¶å€™ä¸ç®¡æ€ä¹ˆé€‰éƒ½ä¼šæ˜¯$O(n^2)$çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">partition</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> pos = <span class="built_in">rand</span>() % (r - l + <span class="number">1</span>) + l;</span><br><span class="line">    <span class="built_in">swap</span>(nums[l], nums[pos]);</span><br><span class="line">    <span class="type">int</span> pivot = nums[l];</span><br><span class="line">    <span class="type">int</span> j = l;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = l + <span class="number">1</span>; i &lt;= r; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums[i] &lt; pivot) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(nums[i], nums[++j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">swap</span>(nums[j], nums[l]);</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quickSort</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> p = <span class="built_in">partition</span>(nums, l, r);</span><br><span class="line">    <span class="keyword">while</span> (p - <span class="number">1</span> &gt;= l &amp;&amp; nums[p - <span class="number">1</span>] == nums[p]) --p;</span><br><span class="line">    <span class="built_in">quickSort</span>(nums, l, p - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (p + <span class="number">1</span> &lt;= r &amp;&amp; nums[p + <span class="number">1</span>] == nums[p]) ++p;</span><br><span class="line">    <span class="built_in">quickSort</span>(nums, p + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="std-sort"><a class="header-anchor" href="#std-sort">Â¶</a>std::sort</h2><p>ä½¿ç”¨ä¸€ç§æ··åˆçš„introsortã€‚</p><p>å¦‚æœè§„æ¨¡å°äº16ï¼Œç›´æ¥æ’å…¥æ’åºã€‚</p><p>åœ¨å¿«æ’æ·±åº¦å¤§äºä¸€ä¸ªé˜ˆå€¼æ—¶ï¼Œåˆ‡æ¢ä¸ºå †æ’åºï¼Œæ¥é¿å…å¿«æ’æœ€å$O(N^2)$å¤æ‚åº¦çš„é—®é¢˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">procedure <span class="title">sort</span><span class="params">(A : array)</span>:</span></span><br><span class="line"><span class="function">    maxdepth â† âŒŠlog2(length(A))âŒ‹ Ã— <span class="number">2</span></span></span><br><span class="line"><span class="function">    introsort(A, maxdepth)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">procedure introsort(A, maxdepth):</span></span><br><span class="line"><span class="function">    n â† length(A)</span></span><br><span class="line"><span class="function">    if n &lt; <span class="number">16</span>:</span></span><br><span class="line"><span class="function">        insertionsort(A)</span></span><br><span class="line"><span class="function">    else if maxdepth =</span> <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">heapsort</span>(A)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p â† <span class="built_in">partition</span>(A)  <span class="comment">// assume this function does pivot selection, p is the final position of the pivot</span></span><br><span class="line">        <span class="built_in">introsort</span>(A[<span class="number">1</span>:p<span class="number">-1</span>], maxdepth - <span class="number">1</span>)</span><br><span class="line">        <span class="built_in">introsort</span>(A[p+<span class="number">1</span>:n], maxdepth - <span class="number">1</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 2127. å‚åŠ ä¼šè®®çš„æœ€å¤šå‘˜å·¥æ•°</title>
      <link href="/2023/11/02/Leetcode-2127-%E5%8F%82%E5%8A%A0%E4%BC%9A%E8%AE%AE%E7%9A%84%E6%9C%80%E5%A4%9A%E5%91%98%E5%B7%A5%E6%95%B0/"/>
      <url>/2023/11/02/Leetcode-2127-%E5%8F%82%E5%8A%A0%E4%BC%9A%E8%AE%AE%E7%9A%84%E6%9C%80%E5%A4%9A%E5%91%98%E5%B7%A5%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>æœ‰nä¸ªäººï¼Œæ¯ä¸ªäººæœ‰å¦å¤–ä¸€ä¸ªå–œæ¬¢çš„äººï¼Œç°åœ¨æœ‰ä¸€ä¸ªåœ†æ¡Œï¼Œè¦æ±‚åº§ä½ä¸Šçš„æ¯ä¸ªäººéƒ½å’Œä»–å–œæ¬¢çš„äººç›¸é‚»ï¼Œé—®åº§ä½ä¸Šæœ€å¤šèƒ½æœ‰å‡ ä¸ªäººã€‚</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€æ¡å‡ºè¾¹ï¼Œæ„æˆè‹¥å¹²æ£µå†…å‘åŸºç¯æ ‘ã€‚</p><p>ç°åœ¨è€ƒè™‘æ¯æ£µåŸºç¯æ ‘ï¼Œæ˜¾ç„¶å¯ä»¥è®©ç¯ä¸Šçš„æ‰€æœ‰äººéƒ½åä¸‹ã€‚</p><p>ä½†æ˜¯ä»æ ·ä¾‹1å°±å¯ä»¥çœ‹å‡ºä¸€ç§ç‰¹æ®Šçš„caseï¼Œå¦‚æœç¯çš„å¤§å°ä¸º2ï¼Œæ­¤æ—¶æ˜¯å¯ä»¥ç»§ç»­åŠ äººçš„ã€‚è®¾ç¯ä¸Šçš„ä¸¤ä¸ªç‚¹ä¸ºxå’Œyï¼Œé‚£ä¹ˆå¯ä»¥å†å¡è¿›xå­æ ‘å†…çš„æœ€é•¿é“¾ä»¥åŠyå­æ ‘å†…çš„æœ€é•¿é“¾ï¼Œè€Œä¸”å¯ä»¥ç»§ç»­æŠŠå…¶å®ƒå¤§å°ä¸º2çš„ç¯ä»¥åŠå¯¹åº”çš„é“¾æ‹¼æ¥è¿›æ¥ã€‚</p><p>å› æ­¤è¿™é“é¢˜åªéœ€è¦æ‰¾å‡ºæ¯æ£µåŸºç¯æ ‘çš„ç¯çš„å¤§å°ï¼Œå¦‚æœå¤§äº2ï¼Œå–maxï¼›å¦åˆ™å†æ‰¾å‡ºè¿™ä¸¤ä¸ªç‚¹å„è‡ªå­æ ‘å†…çš„æœ€é•¿é“¾ï¼Œå–sumã€‚æœ€åä¸¤ç§æƒ…å†µå†å»maxå³å¯ã€‚</p><p>åšçš„æ—¶å€™çœ‹åˆ°æ ·ä¾‹å°±æ„è¯†åˆ°ç¯çš„å¤§å°ä¸º2æ˜¯ä¸ªç‰¹æ®Šç‚¹ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°å¯ä»¥æ‹¼æ¥ï¼Œè€Œä¸”ä¹Ÿæ²¡ç¡®å®šæ¯ä¸ªè”é€šå—éƒ½æ˜¯åŸºç¯æ ‘è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥å†™çš„å¾ˆä¹±ï¼ˆå®Œå…¨åœ¨çå†™ï¼‰ï¼Œä¹ŸWAäº†å¥½å‡ æ¬¡ã€‚ã€‚ğŸ˜­æˆ‘ä¸€å¼€å§‹ä»¥ä¸ºå¤§å°ä¸º2çš„ç¯æœ€å¤šåªèƒ½å¤šå¸¦1ä¸ªäººï¼Œä¸ºäº†åˆ¤æ–­è¿™ä¸ªç¯è¿˜æœ‰å…¶ä»–ç‚¹ï¼Œæˆ‘ä»ä¸€ä¸ªéç¯ä¸Šçš„ç‚¹å¼€å§‹çˆ¬ï¼Œæœ€åå†å¤„ç†çº¯ç¯ï¼ˆå¦‚æœçŸ¥é“æ¯ä¸ªè¿é€šå—éƒ½æ˜¯åŸºç¯æ ‘è¿™ä¸€ç‚¹ï¼Œå®Œå…¨æ²¡å¿…è¦åˆ†æˆä¸¤å—ä»£ç å†™ï¼‰ã€‚åæ¥å‘ç°ç»“è®ºä¸å¯¹ä¹‹åï¼Œè¿™ä¸ªä»£ç æ¡†æ¶å…¶å®ä¸å¤ªå¥½ï¼Œä½†ä¹Ÿæ‡’å¾—æ”¹äº†ï¼Œæ‰€ä»¥è°ƒè¯•èµ·æ¥ä¹Ÿå¾ˆçƒ¦ï¼Œæ‰‹ç”»äº†å¥½å‡ ä¸ªé”™çš„æ ·ä¾‹ã€‚ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maximumInvitations</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; favorite)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = favorite.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>, ans2 = <span class="number">0</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">cnt</span><span class="params">(n)</span>, <span class="title">vis</span><span class="params">(n)</span></span>;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">G</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; favorite.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            cnt[favorite[i]]++;</span><br><span class="line">            G[i].<span class="built_in">push_back</span>(favorite[i]);</span><br><span class="line">            G[favorite[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">tmp</span><span class="params">(n)</span></span>;</span><br><span class="line">        function&lt;<span class="type">int</span>(<span class="type">int</span>, <span class="type">int</span>)&gt; get = [&amp;](<span class="type">int</span> u, <span class="type">int</span> u2) &#123;</span><br><span class="line">            <span class="type">int</span> d = <span class="number">1</span>;</span><br><span class="line">            tmp[u] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v : G[u]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v != u2 &amp;&amp; !tmp[v]) &#123;</span><br><span class="line">                    d = <span class="built_in">max</span>(d, <span class="built_in">get</span>(v, u2) + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> d;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">int</span> two = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!cnt[i]) &#123;</span><br><span class="line">                vector&lt;<span class="type">int</span>&gt; loop;</span><br><span class="line">                <span class="type">int</span> j = i;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = i; ; j = favorite[j]) &#123;</span><br><span class="line">                    loop.<span class="built_in">push_back</span>(j);</span><br><span class="line">                    <span class="keyword">if</span> (!vis[j]) &#123;</span><br><span class="line">                        vis[j] = <span class="number">1</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vis[j] == <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="type">int</span> sz = loop.<span class="built_in">size</span>();</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; sz; i++) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (i &gt; <span class="number">0</span>) cnt[loop[i]]--;</span><br><span class="line">                            vis[loop[i]] = <span class="number">2</span>;</span><br><span class="line">                            <span class="keyword">if</span> (j == loop[i] &amp;&amp; i != sz - <span class="number">1</span>) &#123;</span><br><span class="line">                                <span class="type">int</span> x = i, y = sz - x - <span class="number">1</span>;</span><br><span class="line">                                <span class="keyword">if</span> (y == <span class="number">2</span>) &#123;</span><br><span class="line">                                    <span class="type">int</span> cur = <span class="built_in">get</span>(j, loop[i + <span class="number">1</span>]) + <span class="built_in">get</span>(loop[i + <span class="number">1</span>], j);</span><br><span class="line">                                    ans2 = <span class="built_in">max</span>(ans2, cur);</span><br><span class="line">                                    two += cur;</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    ans = <span class="built_in">max</span>(ans, y);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vis[j] == <span class="number">2</span>) &#123;</span><br><span class="line">                        <span class="type">int</span> sz = loop.<span class="built_in">size</span>();</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; sz; i++) &#123;</span><br><span class="line">                            cnt[loop[i]]--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(vis.<span class="built_in">data</span>(), <span class="number">0</span>, n &lt;&lt; <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (cnt[i]) &#123;</span><br><span class="line">                vector&lt;<span class="type">int</span>&gt; loop;</span><br><span class="line">                <span class="type">int</span> j = i;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> j = i; ; j = favorite[j]) &#123;</span><br><span class="line">                    loop.<span class="built_in">push_back</span>(j);</span><br><span class="line">                    <span class="keyword">if</span> (!vis[j]) &#123;</span><br><span class="line">                        vis[j] = <span class="number">1</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="type">int</span> sz = loop.<span class="built_in">size</span>();</span><br><span class="line">                        <span class="keyword">if</span> (sz == <span class="number">3</span>) &#123;</span><br><span class="line">                            two += <span class="number">2</span>;</span><br><span class="line">                            ans2 = <span class="built_in">max</span>(ans2, <span class="number">2</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            ans = <span class="built_in">max</span>(ans, sz - <span class="number">1</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; sz; i++) &#123;</span><br><span class="line">                            vis[loop[i]] = <span class="number">0</span>;</span><br><span class="line">                            <span class="keyword">if</span> (i &gt; <span class="number">0</span>) cnt[loop[i]]--;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, two);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åŸºç¯æ ‘æ‰¾ç¯å¯ä»¥æŠŠæ‰€æœ‰éç¯ä¸Šçš„è¾¹ç”¨æ‹“æ‰‘æ’åºå»æ‰ã€‚</p><p>ä¸‹é¢ä»£ç çš„<code>rg</code>åŒ…å«äº†æ‰€æœ‰éç¯è¾¹ï¼Œè€Œç¯è¾¹ç”¨<code>favorite</code>æ•°ç»„å°±å¯ä»¥æ‹¿åˆ°ã€‚æ­¤å¤–ï¼Œå…¶å®å¯ä»¥ç›´æ¥åœ¨æ‹“æ‰‘æ’åºçš„æ—¶å€™ç®—å‡ºæœ€é•¿é“¾ï¼Œä¹Ÿå°±ä¸éœ€è¦å»º<code>rg</code>äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">maximumInvitations</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;favorite)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = favorite.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">deg</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> f: favorite) &#123;</span><br><span class="line">            deg[f]++; <span class="comment">// ç»Ÿè®¡åŸºç¯æ ‘æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">rg</span>(n); <span class="comment">// åå›¾</span></span><br><span class="line">        queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (deg[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123; <span class="comment">// æ‹“æ‰‘æ’åºï¼Œå‰ªæ‰å›¾ä¸Šæ‰€æœ‰æ ‘æ</span></span><br><span class="line">            <span class="type">int</span> x = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="type">int</span> y = favorite[x]; <span class="comment">// x åªæœ‰ä¸€æ¡å‡ºè¾¹</span></span><br><span class="line">            rg[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">            <span class="keyword">if</span> (--deg[y] == <span class="number">0</span>) &#123;</span><br><span class="line">                q.<span class="built_in">push</span>(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šè¿‡åå›¾ rg å¯»æ‰¾æ ‘æä¸Šæœ€æ·±çš„é“¾</span></span><br><span class="line">        function&lt;<span class="type">int</span>(<span class="type">int</span>)&gt; rdfs = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="type">int</span> max_depth = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> son: rg[x]) &#123;</span><br><span class="line">                max_depth = <span class="built_in">max</span>(max_depth, <span class="built_in">rdfs</span>(son) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> max_depth;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> max_ring_size = <span class="number">0</span>, sum_chain_size = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (deg[i] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// éå†åŸºç¯ä¸Šçš„ç‚¹</span></span><br><span class="line">            deg[i] = <span class="number">0</span>; <span class="comment">// å°†åŸºç¯ä¸Šçš„ç‚¹çš„å…¥åº¦æ ‡è®°ä¸º 0ï¼Œé¿å…é‡å¤è®¿é—®</span></span><br><span class="line">            <span class="type">int</span> ring_size = <span class="number">1</span>; <span class="comment">// åŸºç¯é•¿åº¦</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> x = favorite[i]; x != i; x = favorite[x]) &#123;</span><br><span class="line">                deg[x] = <span class="number">0</span>; <span class="comment">// å°†åŸºç¯ä¸Šçš„ç‚¹çš„å…¥åº¦æ ‡è®°ä¸º 0ï¼Œé¿å…é‡å¤è®¿é—®</span></span><br><span class="line">                ring_size++;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (ring_size == <span class="number">2</span>) &#123; <span class="comment">// åŸºç¯é•¿åº¦ä¸º 2</span></span><br><span class="line">                sum_chain_size += <span class="built_in">rdfs</span>(i) + <span class="built_in">rdfs</span>(favorite[i]); <span class="comment">// ç´¯åŠ ä¸¤æ¡æœ€é•¿é“¾çš„é•¿åº¦</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                max_ring_size = <span class="built_in">max</span>(max_ring_size, ring_size); <span class="comment">// å–æ‰€æœ‰åŸºç¯é•¿åº¦çš„æœ€å¤§å€¼</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(max_ring_size, sum_chain_size);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é™æ€åˆ†æå·¥å…·æ€»ç»“</title>
      <link href="/2023/11/02/%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93/"/>
      <url>/2023/11/02/%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="cpplint"><a href="#cpplint" class="headerlink" title="cpplint"></a>cpplint</h2><p><code>cpplint</code>æ˜¯ä¸€ä¸ªä¸éœ€è¦ç¼–è¯‘åˆ†ææ–‡ä»¶çš„ï¼ŒåŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„æ–‡æœ¬çº§åˆ«çš„é™æ€æ£€æŸ¥å·¥å…·ï¼Œ<br>å¯ä»¥ç”¨æ¥è¿›è¡Œä¸€äº›æœ€åŸºæœ¬çš„<code>Google Style</code>æ£€æŸ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install</span></span><br><span class="line">pip install cpplint</span><br><span class="line">cpplint --version</span><br><span class="line"></span><br><span class="line"><span class="comment"># use</span></span><br><span class="line">cpplint [OPTIONS] files</span><br><span class="line">cpplint --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ç»“åˆVSCodeçš„<code>cpplint</code>æ’ä»¶ã€‚</p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>æ·»åŠ <code>CPPLINT.cfg</code>æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Stop searching for additional config files.</span></span><br><span class="line"><span class="built_in">set</span> noparent</span><br><span class="line"><span class="comment"># Specifies the line of code for the project</span></span><br><span class="line">linelength=120</span><br><span class="line"></span><br><span class="line">root=.</span><br><span class="line">exclude_files=regex</span><br><span class="line"></span><br><span class="line">filter=+filter1,-filter2</span><br></pre></td></tr></table></figure><p>é€‰é¡¹å¯ä»¥å¤šæ¬¡æŒ‡å®šï¼Œå–å¹¶é›†ã€‚</p><h2 id="clang-tidy"><a href="#clang-tidy" class="headerlink" title="clang-tidy"></a>clang-tidy</h2>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 2003. æ¯æ£µå­æ ‘å†…ç¼ºå¤±çš„æœ€å°å€¼</title>
      <link href="/2023/11/01/Leetcode-2003-%E6%AF%8F%E6%A3%B5%E5%AD%90%E6%A0%91%E5%86%85%E7%BC%BA%E5%A4%B1%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC/"/>
      <url>/2023/11/01/Leetcode-2003-%E6%AF%8F%E6%A3%B5%E5%AD%90%E6%A0%91%E5%86%85%E7%BC%BA%E5%A4%B1%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>ç»™å®šä¸€æ£µnä¸ªèŠ‚ç‚¹ï¼Œä»¥0ä¸ºæ ¹çš„æ— å‘æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªå€¼numï¼Œé—®å¯¹äºæ¯ä¸ªç‚¹uï¼ŒuåŠå…¶å­æ ‘çš„æ‰€æœ‰å€¼çš„mexã€‚</p><p>$n \le 10^5, 1\le num \le 10 ^ 5$</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªæ¡¶æ•°ç»„å’Œä¸€ä¸ªmexæŒ‡é’ˆï¼Œç„¶åä»ä¸‹å¾€ä¸Šè½¬ç§»å³å¯ï¼ˆæ¯æ¬¡åŠ ä¸€ä¸ªç‚¹ï¼Œå°±æ›´æ–°æ¡¶ï¼Œç„¶åå°è¯•ç§»åŠ¨mexæŒ‡é’ˆï¼‰ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬ä¸å¯èƒ½æ¯ä¸ªèŠ‚ç‚¹éƒ½å¼€ä¸€ä¸ªæ¡¶æ•°ç»„ï¼Œæ—¶é—´å’Œç©ºé—´éƒ½å—ä¸äº†ã€‚</p><p>æ˜¾ç„¶å¯ä»¥ç”¨dsu on treeæ¥è§£å†³ï¼ˆå¸¸ç”¨ä¸é™æ€å­æ ‘æŸ¥è¯¢é—®é¢˜ï¼‰ã€‚æ€è·¯å°±æ˜¯åªç”¨ä¸€ä¸ªå…¨å±€çš„æ¡¶æ•°ç»„å’ŒmexæŒ‡é’ˆï¼Œå…ˆå¤„ç†æ‰€æœ‰è½»å„¿å­çš„ç­”æ¡ˆï¼Œç„¶åæ¸…ç©ºè´¡çŒ®ï¼›å†å¤„ç†å”¯ä¸€çš„é‡å„¿å­ï¼Œä½†æ˜¯<strong>ä¿ç•™</strong>è´¡çŒ®ï¼›æœ€åå†æŠŠæ‰€æœ‰è½»å„¿å­çš„è´¡çŒ®å†ç»Ÿè®¡ä¸€éå³å¯ã€‚</p><p>å› ä¸ºä¸€ä¸ªç‚¹å¾€ä¸Šæœ€å¤šåˆ†æˆlogæ®µé‡é“¾ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œæ¯ä¸ªè½»å„¿å­æœ€å¤šé¢å¤–ç»Ÿè®¡logæ¬¡ï¼Œå› æ­¤åªä¹˜äº†ä¸ªlogçš„å¤æ‚åº¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">smallestMissingValueSubtree</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; parents, vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = parents.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">G</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">            G[parents[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sz</span><span class="params">(n)</span>, <span class="title">big_son</span><span class="params">(n, <span class="number">-1</span>)</span>, <span class="title">ans</span><span class="params">(n)</span></span>;</span><br><span class="line">        std::function&lt;<span class="type">void</span>(<span class="type">int</span>, <span class="type">int</span>)&gt; get = [&amp;](<span class="type">int</span> u, <span class="type">int</span> fa) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v : G[u]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="built_in">get</span>(v, u);</span><br><span class="line">                sz[u] += sz[v];</span><br><span class="line">                <span class="keyword">if</span> (big_son[u] == <span class="number">-1</span> || sz[v] &gt; sz[big_son[u]]) &#123;</span><br><span class="line">                    big_son[u] = v;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">get</span>(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">bucket</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, pending</span>;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">        std::function&lt;<span class="type">void</span>(<span class="type">int</span>, <span class="type">int</span>)&gt; add = [&amp;](<span class="type">int</span> u, <span class="type">int</span> fa) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[u] - <span class="number">1</span> &lt; n) &#123;</span><br><span class="line">                bucket[nums[u] - <span class="number">1</span>]++;</span><br><span class="line">                pending.<span class="built_in">push_back</span>(nums[u]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v : G[u]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="built_in">add</span>(v, u);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        std::function&lt;<span class="type">void</span>(<span class="type">int</span>, <span class="type">int</span>, <span class="type">bool</span>)&gt; dfs = [&amp;](<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">bool</span> del) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v : G[u]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (v == big_son[u]) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="built_in">dfs</span>(v, u, <span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (big_son[u] != <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="built_in">dfs</span>(big_son[u], u, <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> v : G[u]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (v == big_son[u]) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="built_in">add</span>(v, u);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (nums[u] - <span class="number">1</span> &lt; n) &#123;</span><br><span class="line">                bucket[nums[u] - <span class="number">1</span>]++;</span><br><span class="line">                pending.<span class="built_in">push_back</span>(nums[u]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (bucket[cur]) ++cur;</span><br><span class="line">            ans[u] = cur + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (del) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> num : pending) bucket[num - <span class="number">1</span>]--;</span><br><span class="line">                pending.<span class="built_in">clear</span>();</span><br><span class="line">                cur = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">-1</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ­¤å¤–ä¹Ÿå¯ä»¥æ¯ä¸ªç‚¹ç»´æŠ¤ä¸€ä¸ªå“ˆå¸Œé›†åˆï¼ˆè€Œä¸æ˜¯æ¡¶æ•°ç»„ï¼‰ï¼Œç„¶åä»ä¸‹å¾€ä¸Šå¯å‘å¼åˆå¹¶ï¼ˆå°çš„é›†åˆæ’å…¥åˆ°å¤§çš„é›†åˆï¼‰ã€‚</p><p>ä»¥ä¸Šåšæ³•æ˜¯é€šç”¨çš„ï¼Œä½†æ˜¯è¿™é“é¢˜æœ‰ä¸€ä¸ªç‰¹æ€§æ˜¯æ¯ä¸ªç‚¹çš„nummäº’ä¸ç›¸åŒï¼Œä¹Ÿå°±æ„å‘³ç€åªæœ‰ä¸€ä¸ªç‚¹çš„numä¸º1ï¼Œåªæœ‰è¿™ä¸ªç‚¹å¾€ä¸Šçš„é“¾çš„mex &gt; 1ï¼Œæ‰€ä»¥ä¸€édfså³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»ˆç«¯å¤ç”¨å™¨</title>
      <link href="/2023/10/30/%E7%BB%88%E7%AB%AF%E5%A4%8D%E7%94%A8%E5%99%A8/"/>
      <url>/2023/10/30/%E7%BB%88%E7%AB%AF%E5%A4%8D%E7%94%A8%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="tmux"><a class="header-anchor" href="#tmux">Â¶</a>tmux</h2><h3 id="åŸºæœ¬æ¦‚å¿µ"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ">Â¶</a>åŸºæœ¬æ¦‚å¿µ</h3><p>é€šå¸¸ï¼Œç»ˆç«¯çª—å£å’Œä¼šè¯æ˜¯ç»‘å®šçš„ï¼Œæ‰“å¼€å’Œå…³é—­ç»ˆç«¯å°±æ„å‘³ç€ä¼šè¯çš„å¼€å§‹å’Œç»“æŸã€‚</p><p>tmuxåˆ™å¯ä»¥è§£ç»‘ç»ˆç«¯å’Œä¼šè¯ï¼Œè¿™æ ·æ¯ä¸ªä¼šè¯å¯ä»¥æ‹¥æœ‰å¤šä¸ªç»ˆç«¯ï¼Œç»ˆç«¯ä¹Ÿå¯ä»¥å’Œä¼šè¯åˆ†ç¦»ä»¥åŠé‡æ–°æ¥å…¥ã€‚</p><p><a href="/post-images/tmux.png">tmux</a></p><ul><li>æœåŠ¡å™¨ï¼šä¸€ä¸ªtmuxæœåŠ¡å™¨å¯ä»¥ç®¡ç†å¤šä¸ªä¼šè¯</li><li>ä¼šè¯ï¼šä¸€ä¸ªä¼šè¯å¯ä»¥æœ‰å¤šä¸ªçª—å£ï¼Œä½†åŒæ—¶åªèƒ½æ˜¾ç¤ºä¸€ä¸ªçª—å£ï¼ˆå¯ä»¥ç±»æ¯”æˆå¤šæ¡Œé¢ï¼Œä¸åŒçš„æ¡Œé¢å¹²ä¸åŒçš„äº‹æƒ…ï¼‰</li><li>çª—å£ï¼šä¸€ä¸ªçª—å£å¯ä»¥åˆ†å‰²æˆå¤šä¸ªçª—æ ¼</li><li>çª—æ ¼ï¼šå³ä¹‹å‰çš„ä¸€ä¸ªç»ˆç«¯çª—å£</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">install</span></span><br><span class="line">sudo apt install tmux</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uninstall</span></span><br><span class="line">sudo apt remove tmux</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šè¿˜æ˜¯å»ºè®®ä»æºç ç¼–è¯‘ï¼Œaptå®‰è£…çš„ç‰ˆæœ¬å¤ªæ—§ï¼Œå¯¼è‡´æ¯æ¬¡å¯åŠ¨tmuxçš„æ—¶å€™éƒ½ä¼šæ›´æ–°ä¸€étpmã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">install</span></span><br><span class="line">git clone https://github.com/tmux/tmux.git</span><br><span class="line">cd tmux</span><br><span class="line">sh autogen.sh</span><br><span class="line">./configure &amp;&amp; make</span><br><span class="line">sudo cp tmux /usr/local/bin</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uninstall</span></span><br><span class="line">sudo rm /usr/local/bin/tmux</span><br></pre></td></tr></table></figure><p>tmuxçš„é»˜è®¤é”®ä½ä¸å¤ªå‹å¥½ï¼Œé€‰æ‹©<code>oh my tmux</code>çš„é…ç½®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line">git clone https://github.com/gpakosz/.tmux.git</span><br><span class="line">ln -s -f .tmux/.tmux.conf</span><br><span class="line">cp .tmux/.tmux.conf.local .</span><br></pre></td></tr></table></figure><p>åœ¨<code>.tmux.conf.local</code>ä¸­æ·»åŠ ä¸‹é¢é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set -g mouse on</span><br><span class="line">set -g mouse-select-pane on</span><br><span class="line">set -g @plugin &#x27;catppuccin/tmux&#x27;</span><br></pre></td></tr></table></figure><h3 id="ä¼šè¯æ“ä½œ"><a class="header-anchor" href="#ä¼šè¯æ“ä½œ">Â¶</a>ä¼šè¯æ“ä½œ</h3><ul><li><code>tmux</code>ï¼šæ‰“å¼€ä¸€ä¸ªtmuxæœåŠ¡å™¨</li><li><code>exit</code>ï¼šé€€å‡º</li><li><code>tmux new -s name</code>, <code>alias tnew=&quot;tmux new -s&quot;</code>ï¼šæ–°å»ºä¸€ä¸ªåä¸ºnameçš„ä¼šè¯</li><li><code>tmux ls</code>ï¼šåˆ—å‡ºæ‰€æœ‰ä¼šè¯</li><li><code>tmux attach -t id/name</code>ï¼šæ¢å¤ä¼šè¯ï¼ˆåªæœ‰ä¸€ä¸ªä¼šè¯å¯ä»¥ä¸ç”¨è¾“å…¥<code>-t</code>ï¼‰</li><li><code>tmux kill-session -t id/name</code>ï¼šå…³é—­ä¼šè¯</li><li><code>tmux switch -t id/name</code>ï¼šåˆ‡æ¢ä¼šè¯</li></ul><h3 id="çª—æ ¼æ“ä½œ"><a class="header-anchor" href="#çª—æ ¼æ“ä½œ">Â¶</a>çª—æ ¼æ“ä½œ</h3><ul><li><code>C-a</code>ï¼šå‰ç¼€é”®ï¼ˆä¹Ÿå¯ä»¥æ˜¯é»˜è®¤çš„<code>C-b</code>ï¼›æ³¨æ„æ˜¯å…ˆæŒ‰ä¸‹<prefix>ï¼Œç„¶åæ¾å¼€ï¼Œå†æŒ‰åé¢çš„é”®ï¼‰</li><li><code>-</code>ï¼šä¸Šä¸‹åˆ†çª—æ ¼</li><li><code>_</code>ï¼šå·¦å³åˆ†çª—æ ¼</li><li><code>x</code>, <code>C-d</code>ï¼šå…³é—­å½“å‰çª—æ ¼</li><li><code>z</code>ï¼šæœ€å¤§åŒ–/æ¢å¤çª—æ ¼</li><li><code>hjkl</code>ï¼šçª—æ ¼ç§»åŠ¨</li><li><code>HJKL</code>ï¼šçª—æ ¼å¤§å°è°ƒæ•´</li><li><code>&lt;</code>/<code>&gt;</code>ï¼šäº¤æ¢çª—æ ¼ä½ç½®</li><li><code>d</code>ï¼šåˆ†ç¦»ï¼Œåç»­å¯ä»¥å†attachå›æ¥</li></ul><h3 id="çª—å£æ“ä½œ"><a class="header-anchor" href="#çª—å£æ“ä½œ">Â¶</a>çª—å£æ“ä½œ</h3><ul><li><code>c</code>ï¼šæ–°å»ºçª—å£</li><li><code>C-h</code>/<code>C-l</code>ï¼šæµè§ˆçª—å£</li><li><code>&lt;number&gt;</code>ï¼šè·³è½¬åˆ°è¯¥çª—å£</li><li><code>,</code>ï¼šçª—å£é‡å‘½å</li></ul><h3 id="å·¥ä½œæµ"><a class="header-anchor" href="#å·¥ä½œæµ">Â¶</a>å·¥ä½œæµ</h3><p>é€šå¸¸å¼€ä¸€ä¸ªtmuxï¼Œç„¶åç”¨<code>&lt;prefix&gt;-</code>/<code>&lt;prefix&gt;_</code>åˆ†å‰²å¤šä¸ªçª—æ ¼å³å¯ã€‚</p><p>æœ‰æ—¶å€™è¦è·‘ä¸€äº›é•¿ä»»åŠ¡ï¼Œå¯ä»¥è¿è¡Œä¹‹å<code>&lt;prefix&gt;d</code>è¿›è¡Œdetachã€‚</p><h2 id="zellij"><a class="header-anchor" href="#zellij">Â¶</a>zellij</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">install</span></span><br><span class="line">wget https://github.com/zellij-org/zellij/releases/download/v0.38.2/zellij-x86_64-unknown-linux-musl.tar.gz</span><br><span class="line">tar -xvf zellij-x86_64-unknown-linux-musl.tar.gz</span><br><span class="line">sudo mv zellij /usr/local/bin</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">uninstall</span></span><br><span class="line">sudo rm /usr/local/bin/zellij</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçª—å£è¢«å«ä½œæ ‡ç­¾ï¼ˆtabï¼›æ„Ÿè§‰æ›´æ¸…æ™°ï¼‰ï¼Œçª—æ ¼ä»ç„¶æ˜¯paneã€‚</p><h3 id="æ ‡ç­¾æ“ä½œ"><a class="header-anchor" href="#æ ‡ç­¾æ“ä½œ">Â¶</a>æ ‡ç­¾æ“ä½œ</h3><ul><li><code>C-t</code>èµ·å§‹<ul><li><code>n</code>ï¼šæ–°å»ºæ ‡ç­¾</li><li><code>x</code>ï¼šå…³é—­å½“å‰æ ‡ç­¾</li></ul></li><li><code>C-o</code>ï¼šåˆ†ç¦»å½“å‰æ ‡ç­¾ï¼ˆå’Œtmuxä¸€æ ·ï¼Œå¯ä»¥<code>zellij attach &lt;name&gt;</code>å›æ¥ï¼‰</li></ul><h3 id="çª—æ ¼æ“ä½œ-s2"><a class="header-anchor" href="#çª—æ ¼æ“ä½œ-s2">Â¶</a>çª—æ ¼æ“ä½œ</h3><ul><li><code>C-p</code>èµ·å§‹<ul><li><code>n</code>ï¼šæ–°å»ºçª—æ ¼ï¼ˆä¼šè‡ªåŠ¨é€‰æ‹©å‚ç›´è¿˜æ˜¯æ°´å¹³åˆ’åˆ†ï¼‰</li><li><code>x</code>ï¼šå…³é—­å½“å‰çª—æ ¼</li></ul></li><li><code>C-n-&lt;+|-&gt;</code>ï¼šæ”¹å˜å½“å‰çª—æ ¼å¤§å°ï¼ˆè¿™ä¸ªä¸èƒ½ç”¨é¼ æ ‡æ“ä½œï¼‰</li><li><code>C-h-&lt;h|j|k|l&gt;/æ–¹å‘é”®</code>ï¼šæµè§ˆçª—æ ¼</li></ul><p>æ€»ä½“æ„Ÿè§‰ä¸€èˆ¬èˆ¬ï¼Œé»˜è®¤çš„é…è‰²æˆ‘ä¹Ÿä¸å¤ªå–œæ¬¢ï¼Œä¸å¦‚tmuxå¥½ç”¨ã€‚</p><ul><li><code>C-q</code>ï¼šé€€å‡º</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Clippyé™æ€åˆ†æå·¥å…·</title>
      <link href="/2023/10/24/Clippy%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/"/>
      <url>/2023/10/24/Clippy%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Git hook</title>
      <link href="/2023/10/21/Git-hook/"/>
      <url>/2023/10/21/Git-hook/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ç‰¹å®šåŠ¨ä½œå‘ç”Ÿå‰åè§¦å‘è‡ªå®šä¹‰çš„è„šæœ¬æ„é€ ï¼Œåˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>å®¢æˆ·ç«¯é’©å­ï¼š<code>pre-commit</code>, <code>commit-msg</code>, <code>post-commit</code>ç­‰</li><li>æœåŠ¡ç«¯é’©å­ï¼š<code>pre-receive</code>, <code>post-receive</code>, <code>update</code>ç­‰</li></ul><h2 id="pre-commit"><a class="header-anchor" href="#pre-commit">Â¶</a>pre-commit</h2><p>åœ¨æ¯æ¬¡git commitå‰è§¦å‘ï¼Œé€šå¸¸ç”¨äºä»£ç è§„èŒƒæ£€æŸ¥ï¼Œå¯ä»¥é€šè¿‡<code>--no-verify</code>è·³è¿‡ã€‚</p><p>ä½¿ç”¨<a href="https://pre-commit.com/">pre-commit</a>æ¡†æ¶ã€‚</p><p><code>pip install pre-commit</code>å®‰è£…ï¼Œå¯èƒ½è¿˜éœ€è¦<code>source ~/.profile</code>ã€‚</p><p><code>pre-commit --version</code>ç¡®è®¤å®‰è£…æˆåŠŸã€‚</p><p><code>pre-commit sample-config &gt; .pre-commit-config.yaml</code>åœ¨æ ¹ç›®å½•ä¸‹ç”Ÿæˆé»˜è®¤é…ç½®ã€‚</p><p><code>pre-commit install</code>è‡ªåŠ¨å°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰é’©å­è„šæœ¬å®‰è£…åˆ°.git/hooks/ä¸­ã€‚</p><p><code>pre-commit run --all-files</code>å¯è‡ªè¡Œæ£€æŸ¥gitç®¡ç†çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè€Œgit commitåªä¼šæ£€æŸ¥å˜æ›´çš„æ–‡ä»¶ã€‚</p><h3 id="é…ç½®"><a class="header-anchor" href="#é…ç½®">Â¶</a>é…ç½®</h3><p><a href="https://github.com/pre-commit/pre-commit-hooks">pre-commit/pre-commit-hooks</a>æä¾›äº†ä¸€äº›é’©å­ï¼ˆå¦‚å»é™¤è¡Œå°¾ç©ºæ ¼ï¼‰ï¼Œç›´æ¥æŒ‡å®šidå³å¯ã€‚</p><p><a href="https://github.com/doublify/pre-commit-rust">doublify/pre-commit-rust</a>æä¾›äº†rustç›¸å…³çš„é’©å­ï¼ˆæ ¼å¼åŒ–ï¼Œé™æ€æ£€æŸ¥ç­‰ï¼‰ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CargoåŒ…ç®¡ç†å·¥å…·</title>
      <link href="/2023/10/21/Cargo%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/"/>
      <url>/2023/10/21/Cargo%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h2 id="å‘½ä»¤"><a class="header-anchor" href="#å‘½ä»¤">Â¶</a>å‘½ä»¤</h2><ul><li><code>cargo new &#123;&#123;project&#125;&#125; [--bin/--lib]</code></li><li><code>cargo check</code></li><li><code>cargo run</code></li><li><code>cargo build [--release]</code></li><li><code>cargo clean</code></li><li><code>cargo update [-p &#123;&#123;lib&#125;&#125;]</code>ï¼šæ›´æ–°ä¾èµ–</li></ul><h2 id="Cargo-lock"><a class="header-anchor" href="#Cargo-lock">Â¶</a>Cargo.lock</h2><p>åŒ…å«ä¾èµ–é¡¹çš„å‡†ç¡®ä¿¡æ¯ï¼Œè‡ªåŠ¨ç”Ÿæˆã€‚</p><p>åœ¨æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶æ—¶åº”è¯¥åŒ…å«lockæ–‡ä»¶ï¼Œè€Œåœ¨æ„å»ºåº“æ—¶ï¼Œåº”è¯¥æ”¾åœ¨.gitignoreä¸­ã€‚</p><h2 id="Cargo-toml"><a class="header-anchor" href="#Cargo-toml">Â¶</a>Cargo.toml</h2><p>åŒ…å«Cargoç¼–è¯‘çš„æ‰€æœ‰å…ƒæ•°æ®ã€‚</p><h3 id="package"><a class="header-anchor" href="#package">Â¶</a>package</h3><ul><li>nameï¼šåŒ…åï¼ˆå¿…è¦ï¼‰</li><li>versionï¼šåŒ…ç‰ˆæœ¬ï¼ˆå¿…è¦ï¼‰</li><li>authors</li><li>editionï¼šRustç‰ˆæœ¬</li><li>rust-versionï¼šæ”¯æŒçš„æœ€ä½Rustç‰ˆæœ¬</li><li>description</li><li>documentationï¼šæ–‡æ¡£é“¾æ¥</li><li>readme</li><li>homepage</li><li>repository</li><li>license</li><li>license-file</li><li>keywords</li><li>categories</li></ul><h3 id="dependencies"><a class="header-anchor" href="#dependencies">Â¶</a>dependencies</h3><ul><li><code>target.'cfg(target_arch = &quot;x86_64&quot;)'.dependencies</code>ï¼šå¹³å°ç‰¹å®šçš„ä¾èµ–é¡¹</li><li><code>dev-dependencies</code>ï¼šå¼€å‘ä¾èµ–</li><li><code>build-dependencies</code>ï¼šæ„å»ºä¾èµ–</li></ul><h3 id="features"><a class="header-anchor" href="#features">Â¶</a>features</h3><p>è¡¨è¾¾æ¡ä»¶ç¼–è¯‘å’Œå¯é€‰ä¾èµ–é¡¹ã€‚</p><h3 id="profile"><a class="header-anchor" href="#profile">Â¶</a>profile</h3><p>æ›´æ”¹ç¼–è¯‘å™¨è®¾ç½®ï¼Œæ”¹å˜ä¼˜åŒ–ã€è°ƒè¯•ç¬¦å·ç­‰ï¼Œåˆ†ä¸ºdevã€releaseã€testã€benchå››ä¸ªã€‚</p><h2 id="rustfmt"><a class="header-anchor" href="#rustfmt">Â¶</a>rustfmt</h2><p>ä¹±å…¥ä¸€ä¸‹rustçš„æ ¼å¼åŒ–å·¥å…·ã€‚</p><ul><li><code>rustfmt &#123;&#123;filename&#125;&#125;</code>ï¼šæ ¼å¼åŒ–å•ä¸ªæ–‡ä»¶</li><li><code>cargo fmt</code>ï¼šæ ¼å¼åŒ–æ•´ä¸ªé¡¹ç›®</li></ul><p><code>rustfmt.toml</code>ä¸ºé…ç½®æ–‡ä»¶ï¼Œrustfmté»˜è®¤æ˜¯å››ä¸ªç©ºæ ¼ï¼Œå¯ä»¥ç”¨<code>tab_spaces=2</code>ä¿®æ”¹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EditorConfig</title>
      <link href="/2023/10/21/EditorConfig/"/>
      <url>/2023/10/21/EditorConfig/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a class="header-anchor" href="#ä»‹ç»">Â¶</a>ä»‹ç»</h2><p>å¸®åŠ©å¼€å‘è€…å®šä¹‰ä¸€è‡´çš„ç¼–ç æ ·å¼ã€‚ä¸åŒçš„ç¼–è¾‘å™¨éƒ½å¯ä»¥è¯»å–å’Œéµå®ˆè¯¥å®šä¹‰ï¼ˆVSCodeéœ€è¦å®‰è£…æ’ä»¶ï¼‰ã€‚</p><h2 id="å¸¸ç”¨å±æ€§"><a class="header-anchor" href="#å¸¸ç”¨å±æ€§">Â¶</a>å¸¸ç”¨å±æ€§</h2><ul><li><code>indent_style</code>ï¼š<code>space</code>è½¯ç¼©è¿›ï¼Œ<code>tab</code>ç¡¬ç¼©è¿›</li><li><code>indent_size</code>ï¼šç¼©è¿›å¤§å°</li><li><code>end_of_line</code>ï¼šè®¾ç½®æ¢è¡Œç¬¦ï¼Œ<code>lf</code>ä¸ºæ¢è¡Œï¼Œå³*nixé£æ ¼</li><li><code>charset</code>ï¼šè®¾ç½®ç¼–ç </li><li><code>trim_trailing_whitespace</code>ï¼šå»é™¤æœ«å°¾ç©ºç™½ç¬¦</li><li><code>insert_final_newline</code>ï¼šä»¥ç©ºç™½è¡Œç»“å°¾</li><li><code>root</code>ï¼šè¡¨ç¤ºæœ€é¡¶å±‚çš„é…ç½®æ–‡ä»¶ã€‚EditorConfigä¼šä¸æ–­å‘ä¸Šå±‚ç›®å½•æŸ¥æ‰¾é…ç½®ï¼Œé‡åˆ°rootä¼šåœæ­¢</li></ul><h2 id="æ¨¡æ¿"><a class="header-anchor" href="#æ¨¡æ¿">Â¶</a>æ¨¡æ¿</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># EditorConfig helps developers define and maintain consistent</span><br><span class="line"># coding styles between different editors or IDEs</span><br><span class="line"># http://editorconfig.org</span><br><span class="line">root = true</span><br><span class="line"></span><br><span class="line">[*]</span><br><span class="line">end_of_line = lf</span><br><span class="line">charset = utf-8</span><br><span class="line">trim_trailing_whitespace = true</span><br><span class="line">insert_final_newline = false</span><br><span class="line">indent_style = space</span><br><span class="line">indent_size = 2</span><br><span class="line"></span><br><span class="line">[*.py]</span><br><span class="line">indent_size = 4</span><br><span class="line"></span><br><span class="line">[*.md]</span><br><span class="line">trim_trailing_whitespace = false</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tree-sitter</title>
      <link href="/2023/10/20/Tree-sitter/"/>
      <url>/2023/10/20/Tree-sitter/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æºç é˜…è¯»</title>
      <link href="/2023/10/19/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
      <url>/2023/10/19/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="é™æ€åˆ†æ"><a href="#é™æ€åˆ†æ" class="headerlink" title="é™æ€åˆ†æ"></a>é™æ€åˆ†æ</h2><h3 id="cloc"><a href="#cloc" class="headerlink" title="cloc"></a>cloc</h3><p>ç»Ÿè®¡ä»£ç è¡Œæ•°ï¼Œç”±perlå®ç°ã€‚</p><ul><li><code>cloc &#123;&#123;file/directory&#125;&#125;</code></li><li><code>--by-file</code>ï¼šæŒ‰æ–‡ä»¶ç»Ÿè®¡ï¼Œè€Œä¸æ˜¯æŒ‰è¯­è¨€</li><li><code>--exclude-list-file=&lt;file&gt;</code></li><li><code>--exclude-dir=&lt;D1&gt;[,D2,]</code></li></ul><h3 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h3><h4 id="git-diff"><a href="#git-diff" class="headerlink" title="git diff"></a>git diff</h4><p><code>git diff --no-index --word-diff=color file1 file2</code></p><p><code>--word-diff-regex=.</code>å¯ä»¥ä»¥å­—ç¬¦ä¸ºå•ä½è¿›è¡Œæ¯”è¾ƒï¼Œé»˜è®¤æƒ…å†µä¸‹<code>word-diff</code>ä»¥wordä¸ºå•ä½ï¼Œå³è¿ç»­çš„éç©ºç™½å­—ç¬¦ã€‚</p><h4 id="git-delta"><a href="#git-delta" class="headerlink" title="git-delta"></a><a href="https://github.com/dandavison/delta"><code>git-delta</code></a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git diff | delta <span class="comment"># é…ç½®.gitconfigä¸­çš„pagerå°±ä¸éœ€è¦å†ç®¡é“ä¼ åˆ°delta</span></span><br><span class="line">rg <span class="string">&quot;word&quot;</span> ./ | delta</span><br></pre></td></tr></table></figure><h4 id="difft"><a href="#difft" class="headerlink" title="difft"></a><a href="https://github.com/Wilfred/difftastic"><code>difft</code></a></h4><p>åŸºäºè¯­æ³•è¿›è¡Œ<code>diff</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">difft --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><h4 id="bat"><a href="#bat" class="headerlink" title="bat"></a><a href="https://github.com/sharkdp/bat"><code>bat</code></a></h4><p>just replace <code>cat</code></p><h3 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h3><p>æŸ¥æ‰¾æ–‡ä»¶ï¼Œç”±rustå®ç°ï¼Œæ˜¯findçš„æ›¿ä»£å“ã€‚</p><ul><li><code>fd &#123;&#123;pattern&#125;&#125; [directory]</code>ï¼šé»˜è®¤ä¸ºæ­£åˆ™åŒ¹é…ï¼Œå¯ä»¥æŒ‡å®šç›®å½•ï¼Œä¸æŒ‡å®šåˆ™æœç´¢å½“å‰ç›®å‰</li><li><code>--extension</code>ï¼šæŸ¥æ‰¾æ‰©å±•å</li><li><code>--exclude</code>ï¼šæ’é™¤æŸäº›æ–‡ä»¶æˆ–ç›®å½•</li><li><code>--no-ignore</code>ï¼šé»˜è®¤ä¼šéµå®ˆç›®å½•ä¸‹çš„<code>.gitignore</code>ï¼ŒæŒ‡å®šè¯¥é€‰é¡¹åˆ™ä¸éµå®ˆ</li></ul><h3 id="rg"><a href="#rg" class="headerlink" title="rg"></a>rg</h3><p>æŸ¥æ‰¾æ–‡ä»¶å†…å®¹ï¼Œç”±rustå®ç°ï¼Œæ˜¯grepçš„æ›¿ä»£å“ã€‚</p><ul><li><code>rg &#123;&#123;pattern&#125;&#125; [path ...]</code>ï¼šæœç´¢æ–‡æœ¬ä¸ºæ­£åˆ™åŒ¹é…</li><li><code>--type &#123;&#123;filetype&#125;&#125;</code>ï¼šæŒ‡å®šè¦æŸ¥æ‰¾çš„æ–‡ä»¶ç±»å‹</li><li><code>-i</code>ï¼šå¤§å°å†™ä¸æ•æ„Ÿ</li><li><code>--glob &#123;&#123;pattern&#125;&#125;</code>ï¼šä»…æŸ¥æ‰¾åŒ¹é…globæ¨¡å¼çš„æ–‡ä»¶</li><li><code>--files-with-matches</code>ï¼šåªåˆ—å‡ºå­˜åœ¨åŒ¹é…çš„æ–‡ä»¶å</li><li><code>-A/-B/-C N</code>ï¼šæ‰“å°åŒ¹é…è¡Œä»¥åŠå/å‰/å‰åNè¡Œ</li><li><code>--files</code>ï¼šæŸ¥æ‰¾æ–‡ä»¶å</li></ul><h3 id="ast-grep"><a href="#ast-grep" class="headerlink" title="ast-grep"></a>ast-grep</h3><p>åŸºäºTree-sitterè¿›è¡Œä»£ç æœç´¢ã€æ›¿æ¢ï¼Œç”±rustå®ç°ã€‚å®ƒåŸºäºASTèŠ‚ç‚¹ï¼ˆå…¶å®æ˜¯CSTï¼ŒASTæ˜¯æŠ½è±¡è¯­æ³•æ ‘ï¼Œ<br>è€ŒTsç”Ÿæˆçš„CSTæ˜¯å…·ä½“è¯­æ³•æ ‘ï¼Œå®ƒä¸ºæ¯ä¸ªtokenéƒ½å­˜å‚¨äº†ä¸€ä¸ªå¯¹åº”çš„èŠ‚ç‚¹ï¼Œå³ä½¿æ˜¯é€—å·ã€æ‹¬å·ç­‰å­—ç¬¦ä¸²å­—é¢é‡ï¼Œè€Œ<br>ASTåˆ™ä¼šå»æ‰è¿™äº›æ— æ„ä¹‰çš„èŠ‚ç‚¹ï¼›è¿™é‡Œç§°ä½œå‘½åèŠ‚ç‚¹å’ŒåŒ¿åèŠ‚ç‚¹ï¼‰è¿›è¡Œç»“æ„åŒ¹é…ï¼Œè€Œä¸æ˜¯ç®€å•çš„æ–‡æœ¬åŒ¹é…ã€‚</p><ul><li><code>ast-grep [OPTIONS] --p &lt;PATTERN&gt; [PATHS]...</code>ï¼š</li><li>PATTERNï¼šASTæ¨¡å¼<ul><li>å…ƒå˜é‡ï¼š<code>$</code>å¼€å¤´åè·Ÿå¤§å†™å­—æ¯ã€ä¸‹åˆ’çº¿æˆ–æ•°å­—1-9ï¼ŒåŒ¹é…å•ä¸ªASTèŠ‚ç‚¹ï¼ˆç±»æ¯”æ­£åˆ™ä¸­çš„<code>.</code>ï¼‰</li><li>å¤šå…ƒå˜é‡ï¼š$$$$$æ¥åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªASTèŠ‚ç‚¹ï¼ˆç±»æ¯”æ­£åˆ™ä¸­çš„<code>*</code>ï¼‰</li><li>å…ƒå˜é‡æ•è·ï¼šå¯ä»¥é‡å¤ä½¿ç”¨åŒåå˜é‡ï¼Œæ­¤æ—¶å®ƒä»¬è¢«è¦æ±‚åŒ¹é…ç›¸åŒçš„å†…å®¹ï¼Œå¯ä»¥ç”¨ä¸‹åˆ’çº¿å¼€å¤´æ¥æŠ‘åˆ¶è¯¥è¡Œä¸º</li><li>åŒ¿åèŠ‚ç‚¹ï¼š$$$$å¼€å¤´ï¼Œå³CSTä¸­ç›´æ¥ç”¨å­—ç¬¦ä¸²å­—é¢é‡å®šä¹‰çš„ï¼Œæ¯”å¦‚<code>+/,/;</code>ç­‰</li></ul></li><li><code>-l</code>ï¼šæŒ‡å®šè¯­è¨€</li><li><code>--rewrite</code>ï¼šæ”¹å†™æ›¿æ¢</li><li><code>--interactive</code>ï¼šäº¤äº’æ¨¡å¼</li><li><code>-A/-B/-C</code> </li></ul><h2 id="è¿è¡Œæ—¶åˆ†æ"><a href="#è¿è¡Œæ—¶åˆ†æ" class="headerlink" title="è¿è¡Œæ—¶åˆ†æ"></a>è¿è¡Œæ—¶åˆ†æ</h2><h3 id="strace"><a href="#strace" class="headerlink" title="strace"></a>strace</h3><h3 id="ltrace"><a href="#ltrace" class="headerlink" title="ltrace"></a>ltrace</h3><h3 id="uftrace"><a href="#uftrace" class="headerlink" title="uftrace"></a>uftrace</h3>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GDBè°ƒè¯•</title>
      <link href="/2023/10/17/GDB%E8%B0%83%E8%AF%95/"/>
      <url>/2023/10/17/GDB%E8%B0%83%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><ul><li><code>help</code>, <code>help command</code>ï¼šæŸ¥çœ‹å¸®åŠ©</li></ul><h3 id="è®¾ç½®"><a href="#è®¾ç½®" class="headerlink" title="è®¾ç½®"></a>è®¾ç½®</h3><p>gdbå¯åŠ¨æ—¶ä¼šå…ˆåº”ç”¨.gdbinitæ–‡ä»¶ä¸­çš„æ‰€æœ‰å‘½ä»¤ï¼Œ<br>å¯ä»¥æŠŠæœ¬æ¬¡è°ƒè¯•å‰éœ€è¦é‡å¤è¾“å…¥çš„å‘½ä»¤å†™è¿›å»ã€‚</p><ul><li><code>set disable-randomization off</code>ï¼šå…³é—­ç¨‹åºçš„è™šæ‹Ÿåœ°å€ç©ºé—´éšæœºåŒ–</li><li><code>set print pretty on</code>ï¼šä¼˜åŒ–ç»“æ„ä½“æ‰“å°</li><li><code>set print array-indexes on</code></li><li><code>set history save on</code>ï¼šä¿ç•™å†å²å‘½ä»¤</li><li><code>set pagination off</code>ï¼šå…³é—­åˆ†é¡µæ˜¾ç¤º</li><li><code>set confirm off</code>ï¼šå…³é—­ç¡®è®¤è¯·æ±‚</li></ul><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><ul><li><code>set args xxx</code>, <code>--args program xxx</code>ï¼šè®¾ç½®ç¨‹åºå¯åŠ¨æ—¶çš„å‚æ•°</li><li><code>show args</code>ï¼šæ˜¾ç¤ºè®¾ç½®çš„å‚æ•°</li><li><code>ulimit -c unlimited</code>, <code>gdb program core</code>ï¼šè°ƒè¯•coredumpæ–‡ä»¶</li><li><code>attach pid</code>, <code>gdb program pid</code>ï¼šé™„åŠ åˆ°å·²è¿è¡Œçš„è¿›ç¨‹ï¼ˆ<code>ps aux | grep program</code>æŸ¥çœ‹pidï¼‰</li><li><code>file xxx</code>ï¼šæŒ‡å®šè¦è°ƒè¯•çš„ç¨‹åº</li><li><code>symbol-file xxx</code>ï¼šå•ç‹¬åŠ è½½åˆ†ç¦»çš„è°ƒè¯•ä¿¡æ¯</li><li><code>r</code>, <code>run</code>ï¼šå¼€å§‹è¿è¡Œ</li><li><code>start</code>ï¼šå¼€å§‹è¿è¡Œå¹¶æš‚åœåœ¨mainå‡½æ•°å…¥å£</li><li><code>!command</code>ï¼šæ‰§è¡Œshellå‘½ä»¤</li><li><code>source xxx</code>, <code>-x xxx</code>ï¼šæ‰§è¡Œè„šæœ¬</li></ul><h3 id="æ–­ç‚¹"><a href="#æ–­ç‚¹" class="headerlink" title="æ–­ç‚¹"></a>æ–­ç‚¹</h3><ul><li><code>info breakpoints</code>ï¼šæŸ¥çœ‹å·²è®¾ç½®çš„æ–­ç‚¹</li><li><code>b linenumber</code></li><li><code>b filename:linenumber</code></li><li><code>b function</code></li><li><code>b test.c:23 if b==0</code>ï¼šæ¡ä»¶æ–­ç‚¹</li><li><code>condition 1 b==0</code>ï¼šè®¾ç½®1å·æ–­ç‚¹çš„æ¡ä»¶</li><li><code>rbreak regex</code>ï¼šä½œç”¨äºæ‰€æœ‰åŒ¹é…regexçš„å‡½æ•°å</li><li><code>tbreak</code>ï¼šè®¾ç½®ä¸´æ—¶æ–­ç‚¹ï¼Œåªç”Ÿæ•ˆä¸€æ¬¡</li><li><code>watch cond</code>ï¼šè§‚å¯ŸæŸä¸ªå˜é‡æˆ–è¡¨è¾¾å¼çš„å–å€¼ï¼Œæ¯æ¬¡å‘ç”Ÿå˜åŒ–æ—¶æš‚åœï¼ˆæœ‰ç¡¬ä»¶è§‚å¯Ÿç‚¹å’Œè½¯ä»¶è§‚å¯Ÿç‚¹ï¼Œ<br>ç¡¬ä»¶è§‚å¯Ÿç‚¹çš„æ•°é‡æœ‰é™ï¼‰</li><li><code>disable</code>ï¼šç¦ç”¨æ–­ç‚¹</li><li><code>enable</code>ï¼šå¯ç”¨æ–­ç‚¹</li><li><code>delete</code>, <code>delete number</code>ï¼šåˆ é™¤æ–­ç‚¹</li><li><code>command number</code>ï¼šè®¾ç½®åœ¨è¾¾åˆ°numberå·æ–­ç‚¹æ—¶è‡ªåŠ¨æ‰§è¡Œçš„å‘½ä»¤</li></ul><h3 id="æŸ¥çœ‹ä¿¡æ¯"><a href="#æŸ¥çœ‹ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ä¿¡æ¯"></a>æŸ¥çœ‹ä¿¡æ¯</h3><ul><li><code>p</code>, <code>print</code>ï¼šæ‰“å°å˜é‡<ul><li><code>p *d</code>ï¼šæ‰“å°æŒ‡é’ˆæŒ‡å‘çš„å€¼</li><li><code>p *d@10</code>ï¼šæ‰“å°æŒ‡é’ˆæŒ‡å‘åœ°å€å¤„10ä¸ªå€¼</li><li><code>p $sp</code>ï¼šæ‰“å°å¯„å­˜å™¨ä¸­çš„å€¼</li><li><code>p/x</code>ï¼šåå…­è¿›åˆ¶æ‰“å°</li><li><code>p/t</code>ï¼šäºŒè¿›åˆ¶æ‰“å°</li><li><code>p/c</code>ï¼šå­—ç¬¦æ‰“å°</li><li><code>p/f</code>ï¼šæµ®ç‚¹æ•°æ‰“å°</li></ul></li><li><code>x</code>, <code>examine</code>ï¼šæŸ¥çœ‹å†…å­˜åœ°å€çš„å€¼<ul><li><code>x/nfu addr</code>ï¼šnæ˜¯å•å…ƒæ•°ï¼Œfæ˜¯æ‰“å°æ ¼å¼ï¼Œuæ˜¯å•å…ƒå¤§å°ï¼Œaddræ˜¯å†…å­˜åœ°å€</li><li><code>u</code>åŒ…æ‹¬bï¼ˆå­—èŠ‚ï¼‰ã€hï¼ˆåŒå­—èŠ‚ï¼‰ã€wï¼ˆå››å­—èŠ‚ï¼‰ã€gï¼ˆå…«å­—èŠ‚ï¼‰</li><li><code>x/4tb &amp;e</code>ï¼šæŸ¥çœ‹å˜é‡eæ‰€åœ¨åœ°å€å¼€å§‹çš„4ä¸ªå­—èŠ‚çš„å€¼</li></ul></li><li><code>bt</code>ï¼šæŸ¥çœ‹è°ƒç”¨æ ˆ<ul><li><code>bt n</code>ï¼šåªæ˜¾ç¤ºå‰nå±‚æ ˆå¸§</li></ul></li><li><code>frame number</code>ï¼šåˆ‡æ¢åˆ°numberå·æ ˆå¸§ï¼Œé€šå¸¸ç”¨æ¥æŸ¥çœ‹çˆ¶å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡</li><li><code>info frame</code>ï¼šæŸ¥çœ‹å½“å‰æ ˆå¸§ä¿¡æ¯</li><li><code>info args</code>ï¼šæŸ¥çœ‹å½“å‰å‡½æ•°å‚æ•°</li><li><code>info locals</code>ï¼šæŸ¥çœ‹å½“å‰å‡½æ•°å†…çš„å±€éƒ¨å˜é‡å€¼</li><li><code>info registers</code>ï¼šæŸ¥çœ‹å¯„å­˜å™¨çš„å€¼</li><li><code>info function</code>ï¼šæŸ¥çœ‹å‡½æ•°</li><li><code>info classes</code>ï¼šæŸ¥çœ‹ç±»</li><li><code>info proc mappings</code>ï¼šæŸ¥çœ‹å†…å­˜åŒºåŸŸæ˜ å°„</li><li><code>call func(arg)</code>ï¼šè°ƒç”¨å‡½æ•°ï¼›æ¯”å¦‚è°ƒç”¨ç¨‹åºå†…æä¾›çš„æ‰“å°å‡½æ•°</li><li><code>ptype</code>ï¼šæ‰“å°å˜é‡ç±»å‹</li><li><code>set $a=xxx</code>ï¼šè‡ªå®šä¹‰å˜é‡ï¼Œéœ€è¦ä»¥<code>$</code>å¼€å¤´ï¼Œç”¨æ¥ç®€åŒ–ä¸€äº›é•¿å˜é‡</li><li><code>dprintf location, formatting-string, expr1, expr2, ...</code>ï¼šåœ¨ç¨‹åºçš„æŸè¡Œæ’å…¥printfå‘½ä»¤ï¼ˆåŠ¨æ€æ‰“å°ï¼‰</li></ul><h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><ul><li><code>l</code>, <code>list</code>ï¼šæ˜¾ç¤ºå½“å‰æ‰€åœ¨è¡ŒåŠä¹‹åçš„10è¡Œæºä»£ç </li><li><code>n</code>, <code>next</code>ï¼šå•æ­¥æ‰§è¡Œ</li><li><code>s</code>, <code>step</code>ï¼šå•æ­¥æ‰§è¡Œï¼Œå‡½æ•°è°ƒç”¨åˆ™ä¼šè¿›å…¥å‡½æ•°å†…ï¼ˆstep intoï¼‰</li><li><code>ni</code>, <code>nexti</code>ï¼šæ‰§è¡Œä¸€æ¡æœºå™¨æŒ‡ä»¤</li><li><code>si</code>, <code>stepi</code></li><li><code>c</code>, <code>continue</code>ï¼šç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹</li><li><code>u</code>, <code>until</code>ï¼šç»§ç»­è¿è¡Œåˆ°æŒ‡å®šä½ç½®æˆ–è€…è¿è¡Œå®Œå½“å‰çš„å¾ªç¯ä½“</li><li><code>finish</code>ï¼šç»§ç»­è¿è¡Œç›´è‡³å½“å‰å‡½æ•°ç»“æŸ</li></ul><h3 id="å¤šè¿›ç¨‹"><a href="#å¤šè¿›ç¨‹" class="headerlink" title="å¤šè¿›ç¨‹"></a>å¤šè¿›ç¨‹</h3><ul><li><code>set follow-fork-mode child</code>ï¼šåœ¨forkåè·Ÿè¸ªè°ƒè¯•å­è¿›ç¨‹</li><li><code>info inferiors</code>ï¼šæŸ¥çœ‹è°ƒè¯•çš„æ‰€æœ‰è¿›ç¨‹çš„ä¿¡æ¯ï¼ˆgdbç§°è¢«è°ƒè¯•è¿›ç¨‹ä¸ºinferiorï¼‰</li></ul><h3 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h3><ul><li><code>info threads</code>ï¼šæŸ¥çœ‹æ‰€æœ‰çº¿ç¨‹ä¿¡æ¯</li><li><code>thread id</code>ï¼šåˆ‡æ¢åˆ°idå·çº¿ç¨‹</li><li><code>thread apply all bt</code>ï¼šå°†å‘½ä»¤ä½œç”¨åˆ°æ‰€æœ‰çº¿ç¨‹ä¸Š </li><li><code>set scheduler-locking off/on</code>ï¼šé»˜è®¤å…³é—­è°ƒåº¦å™¨é”ï¼Œæ­¤æ—¶è¿è¡Œè°ƒè¯•çš„çº¿ç¨‹ï¼Œå…¶å®ƒçº¿ç¨‹ä¹Ÿä¼šè¿è¡Œã€‚<br>åœ¨å¼€å¯æ—¶ï¼Œåˆ™åªæœ‰è°ƒè¯•çš„çº¿ç¨‹ä¼šæ‰§è¡Œï¼Œå…¶å®ƒçº¿ç¨‹æš‚åœæ‰§è¡Œã€‚æ­¤å¤–è¿˜æœ‰<code>step</code>é€‰é¡¹ï¼Œå®ƒä¿è¯åœ¨å•æ­¥æ‰§è¡Œæ—¶ï¼Œ<br>æ°¸è¿œä¿æŒåœ¨å½“å‰è°ƒè¯•çš„çº¿ç¨‹ä¸‹ï¼Œä½†å…¶å®ƒçº¿ç¨‹ä»ç„¶ä¼šç»§ç»­æ‰§è¡Œï¼›<br>è€Œé»˜è®¤çš„<code>off</code>ä¸‹ï¼Œå¦‚æœå…¶å®ƒçº¿ç¨‹é‡åˆ°æ–­ç‚¹ï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å…¶å®ƒçº¿ç¨‹ä¸­ã€‚</li></ul><h2 id="tui"><a href="#tui" class="headerlink" title="tui"></a>tui</h2><ul><li><code>layout src</code>ï¼šæ˜¾ç¤ºæºä»£ç çª—å£ï¼ˆ<code>Ctrl-x-a</code>åˆ‡æ¢ï¼‰</li><li><code>layout asm</code>ï¼šæ˜¾ç¤ºæ±‡ç¼–ä»£ç çª—å£</li><li><code>layout reg</code>ï¼šæ˜¾ç¤ºå¯„å­˜å™¨çª—å£</li><li><code>Ctrl-l</code>ï¼šåˆ·æ–°çª—å£</li></ul><h2 id="pretty-printer"><a href="#pretty-printer" class="headerlink" title="pretty-printer"></a>pretty-printer</h2><ul><li><code>python/shell command</code>ï¼šè¿è¡Œpython/shellå‘½ä»¤</li><li><code>define</code>ï¼šè‡ªå®šä¹‰å‘½ä»¤</li></ul><h2 id="åå‘è°ƒè¯•"><a href="#åå‘è°ƒè¯•" class="headerlink" title="åå‘è°ƒè¯•"></a>åå‘è°ƒè¯•</h2><ul><li><code>record</code>ï¼šå¼€å§‹è®°å½•å½“å‰è°ƒè¯•ç¨‹åºçš„çŠ¶æ€</li><li><code>reverse-step/reverse-next</code>ï¼šåå‘å•æ­¥æ‰§è¡Œ</li><li><code>rr</code>å·¥å…·æ›´åŠ å¥½ç”¨</li></ul><h2 id="Dashboard"><a href="#Dashboard" class="headerlink" title="Dashboard"></a>Dashboard</h2>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxå‘½ä»¤</title>
      <link href="/2023/10/17/Linux%E5%91%BD%E4%BB%A4/"/>
      <url>/2023/10/17/Linux%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h2 id="du"><a href="#du" class="headerlink" title="du"></a>du</h2><p>æ˜¾ç¤ºç›®å½•æˆ–æ–‡ä»¶çš„å¤§å°ã€‚</p><ul><li><code>-b/-k/-m</code> ä»¥bytes/kb/mbä¸ºå•ä½</li><li><code>-h</code> ä»¥Kã€Mã€Gä¸ºå•ä½ï¼Œæé«˜å¯è¯»æ€§</li><li><code>-s</code> åªæ˜¾ç¤ºæ€»å’Œï¼Œä¹Ÿå°±æ˜¯â€.â€ç›®å½•çš„å¤§å°</li><li><code>--exclude</code> ç•¥è¿‡æŒ‡å®šç›®å½•æˆ–æ–‡ä»¶</li></ul><p><code>dust</code>ï¼ˆdu+rustï¼‰ä»¥æ ‘å‹ç»“æ„å±•ç¤ºï¼Œå¹¶æ˜¾ç¤ºå¤§å°å æ¯”ï¼Œæœ€ä¸‹é¢æ˜¯å†…å­˜å ç”¨æœ€å¤§çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚</p><p><code>ncdu</code>æ˜¯<code>du</code>çš„tuiç‰ˆæœ¬ï¼Œä»å¤§åˆ°å°åˆ—å‡ºæ‰€æœ‰ç›®å½•æˆ–æ–‡ä»¶çš„å¤§å°ï¼Œ<br>æŒ‰<code>?</code>æŸ¥çœ‹å¿«æ·é”®ï¼Œå…¶ä¸­<code>d</code>åˆ é™¤ï¼Œ<code>q</code>é€€å‡ºã€‚</p><h2 id="tldr"><a href="#tldr" class="headerlink" title="tldr"></a>tldr</h2><p>mançš„è¨€ç®€æ„èµ…ç‰ˆæœ¬ã€‚</p><h2 id="md5sum"><a href="#md5sum" class="headerlink" title="md5sum"></a>md5sum</h2><p>åœ¨ä¼ è¾“å¤§æ–‡ä»¶æ—¶ï¼Œæ•°æ®å¯èƒ½å‡ºç°ä¸ä¸€è‡´é—®é¢˜ï¼Œå¯ä»¥ç”¨md5å€¼ç®€å•æ ¡éªŒæ–‡ä»¶å†…å®¹æ˜¯å¦æ­£ç¡®ã€‚</p><ul><li><code>md5sum &#123;&#123;path/to/file&#125;&#125;</code>ï¼šè®¡ç®—ä¸€ä¸ªæ–‡ä»¶çš„md5hå€¼</li><li><code>md5sum --check &#123;&#123;path/to/file.md5&#125;&#125;</code>ï¼šæ£€æŸ¥è¯¥æ–‡ä»¶ä¸­ç½—åˆ—çš„æ¯ä¸ªæ–‡ä»¶ä¸å¯¹åº”çš„md5å€¼æ˜¯å¦ä¸€è‡´ï¼ˆæ¯è¡Œæ˜¯æ–‡ä»¶åå’Œmd5å€¼ï¼‰</li></ul><h2 id="pstack"><a href="#pstack" class="headerlink" title="pstack"></a>pstack</h2><p>å”¯ä¸€çš„ç”¨æ³•å°±æ˜¯<code>pstack &lt;PID&gt;</code>ï¼Œç”¨äºæ‰“å°æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹PIDçš„å †æ ˆä¿¡æ¯ã€‚</p><p>ç”¨äºäº†è§£ä¸€ä¸ªè¿›ç¨‹å½“å‰æ­£åœ¨åšä»€ä¹ˆï¼Œå¸®åŠ©æ­»é”æ£€æµ‹ã€æ€§èƒ½åˆ†æã€é—®é¢˜æ’æŸ¥ç­‰ã€‚</p><h2 id="pmap"><a href="#pmap" class="headerlink" title="pmap"></a>pmap</h2><ul><li><code>pmap &lt;PID&gt;</code>ï¼šæ˜¾ç¤ºè¿›ç¨‹PIDçš„åœ°å€ç©ºé—´</li><li><code>-p</code>ï¼šæ˜¾ç¤ºå®Œæ•´è·¯å¾„</li></ul><h2 id="lsof"><a href="#lsof" class="headerlink" title="lsof"></a>lsof</h2><p>list open filesï¼ˆåˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€çš„æ–‡ä»¶ï¼‰ã€‚</p><ul><li><code>lsof</code></li><li><code>lsof &#123;&#123;path/to/file&#125;&#125;</code>ï¼šè¾“å‡ºæ‰“å¼€è¯¥æ–‡ä»¶çš„æ‰€æœ‰è¿›ç¨‹</li><li><code>lsof -c &#123;&#123;command&#125;&#125;</code>ï¼šè¾“å‡ºè¯¥å‘½ä»¤ä¼šæ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶</li><li><code>lsof -p &#123;&#123;PID&#125;&#125;</code>ï¼šè¾“å‡ºè¿›ç¨‹PIDæ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶</li></ul><h2 id="vmstat"><a href="#vmstat" class="headerlink" title="vmstat"></a>vmstat</h2><p>virtual memory statisticsï¼ˆè™šæ‹Ÿå†…å­˜ç»Ÿè®¡ï¼‰</p><ul><li><code>vmstat</code></li><li><code>vmstat 2 3</code>ï¼šæ¯éš”2ç§’é‡‡é›†ä¸€æ¬¡çŠ¶æ€ï¼Œå…±é‡‡é›†3æ¬¡</li></ul><h2 id="df"><a href="#df" class="headerlink" title="df"></a>df</h2><p>åˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨æƒ…å†µã€‚</p><h2 id="dd"><a href="#dd" class="headerlink" title="dd"></a>dd</h2><p>ä»æ ‡å‡†è¾“å…¥æˆ–æ–‡ä»¶è¯»å–æ•°æ®ï¼Œè½¬æ¢å¹¶è¾“å‡ºåˆ°æ–‡ä»¶ã€è®¾å¤‡æˆ–æ ‡å‡†è¾“å‡ºã€‚</p><h2 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h2><h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><h2 id="iostat"><a href="#iostat" class="headerlink" title="iostat"></a>iostat</h2><h2 id="pldd"><a href="#pldd" class="headerlink" title="pldd"></a>pldd</h2><h2 id="source"><a href="#source" class="headerlink" title="source"></a>source</h2><p>è¯»å–å¹¶æ‰§è¡Œæ–‡ä»¶ä¸­çš„å‘½ä»¤ï¼Œå®ƒä¸sh/bashçš„åŒºåˆ«æ˜¯ä¸ä¼šåˆ›å»ºä¸€ä¸ªå­shellï¼Œè€Œæ˜¯åœ¨å½“å‰shellä¸­æ‰§è¡Œã€‚</p><p><code>.</code>ç­‰ä»·äº<code>source</code>ã€‚</p><h2 id="stress"><a href="#stress" class="headerlink" title="stress"></a>stress</h2><p>Linuxä¸‹çš„å¯ä»¥å¯¹CPUã€IOã€MEMã€Diskè¿›è¡Œå‹åŠ›æµ‹è¯•çš„å·¥å…·ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-t, --<span class="built_in">timeout</span> N    <span class="built_in">timeout</span> after N seconds</span><br><span class="line">-c, --cpu N        spawn N workers spinning on sqrt()</span><br><span class="line">-i, --io N         spawn N workers spinning on <span class="built_in">sync</span>()</span><br><span class="line">-m, --vm N         spawn N workers spinning on malloc()/free()</span><br><span class="line">-d, --hdd N        spawn N workers spinning on write()/unlink()</span><br></pre></td></tr></table></figure><h2 id="file"><a href="#file" class="headerlink" title="file"></a>file</h2><h2 id="strip"><a href="#strip" class="headerlink" title="strip"></a>strip</h2><p>å»é™¤æ— ç”¨çš„ç¬¦å·ä¿¡æ¯ï¼Œå‡å°releaseç‰ˆæœ¬çš„å…±äº«åº“å¤§å°ã€‚<br>æ³¨æ„stripéœ€è¦å’Œå…±äº«åº“çš„å¹³å°ä¸€è‡´ï¼ˆç”¨<code>file</code>æŸ¥çœ‹ï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strip --strip-debug xxx.so</span><br><span class="line">strip --strip-unneeded xxx.so</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 260. åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—III</title>
      <link href="/2023/10/16/Leetcode-260-%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97III/"/>
      <url>/2023/10/16/Leetcode-260-%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97III/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>æœ‰ä¸€ä¸ªæ•°ç»„<code>nums</code>ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæ•°å­—åªå‡ºç°äº†1æ¬¡ï¼Œå…¶ä½™æ•°å­—éƒ½å‡ºç°äº†æ°å¥½2æ¬¡ï¼Œé—®åªå‡ºç°1æ¬¡çš„é‚£ä¸¤ä¸ªæ•°å­—ã€‚</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>é™¤äº†å¼‚æˆ–å¤–æƒ³ä¸åˆ°èƒ½å†è·å–ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæœ€åçœ‹äº†çœ¼é¢˜è§£æ‰ä¼šğŸ¤¡ã€‚ã€‚</p><p>é¦–å…ˆæŠŠæ‰€æœ‰æ•°å¼‚æˆ–èµ·æ¥å¯ä»¥çŸ¥é“è¿™ä¸¤ä¸ªæ•°å­—<code>x</code>å’Œ<code>y</code>çš„å¼‚æˆ–å€¼ã€‚</p><p>ä¸‹é¢å°±æ˜¯å…³é”®äº†ï¼Œç”±äº<code>x != y</code>ï¼Œ<code>x ^ y</code>ä¸€å®šæœ‰æŸä¸€ä½æ˜¯1ï¼Œä¸”<code>x</code>å’Œ<code>y</code>åœ¨è¯¥ä½ä¸Šä¸€ä¸ªæ˜¯1ï¼Œä¸€ä¸ªæ˜¯0ã€‚äºæ˜¯æŠŠæ•°ç»„æŒ‰ç…§è¯¥ä½çš„å–å€¼åˆ†æˆä¸¤ä»½ï¼Œå°±é€€åŒ–ä¸ºé—®é¢˜ã€Šåªå‡ºç°ä¸€æ¬¡çš„æ•°å­—Iã€‹äº†ï¼Œåˆ†åˆ«å¼‚æˆ–å³å¯ã€‚</p><p>è®¡ç®—æŸä¸€ä½å¯ä»¥ç”¨<code>x &amp; (-x)</code>å¾—åˆ°æœ€ä½ä½å³å¯ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">single_number</span>(nums: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt;) <span class="punctuation">-&gt;</span> <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">xor</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">num</span> <span class="keyword">in</span> nums.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">            xor ^= num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">low_bit</span> = xor &amp; (-xor);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">y</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">num</span> <span class="keyword">in</span> nums &#123;</span><br><span class="line">            <span class="keyword">if</span> num &amp; low_bit != <span class="number">0</span> &#123;</span><br><span class="line">                x ^= num;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                y ^= num;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vec!</span>[x, y]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 137. åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—II</title>
      <link href="/2023/10/15/Leetcode-137-%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97II/"/>
      <url>/2023/10/15/Leetcode-137-%E5%8F%AA%E5%87%BA%E7%8E%B0%E4%B8%80%E6%AC%A1%E7%9A%84%E6%95%B0%E5%AD%97II/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>ä¸€ä¸ªæ•°ç»„ä¸­æœ‰ä¸€ä¸ªæ•°å­—åªå‡ºç°äº†1æ¬¡ï¼Œ å…¶ä½™æ•°å­—éƒ½å‡ºç°äº†Kæ¬¡ (K &gt; 1)ï¼Œé—®å‡ºç°1æ¬¡çš„æ•°å­—æ˜¯ä»€ä¹ˆ</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>æŒ‰ç…§äºŒè¿›åˆ¶é€ä½ç¡®å®šå³å¯ï¼Œå¦‚æœè¯¥ä½1çš„ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ä¸ºnk + 1ï¼Œè¯´æ˜å‡ºç°1æ¬¡çš„æ•°å­—åŒ…å«è¯¥ä½ã€‚</p><p>é‡åˆ°çš„ä¸€ä¸ªå‘æ˜¯Goè¯­è¨€ä¸­çš„intçš„å¤§å°æ˜¯å’Œæ“ä½œç³»ç»Ÿçš„ä½æ•°æœ‰å…³çš„ï¼Œåœ¨64ä½ä¸Šæ˜¯8å­—èŠ‚ï¼ˆç±»ä¼¼äºC++ä¸­çš„size_tï¼‰ã€‚</p><p>å½“æ—¶ç”¨é»˜è®¤çš„int WAäº†ä¹‹åï¼Œæˆ‘ä»¥ä¸ºæ˜¯æœ‰ç¬¦å·æ•°ä½ç§»ï¼Œä»¥åŠæœ‰ç¬¦å·æ•°æº¢å‡ºæœªå®šä¹‰å¯¼è‡´çš„é—®é¢˜ã€‚</p><p>è®°å½•ä¸€ä¸‹ï¼š</p><ul><li>å·¦ç§»ä½ä½è¡¥0å³å¯ï¼Œé€»è¾‘ç§»ä½å’Œç®—æœ¯ç§»ä½ä¸€æ ·</li><li>æœ‰ç¬¦å·æ•°å³ç§»æ˜¯ç®—æœ¯ç§»ä½ï¼Œé«˜ä½è¡¥ç¬¦å·ä½</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">singleNumber</span><span class="params">(nums []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> ans <span class="type">int32</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">32</span>; i++ &#123;</span><br><span class="line">        cnt := <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _, num := <span class="keyword">range</span> nums &#123;</span><br><span class="line">            cnt += (num &gt;&gt; i) &amp; <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> cnt % <span class="number">3</span> == <span class="number">1</span> &#123;</span><br><span class="line">            ans |= (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">int</span>(ans)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¦‚æœvarç”¨é»˜è®¤çš„intç±»å‹å–å€¼å¯èƒ½å¤§äºç­‰äº$2^{31}$ï¼Œæ­¤æ—¶å†è½¬int32ä¹Ÿæ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</p><p>å½“kå¾ˆå°æ—¶ï¼Œå¯ä»¥è‡ªè¡Œæ„é€ ä½è¿ç®—ã€‚æ¯”å¦‚k=2æ—¶ç”¨å¼‚æˆ–ï¼Œk=3æ—¶ä¸º(0, 0)-&gt;(0, 1)-&gt;(1, 0)-&gt;(0, 0)â€¦ï¼Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a, b = (a ^ x) &amp; (a | b), (b ^ x) &amp; ~a </span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•</title>
      <link href="/2023/10/13/%E5%88%86%E5%B8%83%E5%BC%8FID%E7%94%9F%E6%88%90%E7%AE%97%E6%B3%95/"/>
      <url>/2023/10/13/%E5%88%86%E5%B8%83%E5%BC%8FID%E7%94%9F%E6%88%90%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>åˆ†å¸ƒå¼IDç”Ÿæˆä¸€èˆ¬è¦æ±‚å”¯ä¸€æ€§ã€é€’å¢å‹ã€é«˜å¯ç”¨æ€§å’Œé«˜æ€§èƒ½ã€‚</p><h2 id="UUID"><a class="header-anchor" href="#UUID">Â¶</a>UUID</h2><p>Universally Unique Identifierï¼Œå³é€šç”¨å”¯ä¸€æ ‡è¯†ç ï¼Œæœ‰128ä½ï¼Œé€šå¸¸ç”¨32ä½16è¿›åˆ¶æ•°è¡¨ç¤ºï¼Œå¹¶ä»¥è¿å­—å·åˆ†ä¸ºäº”æ®µï¼Œå½¢å¼ä¸º8-4-4-4-12ã€‚</p><h2 id="snowflake"><a class="header-anchor" href="#snowflake">Â¶</a>snowflake</h2><p>é›ªèŠ±ç®—æ³•ç”±Twitterå¼€æºï¼Œå®ƒç”Ÿæˆçš„æ¯ä¸ªIDæœ‰64ä½ï¼Œå…¶ä¸­ï¼š</p><ul><li>ç¬¬1ä½å§‹ç»ˆä¸º0</li><li>ç¬¬2~42ä½ä¸ºæ¯«ç§’çº§æ—¶é—´æˆ³ï¼Œå¯ç”¨69å¹´ï¼Œ$2^41$çº¦ä¸º$2.2\times 10^{13}$</li><li>ç¬¬43~52ä½ä¸ºæœºå™¨IDï¼Œå¯è¡¨ç¤º1024å°ï¼›è¿™é‡Œå¯ä»¥è‡ªè¡Œåˆ†é…ï¼Œæ¯”å¦‚å‰5ä½è¡¨ç¤ºæ•°æ®ä¸­å¿ƒIDï¼Œå5ä½å†è¡¨ç¤ºæŸä¸ªæ•°æ®ä¸­å¿ƒå†…çš„æœºå™¨ID</li><li>ç¬¬53~64ä½æ˜¯è‡ªå¢åºåˆ—ï¼Œå¯è¡¨ç¤º4096ä¸ªæ•°</li></ul><p>è¿™æ ·ï¼Œæ¯ä¸€æ¯«ç§’åœ¨æ¯ä¸€å°æœºå™¨ä¸Šéƒ½èƒ½äº§ç”Ÿ4096ä¸ªæœ‰åºé€’å¢ä¸”ä¸é‡å¤çš„IDã€‚</p><p><a data-fancybox="gallery" data-src="/post-images/snowflake-id.png" data-caption="IDæ„æˆ"><img src="/post-images/snowflake-id.png" alt="IDæ„æˆ"></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">InvalidSystemClock</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ—¶é’Ÿå›æ‹¨å¼‚å¸¸</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 64ä½IDçš„åˆ’åˆ†</span></span><br><span class="line">WORKER_ID_BITS = <span class="number">5</span></span><br><span class="line">DATACENTER_ID_BITS = <span class="number">5</span></span><br><span class="line">SEQUENCE_BITS = <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤§å–å€¼è®¡ç®—</span></span><br><span class="line">MAX_WORKER_ID = -<span class="number">1</span> ^ (-<span class="number">1</span> &lt;&lt; WORKER_ID_BITS)  <span class="comment"># 2**5-1 0b11111</span></span><br><span class="line">MAX_DATACENTER_ID = -<span class="number">1</span> ^ (-<span class="number">1</span> &lt;&lt; DATACENTER_ID_BITS)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç§»ä½åç§»è®¡ç®—</span></span><br><span class="line">WOKER_ID_SHIFT = SEQUENCE_BITS</span><br><span class="line">DATACENTER_ID_SHIFT = SEQUENCE_BITS + WORKER_ID_BITS</span><br><span class="line">TIMESTAMP_LEFT_SHIFT = SEQUENCE_BITS + WORKER_ID_BITS + DATACENTER_ID_BITS</span><br><span class="line"></span><br><span class="line"><span class="comment"># åºå·å¾ªç¯æ©ç </span></span><br><span class="line">SEQUENCE_MASK = -<span class="number">1</span> ^ (-<span class="number">1</span> &lt;&lt; SEQUENCE_BITS)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å§‹æ—¶é—´æˆª (2015-01-01)</span></span><br><span class="line">TWEPOCH = <span class="number">1420041600000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IdWorker</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç”¨äºç”ŸæˆIDs</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, datacenter_id, worker_id, sequence=<span class="number">0</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆå§‹åŒ–</span></span><br><span class="line"><span class="string">        :param datacenter_id: æ•°æ®ä¸­å¿ƒï¼ˆæœºå™¨åŒºåŸŸï¼‰ID</span></span><br><span class="line"><span class="string">        :param worker_id: æœºå™¨ID</span></span><br><span class="line"><span class="string">        :param sequence: å…¶å®åºå·</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># sanity check</span></span><br><span class="line">        <span class="keyword">if</span> worker_id &gt; MAX_WORKER_ID <span class="keyword">or</span> worker_id &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;worker_idå€¼è¶Šç•Œ&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> datacenter_id &gt; MAX_DATACENTER_ID <span class="keyword">or</span> datacenter_id &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;datacenter_idå€¼è¶Šç•Œ&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        self.worker_id = worker_id</span><br><span class="line">        self.datacenter_id = datacenter_id</span><br><span class="line">        self.sequence = sequence</span><br><span class="line"></span><br><span class="line">        self.last_timestamp = -<span class="number">1</span>  <span class="comment"># ä¸Šæ¬¡è®¡ç®—çš„æ—¶é—´æˆ³</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_gen_timestamp</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ç”Ÿæˆæ•´æ•°æ—¶é—´æˆ³</span></span><br><span class="line"><span class="string">        :return:int timestamp</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(time.time() * <span class="number">1000</span>)</span><br><span class="line">        <span class="comment"># å…¶å®åº”è¿”å›å½“å‰çš„æ¯«ç§’æ•°ï¼Œä½†è¿™é‡Œè¿”å›çš„æ˜¯ç§’æ•°*1000ï¼Œtime.time()çš„è¿”å›å€¼æ˜¯xxxxxxxxxx.xxxxxx</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_id</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è·å–æ–°ID</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        timestamp = self._gen_timestamp()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ—¶é’Ÿå›æ‹¨</span></span><br><span class="line">        <span class="keyword">if</span> timestamp &lt; self.last_timestamp:</span><br><span class="line">            <span class="keyword">raise</span> InvalidSystemClock</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> timestamp == self.last_timestamp:</span><br><span class="line">            self.sequence = (self.sequence + <span class="number">1</span>) &amp; SEQUENCE_MASK</span><br><span class="line">            <span class="keyword">if</span> self.sequence == <span class="number">0</span>:</span><br><span class="line">                timestamp = self._til_next_millis(self.last_timestamp)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.sequence = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        self.last_timestamp = timestamp</span><br><span class="line"></span><br><span class="line">        new_id = ((timestamp - TWEPOCH) &lt;&lt; TIMESTAMP_LEFT_SHIFT) | (self.datacenter_id &lt;&lt; DATACENTER_ID_SHIFT) | \</span><br><span class="line">                 (self.worker_id &lt;&lt; WOKER_ID_SHIFT) | self.sequence</span><br><span class="line">        <span class="keyword">return</span> new_id</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_til_next_millis</span>(<span class="params">self, last_timestamp</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        ç­‰åˆ°ä¸‹ä¸€æ¯«ç§’</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        timestamp = self._gen_timestamp()</span><br><span class="line">        <span class="keyword">while</span> timestamp &lt;= last_timestamp:</span><br><span class="line">            timestamp = self._gen_timestamp()</span><br><span class="line">        <span class="keyword">return</span> timestamp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    worker = IdWorker(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(worker.get_id())</span><br></pre></td></tr></table></figure><p>ç®—æ³•å®ç°å…¶å®å¾ˆç®€å•ï¼Œåœ¨åŒä¸€æ¯«ç§’å†…ï¼Œé€’å¢æœ€åçš„åºåˆ—å·å³å¯ã€‚å¦‚æœåºåˆ—å·è¶…è¿‡4096ï¼Œå°±ç­‰å¾…ä¸‹ä¸€æ¯«ç§’ã€‚</p><p>æ˜¾ç„¶è¯¥ç®—æ³•å¼ºä¾èµ–äºæœºå™¨æ—¶é’Ÿï¼Œå¦‚æœå‡ºç°æ—¶é’Ÿå›æ‹¨ï¼ˆå³å½“å‰è·å¾—çš„æ—¶é—´æˆ³å°äºä¹‹å‰è®°å½•çš„æ—¶é—´æˆ³ï¼‰ï¼Œå°±å¯èƒ½ç”Ÿæˆé‡å¤çš„IDã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><ul><li>é»˜è®¤æ˜¯ç›´æ¥æŠ›å‡ºå¼‚å¸¸</li><li>å¯ä»¥å®Œå…¨ä¸ä¾èµ–äºæœºå™¨æ—¶é’Ÿï¼Œè‡ªè¡Œä»0å¼€å§‹ç»´æŠ¤â€œæ—¶é—´æˆ³â€ï¼Œæ¯æ¬¡åºåˆ—å·è¾¾åˆ°4096æ—¶å†è‡ªè¡ŒåŠ 1</li><li>å‘ç”Ÿæ—¶é—´å›æ‹¨æ—¶é˜»å¡ç­‰å¾…ç›´è‡³æ­£å¸¸</li><li>ç¼“å­˜ä¹‹å‰æ—¶é—´æˆ³ä¸­æ²¡ç”¨çš„åºåˆ—å·ï¼Œåœ¨æ—¶é—´å›æ‹¨æ—¶ä½¿ç”¨</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 2731. ç§»åŠ¨æœºå™¨äºº</title>
      <link href="/2023/10/10/Leetcode-2731-%E7%A7%BB%E5%8A%A8%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
      <url>/2023/10/10/Leetcode-2731-%E7%A7%BB%E5%8A%A8%E6%9C%BA%E5%99%A8%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>æœ‰nä¸ªæœºå™¨äººä½äºä¸€ä¸ªæ— é™é•¿æ¨ªè½´ï¼Œæ¯ä¸ªæœºå™¨äººæ¯ç§’ä¼šå‘å·¦æˆ–å‘å³ç§»åŠ¨ä¸€æ ¼ï¼Œç‰¹åˆ«åœ°ï¼Œå¦‚æœä¸¤ä¸ªæœºå™¨äººä½äºåŒä¸€æ ¼ï¼Œå°±å‘ç”Ÿç›¸æ’ï¼Œå¹¶å„è‡ªè½¬ä¸ºåå‘ç§»åŠ¨ã€‚ç°åœ¨é—®$d$ç§’åï¼Œæ‰€æœ‰æœºå™¨äººä¸¤ä¸¤è·ç¦»ä¹‹å’Œã€‚</p><p>$n \le 10^5, d \le 10^9$</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å…³é”®ç‚¹æ˜¯æœºå™¨äººç›¸æ’ååå‘åº”è¯¥ç†è§£æˆç©¿é€ã€‚</p><p>ç°åœ¨è€ƒè™‘ä»»æ„ä¸¤ä¸ªæœºå™¨äººï¼Œå¦‚æœæ–¹å‘ä¸º<code>LL</code>æˆ–<code>RR</code>åˆ™è·ç¦»ä¿æŒä¸å˜ï¼Œå¦‚æœä¸º<code>LR</code>åˆ™è·ç¦»æ¯ç§’åŠ 2ï¼Œè€Œå¦‚æœä¸º<code>RL</code>ï¼Œåœ¨ç›¸æ’å‰æ¯ç§’å‡2ï¼ˆ[1, dis / 2]ï¼‰ï¼Œç›¸æ’åæ¯ç§’åŠ 2 ([dis / 2 + 1, d]ï¼Œå…¶ä¸­disä¸ºå¥‡æ•°æ—¶ï¼Œdis/2+1ç§’çš„è·ç¦»ä¸å˜)ã€‚</p><p>æ˜¾ç„¶å¯ä»¥$O(n^2)$è®¡ç®—ã€‚ç„¶åæˆ‘å°±æƒ³ç€ä¼˜åŒ–æˆ$O(n)$ã€‚</p><p>éš¾ç‚¹åœ¨<code>LR</code>çš„è´¡çŒ®è®¡ç®—ï¼Œè€ƒè™‘ä¸€ä¸ª<code>L</code>ï¼Œç°åœ¨è¦$O(1)$çš„ç»Ÿè®¡åé¢æ‰€æœ‰çš„<code>R</code>ã€‚è¿›ä¸€æ­¥åœ°ï¼Œå¯ä»¥å°†è¿™äº›<code>R</code>åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ä¸€ç›´å‡2ï¼Œä¸€ç±»åœ¨å‡2åä¼šåŠ 2ã€‚åªéœ€è¦è®¡ç®—åŠ 2çš„æ€»æ—¶é—´å³å¯ã€‚ç”±äºè¿™é‡Œéœ€è¦å‘ä¸‹å–æ•´ï¼Œä»¥åŠæ¶‰åŠåˆ°ä¸€ä¸ªdisä¸ºå¥‡æ•°æ—¶çš„ç‰¹æ®Šcaseï¼ˆè¿™é‡Œæƒ³äº†å¾ˆä¹…æ€ä¹ˆå¤„ç†è¿™ç§æ£˜æ‰‹çš„æƒ…å†µï¼‰ï¼Œæ‰€ä»¥è¿˜éœ€è¦åˆ†å¥‡å¶ç»´æŠ¤ä¸¤ä¸ªåç¼€å’Œæ¥ç®—ã€‚</p><p>å¦ä¸€ä¸ªæ¶å¿ƒçš„åœ°æ–¹æ˜¯è¾“å…¥çš„æœºå™¨äººä½ç½®ä¸æ˜¯æœ‰åºçš„ã€‚</p><p>äºæ˜¯æˆ‘å°±å†™äº†1ä¸ªå¤šå°æ—¶ï¼Œè¿˜waäº†2å‘ã€‚ã€‚ğŸ¤§</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sumDistance</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, string s, <span class="type">int</span> d)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">id</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="built_in">iota</span>(id.<span class="built_in">begin</span>(), id.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">sort</span>(id.<span class="built_in">begin</span>(), id.<span class="built_in">end</span>(), [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">            <span class="keyword">return</span> nums[x] &lt; nums[y];</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> pres = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            pres += nums[id[i]];</span><br><span class="line">            <span class="built_in">Add</span>(ans, (<span class="number">1ll</span> * nums[id[i]] * (i + <span class="number">1</span>) - pres) % MOD);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> cntl = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[id[i]] == <span class="string">&#x27;L&#x27;</span>) ++cntl;</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">Add</span>(ans, <span class="number">2ll</span> * cntl * d % MOD);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> sodd = <span class="number">0</span>, seven = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, codd = <span class="number">0</span>, ceven = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[id[i]] == <span class="string">&#x27;L&#x27;</span>) &#123;</span><br><span class="line">                --cntl;</span><br><span class="line">                <span class="keyword">if</span> (nums[id[i]] &amp; <span class="number">1</span>) --codd, sodd -= nums[id[i]];</span><br><span class="line">                <span class="keyword">else</span> --ceven, seven -= nums[id[i]];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">Sub</span>(ans, <span class="number">2ll</span> * cntl * d % MOD);</span><br><span class="line">                <span class="keyword">while</span> (j &lt; n) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (s[id[j]] == <span class="string">&#x27;R&#x27;</span>) ++j;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="type">int</span> t = nums[id[j]] - nums[id[i]];</span><br><span class="line">                        <span class="keyword">if</span> (d &gt;= t / <span class="number">2</span> + <span class="number">1</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (nums[id[j]] &amp; <span class="number">1</span>) ++codd, sodd += nums[id[j]];</span><br><span class="line">                            <span class="keyword">else</span> ++ceven, seven += nums[id[j]];</span><br><span class="line">                            ++j;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (nums[id[i]] &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="built_in">Sub</span>(ans, <span class="number">2</span> * ceven);</span><br><span class="line">                        <span class="built_in">Add</span>(ans, <span class="number">4ll</span> * (codd + ceven) * d % MOD);</span><br><span class="line">                        <span class="built_in">Sub</span>(ans, <span class="number">2ll</span> * (sodd - <span class="number">1ll</span> * codd * nums[id[i]]) % MOD);</span><br><span class="line">                        <span class="built_in">Sub</span>(ans, <span class="number">2ll</span> * (seven - ceven - <span class="number">1ll</span> * ceven * nums[id[i]]) % MOD);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="built_in">Sub</span>(ans, <span class="number">2</span> * codd);</span><br><span class="line">                        <span class="built_in">Add</span>(ans, <span class="number">4ll</span> * (codd + ceven) * d % MOD);</span><br><span class="line">                        <span class="built_in">Sub</span>(ans, <span class="number">2ll</span> * (sodd - codd - <span class="number">1ll</span> * codd * nums[id[i]]) % MOD);</span><br><span class="line">                        <span class="built_in">Sub</span>(ans, <span class="number">2ll</span> * (seven - <span class="number">1ll</span> * ceven * nums[id[i]]) % MOD);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;   </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x += y;</span><br><span class="line">        <span class="keyword">if</span> (x &gt;= MOD) x -= MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        x += MOD - y;</span><br><span class="line">        <span class="keyword">if</span> (x &gt;= MOD) x -= MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ­£è§£"><a class="header-anchor" href="#æ­£è§£">Â¶</a>æ­£è§£</h2><p>ç†è§£åˆ°ç©¿é€è¿™ä¸€ç‚¹åï¼Œæˆ‘ä»¬ç›´æ¥ç®—å‡º$d$ç§’åæ¯ä¸ªå°è½¦çš„è·ç¦»ï¼Œç„¶åä¸€ä¸ªå‰ç¼€å’Œç®—ç­”æ¡ˆä¸å°±å®Œäº‹äº†ã€‚ã€‚ï¼ˆçœ‹åˆ°é¢˜è§£å‘ç°æˆ‘å‚»äº†ï¼‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rust-snippets</title>
      <link href="/2023/10/08/rust-snippets/"/>
      <url>/2023/10/08/rust-snippets/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>do benchmark</title>
      <link href="/2023/09/26/do-benchmark/"/>
      <url>/2023/09/26/do-benchmark/</url>
      
        <content type="html"><![CDATA[<p><a href="https://quick-bench.com">quick-bench</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–è¯‘é€‰é¡¹</title>
      <link href="/2023/09/26/%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9/"/>
      <url>/2023/09/26/%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9/</url>
      
        <content type="html"><![CDATA[<ul><li><code>-Wall</code> <code>-Wextra</code></li><li><code>-Wshadow</code></li><li><code>-Wundef</code></li><li><code>-Wconversion</code></li><li><code>-fno-common</code>ï¼šé¿å…å…¨å±€å˜é‡</li><li><code>-Wfloat-equal</code></li><li><code>-Wunreachable-code</code></li><li><code>-Wformat=2</code>ï¼šæ£€æŸ¥<code>printf</code>å’Œ<code>scanf</code>çš„æ ¼å¼æ§åˆ¶ç¬¦</li><li><code>-fmudflap</code>ï¼šåœ¨è¿è¡Œæ—¶æ£€æŸ¥æŒ‡é’ˆæ“ä½œä»¥æ•è·æœªå®šä¹‰è¡Œä¸º</li><li><code>-fno-exceptions</code>ï¼šåœ¨ä»£ç ä¸­ä½¿ç”¨å¼‚å¸¸æ—¶ï¼ŒæŠ¥é”™</li><li><code>-ffast-math</code>ï¼›è¦æ±‚é«˜æ€§èƒ½ï¼Œä½†ä¸è¦æ±‚ç²¾åº¦</li><li><code>-fomit-frame-pointer</code>ï¼šçœç•¥æ ˆå¸§</li><li><code>-fno-plt</code></li><li><code>-no-pie</code>ï¼šå…³é—­ä½ç½®æ— å…³</li><li><code>-fPIE</code></li><li><code>-fPIC</code>ï¼šç”Ÿæˆä½ç½®æ— å…³ä»£ç ï¼Œç”¨äºç”Ÿæˆå…±äº«åº“</li><li><code>-m32</code>ï¼šç¼–è¯‘32ä½ç¨‹åº</li><li><code>-pedantic</code>ï¼šå¯¹éC++æ ‡å‡†çš„æ‰©å±•å‘å‡ºè­¦å‘Š</li><li><code>-fanalyzer</code>ï¼šå¯ç”¨é™æ€åˆ†æï¼Œä»¥æŠ¥å‘Šæ›´å¤šé—®é¢˜ï¼ˆæœ‰æ›´é«˜çš„overheadï¼‰</li><li><code>-fstack-protector</code>ï¼šæ£€æŸ¥ç¼“å†²åŒºæº¢å‡º</li><li><code>-flto</code>ï¼šå¼€å¯é“¾æ¥æ—¶ä¼˜åŒ–ï¼Œé€šå¸¸ç¼–è¯‘å™¨åªä¼šåœ¨å•ä¸ªç¿»è¯‘å•å…ƒå†…è¿›è¡Œä¼˜åŒ–ï¼Œè¿™æ ·å¯ä»¥åœ¨æ•´ä¸ªç¨‹åºä¸Šä¼˜åŒ–</li><li><code>-rdynamic</code>ï¼šæŒ‡ç¤ºé“¾æ¥å™¨å°†æ‰€æœ‰ç¬¦å·ï¼ˆä¸ä»…æ˜¯å·²ç»ä½¿ç”¨çš„ï¼‰éƒ½æ·»åŠ åˆ°åŠ¨æ€ç¬¦å·è¡¨ä¸­</li><li><code>-march=native</code> <code>-mtune=native</code>ï¼šæ ¹æ®CPUè¿›è¡Œç‰¹å®šä¼˜åŒ–</li><li><code>-I</code> <code>-L</code>ï¼šæŒ‡å®šé“¾æ¥æ—¶æŸ¥æ‰¾çš„includeæ–‡ä»¶å¤¹å’Œå…±äº«åº“æ–‡ä»¶å¤¹ï¼Œç¯å¢ƒå˜é‡<code>$LD_LIBRARY_PATH</code>ä¸ºè¿è¡Œæ—¶æŸ¥æ‰¾çš„å…±äº«åº“æ–‡ä»¶å¤¹</li><li><code>-save-temps</code>ï¼šä¿ç•™æ‰€æœ‰ç¼–è¯‘çš„ä¸­é—´æ–‡ä»¶ï¼ˆ<code>.c</code>, <code>.i</code>, <code>.s</code>, <code>.o</code>ï¼‰</li><li><code>-v</code>ï¼šè¾“å‡ºè¯¦ç»†ä¿¡æ¯</li><li><code>-E</code>ï¼šåªè¿›è¡Œç¼–è¯‘é¢„å¤„ç†</li><li><code>-S</code>ï¼šç”Ÿæˆæ±‡ç¼–ï¼ˆä¸€èˆ¬äº§ç”Ÿçš„æ±‡ç¼–ä»¥<code>.s</code>ä¸ºåç¼€ï¼Œè€Œè‡ªå·±å†™çš„ä»¥<code>.S</code>ä¸ºåç¼€ï¼Œä¹Ÿæ˜¯ä¸ºäº†é¿å…è¢«è¦†ç›–ï¼‰</li><li><code>-l</code>ï¼šé“¾æ¥</li><li><code>-Os</code>ï¼šä¼˜åŒ–æ–‡ä»¶å¤§å°ï¼Œ<code>-Oz</code>æ›´æ¿€è¿›</li><li><code>-g</code>ï¼šæ·»åŠ debugä¿¡æ¯ï¼ˆdwarfï¼‰é»˜è®¤é€‰é¡¹ï¼ŒåŒ<code>-g2</code></li><li><code>-g0</code>ï¼šä¸ç”Ÿæˆä»»ä½•è°ƒè¯•ä¿¡æ¯ï¼Œå’Œç¼–è¯‘æ—¶ä¸åŠ <code>-g</code>æ˜¯ä¸€æ ·çš„ã€‚</li><li><code>-g1</code>ï¼šç”Ÿæˆæœ€å°‘é‡çš„è°ƒè¯•ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯è¶³å¤Ÿç”¨æ¥é€šè¿‡backtraceæŸ¥çœ‹è°ƒç”¨æ ˆç¬¦å·ä¿¡æ¯ã€‚ä¸»è¦åŒ…æ‹¬äº†å‡½æ•°å£°æ˜ã€å¤–éƒ¨å˜é‡å’Œè¡Œå·ç­‰ä¿¡æ¯ï¼Œä½†æ˜¯ä¸åŒ…å«å±€éƒ¨å˜é‡ä¿¡æ¯ã€‚è¿™ä¸ªé€‰é¡¹æ¯”è¾ƒå°‘ç”¨ã€‚</li><li><code>-g2</code>ï¼šç”Ÿæˆè¶³å¤Ÿå¤šçš„è°ƒè¯•ä¿¡æ¯ï¼Œå¯ä»¥ç”¨GDBè¿›è¡Œæ­£å¸¸çš„ç¨‹åºè°ƒè¯•ï¼Œè¿™ä¸ªæ˜¯é»˜è®¤é€‰é¡¹ã€‚</li><li><code>-g3</code>ï¼šåœ¨<code>-g2</code>çš„åŸºç¡€ä¸Šäº§ç”Ÿæ›´å¤šçš„ä¿¡æ¯ï¼Œå¦‚å®å®šä¹‰ã€‚</li><li><code>-Og</code>ï¼šä¸€å®šç¨‹åº¦çš„ä¼˜åŒ–ï¼Œä½†ä¿è¯debugä½“éªŒ</li><li><code>-s</code>ï¼šç§»é™¤ç¬¦å·è¡¨å’Œé‡å®šä½ä¿¡æ¯</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ£€æµ‹å†…å­˜é—®é¢˜</title>
      <link href="/2023/09/26/%E6%A3%80%E6%B5%8B%E5%86%85%E5%AD%98%E9%97%AE%E9%A2%98/"/>
      <url>/2023/09/26/%E6%A3%80%E6%B5%8B%E5%86%85%E5%AD%98%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="AddressSanitizer"><a class="header-anchor" href="#AddressSanitizer">Â¶</a>AddressSanitizer</h2><p>ç›¸æ¯”Valgrindå¿«ï¼Œä¸»è¦å°±æ˜¯æ›¿æ¢äº†ç¨‹åºä¸­çš„<code>malloc()</code>å’Œ<code>free()</code>ã€‚</p><p>åœ¨ç¼–è¯‘æ—¶æ·»åŠ ä»¥ä¸‹é€‰é¡¹ä¸ºç¼–è¯‘å‚æ•°ï¼ˆCFLAGS/CXXFLAGSï¼‰ä»¥åŠé“¾æ¥å‚æ•°ï¼ˆLDFLAGSï¼‰ï¼š</p><ul><li><code>-fsanitize=address</code>ï¼šå†…å­˜é”™è¯¯ï¼ˆé€šè¿‡æ›¿æ¢mallocï¼Œåœ¨æ¯æ¬¡ç”³è¯·å†…å­˜å—çš„å‰åéƒ½è®¾ç½®guardï¼‰</li><li><code>-fsanitize=leak</code>ï¼šå†…å­˜æ³„éœ²</li><li><code>-fsanitize=thread</code>ï¼šå¤šçº¿ç¨‹ç«äº‰</li><li><code>-fsanitize=undefined</code>ï¼šæœªå®šä¹‰æ“ä½œ</li><li><code>-fsanitize=memory</code>ï¼šæœªåˆå§‹åŒ–å†…å­˜è¯»å–ï¼ˆä¸addresså†²çªï¼‰</li><li><code>-fno-sanitize-recover</code>ï¼šåœ¨æ£€æµ‹åˆ°ç¬¬ä¸€ä¸ªé”™è¯¯åå°±é€€å‡ºï¼Œå¦åˆ™ä¼šç»§ç»­è¿è¡Œï¼ˆåœ¨æŒ‡å®šæ£€æµ‹<code>undefined</code>æ—¶å¯é€‰å¯ç”¨ï¼‰</li><li><code>-fsanitize=pointer-compare</code>ï¼šç¡®ä¿æ²¡æœ‰ä¸åŒå¯¹è±¡çš„æŒ‡é’ˆæ¯”è¾ƒï¼ˆéœ€è¦ç»“åˆ<code>address</code>ä½¿ç”¨ï¼Œä¸”ä¸èƒ½ä¸<code>thread</code>ä¸€èµ·ä½¿ç”¨ï¼‰</li></ul><p>å¯ä»¥ä½¿ç”¨<code>__attribute__((no_sanitize_address)</code>è·³è¿‡åˆ†ææŸä¸ªå‡½æ•°ã€‚</p><h2 id="Valgrind-Memcheck"><a class="header-anchor" href="#Valgrind-Memcheck">Â¶</a>Valgrind Memcheck</h2><p><code>valgrind --log-file=valgrind.log --tool=memcheck --leak-check=full ./prog</code></p><p>valgrindåœ¨æ£€æµ‹BPF CO-REç¨‹åºæ—¶ä¼šå‡ºç°<code>FATAL: unhandled eBPF command 22</code>çš„é—®é¢˜ã€‚</p><h2 id="å†…å­˜è¸©è¸"><a class="header-anchor" href="#å†…å­˜è¸©è¸">Â¶</a>å†…å­˜è¸©è¸</h2><p>Memory stompï¼šå¯¹ä¸å±äºä½ çš„å†…å­˜è¿›è¡Œè¯»å†™ã€‚</p><p>æœ‰æ—¶å€™ç‰¹æŒ‡è®¿é—®è¶Šç•Œï¼Œä½†æ°å¥½æ— æ„è¯†åœ°æ“ä½œåˆ°äº†å…¶å®ƒçš„åˆæ³•åœ°å€ï¼Œå¦‚å¦ä¸€ä¸ªæ•°æ®ç»“æ„ã€‚</p><p>ä¸€æ®µç»å…¸ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">include &lt;stdio.h&gt;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> <span class="built_in">array</span>[<span class="number">10</span>],i;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;=<span class="number">10</span> ; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">array</span>[i]=<span class="number">0</span>; <span class="comment">/*code should never terminate*/</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰å¯èƒ½$i$æ°å¥½åœ¨arrayçš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œæ¯æ¬¡<code>array[10]=0</code>ç­‰ä»·äº<code>i=0</code>ï¼Œä»è€Œå¯¼è‡´äº†æ­»å¾ªç¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 2603. æ”¶é›†æ ‘ä¸­çš„é‡‘å¸</title>
      <link href="/2023/09/22/Leetcode-2603-%E6%94%B6%E9%9B%86%E6%A0%91%E4%B8%AD%E7%9A%84%E9%87%91%E5%B8%81/"/>
      <url>/2023/09/22/Leetcode-2603-%E6%94%B6%E9%9B%86%E6%A0%91%E4%B8%AD%E7%9A%84%E9%87%91%E5%B8%81/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>ç»™å®šä¸€æ£µ$n$ä¸ªç‚¹çš„æ— å‘æ— æ ¹æ ‘ï¼Œæ¯ä¸ªç‚¹æœ‰æˆ–æ²¡æœ‰é‡‘å¸ã€‚</p><p>ç°åœ¨è®©ä½ ä»æŸä¸ªèŠ‚ç‚¹å‡ºå‘ï¼Œæ¯æ¬¡å¯ä»¥æ”¶é›†è·ç¦»å½“å‰ç‚¹2ä»¥å†…çš„æ‰€æœ‰é‡‘å¸ï¼Œæˆ–è€…ç§»åŠ¨åˆ°ä¸€ä¸ªç›¸é‚»èŠ‚ç‚¹ã€‚</p><p>é—®ä½ æ”¶é›†æ‰€æœ‰é‡‘å¸å¹¶è¿”å›åˆ°å‡ºå‘ç‚¹æœ€å°‘çš„æ­¥æ•°ã€‚</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>é¦–å…ˆè€ƒè™‘å›ºå®šå‡ºå‘ç‚¹çš„æƒ…å†µï¼Œç­”æ¡ˆæ˜¯ä»€ä¹ˆã€‚æ˜¾ç„¶å°±æ˜¯å»æ‰æ‰€æœ‰å¶å­èŠ‚ç‚¹è·ç¦»å°äºç­‰äº2çš„è¾¹åå‰©ä½™è¾¹çš„ä¸ªæ•°ä¹˜ä»¥2ã€‚</p><p>æ¢æ ¹DPæ˜æ˜¾å¯ä»¥è§£å†³ã€‚</p><p>ç„¶åæˆ‘å†™äº†1ä¸ªå°æ—¶ï¼Œè°ƒäº†30åˆ†é’Ÿï¼ˆå®åœ¨æƒ³ä¸åˆ°é—®é¢˜åœ¨å“ªï¼Œæ‰‹ç”»äº†ä¸€ä¸‹åå‡ ä¸ªç‚¹çš„é”™è¯¯æ•°æ®æ‰æ„è¯†åˆ°é—®é¢˜ï¼‰ã€‚</p><p>ä»£ç å†™çš„ä¹Ÿæ˜¯å¼‚å¸¸ä¸‘é™‹ï¼Œæ‡’å¾—åœ¨é€’å½’å‡½æ•°é‡Œä¼ ä¸€å †å‚æ•°ï¼Œæ‰€ä»¥å…¨æ”¹æˆç±»çš„ç§æœ‰å˜é‡äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">collectTheCoins</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; coins, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; edges)</span> </span>&#123;</span><br><span class="line">        n = coins.<span class="built_in">size</span>();</span><br><span class="line">        dp.<span class="built_in">resize</span>(<span class="number">0</span>);</span><br><span class="line">        dp.<span class="built_in">resize</span>(n);</span><br><span class="line">        dp2.<span class="built_in">resize</span>(<span class="number">0</span>);</span><br><span class="line">        dp2.<span class="built_in">resize</span>(n);</span><br><span class="line">        G.<span class="built_in">resize</span>(<span class="number">0</span>);</span><br><span class="line">        G.<span class="built_in">resize</span>(n);</span><br><span class="line">        c = coins;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; e : edges) &#123;</span><br><span class="line">            G[e[<span class="number">0</span>]].<span class="built_in">push_back</span>(e[<span class="number">1</span>]);</span><br><span class="line">            G[e[<span class="number">1</span>]].<span class="built_in">push_back</span>(e[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">dfs2</span>(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">2</span> * n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) ans = <span class="built_in">min</span>(ans, dp[i][<span class="number">3</span>] + dp2[i][<span class="number">3</span>]);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v : G[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(v, u);</span><br><span class="line">            <span class="keyword">if</span> (c[v]) dp[u][<span class="number">0</span>]++;</span><br><span class="line">            dp[u][<span class="number">1</span>] += dp[v][<span class="number">0</span>];</span><br><span class="line">            dp[u][<span class="number">2</span>] += dp[v][<span class="number">1</span>] + dp[v][<span class="number">2</span>];</span><br><span class="line">            <span class="keyword">if</span> (dp[v][<span class="number">1</span>] || dp[v][<span class="number">2</span>]) &#123;</span><br><span class="line">                dp[u][<span class="number">3</span>] += dp[v][<span class="number">3</span>] + <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v : G[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (c[u]) dp2[v][<span class="number">0</span>]++;</span><br><span class="line">            dp2[v][<span class="number">1</span>] += dp2[u][<span class="number">0</span>] + dp[u][<span class="number">0</span>] - c[v];</span><br><span class="line">            dp2[v][<span class="number">2</span>] += dp2[u][<span class="number">1</span>] + dp2[u][<span class="number">2</span>] + dp[u][<span class="number">1</span>] + dp[u][<span class="number">2</span>] - dp[v][<span class="number">0</span>] - dp[v][<span class="number">1</span>] - dp[v][<span class="number">2</span>]; </span><br><span class="line">            <span class="comment">// ä¸€å¼€å§‹é”™å°±æ˜¯å› ä¸ºæ²¡åŠ çˆ¶èŠ‚ç‚¹uçš„å­æ ‘å†…çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚çˆ¶èŠ‚ç‚¹æœ‰ä¸€ä¸ªæœ‰é‡‘å¸çš„å„¿å­ï¼Œå®ƒåªè¢«ç»Ÿè®¡åœ¨dp[u][0]ä¸­ï¼Œ</span></span><br><span class="line">            <span class="comment">// ä½†æ­£æ˜¯ç”±äºè¿™ä¸ªé‡‘å¸ï¼Œçˆ¶èŠ‚ç‚¹çš„å¦ä¸€ä¸ªå„¿å­çš„å„¿å­å°±éœ€è¦å¾€çˆ¶äº²èµ°äº†</span></span><br><span class="line">            <span class="type">bool</span> ok = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (dp2[u][<span class="number">1</span>] || dp2[u][<span class="number">2</span>] || dp2[u][<span class="number">3</span>]) &#123;</span><br><span class="line">                dp2[v][<span class="number">3</span>] += dp2[u][<span class="number">3</span>];</span><br><span class="line">                ok = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (dp[u][<span class="number">1</span>] + dp[u][<span class="number">2</span>] - dp[v][<span class="number">0</span>] - dp[v][<span class="number">1</span>] - dp[v][<span class="number">2</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                dp2[v][<span class="number">3</span>] += dp[u][<span class="number">3</span>];</span><br><span class="line">                <span class="keyword">if</span> (dp[v][<span class="number">1</span>] || dp[v][<span class="number">2</span>]) &#123;</span><br><span class="line">                    dp2[v][<span class="number">3</span>] -= dp[v][<span class="number">3</span>] - <span class="number">2</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ok = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ok) dp2[v][<span class="number">3</span>] += <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v : G[u]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (v == fa) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    vector&lt;array&lt;<span class="type">int</span>, 4&gt;&gt; dp, dp2;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; c;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; G;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ­£è§£"><a class="header-anchor" href="#æ­£è§£">Â¶</a>æ­£è§£</h2><p>æ‹“æ‰‘æ’åºã€‚</p><p>å¯¹äºæ ‘ä¸­çš„å¶å­èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰é‡‘å¸ï¼Œç›´æ¥åˆ é™¤å³å¯ã€‚</p><p>ä¸æ–­åˆ é™¤åï¼Œç°åœ¨çš„æ ‘çš„æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½æœ‰é‡‘å¸ï¼Œæ˜¾ç„¶æˆ‘ä»¬å¯ä»¥ç»§ç»­åˆ æ‰ä¸¤å±‚å¶å­èŠ‚ç‚¹ã€‚</p><p>ç­”æ¡ˆå°±æ˜¯å‰©ä¸‹çš„è¾¹æ•°ä¹˜ä»¥2äº†ã€‚å…¶å®å°±æ˜¯è´ªå¿ƒï¼Œå¹¶ä¸éœ€è¦ç®—å‡ºä»æ¯ä¸ªç‚¹å‡ºå‘çš„ç­”æ¡ˆå…·ä½“æ˜¯ä»€ä¹ˆã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç¨‹</title>
      <link href="/2023/09/21/%E5%8D%8F%E7%A8%8B/"/>
      <url>/2023/09/21/%E5%8D%8F%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>cpp snippets</title>
      <link href="/2023/09/21/cpp-snippets/"/>
      <url>/2023/09/21/cpp-snippets/</url>
      
        <content type="html"><![CDATA[<p><code>std::monostate</code>ç”¨äºæ¨¡æ‹Ÿç©ºå€¼çš„çŠ¶æ€ï¼ˆå°±æ˜¯ä¸€ä¸ªç©ºçš„ç»“æ„ä½“ï¼‰ã€‚</p><p><code>std::variant</code>ä¼šé»˜è®¤è°ƒç”¨ç¬¬ä¸€ä¸ªç±»å‹çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œå¦‚æœç¬¬ä¸€ä¸ªç±»å‹æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œå°±ä¼šç¼–è¯‘é”™è¯¯ã€‚</p><p>åœ¨ä»ä¸€ç§çŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ç§çŠ¶æ€æ—¶å‡ºç°å¼‚å¸¸ä¼šç½•è§çš„å˜ä¸º<code>valueless_by_exception</code>ï¼Œå¹¶ä¸”åœ¨<code>index()</code>æ—¶ä¼šè¿”å›<code>variant_npos</code>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> T &gt;</span></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">const</span> T&amp; <span class="title">clamp</span><span class="params">( <span class="type">const</span> T&amp; v, <span class="type">const</span> T&amp; lo, <span class="type">const</span> T&amp; hi )</span></span>;</span><br><span class="line"><span class="comment">// if v &lt; lo return lo</span></span><br><span class="line"><span class="comment">// else if v &gt; hi return hi</span></span><br><span class="line"><span class="comment">// else return v</span></span><br><span class="line"><span class="comment">// å¦‚æœloå¤§äºhiï¼Œæ˜¯æœªå®šä¹‰è¡Œä¸º</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> T &gt;</span></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> T <span class="title">midpoint</span><span class="params">( T a, T b )</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line"><span class="comment">// åœ¨a+bä¸ºå¥‡æ•°æ—¶ï¼Œå‘aå–æ•´</span></span><br></pre></td></tr></table></figure><p><code>std::piecewise_construct</code>æ˜¯ç©ºç»“æ„ä½“<code>std::piecewise_construct_t</code>çš„ä¸€ä¸ªå®ä¾‹ï¼Œ<br>ç”¨äºå¯¹ä¸€ä¸ª<code>std::pair</code>çš„æ„é€ è¿›è¡Œæ¶ˆæ­§ã€‚</p><p>ä½¿ç”¨<code>std::piecewise_construct</code>ï¼Œä¼šå¯¹<code>pair</code>çš„firstå’Œsecondåˆ†åˆ«è¿›è¡ŒåŸåœ°æ„é€ ï¼›<br>å¦åˆ™ä¼šå…ˆç”Ÿæˆä¸¤ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œå†è¿›è¡Œæ‹·è´æ„é€ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::map&lt;<span class="type">int</span>, big&gt; map;</span><br><span class="line">map.<span class="built_in">emplace</span>(std::piecewise_construct, <span class="comment">/*key*/</span>std::forward_as_tuple(<span class="number">1</span>), <span class="comment">/*value*/</span>std::forward_as_tuple(<span class="number">2</span>,<span class="number">3</span>));</span><br></pre></td></tr></table></figure><p>å®é™…åŸç†å°±æ˜¯<code>pair</code>æœ‰ä¸€ä¸ªç‰¹åŒ–çš„æ„é€ å‡½æ•°ï¼Œ<code>piecewise_construct</code>å°±æ˜¯èµ·åˆ°ä¸€ä¸ªæ ‡ç­¾ä½œç”¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span>... Args1, <span class="keyword">class</span>... Args2 &gt;</span></span><br><span class="line"><span class="function"><span class="title">pair</span><span class="params">( std::<span class="type">piecewise_construct_t</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">      std::tuple&lt;Args1...&gt; first_args,</span></span></span><br><span class="line"><span class="params"><span class="function">      std::tuple&lt;Args2...&gt; second_args )</span></span>;</span><br></pre></td></tr></table></figure><h2 id="vectorçš„ç‰¹åŒ–"><a href="#vectorçš„ç‰¹åŒ–" class="headerlink" title="vectorçš„ç‰¹åŒ–"></a>vectorçš„ç‰¹åŒ–</h2><ul><li><p>SmallVectorï¼šåœ¨sizeå°äºæŸä¸ªé˜ˆå€¼æ—¶ï¼Œä½¿ç”¨å¯¹è±¡å†…ç½®çš„æ ˆä¸Šåˆ†é…çš„bufferå­˜å‚¨ï¼Œè€Œåœ¨å¤§äºé˜ˆå€¼åå†è½¬ä¸ºåŠ¨æ€åˆ†é…ã€‚<br><code>std::string</code>ä¹Ÿæœ‰ç±»ä¼¼çš„ä¼˜åŒ–ï¼Œåœ¨æ¯”è¾ƒçŸ­æ—¶ä½¿ç”¨<code>char [N]</code>æ¥å­˜å‚¨ã€‚</p></li><li><p>FixedCapacityVectorï¼šç±»ä¼¼äºarrayï¼Œä½†æ˜¯åˆå§‹å®¹é‡ä¸º0ï¼Œåœ¨å¢åŠ å’Œåˆ é™¤å…ƒç´ æ—¶è¿›è¡Œæ„é€ å’Œææ„ï¼Œ<br>arrayåˆ™åœ¨å®ä¾‹åŒ–æ—¶å°±è¦å¯¹æ‰€æœ‰å…ƒç´ è¿›è¡Œåˆå§‹åŒ–ã€‚åœ¨å¢åŠ å…ƒç´ è¶…è¿‡å›ºå®šçš„å®¹é‡æ—¶æŠ¥é”™ã€‚</p></li><li><p>PODVector: vectoråœ¨æ‰©å®¹æ—¶ä¼šå¯¹å…ƒç´ è¿›è¡Œé»˜è®¤åˆå§‹åŒ–ï¼Œ<br>ä½†æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›çœç•¥è¿™ä¸ªæ­¥éª¤ï¼Œæ¯”å¦‚æˆ‘ä»¬åªæ˜¯æƒ³resizeä¸€ä¸ªè¶³å¤Ÿå¤§çš„bufferç”¨æ¥readã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥åŒ…è£…ä¸€ä¸ªæ„é€ å‡½æ•°ä¸ºç©ºçš„ç±»ã€‚ï¼ˆå¦è§<a href="https://stackoverflow.com/a/61346609">https://stackoverflow.com/a/61346609</a>å’Œ<a href="https://www.bilibili.com/video/BV1gu411m7kN">https://www.bilibili.com/video/BV1gu411m7kN</a>çš„1:24:00å¤„ï¼‰</p></li></ul><h2 id="std-weak-ptr"><a href="#std-weak-ptr" class="headerlink" title="std::weak_ptr"></a>std::weak_ptr</h2><p>æŒ‡å‘ä¸€ä¸ªç”±shared_ptrç®¡ç†çš„å¯¹è±¡ï¼Œä½†ä¸å®é™…æ‹¥æœ‰å®ƒï¼Œä¹Ÿå°±ä¸ä¼šå½±å“å¼•ç”¨è®¡æ•°ã€‚</p><p><code>expired()</code>æ£€æŸ¥å¯¹åº”çš„å¯¹è±¡æ˜¯å¦å·²è¢«æ¶ˆé™¤ã€‚</p><p><code>lock()</code>åˆ›å»ºä¸€ä¸ªå®é™…æ‹¥æœ‰å¯¹åº”å¯¹è±¡çš„shared_ptrã€‚</p><p>ç”¨äºè§£å†³å¾ªç¯å¼•ç”¨ï¼ˆå¼•ç”¨è®¡æ•°æ°¸è¿œä¸ä¸º0å¯¼è‡´å†…å­˜æ³„éœ²ï¼‰ï¼Œæ‚¬æŒ‚ç©ºæŒ‡é’ˆï¼ˆå¯ä»¥åˆ©ç”¨<code>expired</code>åˆ¤æ–­å¯¹è±¡æ˜¯å¦è¿˜å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå†ç”¨<code>lock</code>æ¥æ“ä½œè¯¥å¯¹è±¡ï¼‰ã€‚</p><h2 id="std-enable-shared-from-this"><a href="#std-enable-shared-from-this" class="headerlink" title="std::enable_shared_from_this"></a>std::enable_shared_from_this</h2><p>ç”¨äºåœ¨ç±»å†…æ‹¿åˆ°thisçš„shared_ptrå¯¹è±¡ï¼ˆæœ‰ä¸€ä¸ªç”¨å¤„æ—¶ç”¨åœ¨å›è°ƒå‡½æ•°ä¸­ä»¥ä½¿å¯¹è±¡ä¿æ´»ï¼‰ã€‚</p><p>å¯¹äºæŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªshared_ptrï¼Œ<br>åªèƒ½æœ‰ä¸€ä¸ªæ˜¯é€šè¿‡æŒæœ‰å¯¹è±¡çš„æŒ‡é’ˆæ„é€ çš„ï¼Œå…¶ä½™çš„éƒ½æ˜¯é€šè¿‡è¿™ä¸ªshared_ptræ„é€ çš„ã€‚</p><p>è€Œå¦‚æœåœ¨ç±»å†…ä½¿ç”¨<code>auto local = std::make_shared(this);</code>ï¼Œ<br>å°±åˆäº§ç”Ÿäº†ä¸€ä¸ªç‹¬ç«‹çš„shared_ptrã€‚</p><p>æ­£ç¡®çš„åšæ³•æ˜¯<code>: public std::enable_shared_from_this&lt;T&gt;</code>ï¼Œç„¶ååœ¨ç±»å†…ä½¿ç”¨<code>shared_from_this()</code>ã€‚</p><p>åŸç†ï¼šåˆ©ç”¨äº†CRTPå’Œ<code>weak_ptr</code>ã€‚åœ¨shared_ptrçš„ä¼ å…¥æŒ‡é’ˆï¼ˆ<code>T* ptr</code>ï¼‰çš„æ„é€ å‡½æ•°ä¸­ï¼Œ<br>ä¼šåˆ¤æ–­Tæ˜¯ä¸æ˜¯ç»§æ‰¿è‡ª<code>enable_shared_from_this&lt;T&gt;</code>ï¼Œ<br>å¦‚æœæ˜¯å°±å°†<code>enable_shared_from_this&lt;T&gt;</code>ä¸­çš„weak_ptræˆå‘˜æŒ‡å‘è‡ªèº«ã€‚<br>è¿™æ ·æ¯æ¬¡<code>shared_from_this()</code>åªéœ€è¦è°ƒç”¨è¯¥weak_ptræˆå‘˜çš„<code>lock()</code>æ¥å¾—åˆ°ä¸€ä¸ªå…±äº«çš„<code>shared_ptr</code>äº†ã€‚</p><p>åœ¨è°ƒç”¨shared_from_this()ä¹‹å‰ï¼Œå¿…é¡»å¾—æœ‰ä¸€ä¸ªshared_pträº†ï¼Œå¦åˆ™weak_ptrè¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚<br>å› æ­¤æœ€å¥½çš„æ–¹æ³•æ˜¯å»æ‰è¯¥ç±»çš„æ„é€ å‡½æ•°ï¼Œåªæš´éœ²ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼ˆcreateï¼‰ï¼Œè¿”å›ä¸€ä¸ªç‹¬ç«‹çš„shared_ptrã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">std::numeric_limits&lt;T&gt;::<span class="built_in">min</span>();</span><br><span class="line">std::numeric_limits&lt;T&gt;::<span class="built_in">lowest</span>();</span><br><span class="line"><span class="comment">// å¯¹äºæµ®ç‚¹æ•°ï¼Œminè¿”å›çš„æ˜¯ä»¥æ ‡å‡†å½¢å¼è¡¨ç¤ºçš„æœ€å°æ­£æµ®ç‚¹æ•°ï¼Œæœ€å°è¡¨ç¤ºå€¼åº”ä½¿ç”¨lowest</span></span><br><span class="line">std::numeric_limits&lt;T&gt;::<span class="built_in">infinity</span>();</span><br></pre></td></tr></table></figure><h2 id="deque"><a href="#deque" class="headerlink" title="deque"></a>deque</h2><p><code>std::deque</code>çš„å®ç°æ˜¯ä¸€ä¸ªå—çŠ¶æ•°ç»„ï¼Œæ¯ä¸ªå—æœ‰å›ºå®šçš„å¤§å°<code>block_size</code>ï¼ˆ8æˆ–16ï¼‰ï¼Œæ¯æ¬¡éšæœºè®¿é—®éœ€è¦<br>å…ˆç®—å‡ºå—(<code>index / block_size</code>)ï¼Œå†æ‰¾åˆ°å—å†…åç§»ï¼ˆ<code>index % block_size</code>ï¼‰ã€‚<br>æ˜¾ç„¶ä¸åŒå—çš„å­˜å‚¨å¯èƒ½ä¸è¿ç»­ã€‚<br>è¿™æ ·çš„å¥½å¤„æ˜¯åœ¨ä¸æ–­<code>push_back</code>æ‰©å®¹æ—¶ä¸éœ€è¦ç§»åŠ¨æ•°æ®ï¼Œå› æ­¤å¯ä»¥æ›´å¿«ï¼Œä¸”è¿­ä»£å™¨ä¸ä¼šå¤±æ•ˆã€‚</p><p><strong>ä»…ä¾›å‚è€ƒ</strong>ï¼šç›¸æ¯”<code>std::vector</code>ï¼Œè¿­ä»£å™¨åœ¨æ‰©å®¹æ—¶ä¸ä¼šå¤±æ•ˆï¼›ç›¸æ¯”<code>std::list</code>ï¼Œç¼“å­˜æ›´å‹å¥½ï¼›ç›¸æ¯”<code>std::array</code>ï¼Œ<br>å¯ä»¥åŠ¨æ€æ‰©å®¹ã€‚å› æ­¤å¯ä»¥ä½œä¸ºå…¨å±€çš„å†…å­˜æ± ä½¿ç”¨ï¼ˆè§<a href="https://codeforces.com/blog/entry/60321">https://codeforces.com/blog/entry/60321</a>ï¼‰ã€‚</p><p><code>stack</code>å’Œ<code>queue</code>çš„åº•å±‚é»˜è®¤æ˜¯<code>deque</code>ï¼ˆåªæ˜¯ç¦ç”¨äº†æŸäº›æ¥å£ï¼‰ã€‚</p><p><code>template&lt;class T, class Container = std::deque&lt;T&gt;&gt; class stack</code></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">stack&lt;elem*&gt; recycleBin;</span><br><span class="line">deque&lt;elem&gt; elemCache;</span><br><span class="line"></span><br><span class="line"><span class="function">elem *<span class="title">fetchElement</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!recycleBin.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">    elem *temp = recycleBin.<span class="built_in">top</span>();</span><br><span class="line">    recycleBin.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">  &#125;</span><br><span class="line">  elemCache.<span class="built_in">push_back</span>(<span class="built_in">elem</span>());</span><br><span class="line">  <span class="keyword">return</span> &amp;elemCache.<span class="built_in">back</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">deleteElement</span><span class="params">(elem *e)</span> </span>&#123;</span><br><span class="line">  recycleBin.<span class="built_in">push</span>(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/Shmoopty/veque"><code>veque</code></a>çš„å®ç°æ–¹å¼å°±æ˜¯åœ¨å‰é¢ä¹Ÿæœ‰ä¸€æ®µé¢„ç•™çš„bufferï¼Œå³åº•å±‚çš„bufferåˆ†æˆ[front][data][back]ä¸‰éƒ¨åˆ†ã€‚<br>ç±»ä¼¼åœ°ï¼Œåœ¨<code>push_front</code>æ—¶ï¼Œå¦‚æœæ²¡æœ‰ç©ºé—´ï¼Œå°±å¯¹[front]è¿›è¡Œæ‰©å®¹ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©shift_backï¼Œéœ€è¦å¯¹frontå’Œbackçš„bufferè¿›è¡Œå¹³è¡¡ã€‚<br>frontå’Œdataçš„è¾¹ç•Œç”¨ä¸€ä¸ªé¢å¤–çš„å˜é‡<code>offset</code>æŒ‡ç¤ºï¼Œdataå’Œbackçš„è¾¹ç•Œæ˜¯<code>size</code></p><h2 id="ring-buffer"><a href="#ring-buffer" class="headerlink" title="ring_buffer"></a>ring_buffer</h2><p>ç¯å½¢ç¼“å†²åŒºï¼Œæˆ–ç¯å½¢é˜Ÿåˆ—ã€‚å®¹é‡æ˜¯å›ºå®šçš„ã€‚</p><p>æ¯æ¬¡è¯»å–æ•°æ®è¿”å›çš„æ˜¯<strong>å½“å‰</strong>æœ€è€çš„æ•°æ®ã€‚</p><p>éœ€è¦ä¸€ä¸ªå¤´æŒ‡é’ˆï¼ˆå†™ç´¢å¼•ï¼‰ã€å°¾æŒ‡é’ˆï¼ˆè¯»ç´¢å¼•ï¼‰ã€‚<br>ç”±äºå¯èƒ½å‡ºç°ç¼“å†²åŒºæ»¡å‘ç”Ÿè¦†ç›–çš„æƒ…å†µï¼Œ<br>åˆ¤æ–­å½“å‰æ˜¯ç©ºè¿˜æ˜¯æ»¡æ˜¯é‡ç‚¹ã€‚</p><ol><li>å¯ä»¥ç”¨ä¸€ä¸ª<code>size</code>å˜é‡è®°å½•å½“å‰çš„å¤§å°ã€‚</li><li>ç•™ç©ºä¸€ä¸ªä½ç½®ï¼Œè¿™æ ·æ»¡çš„æ—¶å€™å°±æ˜¯<code>max_size - 1</code>ã€‚</li><li>RT-Threadä½¿ç”¨çš„æ˜¯é•œåƒæŒ‡ç¤ºä½ã€‚æ¯ä¸ªç´¢å¼•çš„èŒƒå›´æ˜¯<code>[0, 2 * max_size - 1]</code>ï¼ŒçœŸå®æŒ‡é’ˆéœ€è¦<code>% max_size</code>ã€‚<br>åŒæ—¶ä¸ºäº†æ•ˆç‡ï¼Œè¿˜ç”¨ä¸¤ä¸ªboolå˜é‡æŒ‡ç¤ºç´¢å¼•åœ¨é€»è¾‘åœ°å€ç©ºé—´ï¼ˆ<code>[0, max_size - 1]</code>ï¼‰è¿˜æ˜¯é•œåƒé€»è¾‘åœ°å€ç©ºé—´ï¼ˆ<code>[max_size, 2 * max_size - 1]</code>ï¼‰ã€‚</li><li>Linux2.6å¯¹é•œåƒæŒ‡ç¤ºä½è¿›è¡Œäº†æ‰©å±•ï¼Œç´¢å¼•èŒƒå›´æ˜¯<code>[0, 2^32 - 1]</code>ï¼Œä¹Ÿå°±æ˜¯è®©å…¶è‡ªç„¶æº¢å‡ºã€‚æœ¬è´¨ä¸Šè®©ç´¢å¼•èƒ½å¤§äºç­‰äº<code>max_size</code>ï¼Œå°±å¯ä»¥é€šè¿‡å·®å€¼ç­‰äº<code>max_size</code>æ¥åˆ¤æ–­æ»¡äº†ï¼Œ<br>ä½†è¿™å°±å¼ºåˆ¶è¦æ±‚<code>max_size</code>æ˜¯2çš„å¹‚æ¬¡ã€‚</li></ol><p>è¦æ±‚ring_bufferçš„<code>max_size</code>ä¸º2çš„å¹‚æ¬¡ä¼šæ–¹ä¾¿ä¸€äº›ï¼Œå–æ¨¡å¯ä»¥ç”¨<code>&amp; (max_size - 1)</code>ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RT_Thread</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">rt_ringbuffer</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">rt_uint8_t</span> *buffer_ptr;</span><br><span class="line">  <span class="type">rt_uint16_t</span> read_mirror : <span class="number">1</span>;</span><br><span class="line">  <span class="type">rt_uint16_t</span> read_index : <span class="number">15</span>;</span><br><span class="line">  <span class="type">rt_uint16_t</span> write_mirror : <span class="number">1</span>;</span><br><span class="line">  <span class="type">rt_uint16_t</span> write_index : <span class="number">15</span>;</span><br><span class="line">  <span class="type">rt_int16_t</span> buffer_size;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// Linux2.6</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">kfifo</span> &#123;</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">char</span> *buffer; <span class="comment">/* the buffer holding the data */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> size; <span class="comment">/* the size of the allocated buffer */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> in; <span class="comment">/* data is added at offset (in % size) */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> out; <span class="comment">/* data is extracted from off. (out % size) */</span></span><br><span class="line">  <span class="type">spinlock_t</span> *lock; <span class="comment">/* protects concurrent modifications */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// Linux5.17</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> __<span class="title">kfifo</span> &#123;</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> in;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> out;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> mask; <span class="comment">// max_size - 1</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> esize;</span><br><span class="line">  <span class="type">void</span>  *data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="hyperloglog"><a href="#hyperloglog" class="headerlink" title="hyperloglog"></a>hyperloglog</h2><p><strong>ä¼°è®¡</strong>ä¸€ä¸ªå¾ˆå¤§çš„é›†åˆçš„åŸºæ•°ã€‚</p><p>åŸºæœ¬æ€æƒ³ï¼šå¦‚æœä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°é›†åˆä¸­äºŒè¿›åˆ¶å‰å¯¼é›¶ä¸ªæ•°æœ€å¤§ä¸º$n$ï¼Œåˆ™ä¼°è®¡é›†åˆå¤§å°ä¸º$2^n$ã€‚</p><p>å¯¹æ¯ä¸ªæ•°è¿›è¡Œhashï¼ˆhashå¾—åˆ°çš„å€¼å°±å¯ä»¥è®¤ä¸ºæ„æˆä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°é›†åˆï¼‰ï¼Œé«˜14ä½ä½œä¸ºæ¡¶ç¼–å·ï¼Œä½50ä½åœ¨æ¯ä¸ªæ¡¶å†…ç»Ÿè®¡å‰å¯¼é›¶ä¸ªæ•°çš„æœ€å¤§å€¼ï¼Œ<br>æœ€åå¯¹æ‰€æœ‰æ¡¶æ±‚åŠ æƒå¹³å‡ã€‚</p><h2 id="ordered-map"><a href="#ordered-map" class="headerlink" title="ordered map"></a>ordered map</h2><p>è¿™é‡Œçš„orderæŒ‡çš„æ˜¯ä¿æŒæ’å…¥æ—¶çš„é¡ºåºï¼Œ<br>å¯¹ordered mapè¿›è¡Œè¿­ä»£ä¼šéµå¾ªæ’å…¥çš„é¡ºåºã€‚<br>æ˜¾ç„¶<code>std::map</code>å’Œ<code>std::unordered_map</code>éƒ½ä¸æ»¡è¶³è¦æ±‚ã€‚</p><p>å®ç°æ–¹å¼ï¼š</p><ol><li>listå­˜è¿­ä»£å™¨ï¼Œmapç»´æŠ¤é”®å€¼å¯¹</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::unordered_map&lt;K, V&gt; map;</span><br><span class="line">std::list&lt;<span class="keyword">decltype</span>(map.begin())&gt; order;</span><br></pre></td></tr></table></figure><ol><li>ä¸€ä¸ªdeque/vector <code>values</code>ç»´æŠ¤valueåºåˆ—ï¼Œ<br>å¦ä¸€ä¸ªvector <code>buckets</code>ç»´æŠ¤æ¡¶åºåˆ—ï¼Œæ¯ä¸ªæ¡¶åŒ…å«ä¸€ä¸ªkeyçš„hashå€¼ä»¥åŠå…¶valueåœ¨<code>values</code>ä¸­çš„ä¸‹æ ‡ï¼ˆä¹Ÿå°±æ˜¯ä¸€ä¸ªmapï¼‰ã€‚</li></ol><p><a href="https://github.com/Tessil/ordered-map">tsl::ordered_map</a></p><p>æœ‰æ›´å¿«çš„æ’å…¥å’Œéå†é€Ÿåº¦ï¼Œä½†æ˜¯ä¿æŒæœ‰åºçš„åˆ é™¤æ˜¯$O(N)$çš„ã€‚</p><ol><li>python3.6åçš„å­—å…¸å°±æ˜¯æœ‰åºçš„ã€‚<br>vector<pair<K,V>&gt; <code>entries</code>å­˜é”®å€¼å¯¹ï¼Œ<br>å¦ä¸€ä¸ªvector <code>indices</code>å­˜ä¸‹æ ‡ã€‚<br>æ¯æ¬¡æŸ¥æ‰¾ï¼Œå¯¹é”®å“ˆå¸Œæ‰¾åˆ°åœ¨<code>indices</code>ä¸­çš„ä½ç½®ï¼Œç„¶åå¾—åˆ°åœ¨<code>entries</code>ä¸­çš„ä½ç½®ã€‚</li></ol><p>æ˜¾ç„¶åˆ é™¤ä¹Ÿæ˜¯$O(N)$çš„ï¼Œä½†å®é™…ç”¨äº†æ‡’æƒ°æ ‡è®°ï¼Œåœ¨åˆ é™¤ä¸ªæ•°è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶ï¼Œå†ç»Ÿä¸€è¿›è¡Œä¸€æ¬¡åˆ é™¤ã€‚</p><h2 id="placement-new"><a href="#placement-new" class="headerlink" title="placement new"></a>placement new</h2><p><code>A* a = new(buf) A</code>ï¼Œè‡ªå·±æŒ‡å®šä½ç½®ï¼ˆç»™å®š<code>buf</code>ï¼Œæ—¢å¯ä»¥æ˜¯å·²åˆ†é…çš„å †ä¸Šç©ºé—´ï¼Œä¹Ÿå¯ä»¥æ˜¯æ ˆä¸Šçš„ï¼‰ï¼Œ<br>ç„¶åè°ƒç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°è¿›è¡Œæ„é€ ã€‚</p><p>ä½†æ³¨æ„ç”¨å®Œå¯¹è±¡åéœ€è¦æ˜¾ç¤ºè°ƒç”¨ææ„å‡½æ•°<code>a.~A()</code>ã€‚</p><p>ç±»ä¼¼äºå†…å­˜æ± ï¼Œå¯¹å†…å­˜å¤ç”¨ã€‚</p><p>è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°æœ‰å‚æ•°çš„ç±»æ•°ç»„ï¼Œå¯ä»¥å…ˆç”³è¯·ç©ºé—´ï¼Œ<br>ç„¶åå¯¹æ¯ä¸€é¡¹åˆ©ç”¨placement newæ„é€ å¯¹åº”çš„å¯¹è±¡ï¼ˆè¿™å…¶å®å°±æ˜¯<code>vector</code>çš„åšæ³•ï¼‰ã€‚</p><h2 id="algorithm"><a href="#algorithm" class="headerlink" title="algorithm"></a>algorithm</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">std::<span class="built_in">iota</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), <span class="number">0</span>) <span class="comment">// range(0, n)</span></span><br><span class="line">std::<span class="built_in">fill</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), value)</span><br><span class="line">std::<span class="built_in">adjacent_difference</span>(in.<span class="built_in">begin</span>(), in.<span class="built_in">end</span>(), out.<span class="built_in">begin</span>()); <span class="comment">// å·®åˆ†ï¼Œoutå¯ä»¥ç­‰äºin</span></span><br><span class="line">std::<span class="built_in">partial_sum</span>(in.<span class="built_in">begin</span>(), in.<span class="built_in">end</span>(), out.<span class="built_in">begin</span>()) <span class="comment">// å‰ç¼€å’Œ</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">std::lexigraphical_compare</span><span class="params">(a.begin(), a.end(), b.begin(), b.end())</span> <span class="comment">// O(n)</span></span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">std::is_sorted</span><span class="params">(a.begin(), a.end())</span></span></span><br><span class="line"><span class="function">iterator std::min/<span class="title">max_element</span><span class="params">(a.begin(), a.end())</span></span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">std::binary_search</span><span class="params">(a.begin(), a.end(), target)</span> <span class="comment">// O(log n) </span></span></span><br><span class="line"><span class="function">T <span class="title">std::accumulate</span><span class="params">(a.begin(), a.end(), <span class="number">0LL</span>)</span></span>; <span class="comment">// æ±‚åŒºé—´å’Œï¼Œæ³¨æ„è¿”å›ç±»å‹å’Œæœ€åä¸€ä¸ªå‚æ•°çš„ç±»å‹ç›¸åŒ</span></span><br><span class="line"><span class="type">bool</span> std::any/all/<span class="built_in">none_of</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), func);</span><br><span class="line">std::for_each(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), func); <span class="comment">// å¾ˆå¤šæ—¶å€™å¯èƒ½ä¸å¦‚range-based for</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">std::count</span><span class="params">(a.begin(), a.end(), value)</span></span>;</span><br><span class="line">std::<span class="built_in">nth_element</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">begin</span>() + k, a.<span class="built_in">end</span>()); <span class="comment">// ç¬¬k + 1å¤§å°†ä½äºa[k]ï¼Œä¸”å‰é¢çš„éƒ½ä¸å°äºåé¢çš„ O(n)</span></span><br><span class="line">std::<span class="built_in">merge</span>(in1.<span class="built_in">begin</span>(), in1.<span class="built_in">end</span>(), in2.<span class="built_in">begin</span>(), in2.<span class="built_in">end</span>(), out.<span class="built_in">begin</span>()) <span class="comment">// å½’å¹¶æ’åºï¼Œ outå’Œinä¸èƒ½æœ‰é‡å </span></span><br><span class="line">std::<span class="built_in">rotate</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">begin</span>() + k, a.<span class="built_in">end</span>()) <span class="comment">// a[k]æˆä¸ºç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">std::is_permutation</span><span class="params">(a.begin(), a.end(), b.begin())</span> <span class="comment">// aæ˜¯å¦æ˜¯bçš„ä¸€ä¸ªæ’åˆ— O(n^2) æ’åºæ¯”è¾ƒå³å¯</span></span></span><br></pre></td></tr></table></figure><p><code>std::end(container)[-1]</code>åƒpythonä¸€æ ·å¾—åˆ°æœ€åä¸€ä¸ªå…ƒç´ </p><p><code>ssize(v)</code>è¿”å›æœ‰ç¬¦å·ç±»å‹çš„å¤§å°</p><h2 id="std-byte"><a href="#std-byte" class="headerlink" title="std::byte"></a>std::byte</h2><p><code>enum class byte : unsigned char &#123;&#125;;</code></p><p>char/signed char/unsigned charè¢«ç”¨äºè¡¨ç¤ºå­—èŠ‚ã€å­—ç¬¦ä»¥åŠæ‰§è¡Œè®¡ç®—ã€‚å¼•å…¥<code>std::byte</code>ï¼Œä¸“é—¨è®©å…¶ç”¨äºè¡¨ç¤ºä¸€ä¸ªå­—èŠ‚çš„å†…å®¹ï¼Œ<br>åªèƒ½è¿›è¡Œä½è¿ç®—å’Œæ¯”è¾ƒè¿ç®—ï¼Œä»¥æé«˜ç¨‹åºçš„å®‰å…¨æ€§å’Œå¯è¯»æ€§ã€‚</p><p>æ³¨æ„ï¼šä¸€ä¸ªå­—èŠ‚é€šå¸¸æ˜¯8ä¸ªæ¯”ç‰¹ï¼Œä½†ä¹Ÿå¯èƒ½æ›´å¤šï¼ˆå¦‚16æ¯”ç‰¹ï¼‰ï¼Œç¡®åˆ‡æ•°å€¼å®šä¹‰åœ¨<code>CHAR_BIT</code>ä¸­ã€‚</p><h2 id="std-call-once"><a href="#std-call-once" class="headerlink" title="std::call_once"></a>std::call_once</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> Callable, <span class="keyword">class</span>... Args &gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">call_once</span><span class="params">( std::once_flag&amp; flag, Callable&amp;&amp; f, Args&amp;&amp;... args )</span></span>;`</span><br></pre></td></tr></table></figure><p>ç¡®ä¿ä¸€ä¸ªå‡½æ•°åªä¼šè¢«æ­£å¸¸è°ƒç”¨ä¸€æ¬¡ï¼ˆå¦‚æœè°ƒç”¨æ—¶å‘ç”Ÿäº†å¼‚å¸¸ï¼Œåˆ™ä¸ç®—æ­£å¸¸è°ƒç”¨ï¼‰ã€‚ç”¨äºå…¨å±€å˜é‡çš„æŒ‰éœ€åˆå§‹åŒ–ä¸€çº§å•ä¾‹æ¨¡å¼ã€‚</p><p><code>std::once_flag</code>æ˜¯ä¸“é—¨ç”¨äº<code>std::call_once</code>çš„ä¸€ä¸ªç»“æ„ä½“æ ‡è®°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Singleton&amp; <span class="title">Singleton::get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> std::once_flag flag;</span><br><span class="line">    std::<span class="built_in">call_once</span>(flag, [&amp;]()&#123; instance.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">SingletonDataBase</span>()); &#125;);</span><br><span class="line">    <span class="keyword">return</span> instance.<span class="built_in">get_interface</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="std-using"><a href="#std-using" class="headerlink" title="std::using"></a>std::using</h2><p><code>typedef</code>å¯ä»¥é€šè¿‡å£°æ˜+å³å·¦æ³•åˆ™æ¥ç†è§£ï¼Œç±»å‹åˆ«åä½äºå£°æ˜è¯­å¥ä¸­å˜é‡åå’Œå‡½æ•°åæ‰€åœ¨çš„ä½ç½®ã€‚<br>åœ¨Cè¯­è¨€ä¸­ä¸<code>static</code>ã€<code>register</code>ç­‰åŒå±äºstorage class specifiersï¼Œå³å­˜å‚¨ç±»å‹è¯´æ˜ç¬¦ã€‚</p><p><code>std::using</code>ä¸­ç±»å‹åˆ«åæ°¸è¿œä½äºç­‰å·å·¦ä¾§ï¼Œè€Œ<code>typedef</code>åˆ™ä¼šæ··æ‚åœ¨é‡Œé¢ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">int</span><span class="params">(*func_ptr)</span><span class="params">(<span class="type">int</span>, <span class="type">double</span>)</span></span>;</span><br><span class="line"><span class="keyword">using</span> func_ptr1 = <span class="built_in">int</span>(*)(<span class="type">int</span>, <span class="type">double</span>);</span><br></pre></td></tr></table></figure><p>åœ¨å³å·¦æ³•åˆ™ä¸­ï¼Œæˆ‘ä»¬ä¼šä»æœªå®šä¹‰çš„å˜é‡åå¼€å§‹ä»å³å‘å·¦èºæ—‹è§£é‡Šç±»å‹ï¼Œä½†æ˜¯åœ¨C++ä¸­ï¼Œæœ‰äº›ç±»å‹ï¼ˆæ¨¡æ¿ã€åˆ«åï¼‰æ˜¯ä¸åŒ…å«åç§°çš„ï¼Œ<br>è¿™è¢«ç§°ä½œ<code>type-id</code>ï¼Œè¿™æ—¶åº”è¯¥ä»æœ€å·¦ä¾§çš„æœ€å†…å±‚æ‹¬å·å¼€å§‹ï¼ˆå½“ç„¶Cè¯­è¨€å…¶å®ä¹Ÿæ˜¯è¿™æ ·ï¼Œ<br>åªæ˜¯æœ‰äº›äººä¼šä»æœªå®šä¹‰å˜é‡å¼€å§‹ï¼Œä½†åœ¨è¿™é‡Œå°±ä¸é€‚ç”¨äº†ï¼‰ã€‚</p><p><code>std::using</code>è¿˜å¯ä»¥ç”¨äºæ¨¡æ¿åˆ«åã€‚</p><h2 id="ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆ"><a href="#ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆ" class="headerlink" title="ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆ"></a>ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆ</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">void</span> (A::*fp)(<span class="type">int</span>) = &amp;(A::f);</span><br><span class="line"><span class="built_in">void</span> (*gp)(<span class="type">int</span>) = A::g;</span><br><span class="line">A a;</span><br><span class="line">a.*<span class="built_in">fp</span>(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">gp</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>é™æ€æˆå‘˜å‡½æ•°å’Œæ™®é€šçš„å‡½æ•°ä¸€æ ·ã€‚è€Œéé™æ€æˆå‘˜å‡½æ•°åœ¨å£°æ˜æ—¶éœ€è¦é™„åŠ ç±»åç§°ï¼ˆ<code>A::</code>ï¼‰ï¼Œ<br>å¹¶ä¸”åœ¨è°ƒç”¨æ—¶ä¼ å…¥å¯¹è±¡ï¼ˆ<code>a.</code>ï¼‰ï¼Œè€Œä¸”<code>&amp;</code>å’Œ<code>*</code>ä¸èƒ½çœç•¥ã€‚</p><p>è™šå‡½æ•°çš„æŒ‡é’ˆå€¼æ˜¯ä¸€ä¸ªåç§»é‡ï¼Œè€Œä¸æ˜¯å®é™…åœ°å€ã€‚</p><h2 id="å‡½æ•°çº§try-catch"><a href="#å‡½æ•°çº§try-catch" class="headerlink" title="å‡½æ•°çº§try catch"></a>å‡½æ•°çº§try catch</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">D</span> &#123;</span><br><span class="line">    <span class="built_in">D</span>(<span class="type">int</span> x) <span class="keyword">try</span> : <span class="built_in">x_</span>(x) &#123;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="built_in">catch</span>(...) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> n = <span class="number">2</span>)</span> <span class="keyword">try</span> </span>&#123;</span><br><span class="line">    ++n; <span class="comment">// increments the function parameter</span></span><br><span class="line">    <span class="keyword">throw</span> n;</span><br><span class="line">&#125; <span class="built_in">catch</span>(...)</span><br><span class="line">&#123;</span><br><span class="line">    ++n; <span class="comment">// n is in scope and still refers to the function parameter</span></span><br><span class="line">    <span class="built_in">assert</span>(n == <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªtryå—åŒ…è£¹äº†å‡½æ•°ä½“ï¼ˆå¯¹äºæ„é€ å‡½æ•°ï¼Œè¿˜å¯ä»¥åŒ…è£¹æˆå‘˜åˆå§‹åŒ–ï¼‰ï¼Œä½†ä¸åŒ…æ‹¬å‡½æ•°å‚æ•°çš„èµ‹å€¼ã€‚</p><p>ç‰¹åˆ«åœ°ï¼Œå¯¹äºæ„é€ å‡½æ•°ä¸Šçš„try catchï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œè™½ç„¶ä¼šæ‰§è¡Œcatchå—ï¼Œä½†ç”±äºå¯¹è±¡æ„é€ å¤±è´¥ï¼Œå”¯ä¸€èƒ½åšçš„å°±æ˜¯<strong>é‡æ–°æŠ›å‡ºä¸€æ¬¡å¼‚å¸¸</strong>ã€‚<br>å› æ­¤æ„é€ å‡½æ•°ä¸Šçš„try catchçš„ä½œç”¨ä»…ä»…æ˜¯æ¸…ç†æˆ–è€…æŠ›å‡ºå¦ä¸€ä¸ªå¼‚å¸¸ï¼Œå®ƒå¹¶ä¸èƒ½é˜»æ­¢å¼‚å¸¸çš„ä¼ æ’­ã€‚</p><h2 id="ç±»æ¨¡æ¿å‚æ•°æ¨å¯¼"><a href="#ç±»æ¨¡æ¿å‚æ•°æ¨å¯¼" class="headerlink" title="ç±»æ¨¡æ¿å‚æ•°æ¨å¯¼"></a>ç±»æ¨¡æ¿å‚æ•°æ¨å¯¼</h2><p>C++17èµ·æœ‰CTADï¼Œæ­¤æ—¶ä¸å¿…å†™å‡ºæ¨¡æ¿å‚æ•°åˆ—è¡¨ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®ä¸Šä¸‹æ–‡è¿›è¡Œæ¨å¯¼ï¼ˆæœ‰ç‚¹ç±»ä¼¼rustï¼‰ã€‚</p><p>æ‰€ä»¥å¯ä»¥å†™å‡ºä¸‹é¢çš„ç®€åŒ–ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::pair <span class="title">p</span><span class="params">(<span class="number">2</span>, <span class="number">4.5</span>)</span></span>; <span class="comment">// std::pair&lt;int, double&gt;</span></span><br><span class="line"><span class="function">std::vector <span class="title">dp</span><span class="params">(N, std::vector&lt;<span class="type">int</span>&gt;(M))</span></span>; <span class="comment">// å¤šç»´vectorçš„å£°æ˜ä¼šæ–¹ä¾¿å¾ˆå¤š</span></span><br><span class="line">std::<span class="built_in">lock_guard</span>(mutex); <span class="comment">// std::lock_guard(std::mutex) å‡½æ•°ä¹Ÿæ˜¯å¯ä»¥çš„</span></span><br></pre></td></tr></table></figure><h3 id="æ¨å¯¼æŒ‡ç¤º"><a href="#æ¨å¯¼æŒ‡ç¤º" class="headerlink" title="æ¨å¯¼æŒ‡ç¤º"></a>æ¨å¯¼æŒ‡ç¤º</h3><p>ç”¨äºæŒ‡ç¤ºç¼–è¯‘å™¨å¦‚ä½•æ­£ç¡®æ¨å¯¼æ¨¡æ¿å‚æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Pair</span></span><br><span class="line">&#123;</span><br><span class="line">    T first&#123;&#125;;</span><br><span class="line">    U second&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Here&#x27;s a deduction guide for our Pair (needed in C++17)</span></span><br><span class="line"><span class="comment">// Pair objects initialized with arguments of type T and U should deduce to Pair&lt;T, U&gt;</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="built_in">Pair</span>(T, U) -&gt; Pair&lt;T, U&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; p1&#123; <span class="number">1</span>, <span class="number">2</span> &#125;; <span class="comment">// explicitly specify class template Pair&lt;int, int&gt; (C++11 onward)</span></span><br><span class="line">    Pair p2&#123; <span class="number">1</span>, <span class="number">2</span> &#125;;           <span class="comment">// CTAD used to deduce Pair&lt;int, int&gt; from the initializers (C++17)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Y-Combinator"><a href="#Y-Combinator" class="headerlink" title="Y Combinator"></a>Y Combinator</h2><p><a href="https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0200r0.html">https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0200r0.html</a></p><p>C++ä¸æ”¯æŒé€’å½’çš„lambdaï¼Œåªèƒ½é€šè¿‡std::functionè§£å†³ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> gcd = std::<span class="built_in">y_combinator</span>([](<span class="keyword">auto</span> gcd, <span class="type">int</span> a, <span class="type">int</span> b) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> b == <span class="number">0</span> ? a : <span class="built_in">gcd</span>(b, a % b);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸€ç§ç¤ºä¾‹å®ç°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;utility&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> std &#123;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">Fun</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">y_combinator_result</span> &#123;</span><br><span class="line">    Fun fun_;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function">    <span class="keyword">explicit</span> <span class="title">y_combinator_result</span><span class="params">(T &amp;&amp;fun)</span>: fun_(std::forward&lt;T&gt;(fun)) &#123;</span>&#125;</span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ...Args&gt;</span></span><br><span class="line"><span class="function">    <span class="keyword">decltype</span>(<span class="keyword">auto</span>) <span class="title">operator</span><span class="params">()</span><span class="params">(Args &amp;&amp;...args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fun_</span>(std::<span class="built_in">ref</span>(*<span class="keyword">this</span>), std::forward&lt;Args&gt;(args)...);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> Fun&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">decltype</span>(<span class="keyword">auto</span>) <span class="title">y_combinator</span><span class="params">(Fun &amp;&amp;fun)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> y_combinator_result&lt;std::<span class="type">decay_t</span>&lt;Fun&gt;&gt;(std::forward&lt;Fun&gt;(fun));</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">// namespace std</span></span><br></pre></td></tr></table></figure><h2 id="new-int-0"><a href="#new-int-0" class="headerlink" title="new int[0]"></a>new int[0]</h2><p>è¿™è¢«å…è®¸ï¼Œä½†æ˜¯è¿”å›çš„æŒ‡é’ˆæ²¡æœ‰æ„ä¹‰ï¼Œå¯¹å…¶è§£å¼•ç”¨æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œä½†æ˜¯ä½ ä»ç„¶éœ€è¦ä½¿ç”¨<code>delete[]</code><br>ï¼ˆæ²¡æœ‰è§„å®šåº”è¯¥æ€ä¹ˆå®ç°ï¼Œä½†çŒœæµ‹ä¼šåƒéé›¶å€¼æ—¶ä¸€æ ·å†å‰é¢æœ‰ä¸€å—meta dataï¼Œå¹¶ä¸ä¼šç‰¹æ®Šå¤„ç†ï¼‰ã€‚</p><p>è¿™æ˜¯ä¸ºäº†å’Œmallocä¸€è‡´ï¼Œä¸è¿‡<code>malloc(0)</code>ä¼šè¿”å›NULLï¼Œè€Œ<code>new int[0]</code>ä¸ä¸€å®šã€‚</p><p>å’Œ<code>free(NULL)</code>ç±»ä¼¼ï¼Œ<code>delete nullptr</code>ä»€ä¹ˆä¹Ÿä¸ä¼šåšï¼Œæ˜¯åˆæ³•è¡Œä¸ºã€‚</p><h2 id="std-clog"><a href="#std-clog" class="headerlink" title="std::clog"></a>std::clog</h2><p>é™¤äº†å¸¸è§çš„<code>std::cout</code>å’Œ<code>std::cerr</code>å¤–ï¼Œè¿˜æœ‰<code>std::clog</code>ï¼Œå®ƒä¹Ÿè¾“å‡ºåˆ°stderrä¸­ã€‚<br>åŒºåˆ«æ˜¯<code>std::cerr</code>ä¸åƒå…¶å®ƒä¸¤ä¸ªé‚£æ ·ä¼šç¼“å†²ã€‚</p><h2 id="std-string-c-str-vs-data"><a href="#std-string-c-str-vs-data" class="headerlink" title="std::string c_str() vs. data()"></a>std::string c_str() vs. data()</h2><p>åœ¨C++11ä¹‹åï¼Œstd::stringå’ŒCé£æ ¼å­—ç¬¦ä¸²ä¸€æ ·ï¼Œä¼šé¢å¤–å­˜å‚¨ä¸€ä¸ªâ€™\0â€™ä½œä¸ºnull terminateã€‚<br>å› æ­¤ï¼Œc_str()å’Œdata()éƒ½ä¿è¯è¿”å›çš„æ˜¯null terminateçš„å­—ç¬¦æ•°ç»„ï¼Œå®ƒä»¬çš„è¡Œä¸ºä¸€æ ·ã€‚</p><p>åœ¨C++17ä¹‹åï¼Œdata()æœ‰constå’Œéconstçš„é‡è½½ï¼Œè€Œc_str()ä¸€å®šè¿”å›constã€‚</p><h2 id="ä¸‰å‘æ¯”è¾ƒ"><a href="#ä¸‰å‘æ¯”è¾ƒ" class="headerlink" title="ä¸‰å‘æ¯”è¾ƒ"></a>ä¸‰å‘æ¯”è¾ƒ</h2><p>C++20ä¹‹å‰å¯ä»¥é‡è½½<code>&lt;</code>ã€<code>&gt;</code>ã€<code>&lt;=</code>ã€<code>&gt;=</code>ã€<code>==</code>ã€<code>!=</code>è¿™6ç§æ¯”è¾ƒè¿ç®—ç¬¦ã€‚</p><p>ä¸€èˆ¬ä¼šéµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p><ul><li>åŒç±»å‹ç”¨æˆå‘˜å‡½æ•°å®ç°</li><li>ä¸åŒç±»å‹ç”¨éæˆå‘˜å‡½æ•°å®ç°</li><li>ä¼˜å…ˆå®ç°<code>&gt;</code>ã€<code>&lt;</code>ã€<code>==</code></li><li>å…¶ä½™çš„ç”¨ä»¥ä¸Šä¸‰ç§å®ç°</li></ul><h3 id="é»˜è®¤æ¯”è¾ƒ"><a href="#é»˜è®¤æ¯”è¾ƒ" class="headerlink" title="é»˜è®¤æ¯”è¾ƒ"></a>é»˜è®¤æ¯”è¾ƒ</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> <span class="built_in">operator</span>&lt;=&gt;(<span class="type">const</span> Point&amp;) <span class="type">const</span> = <span class="keyword">default</span>;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ä¼šæŒ‰å›ºå®šçš„è§„åˆ™ç”Ÿæˆæ‰€æœ‰çš„6ç§æ¯”è¾ƒè¿ç®—ç¬¦ã€‚</p><h3 id="è‡ªå®šä¹‰æ¯”è¾ƒ"><a href="#è‡ªå®šä¹‰æ¯”è¾ƒ" class="headerlink" title="è‡ªå®šä¹‰æ¯”è¾ƒ"></a>è‡ªå®šä¹‰æ¯”è¾ƒ</h3><p><code>&lt;=&gt;</code>çš„è¿”å›ç±»å‹æœ‰ä¸‰ç§ï¼š</p><ul><li><code>std::strong_ordering</code>ï¼šå¿…é¡»ä¸¥æ ¼æ¯”è¾ƒæ‰€æœ‰æˆå‘˜ï¼Œä½†æ˜¯å¯ä»¥æŒ‰ä¸åŒçš„é¡ºåºã€‚ä¸¥æ ¼çš„æ„æ€æ˜¯è¯´ï¼Œå¦‚æœ<code>a==b</code>ï¼Œåˆ™<code>f(a)==f(b)</code>ï¼Œå…¶ä¸­<code>f</code>æ˜¯ä»»æ„åªè¯»å‡½æ•°</li><li><code>std::weak_ordering</code>ï¼šå¿…é¡»æ¯”è¾ƒæ‰€æœ‰æˆå‘˜ï¼Œä½†æ˜¯å¯ä»¥æŒ‰ä¸åŒçš„é¡ºåºã€‚å¯ä»¥æ˜¯ä¸ä¸¥æ ¼çš„ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²å¯ä»¥æŒ‰ç…§å¤§å°å†™ä¸æ•æ„Ÿçš„æ–¹å¼æ¯”è¾ƒã€‚</li><li><code>std::partial_ordering</code>ï¼šå…è®¸åªæ¯”è¾ƒéƒ¨åˆ†æˆå‘˜ï¼Œå¯ä»¥æŒ‰ä¸åŒçš„é¡ºåºï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸ä¸¥æ ¼çš„ã€‚</li></ul><p>å¦‚æœç±»åŒ…å«å®¹å™¨ç±»å‹ï¼Œåº”è¯¥å†å†™ä¸€ä¸ªé»˜è®¤çš„ç­‰äºè¿ç®—ç¬¦ï¼Œå› ä¸ºä¸‰å‘æ¯”è¾ƒç”Ÿæˆçš„ä¼šæ¯”è¾ƒå®¹å™¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œ<br>è€Œç­‰äºè¿ç®—ç¬¦ç”Ÿæˆçš„ä¼šä¼˜å…ˆæ¯”è¾ƒå®¹å™¨çš„å¤§å°ï¼Œæ€§èƒ½ä¼šæ›´å¥½ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> Point&amp;) <span class="type">const</span> = <span class="keyword">default</span>;</span><br></pre></td></tr></table></figure><h2 id="format"><a href="#format" class="headerlink" title="format"></a>format</h2><p>ç”¨æ³•ç±»ä¼¼Python3çš„fstringï¼š<code>std::format(&quot;Hello &#123;&#125;&quot;, world_str)</code>ã€‚</p><p><code>std::format</code>ç›¸æ¯”äº<code>sprintf</code>å’Œ<code>std::stringstream</code>çš„ä¼˜åŠ¿æ˜¯é€Ÿåº¦æ›´å¿«ï¼Œæ›´å®‰å…¨ï¼ˆä¸éœ€è¦å†™å…·ä½“çš„æ ¼å¼æ§åˆ¶ç¬¦ï¼Œç”¨å¤§æ‹¬å·å³å¯ï¼‰ï¼Œ<br>åœ¨æµ®ç‚¹æ•°ç²¾åº¦æ–¹é¢ä¹Ÿæ›´ä¼˜ã€‚</p><p>ä¸è¿‡è‡ªå®šä¹‰ç±»å‹è¦æƒ³ä½¿ç”¨<code>std::format</code>è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œéœ€è¦å†™ä¸€ä¸ªç‰¹åŒ–çš„<code>std::formatter&lt;T&gt;</code>ï¼Œå®ç°å…¶ä¸­çš„<code>parse</code>å‡½æ•°å’Œ<code>format</code>å‡½æ•°ã€‚</p><p>æ­¤å¤–ï¼Œ<code>std::format_to</code>å°†ç»“æœå†™å…¥åˆ°ä¸€ä¸ªè¿­ä»£å™¨ä¸­ï¼Œç”¨äºè¿½åŠ å†™ï¼Œ<br><code>std::format_to_n</code>é™åˆ¶æœ€å¤šå†™å…¥nä¸ªå­—ç¬¦ï¼Œ<br><code>std::formatted_size</code>åˆ™è¿”å›æ„æˆçš„å­—ç¬¦ä¸²çš„å¤§å°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span>... Args &gt;</span></span><br><span class="line"><span class="function">std::string <span class="title">format</span><span class="params">( std::format_string&lt;Args...&gt; fmt, Args&amp;&amp;... args )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> OutputIt, <span class="keyword">class</span>... Args &gt;</span></span><br><span class="line"><span class="function">OutputIt <span class="title">format_to</span><span class="params">( OutputIt out, std::format_string&lt;Args...&gt; fmt, Args&amp;&amp;... args )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span> OutputIt, <span class="keyword">class</span>... Args &gt;</span></span><br><span class="line"><span class="function">std::format_to_n_result&lt;OutputIt&gt;</span></span><br><span class="line"><span class="function">    <span class="title">format_to_n</span><span class="params">( OutputIt out, std::<span class="type">iter_difference_t</span>&lt;OutputIt&gt; n,</span></span></span><br><span class="line"><span class="params"><span class="function">                 std::format_string&lt;Args...&gt; fmt, Args&amp;&amp;... args )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt; <span class="keyword">class</span>... Args &gt;</span></span><br><span class="line"><span class="function">std::<span class="type">size_t</span> <span class="title">formatted_size</span><span class="params">( std::format_string&lt;Args...&gt; fmt, Args&amp;&amp;... args )</span></span>;</span><br></pre></td></tr></table></figure><h2 id="optional"><a href="#optional" class="headerlink" title="optional"></a>optional</h2><ul><li><code>std::make_optional()</code></li><li><code>*</code>, <code>has_value()</code></li><li><code>-&gt;</code>, <code>value()</code></li><li><code>value_or(default_value)</code>ï¼šä¸ºç©ºå°±è¿”å›ä¼ å…¥çš„default_value</li><li><code>reset()</code>ï¼šå¦‚æœæœ‰valueï¼Œå°±é”€æ¯åŒ…å«çš„valueï¼ˆè¿™å’Œ<code>=&#123;&#125;</code>,<code>=std::nullopt</code>æ²¡ä»€ä¹ˆåŒºåˆ«ï¼‰</li><li><code>emplace()</code>ï¼šoptionalä¹Ÿæœ‰emplaceå‡½æ•°ï¼Œåœ¨åŸåœ°æ„é€ </li></ul><h2 id="extern-â€œCâ€"><a href="#extern-â€œCâ€" class="headerlink" title="extern â€œCâ€"></a>extern â€œCâ€</h2><p>C++æœ‰å‡½æ•°é‡è½½ã€å‘½åç©ºé—´ã€æ¨¡æ¿ç­‰ï¼Œå› æ­¤éœ€è¦å¯¹åç§°è¿›è¡Œmangleï¼Œ<br>è€ŒCè¯­è¨€ä¸ä¼šã€‚</p><p>ä½¿ç”¨<code>extern &quot;C&quot;</code>è¡¨æ˜ç¬¦å·ä¸ä¼šè¢«mangleï¼Œä»è€Œèƒ½å¤Ÿä¸Cæ–‡ä»¶é“¾æ¥ï¼Œ<br>å®ç°åœ¨Cæ–‡ä»¶ä¸­è°ƒç”¨C++å‡½æ•°ä»¥åŠåœ¨C++æ–‡ä»¶ä¸­è°ƒç”¨Cå‡½æ•°ã€‚<br>æ˜¾ç„¶ï¼Œåœ¨<code>extern &quot;C&quot;</code>å°±ä¸èƒ½ä½¿ç”¨C++é‚£äº›å¿…é¡»mangleçš„åŠŸèƒ½äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="type">int</span> a;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="type">double</span> b;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="type">char</span> c;</span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="type">double</span> b;</span><br><span class="line">    <span class="type">char</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>extern &quot;C&quot; &#123;...&#125;</code>ä½œç”¨åˆ°å…¶ä¸­æ‰€æœ‰å…·æœ‰å¤–éƒ¨é“¾æ¥çš„å‡½æ•°å’Œå˜é‡ä¸Šã€‚</p><p>æ³¨æ„ï¼Œä¸å¸¦å¤§æ‹¬å·æ—¶ï¼Œexternç›´æ¥ä½œç”¨åˆ°åç»­çš„è¯­å¥ä¸Šï¼Œå› æ­¤è¿™åªæ˜¯ä¸€ä¸ªå£°æ˜ã€‚<br>è€Œåœ¨å¸¦å¤§æ‹¬å·æ—¶ï¼Œåˆ™æ˜¯å£°æ˜åŠ å®šä¹‰ï¼Œé™¤éå†™æˆ<code>extern &quot;C&quot; &#123; extern int a; &#125;</code>ã€‚<br>å½“ç„¶ï¼Œè¿™ä¸ªç»†å¾®å·®åˆ«ä»…åœ¨å®šä¹‰å˜é‡æ—¶å­˜åœ¨ï¼Œè€Œåœ¨æ›´å¸¸è§çš„å®šä¹‰å‡½æ•°æ—¶ä¸å­˜åœ¨ã€‚</p><p>é™¤äº†<code>static</code>ï¼Œåœ¨C++ä¸­<code>const</code>å˜é‡ä¹Ÿä¼šå˜æˆå†…éƒ¨é“¾æ¥ã€‚</p><h2 id="std-jthread"><a href="#std-jthread" class="headerlink" title="std::jthread"></a>std::jthread</h2><p><code>jthread</code>å³<code>joining thread</code>ï¼Œ<br>ä¸åŒäº<code>std::thread</code>ï¼Œ<code>std::jthread</code>ä¼šåœ¨ææ„æ—¶è‡ªåŠ¨è°ƒç”¨<code>join</code>ï¼Œè€Œ<code>std::thread</code>åœ¨ææ„æ—¶<br>è°ƒç”¨<code>std::terminate</code>ã€‚<br>æ­¤å¤–ï¼Œè¿˜å¯ä»¥è¯·æ±‚<code>jthread</code>æš‚åœæ‰§è¡Œï¼Œä»¥å¯¹çº¿ç¨‹æ‰§è¡Œè¿›è¡Œé¢å¤–æ§åˆ¶ï¼ˆé€šè¿‡<code>std::stop_token.stop_requested()</code>å’Œ<code>jthread.request_stop()</code>ï¼‰ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>c snippets</title>
      <link href="/2023/09/19/c-snippets/"/>
      <url>/2023/09/19/c-snippets/</url>
      
        <content type="html"><![CDATA[<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> die(msg)                                      \</span></span><br><span class="line"><span class="meta">do &#123;                                                  \</span></span><br><span class="line"><span class="meta">    perror(msg);                                      \</span></span><br><span class="line"><span class="meta">    exit(EXIT_FAILURE);                               \</span></span><br><span class="line"><span class="meta">&#125; while (0)</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> ARRAY_SIZE(arr) (sizeof(arr) / sizeof((arr)[0]))</span></span><br><span class="line"><span class="comment">// åœ¨sizeofä¸­æ•°ç»„ç±»å‹æ˜¯ä¸ä¼šé€€åŒ–çš„</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">free</span>(<span class="literal">NULL</span>); <span class="comment">// åœ¨Cæ ‡å‡†ä¸­ï¼Œè¿™æ˜¯åˆæ³•çš„ï¼Œä¸ä¼šå‘ç”Ÿä»»ä½•æ“ä½œ</span></span><br></pre></td></tr></table></figure><blockquote><p>If ptr is a null pointer, no action occurs.</p></blockquote><p>So, no need to check for NULL before <code>free</code>, it only adds more dummy code to read and is thus a bad practice.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> offsetof(TYPE, MEMBER) ((int)&amp;(((TYPE *)0)-&gt;MEMBER))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> container_of(ptr, type, member) (&#123;                      \</span></span><br><span class="line"><span class="meta">        const typeof( ((type *)0)-&gt;member ) *__mptr = (ptr);    \</span></span><br><span class="line"><span class="meta">        (type *)( (char *)__mptr - offsetof(type,member) );&#125;)</span></span><br></pre></td></tr></table></figure><p><code>offsetof</code>åœ¨ç»™å®šç»“æ„ä½“ç±»å‹å’Œä¸€ä¸ªæˆå‘˜åæ—¶ï¼Œè®¡ç®—ç»“æ„ä½“ä¸­è¯¥æˆå‘˜ç›¸å¯¹äºé¦–åœ°å€çš„åç§»é‡ã€‚è¿™é‡ŒåŠ äº†å–åœ°å€ï¼Œä»è€Œä¸ä¼šè§£å¼•ç”¨<code>0-&gt;MEMBER</code>ã€‚<code>container_of</code>åœ¨ç»™å®šç»“æ„ä½“ç±»å‹ï¼Œä»¥åŠå…¶ä¸­ä¸€ä¸ªæˆå‘˜çš„åç§°åŠå…¶åœ°å€æ—¶ï¼Œå¾—åˆ°ç»“æ„ä½“çš„é¦–åœ°å€ã€‚è¿™é‡Œ<code>(&#123;x;y;&#125;)</code>æ˜¯GNUçš„æ‰©å±•ï¼Œå®ƒä¼šè®¡ç®—æ¯ä¸ªè¡¨è¾¾å¼å¹¶è¿”å›æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚æ­¤å¤–ç¬¬ä¸€è¡Œåªæ˜¯ç”¨äºç±»å‹æ£€æŸ¥ï¼Œå…¶ä¸­<code>typeof</code>ä¹Ÿæ˜¯GNUçš„æ‰©å±•ï¼Œç±»ä¼¼C++ä¸­çš„<code>decltype</code>ã€‚ä»¥ä¸Šå®å¯ä»¥ç”¨äºå®ç°æ— ä¾µå…¥å¼çš„é“¾è¡¨ã€‚</p><h2 id="åŒ¿åæšä¸¾"><a class="header-anchor" href="#åŒ¿åæšä¸¾">Â¶</a>åŒ¿åæšä¸¾</h2><p><a href="https://stackoverflow.com/questions/7147008/the-usage-of-anonymous-enums">https://stackoverflow.com/questions/7147008/the-usage-of-anonymous-enums</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> &#123;</span> color = <span class="number">1</span> &#125;; </span><br></pre></td></tr></table></figure><p>ç›¸æ¯”äº<code>#define</code>æ›´å®‰å…¨ï¼Œç›¸æ¯”äº<code>const int</code>ï¼Œåˆ™ä¸ä¼šå ç”¨ç©ºé—´ï¼Œå¹¶ä¸”æ˜¯ç¼–è¯‘æœŸæ±‚å€¼ï¼Œå¯ä»¥æ”¾åœ¨ç±»çš„å†…éƒ¨ï¼ˆå³ç­‰ä»·äº<code>static const int</code>ï¼‰ã€‚</p><h2 id="jmp"><a class="header-anchor" href="#jmp">Â¶</a>jmp</h2><ul><li><code>setjmp(jmp_buf buf)</code>ï¼šåœ¨bufä¸­ä¿å­˜å½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¹¶è¿”å›0ã€‚</li><li><code>longjmp(jmp_buf buf, i)</code>ï¼šåŠ è½½bufä¿å­˜çš„ä¸Šä¸‹æ–‡ï¼Œå³æ¢å¤åˆ°ä¸Šæ¬¡<code>setjmp</code>çš„ä½ç½®ï¼Œå¹¶ä½¿ä¸‹æ¬¡<code>setjmp</code>è¿”å›iã€‚</li></ul><p>åœ¨Cè¯­è¨€ä¸­å®ç°é”™è¯¯å¤„ç†ï¼ˆtry catchï¼‰ã€åç¨‹ç­‰ã€‚</p><h2 id="é›¶é•¿æ•°ç»„"><a class="header-anchor" href="#é›¶é•¿æ•°ç»„">Â¶</a>é›¶é•¿æ•°ç»„</h2><p>ä¹Ÿå«æŸ”æ€§æ•°ç»„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> length;</span><br><span class="line">    <span class="type">char</span> contents[<span class="number">0</span>]; <span class="comment">// or char contents[]</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span> *<span class="title">thisline</span> =</span> <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> line) + this_length);</span><br><span class="line">thisline-&gt;length = this_length;</span><br><span class="line">assert(<span class="keyword">sizeof</span>(contents) == <span class="number">0</span>);</span><br><span class="line"><span class="comment">// åœ¨ç»“æ„ä½“å¤–ä¹Ÿèƒ½å£°æ˜int a[0]ï¼Œä½†æ˜¯ä¸èƒ½int a[]ï¼Œå…¶å®ç±»ä¼¼äºä¸€ä¸ªlabel</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> LIKELY(x) __builtin_expect(!!(x), 1) <span class="comment">// xå¾ˆå¯èƒ½ä¸ºçœŸ</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNLIKELY(x) __builtin_expect(!!(x), 0) <span class="comment">// xå¾ˆå¯èƒ½ä¸ºå‡</span></span></span><br><span class="line"><span class="comment">// __builtin_expect(exp, c)è¡¨ç¤ºexpç­‰äºcçš„æ¦‚ç‡å¾ˆå¤§ï¼Œç”¨äºå¼•å¯¼CPUçš„åˆ†æ”¯é¢„æµ‹</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/prefetch.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> prefetch(x) __builtin_prefetch(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> prefetchw(x) __builtin_prefetch(x,1)</span></span><br><span class="line">__builtin_prefetch(<span class="type">const</span> <span class="type">void</span> *addr, <span class="type">int</span> rw, <span class="type">int</span> locality) <span class="comment">// ä¸»åŠ¨å°†æ•°æ®è¯»å–åˆ°addrä¸­ï¼Œrw=1è¡¨ç¤ºå¯å†™ï¼Œ0è¡¨ç¤ºåªè¯»</span></span><br></pre></td></tr></table></figure><h2 id="ä½åŸŸ"><a class="header-anchor" href="#ä½åŸŸ">Â¶</a>ä½åŸŸ</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">S</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// will usually occupy 2 bytes:</span></span><br><span class="line">    <span class="comment">// 3 bits: value of b1</span></span><br><span class="line">    <span class="comment">// 5 bits: unused</span></span><br><span class="line">    <span class="comment">// 2 bits: value of b2</span></span><br><span class="line">    <span class="comment">// 6 bits: unused</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> b1 : <span class="number">3</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> :<span class="number">0</span>; <span class="comment">// start a new byte; 0åªèƒ½ä½œç”¨åœ¨åŒ¿åçš„å˜é‡ä¸Šï¼Œç”¨äºåç»­çš„å¼ºåˆ¶å¯¹é½</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> b2 : <span class="number">2</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">sizeof</span>(S) == <span class="number">2</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">test</span> &#123;</span></span><br><span class="line">    <span class="comment">// Unsigned integer member x</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> x;</span><br><span class="line">    <span class="comment">// Bit-field member y with 33 bits</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> y : <span class="number">33</span>;</span><br><span class="line">    <span class="comment">// Unsigned integer member z</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> z;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">sizeof</span>(test) = <span class="number">16</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="type">uint8_t</span> b : <span class="number">1000</span>; <span class="comment">// å½“æŒ‡å®šçš„å¤§å°å¤§äºç±»å‹çš„å¤§å°æ—¶ï¼Œå€¼åŸŸä¼šè¢«ç±»å‹é™åˆ¶ï¼Œ</span></span><br><span class="line"><span class="comment">// å¤šä½™çš„ä½æ•°ä»…ä»…å……å½“padding</span></span><br></pre></td></tr></table></figure><p>ä½åŸŸæˆå‘˜ä¸èƒ½å–åœ°å€ï¼Œä¹Ÿå°±ä¸èƒ½ç”¨æŒ‡é’ˆæŒ‡å‘å®ƒï¼Œå› ä¸ºå®ƒå¯èƒ½ä¸æ˜¯èµ·å§‹äºæŸä¸ªå­—èŠ‚ã€‚å¸¸é‡å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°ä½åŸŸæˆå‘˜ã€‚æ­¤å¤–ä¹Ÿä¸èƒ½ä½¿ç”¨<code>sizeof</code>ã€‚</p><p>åªæœ‰integralå’Œenumerationç±»å‹å¯ä»¥æŒ‡å®šä½åŸŸã€‚</p><h2 id="restrict"><a class="header-anchor" href="#restrict">Â¶</a>restrict</h2><p>ç±»ä¼¼äºconstå’Œvolatileçš„ç±»å‹é™å®šç¬¦ï¼Œä»…å¯ä½œç”¨äºæŒ‡é’ˆç±»å‹ï¼ˆåœ¨C++ä¸­æ²¡æœ‰ç±»ä¼¼çš„å…³é”®å­—ï¼‰ï¼Œå‘ç¼–è¯‘å™¨æ‰¿è¯ºä»…èƒ½é€šè¿‡è¯¥æŒ‡é’ˆè®¿é—®æŒ‡å‘çš„å˜é‡ï¼Œä»è€Œè¿›è¡Œæ›´å¤šä¼˜åŒ–ã€‚</p><p>æ¯”å¦‚åœ¨memmoveä¸­ï¼Œ<code>src</code>å’Œ<code>dst</code>æŒ‡å‘çš„åŒºåŸŸå¯èƒ½é‡å ï¼Œæ­¤æ—¶å°±ä¸èƒ½åŠ <code>restrict</code>ã€‚è€Œmemcpyå¦‚æœä¸è€ƒè™‘é‡å é—®é¢˜ï¼Œå¯ä»¥åŠ <code>restrict</code>å…³é”®å­—è¿›è¡Œæ›´å¤šä¼˜åŒ–</p><p>ç”±äºåœ¨C++ä¸­ï¼Œ<code>restrict</code>æ€ä¹ˆå¤„ç†ç±»ä¸å¥½è§£å†³ï¼Œæ‰€ä»¥C++æ ‡å‡†æ²¡æœ‰æ·»åŠ ã€‚ä½†ä¸»æµç¼–è¯‘å™¨éƒ½æ”¯æŒ<code>__restrict</code>æ‰©å±•ï¼Œä½†æ˜¾ç„¶ä¸åŒç¼–è¯‘å™¨çš„è¯­ä¹‰å¯èƒ½ä¸åŒã€‚</p><p>æ³¨æ„<code>getchar()</code>çš„è¿”å›å€¼æ˜¯intï¼Œè¦ä¹ˆæ˜¯unsigned charï¼Œè¦ä¹ˆæ˜¯EOFï¼ˆé€šå¸¸æ˜¯-1ï¼‰ï¼Œå› æ­¤åº”è¯¥å†™<code>int c = getchar()</code>ã€‚</p><h2 id="alloc"><a class="header-anchor" href="#alloc">Â¶</a>*alloc</h2><p><code>void* calloc( std::size_t num, std::size_t size )</code>ç”¨äºåˆ†é…numä¸ªå¤§å°ä¸ºsizeçš„å…ƒç´ ï¼Œå¹¶ä¸”ä¿è¯é›¶åˆå§‹åŒ–ã€‚è€Œ<code>malloc</code>ä¸ä¼šå¯¹åˆ†é…çš„å†…å­˜è¿›è¡Œä»»ä½•åˆå§‹åŒ–ã€‚å¦ä¸€ä¸ª<code>calloc</code>çš„ä¼˜ç‚¹æ˜¯å®ƒå¯ä»¥é¿å…<code>num * size</code>å‘ç”Ÿæº¢å‡ºçš„æƒ…å†µã€‚é€šå¸¸<code>calloc</code>ä¼šæ¯”<code>malloc</code>æ…¢ã€‚TODOï¼šmmapä¼šè¿”å›å…¨é›¶çš„é¡µé¢ã€‚</p><p><code>void* alloc(size_t size)</code>åœ¨å½“å‰å‡½æ•°çš„æ ˆå¸§å†…åˆ†é…å°‘é‡å†…å­˜ï¼Œå¹¶åœ¨å‡½æ•°è¿”å›æ—¶é‡Šæ”¾ã€‚ä½¿ç”¨åœºæ™¯æ˜¯å¯å˜æ•°ç»„ï¼ˆä»¥å˜é‡ä¸ºé•¿åº¦ï¼‰å’Œå¯è¾¹é•¿å‚æ•°åˆ—è¡¨ï¼ˆva_listï¼‰ã€‚</p><h2 id="I-Oç¼“å†²"><a class="header-anchor" href="#I-Oç¼“å†²">Â¶</a>I/Oç¼“å†²</h2><ul><li>å…¨ç¼“å†²ï¼šä»…åœ¨ç¼“å†²åŒºæ»¡æ—¶æ‰è¿›è¡Œå®é™…I/Oæ“ä½œ</li><li>è¡Œç¼“å†²ï¼šåœ¨é‡åˆ°æ¢è¡Œç¬¦æ—¶æ‰è¿›è¡Œå®é™…I/Oæ“ä½œ</li><li>æ— ç¼“å†²ï¼šä¸è¿›è¡Œç¼“å†²</li></ul><p><code>stdint</code>å’Œ<code>stdout</code>åœ¨éäº¤äº’è®¾å¤‡ä¸‹æ˜¯å…¨ç¼“å†²çš„ï¼Œè€Œ<code>stderr</code>æ˜¯æ— ç¼“å†²æˆ–è¡Œç¼“å†²çš„ã€‚æ‰€ä»¥åƒæ—¥å¿—è¿™ç§è¾“å‡ºåˆ°<code>stderr</code>çš„æ²¡å¿…è¦åœ¨æ¯æ¬¡è¾“å‡ºåå†åˆ·æ–°ä¸€ä¸‹ç¼“å†²åŒºï¼ˆå¦‚æœè¾“å‡ºä¼šæ¢è¡Œçš„è¯ï¼‰ã€‚</p><p>æ–‡æœ¬æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„åŒºåˆ«æ˜¯æ–‡æœ¬æ–‡ä»¶ä¼šå¯¹è¯¸å¦‚æ¢è¡Œç¬¦ç­‰è¿›è¡Œå¤„ç†ï¼ˆåœ¨windowsä¸‹åº”ä¸º<code>\r\n</code>ï¼Œå³å›è½¦+æ¢è¡Œï¼‰ï¼Œè€ŒäºŒè¿›åˆ¶æ–‡ä»¶åªæ˜¯å½“åšæ™®é€šçš„å­—èŠ‚ï¼ˆå› æ­¤ï¼Œåœ¨*nixä¸‹ä¸¤è€…æ²¡æœ‰åŒºåˆ«ï¼‰ã€‚</p><h2 id="ä¿¡å·"><a class="header-anchor" href="#ä¿¡å·">Â¶</a>ä¿¡å·</h2><p><code>int raise(int sig)</code>äº§ç”Ÿä¸€ä¸ªä¿¡å·ï¼ŒæˆåŠŸæ—¶è¿”å›0ã€‚</p><p><code>void (*signal(int sig, void (*handler)(int)))(int)</code>å¯¹ä¸€ä¸ªä¿¡å·æ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚ç‰¹åˆ«åœ°ï¼Œ<code>SIG_DFL</code>ä¼šé‡‡ç”¨å®ç°å®šä¹‰çš„é»˜è®¤è¡Œä¸ºï¼Œ<code>SIG_IGN</code>ä¼šå¿½ç•¥ä¿¡å·ã€‚</p><ul><li><code>SIGABRT</code>ï¼šå¼‚å¸¸é€€å‡ºï¼Œå¦‚<code>abort</code></li><li><code>SIGFPE</code>ï¼šç®—æœ¯å¼‚å¸¸ï¼Œå¦‚é™¤0å’Œæº¢å‡º</li><li><code>SIGINT</code>ï¼šä¸­æ–­ (<code>CTRL+C</code>ï¼›<code>CTRL+D</code>è¡¨ç¤ºEOFï¼Œç”¨äºäº¤äº’ç¨‹åºï¼›<code>CTRL+Z</code>å‘é€<code>TSTP</code>ï¼Œè®©ç¨‹åºåœ¨åå°è¿è¡Œï¼Œå¯ä»¥ç”¨<code>fg</code>æ¢å¤)</li><li><code>SIGTERM</code>ï¼šç»ˆæ­¢è¯·æ±‚ (<code>kill [15]</code>)</li><li><code>SIGSEGV</code>ï¼šæ®µé”™è¯¯</li></ul><h2 id="å¯å˜å‚æ•°åˆ—è¡¨"><a class="header-anchor" href="#å¯å˜å‚æ•°åˆ—è¡¨">Â¶</a>å¯å˜å‚æ•°åˆ—è¡¨</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">va_list ap;</span><br><span class="line">va_start(ap, arg); <span class="comment">// ä½¿apæŒ‡å‘æœ€åä¸€ä¸ªå‘½åå‚æ•°arg</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">va_arg</span><span class="params">(ap, <span class="type">int</span>)</span>; <span class="comment">// ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ç”¨æŒ‡å®šçš„typeç±»å‹è§£é‡Š</span></span><br><span class="line">va_end(ap);</span><br></pre></td></tr></table></figure><h2 id="div"><a class="header-anchor" href="#div">Â¶</a>div</h2><p><code>div_t div(int x, int y)</code>è¿”å›çš„<code>div_t</code>æ˜¯æœ‰æˆå‘˜<code>quot</code>å’Œ<code>rem</code>çš„ç»“æ„ä½“ã€‚</p><p><code>double fmod(double x, double y)</code>è®¡ç®—æµ®ç‚¹æ•°æ¨¡æ•°ã€‚</p><p><code>double modf(double arg, double* ap)</code>è¿”å›å°æ•°éƒ¨åˆ†ï¼Œå¹¶åœ¨<code>ap</code>ä¸­å­˜å‚¨æ•´æ•°éƒ¨åˆ†ã€‚</p><p><code>size_t strspn( const char *dest, const char *src )</code>è¿”å›ä»¥<code>dest</code>èµ·å§‹çš„æœ€é•¿å‰ç¼€ï¼Œå…¶åªåŒ…å«<code>src</code>ä¸­çš„å­—ç¬¦ã€‚</p><p><code>char *strpbrk( const char *dest, const char *breakset )</code>è¿”å›ç¬¬ä¸€ä¸ªåœ¨<code>breakset</code>ä¸­å‡ºç°çš„å­—ç¬¦çš„ä½ç½®</p><p><code>char *strtok( char *str, const char *delim )</code>æ ¹æ®<code>delim</code>å¯¹<code>str</code>è¿›è¡Œsplitã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *token = strtok(input, <span class="string">&quot; &quot;</span>);</span><br><span class="line"><span class="keyword">while</span>(token) &#123;</span><br><span class="line">    <span class="built_in">puts</span>(token);</span><br><span class="line">    token = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>); <span class="comment">// ä¼ å…¥NULLä»¥ç»§ç»­å¤„ç†ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶çš„input</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡è°ƒç”¨ä¼šä»ä¸Šä¸ª<code>token</code>ç»“æŸçš„ä½ç½®å¼€å§‹æŸ¥æ‰¾ä¸åŒ…å«<code>delim</code>çš„<code>token</code>ï¼Œå¹¶å°†ç»“æŸä½ç½®æ°¸ä¹…ç½®ä¸ºâ€™\0â€™åè¿”å›ï¼ˆå› æ­¤ä¼ å…¥çš„å‚æ•°ä¸æ˜¯constçš„ï¼‰ï¼Œæ¯æ¬¡<code>strtok</code>çš„<code>delim</code>å¯ä»¥ä¸åŒã€‚</p><h2 id="sizeof"><a class="header-anchor" href="#sizeof">Â¶</a>sizeof</h2><p><code>sizeof(type)</code>æˆ–<code>sizeof expression</code>ï¼Œè¡¨è¾¾å¼æ˜¯å¯ä»¥ä¸åŠ æ‹¬å·çš„ï¼Œä½†ç”±äºä¼˜å…ˆçº§é—®é¢˜ä»¥åŠä¿æŒä¸€è‡´æ€§åŸåˆ™ï¼Œå»ºè®®æ°¸è¿œåŠ æ‹¬å·ã€‚å¦‚<code>sizeof a + b</code>å…¶å®æ˜¯<code>sizeof(a) + b</code>ã€‚</p><h2 id="å‡½æ•°æŒ‡é’ˆ"><a class="header-anchor" href="#å‡½æ•°æŒ‡é’ˆ">Â¶</a>å‡½æ•°æŒ‡é’ˆ</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> (*fp)(<span class="type">int</span>) = &amp;f;</span><br><span class="line">(*fp)(<span class="number">10</span>);</span><br><span class="line"><span class="type">void</span> (*fp)(<span class="type">int</span>) = f;</span><br><span class="line">fp(<span class="number">10</span>);</span><br><span class="line"><span class="type">void</span> <span class="title function_">g</span><span class="params">(<span class="type">void</span> fp(<span class="type">int</span>))</span>; <span class="comment">// åœ¨å‡½æ•°å‚æ•°ä¸­å‡½æ•°ç±»å‹ä¼šéšå¼è½¬ä¸ºæŒ‡é’ˆï¼ˆå°±åƒæ•°ç»„åä¼šé€€åŒ–ä¸ºæŒ‡é’ˆä¸€æ ·ï¼‰</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ç§å†™æ³•éƒ½æ˜¯å¯ä»¥çš„ï¼Œå‡½æ•°åç§°ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯å‡½æ•°æŒ‡é’ˆå¸¸é‡ï¼Œç±»æ¯”æ•°ç»„ï¼‰å’ŒæŒ‡é’ˆæ··ç”¨å¯ä»¥ç†è§£ä¸ºä¸€ç§è¯­æ³•ç³–ï¼Œå‡½æ•°æŒ‡é’ˆä¸å…¶å®ƒæŒ‡é’ˆçš„åŒºåˆ«æ˜¯å®ƒæŒ‡å‘ä»£ç è€Œä¸æ˜¯æ•°æ®ã€‚</p><p><code>void *__builtin_return_address(unsigned int level)</code>ï¼šè¿”å›å½“å‰å‡½æ•°æˆ–å…¶è°ƒç”¨è€…ä¹‹ä¸€çš„è¿”å›åœ°å€<code>void *__builtin_frame_address(unsigned int level)</code>ï¼š è¿”å›å‡½æ•°æ ˆå¸§åœ°å€ï¼ˆå¸§æ˜¯å †æ ˆä¸Šä¿å­˜å±€éƒ¨å˜é‡å’Œå¯„å­˜å™¨çš„åŒºåŸŸï¼Œå¸§åœ°å€æ˜¯å‡½æ•°å¯¹åº”å †æ ˆåŒºåŸŸçš„èµ·å§‹åœ°å€ï¼‰</p><p>åˆ†åˆ«åœ¨mainæ‰§è¡Œå‰å’Œmainæ‰§è¡Œåè¿è¡Œã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__attribute__((constructor))</span><br><span class="line">__attribute__((destructor))</span><br></pre></td></tr></table></figure><h2 id="format-macro-constants"><a class="header-anchor" href="#format-macro-constants">Â¶</a>format macro constants</h2><p><a href="https://en.cppreference.com/w/c/types/integer#Format_macro_constants">https://en.cppreference.com/w/c/types/integer#Format_macro_constants</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;inttypes.h&gt;</span></span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;num1 %&quot;</span> PRIi64 <span class="string">&quot; num2 %&quot;</span> PRIu64, num_i64, num_u64);</span><br></pre></td></tr></table></figure><h2 id="å®å±•å¼€è§„åˆ™"><a class="header-anchor" href="#å®å±•å¼€è§„åˆ™">Â¶</a>å®å±•å¼€è§„åˆ™</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> identifier(a1, a2, ..., an) replacement-list</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœå½“å‰å®æ˜¯å‡½æ•°å½¢å¼ï¼Œåˆ™å…ˆå¯¹å®å‚è¿›è¡Œå®å±•å¼€</li><li>å¦‚æœå½“å‰å®åŒ…å«#æˆ–è€…##ï¼Œåˆ™ç›´æ¥æ›¿æ¢ ï¼ˆinhibits expansionï¼‰</li><li>è¢«æ›¿æ¢åä¼šå¯¹<strong>æ›¿æ¢çš„ç»“æœ</strong>è¿›è¡Œé‡æ–°æ‰«æï¼Œè€Œå¦‚æœæ›¿æ¢åæ˜¯ä¸€ä¸ªé€’å½’å®ï¼ˆæ›¿æ¢ç»“æœæ­£æ˜¯åˆè¯¥å®äº§ç”Ÿçš„ï¼‰ï¼Œä¸ä¼šå†è¿›è¡Œæ›¿æ¢ï¼ˆè¢«æ ‡è®°ä¼š&quot;to be ignored&quot;ï¼‰</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> EMPTY</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SCAN(x)     x</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EXAMPLE_()  EXAMPLE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EXAMPLE(n)  EXAMPLE_ EMPTY()(n-1) (n)</span></span><br><span class="line">EXAMPLE(<span class="number">5</span>)</span><br><span class="line">SCAN(EXAMPLE(<span class="number">5</span>))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ<code>EXAMPLE(5)</code>å…ˆè¢«æ›¿æ¢ä¸º<code>EXAMPLE_ EMPTY()(5-1) (5)</code>ï¼Œç„¶åé‡æ–°æ‰«æåæŠŠ<code>EMPTY</code>æ›¿æ¢ä¸ºç©ºï¼Œç„¶åå°±ç»“æŸäº†ã€‚</p><p>å†å¥—ä¸€å±‚<code>SCAN</code>å°±ä¼šå¼ºè¿«å¯¹æ•´ä¸ªè¿›è¡Œæ‰«æï¼Œäºæ˜¯è¿›ä¸€æ­¥å˜æˆ<code>EXAMPLE(5-1) (5)</code>ï¼Œç„¶åå†è§¦å‘ä¸€æ¬¡æ›¿æ¢ã€‚</p><p>ä¸€ä¸ªç»†èŠ‚æ˜¯å‡½æ•°è°ƒç”¨ä¸­å‡½æ•°åå’Œæ‹¬å·é—´æ˜¯å¯ä»¥æœ‰ç©ºç™½ç¬¦çš„ï¼Œä¼šè¢«å¿½ç•¥æ‰ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python snippets</title>
      <link href="/2023/09/16/python-snippets/"/>
      <url>/2023/09/16/python-snippets/</url>
      
        <content type="html"><![CDATA[<h2 id="æ— ç©·å¤§"><a class="header-anchor" href="#æ— ç©·å¤§">Â¶</a>æ— ç©·å¤§</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)</span><br><span class="line"><span class="built_in">float</span>(<span class="string">&#x27;-inf&#x27;</span>)</span><br><span class="line">math.inf</span><br><span class="line">-math.inf</span><br><span class="line"><span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>) == math.inf <span class="comment"># True</span></span><br><span class="line"><span class="built_in">type</span>(<span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)) == <span class="built_in">float</span></span><br><span class="line"><span class="built_in">type</span>(math.inf) == <span class="built_in">float</span></span><br></pre></td></tr></table></figure><h2 id="map"><a class="header-anchor" href="#map">Â¶</a>map</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mp = &#123;<span class="string">&#x27;(&#x27;</span>:<span class="number">0</span>, <span class="string">&#x27;&#123;&#x27;</span>:<span class="number">1</span>, <span class="string">&#x27;[&#x27;</span>:<span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰æ¯”è¾ƒ"><a class="header-anchor" href="#è‡ªå®šä¹‰æ¯”è¾ƒ">Â¶</a>è‡ªå®šä¹‰æ¯”è¾ƒ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">lst.sort(<span class="keyword">lambda</span> x: <span class="number">10</span> * x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmp</span>(<span class="params">i, j</span>):</span><br><span class="line">    <span class="keyword">if</span> a[i] &lt; a[j]: <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> a[i] &gt; a[j]: <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">lst.sort(functools.cmp_to_key(cmp))</span><br><span class="line"><span class="comment"># list.sort()å’Œsortedéƒ½ä¿è¯æ˜¯stableçš„</span></span><br></pre></td></tr></table></figure><p><code>for i, x in enumerate(lst):</code></p><h2 id="å¤šç»´åˆ—è¡¨"><a class="header-anchor" href="#å¤šç»´åˆ—è¡¨">Â¶</a>å¤šç»´åˆ—è¡¨</h2><p><code>lst * n</code>ä¼šåˆ›å»ºnä¸ªæµ…æ‹·è´çš„åˆ—è¡¨ï¼Œæ‰€ä»¥åº”è¯¥ä½¿ç”¨åˆ—è¡¨æ¨å¯¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="number">0</span>] * n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br></pre></td></tr></table></figure><h2 id="Counter"><a class="header-anchor" href="#Counter">Â¶</a>Counter</h2><p>å­—å…¸çš„å­ç±»ï¼Œæä¾›å¯å“ˆå¸Œå¯¹è±¡çš„è®¡æ•°åŠŸèƒ½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line">c = Counter([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>]) <span class="comment"># Counter(&#123;2: 2, 1: 1, 3: 1&#125;)</span></span><br><span class="line">c1 + c2</span><br><span class="line">c1 - c2</span><br><span class="line">c1 &amp; c2</span><br><span class="line">c1 | c2</span><br><span class="line">c.most_common(n) <span class="comment"># è¿”å›å‡ºç°æ¬¡æ•°å‰nå¤šçš„å…ƒç´ åˆ—è¡¨</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cppquiz</title>
      <link href="/2023/09/11/cppquiz/"/>
      <url>/2023/09/11/cppquiz/</url>
      
        <content type="html"><![CDATA[<ul><li>Undefined behaviourï¼šæœªå®šä¹‰è¡Œä¸ºã€‚æ ‡å‡†æ²¡æœ‰è§„å®šç¨‹åºåœ¨è¯¥çŠ¶æ€ä¸‹çš„è¡Œä¸ºï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å‘ç”Ÿä»»ä½•äº‹æƒ…ã€‚è¿™æ˜¯ä¸è¡Œçš„ã€‚</li><li>Unspecified behaviorï¼šæœªæŒ‡å®šè¡Œä¸ºã€‚è¿™æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¯èƒ½æœ‰å¤šç§æœ‰æ•ˆçš„ç»“æœã€‚</li><li>Implementation-defined behaviorï¼šå®ç°å®šä¹‰è¡Œä¸ºã€‚ä¸æœªæŒ‡å®šè¡Œä¸ºç±»ä¼¼ï¼Œä½†æ˜¯éœ€è¦åœ¨ç¼–è¯‘æ‰‹å†Œä¸­è®°å½•ã€‚</li><li>Ill-formed, no diagnostic requiredï¼šé”™è¯¯ä¸”æ— éœ€è¯Šæ–­ã€‚ç­‰ä»·äºæœªå®šä¹‰è¡Œä¸ºï¼Œåªæ˜¯è¿™ç§è¯´æ³•æ›´ä¾§é‡äºç¼–è¯‘æœŸï¼ˆä»£ç å±‚é¢ï¼‰ï¼Œè€Œæœªå®šä¹‰è¡Œä¸ºæ›´ä¾§é‡äºè¿è¡ŒæœŸã€‚</li></ul><p>æœªå®šä¹‰è¡Œä¸ºæ˜¯è¢«è®¤ä¸ºä¸å…è®¸å‡ºç°çš„ï¼Œæ— å˜å¤´è¡Œä¸ºï¼ˆç¼–è¯‘å™¨ä¼šå‡å®šç¨‹åºä¸åŒ…å«UBä»¥è¿›è¡Œä¼˜åŒ–ï¼‰ã€‚è€Œå®ç°å®šä¹‰è¡Œä¸ºæ˜¯å› ä¸ºä¸åŒCPUã€æ“ä½œç³»ç»Ÿã€ç¼–è¯‘å™¨æ— æ³•å¯¹è¯¥è¡Œä¸ºè¾¾æˆå…±è¯†ã€‚</p><p>è§„å®šæœªå®šä¹‰è¡Œä¸ºä¹Ÿæ˜¯ä¸ºäº†æ€§èƒ½ï¼ˆæ¯”å¦‚å…è®¸ä»»æ„çš„è¡¨è¾¾å¼æ±‚å€¼é¡ºåºï¼‰ä»¥åŠç®€åŒ–è¯­è¨€å¤æ‚æ€§ã€‚</p><p>æ³¨ï¼šå®‰å…¨Rustç†è®ºä¸Šæ˜¯æ²¡æœ‰æœªå®šä¹‰è¡Œä¸ºçš„ã€‚å…¶å®æ˜¯ä¼šå‡ºç°çš„ï¼Œä¸è¿‡ä¼šè¢«è§†ä½œç¼–è¯‘å™¨æˆ–æ ‡å‡†åº“çš„bugã€‚</p><h2 id="å€¼ç±»åˆ«"><a class="header-anchor" href="#å€¼ç±»åˆ«">Â¶</a>å€¼ç±»åˆ«</h2><p>å‚è€ƒ<a href="https://paul.pub/cpp-value-category/">https://paul.pub/cpp-value-category/</a></p><p>æ¯ä¸ªè¡¨è¾¾å¼æœ‰ä¸¤ä¸ªå±æ€§ï¼šç±»å‹ï¼ˆtypeï¼‰å’Œå€¼ç±»åˆ«ï¼ˆvalue categoryï¼‰ã€‚</p><p>å·¦å€¼ï¼ˆlvalueï¼‰å¸¸å¸¸å‡ºç°åœ¨ç­‰å·å·¦è¾¹ï¼Œè€Œå³å€¼ï¼ˆrvalueï¼‰å¸¸å¸¸å‡ºç°åœ¨ç­‰å·å³è¾¹ã€‚ï¼ˆè€ƒè™‘<code>const int</code>ï¼Œåœ¨åˆå§‹åŒ–æ—¶èƒ½å‡ºç°åœ¨å·¦è¾¹ï¼Œä¹‹ååªèƒ½å‡ºç°åœ¨å³è¾¹ï¼Œæ— æ³•åˆ†ç±»ï¼‰</p><p>æ›´å‡†ç¡®åœ°è¯´ï¼Œå·¦å€¼ä»£è¡¨äº†å…·æœ‰å†…å­˜åœ°å€çš„å¯¹è±¡ï¼ˆlocator valueï¼‰ï¼Œè€Œå³å€¼ä»£è¡¨ä¸´æ—¶å€¼ã€‚</p><p>åœ¨C++11åï¼Œå€¼ç±»åˆ«åˆ†ä¸ºlvalueã€prvalueã€xvalueä»¥åŠglvalueå’Œrvalueäº”ç§ã€‚</p><ul><li>lvalueï¼šæ‹¥æœ‰èº«ä»½ä¸”ä¸å¯è¢«ç§»åŠ¨çš„è¡¨è¾¾å¼ã€‚</li><li>xvalue (eXpiring value)ï¼šæ‹¥æœ‰èº«ä»½ä¸”å¯è¢«ç§»åŠ¨çš„è¡¨è¾¾å¼ã€‚</li><li>prvalue (pure rvalue)ï¼šä¸æ‹¥æœ‰èº«ä»½ä¸”å¯è¢«ç§»åŠ¨çš„è¡¨è¾¾å¼ã€‚</li><li>glvalue (generalized lvalue)ï¼šæ‹¥æœ‰èº«ä»½çš„è¡¨è¾¾å¼ï¼Œlvalueå’Œxvalueéƒ½æ˜¯glvalueã€‚</li><li>rvalueï¼šå¯è¢«ç§»åŠ¨çš„è¡¨è¾¾å¼ã€‚prvalueå’Œxvalueéƒ½æ˜¯rvalueã€‚</li></ul><p>èº«ä»½ï¼šå³æ˜¯å¦å¯ä»¥åˆ¤æ–­ä¸¤ä¸ªè¡¨è¾¾å¼å¯¹åº”äºåŒä¸€ä¸ªå®ä½“ï¼Œå¦‚æ ¹æ®åœ°å€ã€‚</p><ul><li>å·¦å€¼å¼•ç”¨ï¼ˆ&amp;ï¼‰ï¼šéconstç‰ˆæœ¬åªèƒ½ç»‘å®šåˆ°å·¦å€¼ï¼Œconstç‰ˆæœ¬è¿˜å¯ä»¥ç»‘å®šåˆ°å³å€¼ã€‚</li><li>å³å€¼å¼•ç”¨ï¼ˆ&amp;&amp;ï¼‰ï¼šåªèƒ½ç»‘å®šåˆ°å³å€¼ã€‚</li></ul><p><a data-fancybox="gallery" data-src="/post-images/value-catogory.png" data-caption="å€¼ç±»åˆ«åˆ†ç±»"><img src="/post-images/value-catogory.png" alt="å€¼ç±»åˆ«åˆ†ç±»"></a></p><h3 id="ç§»åŠ¨è¯­ä¹‰"><a class="header-anchor" href="#ç§»åŠ¨è¯­ä¹‰">Â¶</a>ç§»åŠ¨è¯­ä¹‰</h3><p>åœ¨å®šä¹‰äº†æ‹·è´æ„é€ å’Œæ‹·è´èµ‹å€¼å‡½æ•°æ—¶ï¼Œé€šå¸¸è¿˜éœ€è¦å®šä¹‰ææ„å‡½æ•°ï¼Œæ­¤æ—¶ä¸€èˆ¬æ¶‰åŠåˆ°æ‹¥æœ‰æ‰€æœ‰æƒçš„æŒ‡é’ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">X</span>(<span class="type">const</span> X&amp; other); <span class="comment">// copy constructor</span></span><br><span class="line">X&amp; <span class="keyword">operator</span>=(X other); <span class="comment">// copy assignment</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">X</span>(X&amp;&amp;) <span class="comment">// move constructor</span></span><br><span class="line">X&amp; <span class="keyword">operator</span>=(X&amp;&amp;); <span class="comment">// move assignment</span></span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´ï¼Œåœ¨æ‹·è´ä¸­æˆ‘ä»¬ä¼šnewä¸€æ®µæ–°çš„å†…å­˜ç©ºé—´ï¼Œå¹¶æ ¹æ®ç»™å®šå¯¹è±¡æ„é€ ä¸€ä»½ç›¸åŒçš„ã€‚è€Œåœ¨ç§»åŠ¨ä¸­æˆ‘ä»¬åªæ˜¯å°†ç»™å®šå¯¹è±¡å†…éƒ¨çš„æŒ‡é’ˆæ‹·è´è¿‡æ¥ã€‚ï¼ˆç±»ä¼¼æ·±æ‹·è´ã€æµ…æ‹·è´ï¼‰</p><p>Rule of Threeï¼šæ¯å½“éœ€è¦æ˜¾å¼å®šä¹‰ææ„ã€æ‹·è´æ„é€ å’Œæ‹·è´èµ‹å€¼ä¹‹ä¸€ï¼Œå°±åº”è¯¥è€ƒè™‘æ˜¾å¼å®šä¹‰å…¨éƒ¨ã€‚</p><p>è¡¥å……ï¼šé€šå¸¸è¯¥ç±»éœ€è¦æ‰‹åŠ¨ç®¡ç†èµ„æºï¼Œä½†æ˜¯å¦‚æœæ¶‰åŠå¤šä¸ªèµ„æºï¼Œä¸”åœ¨æ„é€ å‡½æ•°ä¸­å‘ç”Ÿå¼‚å¸¸ï¼Œå¯¹åº”çš„ææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ï¼Œå› ä¸ºè¿™ä¸ªå¯¹è±¡å°±æ²¡æœ‰å­˜åœ¨è¿‡ï¼ˆéå¼‚å¸¸å®‰å…¨ï¼‰ã€‚è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªRAIIç±»æ¥åŒ…è£…æ¯ä¸€ä¸ªèµ„æºã€‚è€Œæ­¤æ—¶é€šå¸¸ä¸å†éœ€è¦æ˜¾ç¤ºå®šä¹‰ææ„å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤çš„ç‰ˆæœ¬ï¼Œå› ä¸ºèµ„æºçš„é‡Šæ”¾è½¬è€Œåœ¨RAIIç±»çš„ææ„å‡½æ•°ä¸­è¿›è¡Œï¼Œè¿™ä¹Ÿè¢«ç§°ä½œRule of twoã€‚</p><p>RAIIè¡¨ç¤ºèµ„æºè·å–å³åˆå§‹åŒ–ï¼Œå…¶å°†èµ„æºä¸å¯¹è±¡çš„ç”Ÿå‘½è”ç³»èµ·æ¥ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­<strong>ç”³è¯·æˆ–è·å–</strong>èµ„æºï¼Œåœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾èµ„æºRAIIå¹¶ä¸æ˜¯æŒ‡èµ„æºä¸€å®šè¦åœ¨æ„é€ å‡½æ•°ä¸­è‡ªè¡Œç”³è¯·ï¼Œè€Œæ˜¯èµ„æºçš„è·å–å’Œé‡Šæ”¾ä¸å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç›¸å…³è”ã€‚åœ¨ä¸åŒæƒ…å†µä¸‹ï¼Œèµ„æºçš„è·å–å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°å‚æ•°ä¼ é€’ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¯¹è±¡çš„æ„é€ å‡½æ•°è‡ªè¡Œç”³è¯·ã€‚å…³é”®æ˜¯ç¡®ä¿èµ„æºçš„æ­£ç¡®ç®¡ç†ä¸å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œä»¥é¿å…èµ„æºæ³„æ¼å’Œä¸æ­£ç¡®çš„èµ„æºä½¿ç”¨ã€‚</p><p>Rule of Fiveï¼šåœ¨C++11åŠä»¥åï¼Œè¿˜è¦å†åŠ ä¸Šç§»åŠ¨æ„é€ å’Œç§»åŠ¨èµ‹å€¼ã€‚</p><p>Rule of Zeroï¼šä¸æ­¤åŒæ—¶ï¼Œä¸€ä¸ªç±»é™¤éä¸èµ„æºç®¡ç†æœ‰å…³ï¼Œå¦åˆ™ä¸åº”è¯¥è‡ªå®šä¹‰ä»»ä½•ç‰¹æ®Šå‡½æ•°ã€‚å•ä¸€èŒè´£åŸç†ã€‚å› ä¸ºä¸€ä¸ªç‰¹æ®Šçš„æˆå‘˜å°±å»è‡ªè¡Œç¼–å†™è¿™å‡ ä¸ªç‰¹æ®Šå‡½æ•°å¾ˆå®¹æ˜“äº§ç”Ÿé—®é¢˜å’Œéº»çƒ¦ã€‚</p><p><code>std::move()</code>æ— æ¡ä»¶åœ°å°†å®å‚å¼ºåˆ¶è½¬æ¢ä¸ºå³å€¼å¼•ç”¨ï¼ˆä½œç”¨ç±»ä¼¼<code>static_cast</code>ï¼‰ã€‚åœ¨C++ä¸­moveæ˜¯non-destructiveçš„ï¼Œè¢«ç§»åŠ¨åçš„å¯¹è±¡çŠ¶æ€ä»æ˜¯ä¸€ç§valid stateï¼Œéœ€è¦ä¿è¯å®ƒèƒ½<strong>æ­£å¸¸ä¸”éœ€è¦è¢«è°ƒç”¨ææ„å‡½æ•°</strong>ã€‚</p><h3 id="å®Œç¾è½¬å‘"><a class="header-anchor" href="#å®Œç¾è½¬å‘">Â¶</a>å®Œç¾è½¬å‘</h3><p><code>emplace_back</code>å°±æ˜¯ç”¨çš„è¿™ä¸ªæŠ€æœ¯ï¼Œé¿å…äº†ä¸€ä¸ªä¸´æ—¶å¯¹è±¡çš„æ„é€ ï¼ˆéš¾ç‚¹æ˜¯æ€ä¹ˆåœ¨å‡½æ•°è°ƒç”¨é—´ä¿æŒå‚æ•°çš„æ­£ç¡®ç±»å‹ï¼‰ã€‚</p><p>å¼•ç”¨æŠ˜å è§„åˆ™ï¼šåªæœ‰å³å€¼+å³å€¼ï¼ˆå³A&amp;&amp; &amp;&amp;ï¼‰ä»ç„¶ä¸ºå³å€¼ï¼Œå¦åˆ™éƒ½å°†å˜ä¸ºå·¦å€¼ã€‚</p><p>Universal Referenseï¼š<code>template&lt;typename T&gt; T&amp;&amp;</code>ï¼ŒTä¼šè¢«æ­£ç¡®åœ°æ¨å¯¼ä¸ºå¯¹åº”çš„å·¦å€¼å¼•ç”¨æˆ–å³å€¼å¼•ç”¨ç±»å‹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2&gt; </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">emplace_back</span><span class="params">(T1&amp;&amp; e1, T2&amp;&amp; e2)</span> </span>&#123; </span><br><span class="line">    <span class="built_in">func</span>(forward&lt;T1&gt;(e1), forward&lt;T2&gt;(e2)); </span><br><span class="line">    <span class="comment">// forwardå°†e1è½¬ä¸ºstd::remove_reference&lt;T1&gt;::type&amp;&amp;ç±»å‹ï¼Œ</span></span><br><span class="line">    <span class="comment">// ä¹Ÿå°±æ˜¯æ­£ç¡®çš„å³å€¼å¼•ç”¨ç±»å‹ </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼Œé¦–å…ˆæ˜¯å‚æ•°ä¸­çš„<code>T1&amp;&amp; e1</code>ï¼Œè¿™åˆ©ç”¨Urefçš„ç‰¹æ€§æ¥ä¿æŒç±»å‹ã€‚ç„¶åæ˜¯è°ƒç”¨funcä¸­çš„<code>forward&lt;T1&gt;(e1)</code>ï¼Œforwardä¸ºT1å åŠ äº†ä¸€ä¸ª&amp;&amp;ï¼ŒåŸºäºå¼•ç”¨å åŠ è§„åˆ™ï¼Œä¹Ÿèƒ½ç»§ç»­ä¿æŒç±»å‹ã€‚</p><h2 id="å³å·¦æ³•åˆ™"><a class="header-anchor" href="#å³å·¦æ³•åˆ™">Â¶</a>å³å·¦æ³•åˆ™</h2><p>ç”¨äºè§£è¯»å˜é‡çš„å£°æ˜ç±»å‹ï¼Œä¹Ÿå«èºæ—‹ä¿®é¥°è§„åˆ™ã€‚</p><p>ä»æœªå®šä¹‰çš„å˜é‡åï¼ˆæœ€å·¦ä¾§çš„æœ€å†…å±‚æ‹¬å·ï¼‰å¼€å§‹ï¼Œ<strong>å…ˆå¾€å³å†å¾€å·¦</strong>ï¼ˆé¡ºæ—¶é’ˆé¡ºåºï¼‰ï¼Œé‡åˆ°</p><ul><li><input type="checkbox" id="checkbox0" checked="true"><label for="checkbox0">ä¸€ä¸ªæœ‰xä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œå…ƒç´ ç±»å‹ä¸ºâ€¦</label></li><li>[] ä¸€ä¸ªå…ƒç´ ä¸ªæ•°æœªçŸ¥çš„æ•°ç»„ï¼Œå…ƒç´ ç±»å‹ä¸ºâ€¦</li><li>(type1, type2) ä¸€ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸ºtype1ï¼Œç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸ºtype2ï¼Œè¿”å›ç±»å‹ä¸ºâ€¦</li><li>* ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç±»å‹ä¸ºâ€¦</li><li>å†—ä½™çš„å·¦æ‹¬å·åªèƒ½åœ¨å‘ä¸Šçš„æ—¶å€™ç¢°åˆ°ï¼Œå†—ä½™çš„å³æ‹¬å·åªèƒ½åœ¨å‘ä¸‹çš„æ—¶å€™ç¢°åˆ°ï¼Œå¦åˆ™è¯­æ³•é”™è¯¯</li><li>ç‰¹åˆ«æ³¨æ„ç©¿æ’çš„cvé™å®šç¬¦</li></ul><h3 id="ä¾‹å­"><a class="header-anchor" href="#ä¾‹å­">Â¶</a>ä¾‹å­</h3><p><code>int (*func)( int *p, int (*f)(int*) );</code></p><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><ol><li>funcæ˜¯æŒ‡é’ˆ<code>*</code>ï¼ŒæŒ‡å‘ç±»å‹ä¸º</li><li>ä¸€ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>int *p</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸º<code>int (*f)(int*)</code>ï¼Œè¿”å›ç±»å‹ä¸º</li><li>int</li></ol></details><p><code>int ( *(*func)(int *p) )[5];</code></p><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><ol><li>funcæ˜¯æŒ‡é’ˆ<code>*</code>ï¼ŒæŒ‡å‘ç±»å‹ä¸º</li><li>ä¸€ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸º<code>int *p</code>ï¼Œè¿”å›ç±»å‹ä¸º</li><li>ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ç±»å‹ä¸º</li><li>ä¸€ä¸ªæœ‰5ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œå…ƒç´ ç±»å‹ä¸º</li><li>int</li></ol></details><p><code>int (*)p[2]</code></p><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¯­æ³•é”™è¯¯ã€‚è¿™é‡Œåœ¨å‘ä¸Šçš„æ—¶å€™ç¢°åˆ°äº†å†—ä½™çš„å³æ‹¬å·ã€‚</p></details><p><code>int const *p</code></p><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>pæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªconstä¿®é¥°çš„intã€‚å¯è§constå†™åœ¨å³ä¾§ç”¨å³å·¦æ³•åˆ™æ›´å®¹æ˜“è§£é‡Šã€‚</p><p>constä½œç”¨åˆ°å®ƒ<strong>å·¦ä¾§</strong>çš„å…ƒç´ ï¼Œä»…å½“å®ƒæ˜¯æœ€å·¦ä¾§æ—¶ï¼Œæ‰ä½œç”¨åˆ°å³ä¾§çš„å…ƒç´ ã€‚</p></details><p>å¯ä»¥ç”¨<a href="https://cdecl.org/">https://cdecl.org/</a>æ£€æŸ¥ã€‚</p><h2 id="æ•´æ•°æå‡"><a class="header-anchor" href="#æ•´æ•°æå‡">Â¶</a>æ•´æ•°æå‡</h2><p>æ•´æ•°ç±»å‹æœ‰ä¸€ä¸ªæ’åï¼ˆ<code>bool</code>&lt;<code>signed char</code>&lt;<code>short</code>&lt;<code>int</code>&lt;<code>long</code>&lt;<code>long long</code>ï¼Œunsignedä¸å¯¹åº”çš„ä¸€è‡´ï¼‰ã€‚</p><p>å¤§è‡´æ˜¯æŒ‰ç…§å¤§å°æ’åçš„ï¼Œä½†ä¸åŒç±»å‹çš„å¤§å°å…è®¸å­˜åœ¨ç­‰äºçš„æƒ…å†µï¼Œä½†æ’åä¸å­˜åœ¨ã€‚</p><ol><li>æ‰€æœ‰ä½äºintçš„æ•´æ•°ç±»å‹åœ¨è®¡ç®—æ—¶éƒ½ä¼šéšå¼æå‡ä¸ºintï¼ˆå¦‚æœintèƒ½å¤Ÿè¡¨ç¤ºæ‰€æœ‰å–å€¼ï¼‰æˆ–unsigned intã€‚</li><li>å½“æœ‰ç±»å‹é«˜äºintï¼Œå¦ä¸€ä¸ªå°ç±»å‹ä¼šéšå¼æå‡ä¸ºè¯¥å¤§ç±»å‹ï¼ˆæ¯”å¦‚intå’Œunsigned intè®¡ç®—ä¼šç»Ÿä¸€ä¸ºunsigned intç±»å‹ï¼‰ã€‚</li></ol><h2 id="105"><a class="header-anchor" href="#105">Â¶</a>105</h2><h3 id="ä»£ç "><a class="header-anchor" href="#ä»£ç ">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">A</span>() &#123; cout &lt;&lt; <span class="string">&quot;a&quot;</span>; &#125;</span><br><span class="line">  ~<span class="built_in">A</span>() &#123; cout &lt;&lt; <span class="string">&quot;A&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">label:</span><br><span class="line">  A a;</span><br><span class="line">  <span class="keyword">if</span> (i--)</span><br><span class="line">    <span class="keyword">goto</span> label;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º"><a class="header-anchor" href="#è¾“å‡º">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>aAaA</code></p></details><h3 id="åˆ†æ"><a class="header-anchor" href="#åˆ†æ">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>goto</code>æœ¬è´¨å°±æ˜¯è·³è½¬ï¼Œå¯ä»¥æŠŠlabelæ ‡ç­¾åˆ°gotoé—´å½“ä½œä¸€ä¸ªä½œç”¨åŸŸï¼Œå› æ­¤å’Œå¾ªç¯è¯­å¥ç±»ä¼¼ï¼Œç±»aæ˜¯ä¼šåœ¨gotoæ—¶è¿›è¡Œé”€æ¯çš„ã€‚</p><ul><li><p>åœ¨é€€å‡ºä¸€ä¸ªä½œç”¨åŸŸï¼Œå…·æœ‰è‡ªåŠ¨å­˜å‚¨æœŸçš„å¯¹è±¡ä¼šæŒ‰ç…§æ„é€ çš„<strong>ç›¸å</strong>é¡ºåºé”€æ¯ã€‚</p></li><li><p>ä»¥è·³è½¬æ–¹å¼ç¦»å¼€ä½œç”¨åŸŸæ—¶ä¼šåœ¨è·³è½¬<strong>å‰</strong>è¿›è¡Œé”€æ¯ã€‚</p></li></ul><p>è‡ªåŠ¨å­˜å‚¨æœŸï¼šå‡½æ•°ä¸­ä¸ä½¿ç”¨<code>static</code>å®šä¹‰å‡ºæ¥çš„å˜é‡ã€‚</p><ol><li><p>ç¨‹åºåœ¨æ‰§è¡Œåˆ°å¯¹è±¡å£°æ˜æ—¶æ„é€ ç›¸åº”çš„å¯¹è±¡ (<code>int a = 1</code>)ï¼Œåœ¨æ‰§è¡Œåˆ°åŒ…å«è¯¥å£°æ˜çš„ç¨‹åºå—çš„ç»“å°¾æ—¶ææ„è¯¥å¯¹è±¡ (<code>&#125;</code>)ã€‚</p></li><li><p>å¦‚æœä¸æ˜¾å¼åœ°è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™è¯¥å¯¹è±¡çš„åˆå§‹å€¼ä¸ç¡®å®šã€‚</p></li></ol></details><h2 id="217"><a class="header-anchor" href="#217">Â¶</a>217</h2><h3 id="ä»£ç -s2"><a class="header-anchor" href="#ä»£ç -s2">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="type">const</span>&amp; a = i &gt; <span class="number">0</span> ? i : <span class="number">1</span>;</span><br><span class="line">    i = <span class="number">2</span>;</span><br><span class="line">    std::cout &lt;&lt; i &lt;&lt; a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s2"><a class="header-anchor" href="#è¾“å‡º-s2">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>21</code></p></details><h3 id="åˆ†æ-s2"><a class="header-anchor" href="#åˆ†æ-s2">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿™é‡Œå˜é‡aä¸æ˜¯içš„å¼•ç”¨ï¼Œè€Œæ˜¯ä¸‰å…ƒè¡¨è¾¾å¼è¿”å›çš„ä¸´æ—¶å˜é‡çš„å¼•ç”¨ï¼ˆå› ä¸º1æ˜¯ä¸´æ—¶å€¼ï¼‰ã€‚</p><p><code>int const&amp;</code>ç­‰ä»·äº<code>const int&amp;</code>ï¼Œè¿™é‡Œçš„constéƒ½æ˜¯åº•å±‚constï¼ˆä¸æŒ‡é’ˆä¸åŒï¼‰ï¼Œå› ä¸ºå¼•ç”¨æœ¬èº«å°±å…·æœ‰constè¯­ä¹‰ï¼šå¿…é¡»è¢«åˆå§‹åŒ–ä¸”ä¸èƒ½è¢«å†æ¬¡èµ‹å€¼ï¼ˆå³ä½¿æ˜¯ç›¸åŒå€¼ï¼›å‡†ç¡®åœ°è¯´å¼•ç”¨å¯ä»¥è¢«èµ‹å€¼ï¼Œä½†è¯­ä¹‰æ˜¯ä¿®æ”¹å¼•ç”¨çš„å¯¹è±¡çš„å€¼ï¼‰ã€‚</p></details><h2 id="295"><a class="header-anchor" href="#295">Â¶</a>295</h2><h3 id="ä»£ç -s3"><a class="header-anchor" href="#ä»£ç -s3">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> a[<span class="number">2</span>] = <span class="string">&quot;0&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">a_string</span> &#123;</span><br><span class="line">   <span class="built_in">a_string</span>() &#123; *a=<span class="string">&#x27;1&#x27;</span>; &#125;</span><br><span class="line">   ~<span class="built_in">a_string</span>() &#123; *a=<span class="string">&#x27;0&#x27;</span>; &#125;</span><br><span class="line">   <span class="function"><span class="type">const</span> <span class="type">char</span>* <span class="title">c_str</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> a; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* s)</span> </span>&#123; std::cout &lt;&lt; s; &#125;</span><br><span class="line"><span class="function">a_string <span class="title">make_string</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> a_string&#123;&#125;; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   a_string s1 = <span class="built_in">make_string</span>();</span><br><span class="line">   <span class="built_in">print</span>(s1.<span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">   <span class="type">const</span> <span class="type">char</span>* s2 = <span class="built_in">make_string</span>().<span class="built_in">c_str</span>();</span><br><span class="line">   <span class="built_in">print</span>(s2);</span><br><span class="line"></span><br><span class="line">   <span class="built_in">print</span>(<span class="built_in">make_string</span>().<span class="built_in">c_str</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s3"><a class="header-anchor" href="#è¾“å‡º-s3">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>101</code></p></details><h3 id="åˆ†æ-s3"><a class="header-anchor" href="#åˆ†æ-s3">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä¸´æ—¶å˜é‡çš„é”€æ¯ä½œä¸ºæ±‚å€¼åŒ…å«å®ƒçš„<strong>å®Œæ•´è¡¨è¾¾å¼</strong>çš„æœ€åä¸€æ­¥ã€‚</p><p>s1ä¸æ˜¯ä¸´æ—¶å˜é‡ï¼Œåœ¨mainç»“æŸå‰æ‰é”€æ¯ã€‚</p><p>ç¬¬äºŒä¸ªmake_string()äº§ç”Ÿçš„ä¸´æ—¶å˜é‡åœ¨èµ‹å€¼åé”€æ¯ã€‚</p><p>ç¬¬ä¸‰ä¸ªmake_string()åœ¨æ‰“å°åé”€æ¯ã€‚</p></details><h2 id="49"><a class="header-anchor" href="#49">Â¶</a>49</h2><h3 id="ä»£ç -s4"><a class="header-anchor" href="#ä»£ç -s4">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">C</span>(<span class="type">int</span> i) : <span class="built_in">i</span>(i) &#123; std::cout &lt;&lt; i; &#125;</span><br><span class="line">  ~<span class="built_in">C</span>() &#123; std::cout &lt;&lt; i + <span class="number">5</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">const</span> C &amp;c = <span class="built_in">C</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">C</span>(<span class="number">2</span>);</span><br><span class="line">  <span class="built_in">C</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s4"><a class="header-anchor" href="#è¾“å‡º-s4">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>127386</code></p></details><h3 id="åˆ†æ-s4"><a class="header-anchor" href="#åˆ†æ-s4">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œä¸´æ—¶å˜é‡ä¼šåœ¨ç”¨å®Œåç«‹å³é”€æ¯ã€‚é™¤äº†C(1)è¢«ç»‘å®šåˆ°constå¼•ç”¨ä¸Šï¼Œå»¶é•¿äº†ç”Ÿå‘½å‘¨æœŸã€‚</p></details><h2 id="14"><a class="header-anchor" href="#14">Â¶</a>14</h2><h3 id="ä»£ç -s5"><a class="header-anchor" href="#ä»£ç -s5">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">A</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;a&quot;</span>; &#125;</span><br><span class="line">  ~<span class="built_in">A</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;A&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">B</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;b&quot;</span>; &#125;</span><br><span class="line">  ~<span class="built_in">B</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;B&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">C</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;c&quot;</span>; &#125;</span><br><span class="line">  ~<span class="built_in">C</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;C&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">A a;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123; <span class="type">static</span> C c; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  B b;</span><br><span class="line">  <span class="built_in">foo</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s5"><a class="header-anchor" href="#è¾“å‡º-s5">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>abcBCA</code></p></details><h3 id="åˆ†æ-s5"><a class="header-anchor" href="#åˆ†æ-s5">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å˜é‡aåœ¨å…¨å±€ç©ºé—´å£°æ˜ï¼Œæ˜¯é™æ€çš„ã€‚å…¶åŠ¨æ€åˆå§‹åŒ–å¯èƒ½åœ¨mainä¹‹å‰å®Œæˆï¼Œä¹Ÿå¯èƒ½åœ¨mainä¸­è°ƒç”¨ä»»ä½•å‡½æ•°å‰æˆ–è€…è¢«ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶å®Œæˆï¼ˆè¿™æ˜¯å®ç°å®šä¹‰çš„ï¼‰ã€‚</p><p>å±€éƒ¨è‡ªåŠ¨å˜é‡åœ¨å®šä¹‰åŸŸç»“æŸå‰é”€æ¯ï¼ˆæ³¨æ„å’Œä¸´æ—¶å˜é‡çš„åŒºåˆ«ï¼‰ã€‚</p><p>å‡½æ•°å†…çš„é™æ€å˜é‡åˆ™åœ¨ç¬¬ä¸€æ¬¡ç»è¿‡å®ƒæ˜¯è¢«æ„é€ ã€‚</p><p>æœ€åæ‰€æœ‰é™æ€å˜é‡æŒ‰ç…§åˆå§‹åŒ–çš„<strong>ç›¸å</strong>é¡ºåºè¿›è¡Œé”€æ¯ã€‚</p></details><h2 id="148"><a class="header-anchor" href="#148">Â¶</a>148</h2><h3 id="ä»£ç -s6"><a class="header-anchor" href="#ä»£ç -s6">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">int</span> a;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cout &lt;&lt; (a + a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s6"><a class="header-anchor" href="#è¾“å‡º-s6">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªå®šä¹‰è¡Œä¸º</p></details><h3 id="åˆ†æ-s6"><a class="header-anchor" href="#åˆ†æ-s6">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>åœ¨è¯»å–volatileå˜é‡æ—¶ï¼Œå®ƒçš„å€¼å¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚</p><p>åœ¨è®¡ç®—è¡¨è¾¾å¼æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®šï¼ˆé€»è¾‘è¿ç®—ç¬¦çš„çŸ­è·¯ï¼‰ï¼Œè¿ç®—é¡ºåºæ˜¯æœªå®šä¹‰çš„ã€‚</p><p>ä¿®æ”¹çš„å†™æ³•æ˜¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> tmp = a;</span><br><span class="line">  <span class="comment">// do stuff with tmp</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h2 id="252"><a class="header-anchor" href="#252">Â¶</a>252</h2><h3 id="ä»£ç -s7"><a class="header-anchor" href="#ä»£ç -s7">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="string">&#x27;3&#x27;</span> - <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">    std::cout &lt;&lt; i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s7"><a class="header-anchor" href="#è¾“å‡º-s7">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>1</code></p></details><h3 id="åˆ†æ-s7"><a class="header-anchor" href="#åˆ†æ-s7">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>basic source character setï¼šåŸºæœ¬æºå­—ç¬¦é›†ï¼ŒC++ç¼–ç¨‹è¯­è¨€ä¸­å…è®¸åœ¨æºä»£ç ä¸­ä½¿ç”¨çš„æœ€åŸºæœ¬çš„å­—ç¬¦é›†</p><p>basic execution character setï¼šåŸºæœ¬æ‰§è¡Œå­—ç¬¦é›†ï¼ŒC++ç¼–ç¨‹è¯­è¨€ä¸­ç”¨äºæ‰§è¡Œç¨‹åºæ—¶ï¼Œè®¡ç®—æœºç³»ç»Ÿå¿…é¡»æ”¯æŒçš„æœ€åŸºæœ¬çš„å­—ç¬¦é›†</p><p>è™½ç„¶å¤§éƒ¨åˆ†æƒ…å†µé‡‡ç”¨ASCIIç¼–ç ï¼Œä½†C++ä¹Ÿå…è®¸å…¶å®ƒç¼–ç ï¼Œä¹Ÿå°±æ˜¯è¯´â€™Aâ€™ã€â€˜1â€™è¿™äº›å­—ç¬¦çš„å–å€¼éƒ½æ˜¯ä¸ç¡®å®šçš„ï¼Œä½†æ˜¯æ•°å­—å­—ç¬¦é—´çš„å·®å€¼æ˜¯æ ‡å‡†å®šä¹‰ï¼Œä½†å­—æ¯å­—ç¬¦é—´çš„å·®å€¼å¹¶æ²¡æœ‰å®šä¹‰ï¼Œä¹Ÿå°±æ˜¯è¯´â€™Bâ€™-'Aâ€™ä¸ä¸€å®šç­‰äº1ã€‚</p></details><h2 id="107"><a class="header-anchor" href="#107">Â¶</a>107</h2><h3 id="ä»£ç -s8"><a class="header-anchor" href="#ä»£ç -s8">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">()</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;f&quot;</span>; <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">g</span><span class="params">()</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;g&quot;</span>; <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">h</span><span class="params">(std::vector&lt;<span class="type">int</span>&gt; v)</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">h</span>(&#123;<span class="built_in">f</span>(), <span class="built_in">g</span>()&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s8"><a class="header-anchor" href="#è¾“å‡º-s8">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>fg</code></p></details><h3 id="åˆ†æ-s8"><a class="header-anchor" href="#åˆ†æ-s8">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>åˆå§‹åŒ–åˆ—è¡¨çš„æ±‚å€¼é¡ºåºæŒ‰ç…§å‡ºç°é¡ºåºï¼ˆå³ä»å·¦åˆ°å³ï¼‰ã€‚</p><p>ä½†æ˜¯å‡½æ•°å‚æ•°çš„æ±‚å€¼é¡ºåºæ˜¯æœªæŒ‡å®šçš„ï¼Œä¾å®ç°å®šä¹‰çš„ï¼Œæ¯”å¦‚<code>h(f(), g())</code>å¯èƒ½æ˜¯<code>fg</code>ï¼Œä¹Ÿå¯èƒ½æ˜¯<code>gf</code>ï¼Œç”šè‡³å¯ä»¥ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¯<code>fg</code>ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨æ˜¯<code>gf</code>ï¼ˆ<a href="https://cppquiz.org/quiz/question/192">#192</a>ï¼‰ã€‚</p></details><h2 id="229"><a class="header-anchor" href="#229">Â¶</a>229</h2><h3 id="ä»£ç -s9"><a class="header-anchor" href="#ä»£ç -s9">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> f = [](<span class="type">int</span> b) &#123; <span class="keyword">return</span> a + b; &#125;;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="built_in">f</span>(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s9"><a class="header-anchor" href="#è¾“å‡º-s9">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>5</code></p></details><h3 id="åˆ†æ-s9"><a class="header-anchor" href="#åˆ†æ-s9">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>lambdaè¡¨è¾¾å¼å¯ä»¥åœ¨ä¸æ•è·çš„æƒ…å†µä¸‹ä½¿ç”¨ä¸€ä¸ªéå±€éƒ¨å˜é‡ã€é™æ€å˜é‡ã€çº¿ç¨‹å±€éƒ¨å˜é‡æˆ–è¢«å¸¸é‡è¡¨è¾¾å¼åˆå§‹åŒ–è¿‡çš„å¼•ç”¨ã€‚</p><p>åªæœ‰è‡ªåŠ¨å˜é‡å’ŒthisæŒ‡é’ˆéœ€è¦åœ¨æ•è·åˆ—è¡¨ä¸­å£°æ˜ã€‚</p></details><h2 id="38"><a class="header-anchor" href="#38">Â¶</a>38</h2><h3 id="ä»£ç -s10"><a class="header-anchor" href="#ä»£ç -s10">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">decltype</span>((a)) b = a;</span><br><span class="line">  b++;</span><br><span class="line">  std::cout &lt;&lt; a &lt;&lt; b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s10"><a class="header-anchor" href="#è¾“å‡º-s10">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>11</code></p></details><h3 id="åˆ†æ-s10"><a class="header-anchor" href="#åˆ†æ-s10">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿™é‡Œçš„å‚æ•°è¢«æ‹¬å·åŒ…è£¹ï¼Œä¸”æ˜¯å·¦å€¼ï¼Œæ‰€ä»¥è¿”å›å…¶å¼•ç”¨ç±»å‹ã€‚</p></details><h2 id="283"><a class="header-anchor" href="#283">Â¶</a>283</h2><h3 id="ä»£ç -s11"><a class="header-anchor" href="#ä»£ç -s11">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">show_id</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~<span class="built_in">show_id</span>() &#123; std::cout &lt;&lt; id; &#125;</span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">delete</span>[] <span class="keyword">new</span> show_id[<span class="number">3</span>]&#123; &#123;<span class="number">0</span>&#125;, &#123;<span class="number">1</span>&#125;, &#123;<span class="number">2</span>&#125; &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s11"><a class="header-anchor" href="#è¾“å‡º-s11">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>210</code></p></details><h3 id="åˆ†æ-s11"><a class="header-anchor" href="#åˆ†æ-s11">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>åœ¨C++ä¸­ï¼Œå¯¹è±¡çš„é”€æ¯æŒ‰ç…§æ„é€ æ—¶çš„<strong>ç›¸å</strong>é¡ºåºè¿›è¡Œï¼Œ<code>delete[]</code>ä¹Ÿä¸ä¾‹å¤–ã€‚</p></details><h2 id="18"><a class="header-anchor" href="#18">Â¶</a>18</h2><h3 id="ä»£ç -s12"><a class="header-anchor" href="#ä»£ç -s12">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;A&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> : <span class="keyword">public</span> A &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;B&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">g</span><span class="params">(A &amp;a)</span> </span>&#123; a.<span class="built_in">f</span>(); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  B b;</span><br><span class="line">  <span class="built_in">g</span>(b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s12"><a class="header-anchor" href="#è¾“å‡º-s12">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>B</code></p></details><h3 id="åˆ†æ-s12"><a class="header-anchor" href="#åˆ†æ-s12">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å¤šæ€ã€‚</p><p>æ³¨æ„åˆ°è™½ç„¶ç±»Bçš„å‡½æ•°f()æ˜¯ç§æœ‰çš„ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥è¢«è°ƒç”¨ï¼Œå› ä¸ºè®¿é—®æƒé™åœ¨è°ƒç”¨ç‚¹å¤„è¢«æ£€æŸ¥ã€‚</p></details><h2 id="225"><a class="header-anchor" href="#225">Â¶</a>225</h2><h3 id="ä»£ç -s13"><a class="header-anchor" href="#ä»£ç -s13">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X</span> &#123;</span><br><span class="line">    <span class="built_in">X</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;1&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">X</span>(<span class="type">const</span> X &amp;) &#123; std::cout &lt;&lt; <span class="string">&quot;3&quot;</span>; &#125;</span><br><span class="line">    ~<span class="built_in">X</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;2&quot;</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;4&quot;</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125; object;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">X</span>(object);</span><br><span class="line">    object.<span class="built_in">f</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s13"><a class="header-anchor" href="#è¾“å‡º-s13">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>11422</code></p></details><h3 id="åˆ†æ-s13"><a class="header-anchor" href="#åˆ†æ-s13">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿™é‡Œçš„å…³é”®æ˜¯<code>X(object)</code>ï¼Œè¿™å¯ä»¥çœ‹ä½œæ˜¯äº§ç”Ÿäº†ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å£°æ˜äº†ä¸€ä¸ªå˜é‡objectï¼ˆç­‰ä»·äº<code>X object</code>ï¼‰ã€‚è¯­æ³•è§„å®šå½“ä½œå£°æ˜è¯­å¥ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶åˆ›å»ºäº†ä¸€ä¸ªå±€éƒ¨å˜é‡objectï¼Œæ©ç›–äº†å…¨å±€å˜é‡objectã€‚</p></details><h2 id="187"><a class="header-anchor" href="#187">Â¶</a>187</h2><h3 id="ä»£ç -s14"><a class="header-anchor" href="#ä»£ç -s14">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">C</span> &#123;</span><br><span class="line">  <span class="built_in">C</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;1&quot;</span>; &#125;</span><br><span class="line">  <span class="built_in">C</span>(<span class="type">const</span> C&amp; other) &#123; std::cout &lt;&lt; <span class="string">&quot;2&quot;</span>; &#125;</span><br><span class="line">  C&amp; <span class="keyword">operator</span>=(<span class="type">const</span> C&amp; other) &#123; std::cout &lt;&lt; <span class="string">&quot;3&quot;</span>; <span class="keyword">return</span> *<span class="keyword">this</span>;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  C c1;</span><br><span class="line">  C c2 = c1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s14"><a class="header-anchor" href="#è¾“å‡º-s14">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>12</code></p></details><h3 id="åˆ†æ-s14"><a class="header-anchor" href="#åˆ†æ-s14">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>åˆå§‹åŒ–åªä¼šé€‰æ‹©æ„é€ å‡½æ•°ã€‚</p></details><h2 id="254"><a class="header-anchor" href="#254">Â¶</a>254</h2><h3 id="ä»£ç -s15"><a class="header-anchor" href="#ä»£ç -s15">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;type_traits&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; std::is_same_v&lt;</span><br><span class="line">        <span class="built_in">void</span>(<span class="type">int</span>),</span><br><span class="line">        <span class="built_in">void</span>(<span class="type">const</span> <span class="type">int</span>)&gt;;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; std::is_same_v&lt;</span><br><span class="line">        <span class="built_in">void</span>(<span class="type">int</span>*),</span><br><span class="line">        <span class="built_in">void</span>(<span class="type">const</span> <span class="type">int</span>*)&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s15"><a class="header-anchor" href="#è¾“å‡º-s15">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>10</code></p></details><h3 id="åˆ†æ-s15"><a class="header-anchor" href="#åˆ†æ-s15">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å‡½æ•°å‚æ•°çš„é¡¶å±‚cvé™å®šç¬¦åœ¨å‡½æ•°ç±»å‹ä¸Šä¼šè¢«ç§»é™¤ï¼Œå› ä¸ºä¼ å‚ä¼šå‘ç”Ÿæ‹·è´ï¼Œä¸€å®šä¸ä¼šä¿®æ”¹åŸæ¥çš„å˜é‡ï¼ˆconstä¸å¦æ²¡æœ‰åŒºåˆ«ï¼‰ã€‚</p></details><h2 id="244"><a class="header-anchor" href="#244">Â¶</a>244</h2><h3 id="ä»£ç -s16"><a class="header-anchor" href="#ä»£ç -s16">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="built_in">static_assert</span>(<span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s16"><a class="header-anchor" href="#è¾“å‡º-s16">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªå®šä¹‰è¡Œä¸º</p></details><h3 id="åˆ†æ-s16"><a class="header-anchor" href="#åˆ†æ-s16">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>static_assert</code>åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå¸¸é‡0æ—¶ï¼Œæ°¸è¿œæ˜¯é”™è¯¯çš„ï¼Œä¸”æ— éœ€è¯Šæ–­ï¼ˆâ€œill-formed, no diagnostic requiredâ€ï¼Œç¼–è¯‘å™¨å¯ä»¥ä¸å‘å‡ºä»»ä½•è¯Šæ–­å’Œé”™è¯¯æ¶ˆæ¯ï¼Œå› ä¸ºè¿™è¿˜ä¼šä½¿å¾—ç¼–è¯‘æ—¶é—´å˜é•¿ï¼‰ï¼Œä¹Ÿå°±æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼ˆâ€œundefine behaviorâ€ï¼‰ï¼Œå³ä½¿æ˜¯åœ¨æ²¡æœ‰å®ä¾‹åŒ–çš„æ¨¡æ¿å‡½æ•°ä¸­ã€‚</p><p>ä½†äº‹å®ä¸Šï¼Œæœ€æ–°çš„gccã€clangã€msvcéƒ½ä¼šæŠ¥å‘Šç¼–è¯‘é”™è¯¯ã€‚</p></details><h2 id="354"><a class="header-anchor" href="#354">Â¶</a>354</h2><h3 id="ä»£ç -s17"><a class="header-anchor" href="#ä»£ç -s17">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">S</span> &#123;</span><br><span class="line">    <span class="type">char</span> s;</span><br><span class="line">    <span class="built_in">S</span>(<span class="type">char</span> s): s&#123;s&#125; &#123;&#125;</span><br><span class="line">    ~<span class="built_in">S</span>() &#123; std::cout &lt;&lt; s; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">S <span class="title">a</span><span class="params">(<span class="string">&#x27;a&#x27;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">S <span class="title">b</span><span class="params">(<span class="string">&#x27;b&#x27;</span>)</span></span>;</span><br><span class="line">    std::<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s17"><a class="header-anchor" href="#è¾“å‡º-s17">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>a</code></p></details><h3 id="åˆ†æ-s17"><a class="header-anchor" href="#åˆ†æ-s17">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>std::exit</code>åªä¼šä¸ºå…·æœ‰é™æ€å­˜å‚¨æœŸçš„å¯¹è±¡è°ƒç”¨ææ„ï¼Œè€Œä¸ä¼šä¸ºå±€éƒ¨å˜é‡è°ƒç”¨ææ„ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨mainä¸­ï¼Œä½¿ç”¨exitå’Œreturnæ˜¯æœ‰åŒºåˆ«çš„ï¼Œé€šå¸¸returnæ›´å¥½ï¼ˆé¦–å…ˆæ›´åŠ ç›´è§‚ï¼Œå…¶æ¬¡å®ƒä¼šæ­£ç¡®åœ°ææ„å±€éƒ¨å˜é‡ï¼ˆä½†<code>exit</code>ä¼¼ä¹ä¼šæ­£ç¡®å…³é—­æ–‡ä»¶æŒ‡é’ˆå’Œæµï¼›å¦è§<a href="https://stackoverflow.com/a/461528">https://stackoverflow.com/a/461528</a>ï¼‰ã€‚</p><p>æ­¤å¤–ï¼Œåœ¨<code>exit</code>ä¸­è¿˜ä¼šé€†åºè°ƒç”¨é€šè¿‡<code>atexit(void (*fcn)(void))</code>æ³¨å†Œçš„å‡½æ•°ã€‚</p></details><h2 id="16"><a class="header-anchor" href="#16">Â¶</a>16</h2><h3 id="ä»£ç -s18"><a class="header-anchor" href="#ä»£ç -s18">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">A</span>() &#123; std::cout &lt;&lt; <span class="string">&#x27;a&#x27;</span>; &#125;</span><br><span class="line">  ~<span class="built_in">A</span>() &#123; std::cout &lt;&lt; <span class="string">&#x27;A&#x27;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">B</span>() &#123; std::cout &lt;&lt; <span class="string">&#x27;b&#x27;</span>; &#125;</span><br><span class="line">  ~<span class="built_in">B</span>() &#123; std::cout &lt;&lt; <span class="string">&#x27;B&#x27;</span>; &#125;</span><br><span class="line">  A a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; B b; &#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s18"><a class="header-anchor" href="#è¾“å‡º-s18">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>abBA</code></p></details><h3 id="åˆ†æ-s18"><a class="header-anchor" href="#åˆ†æ-s18">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å…ˆæ„é€ ç±»æˆå‘˜å˜é‡ï¼Œå†è°ƒç”¨æ„é€ å‡½æ•°ã€‚</p><p>å…ˆè°ƒç”¨ææ„å‡½æ•°ï¼Œå†ææ„ç±»æˆå‘˜å˜é‡ã€‚</p><p>åŒæ ·éµå¾ªææ„å’Œæ„é€ é¡ºåºç›¸åè¿™ä¸€ç‰¹å¾ã€‚</p></details><h2 id="281"><a class="header-anchor" href="#281">Â¶</a>281</h2><h3 id="ä»£ç -s19"><a class="header-anchor" href="#ä»£ç -s19">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">C</span>()&#123;&#125;</span><br><span class="line">    <span class="built_in">C</span>(<span class="type">const</span> C&amp;)&#123;&#125; <span class="comment">//User-declared, disables move constructor</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    C c;</span><br><span class="line">    <span class="function">C <span class="title">c2</span><span class="params">(std::move(c))</span></span>;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s19"><a class="header-anchor" href="#è¾“å‡º-s19">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>ok</code></p></details><h3 id="åˆ†æ-s19"><a class="header-anchor" href="#åˆ†æ-s19">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å¦‚æœç±»Xæ²¡æœ‰æ˜¾ç¤ºå®šä¹‰ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä¸”Xä¸åŒ…å«ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œåˆ™ä¼šéšå¼å®šä¹‰ä¸€ä¸ªé»˜è®¤çš„ç‰ˆæœ¬ã€‚</p><p>ä¼šåœ¨æ‰€æœ‰æ„é€ å‡½æ•°ä¸­è¿›è¡Œé‡è½½å†³ç­–ï¼Œå½“ç„¶åœ¨è¿™é‡Œï¼Œç§»åŠ¨æ„é€ è‚¯å®šä¼˜äºæ‹·è´æ„é€ ã€‚</p><p>åœ¨æ²¡æœ‰ç§»åŠ¨æ„é€ çš„æƒ…å†µä¸‹ï¼Œæ‹·è´æ„é€ ä¹Ÿæ˜¯å¯ä»¥é€‰æ‹©çš„ã€‚</p></details><h2 id="minmax"><a class="header-anchor" href="#minmax">Â¶</a>minmax</h2><h3 id="ä»£ç -s20"><a class="header-anchor" href="#ä»£ç -s20">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> [mn, mx] = std::<span class="built_in">minmax</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s20"><a class="header-anchor" href="#è¾“å‡º-s20">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªå®šä¹‰è¡Œä¸º</p></details><h3 id="åˆ†æ-s20"><a class="header-anchor" href="#åˆ†æ-s20">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿™é‡Œmnå’Œmxéƒ½æ˜¯æ‚¬æŒ‚å¼•ç”¨ã€‚</p><p>é¦–å…ˆminmaxçš„å‡½æ•°åŸå‹æ˜¯<code>std::pair&lt;const T&amp;, const T&amp;&gt; std::minmax(const T&amp;, const T&amp;)</code>ï¼Œç”±äºpairçš„åŸå› ï¼Œåœ¨è‡ªåŠ¨æ¨å¯¼åï¼Œmnå’Œmxçš„ç±»å‹éƒ½æ˜¯<code>const int&amp;</code>ï¼Œä½†æ˜¯ä¼ å…¥çš„1å’Œ2è¢«åˆ†åˆ«ç»‘å®šåˆ°å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°ä¸Šä¹‹åï¼Œä¼šåœ¨å‡½æ•°ç»“æŸæ—¶é”€æ¯ã€‚</p><p>è¿™é‡Œæ¶‰åŠåˆ°ç”Ÿå‘½å‘¨æœŸå»¶é•¿çš„æ¦‚å¿µï¼ˆlifetime extesionï¼‰ï¼š</p><blockquote><ol><li>The lifetime of a temporary object may be extended by binding to a reference.</li><li>A temporary bound to a return value of a function in a return statement is <strong>not</strong> extended: it is destroyed immediately at the end of the return expression. Such return statement always returns a dangling reference.</li><li>A temporary bound to a reference parameter in a function call exists until the end of the full expression containing that function call: if the function returns a reference, which outlives the full expression, it becomes a dangling reference.</li></ol></blockquote><p>åŒç†ï¼Œ<code>const int&amp; x = std::min(1, 2)</code>ä¹Ÿæ˜¯æœªå®šä¹‰çš„ï¼Œä¸è¿‡<code>auto x</code>æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºæ­¤æ—¶ä¼šæ¨å¯¼ä¸º<code>const int</code>ã€‚</p><p>å¦è§<a href="https://stackoverflow.com/questions/17362673/temporary-lifetime-extension">https://stackoverflow.com/questions/17362673/temporary-lifetime-extension</a>ã€‚</p></details><h2 id="132"><a class="header-anchor" href="#132">Â¶</a>132</h2><h3 id="ä»£ç -s21"><a class="header-anchor" href="#ä»£ç -s21">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  cout &lt;&lt; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bar</span><span class="params">(<span class="type">int</span> i = foo())</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">bar</span>();</span><br><span class="line">  <span class="built_in">bar</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s21"><a class="header-anchor" href="#è¾“å‡º-s21">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>11</code></p></details><h3 id="åˆ†æ-s21"><a class="header-anchor" href="#åˆ†æ-s21">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>é»˜è®¤å‚æ•°ä¼šåœ¨æ¯æ¬¡è°ƒç”¨æ—¶ä¸”ä¸æä¾›è¯¥å‚æ•°çš„æƒ…å†µä¸‹è®¡ç®—ä¸€éã€‚</p></details><h2 id="264"><a class="header-anchor" href="#264">Â¶</a>264</h2><h3 id="ä»£ç -s22"><a class="header-anchor" href="#ä»£ç -s22">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">C</span> &#123;</span><br><span class="line">    <span class="built_in">C</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> C c;</span><br><span class="line">    std::cout &lt;&lt; c.i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s22"><a class="header-anchor" href="#è¾“å‡º-s22">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç¼–è¯‘é”™è¯¯</p></details><h3 id="åˆ†æ-s22"><a class="header-anchor" href="#åˆ†æ-s22">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç±»Cå¿…é¡»æ»¡è¶³å¸¸é‡å¯æ„é€ æ€§ã€‚</p><ol><li>ä¼šè°ƒç”¨ç”¨æˆ·æä¾›çš„æ„é€ å‡½æ•°ï¼ˆuser-providedï¼‰</li><li>æ¯ä¸ªévariantï¼Œéé™æ€çš„æˆå‘˜ä¼šé»˜è®¤åˆå§‹åŒ–æˆ–è€…å¯¹äºç±»ï¼Œåˆ™æ˜¯å¸¸é‡å¯æ„é€ çš„</li><li>â€¦</li></ol><p><code>C::C() = default</code>æ˜¯user-providedï¼Œ<code>C() = default</code>æ˜¯user-declaredï¼Œè€Œ<code>C() = default</code>åˆ™ä¼šæ˜¯é»˜è®¤çš„æ„é€ å‡½æ•°</p></details><h2 id="284"><a class="header-anchor" href="#284">Â¶</a>284</h2><h3 id="ä»£ç -s23"><a class="header-anchor" href="#ä»£ç -s23">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">main</span><span class="params">()</span> -&gt; <span class="type">int</span> </span>&#123;</span><br><span class="line">  std::string out&#123;<span class="string">&quot;Hello world&quot;</span>&#125;;</span><br><span class="line">  std::cout &lt;&lt; (out[out.<span class="built_in">size</span>()] == <span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s23"><a class="header-anchor" href="#è¾“å‡º-s23">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>1</code></p></details><h3 id="åˆ†æ-s23"><a class="header-anchor" href="#åˆ†æ-s23">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æ ‡å‡†æ˜ç¡®è§„å®šäº†åœ¨<code>pos=size()</code>æ—¶è¿”å›ä¸€ä¸ªcharT()ï¼ˆå€¼åˆå§‹åŒ–ä¸º0ï¼Œç­‰äº<code>'\0'</code>ï¼‰ï¼Œä½†ä¿®æ”¹è¯¥å¯¹è±¡æ˜¾ç„¶æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</p></details><h2 id="195"><a class="header-anchor" href="#195">Â¶</a>195</h2><h3 id="ä»£ç -s24"><a class="header-anchor" href="#ä»£ç -s24">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstddef&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;type_traits&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cout &lt;&lt; std::is_pointer_v&lt;<span class="keyword">decltype</span>(<span class="literal">nullptr</span>)&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s24"><a class="header-anchor" href="#è¾“å‡º-s24">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>0</code></p></details><h3 id="åˆ†æ-s24"><a class="header-anchor" href="#åˆ†æ-s24">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>nullptræ˜¯<code>std::nullptr_t</code>ç±»å‹ï¼Œè¿™ä¸æ˜¯æŒ‡é’ˆç±»å‹ï¼Œè€Œæ˜¯ç©ºæŒ‡é’ˆå¸¸é‡ï¼Œå¯ä»¥è½¬åŒ–ä¸ºæŒ‡é’ˆã€‚</p><p><code>(int*)nullptr</code>æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆå€¼ï¼Œ<code>(int some_class::*)nullptr</code>æ˜¯ä¸€ä¸ªç©ºæˆå‘˜æŒ‡é’ˆå€¼ã€‚</p></details><h2 id="236"><a class="header-anchor" href="#236">Â¶</a>236</h2><h3 id="ä»£ç -s25"><a class="header-anchor" href="#ä»£ç -s25">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Foo</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">operator</span> <span class="title">auto</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;A&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> a = <span class="built_in">Foo</span>();</span><br><span class="line">  std::cout &lt;&lt; a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s25"><a class="header-anchor" href="#è¾“å‡º-s25">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>A1</code></p></details><h3 id="åˆ†æ-s25"><a class="header-anchor" href="#åˆ†æ-s25">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è½¬æ¢å‡½æ•°ä¸éœ€è¦å†™è¿”å›ç±»å‹ï¼ˆå› ä¸ºå®ƒçš„åå­—å°±æ˜¯ï¼‰ï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡<code>auto</code>çš„æ–¹å¼è¿›è¡Œæ¨å¯¼ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªåä¸ºautoçš„è½¬åŒ–å‡½æ•°ï¼Œè€Œæ˜¯ä¼šè¢«æ¨åˆ°ä¸º<code>operator int()</code>ã€‚</p></details><h2 id="118"><a class="header-anchor" href="#118">Â¶</a>118</h2><h3 id="ä»£ç -s26"><a class="header-anchor" href="#ä»£ç -s26">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">char</span> <span class="type">const</span> *str)</span> </span>&#123; std::cout &lt;&lt; str; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">short</span> num)</span> </span>&#123; std::cout &lt;&lt; num; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;abc&quot;</span>);</span><br><span class="line">  <span class="built_in">print</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s26"><a class="header-anchor" href="#è¾“å‡º-s26">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç¼–è¯‘é”™è¯¯</p></details><h3 id="åˆ†æ-s26"><a class="header-anchor" href="#åˆ†æ-s26">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>0å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªç©ºæŒ‡é’ˆå¸¸é‡ï¼Œç„¶åè¢«è½¬æ¢ä¸ºä¸€ä¸ªæŒ‡é’ˆç±»å‹ã€‚</p><p>0é»˜è®¤æ˜¯intç±»å‹ï¼Œä¹Ÿéœ€è¦è½¬æ¢ä¸ºshortç±»å‹ã€‚</p><p>å› æ­¤å¯¹äº<code>print(0)</code>ï¼Œé‡è½½å†³ç­–æ— æ³•åˆ¤æ–­å“ªä¸ªå‡½æ•°æ›´ä¼˜ã€‚</p><p>ç©ºæŒ‡é’ˆå¸¸é‡æ˜¯å€¼ä¸º0çš„æ•´æ•°æˆ–è€…std::nullptrã€‚</p></details><h2 id="307"><a class="header-anchor" href="#307">Â¶</a>307</h2><h3 id="ä»£ç -s27"><a class="header-anchor" href="#ä»£ç -s27">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">S</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">S</span>() = <span class="keyword">delete</span>;</span><br><span class="line">  <span class="type">int</span> x;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> s = S&#123;&#125;;</span><br><span class="line">  std::cout &lt;&lt; s.x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s27"><a class="header-anchor" href="#è¾“å‡º-s27">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>0</p></details><h3 id="åˆ†æ-s27"><a class="header-anchor" href="#åˆ†æ-s27">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä¸€ä¸ªå‡½æ•°æ˜¯user-providedï¼Œå¦‚æœå®ƒæ˜¯user-declaredï¼Œä¸”æ²¡æœ‰åœ¨å®ƒ<strong>ç¬¬ä¸€æ¬¡å£°æ˜</strong>æ—¶æ˜¾ç¤ºåœ°defaultæˆ–deleteã€‚</p><p>Sæ˜¯ä¸€ä¸ªèšåˆç±»å‹ï¼ˆaggregateï¼‰ï¼Œ<code>S&#123;&#125;</code>ä½¿ç”¨çš„æ˜¯èšåˆåˆå§‹åŒ–ï¼Œè€Œä¸æ˜¯æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”åˆå§‹åŒ–åˆ—è¡¨ä¸­æ²¡æœ‰å¯¹åº”çš„å…ƒç´ ä¼šè¢«å€¼åˆå§‹åŒ–ã€‚</p><p>æ³¨ï¼šåœ¨C++20ä¸­ï¼Œaggregateçš„æ¦‚å¿µä»no user-providedæ”¹ä¸ºno user-declaredï¼ŒSä¸å†æ˜¯èšåˆç±»å‹ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</p></details><h2 id="25"><a class="header-anchor" href="#25">Â¶</a>25</h2><h3 id="ä»£ç -s28"><a class="header-anchor" href="#ä»£ç -s28">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;limits&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i = std::numeric_limits&lt;<span class="type">int</span>&gt;::<span class="built_in">max</span>();</span><br><span class="line">  std::cout &lt;&lt; ++i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s28"><a class="header-anchor" href="#è¾“å‡º-s28">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªå®šä¹‰è¡Œä¸º</p></details><h3 id="åˆ†æ-s28"><a class="header-anchor" href="#åˆ†æ-s28">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœ‰ç¬¦å·æ•´æ•°æº¢å‡ºæ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</p><p>åªæ˜¯å¾ˆå¤šå®ç°ä¼šé€‰æ‹©wrap aroundï¼ˆå¦‚gccï¼‰ï¼Œæ­¤æ—¶ä¼šå¾—åˆ°<code>std::numeric_limits&lt;int&gt;::min()</code></p></details><h2 id="178"><a class="header-anchor" href="#178">Â¶</a>178</h2><h3 id="ä»£ç -s29"><a class="header-anchor" href="#ä»£ç -s29">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> <span class="type">int</span> a = <span class="number">5</span>,b = <span class="number">2</span>;</span><br><span class="line"> std::cout &lt;&lt; a+++++b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s29"><a class="header-anchor" href="#è¾“å‡º-s29">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç¼–è¯‘é”™è¯¯</p></details><h3 id="åˆ†æ-s29"><a class="header-anchor" href="#åˆ†æ-s29">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æ ¹æ®æœ€é•¿åŒ¹é…ï¼ˆæœ€å¤§å’€åš¼ï¼‰åŸåˆ™ï¼ˆmaximal munch principleï¼‰ï¼Œè¯æ³•åˆ†æå™¨ä¼šé€‰æ‹©æœ€é•¿çš„å­—ç¬¦åºåˆ—ç»„æˆä¸‹ä¸€ä¸ªtokenï¼Œå³ä½¿ä¼šé€ æˆåç»­çš„å¤±è´¥ã€‚</p><p>æ³¨ï¼šè¿™å…¶å®æ˜¯ä¸ºäº†è§£å†³æ­£åˆ™è¡¨è¾¾å¼å›ºæœ‰çš„æ­§ä¹‰é—®é¢˜ï¼ˆå¦‚<code>[a-z]+</code>ï¼‰</p><p>è¿™é‡Œä¼šåˆ†è§£ä¸º<code>a ++ ++ + b</code>ï¼Œ<code>a++</code>ä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶çš„å³å€¼ï¼Œä¸å†èƒ½è¢«ç»§ç»­åç½®é€’å¢ã€‚</p><p>åŒç†<code>x=y/*z</code>ä¹Ÿä¼šç¼–è¯‘é”™è¯¯ï¼Œè¿™é‡Œä¼šåˆ†è§£å‡º<code>/*</code>ï¼Œè®¤ä¸ºæ˜¯å—æ³¨é‡Šçš„èµ·å§‹ã€‚</p><p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨c++11ä¹‹å‰ï¼Œ<code>&gt; &gt;</code>å°–æ‹¬å·ä¹‹é—´è¦åŠ ç©ºæ ¼ã€‚è§£å†³æ–¹æ³•ä¸æ˜¯å¯¹æ­¤è¿›è¡Œç‰¹åˆ¤ï¼Œè€Œæ˜¯å°†å³ç§»<code>&gt;&gt;</code>è§†ä¸º<strong>ä¸€å¯¹</strong>å°–æ‹¬å·ï¼ˆåŒjavaï¼‰ï¼Œè¿™æ ·<code>&gt;&gt;</code>ä¼šåˆ†æˆä¸¤ä¸ªtokenï¼Œä»è€Œèƒ½ç»§ç»­ä½¿ç”¨æœ€é•¿åŒ¹é…åŸåˆ™ã€‚</p></details><h2 id="42"><a class="header-anchor" href="#42">Â¶</a>42</h2><h3 id="ä»£ç -s30"><a class="header-anchor" href="#ä»£ç -s30">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;initializer_list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="built_in">A</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;1&quot;</span>; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">A</span>(<span class="type">int</span>) &#123; std::cout &lt;&lt; <span class="string">&quot;2&quot;</span>; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">A</span>(std::initializer_list&lt;<span class="type">int</span>&gt;) &#123; std::cout &lt;&lt; <span class="string">&quot;3&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">  A a1;</span><br><span class="line">  A a2&#123;&#125;;</span><br><span class="line">  A a3&#123; <span class="number">1</span> &#125;;</span><br><span class="line">  A a4&#123; <span class="number">1</span>, <span class="number">2</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s30"><a class="header-anchor" href="#è¾“å‡º-s30">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>1133</code></p></details><h3 id="åˆ†æ-s30"><a class="header-anchor" href="#åˆ†æ-s30">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>a1é»˜è®¤åˆå§‹åŒ–ã€‚</p><p>åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸ºç©ºï¼Œä¸”æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼ˆå³å¯ä»¥åœ¨æ— å‚æ•°çš„æƒ…å†µä¸‹è°ƒç”¨ï¼‰æ—¶ï¼Œä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°ã€‚</p><p>åœ¨å…¶ä½™æƒ…å†µä¸‹ï¼Œåˆå§‹åŒ–åˆ—è¡¨çš„æ„é€ å‡½æ•°æ€»æ˜¯æœ€å…ˆè¢«é€‰æ‹©ï¼Œåœ¨æ²¡æœ‰æ—¶æ‰ä¼šè€ƒè™‘å…¶å®ƒçš„ã€‚</p></details><h2 id="30"><a class="header-anchor" href="#30">Â¶</a>30</h2><h3 id="ä»£ç -s31"><a class="header-anchor" href="#ä»£ç -s31">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X</span> &#123;</span><br><span class="line">  <span class="built_in">X</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;X&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; <span class="function">X <span class="title">x</span><span class="params">()</span></span>; &#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s31"><a class="header-anchor" href="#è¾“å‡º-s31">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>no output</p></details><h3 id="åˆ†æ-s31"><a class="header-anchor" href="#åˆ†æ-s31">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>X x()</code>æ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜ï¼ˆEmpty parenthese interpreted as a function declarationï¼‰ã€‚</p></details><h2 id="29"><a class="header-anchor" href="#29">Â¶</a>29</h2><h3 id="ä»£ç -s32"><a class="header-anchor" href="#ä»£ç -s32">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="built_in">A</span>() &#123; <span class="built_in">foo</span>(); &#125;</span><br><span class="line">  <span class="keyword">virtual</span> ~<span class="built_in">A</span>() &#123; <span class="built_in">foo</span>(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;1&quot;</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">bar</span><span class="params">()</span> </span>&#123; <span class="built_in">foo</span>(); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">B</span> : <span class="keyword">public</span> A &#123;</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;2&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  B b;</span><br><span class="line">  b.<span class="built_in">bar</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s32"><a class="header-anchor" href="#è¾“å‡º-s32">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>121</code></p></details><h3 id="åˆ†æ-s32"><a class="header-anchor" href="#åˆ†æ-s32">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>åœ¨Açš„æ„é€ å‡½æ•°ä¸­ï¼ŒBçš„éƒ¨åˆ†è¿˜æ²¡æœ‰è¢«æ„é€ ï¼Œå› æ­¤ä¸ä¼šè°ƒç”¨Bçš„<code>foo</code>ã€‚</p><p>åŒç†ï¼Œåœ¨ææ„å‡½æ•°ï¼ŒBçš„éƒ¨åˆ†å…ˆè¢«ææ„ï¼Œå› æ­¤åœ¨Açš„ææ„å‡½æ•°ä¸­ä¹Ÿä¸ä¼šè°ƒç”¨Bçš„<code>foo</code>ã€‚</p><p>æ€»ç»“ï¼Œæ„é€ å’Œææ„å‡½æ•°ä¸­ä¸ä¼šè€ƒè™‘è™šå‡½æ•°ã€‚</p></details><h2 id="130"><a class="header-anchor" href="#130">Â¶</a>130</h2><h3 id="ä»£ç -s33"><a class="header-anchor" href="#ä»£ç -s33">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adl</span><span class="params">(T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;T&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">S</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">call_adl</span><span class="params">(T t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">adl</span>(<span class="built_in">S</span>());</span><br><span class="line">  <span class="built_in">adl</span>(t);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">adl</span><span class="params">(S)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;S&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">call_adl</span>(<span class="built_in">S</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s33"><a class="header-anchor" href="#è¾“å‡º-s33">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>TS</code></p></details><h3 id="åˆ†æ-s33"><a class="header-anchor" href="#åˆ†æ-s33">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç¬¬ä¸€æ¬¡è°ƒç”¨<code>adl(S())</code>ä¸ä¾èµ–äºæ¨¡æ¿å‚æ•°ï¼Œå› æ­¤åœ¨å®šä¹‰æ—¶å°±è¿›è¡Œåç§°æŸ¥æ‰¾ã€‚</p><p>è€Œç¬¬äºŒæ¬¡è°ƒç”¨<code>adl(t)</code>ä¾èµ–äºæ¨¡æ¿å‚æ•°ï¼Œä¼šå»¶è¿Ÿåˆ°æ¨¡æ¿å®ä¾‹åŒ–æ—¶æ‰è¿›è¡Œåç§°æŸ¥æ‰¾ã€‚</p></details><h2 id="158"><a class="header-anchor" href="#158">Â¶</a>158</h2><h3 id="ä»£ç -s34"><a class="header-anchor" href="#ä»£ç -s34">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Foo</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">Foo</span>() &#123; std::cout&lt;&lt;<span class="string">&quot;a&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">Foo</span>(<span class="type">const</span> Foo&amp;) &#123; std::cout&lt;&lt;<span class="string">&quot;b&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">std::vector&lt;Foo&gt; <span class="title">bar</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s34"><a class="header-anchor" href="#è¾“å‡º-s34">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>aaaaa</code></p></details><h3 id="åˆ†æ-s34"><a class="header-anchor" href="#åˆ†æ-s34">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>åœ¨C++11ä¹‹å‰ä¼šè¾“å‡º<code>bbbbb</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">explicit</span> <span class="title">vector</span><span class="params">( size_type count,</span></span></span><br><span class="line"><span class="params"><span class="function">                 <span class="type">const</span> T&amp; value = T(),</span></span></span><br><span class="line"><span class="params"><span class="function">                 <span class="type">const</span> Allocator&amp; alloc = Allocator() )</span></span>; <span class="comment">// until C++11</span></span><br><span class="line"><span class="built_in">vector</span>( size_type count,</span><br><span class="line">                 <span class="type">const</span> T&amp; value,</span><br><span class="line">                 <span class="type">const</span> Allocator&amp; alloc = <span class="built_in">Allocator</span>() ); <span class="comment">// since C++11</span></span><br></pre></td></tr></table></figure></details><h2 id="193"><a class="header-anchor" href="#193">Â¶</a>193</h2><h3 id="ä»£ç -s35"><a class="header-anchor" href="#ä»£ç -s35">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a[] = &lt;%<span class="number">1</span>%&gt;;</span><br><span class="line">    std::cout &lt;&lt; a&lt;:<span class="number">0</span>:&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s35"><a class="header-anchor" href="#è¾“å‡º-s35">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>1</code></p></details><h3 id="åˆ†æ-s35"><a class="header-anchor" href="#åˆ†æ-s35">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç­‰ä»·äº</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a[] = &#123;<span class="number">1</span>&#125;;</span><br><span class="line">std::cout &lt;&lt; a[<span class="number">0</span>];</span><br></pre></td></tr></table></figure><p>C++æä¾›ä¸ºä¸€äº›æ ‡ç‚¹ç¬¦å·æä¾›äº†æ›¿ä»£çš„tokensï¼Œ<code>&lt;%</code>å’Œ<code>%&gt;</code>åˆ†åˆ«ç­‰ä»·äº<code>&#123;</code>å’Œ<code>&#125;</code>ï¼Œ<code>&lt;:</code>å’Œ<code>:&gt;</code>åˆ†åˆ«ç­‰ä»·äº<code>[</code>å’Œ<code>]</code>ã€‚</p><p>è§<a href="https://timsong-cpp.github.io/cppwp/n4659/lex.digraph#1">https://timsong-cpp.github.io/cppwp/n4659/lex.digraph#1</a>ã€‚</p><p>å…¶å®C++11åŠä»¥å<code>and</code>ç­‰ä»·äº<code>&amp;&amp;</code>ï¼Œå°±å±äºä¸€ç§alternative tokenã€‚</p></details><h2 id="228"><a class="header-anchor" href="#228">Â¶</a>228</h2><h3 id="ä»£ç -s36"><a class="header-anchor" href="#ä»£ç -s36">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ...Ts&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X</span> &#123;</span><br><span class="line">  <span class="built_in">X</span>(Ts ...args) : <span class="built_in">Var</span>(<span class="number">0</span>, args...) &#123;&#125;</span><br><span class="line">  <span class="type">int</span> Var;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  X&lt;&gt; x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s36"><a class="header-anchor" href="#è¾“å‡º-s36">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªå®šä¹‰è¡Œä¸º</p></details><h3 id="åˆ†æ-s36"><a class="header-anchor" href="#åˆ†æ-s36">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å¦‚æœä¸€ä¸ªå¯å˜å‚æ•°æ¨¡æ¿åªåœ¨ç©ºå‚æ•°æ—¶ä¹Ÿæ˜¯åˆæ³•çš„ï¼Œè¿™æ˜¯ill-formed, no diagnostic requiredï¼Œä¸”åœ¨è¿è¡Œæ—¶çš„è¡Œä¸ºæœªå®šä¹‰ã€‚</p></details><h2 id="133"><a class="header-anchor" href="#133">Â¶</a>133</h2><h3 id="ä»£ç -s37"><a class="header-anchor" href="#ä»£ç -s37">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">A</span>() &#123; cout &lt;&lt; <span class="string">&quot;A&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">A</span>(<span class="type">const</span> A &amp;) &#123; cout &lt;&lt; <span class="string">&quot;a&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>: <span class="keyword">public</span> <span class="keyword">virtual</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">B</span>() &#123; cout &lt;&lt; <span class="string">&quot;B&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">B</span>(<span class="type">const</span> B &amp;) &#123; cout&lt;&lt; <span class="string">&quot;b&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>: <span class="keyword">public</span> <span class="keyword">virtual</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">C</span>() &#123; cout&lt;&lt; <span class="string">&quot;C&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">C</span>(<span class="type">const</span> C &amp;) &#123; cout &lt;&lt; <span class="string">&quot;c&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>:B,C</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">D</span>() &#123; cout&lt;&lt; <span class="string">&quot;D&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">D</span>(<span class="type">const</span> D &amp;) &#123; cout &lt;&lt; <span class="string">&quot;d&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    D d1;</span><br><span class="line">    <span class="function">D <span class="title">d2</span><span class="params">(d1)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s37"><a class="header-anchor" href="#è¾“å‡º-s37">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>ABCDABCd</code></p></details><h3 id="åˆ†æ-s37"><a class="header-anchor" href="#åˆ†æ-s37">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å¯¹äº<code>D d1</code>ï¼Œé¡ºåºæ˜¯<code>ABCD</code>ï¼Œä»åŸºç±»å¼€å§‹ï¼Œé¦–å…ˆæ˜¯è™šç»§æ‰¿çš„ç±»æŒ‰ç…§ä»å·¦å¾€å³æ·±åº¦ä¼˜å…ˆçš„é¡ºåºè¿›è¡Œï¼Œç„¶åæ˜¯æ™®é€šç»§æ‰¿çš„ç±»æŒ‰ç…§ä»å·¦å¾€å³çš„é¡ºåºï¼ˆä»å·¦å¾€å³å³ä»£ç å‡ºå‡ºç°çš„é¡ºåºï¼‰ã€‚</p><p>å¯¹äº<code>D d2(d1)</code>ï¼Œéšå¼å®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°ä¼šè°ƒç”¨åŸºç±»çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œä½†æ˜¯è‡ªå®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°ä¸ä¼šã€‚åœ¨<code>D</code>çš„æ‹·è´æ„é€ å‡½æ•°ä¸­æ²¡æœ‰æ˜¾ç¤ºå†™å‡ºï¼Œæ‰€ä»¥è½¬è€Œè°ƒç”¨çš„æ˜¯åŸºç±»çš„æ„é€ å‡½æ•°ã€‚</p><p>è™šç»§æ‰¿ï¼šä¸ºè§£å†³å¤šé‡ç»§æ‰¿è€Œå‡ºç°ï¼ˆé¿å…è±å½¢ç»§æ‰¿æ—¶åŸºç±»çš„å˜é‡å’Œå‡½æ•°é‡å¤å‡ºç°ï¼‰ã€‚</p><p>istreamå’Œostreamè™šç»§æ‰¿è‡ªbase_ioï¼Œiostreamç»§æ‰¿äº†istreamå’Œostreamã€‚</p><p><code>virtual public A</code>å£°æ˜äº†Aæ˜¯ä¸€ä¸ªè¢«å…±äº«çš„è™šåŸºç±»ã€‚</p></details><h2 id="109"><a class="header-anchor" href="#109">Â¶</a>109</h2><h3 id="ä»£ç -s38"><a class="header-anchor" href="#ä»£ç -s38">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">call_with</span><span class="params">(std::function&lt;<span class="type">void</span>(T)&gt; f, T val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">f</span>(val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> print = [] (<span class="type">int</span> x) &#123; std::cout &lt;&lt; x; &#125;;</span><br><span class="line">    <span class="built_in">call_with</span>(print, <span class="number">42</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s38"><a class="header-anchor" href="#è¾“å‡º-s38">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç¼–è¯‘é”™è¯¯</p></details><h3 id="åˆ†æ-s38"><a class="header-anchor" href="#åˆ†æ-s38">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æ³¨æ„lambdaæ˜¯ä¸€ç§å®Œå…¨ä¸åŒçš„ç±»å‹ï¼Œä¸std::function&lt;void<int>&gt;ä¸åŒ¹é…ã€‚</p><p>ç¼–è¯‘å™¨ä¼šä¸ºæ¯ä¸ªå‚æ•°éƒ½æ¨å¯¼Tï¼Œå¹¶æ£€æŸ¥æ˜¯å¦åŒ¹é…ã€‚è™½ç„¶<code>T val</code>æ˜¾ç„¶ä¼šç¡®å®šåœ°å°†Tæ¨å¯¼ä¸ºintï¼Œä½†æ˜¯ä»ç„¶éœ€è¦æ£€æŸ¥<code>std::function&lt;void(int)&gt;</code>ä¸å®å‚çš„åŒ¹é…æ€§ã€‚</p><p><code>typename type_identity&lt;std::function&lt;void(T)&gt;&gt;::type</code>å¯ä»¥å°†Tè½¬åŒ–ä¸ºéæ¨å¯¼ã€‚</p></details><h2 id="122"><a class="header-anchor" href="#122">Â¶</a>122</h2><h3 id="ä»£ç -s39"><a class="header-anchor" href="#ä»£ç -s39">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">(<span class="type">unsigned</span> ll)</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;1&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">(<span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>)</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;2&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">foo</span>(<span class="number">2ull</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s39"><a class="header-anchor" href="#è¾“å‡º-s39">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>2</code></p></details><h3 id="åˆ†æ-s39"><a class="header-anchor" href="#åˆ†æ-s39">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>unsigned ll</code>ä¼šè¢«è®¤ä¸ºæ˜¯unsigned intç±»å‹çš„å˜é‡llã€‚</p></details><h2 id="5"><a class="header-anchor" href="#5">Â¶</a>5</h2><h3 id="ä»£ç -s40"><a class="header-anchor" href="#ä»£ç -s40">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line">  <span class="built_in">A</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;A&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">B</span> &#123;</span><br><span class="line">  <span class="built_in">B</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;B&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">C</span>() : <span class="built_in">a</span>(), <span class="built_in">b</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  B b;</span><br><span class="line">  A a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">C</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s40"><a class="header-anchor" href="#è¾“å‡º-s40">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>BA</code></p></details><h3 id="åˆ†æ-s40"><a class="header-anchor" href="#åˆ†æ-s40">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æˆå‘˜å˜é‡çš„åˆå§‹åŒ–é¡ºåºå–å†³äºå£°æ˜é¡ºåºï¼Œè€Œä¸æ˜¯åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„é¡ºåºã€‚</p></details><h2 id="249"><a class="header-anchor" href="#249">Â¶</a>249</h2><h3 id="ä»£ç -s41"><a class="header-anchor" href="#ä»£ç -s41">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="type">char</span> <span class="type">const</span> &amp;b = a;</span><br><span class="line">    cout &lt;&lt; b;</span><br><span class="line">    a++;</span><br><span class="line">    cout &lt;&lt; b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s41"><a class="header-anchor" href="#è¾“å‡º-s41">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>00</code></p></details><h3 id="åˆ†æ-s41"><a class="header-anchor" href="#åˆ†æ-s41">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å’Œ#217ç±»ä¼¼ï¼Œç”±äºbå’Œaçš„ç±»å‹ä¸åŒï¼Œbä¼šç»‘å®šåˆ°ä¸€ä¸ªä¸´æ—¶å˜é‡ä¸Šï¼Œè€Œä¸æ˜¯aã€‚</p></details><h2 id="251"><a class="header-anchor" href="#251">Â¶</a>251</h2><h3 id="ä»£ç -s42"><a class="header-anchor" href="#ä»£ç -s42">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(T)</span> </span>&#123; std::cout &lt;&lt; <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;&gt;</span><br><span class="line"><span class="type">void</span> f&lt;&gt;(<span class="type">int</span>*) &#123; std::cout &lt;&lt; <span class="number">2</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(T*)</span> </span>&#123; std::cout &lt;&lt; <span class="number">3</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> *p = <span class="literal">nullptr</span>; </span><br><span class="line">    <span class="built_in">f</span>( p );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s42"><a class="header-anchor" href="#è¾“å‡º-s42">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>3</code></p></details><h3 id="åˆ†æ-s42"><a class="header-anchor" href="#åˆ†æ-s42">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å…ˆåœ¨æ¨¡æ¿å‡½æ•°ä¸­è¿›è¡Œé‡è½½å†³ç­–ï¼Œç„¶åæ‰è€ƒè™‘é€‰æ‹©çš„å‡½æ•°çš„æ¨¡æ¿ç‰¹åŒ–ã€‚</p></details><h2 id="332"><a class="header-anchor" href="#332">Â¶</a>332</h2><h3 id="ä»£ç -s43"><a class="header-anchor" href="#ä»£ç -s43">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">S</span> &#123;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Callable&gt;</span><br><span class="line">    <span class="type">void</span> <span class="keyword">operator</span>[](Callable f) &#123;</span><br><span class="line">        <span class="built_in">f</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> caller = S&#123;&#125;;</span><br><span class="line">    caller[ []&#123; std::cout &lt;&lt; <span class="string">&quot;C&quot;</span>;&#125; ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s43"><a class="header-anchor" href="#è¾“å‡º-s43">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç¼–è¯‘é”™è¯¯</p></details><h3 id="åˆ†æ-s43"><a class="header-anchor" href="#åˆ†æ-s43">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿ç»­çš„å·¦æ–¹æ‹¬å·åªå…è®¸å‡ºç°åœ¨<code>[[attributes]]</code>ä¸­ã€‚</p></details><h2 id="121"><a class="header-anchor" href="#121">Â¶</a>121</h2><h3 id="ä»£ç -s44"><a class="header-anchor" href="#ä»£ç -s44">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="type">int</span> b = <span class="number">20</span>;</span><br><span class="line">  <span class="type">int</span> x;</span><br><span class="line">  x = (a, b);</span><br><span class="line">  std::cout &lt;&lt; x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s44"><a class="header-anchor" href="#è¾“å‡º-s44">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>20</code></p></details><h3 id="åˆ†æ-s44"><a class="header-anchor" href="#åˆ†æ-s44">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>é€—å·æ“ä½œç¬¦åº”ç”¨åˆ°çš„ä¸¤ä¸ªè¡¨è¾¾å¼ï¼Œä¿è¯ä»å·¦åˆ°å³è®¡ç®—ï¼Œå¹¶è¿”å›ç¬¬äºŒä¸ªæ“ä½œæ•°çš„ç»“æœå’Œç±»å‹ã€‚</p></details><h2 id="157"><a class="header-anchor" href="#157">Â¶</a>157</h2><h3 id="ä»£ç -s45"><a class="header-anchor" href="#ä»£ç -s45">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;typeinfo&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::cout&lt;&lt; (&amp;<span class="built_in">typeid</span>(A) == &amp;<span class="built_in">typeid</span>(A));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s45"><a class="header-anchor" href="#è¾“å‡º-s45">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªæŒ‡å®šè¡Œä¸º</p></details><h3 id="åˆ†æ-s45"><a class="header-anchor" href="#åˆ†æ-s45">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä¸åº”è¯¥é€šè¿‡å–åœ°å€çš„æ–¹å¼ç¡®å®šä¸¤ç§ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œè¿™æ˜¯æ— æ³•ä¿è¯çš„ã€‚</p><p>åº”è¯¥å€ŸåŠ©<code>hash_code</code>å’Œ<code>type_index</code>ã€‚</p></details><h2 id="261"><a class="header-anchor" href="#261">Â¶</a>261</h2><h3 id="ä»£ç -s46"><a class="header-anchor" href="#ä»£ç -s46">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="function">std::stringstream <span class="title">ss</span><span class="params">(<span class="string">&quot;a&quot;</span>)</span></span>;</span><br><span class="line">  std::cout &lt;&lt; ss.<span class="built_in">str</span>();</span><br><span class="line">  ss &lt;&lt; <span class="string">&quot;b&quot;</span>;</span><br><span class="line">  std::cout &lt;&lt; ss.<span class="built_in">str</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s46"><a class="header-anchor" href="#è¾“å‡º-s46">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>ab</code></p></details><h3 id="åˆ†æ-s46"><a class="header-anchor" href="#åˆ†æ-s46">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>stringstreamä¼šå…ˆåˆå§‹åŒ–ä¸€ä¸ªbufferï¼Œè€Œ<code>operator&lt;&lt;</code>ä¼šå†™åˆ°bufferä¸­çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œè€Œè¿™é‡Œæ˜¯èµ·å§‹ä½ç½®ï¼Œå¯¼è‡´è¦†ç›–äº†<code>a</code>ã€‚</p><p>ä¼šé¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥å£°æ˜ssä¸º<code>std::stringstream ss(&quot;a&quot;, std::ios_base::out|std::ios_base::ate);</code></p></details><h2 id="287"><a class="header-anchor" href="#287">Â¶</a>287</h2><h3 id="ä»£ç -s47"><a class="header-anchor" href="#ä»£ç -s47">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">using</span> <span class="keyword">namespace</span> std::string_literals;</span><br><span class="line">  <span class="function">std::string <span class="title">s1</span><span class="params">(<span class="string">&quot;hello world&quot;</span>,<span class="number">5</span>)</span></span>; </span><br><span class="line">  <span class="function">std::string <span class="title">s2</span><span class="params">(<span class="string">&quot;hello world&quot;</span>s,<span class="number">5</span>)</span></span>; </span><br><span class="line"></span><br><span class="line">  std::cout &lt;&lt; s1 &lt;&lt; s2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s47"><a class="header-anchor" href="#è¾“å‡º-s47">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>hello world</code></p></details><h3 id="åˆ†æ-s47"><a class="header-anchor" href="#åˆ†æ-s47">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä»¥<code>s</code>ä¸ºåç¼€ä¸ºå£°æ˜ä¸€ä¸ª<code>std::string</code>ç±»å‹çš„å­—é¢é‡ï¼Œè€Œé»˜è®¤åˆ™æ˜¯<code>const char[]</code>ç±»å‹ï¼Œä»è€Œå¯ä»¥åŒ…å«<code>\0</code>ã€‚</p><ul><li><code>basic_string(const charT* s, size_type n, const Allocator&amp; a = Allocator());</code></li><li><code>basic_string(const basic_string&amp; str, size_type pos, const Allocator&amp; a = Allocator());</code></li><li><code>basic_string( size_type count, CharT ch, const Allocator&amp; alloc = Allocator() );</code> ï¼ˆcountä¸ªchå­—ç¬¦ï¼‰</li></ul><p>é€šè¿‡<code>const char*</code>æ„é€ ï¼Œè¡¨ç¤ºèµ·å§‹çš„nä¸ªå­—ç¬¦ã€‚è€Œé€šè¿‡<code>std::string</code>æ„é€ ï¼Œåˆ™è¡¨ç¤ºä»<code>pos</code>èµ·å§‹åˆ°ç»“æŸçš„å­—ç¬¦ã€‚</p></details><h2 id="116"><a class="header-anchor" href="#116">Â¶</a>116</h2><h3 id="ä»£ç -s48"><a class="header-anchor" href="#ä»£ç -s48">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;utility&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">y</span><span class="params">(<span class="type">int</span> &amp;)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">y</span><span class="params">(<span class="type">int</span> &amp;&amp;)</span> </span>&#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(T &amp;&amp;x)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">y</span>(x); &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="type">int</span> <span class="title">g</span><span class="params">(T &amp;&amp;x)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">y</span>(std::<span class="built_in">move</span>(x)); &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="type">int</span> <span class="title">h</span><span class="params">(T &amp;&amp;x)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">y</span>(std::forward&lt;T&gt;(x)); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">10</span>;</span><br><span class="line">  std::cout &lt;&lt; <span class="built_in">f</span>(i) &lt;&lt; <span class="built_in">f</span>(<span class="number">20</span>);</span><br><span class="line">  std::cout &lt;&lt; <span class="built_in">g</span>(i) &lt;&lt; <span class="built_in">g</span>(<span class="number">20</span>);</span><br><span class="line">  std::cout &lt;&lt; <span class="built_in">h</span>(i) &lt;&lt; <span class="built_in">h</span>(<span class="number">20</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s48"><a class="header-anchor" href="#è¾“å‡º-s48">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>112212</code></p></details><h3 id="åˆ†æ-s48"><a class="header-anchor" href="#åˆ†æ-s48">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>T&amp;&amp;</code>æ˜¯ä¸€ä¸ªuniversal referenceã€‚</p><p>ç”¨å·¦å€¼è°ƒç”¨æ—¶ï¼Œ<code>T&amp;&amp; &amp;</code>ä¼šæŠ˜å ä¸º<code>T&amp;</code>ï¼Œè€Œç”¨å³å€¼è°ƒç”¨æ—¶ï¼Œä¼šæŠ˜å ä¸º<code>T&amp;&amp; &amp;&amp;</code>ã€‚</p></details><h2 id="287-s2"><a class="header-anchor" href="#287-s2">Â¶</a>287</h2><h3 id="ä»£ç -s49"><a class="header-anchor" href="#ä»£ç -s49">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">using</span> <span class="keyword">namespace</span> std::string_literals;</span><br><span class="line">  <span class="function">std::string <span class="title">s1</span><span class="params">(<span class="string">&quot;hello world&quot;</span>,<span class="number">5</span>)</span></span>; </span><br><span class="line">  <span class="function">std::string <span class="title">s2</span><span class="params">(<span class="string">&quot;hello world&quot;</span>s,<span class="number">5</span>)</span></span>; </span><br><span class="line"></span><br><span class="line">  std::cout &lt;&lt; s1 &lt;&lt; s2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s49"><a class="header-anchor" href="#è¾“å‡º-s49">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>hello world</code></p></details><h3 id="åˆ†æ-s49"><a class="header-anchor" href="#åˆ†æ-s49">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä»¥<code>s</code>ä¸ºåç¼€ä¸ºå£°æ˜ä¸€ä¸ª<code>std::string</code>ç±»å‹çš„å­—é¢é‡ï¼Œè€Œé»˜è®¤åˆ™æ˜¯<code>const char[n]</code>ç±»å‹ï¼Œä»è€Œå¯ä»¥åŒ…å«<code>\0</code>ã€‚</p><ul><li><code>basic_string(const charT* s, size_type n, const Allocator&amp; a = Allocator());</code></li><li><code>basic_string(const basic_string&amp; str, size_type pos, const Allocator&amp; a = Allocator());</code></li><li><code>basic_string( size_type count, CharT ch, const Allocator&amp; alloc = Allocator() );</code> ï¼ˆcountä¸ªchå­—ç¬¦ï¼‰</li></ul><p>é€šè¿‡<code>const char*</code>æ„é€ ï¼Œè¡¨ç¤ºèµ·å§‹çš„nä¸ªå­—ç¬¦ã€‚è€Œé€šè¿‡<code>std::string</code>æ„é€ ï¼Œåˆ™è¡¨ç¤ºä»<code>pos</code>èµ·å§‹åˆ°ç»“æŸçš„å­—ç¬¦ã€‚</p></details><h2 id="161"><a class="header-anchor" href="#161">Â¶</a>161</h2><h3 id="ä»£ç -s50"><a class="header-anchor" href="#ä»£ç -s50">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">3</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (n % <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: </span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">    ++i;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: ++i;</span><br><span class="line">    &#125; <span class="keyword">while</span> (--n &gt; <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s50"><a class="header-anchor" href="#è¾“å‡º-s50">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>5</code></p></details><h3 id="åˆ†æ-s50"><a class="header-anchor" href="#åˆ†æ-s50">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>case</code>å’Œ<code>default</code>åªæ˜¯labelï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¸åŠ breakï¼Œä¼šé»˜è®¤ç»§ç»­æ‰§è¡Œï¼ˆfall throughï¼‰</p></details><h2 id="335"><a class="header-anchor" href="#335">Â¶</a>335</h2><h3 id="ä»£ç -s51"><a class="header-anchor" href="#ä»£ç -s51">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstddef&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(<span class="type">void</span>*)</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(std::<span class="type">nullptr_t</span>)</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span>* a&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">f</span>(a);</span><br><span class="line">    <span class="built_in">f</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="built_in">f</span>(<span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s51"><a class="header-anchor" href="#è¾“å‡º-s51">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªæŒ‡å®šè¡Œä¸º</p></details><h3 id="åˆ†æ-s51"><a class="header-anchor" href="#åˆ†æ-s51">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>NULLå¯ä»¥æ˜¯<code>0</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>std::nullptr_t</code>ã€‚GCCå’ŒClangéƒ½æ˜¯longç±»å‹çš„0ï¼Œè€ŒMSVCæ˜¯intç±»å‹çš„0ã€‚</p><p>å¦‚æœNULLæ˜¯0ï¼Œåˆ™<code>f(NULL)</code>æ˜¯æœ‰æ­§ä¹‰çš„ï¼Œå› ä¸º<code>f(void*)</code>å’Œ<code>f(std::nullptr_t)</code>ä¸€æ ·å¥½ï¼Œéƒ½éœ€è¦ç»è¿‡ä¸€æ¬¡è½¬åŒ–ã€‚</p></details><h2 id="31"><a class="header-anchor" href="#31">Â¶</a>31</h2><h3 id="ä»£ç -s52"><a class="header-anchor" href="#ä»£ç -s52">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X</span> &#123;</span><br><span class="line">  <span class="built_in">X</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;X&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Y</span> &#123;</span><br><span class="line">  <span class="built_in">Y</span>(<span class="type">const</span> X &amp;x) &#123; std::cout &lt;&lt; <span class="string">&quot;Y&quot;</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;f&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="function">Y <span class="title">y</span><span class="params">(X())</span></span>;</span><br><span class="line">  y.<span class="built_in">f</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s52"><a class="header-anchor" href="#è¾“å‡º-s52">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ç¼–è¯‘é”™è¯¯</p></details><h3 id="åˆ†æ-s52"><a class="header-anchor" href="#åˆ†æ-s52">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿™æ¶‰åŠåˆ°most vexing parseã€‚</p><p>C++åœ¨æ— æ³•åŒºåˆ†å¯¹è±¡åˆ›å»ºå’Œå‡½æ•°å®šä¹‰æ—¶ï¼Œä¼šè§£é‡Šæˆå‡½æ•°å®šä¹‰ã€‚</p><p><code>Y y(X())</code>ä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªå‚æ•°ä¸ºXç±»å‹ï¼Œè¿”å›å€¼ä¸ºYï¼Œåç§°ä¸ºyçš„å‡½æ•°çš„å£°æ˜ï¼ˆCè¯­è¨€å…è®¸åœ¨å‡½æ•°å‚æ•°å‘¨å›´æ·»åŠ å¤šä½™çš„æ‹¬å·ï¼‰ã€‚</p></details><h2 id="147"><a class="header-anchor" href="#147">Â¶</a>147</h2><h3 id="ä»£ç -s53"><a class="header-anchor" href="#ä»£ç -s53">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">int</span> x=<span class="number">0</span>; <span class="comment">//What is wrong here??/</span></span><br><span class="line">  x=<span class="number">1</span>;</span><br><span class="line">  std::cout&lt;&lt;x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s53"><a class="header-anchor" href="#è¾“å‡º-s53">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>1</code></p></details><h3 id="åˆ†æ-s53"><a class="header-anchor" href="#åˆ†æ-s53">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿™é‡Œçš„<code>??/</code>å±äºCè¯­è¨€ä¸­çš„trigraphï¼Œå¯ä»¥ä½œä¸ºæŸäº›å­—ç¬¦çš„æ›¿ä»£ï¼Œç±»ä¼¼#193ã€‚</p><p>è§<a href="https://en.wikibooks.org/wiki/C_Programming/C_trigraph">https://en.wikibooks.org/wiki/C_Programming/C_trigraph</a>ã€‚</p></details><h2 id="41"><a class="header-anchor" href="#41">Â¶</a>41</h2><h3 id="ä»£ç -s54"><a class="header-anchor" href="#ä»£ç -s54">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cout &lt;&lt; <span class="number">1</span>[<span class="string">&quot;ABC&quot;</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s54"><a class="header-anchor" href="#è¾“å‡º-s54">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>B</code></p></details><h3 id="åˆ†æ-s54"><a class="header-anchor" href="#åˆ†æ-s54">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¡¨è¾¾å¼<code>E1[E2]</code>ç­‰ä»·äº<code>((E1)+(E2))</code>ã€‚</p></details><h2 id="160"><a class="header-anchor" href="#160">Â¶</a>160</h2><h3 id="ä»£ç -s55"><a class="header-anchor" href="#ä»£ç -s55">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo</span> <span class="params">(<span class="type">int</span> a = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;A&quot;</span> &lt;&lt; a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">B</span> : A &#123;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">foo</span> <span class="params">(<span class="type">int</span> a = <span class="number">2</span>)</span> </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;B&quot;</span> &lt;&lt; a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    A *b = <span class="keyword">new</span> B;</span><br><span class="line">    b-&gt;<span class="built_in">foo</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s55"><a class="header-anchor" href="#è¾“å‡º-s55">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>B1</code></p></details><h3 id="åˆ†æ-s55"><a class="header-anchor" href="#åˆ†æ-s55">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å˜é‡bæœ‰é™æ€ç±»å‹Aï¼ŒåŠ¨æ€ç±»å‹Bã€‚</p><p>è™šå‡½æ•°è°ƒç”¨ä¼šä½¿ç”¨æŒ‡é’ˆæˆ–å¼•ç”¨çš„é™æ€ç±»å‹ä¸­å®šä¹‰çš„é»˜è®¤å‚æ•°ã€‚æ´¾ç”Ÿç±»çš„é‡å†™å‡½æ•°å¯ä»¥æœ‰ä¸åŒçš„é»˜è®¤å‚æ•°ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰é»˜è®¤å‚æ•°ã€‚</p></details><h2 id="233"><a class="header-anchor" href="#233">Â¶</a>233</h2><h3 id="ä»£ç -s56"><a class="header-anchor" href="#ä»£ç -s56">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;type_traits&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">()</span> <span class="type">const</span>&amp;&amp;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> ptr = &amp;X::f;</span><br><span class="line">    cout &lt;&lt; is_same_v&lt;<span class="keyword">decltype</span>(ptr), <span class="built_in">int</span>()&gt;</span><br><span class="line">         &lt;&lt; is_same_v&lt;<span class="keyword">decltype</span>(ptr), <span class="built_in">int</span>(X::*)()&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s56"><a class="header-anchor" href="#è¾“å‡º-s56">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>00</code></p></details><h3 id="åˆ†æ-s56"><a class="header-anchor" href="#åˆ†æ-s56">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿”å›ç±»å‹ã€å‚æ•°ç±»å‹åˆ—è¡¨ã€å¼•ç”¨é™å®šã€cvé™å®šã€å¼‚å¸¸ï¼ˆä¸åŒ…æ‹¬é»˜è®¤å‚æ•°ï¼‰éƒ½æ˜¯å‡½æ•°ç±»å‹çš„ä¸€éƒ¨åˆ†ã€‚</p><p>è¿™é‡Œptræ˜¯<code>int(X::*)() const&amp;&amp;</code>ç±»å‹ã€‚</p><p>æ³¨æ„å‡½æ•°ç±»å‹ã€å‡½æ•°ç­¾åã€å‡½æ•°åŸå‹çš„åŒºåˆ«ã€‚</p></details><h2 id="293"><a class="header-anchor" href="#293">Â¶</a>293</h2><h3 id="ä»£ç -s57"><a class="header-anchor" href="#ä»£ç -s57">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; (argv[argc] == <span class="literal">nullptr</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s57"><a class="header-anchor" href="#è¾“å‡º-s57">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>1</code></p></details><h3 id="åˆ†æ-s57"><a class="header-anchor" href="#åˆ†æ-s57">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>argv[argc]</code>ä¿è¯ä¸º0ã€‚</p></details><h2 id="179"><a class="header-anchor" href="#179">Â¶</a>179</h2><h3 id="ä»£ç -s58"><a class="header-anchor" href="#ä»£ç -s58">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span>&amp; r = <span class="built_in">const_cast</span>&lt;<span class="type">int</span>&amp;&gt;(i);</span><br><span class="line">    r = <span class="number">1</span>;</span><br><span class="line">    std::cout &lt;&lt; r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s58"><a class="header-anchor" href="#è¾“å‡º-s58">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªå®šä¹‰è¡Œä¸º</p></details><h3 id="åˆ†æ-s58"><a class="header-anchor" href="#åˆ†æ-s58">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä¿®æ”¹constå¯¹è±¡æ€»æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚<code>const_cast</code>çš„ç”¨é€”ä¸æ˜¯è¿™ä¸ªã€‚</p></details><h2 id="224"><a class="header-anchor" href="#224">Â¶</a>224</h2><h3 id="ä»£ç -s59"><a class="header-anchor" href="#ä»£ç -s59">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Base</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">int</span> <span class="title">f</span><span class="params">()</span> </span>= <span class="number">0</span>; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Base::f</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Derived</span> : Base &#123;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">()</span> <span class="keyword">override</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Derived::f</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Derived object;</span><br><span class="line">    std::cout &lt;&lt; object.<span class="built_in">f</span>();</span><br><span class="line">    std::cout &lt;&lt; ((Base&amp;)object).<span class="built_in">f</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s59"><a class="header-anchor" href="#è¾“å‡º-s59">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>22</code></p></details><h3 id="åˆ†æ-s59"><a class="header-anchor" href="#åˆ†æ-s59">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>äº‹å®ä¸Šçº¯è™šå‡½æ•°ä¹Ÿå¯ä»¥åœ¨ç±»å¤–ä¸ºå…¶æä¾›ä¸€ä¸ªå®šä¹‰ã€‚</p><p>å¸¦æœ‰çº¯è™šå‡½æ•°çš„æŠ½è±¡ç±»æ˜¯æ— æ³•åˆ›å»ºå¯¹è±¡çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æ´¾ç”Ÿç±»ä¸­é€šè¿‡<code>Base::f()</code>è¿›è¡Œè°ƒç”¨ã€‚</p></details><h2 id="15"><a class="header-anchor" href="#15">Â¶</a>15</h2><h3 id="ä»£ç -s60"><a class="header-anchor" href="#ä»£ç -s60">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;exception&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">A</span>() &#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (x++ == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> std::<span class="built_in">exception</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ~<span class="built_in">A</span>() &#123; std::cout &lt;&lt; <span class="string">&#x27;A&#x27;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">B</span>() &#123; std::cout &lt;&lt; <span class="string">&#x27;b&#x27;</span>; &#125;</span><br><span class="line">  ~<span class="built_in">B</span>() &#123; std::cout &lt;&lt; <span class="string">&#x27;B&#x27;</span>; &#125;</span><br><span class="line">  A a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123; <span class="type">static</span> B b; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="built_in">foo</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">catch</span> (std::exception &amp;) &#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">    <span class="built_in">foo</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s60"><a class="header-anchor" href="#è¾“å‡º-s60">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>acabBA</code></p></details><h3 id="åˆ†æ-s60"><a class="header-anchor" href="#åˆ†æ-s60">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>å› ä¸º<code>b</code>åœ¨ç¬¬ä¸€æ¬¡åˆå§‹åŒ–æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œè¢«è§†ä¸ºæ²¡åˆå§‹åŒ–ã€‚å› æ­¤åœ¨ç¬¬äºŒæ¬¡è¿›å…¥æ—¶ä¼šé‡æ–°å°è¯•ã€‚</p></details><h2 id="186"><a class="header-anchor" href="#186">Â¶</a>186</h2><h3 id="ä»£ç -s61"><a class="header-anchor" href="#ä»£ç -s61">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;typeinfo&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">takes_pointer</span><span class="params">(<span class="type">int</span>* pointer)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">typeid</span>(pointer) == <span class="built_in">typeid</span>(<span class="type">int</span>[])) std::cout &lt;&lt; <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">typeid</span>(pointer) == <span class="built_in">typeid</span>(<span class="type">int</span>*)) std::cout &lt;&lt; <span class="string">&#x27;p&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">takes_array</span><span class="params">(<span class="type">int</span> array[])</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">typeid</span>(array) == <span class="built_in">typeid</span>(<span class="type">int</span>[])) std::cout &lt;&lt; <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">typeid</span>(array) == <span class="built_in">typeid</span>(<span class="type">int</span>*)) std::cout &lt;&lt; <span class="string">&#x27;p&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span>* pointer = <span class="literal">nullptr</span>;</span><br><span class="line">  <span class="type">int</span> array[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">takes_pointer</span>(array);</span><br><span class="line">  <span class="built_in">takes_array</span>(pointer);</span><br><span class="line"></span><br><span class="line">  std::cout &lt;&lt; (<span class="built_in">typeid</span>(<span class="type">int</span>*) == <span class="built_in">typeid</span>(<span class="type">int</span>[]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s61"><a class="header-anchor" href="#è¾“å‡º-s61">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>pp0</code></p></details><h3 id="åˆ†æ-s61"><a class="header-anchor" href="#åˆ†æ-s61">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>int*</code>æ˜¯æŒ‡é’ˆï¼Œ<code>int[]</code>æ˜¯ä¸€ä¸ªæœªçŸ¥ä¸ªæ•°çš„æ•°ç»„ï¼ˆæ˜¯ä¸å®Œæ•´ç±»å‹ï¼‰ï¼Œ<code>int[1]</code>æ˜¯ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ã€‚</p><p>åœ¨å‡½æ•°ä¼ å‚ä¸­ï¼Œæ•°ç»„ä¼šé€€åŒ–ä¸ºæŒ‡é’ˆã€‚å¯ä»¥é€šè¿‡ä¼ æ•°ç»„çš„å¼•ç”¨çš„æ–¹å¼é¿å…ã€‚<code>int (&amp;a)[1]</code>ã€‚</p></details><h2 id="323"><a class="header-anchor" href="#323">Â¶</a>323</h2><h3 id="ä»£ç -s62"><a class="header-anchor" href="#ä»£ç -s62">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdexcept&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;</span><br><span class="line">    <span class="built_in">A</span>(<span class="type">char</span> c) : <span class="built_in">c_</span>(c) &#123;&#125;</span><br><span class="line">    ~<span class="built_in">A</span>() &#123; std::cout &lt;&lt; c_; &#125;</span><br><span class="line">    <span class="type">char</span> c_;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Y</span> &#123; ~<span class="built_in">Y</span>() <span class="built_in">noexcept</span>(<span class="literal">false</span>) &#123; <span class="keyword">throw</span> std::<span class="built_in">runtime_error</span>(<span class="string">&quot;&quot;</span>); &#125; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">A <span class="title">f</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="function">A <span class="title">a</span><span class="params">(<span class="string">&#x27;a&#x27;</span>)</span></span>;</span><br><span class="line">        Y y;</span><br><span class="line">        <span class="function">A <span class="title">b</span><span class="params">(<span class="string">&#x27;b&#x27;</span>)</span></span>;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;c&#x27;</span>&#125;;</span><br><span class="line">    &#125; <span class="built_in">catch</span> (...) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&#x27;d&#x27;</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">f</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s62"><a class="header-anchor" href="#è¾“å‡º-s62">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>bcad</code></p></details><h3 id="åˆ†æ-s62"><a class="header-anchor" href="#åˆ†æ-s62">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æ³¨æ„å¼‚å¸¸æ˜¯åœ¨<code>y</code>çš„ææ„ä¸­æŠ›å‡ºçš„ã€‚</p><p>é¦–å…ˆ<code>return &#123;'c'&#125;</code>æ„é€ äº†ä¸€ä¸ªAçš„å¯¹è±¡ï¼Œç„¶åææ„bï¼Œææ„yå¹¶æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´å †æ ˆå±•å¼€ï¼Œå†æŒ‰ç…§åé¡ºåºï¼Œææ„<code>return</code>æ„é€ çš„å¯¹è±¡ï¼Œå†ææ„aã€‚</p><p>ç„¶è€Œç›®å‰<code>GCC</code>ã€<code>CLang</code>å’Œ<code>MSVC</code>éƒ½æœªéµå®ˆC++æ ‡å‡†ï¼Œä¼šåˆ†åˆ«è¾“å‡º<code>bacd</code>ã€<code>bad</code>å’Œ<code>bad</code>ã€‚</p><p>æ³¨ï¼šå¦‚æœæ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ï¼Œåº”è¯¥æ˜¯<code>bac</code>ã€‚</p><p><code>noexcept</code>æ˜¯å¯ä»¥åŠ ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼çš„ï¼Œè¡¨ç¤ºåœ¨è¯¥æ¡ä»¶ä¸‹ä¸ä¼šå‘ç”Ÿå¼‚å¸¸ã€‚åº”è¯¥è®¤ä¸ºæ‰€æœ‰å‡½æ•°éƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå³<code>noexcept(false)</code>ï¼Œå› æ­¤é€šå¸¸åªå¯¹æ˜ç¡®ä¸æŠ›å‡ºå¼‚å¸¸çš„å‡½æ•°ä½¿ç”¨<code>noexcept</code>æ ‡è®°ã€‚</p><p>åªæœ‰ææ„å‡½æ•°é»˜è®¤æ˜¯<code>noexcept(true)</code>ã€‚</p></details><h2 id="350"><a class="header-anchor" href="#350">Â¶</a>350</h2><h3 id="ä»£ç -s63"><a class="header-anchor" href="#ä»£ç -s63">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Q</span>&#123;</span><br><span class="line">    <span class="type">int</span> v=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">Q</span>(Q&amp;&amp;)&#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;M&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">Q</span>(<span class="type">const</span> Q&amp;)&#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;C&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">Q</span>()&#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;D&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">()</span></span>&#123;</span><br><span class="line">            ++v;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">            std::cout &lt;&lt; v;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">takeQfunc</span><span class="params">(std::function&lt;<span class="type">void</span>(Q)&gt; qfunc)</span></span>&#123;</span><br><span class="line">    Q q;</span><br><span class="line">    q.<span class="built_in">func</span>();</span><br><span class="line">    <span class="built_in">qfunc</span>(q);</span><br><span class="line">    q.<span class="built_in">func</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">takeQfunc</span>([](Q&amp;&amp; q)&#123;</span><br><span class="line">        q.<span class="built_in">change</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s63"><a class="header-anchor" href="#è¾“å‡º-s63">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>D0C0</code></p></details><h3 id="åˆ†æ-s63"><a class="header-anchor" href="#åˆ†æ-s63">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è™½ç„¶ä¼ è¿›å»çš„lambdaçš„å‚æ•°æ˜¯ä¸€ä¸ªçº¯å³å€¼ï¼Œä½†æ˜¯std::functionçš„å‚æ•°æ˜¯ä¸€ä¸ªä¸å¸¦å¼•ç”¨çš„å·¦å€¼ï¼Œåœ¨<code>qfunc(q)</code>ä¸­ä¼šå‘ç”Ÿæ‹·è´æ„é€ äº§ç”Ÿä¸€ä¸ªä¸´æ—¶å€¼ï¼Œç„¶åè¯¥ä¸´æ—¶å€¼è¿›å…¥lambdaï¼Œè°ƒç”¨äº†<code>q.change()</code>ã€‚</p><p>å’Œè¿™ä¸ªç±»ä¼¼çš„æ˜¯ä»¥ä¸‹æƒ…å†µï¼ˆä¹Ÿæ˜¯æŸä¸ªquizï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(<span class="type">int</span>&amp;&amp;)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(<span class="type">float</span>&amp;&amp;)</span> </span>&#123;&#125;</span><br><span class="line"><span class="type">int</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> y = <span class="number">1.f</span>;</span><br><span class="line"><span class="built_in">f</span>(x); <span class="comment">// call f(float&amp;&amp;)</span></span><br><span class="line"><span class="built_in">f</span>(y); <span class="comment">// call f(int&amp;&amp;)</span></span><br></pre></td></tr></table></figure></details><h2 id="360"><a class="header-anchor" href="#360">Â¶</a>360</h2><h3 id="ä»£ç -s64"><a class="header-anchor" href="#ä»£ç -s64">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;type_traits&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; is_const_v&lt;<span class="type">const</span> <span class="type">int</span> *&gt;</span><br><span class="line">         &lt;&lt; is_const_v&lt;<span class="type">const</span> <span class="type">int</span> [<span class="number">1</span>]&gt;</span><br><span class="line">         &lt;&lt; is_const_v&lt;<span class="type">const</span> <span class="type">int</span> **&gt;</span><br><span class="line">         &lt;&lt; is_const_v&lt;<span class="function"><span class="type">const</span> <span class="title">int</span> <span class="params">(*)</span>[1]&gt;</span></span><br><span class="line"><span class="function">         &lt;&lt; is_const_v&lt;<span class="type">const</span> <span class="type">int</span> *[1]&gt;</span></span><br><span class="line"><span class="function">         &lt;&lt; is_const_v&lt;<span class="type">const</span> <span class="type">int</span> [1][1]&gt;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s64"><a class="header-anchor" href="#è¾“å‡º-s64">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>010001</code></p></details><h3 id="åˆ†æ-s64"><a class="header-anchor" href="#åˆ†æ-s64">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æŒ‡é’ˆæœ‰é¡¶å±‚constå’Œåº•å±‚constã€‚è¿™é‡Œæ”¾åœ¨æœ€å‰é¢éƒ½æ˜¯åº•å±‚constï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘çš„å…ƒç´ æ˜¯constçš„ï¼Œä½†æ˜¯ä½ è‡ªèº«å¯ä»¥æ›´æ”¹æŒ‡å‘ã€‚</p><p>ä½†æ˜¯æ•°ç»„åªæœ‰é¡¶å±‚constã€‚</p></details><h2 id="226"><a class="header-anchor" href="#226">Â¶</a>226</h2><h3 id="ä»£ç -s65"><a class="header-anchor" href="#ä»£ç -s65">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;utility&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X</span> &#123;</span><br><span class="line">    <span class="built_in">X</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;1&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">X</span>(X &amp;) &#123; std::cout &lt;&lt; <span class="string">&quot;2&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">X</span>(<span class="type">const</span> X &amp;) &#123; std::cout &lt;&lt; <span class="string">&quot;3&quot;</span>; &#125;</span><br><span class="line">    <span class="built_in">X</span>(X &amp;&amp;) &#123; std::cout &lt;&lt; <span class="string">&quot;4&quot;</span>; &#125;</span><br><span class="line">    ~<span class="built_in">X</span>() &#123; std::cout &lt;&lt; <span class="string">&quot;5&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Y</span> &#123;</span><br><span class="line">    <span class="keyword">mutable</span> X x;</span><br><span class="line">    <span class="built_in">Y</span>() = <span class="keyword">default</span>;</span><br><span class="line">    <span class="built_in">Y</span>(<span class="type">const</span> Y &amp;) = <span class="keyword">default</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Y y1;</span><br><span class="line">    Y y2 = std::<span class="built_in">move</span>(y1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s65"><a class="header-anchor" href="#è¾“å‡º-s65">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>1255</code></p></details><h3 id="åˆ†æ-s65"><a class="header-anchor" href="#åˆ†æ-s65">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>Yæ²¡æœ‰ç§»åŠ¨æ„é€ ï¼Œæ‰€ä»¥è°ƒç”¨æ‹·è´æ„é€ ã€‚</p><p>ç”±äºç±»æˆå‘˜xè¢«æ ‡è®°ä¸ºmutableï¼Œ<code>X(X &amp;)</code>æ˜¯æ›´å¥½çš„åŒ¹é…ã€‚</p><p>æ³¨æ„æœ€åy1å’Œy2ä¸­çš„xéƒ½ä¼šè¢«ææ„ã€‚</p><p>æ³¨ï¼š<code>mutable</code>å…³é”®å­—ç”¨äºä¿®é¥°ç±»æˆå‘˜ï¼Œä½¿å…¶å¯ä»¥åœ¨constçš„æˆå‘˜å‡½æ•°ä¸­è¢«ä¿®æ”¹ã€‚æ­¤å¤–ï¼Œåœ¨lambdaå‡½æ•°ä¸­æ— æ³•ä¿®æ”¹æŒ‰å€¼æ•è·çš„å˜é‡ï¼Œå¯ä»¥æ·»åŠ mutableè¿›è¡Œä¿®æ”¹ï¼Œä½†æ˜¯ä¸å¼•ç”¨æ•è·è¿˜æ˜¯ä¸åŒçš„ï¼Œå› ä¸ºè¿™é‡Œä¿®æ”¹çš„æ˜¯ä¸€ä»½æ‹·è´ã€‚</p></details><h2 id="114"><a class="header-anchor" href="#114">Â¶</a>114</h2><h3 id="ä»£ç -s66"><a class="header-anchor" href="#ä»£ç -s66">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span>       </span>&#123; std::cout &lt;&lt; <span class="string">&quot;A&quot;</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> <span class="type">const</span> </span>&#123; std::cout &lt;&lt; <span class="string">&quot;B&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">S</span> &#123;</span><br><span class="line">  std::vector&lt;C&gt; v;</span><br><span class="line">  std::unique_ptr&lt;C&gt; u;</span><br><span class="line">  C *<span class="type">const</span> p;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">S</span>() </span><br><span class="line">    : <span class="built_in">v</span>(<span class="number">1</span>) </span><br><span class="line">    , <span class="built_in">u</span>(<span class="keyword">new</span> <span class="built_in">C</span>())</span><br><span class="line">    , <span class="built_in">p</span>(u.<span class="built_in">get</span>())</span><br><span class="line">  &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  S s;</span><br><span class="line">  <span class="type">const</span> S &amp;r = s;</span><br><span class="line"> </span><br><span class="line">  s.v[<span class="number">0</span>].<span class="built_in">foo</span>();</span><br><span class="line">  s.u-&gt;<span class="built_in">foo</span>();</span><br><span class="line">  s.p-&gt;<span class="built_in">foo</span>();</span><br><span class="line"></span><br><span class="line">  r.v[<span class="number">0</span>].<span class="built_in">foo</span>();</span><br><span class="line">  r.u-&gt;<span class="built_in">foo</span>();</span><br><span class="line">  r.p-&gt;<span class="built_in">foo</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s66"><a class="header-anchor" href="#è¾“å‡º-s66">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>AAABAA</code></p></details><h3 id="åˆ†æ-s66"><a class="header-anchor" href="#åˆ†æ-s66">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä¸€ä¸ªconstçš„å¯¹è±¡ï¼Œå…¶æˆå‘˜ä¹Ÿæ˜¯constçš„ï¼Œä½†éƒ½æ˜¯é¡¶å±‚çš„constï¼Œæ„å‘³ç€<code>v</code>ã€<code>u</code>å’Œ<code>p</code>ä¸èƒ½è¢«èµ‹å€¼ï¼Œä½†æ˜¯<code>std::vector</code>æ¯”è¾ƒç‰¹æ®Šï¼Œå½“å®ƒä¸ºconstæ—¶ï¼Œ<code>[]</code>ä¼šè°ƒç”¨è¿”å›constå…ƒç´ çš„é‚£ä¸ª<code>operator[]</code>é‡è½½ã€‚</p></details><h2 id="124"><a class="header-anchor" href="#124">Â¶</a>124</h2><h3 id="ä»£ç -s67"><a class="header-anchor" href="#ä»£ç -s67">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span> &#123;&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">B</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T = A&gt;</span><br><span class="line"><span class="keyword">struct</span> X;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X</span>&lt;A&gt; &#123;</span><br><span class="line">   <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="number">1</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">X</span>&lt;B&gt; &#123;</span><br><span class="line">   <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">f</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="number">2</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt; <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T = B&gt; <span class="keyword">class</span> C&gt;</span><br><span class="line"><span class="type">void</span> <span class="built_in">g</span>() &#123;</span><br><span class="line">   C&lt;&gt;::<span class="built_in">f</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="built_in">g</span>&lt;X&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s67"><a class="header-anchor" href="#è¾“å‡º-s67">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>2</code></p></details><h3 id="åˆ†æ-s67"><a class="header-anchor" href="#åˆ†æ-s67">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>è¿™é‡Œçš„templateåˆæ˜¯ä¸ªæ¨¡æ¿ç±»<code>template&lt;typenmae T = B&gt; class C&gt;</code>ï¼Œä¼ è¿›å»çš„æ˜¯<code>X&lt;B&gt;</code>ã€‚</p></details><h2 id="339"><a class="header-anchor" href="#339">Â¶</a>339</h2><h3 id="ä»£ç -s68"><a class="header-anchor" href="#ä»£ç -s68">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;future&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::promise&lt;<span class="type">int</span>&gt; p;</span><br><span class="line">    std::future&lt;<span class="type">int</span>&gt; f = p.<span class="built_in">get_future</span>();</span><br><span class="line">    p.<span class="built_in">set_value</span>(<span class="number">1</span>);</span><br><span class="line">    std::cout &lt;&lt; f.<span class="built_in">get</span>();</span><br><span class="line">    std::cout &lt;&lt; f.<span class="built_in">get</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s68"><a class="header-anchor" href="#è¾“å‡º-s68">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>æœªå®šä¹‰è¡Œä¸ºã€‚</p></details><h3 id="åˆ†æ-s68"><a class="header-anchor" href="#åˆ†æ-s68">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä»ä¸€ä¸ªfutureä¸­åªèƒ½getä¸€æ¬¡ï¼Œåç»­çš„getæ˜¯æœªå®šä¹‰çš„ï¼ˆæ­¤æ—¶<code>valid()</code>è¿”å›falseï¼‰ï¼Œä½†é¼“åŠ±æŠ›å‡ºå¼‚å¸¸ï¼ˆä¸»æµç¼–è¯‘å™¨éƒ½è¿™ä¹ˆåšï¼‰ã€‚</p></details><h2 id="340"><a class="header-anchor" href="#340">Â¶</a>340</h2><h3 id="ä»£ç -s69"><a class="header-anchor" href="#ä»£ç -s69">Â¶</a>ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;future&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        std::promise&lt;<span class="type">int</span>&gt; p;</span><br><span class="line">        std::future&lt;<span class="type">int</span>&gt; f1 = p.<span class="built_in">get_future</span>();</span><br><span class="line">        std::future&lt;<span class="type">int</span>&gt; f2 = p.<span class="built_in">get_future</span>();</span><br><span class="line">        p.<span class="built_in">set_value</span>(<span class="number">1</span>);</span><br><span class="line">        std::cout &lt;&lt; f1.<span class="built_in">get</span>() &lt;&lt; f2.<span class="built_in">get</span>();</span><br><span class="line">    &#125; <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">    &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡º-s69"><a class="header-anchor" href="#è¾“å‡º-s69">Â¶</a>è¾“å‡º</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p><code>2</code></p></details><h3 id="åˆ†æ-s69"><a class="header-anchor" href="#åˆ†æ-s69">Â¶</a>åˆ†æ</h3><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>ä»ä¸€ä¸ªpromiseä¸­åªèƒ½å¾—åˆ°ä¸€ä¸ªfutureï¼Œåç»­ä¼šæŠ›å‡º<code>future_error</code>çš„å¼‚å¸¸ã€‚</p></details>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode 41. ç¼ºå¤±çš„ç¬¬ä¸€ä¸ªæ­£æ•°</title>
      <link href="/2023/09/08/Leetcode-41-%E7%BC%BA%E5%A4%B1%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%AD%A3%E6%95%B0/"/>
      <url>/2023/09/08/Leetcode-41-%E7%BC%BA%E5%A4%B1%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%AD%A3%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h2><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º$n$çš„æ•°ç»„$a$ï¼Œå¯¹å…¶ä¸­çš„æ‰€æœ‰æ­£æ•°æ±‚mexã€‚è¦æ±‚æ—¶é—´å¤æ‚åº¦$O(n)$ï¼Œé¢å¤–ç©ºé—´å¤æ‚åº¦$O(1)$ã€‚</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>æ’åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸è¡Œã€‚</p><p>æ¡¶æ’åºï¼Œç©ºé—´å¤æ‚åº¦ä¸è¡Œã€‚</p><p>æ˜¾ç„¶åªèƒ½å¯¹$a$æ•°ç»„æœ¬èº«è¿›è¡ŒåŸåœ°çš„æ“ä½œ (in place)ï¼Œæœ€åå¸Œæœ›èƒ½æ ¹æ®$a[i]$çš„å–å€¼åˆ¤æ–­å‡º$i$æ˜¯å¦å­˜åœ¨äºåŸæ•°ç»„ä¸­ã€‚</p><p>é‚£å°±æŒ‰ä¸‹æ ‡é¡ºåºä»å°åˆ°å¤§ä¾æ¬¡æ ‡è®°ã€‚è®¾å½“å‰ä¸‹æ ‡ä¸º$i$ï¼Œå¦‚æœ$a[i]\gt i$ï¼Œå°±å…ˆæ ‡è®°$a[a[i]]$ï¼Œç„¶åå†è¦†ç›–$a[a[i]]$å¤„çš„å€¼æ¥æ ‡è®°$a[i]$çš„å­˜åœ¨ï¼›è€Œå¦‚æœ$a[i]\le i$ï¼Œç›´æ¥å¯¹$a[a[i]]$è¿›è¡Œæ ‡è®°å³å¯ã€‚</p><p>ä¸‹ä¸€ä¸ªéš¾ç‚¹æ˜¯ç”¨ä»€ä¹ˆå€¼æ¥æ ‡è®°ã€‚æ˜¾ç„¶å¯ä»¥å–ä¸åœ¨åŸæ•°ç»„ä¸­çš„ä»»æ„å€¼ï¼Œä½†æ˜¯$O(n)$ç®—ä¸å‡ºæ¥ï¼Œè€ŒåŸæ•°ç»„çš„å–å€¼èŒƒå›´åˆæ˜¯æ•´ä¸ªintåŒºé—´ï¼Œä¸èƒ½ç”¨max+1ï¼Œmin-1è¿™ä¸ªtrickã€‚æˆ‘çš„åšæ³•å°±æ˜¯ç”¨n+1æ¥æ ‡è®°ï¼Œä½†éœ€è¦æŠŠåŸæ•°ç»„ä¸­çš„n+1éƒ½å…ˆæ”¹æˆn+2ï¼ˆä¸€å¼€å§‹æ²¡æ„è¯†åˆ°è¦æ”¹ï¼Œwaäº†ä¸€æ¬¡ï¼‰ï¼Œå› ä¸ºå¯ä»¥çŸ¥é“ç­”æ¡ˆä¸€å®šæ˜¯å°äºç­‰äºn+1çš„ï¼Œæ‰€ä»¥å¤§äºç­‰äºn+1çš„æ•°çš„å–å€¼æ˜¯æ— æ‰€è°“çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">firstMissingPositive</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        nums.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> &amp;x : nums) <span class="keyword">if</span> (x == n + <span class="number">1</span>) x = n + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">int</span> j = i, x = nums[j];</span><br><span class="line">            <span class="keyword">while</span> (x &gt; i &amp;&amp; x &lt;= n) &#123;</span><br><span class="line">                <span class="type">int</span> tmp = nums[x];</span><br><span class="line">                nums[x] = n + <span class="number">1</span>;</span><br><span class="line">                x = tmp;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (x &gt;= <span class="number">0</span> &amp;&amp; x &lt;= i) nums[x] = n + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> d = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (d &lt;= n &amp;&amp; nums[d] == n + <span class="number">1</span>) ++d;</span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>çœ‹äº†é¢˜è§£æ‰æ„è¯†åˆ°è¿™æ˜¯ç½®æ¢çš„åšæ³•ã€‚</p><p>æ­¤å¤–è¿˜æœ‰ä¸€ç§æ­£è´Ÿçš„åšæ³•ï¼ˆæˆ–è€…ç§°ä¸ºå“ˆå¸Œï¼‰ï¼šæ˜¾ç„¶è´Ÿæ•°æ˜¯æ²¡ç”¨çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨è´Ÿå·ä½œä¸ºæ ‡è®°çš„æ‰‹æ®µï¼Œä¸æ­¤åŒæ—¶ç»å¯¹å€¼ä¿ç•™ä¸ºåŸå–å€¼ï¼Œè¿™æ ·éƒ½ä¸ç”¨æ‹…å¿ƒè¦†ç›–çš„é—®é¢˜ï¼Œä¸éœ€è¦è¿›è¡Œç½®æ¢ï¼Œæ›´å¥½å†™äº†ã€‚æœ¬è´¨æœ‰ç‚¹ç±»ä¼¼å‹ä½ï¼Œåæ­£å°±æ˜¯åœ¨ä¸€ä¸ªintçš„32bité‡Œè¡¨è¾¾æ›´å¤šçš„ä¿¡æ¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linenoiseåº“</title>
      <link href="/2023/09/04/Linenoise%E5%BA%93/"/>
      <url>/2023/09/04/Linenoise%E5%BA%93/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Perl è¯­è¨€</title>
      <link href="/2023/09/04/Perl-%E8%AF%AD%E8%A8%80/"/>
      <url>/2023/09/04/Perl-%E8%AF%AD%E8%A8%80/</url>
      
        <content type="html"><![CDATA[<p>Perl æ˜¯ä¸€ç§è„šæœ¬è¯­è¨€ï¼Œå®ƒå†…ç½®äº†æ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨æ–‡æœ¬å’Œå­—ç¬¦ä¸²å¤„ç†æ–¹é¢æœ‰ä¸€å®šçš„ä¼˜åŠ¿ã€‚</p><p><a href="https://catonmat.net/ftp/perl1line.txt">Perl one liners</a></p><p><a href="https://perldoc.perl.org/perlintro">Perl doc intro</a></p><h2 id="è¿è¡Œ"><a class="header-anchor" href="#è¿è¡Œ">Â¶</a>è¿è¡Œ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">perl prog.pl</span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨shebang</span></span><br><span class="line"><span class="comment">#!/usr/bin/env perl</span></span><br><span class="line"><span class="comment">## ä½¿ç”¨#!/usr/bin/perlåˆ™å›ºå®šäº†perlçš„è·¯å¾„ï¼Œè€Œä»¥ä¸Šå†™æ³•ä¼šåœ¨envä¸­æŸ¥æ‰¾perlçš„å®‰è£…è·¯å¾„ï¼Œä¸ä¸€å®šåœ¨/usr/binä¸‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•è·æ½œåœ¨çš„é—®é¢˜ï¼Œåœ¨5.35ç‰ˆæœ¬åŠä»¥ä¸Šä¼šè‡ªåŠ¨å¯ç”¨ï¼ˆ`use v5.35`ï¼‰</span></span><br><span class="line">use strict;</span><br><span class="line">use warning;</span><br></pre></td></tr></table></figure><h2 id="è¯­æ³•"><a class="header-anchor" href="#è¯­æ³•">Â¶</a>è¯­æ³•</h2><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³¨é‡Š</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ‡é‡ä»¥$èµ·å§‹</span></span><br><span class="line"><span class="keyword">my</span> $var = <span class="number">123</span>; <span class="comment"># ç¬¬ä¸€æ¬¡ä½¿ç”¨å˜é‡ä½¿ç”¨myå…³é”®å­—è¿›è¡Œå£°æ˜ï¼Œè¿™æ˜¯`use strict;`çš„è¦æ±‚ï¼Œå¹¶ä¸”myä¼šåˆ›å»ºå…·æœ‰è¯­æ³•èŒƒå›´çš„å˜é‡ï¼Œå¦åˆ™åˆ›å»ºå…¨å±€å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°ç»„ä»¥@èµ·å§‹ï¼Œè¡¨ç¤ºä¸€åˆ—å€¼ï¼Œç±»å‹å¯ä»¥ä¸åŒ</span></span><br><span class="line"><span class="keyword">my</span> @arr = (<span class="string">&quot;camel&quot;</span>, <span class="number">42</span>, <span class="number">1.23</span>);</span><br><span class="line">$arr[<span class="number">0</span>]; <span class="comment"># ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">$arr[<span class="comment">#arr]; # æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">@arr <span class="comment"># æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="comment">## è·å–å¤šä¸ªå€¼ï¼ˆåˆ‡ç‰‡ï¼‰</span></span><br><span class="line">@arr[<span class="number">0</span>,<span class="number">1</span>]; <span class="comment"># (&quot;camel&quot;, 42)</span></span><br><span class="line">@arr[<span class="number">0</span>..<span class="number">2</span>]; <span class="comment"># (&quot;camel&quot;, 42, 1.23)</span></span><br><span class="line"><span class="keyword">my</span> @sorted_arr = <span class="keyword">sort</span> @arr;</span><br><span class="line"><span class="keyword">my</span> @reversed_arr = <span class="keyword">reverse</span> @arr;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å“ˆå¸Œä»¥%èµ·å§‹ï¼Œè¡¨ç¤ºä¸€ä¸ªé”®å€¼å¯¹é›†åˆï¼Œå†…éƒ¨é¡ºåºä¸å®š</span></span><br><span class="line"><span class="keyword">my</span> %fruit_color = (</span><br><span class="line">    <span class="string">apple =&gt;</span> <span class="string">&quot;red&quot;</span>,</span><br><span class="line">    <span class="string">banana =&gt;</span> <span class="string">&quot;yellow&quot;</span>,</span><br><span class="line">);</span><br><span class="line">$fruit_color&#123;<span class="string">&quot;apple&quot;</span>&#125;; <span class="comment"># &quot;red&quot;</span></span><br><span class="line"><span class="keyword">my</span> fruits = <span class="keyword">keys</span> %fruit_color;</span><br><span class="line"><span class="keyword">my</span> colors = <span class="keyword">values</span> @fruit_color;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¡ä»¶è¯­å¥</span></span><br><span class="line"><span class="keyword">if</span> ($var) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">elsif</span> ($var eq <span class="string">&#x27;bar&#x27;</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unless</span> (condition) &#123; <span class="comment"># ç­‰ä»·äº if (!condition)</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">## å•è¡Œæ¡ä»¶å—å¯ä»¥ä½¿ç”¨æ¡ä»¶åç½®</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;123&quot;</span> <span class="keyword">if</span> $var</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;345&quot;</span> <span class="keyword">unless</span> $var</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾ªç¯è¯­å¥</span></span><br><span class="line"><span class="keyword">while</span> (condition) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">until</span> (condition) &#123; <span class="comment"># ç­‰ä»·äº while (!condition)</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt;= <span class="number">5</span>; $i++) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (@array) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç‰¹æ®Šæ ‡é‡</span></span><br><span class="line">$_ <span class="comment"># é»˜è®¤å˜é‡ï¼Œåœ¨foreachä¸­ä¼šç»‘å®šåˆ°å½“å‰å…ƒç´ ï¼Œä¹Ÿå¯ä»¥å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼Œå®ƒæ˜¯ä¸€äº›å‡½æ•°å’Œæ“ä½œçš„éšå¼é»˜è®¤å‚æ•°ï¼ˆprintï¼Œm//ï¼‰</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="number">1</span>..<span class="number">5</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;$_\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">subroutine</span> </span>&#123;</span><br><span class="line"><span class="comment"># @_æ˜¯å‚æ•°æ•°ç»„ï¼Œ$_[i]è®¿é—®ç¬¬iä¸ªå‚æ•°</span></span><br><span class="line"><span class="comment"># ç”¨returnè¿”å›å€¼ï¼Œæ²¡æœ‰returnåˆ™é»˜è®¤æœ€åä¸€è¡Œè¯­å¥ä½œä¸ºè¿”å›å€¼</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">## åŒå¼•å·ä¼šæ­£å¸¸è§£æè½¬ä¹‰å­—ç¬¦ï¼ˆåŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰å’Œå˜é‡ç­‰ï¼Œè€Œå•å¼•å·ä¿æŒåŸæ ·ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿ç®—ç¬¦</span></span><br><span class="line">=</span><br><span class="line">. <span class="comment"># å­—ç¬¦ä¸²æ‹¼æ¥</span></span><br><span class="line"><span class="keyword">x</span> <span class="comment"># å­—ç¬¦ä¸²é‡å¤</span></span><br><span class="line">.. <span class="comment"># èŒƒå›´è¿ç®—ç¬¦</span></span><br><span class="line">&lt;=&gt; <span class="comment"># å·¦è¾¹å°è¿”å›-1ï¼Œç›¸ç­‰è¿”å›0ï¼Œå·¦è¾¹å¤§è¿”å›1 `cmp`</span></span><br><span class="line"><span class="string">q&#123;&#125;</span> <span class="comment"># æ·»åŠ å•å¼•å·</span></span><br><span class="line"><span class="string">qq&#123;&#125;</span> <span class="comment"># æ·»åŠ åŒå¼•å·</span></span><br><span class="line"><span class="string">qx&#123;&#125;</span> <span class="comment"># æ·»åŠ åå¼•å·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line"><span class="comment">## åŒ¹é… m/regex/ï¼Œå¯çœå»m</span></span><br><span class="line"><span class="comment">## æ›¿æ¢ s/pattern/replacement/</span></span><br><span class="line"><span class="comment">## =~ ç›¸åŒ¹é…</span></span><br><span class="line"><span class="comment">## !~ ä¸åŒ¹é…</span></span><br><span class="line"><span class="keyword">if</span> ($a =~ <span class="regexp">/regex/</span>) &#123; ... &#125;</span><br><span class="line"><span class="keyword">if</span> ($email =~ <span class="regexp">/([^@]+)@(.+)/</span>) &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Username is $1\n&quot;</span>;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;Hostname is $2\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shellé‡å®šå‘</title>
      <link href="/2023/09/03/Shell%E9%87%8D%E5%AE%9A%E5%90%91/"/>
      <url>/2023/09/03/Shell%E9%87%8D%E5%AE%9A%E5%90%91/</url>
      
        <content type="html"><![CDATA[<h2 id="è¾“å…¥-è¾“å‡ºé‡å®šå‘"><a class="header-anchor" href="#è¾“å…¥-è¾“å‡ºé‡å®šå‘">Â¶</a>è¾“å…¥/è¾“å‡ºé‡å®šå‘</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &gt; file <span class="comment"># è¾“å‡ºé‡å®šå‘åˆ°file</span></span><br><span class="line"><span class="built_in">command</span> &lt; file <span class="comment"># è¾“å…¥é‡å®šå‘åˆ°file</span></span><br><span class="line"><span class="built_in">command</span> &gt;&gt; file <span class="comment"># è¾“å‡ºä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘åˆ°file</span></span><br><span class="line">n &gt; file <span class="comment"># æ–‡ä»¶æè¿°ç¬¦ä¸ºnçš„æ–‡ä»¶é‡å®šå‘åˆ°file</span></span><br><span class="line">n &gt;&gt; file</span><br><span class="line">n &gt;&amp; m <span class="comment"># è¾“å‡ºæ–‡ä»¶åˆå¹¶</span></span><br><span class="line">n &lt;&amp; m</span><br><span class="line">&lt;&lt; <span class="string">tag # å°†å¼€å§‹æ ‡è®°tag</span>å’Œç»“æŸæ ‡è®°tagé—´çš„å†…å®¹ä½œä¸ºè¾“å…¥</span><br></pre></td></tr></table></figure><ul><li>æ ‡å‡†è¾“å…¥ï¼šstdinï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º0</li><li>æ ‡å‡†è¾“å‡ºï¼šstdoutï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º1</li><li>æ ‡å‡†é”™è¯¯ï¼šstderrï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º2</li><li>/dev/null</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &gt; file 2&gt;&amp;1 <span class="comment"># stdoutå’Œstderréƒ½è¾“å‡ºåˆ°file</span></span><br></pre></td></tr></table></figure><h2 id="Here-document"><a class="header-anchor" href="#Here-document">Â¶</a>Here document</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n &lt;&lt; <span class="string">delimiter</span></span><br><span class="line"><span class="string">document</span></span><br><span class="line"><span class="string">delimiter</span></span><br></pre></td></tr></table></figure><p>å°†ä¸¤ä¸ªdelimiteré—´çš„å†…å®¹é‡å®šå‘è¾“å‡ºåä½œä¸ºæ ‡å‡†è¾“å…¥ä¼ é€’ç»™æ–‡ä»¶æè¿°ç¬¦nã€‚å…¶ä¸­ç»“å°¾çš„delimiteréœ€è¦é¡¶æ ¼å†™ï¼Œå‘¨å›´ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œä½†å¼€å§‹çš„delimiterå‘¨å›´çš„ç©ºæ ¼ä¼šè¢«å¿½ç•¥ã€‚</p><p>delimiteråº”é€‰æ‹©ä¸ä¼šåœ¨documentä¸­å‡ºç°ï¼Œä¸”ä¸ä¼šå¼•èµ·æ··æ·†çš„å­—ç¬¦ä¸²ï¼ˆå­—æ¯å¼€å¤´ï¼Œå¯åŒ…å«å­—æ¯å’Œæ•°å­—ï¼‰ã€‚</p><p>ä½¿ç”¨<code>&lt;&lt;-</code>ï¼Œå¯ä»¥è®©documentä¿æŒç¼©è¿›ã€‚</p><p>delimiterå¦‚æœåŠ å•/åŒå¼•å·ï¼Œåˆ™documentä¸­çš„å†…å®¹ä¸ä¼šè¿›è¡Œshellæ›¿æ¢ï¼Œå¦‚å˜é‡ã€å‘½ä»¤ç­‰ã€‚</p><p>è¾“å‡ºé‡å®šå‘åœ¨å¼€å§‹çš„delimiteråæŒ‡å®šã€‚</p><h2 id="Here-string"><a class="header-anchor" href="#Here-string">Â¶</a>Here string</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n &lt;&lt;&lt; <span class="string">word # ç­‰ä»·äºecho word</span> | n</span><br></pre></td></tr></table></figure><p>wordåŠ å•å¼•å·ä¸ä¼šè¿›è¡Œshellæ›¿æ¢,åŒå¼•å·æ—¶ä¼šã€‚</p><h2 id="Command-substitution"><a class="header-anchor" href="#Command-substitution">Â¶</a>Command substitution</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">command</span>)</span><br><span class="line">`<span class="built_in">command</span>`</span><br><span class="line">text=<span class="string">&quot;<span class="subst">$(command)</span>&quot;</span></span><br></pre></td></tr></table></figure><p>å‘½ä»¤æ›¿æ¢å…è®¸æ‰§è¡Œå‘½ä»¤å¹¶ç”¨å‘½ä»¤çš„è¾“å‡ºæ›¿æ¢å‘½ä»¤æ–‡æœ¬ã€‚</p><h2 id="Process-substitution"><a class="header-anchor" href="#Process-substitution">Â¶</a>Process substitution</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;(<span class="built_in">command</span>)</span><br><span class="line">&gt;(<span class="built_in">command</span>)</span><br><span class="line">diff &lt;(<span class="built_in">ls</span> dir1) &lt;(<span class="built_in">ls</span> dir2) <span class="comment"># æ¯”è¾ƒä¸¤ä¸ªå‘½ä»¤çš„è¾“å‡º</span></span><br></pre></td></tr></table></figure><p>è¿›ç¨‹æ›¿æ¢å…è®¸å°†å‘½ä»¤çš„è¾“å‡ºä¿å­˜åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼ˆå‘½åç®¡é“ï¼‰ä¸­ï¼Œç„¶åä½œä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> &lt;(<span class="built_in">ls</span>)</span><br><span class="line">/proc/self/fd/13</span><br><span class="line">$ <span class="built_in">cat</span> &lt;&lt;&lt;<span class="string">&quot;<span class="subst">$(ls)</span>&quot;</span></span><br><span class="line">$ <span class="built_in">cat</span> &lt; &lt;(<span class="built_in">ls</span>)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;<span class="subst">$(ls)</span>&quot;</span> | <span class="built_in">cat</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼šè¯¸å¦‚ç®¡é“ã€è¾“å…¥é‡å®šå‘ã€here documentã€here stringéƒ½æ˜¯å°†å†…å®¹æ¨é€åˆ°æ ‡å‡†è¾“å…¥æµä¸­ï¼Œè€Œè¿›ç¨‹æ›¿æ¢åˆ™æ˜¯ä¿å­˜åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¹¶ç”¨ä¸´æ—¶æ–‡ä»¶åæ¥æ›¿æ¢å‘½ä»¤ã€‚è¿™æ˜¾ç„¶æ›´å¼ºå¤§ã€‚å¯ä»¥é€šè¿‡<code>&lt; &lt;(command)</code>æ¥æ¨é€åˆ°æ ‡å‡†è¾“å…¥æµã€‚</p><p>å¦å¤–æ³¨æ„æ˜¯å¦æ·»åŠ å¼•å·å¯èƒ½ä¼šæœ‰åŒºåˆ«ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è¯­è¨€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csmithâ€”â€”ç”Ÿæˆç”¨äºæµ‹è¯•çš„éšæœºCç¨‹åº</title>
      <link href="/2023/09/03/Csmith%E2%80%94%E2%80%94%E7%94%9F%E6%88%90%E7%94%A8%E4%BA%8E%E6%B5%8B%E8%AF%95%E7%9A%84%E9%9A%8F%E6%9C%BAC%E7%A8%8B%E5%BA%8F/"/>
      <url>/2023/09/03/Csmith%E2%80%94%E2%80%94%E7%94%9F%E6%88%90%E7%94%A8%E4%BA%8E%E6%B5%8B%E8%AF%95%E7%9A%84%E9%9A%8F%E6%9C%BAC%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p>Csmith èƒ½å¤Ÿéšæœºç”Ÿæˆ<strong>æ²¡æœ‰æœªå®šä¹‰è¡Œä¸º</strong>çš„Cç¨‹åºï¼ˆå€ŸåŠ©é™æ€è§„åˆ™å’Œè¿è¡Œæ—¶æ£€æŸ¥ï¼‰ï¼Œç”¨äºç¼–è¯‘å™¨ã€é™æ€åˆ†æå™¨ç­‰å¤„ç†æºä»£ç çš„å·¥å…·çš„æµ‹è¯•ã€‚</p><p>æ³¨æ„ï¼šç”Ÿæˆçš„ç¨‹åºå¯èƒ½åŒ…å«æ­»å¾ªç¯ï¼Œå¹¶ä¸”æ¯•ç«Ÿæ˜¯éšæœºç”Ÿæˆçš„ï¼Œä¸äººå†™çš„ä»£ç è¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚è€Œä¸”Csmith åªèƒ½ç”Ÿæˆ<strong>Cç¨‹åº</strong>ï¼Œä¸èƒ½ç”Ÿæˆ<strong>C++ç¨‹åº</strong>ã€‚<a href="https://github.com/intel/yarpgen">yarpgen</a>å¯ä»¥éšæœºç”ŸæˆC++ç¨‹åºã€‚</p><h2 id="éšæœºæµ‹è¯•-å·®åˆ†æµ‹è¯•"><a class="header-anchor" href="#éšæœºæµ‹è¯•-å·®åˆ†æµ‹è¯•">Â¶</a>éšæœºæµ‹è¯•+å·®åˆ†æµ‹è¯•</h2><p>åŒ…å«å¦‚ä¸‹ä¸‰æ­¥ï¼š</p><ul><li>ä½¿ç”¨Csmithç”Ÿæˆå¤§é‡æœ‰æ•ˆçš„Cç¨‹åº</li><li>ç”¨ä¸åŒç‰ˆæœ¬çš„ç¼–è¯‘å™¨è¿è¡ŒåŒä¸€ä¸ªCç¨‹åº</li><li>æ¯”è¾ƒç¼–è¯‘å™¨çš„è¾“å‡ºï¼Œä»¥å¤šæ•°çš„ç»“æœä½œä¸ºæ­£ç¡®è¾“å‡º</li></ul><p><a data-fancybox="gallery" data-src="/post-images/Csmith.png" data-caption="Csmith éšæœºæµ‹è¯•+å·®åˆ†æµ‹è¯•"><img src="/post-images/Csmith.png" alt="Csmith éšæœºæµ‹è¯•+å·®åˆ†æµ‹è¯•"></a></p><h2 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">Â¶</a>å®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/csmith-project/csmith.git</span><br><span class="line"><span class="built_in">cd</span> csmith</span><br><span class="line">sudo apt install g++ cmake m4</span><br><span class="line">cmake -DCMAKE_INSTALL_PREFIX=<span class="variable">$HOME</span>/csmith .</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„<code>m4</code>æ˜¯ä¸€ä¸ªæ–‡æœ¬å¤„ç†å·¥å…·ï¼Œé€šå¸¸ç”¨äºå®å¤„ç†å’Œæ–‡æœ¬æ›¿æ¢ã€‚å®ƒå¯ä»¥ç”¨æ¥ç¼–å†™ã€ç»´æŠ¤å’Œç”Ÿæˆå„ç§ç±»å‹çš„æ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ã€è„šæœ¬ã€ç¨‹åºæºä»£ç ç­‰ã€‚</p><h2 id="è¿è¡Œ"><a class="header-anchor" href="#è¿è¡Œ">Â¶</a>è¿è¡Œ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HME</span>/csmith/bin</span><br><span class="line">csmith &gt; random1.c</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šç”Ÿæˆçš„ç¨‹åºçš„è¾“å‡ºå›ºå®šä¸º<code>checksum = xxx</code>çš„å½¢å¼ï¼Œé€šè¿‡æ¯”è¾ƒè¿è¡Œåè¾“å‡ºçš„checksumçš„å€¼æ¥åˆ¤æ–­ç¼–è¯‘å™¨æ˜¯å¦æ­£ç¡®ç¼–è¯‘ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GNU Binutils</title>
      <link href="/2023/09/03/GNU-Binutils/"/>
      <url>/2023/09/03/GNU-Binutils/</url>
      
        <content type="html"><![CDATA[<p>Binutils æ˜¯ç”±å¾ˆå¤šå¤„ç†æ±‡ç¼–æ–‡ä»¶ã€ç›®æ ‡æ–‡ä»¶ä»¥åŠåº“çš„äºŒè¿›åˆ¶å¼€å‘å·¥å…·ç»„æˆçš„é›†åˆã€‚</p><h2 id="as"><a class="header-anchor" href="#as">Â¶</a>as</h2><p>æ±‡ç¼–å™¨ï¼Œå°†æ±‡ç¼–ä»£ç è½¬åŒ–ä¸ºç›®æ ‡æ–‡ä»¶ã€‚åœ¨ä¸æä¾›<code>-o</code>é€‰é¡¹æ—¶ï¼Œé»˜è®¤è¾“å‡ºåˆ°a.outæ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">as file.s -o file.o</span><br><span class="line">as --32/--64 file.s # 32/64 bit</span><br></pre></td></tr></table></figure><h3 id="ç›®æ ‡æ–‡ä»¶"><a class="header-anchor" href="#ç›®æ ‡æ–‡ä»¶">Â¶</a>ç›®æ ‡æ–‡ä»¶</h3><p>ä¹Ÿå«å¯é‡å®šä½æ–‡ä»¶ï¼Œæ˜¯ç»è¿‡ç¼–è¯‘ä½†è¿˜æœªè¿›è¡Œé“¾æ¥çš„ä¸­é—´æ–‡ä»¶ã€‚</p><h2 id="ld"><a class="header-anchor" href="#ld">Â¶</a>ld</h2><p>é“¾æ¥å™¨ï¼Œå°†è‹¥å¹²ç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ld file1.o file2.o -o exe</span><br><span class="line">ld file.o --dynamic-linker /lib64/ld-linux-x86-64.so.2 -e main -lc -o exe</span><br></pre></td></tr></table></figure><p>è™½ç„¶è¯´<code>gcc</code>åœ¨å°†æºä»£ç ç¼–è¯‘æˆæ±‡ç¼–åå°±æ˜¯ä¾é <code>as</code>å’Œ<code>ld</code>æ¥ç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ<code>gcc -v</code>æ˜¾ç¤ºçš„æ˜¯<code>collect2</code>ï¼Œä¸è¿‡è¿™å…¶å®åªæ˜¯<code>ld</code>çš„å°è£…ï¼‰ï¼Œä½†æ˜¯æ‰‹åŠ¨ä½¿ç”¨<code>gcc -S</code>ï¼Œ<code>as</code>å’Œ<code>ld</code>æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ä¼šäº§ç”Ÿå¾ˆå¤šé—®é¢˜ï¼ˆæˆ‘åˆ°ç°åœ¨éƒ½è¿˜æ²¡æˆåŠŸï¼‰ï¼Œæ¯”å¦‚å…¥å£å‡½æ•°ã€ç¨‹åºç»ˆæ­¢ç­‰ç­‰ã€‚</p><h2 id="nm"><a class="header-anchor" href="#nm">Â¶</a>nm</h2><p>åˆ—å‡ºç›®æ ‡æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nm file</span><br><span class="line">-g # åˆ—å‡ºå…¨å±€ç¬¦å·</span><br><span class="line">-u # åˆ—å‡ºæœªå®šä¹‰ç¬¦å·</span><br><span class="line">-a # åˆ—å‡ºæ‰€æœ‰ç¬¦å·</span><br><span class="line">--demangle # è¿˜åŸC++ä¸­ä¿®é¥°äº†çš„ç¬¦å·</span><br></pre></td></tr></table></figure><p>ç¬¦å·ç±»å‹ï¼šå¤§å†™ä¸ºå…¨å±€ï¼Œå°å†™ä¸ºå±€éƒ¨ã€‚</p><ul><li>U: æœªå®šä¹‰ç¬¦å·</li><li>T: æ–‡æœ¬ç¬¦å·</li><li>D: æ•°æ®ç¬¦å·</li><li>B: bssç¬¦å·</li><li>A: ç»å¯¹ç¬¦å·</li></ul><h2 id="size"><a class="header-anchor" href="#size">Â¶</a>size</h2><p>åˆ—å‡ºç›®æ ‡æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶ä¸­å„ä¸ªèŠ‚çš„å¤§å°ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">size file</span><br></pre></td></tr></table></figure><p>è¾“å‡ºåŒ…æ‹¬textï¼Œdataï¼Œbssï¼Œdecï¼Œhexå’Œfilenameåˆ—ï¼Œå…¶ä¸­decå’Œhexæ˜¯æ€»å¤§å°çš„åè¿›åˆ¶å’Œåå…­è¿›åˆ¶è¡¨ç¤ºã€‚</p><h2 id="strings"><a class="header-anchor" href="#strings">Â¶</a>strings</h2><p>åˆ—å‡ºç›®æ ‡æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶ä¸­å¯æ‰“å°çš„å­—ç¬¦ä¸²ï¼Œé»˜è®¤åªæœç´¢æ•°æ®æ®µã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strings file</span><br><span class="line">strings -a file</span><br><span class="line">string -n number file # é™åˆ¶é•¿åº¦è‡³å°‘ä¸ºnumber</span><br></pre></td></tr></table></figure><h2 id="strip"><a class="header-anchor" href="#strip">Â¶</a>strip</h2><p>å»é™¤ç¬¦å·è¡¨ï¼Œå‡å°æ–‡ä»¶å¤§å°å¹¶åŠ é€Ÿæ‰§è¡Œã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">strip file</span><br><span class="line">strip --strip-all file</span><br><span class="line">strip --strip-debug file</span><br><span class="line">strip --strip-unneeded file</span><br><span class="line">strip file -o stripped_file # é»˜è®¤æ˜¯æ›¿æ¢æºæ–‡ä»¶ï¼Œ-oåˆ™ç”Ÿæˆä¸€ä¸ªæ–°æ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="c-filt"><a class="header-anchor" href="#c-filt">Â¶</a>c++filt</h2><p>è¿˜åŸä¿®é¥°çš„C++ç¬¦å·ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c++filt _Z1fv</span><br></pre></td></tr></table></figure><h2 id="addr2line"><a class="header-anchor" href="#addr2line">Â¶</a>addr2line</h2><p>å°†å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„åœ°å€ç¿»è¯‘ä¸ºå¯¹åº”çš„è¡Œå·å’Œæ–‡ä»¶åï¼Œéœ€è¦ç¼–è¯‘ä¿¡æ¯ï¼ˆ<code>-g</code>ï¼‰ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addr2line -e exe --functions --demangle address </span><br></pre></td></tr></table></figure><p>å¯ä»¥å°†æ±‡ç¼–ä»£ç å’Œæºæ–‡ä»¶ä»£ç ä¸€ä¸€å¯¹åº”èµ·æ¥ï¼Œå¸®åŠ©ç†è§£ã€‚</p><h2 id="gprof"><a class="header-anchor" href="#gprof">Â¶</a>gprof</h2><p>ç”¨äºç¨‹åºæ€§èƒ½åˆ†æï¼Œéœ€è¦<code>-pg</code>é€‰é¡¹ä»¥åœ¨æ¯ä¸ªå‡½æ•°å…¥å£å¤„æ’å…¥<code>mcount</code>å‡½æ•°ç”¨äºæ’æ¡©ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./exe # è¿è¡Œåä¼šç”Ÿæˆä¸€ä¸ªgmon.outæ–‡ä»¶</span><br><span class="line">gprof exe gmon.out &gt; analysis.txt</span><br></pre></td></tr></table></figure><p>ç¼ºç‚¹ï¼š</p><ul><li>è®¡æ—¶åŸºäºé‡‡æ ·ï¼Œä¸å‡†ç¡®</li><li>åªåˆ†æç”¨æˆ·æ€ä»£ç </li><li>ä¸åˆ†æå…±äº«åº“ä»£ç </li><li>åªè§‚æµ‹ä¸»çº¿ç¨‹ï¼Œä¸”ä¸ä¸€å®šçº¿ç¨‹å®‰å…¨</li></ul><h2 id="ar"><a class="header-anchor" href="#ar">Â¶</a>ar</h2><p>ç”¨äºå»ºç«‹ã€ä¿®æ”¹é™æ€åº“æˆ–ä»é™æ€åº“ä¸­æå–æ–‡ä»¶ã€‚å…¶ä¸­é™æ€åº“ä¸­åŒ…å«äº†æŒ‰ç…§ç‰¹å®šç»“æ„ç»„ç»‡èµ·æ¥çš„ä¸€ç»„ç›®æ ‡æ–‡ä»¶ï¼ˆç§°ä¸ºæˆå‘˜ï¼Œæœ‰.aã€.soã€.oç­‰ç±»å‹ï¼‰ï¼Œå¹¶ä¿ç•™å„ä¸ªæ–‡ä»¶çš„åŸå§‹ä¿¡æ¯ã€‚</p><p>æ³¨ï¼š<code>ar</code>å‘½ä»¤åˆ›å»ºçš„æ–‡ä»¶ç”¨äºå­˜å‚¨ç¼–è¯‘åçš„ç›®æ ‡æ–‡ä»¶ä»¥ä¾›é“¾æ¥ï¼Œè€Œ<code>tar</code>å‘½ä»¤åˆ›å»ºçš„æ–‡ä»¶ç”¨äºç»„ç»‡å’Œå½’æ¡£æ–‡ä»¶å’Œç›®å½•ã€‚è¿™ä¸¤ç§å‘½ä»¤çš„ä¸»è¦ç”¨é€”å’Œæ–‡ä»¶æ ¼å¼å®Œå…¨ä¸åŒã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ar crv liba.a file1.o file2.o</span><br></pre></td></tr></table></figure><h2 id="ranlib"><a class="header-anchor" href="#ranlib">Â¶</a>ranlib</h2><p>åœ¨æ›´æ–°é™æ€åº“åï¼Œæ›´æ–°ç¬¦å·è¡¨ä¿¡æ¯ï¼ˆä¸€èˆ¬ä¸éœ€è¦ä½¿ç”¨ï¼Œè¯¥åŠŸèƒ½ç­‰ä»·äº<code>ar -s</code>ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ranlib liba.a</span><br></pre></td></tr></table></figure><h2 id="readelf"><a class="header-anchor" href="#readelf">Â¶</a>readelf</h2><p>æ˜¾ç¤ºELFæ ¼å¼æ–‡ä»¶çš„ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">readelf -h file</span><br><span class="line">readelf -a file</span><br><span class="line">readelf -s file # ç¬¦å·è¡¨</span><br><span class="line">readelf -r file # å¯é‡å®šä½è¡¨</span><br><span class="line">readelf -S file # èŠ‚å¤´è¡¨</span><br><span class="line">readelf -l file # ç¨‹åºå¤´è¡¨</span><br><span class="line">-W # è¾“å‡ºä¸æ¢è¡Œ</span><br></pre></td></tr></table></figure><h2 id="objdump"><a class="header-anchor" href="#objdump">Â¶</a>objdump</h2><p>æ˜¾ç¤ºç›®æ ‡æ–‡ä»¶çš„ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">objdump -d file # åæ±‡ç¼–</span><br><span class="line">objdump -d -S file # ä¸æºä»£ç å¯¹åº”</span><br><span class="line">objdump -d -l file # ä¸æºä»£ç ä¸­çš„è¡Œå·å¯¹åº”</span><br><span class="line">objdump -M intel -d file # ä½¿ç”¨intelæ ¼å¼</span><br><span class="line">objdump -f file # æŸ¥çœ‹æ–‡ä»¶å¤´ä¿¡æ¯</span><br></pre></td></tr></table></figure><h2 id="objcopy"><a class="header-anchor" href="#objcopy">Â¶</a>objcopy</h2><p>å°†ä¸€ç§ç±»å‹çš„ç›®æ ‡æ–‡ä»¶è½¬åŒ–ä¸ºå¦ä¸€ç§ç±»å‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objcopy --only-keep-debug file file.debuginfo # æŠ½å–å‡ºè°ƒè¯•ä¿¡æ¯</span><br></pre></td></tr></table></figure><h2 id="libiberty"><a class="header-anchor" href="#libiberty">Â¶</a>libiberty</h2><h2 id="libbfd"><a class="header-anchor" href="#libbfd">Â¶</a>libbfd</h2><p>äºŒè¿›åˆ¶æè¿°ç¬¦åº“ã€‚</p><h2 id="libopcodes"><a class="header-anchor" href="#libopcodes">Â¶</a>libopcodes</h2>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»ˆç«¯æ¨¡æ‹Ÿå™¨</title>
      <link href="/2023/08/26/%E7%BB%88%E7%AB%AF%E6%A8%A1%E6%8B%9F%E5%99%A8/"/>
      <url>/2023/08/26/%E7%BB%88%E7%AB%AF%E6%A8%A1%E6%8B%9F%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>ç”¨äºå¹³æ›¿Xshellå’ŒXftpã€‚</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>å¤–è§‚/å­—ä½“ï¼šæ”¯æŒNerd Font</p><p>ç»ˆç«¯/å³é”®ç‚¹å‡»ï¼šç²˜è´´</p><p>ç»ˆç«¯/æŒ‰ä¸‹æŒ‰é”®æ¥ç‚¹å‡»é“¾æ¥ï¼š<code>Ctrl</code>ï¼ˆé˜²æ­¢è¯¯ç‚¹é“¾æ¥ï¼‰</p><p>ç»ˆç«¯/é€‰ä¸­æ—¶å¤åˆ¶ï¼šå…³é—­</p><p>é…è‰²æ–¹æ¡ˆï¼šNord</p><p>å¿«æ·é”®ï¼š</p><ul><li><code>Ctrl-Shift-O</code>: å…³é—­å½“å‰èšç„¦çš„çª—æ ¼ (Cl<ins>o</ins>se)</li></ul><p>æ’ä»¶ï¼š</p><ul><li><code>community-color-schemes</code></li><li><code>docker</code></li><li><code>search-in-browser</code>ï¼šé€‰ä¸­æ–‡å­—ï¼Œ<strong>é•¿æŒ‰</strong>å³é”®åé€‰æ‹©åœ¨æµè§ˆå™¨ä¸­æœç´¢</li><li><code>trzsz</code>ï¼šä¸²è¡Œé€šä¿¡ç¯å¢ƒä¸‹çš„æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œæœ‰è¿›åº¦æ¡å¹¶æ”¯æŒç›®å½•ä¼ è¾“ï¼ˆlrzszåŠ å¼ºç‰ˆï¼‰</li></ul><p>çª—å£/ä¸é€æ˜åº¦ï¼šè‡ªè¡Œè°ƒæ•´</p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><ul><li>å¤åˆ¶ï¼š<code>Ctrl+Shift+C</code></li><li>ç²˜è´´ï¼š<code>Ctrl+Shift+V</code>/å³é”®</li><li>èœå•ï¼šé•¿æŒ‰å³é”®</li><li><code>Ctrl+Shift+S</code>ï¼šå‘å³æ‹†åˆ†çª—å£ (<ins>S</ins>plit)</li><li><code>Ctrl+Shift+D</code>ï¼šå‘ä¸‹æ‹†åˆ†çª—å£ (<ins>D</ins>own)</li><li><code>trzsz</code>(<code>trz/tsz</code>)ï¼šä¸»è¦ç”¨äºè§£å†³æ–‡ä»¶å¤¹ä»¥åŠæ‰¹é‡æ–‡ä»¶ä¸‹è½½çš„<ul><li><code>trz dir/</code>ï¼šä¸Šä¼ æ–‡ä»¶åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹ï¼ˆ<ins>R</ins>eceiveï¼Œå³æ¥æ”¶åˆ°å½“å‰æœåŠ¡å™¨ï¼‰</li><li><code>tsz file1 file2</code>ï¼šä¸‹è½½ï¼ˆå¤šä¸ªï¼‰æ–‡ä»¶ï¼ˆ<ins>S</ins>endï¼Œå³ä»å½“å‰æœåŠ¡å™¨å‘é€ï¼‰</li><li><code>trz -d</code>å’Œ<code>tsz -r</code>ï¼šå…è®¸æ–‡ä»¶å¤¹ä¼ è¾“</li><li><code>-b</code>ï¼šäºŒè¿›åˆ¶ä¼ è¾“ï¼Œå¯¹å‹ç¼©åŒ…ã€å›¾ç‰‡ç­‰æ›´å¿«</li><li><code>-e</code>ï¼šè½¬ç§»æ§åˆ¶å­—ç¬¦</li><li><code>-y</code>ï¼šè¦†ç›–åŒåæ–‡ä»¶/æ–‡ä»¶å¤¹ï¼Œå¹¶æ”¯æŒæ–­ç‚¹ç»­ä¼ </li><li>è®¾ç½®<code>Enable drag files and directories</code>åå…è®¸ç›´æ¥æ‹–åŠ¨æ–‡ä»¶/æ–‡ä»¶å¤¹è¿›è¡Œä¸Šä¼ </li></ul></li></ul><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p>trzszï¼š<br><img src="/post-images/trzsz.png" alt="trzä¸Šä¼ æ–‡ä»¶"></p><h2 id="MobaXterm"><a href="#MobaXterm" class="headerlink" title="MobaXterm"></a>MobaXterm</h2><ul><li>å­—ä½“ï¼šFiraCode Nerfï¼ˆæ³¨æ„MobadXtermä¸æ”¯æŒtruetypeå­—ä½“ï¼Œæ‰€ä»¥å¿…é¡»å°†.ttlæ–‡ä»¶è½¬æ¢ä¸º.otfæ–‡ä»¶åå®‰è£…ï¼‰</li><li>å­—å·ï¼š9</li><li>é¢œè‰²é¥±å’Œåº¦ï¼š30%</li><li>é€æ˜åº¦ï¼š10%</li><li>é¢œè‰²ä¸»é¢˜ï¼šsoft pastel</li><li>å¯ç”¨å³é”®å¤åˆ¶ç²˜è´´</li><li>å…³é—­ç™»å½•è‡ªåŠ¨åˆ‡æ¢åˆ°SSH-browser</li><li>å¯ç”¨SSHä¿æ´»</li><li>å…³é—­æ‰€æœ‰è¯­æ³•é«˜äº®</li><li>Bell Typeè®¾ç½®ä¸ºå¯è§†åŒ–</li><li>Cursor colorè®¾ç½®ä¸ºBlinking block</li><li>è®¾ç½®Paste in Terminalçš„å¿«æ·é”®ä¸ºCtrl-Shift-V</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vim æ€»ç»“</title>
      <link href="/2023/08/25/vim%E6%80%BB%E7%BB%93/"/>
      <url>/2023/08/25/vim%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="vimå¸¸ç”¨é”®"><a class="header-anchor" href="#vimå¸¸ç”¨é”®">Â¶</a>vimå¸¸ç”¨é”®</h2><p><code>verb + noun</code> (cperator [number] motion/object)</p><h3 id="å‘½ä»¤"><a class="header-anchor" href="#å‘½ä»¤">Â¶</a>å‘½ä»¤</h3><ul><li><code>:e file</code>ï¼šæ‰“å¼€æ–‡ä»¶</li><li><code>:enew</code></li><li><code>:e</code>ï¼šé‡æ–°åŠ è½½å½“å‰æ–‡ä»¶</li><li><code>:wq</code>, <code>:x</code>ï¼š<code>x</code>ç­‰äº<code>wq</code></li><li><code>vim +line_number path/to/file</code>ï¼šæ‰“å¼€æ–‡ä»¶çš„æŒ‡å®šè¡Œï¼ˆçœç•¥line_numberåˆ™ä½äºæ–‡ä»¶æœ«å°¾ï¼‰</li><li><code>!cmd</code>ï¼šæ‰§è¡Œå¤–éƒ¨å‘½ä»¤</li></ul><h3 id="ç¼–è¾‘"><a class="header-anchor" href="#ç¼–è¾‘">Â¶</a>ç¼–è¾‘</h3><ul><li><code>i</code>ï¼šå…‰æ ‡å‰æ’å…¥</li><li><code>a</code>ï¼šå…‰æ ‡åæ’å…¥</li><li><code>o</code>ï¼šä¸‹ä¸€è¡Œæ’å…¥</li><li><code>O</code>ï¼šä¸Šä¸€è¡Œæ’å…¥</li><li><code>I</code>ï¼šå½“å‰è¡Œå¼€å¤´æ’å…¥</li><li><code>A</code>ï¼šå½“å‰è¡Œç»“å°¾æ’å…¥</li><li><code>u</code>ï¼šæ’¤é”€ä¸Šä¸€æ¬¡æ”¹åŠ¨</li><li><code>Ctrl-r</code>ï¼šé‡åš</li><li><code>U</code>ï¼šæ’¤é”€å½“å‰è¡Œçš„æ‰€æœ‰æ”¹åŠ¨</li></ul><h3 id="åŠ¨ä½œ"><a class="header-anchor" href="#åŠ¨ä½œ">Â¶</a>åŠ¨ä½œ</h3><ul><li><p><code>y</code>ï¼šå¤åˆ¶</p></li><li><p><code>p</code>ï¼šç²˜è´´</p></li><li><p><code>d</code>ï¼šåˆ é™¤</p></li><li><p><code>c</code>ï¼šæ›¿æ¢</p></li><li><p><code>x</code>ï¼šåˆ é™¤å•ä¸ªå­—ç¬¦</p></li><li><p><code>r</code>ï¼šæ›¿æ¢å•ä¸ªå­—ç¬¦</p></li><li><p><code>R</code>ï¼šè¿ç»­æ›¿æ¢å¤šä¸ªå­—ç¬¦</p></li><li><p><code>~</code>ï¼šä¿®æ”¹å¤§å°å†™</p></li><li><p><code>.</code>ï¼šé‡å¤ä¸Šä¸€æ¬¡<strong>æ›´æ”¹</strong></p></li></ul><h3 id="ç§»åŠ¨"><a class="header-anchor" href="#ç§»åŠ¨">Â¶</a>ç§»åŠ¨</h3><ul><li><p><code>hjkl</code>ï¼šä¸Šä¸‹å·¦å³</p></li><li><p><code>gg</code>ï¼šé¦–è¡Œ</p></li><li><p><code>G</code>ï¼šæœ€åä¸€è¡Œ</p></li><li><p><code>%</code>ï¼šç§»åŠ¨åˆ°åŒ¹é…çš„æ‹¬å·å¤„</p></li><li><p><code>n%</code>ï¼šç§»åŠ¨åˆ°æ–‡ä»¶çš„n%ä½ç½®å¤„</p></li><li><p><code>^</code>ï¼šå½“å‰è¡Œå¼€å¤´ï¼ˆç¬¬ä¸€ä¸ªéç©ºç™½å­—ç¬¦ï¼‰</p></li><li><p><code>0</code>ï¼šå½“å‰è¡Œå¼€å¤´ï¼ˆç¬¬ä¸€ä¸ªå­—ç¬¦ï¼‰</p></li><li><p><code>$</code>ï¼šå½“å‰è¡Œç»“å°¾ï¼ˆæœ€åä¸€ä¸ªå­—ç¬¦ï¼‰</p></li><li><p><code>n|</code>ï¼šå½“å‰è¡Œçš„ç¬¬<code>n</code>åˆ—</p></li><li><p><code>b</code>ï¼šå‰ä¸€ä¸ªwordçš„ç»“å°¾</p></li><li><p><code>w</code>ï¼šåä¸€ä¸ªwordçš„å¼€å¤´</p></li><li><p><code>e</code>ï¼šåä¸€ä¸ªwordçš„ç»“å°¾</p></li><li><p><code>BWE</code>ï¼šWORDæ˜¯é™¤ç©ºç™½ç¬¦å¤–çš„å­—ç¬¦åºåˆ—ï¼Œç›¸æ¯”äºwordå¯ä»¥åŒ…å«æ ‡ç‚¹ç¬¦å·</p></li><li><p><code>fx</code>ï¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦<code>x</code> (find)</p></li><li><p><code>Fx</code>ï¼šç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªå­—ç¬¦<code>x</code></p></li><li><p><code>;</code>ï¼šé‡å¤<code>fF</code>ç§»åŠ¨</p></li><li><p><code>,</code>ï¼šåå‘ç§»åŠ¨</p></li><li><p><code>(</code>ï¼šå‰ä¸€ä¸ªå¥å­</p></li><li><p><code>)</code>ï¼šåä¸€ä¸ªå¥å­</p></li><li><p><code>&#123;</code>ï¼šå‰ä¸€ä¸ªæ®µè½</p></li><li><p><code>&#125;</code>ï¼šåä¸€ä¸ªæ®µè½</p></li><li><p><code>Ctrl-d</code>ï¼šå‘ä¸‹æ»šåŠ¨åŠä¸ªå±å¹•</p></li><li><p><code>Ctrl-f</code>ï¼šå‘ä¸‹æ»šåŠ¨ä¸€ä¸ªå±å¹•</p></li><li><p><code>Ctrl-u</code>ï¼šå‘ä¸Šæ»šåŠ¨åŠä¸ªå±å¹•</p></li><li><p><code>Ctrl-b</code>ï¼šå‘ä¸Šæ»šåŠ¨ä¸€ä¸ªå±å¹•</p></li><li><p><code>zt</code>ï¼šå°†å½“å‰è¡Œç½®äºå±å¹•é¡¶éƒ¨</p></li><li><p><code>zz</code>ï¼šå°†å½“å‰è¡Œç½®äºå±å¹•ä¸­å¤®</p></li><li><p><code>zb</code>ï¼šå°†å½“å‰è¡Œç½®äºå±å¹•åº•éƒ¨</p></li><li><p><code>/</code>ï¼šæ­£å‘æœç´¢</p></li><li><p><code>?</code>ï¼šé€†å‘æœç´¢</p></li><li><p><code>n</code>ï¼šä¸‹ä¸€ä¸ªåŒ¹é…</p></li><li><p><code>N</code>ï¼šä¸Šä¸€ä¸ªåŒ¹é…</p></li><li><p><code>*</code>ï¼šå¿«é€Ÿæ­£å‘æœç´¢å½“å‰å•è¯</p></li><li><p><code>#</code>ï¼šå¿«é€Ÿé€†å‘æœç´¢å½“å‰å•è¯</p></li><li><p><code>%s/regexp/replacement/g</code>ï¼šå…¨å±€æ›¿æ¢ï¼ˆä¸åŠ gåˆ™åªä¿®æ”¹ä¸€æ¬¡ï¼‰</p></li><li><p><code>%s/regexp/replacement/gc</code>ï¼šå¯¹æ¯ä¸ªæ›¿æ¢éƒ½æé—®æ˜¯å¦è¿›è¡Œ</p></li></ul><h3 id="å¯¹è±¡"><a class="header-anchor" href="#å¯¹è±¡">Â¶</a>å¯¹è±¡</h3><ul><li><p><code>i object</code>: inner object</p></li><li><p><code>a object</code>: around object</p></li><li><p><code>w</code>: word</p></li><li><p><code>p</code>: paragraph</p></li><li><p><code>s</code>: sentence</p></li><li><p><code>(</code>/<code>)</code>: a pair of ( )</p></li><li><p><code>[</code>/<code>]</code>: a pair of [ ]</p></li><li><p><code>&#123;</code>/<code>&#125;</code>: a pair of { }</p></li><li><p><code>&lt;</code>/<code>&gt;</code>: a pair of &lt; &gt;</p></li><li><p>&quot;: a pair of &quot; &quot;</p></li><li><p>': a pair of â€™ â€™</p></li><li><p><code>: a pair of </code> `</p></li></ul><h3 id="å¤šçª—å£æµè§ˆ"><a class="header-anchor" href="#å¤šçª—å£æµè§ˆ">Â¶</a>å¤šçª—å£æµè§ˆ</h3><ul><li>å‘ä¸‹åˆ‡åˆ†ï¼š<code>:sp [file]</code></li><li>å‘å³åˆ‡åˆ†ï¼š<code>:vsp [file]</code></li><li>ä¸Šä¸‹å·¦å³ç§»åŠ¨ï¼š<code>&lt;Ctrl-h/j/k/l&gt;</code></li><li>å…³é—­å½“å‰çª—å£ï¼š<code>:q</code></li></ul><h3 id="æŠ˜å "><a class="header-anchor" href="#æŠ˜å ">Â¶</a>æŠ˜å </h3><ul><li><code>za</code>ï¼šç¿»è½¬æŠ˜å </li><li><code>zR</code>ï¼šå–æ¶ˆæ‰€æœ‰æŠ˜å </li><li><code>zM</code>ï¼šæ‰§è¡Œæ‰€æœ‰æŠ˜å </li></ul><h3 id="é€‰æ‹©æ¨¡å¼"><a class="header-anchor" href="#é€‰æ‹©æ¨¡å¼">Â¶</a>é€‰æ‹©æ¨¡å¼</h3><ul><li><code>&gt;</code>ï¼šå³ç§»</li><li><code>&lt;</code>ï¼šå·¦ç§»</li><li><code>y</code>ï¼šå¤åˆ¶</li><li><code>d</code>ï¼šåˆ é™¤</li><li><code>u</code>ï¼šå°å†™åŒ–</li><li><code>U</code>ï¼šå¤§å†™åŒ–</li></ul><h3 id="é€‰é¡¹"><a class="header-anchor" href="#é€‰é¡¹">Â¶</a>é€‰é¡¹</h3><ul><li>è®¾ç½®ç¼©è¿›å¤§å°ï¼š<code>:set shiftwidth=4</code></li><li>è®¾ç½®wrapï¼š<code>set wrap</code></li><li>æŸ¥çœ‹æ–‡ä»¶ç±»å‹ï¼š<code>set filetype?</code></li></ul><h2 id="Neovimé…ç½®"><a class="header-anchor" href="#Neovimé…ç½®">Â¶</a>Neovimé…ç½®</h2><h3 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">Â¶</a>å®‰è£…</h3><p>Ubuntu aptå®‰è£…çš„ç‰ˆæœ¬è¾ƒæ—§ï¼Œæ‰€ä»¥é€‰æ‹©è‡ªè¡Œå®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼ˆç›®å‰æ˜¯0.9.5ï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -LO https://github.com/neovim/neovim/releases/download/v0.9.5/nvim.appimage</span><br><span class="line"><span class="built_in">chmod</span> u+x nvim.appimage</span><br><span class="line">./nvim.appimage --appimage-extract</span><br><span class="line">./squashfs-root/AppRun --version</span><br><span class="line">sudo <span class="built_in">mv</span> squashfs-root /</span><br><span class="line">sudo <span class="built_in">ln</span> -s /squashfs-root/AppRun /usr/local/bin/nvim</span><br><span class="line"><span class="built_in">rm</span> ./nvim.appimage</span><br></pre></td></tr></table></figure><h3 id="å¸è½½"><a class="header-anchor" href="#å¸è½½">Â¶</a>å¸è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> /usr/local/bin/nvim</span><br><span class="line">sudo <span class="built_in">rm</span> -rf /squashfs-root</span><br><span class="line"><span class="comment"># ç§»é™¤é…ç½®</span></span><br><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$HOME</span>/.config/nvim</span><br><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$HOME</span>/.local/share/nvim</span><br></pre></td></tr></table></figure><h3 id="é…ç½®"><a class="header-anchor" href="#é…ç½®">Â¶</a>é…ç½®</h3><h4 id="èµ·ç‚¹"><a class="header-anchor" href="#èµ·ç‚¹">Â¶</a>èµ·ç‚¹</h4><p>é€‰æ‹©<code>NvChad</code>ä½œä¸ºé…ç½®çš„èµ·ç‚¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/NvChad/NvChad ~/.config/nvim --depth 1 &amp;&amp; nvim</span><br><span class="line"><span class="comment"># è¾“å…¥Nï¼Œä¸é‡‡ç”¨ç¤ºä¾‹é…ç½®</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>custom/init.lua</code>ä¸­è®¾ç½®<code>vim.g.mapleader = &quot;,&quot;</code>ï¼Œå°†<code>&lt;leader&gt;</code>è®¾ç½®ä¸ºé€—å·ã€‚</p><p>æ’ä»¶é…ç½®å‚è€ƒ<a href="https://github.com/ayamir/nvimdots">ayamir/nvimdots</a>ã€<a href="https://www.lazyvim.org/">lazyvim</a>å’Œ<a href="https://github.com/BrunoKrugel/dotfiles">BrunoKrugel/dotfiles</a>ã€‚</p><p>ä¸‹é¢åªä»‹ç»æ¶‰åŠåˆ°å¿«æ·é”®æˆ–è€…å‘½ä»¤çš„æ’ä»¶ï¼Œä½œä¸ºå¤‡å¿˜ã€‚</p><ul><li><code>NvChadUpdate</code>ï¼šä¸€é”®æ›´æ–°</li><li><code>&lt;Ctrl-s&gt;</code>ï¼šä¿å­˜æ–‡ä»¶</li><li><code>&lt;Ctrl-c&gt;</code>ï¼šå¤åˆ¶æ•´ä¸ªæ–‡ä»¶</li><li><code>&lt;leader&gt;rn</code>ï¼šåˆ‡æ¢ç›¸å¯¹è¡Œå·</li></ul><h4 id="æ’ä»¶ç®¡ç†"><a class="header-anchor" href="#æ’ä»¶ç®¡ç†">Â¶</a>æ’ä»¶ç®¡ç†</h4><p><code>folke/lazy.nvim</code></p><ul><li><code>:Lazy</code>ï¼šæ‰“å¼€Lazyé¢æ¿</li></ul><h4 id="ç”¨æˆ·ç•Œé¢"><a class="header-anchor" href="#ç”¨æˆ·ç•Œé¢">Â¶</a>ç”¨æˆ·ç•Œé¢</h4><h5 id="ä¸»é¢˜"><a class="header-anchor" href="#ä¸»é¢˜">Â¶</a>ä¸»é¢˜</h5><ul><li><code>&lt;leader&gt;th</code>ï¼šé€‰æ‹©ä¸»é¢˜</li></ul><p>é€‰ç”¨<code>aquarium</code>ï¼Œå¹¶è®¾ç½®<code>transparency=false</code>ã€‚</p><h5 id="é¢æ¿"><a class="header-anchor" href="#é¢æ¿">Â¶</a>é¢æ¿</h5><p>è®¾ç½®<code>load_on_startup=true</code>ï¼ˆå¯é€‰ï¼‰ã€‚</p><h5 id="Buffer-line"><a class="header-anchor" href="#Buffer-line">Â¶</a>Buffer line</h5><ul><li><code>&lt;Tab&gt;</code>ï¼šä¸‹ä¸€ä¸ªBuffer</li><li><code>&lt;S-Tab&gt;</code>ï¼šä¸Šä¸€ä¸ªBuffer</li><li><code>&lt;leader&gt;x</code>ï¼šå…³é—­å½“å‰Buffer</li></ul><h4 id="å·¥å…·"><a class="header-anchor" href="#å·¥å…·">Â¶</a>å·¥å…·</h4><h5 id="å¤‡å¿˜å•"><a class="header-anchor" href="#å¤‡å¿˜å•">Â¶</a>å¤‡å¿˜å•</h5><ul><li><code>&lt;leader&gt;ch</code>ï¼šæ‰“å¼€å¤‡å¿˜å•</li></ul><h5 id="æ–‡ä»¶æ ‘"><a class="header-anchor" href="#æ–‡ä»¶æ ‘">Â¶</a>æ–‡ä»¶æ ‘</h5><p><code>nvim-tree/nvim-tree.lua</code></p><p><code>:h nvim-tree-mappings-default</code></p><ul><li><p><code>&lt;Ctrl-n&gt;</code>ï¼šæ‰“å¼€/å…³é—­æ–‡ä»¶æ ‘</p></li><li><p><code>NvimTreeFocus</code>, <code>&lt;leader&gt;e</code>ï¼šèšç„¦</p></li><li><p><code>&lt;CR&gt;</code>ï¼šæ‰“å¼€å…‰æ ‡æ‰€åœ¨æ–‡ä»¶/è¿›å…¥æ–‡ä»¶å¤¹</p></li><li><p><code>j</code>/<code>k</code>ï¼šä¸Šä¸‹ç§»åŠ¨</p></li><li><p><code>a</code>ï¼šæ–°å»ºæ–‡ä»¶</p></li><li><p><code>d</code>ï¼šåˆ é™¤æ–‡ä»¶</p></li><li><p><code>r</code>ï¼šé‡å‘½åæ–‡ä»¶</p></li><li><p><code>S</code>ï¼šæœç´¢æ–‡ä»¶</p></li><li><p><code>&lt;BS&gt;</code>ï¼šå…³é—­æ–‡ä»¶å¤¹</p></li><li><p><code>q</code>ï¼šé€€å‡º</p></li><li><p><code>&lt;Tab&gt;</code>ï¼šé¢„è§ˆ</p></li><li><p><code>c</code>ï¼šå¤åˆ¶æ–‡ä»¶</p></li><li><p><code>p</code>ï¼šç²˜è´´æ–‡ä»¶</p></li><li><p><code>x</code>ï¼šå‰ªåˆ‡æ–‡ä»¶</p></li></ul><h5 id="æ–‡ä»¶æŸ¥æ‰¾"><a class="header-anchor" href="#æ–‡ä»¶æŸ¥æ‰¾">Â¶</a>æ–‡ä»¶æŸ¥æ‰¾</h5><p><code>nvim-telescope/telescope.nvim</code></p><ul><li><p><code>&lt;leader&gt;ff</code>ï¼šæŸ¥æ‰¾æ–‡ä»¶</p></li><li><p><code>&lt;leader&gt;fw</code>ï¼šæŸ¥æ‰¾æ–‡ä»¶ä¸­çš„å†…å®¹</p></li><li><p><code>&lt;leader&gt;fg</code>ï¼šæŸ¥æ‰¾æ—¶å¯ä»¥æ·»åŠ rgå‚æ•°ï¼Œæ­¤æ—¶æœç´¢çš„æ–‡æœ¬éœ€è¦ç”¨åŒå¼•å·åŒ…è£¹ (<code>&quot;foo&quot; -i</code>å¤§å°å†™ä¸æ•æ„ŸæŸ¥æ‰¾)</p></li><li><p><code>&lt;leader&gt;gs</code>ï¼š<code>AdvancedGitSearch</code></p></li><li><p><code>&lt;leader&gt;fz</code>ï¼šåœ¨å½“å‰æ–‡ä»¶ä¸­fzf</p></li><li><p><code>&lt;leader&gt;th</code>ï¼šæŸ¥æ‰¾ä¸»é¢˜</p></li><li><p><code>&lt;leader&gt;cm</code>ï¼šæŸ¥æ‰¾git commit</p></li><li><p><code>&lt;leader&gt;gt</code>ï¼šæŸ¥æ‰¾git status</p></li><li><p><code>&lt;leader&gt;fa</code>ï¼šæŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰</p></li><li><p><code>&lt;leader&gt;fb</code>ï¼šæŸ¥æ‰¾æ‰“å¼€çš„Bufferä¸­çš„æ–‡ä»¶</p></li><li><p><code>&lt;leader&gt;fh</code>ï¼šæŸ¥æ‰¾å¸®åŠ©æ–‡ä»¶</p></li><li><p><code>&lt;Up&gt;</code>/<code>&lt;Down&gt;</code>æˆ–åœ¨Normalæ¨¡å¼ä¸‹<code>j</code>/<code>k</code>ï¼šä¸Šä¸‹ç§»åŠ¨</p></li><li><p><code>&lt;C-u&gt;</code>/<code>&lt;C-d&gt;</code>ï¼šåœ¨é¢„è§ˆçª—å£ä¸Šä¸‹ç§»åŠ¨</p></li><li><p><code>&lt;CR&gt;</code>ï¼šé€‰æ‹©</p></li><li><p><code>?</code>ï¼šæ‰“å¼€å¿«æ·é”®é¢æ¿</p></li></ul><h5 id="ç»ˆç«¯"><a class="header-anchor" href="#ç»ˆç«¯">Â¶</a>ç»ˆç«¯</h5><ul><li><code>&lt;A-h&gt;</code>ï¼šåœ¨ä¸‹æ–¹æ‰“å¼€/å…³é—­ä¸€ä¸ªç»ˆç«¯</li><li><code>&lt;A-v&gt;</code>ï¼šåœ¨å³æ–¹æ‰“å¼€/å…³é—­ä¸€ä¸ªç»ˆç«¯</li><li><code>&lt;A-i&gt;</code>ï¼šæ‰“å¼€/å…³é—­ä¸€ä¸ªæµ®åŠ¨ç»ˆç«¯</li></ul><h5 id="è¡Œè·³è½¬"><a class="header-anchor" href="#è¡Œè·³è½¬">Â¶</a>è¡Œè·³è½¬</h5><p><code>nacro90/numb.nvim</code></p><ul><li><code>:&lt;number&gt;</code>ï¼šè·³è½¬åˆ°æŸè¡Œï¼Œè¯¥æ’ä»¶å¯ä»¥æä¾›å®æ—¶é¢„è§ˆåŠŸèƒ½</li></ul><h4 id="ç¼–è¾‘-s2"><a class="header-anchor" href="#ç¼–è¾‘-s2">Â¶</a>ç¼–è¾‘</h4><h5 id="æ³¨é‡Š"><a class="header-anchor" href="#æ³¨é‡Š">Â¶</a>æ³¨é‡Š</h5><p><code>numToStr/Comment.nvim</code></p><ul><li><code>gcc</code>ï¼šåˆ‡æ¢å½“å‰è¡Œæ³¨é‡Š</li><li><code>gc</code>ï¼šåˆ‡æ¢è¡Œæ³¨é‡Š</li><li><code>gb</code>ï¼šåˆ‡æ¢å—æ³¨é‡Š</li></ul><h5 id="é«˜äº®"><a class="header-anchor" href="#é«˜äº®">Â¶</a>é«˜äº®</h5><p><code>nvim-treesitter/nvim-treesitter</code></p><ul><li><p>å¢é‡é€‰æ‹©åŠŸèƒ½ï¼š</p><ul><li><code>&lt;CR&gt;</code>ï¼šæ‰©å¤§é€‰æ‹©</li><li><code>&lt;BS&gt;</code>ï¼šç¼©å°é€‰æ‹©</li></ul></li><li><p><code>TSInstallInfo</code>ï¼šæŸ¥çœ‹æ‰€æœ‰è¯­è¨€å®‰è£…æƒ…å†µ</p></li><li><p><code>TSEnable highlight</code>ï¼šå¼€å¯è¯­æ³•é«˜äº®</p></li><li><p><code>TSUpdateSync</code>ï¼šæ›´æ–°</p></li><li><p><code>TSInstall lang</code>ï¼šå®‰è£…</p></li><li><p><code>TSUninstall lang</code>ï¼šå¸è½½</p></li></ul><h5 id="é—®é¢˜åˆ—è¡¨"><a class="header-anchor" href="#é—®é¢˜åˆ—è¡¨">Â¶</a>é—®é¢˜åˆ—è¡¨</h5><p><code>folke/trouble.nvim</code></p><ul><li><code>TroubleToggle</code>, <code>&lt;leader&gt;tt</code>ï¼šæ‰“å¼€/å…³é—­é—®é¢˜åˆ—è¡¨</li></ul><h5 id="TODO-é«˜äº®"><a class="header-anchor" href="#TODO-é«˜äº®">Â¶</a>TODO é«˜äº®</h5><p><code>folke/todo-comments.nvim</code></p><ul><li><p>TODO:</p></li><li><p>PERF:</p></li><li><p>NOTE:</p></li><li><p>FIX:</p></li><li><p>WARN:</p></li><li><p>TEST:</p></li><li><p><code>:TodoTrouble</code>, <code>&lt;leader&gt;td</code>ï¼šåˆ—å‡ºæ‰€æœ‰todo</p></li><li><p><code>:TodoTelescope</code> <code>&lt;leader&gt;ts</code>ï¼šç”¨telescopeæŸ¥æ‰¾todo</p></li></ul><p>è¿™é‡Œæœ‰ä¸€ä¸ªbugæ˜¯åªèƒ½æŸ¥çœ‹å½“å‰æ‰€åœ¨æ–‡ä»¶å¤¹ä¸‹çš„todosï¼Œè€Œä¸æ˜¯æ‰“å¼€çš„æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸‹çš„todosï¼ˆå¦‚æœè®¾ç½®<code>autochdir</code>ï¼Œé‚£ä¹ˆtelescopeæ’ä»¶åˆä¼šå‡ºé—®é¢˜ï¼‰ã€‚</p><h5 id="å¿«é€Ÿè·³è½¬"><a class="header-anchor" href="#å¿«é€Ÿè·³è½¬">Â¶</a>å¿«é€Ÿè·³è½¬</h5><p><code>folke/flash.nvim</code></p><p>æ ¹æ®ä½ç½®æç¤ºå¿«é€Ÿè·³è½¬ã€‚</p><ul><li>é›†æˆåˆ°äº†æœç´¢ (<code>/</code>/<code>?</code>) ä¸­</li><li>é›†æˆåˆ°äº†<code>f</code>/<code>t</code>/<code>F</code>/<code>T</code>ä¸­ï¼Œå†è¾“å…¥ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼ŒæŒ‰<code>f</code>/<code>t</code>/<code>F</code>/<code>T</code>æˆ–è€…<code>;</code>/<code>,</code>ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªåŒ¹é…</li><li>æŒ‰<code>s</code>/<code>S</code>ï¼ˆ<code>s</code>æ˜¯å…¨å±€ï¼Œ<code>S</code>æ˜¯treesitterä¸­çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹ï¼ˆè¿˜å¯ä»¥é€šè¿‡<code>;</code>/<code>,</code>æ‰©å¤§æˆ–ç¼©å°èŒƒå›´ï¼‰ï¼‰ï¼Œç„¶åè¾“å…¥ä»»æ„å‰ç¼€</li></ul><h5 id="æ‹¬å·ç§»åŠ¨"><a class="header-anchor" href="#æ‹¬å·ç§»åŠ¨">Â¶</a>æ‹¬å·ç§»åŠ¨</h5><p><code>andymass/vim-matchup</code></p><ul><li><code>%</code>ï¼šé™¤äº†åŸæœ¬çš„æ‹¬å·åŒ¹é…ï¼ˆ<code>()[]&#123;&#125;</code>ï¼‰è·³è½¬å¤–ï¼Œè¿˜åœ¨ç‰¹å®šäºè¯­è¨€çš„åŒ¹é…å•è¯é—´è·³è½¬ï¼ˆæ¯”å¦‚ifå’Œelseï¼‰</li></ul><h4 id="è¯­è¨€"><a class="header-anchor" href="#è¯­è¨€">Â¶</a>è¯­è¨€</h4><h5 id="ç¬¦å·æ ‘"><a class="header-anchor" href="#ç¬¦å·æ ‘">Â¶</a>ç¬¦å·æ ‘</h5><p><code>stevearc/aerial.nvim</code></p><ul><li><code>&lt;leader&gt;a</code>ï¼šæ‰“å¼€å…³é—­aerial</li><li><code>&lt;leader&gt;ta</code>ï¼šç”¨telescopeæŸ¥æ‰¾ç¬¦å·</li></ul><h5 id="æ ¼å¼åŒ–"><a class="header-anchor" href="#æ ¼å¼åŒ–">Â¶</a>æ ¼å¼åŒ–</h5><p><code>stevearc/conform.nvim</code></p><ul><li><code>&lt;leader&gt;fm</code>ï¼šæ ¼å¼åŒ–å½“å‰æ–‡ä»¶</li><li><code>FormatEnable</code>ï¼šå¼€å¯ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–</li><li><code>FormatDisable</code>ï¼šå…³é—­ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–</li><li><code>ConformInfo</code></li></ul><h5 id="LSP"><a class="header-anchor" href="#LSP">Â¶</a>LSP</h5><p>æ’ä»¶ï¼š<code>neovim/nvim-lspconfig</code>ï¼ˆé…ç½®ï¼‰ã€<code>williamboman/mason.nvim</code>ï¼ˆå®‰è£…ç®¡ç†ï¼‰ã€<code>williamboman/mason-lspconfig.nvim</code></p><ul><li><code>LspInfo</code>ï¼šæŸ¥çœ‹LSPçŠ¶æ€</li><li><code>LspRestart</code>ï¼šé‡å¯LSP</li><li><code>LspStart</code>ï¼šå¯åŠ¨LSP</li><li><code>LspStop</code>ï¼šå…³é—­LSP</li><li><code>Mason</code>ï¼šMasoné¢æ¿</li><li><code>MasonInstall &lt;package&gt;</code>, <code>MasonUninstall</code>ï¼šMasonå®‰è£…</li><li><code>MasonUninstall &lt;package&gt;</code>, <code>:MasonUninstall</code>ï¼šMasonå¸è½½</li><li><code>MasonUpdate</code>ï¼šMasonæ›´æ–°</li><li><code>MasonLog</code>ï¼šMasonæ—¥å¿—</li></ul><p>Lspå¿«æ·é”®ï¼š</p><ul><li><code>K</code>ï¼šæŸ¥çœ‹æ–‡æ¡£</li><li><code>gr</code>ï¼šæŸ¥çœ‹å¼•ç”¨</li><li><code>gd</code>ï¼šæŸ¥çœ‹å®šä¹‰</li><li><code>gi</code>ï¼šæŸ¥çœ‹å®ç°</li><li><code>&lt;leader&gt;ca</code>ï¼šcode action</li><li><code>&lt;leader&gt;ra</code>ï¼šå˜é‡æ”¹å</li><li><code>&lt;leader&gt;D</code>ï¼šç±»å‹</li><li><code>&lt;leader&gt;</code>ï¼šç­¾å</li></ul><h5 id="Glance"><a class="header-anchor" href="#Glance">Â¶</a>Glance</h5><ul><li><code>gD</code>ï¼šæŸ¥çœ‹æ‰€æœ‰å®šä¹‰</li><li><code>gM</code>ï¼šæŸ¥çœ‹æ‰€æœ‰å®ç°</li><li><code>gY</code>ï¼šæŸ¥çœ‹ç±»å‹å®šä¹‰</li><li><code>gR</code>ï¼šæŸ¥çœ‹æ‰€æœ‰å¼•ç”¨</li></ul><h5 id="Clangd-Extension"><a class="header-anchor" href="#Clangd-Extension">Â¶</a>Clangd Extension</h5><ul><li><code>ClangdSwitchSourceHeader</code>ï¼šåœ¨å¤´æ–‡ä»¶å’Œä»£ç æ–‡ä»¶é—´åˆ‡æ¢</li><li><code>ClangdInlayHints</code></li><li><code>ClangdAST</code>ï¼šæ˜¾ç¤ºé€‰ä¸­ä»£ç æ®µçš„AST</li><li><code>ClangdSymbolInfo</code>ï¼šæ˜¾ç¤ºå…‰æ ‡æ‰€åœ¨å¤„çš„ç±»å‹</li><li><code>ClangdTypeHierarchy</code>ï¼šæ˜¾ç¤ºå…‰æ ‡æ‰€åœ¨å¤„çš„ç±»å±‚çº§å…³ç³»</li></ul><h5 id="markdown"><a class="header-anchor" href="#markdown">Â¶</a>markdown</h5><p><code>iamcco/markdown-preview.nvim</code></p><ul><li><code>MarkdownPreviewToggle</code>, <code>&lt;F12&gt;</code></li></ul><h3 id="æˆªå›¾"><a class="header-anchor" href="#æˆªå›¾">Â¶</a>æˆªå›¾</h3><p><a data-fancybox="gallery" data-src="/post-images/nvim-dash.png" data-caption="nvim dashboard"><img src="/post-images/nvim-dash.png" alt="nvim dashboard"></a></p><p><a data-fancybox="gallery" data-src="/post-images/nvim-startup.png" data-caption="nvim startup time"><img src="/post-images/nvim-startup.png" alt="nvim startup time"></a></p><p><a data-fancybox="gallery" data-src="/post-images/nvim-cpp.png" data-caption="nvim cpp file"><img src="/post-images/nvim-cpp.png" alt="nvim cpp file"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>leetcode æ¨¡æ¿æ€»ç»“</title>
      <link href="/2023/08/25/leetcode%E6%A8%A1%E6%9D%BF%E6%80%BB%E7%BB%93/"/>
      <url>/2023/08/25/leetcode%E6%A8%A1%E6%9D%BF%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="äºŒå‰æ ‘éå†"><a class="header-anchor" href="#äºŒå‰æ ‘éå†">Â¶</a>äºŒå‰æ ‘éå†</h2><p>å‰åºã€ä¸­åºã€ååºéå†ï¼ˆè¿™é‡Œçš„å‰ä¸­åæè¿°çš„æ˜¯æ ¹èŠ‚ç‚¹çš„ä½ç½®ï¼Œå·¦å­æ ‘åˆ™æ°¸è¿œåœ¨å³å­æ ‘ä¹‹å‰ï¼‰ã€‚</p><p>å±‚æ¬¡éå†ï¼ˆBFSï¼‰ã€‚</p><p>éé€’å½’å®ç°ä½¿ç”¨æ ˆã€‚</p><h3 id="åºåˆ—åŒ–å’Œååºåˆ—åŒ–"><a class="header-anchor" href="#åºåˆ—åŒ–å’Œååºåˆ—åŒ–">Â¶</a>åºåˆ—åŒ–å’Œååºåˆ—åŒ–</h3><p>ä½¿ç”¨å‰åº/ååºéå†å†åŠ ä¸Šä¸­åºéå†å¯ä»¥è¿˜åŸäºŒå‰æ ‘ã€‚</p><p>å½“åŒ…å«ï¼ˆæ‰€æœ‰å¶å­èŠ‚ç‚¹çš„ï¼‰ç©ºæŒ‡é’ˆä¿¡æ¯æ—¶ï¼Œå‰åº/ååºéå†å³å¯è¿˜åŸäºŒå‰æ ‘ã€‚</p><p>äºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†æ˜¯æœ‰åºçš„ï¼Œå› æ­¤åªéœ€è¦å‰åº/ååºéå†å³å¯è¿˜åŸï¼ˆå°†å‰åº/åç»­éå†æ’åºå°±æ˜¯ä¸­åºéå†äº†ï¼‰ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>markdown æ€»ç»“</title>
      <link href="/2023/08/25/markdown%E6%80%BB%E7%BB%93/"/>
      <url>/2023/08/25/markdown%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬è¯­æ³•"><a class="header-anchor" href="#åŸºæœ¬è¯­æ³•">Â¶</a>åŸºæœ¬è¯­æ³•</h2><h3 id="n-çº§æ ‡é¢˜"><a class="header-anchor" href="#n-çº§æ ‡é¢˜">Â¶</a>n çº§æ ‡é¢˜</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># ä¸€çº§æ ‡é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="section">## äºŒçº§æ ‡é¢˜</span></span><br></pre></td></tr></table></figure><h3 id="ç²—ä½“"><a class="header-anchor" href="#ç²—ä½“">Â¶</a>ç²—ä½“</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="strong">**ç²—ä½“æ–‡æœ¬**</span></span><br></pre></td></tr></table></figure><p><strong>ç²—ä½“æ–‡æœ¬</strong></p><h3 id="æ–œä½“"><a class="header-anchor" href="#æ–œä½“">Â¶</a>æ–œä½“</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">*æ–œä½“æ–‡æœ¬*</span></span><br></pre></td></tr></table></figure><p><em>æ–œä½“æ–‡æœ¬</em></p><h3 id="å¼•ç”¨"><a class="header-anchor" href="#å¼•ç”¨">Â¶</a>å¼•ç”¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; å¼•ç”¨</span></span><br><span class="line"><span class="quote">&gt; æ–‡æœ¬</span></span><br></pre></td></tr></table></figure><blockquote><p>å¼•ç”¨æ–‡æœ¬</p></blockquote><ul><li>å»ºè®®æ¯ä¸€è¡Œå¼•ç”¨éƒ½ä½¿ç”¨ç¬¦å·<code>&gt;</code>ã€‚</li></ul><h3 id="æ— åºåˆ—è¡¨"><a class="header-anchor" href="#æ— åºåˆ—è¡¨">Â¶</a>æ— åºåˆ—è¡¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> æ— åºæ–‡æœ¬</span><br><span class="line"><span class="bullet">-</span> æ— åºæ–‡æœ¬</span><br></pre></td></tr></table></figure><ul><li>æ— åºæ–‡æœ¬</li><li>æ— åºæ–‡æœ¬</li></ul><h3 id="æœ‰åºåˆ—è¡¨"><a class="header-anchor" href="#æœ‰åºåˆ—è¡¨">Â¶</a>æœ‰åºåˆ—è¡¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> æœ‰åºæ–‡æœ¬</span><br><span class="line"><span class="bullet">2.</span> æœ‰åºæ–‡æœ¬</span><br></pre></td></tr></table></figure><ol><li>æœ‰åºæ–‡æœ¬</li><li>æœ‰åºæ–‡æœ¬</li></ol><ul><li>å¦‚æœåˆ—è¡¨é¡¹æœ‰æ¢è¡Œï¼Œåˆ™å»ºè®®ç»™æ— åºåˆ—è¡¨ä½¿ç”¨ 3 ä¸ªç©ºæ ¼ï¼Œç»™æœ‰åºåˆ—è¡¨ä½¿ç”¨ 2 ä¸ªç©ºæ ¼ã€‚</li><li>å¦‚æœä¸€ä¸ªåˆ—è¡¨ä¸­çš„æ¯ä¸ªåˆ—è¡¨é¡¹éƒ½åªæœ‰ 1 è¡Œï¼Œå»ºè®®åˆ—è¡¨é¡¹ä¹‹é—´ä¸è¦æœ‰ç©ºè¡Œã€‚</li><li>å¦‚æœåˆ—è¡¨é¡¹ä¸­æœ‰æ¢è¡Œï¼Œå»ºè®®åœ¨åˆ—è¡¨é¡¹ä¹‹é—´ç©º 1 è¡Œï¼Œè¿™æ ·ä¼šæ¯”è¾ƒå®¹æ˜“åŒºåˆ†å¤šè¡Œåˆ—è¡¨é¡¹çš„å¼€å§‹å’Œç»“æŸã€‚</li></ul><h3 id="è¡Œå†…ä»£ç "><a class="header-anchor" href="#è¡Œå†…ä»£ç ">Â¶</a>è¡Œå†…ä»£ç </h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">`code`</span></span><br></pre></td></tr></table></figure><p><code>code</code></p><h3 id="åˆ†å‰²çº¿"><a class="header-anchor" href="#åˆ†å‰²çº¿">Â¶</a>åˆ†å‰²çº¿</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">---</span><br></pre></td></tr></table></figure><hr><h3 id="æ–‡å­—é“¾æ¥"><a class="header-anchor" href="#æ–‡å­—é“¾æ¥">Â¶</a>æ–‡å­—é“¾æ¥</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">ç¤ºä¾‹ç½‘ç«™</span>](<span class="link">www.example.com</span>)</span><br></pre></td></tr></table></figure><p><a href="www.example.com">ç¤ºä¾‹ç½‘ç«™</a></p><h3 id="å›¾ç‰‡"><a class="header-anchor" href="#å›¾ç‰‡">Â¶</a>å›¾ç‰‡</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">å›¾ç‰‡</span>](<span class="link">/post-images/markdown-cheat.png</span>)</span><br></pre></td></tr></table></figure><p><a data-fancybox="gallery" data-src="/post-images/markdown-cheat.png" data-caption="å›¾ç‰‡"><img src="/post-images/markdown-cheat.png" alt="å›¾ç‰‡"></a></p><h3 id="ç½‘å€é“¾æ¥"><a class="header-anchor" href="#ç½‘å€é“¾æ¥">Â¶</a>ç½‘å€é“¾æ¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;www.example.com&gt;</span><br></pre></td></tr></table></figure><p>&lt;<a href="http://www.example.com">www.example.com</a>&gt;</p><h2 id="æ‰©å±•è¯­æ³•"><a class="header-anchor" href="#æ‰©å±•è¯­æ³•">Â¶</a>æ‰©å±•è¯­æ³•</h2><p>åªä»‹ç» Github åå¥½çš„ Markdownï¼ˆGFMï¼‰ï¼Œå°½é‡ä¿æŒå…¼å®¹æ€§ã€‚</p><h3 id="è‡ªåŠ¨é“¾æ¥"><a class="header-anchor" href="#è‡ªåŠ¨é“¾æ¥">Â¶</a>è‡ªåŠ¨é“¾æ¥</h3><p><a href="http://www.example.com">www.example.com</a></p><p>ç¦ç”¨è‡ªåŠ¨é“¾æ¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`www.example.com`</span><br></pre></td></tr></table></figure><p><code>www.example.com</code></p><h3 id="è¡¨æ ¼"><a class="header-anchor" href="#è¡¨æ ¼">Â¶</a>è¡¨æ ¼</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">| Header | Header | Header |</span><br><span class="line">| :---   | :---:  | ---:   |</span><br><span class="line">| Left   | Middle | Right  |</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">Header</th><th style="text-align:center">Header</th><th style="text-align:right">Header</th></tr></thead><tbody><tr><td style="text-align:left">Left</td><td style="text-align:center">Middle</td><td style="text-align:right">Right</td></tr></tbody></table><ul><li>è¡¨å¤´ä¸å…¶ä»–è¡Œä½¿ç”¨<code>-</code>æ¥åˆ†éš”ã€‚</li></ul><h3 id="ä»£ç å—"><a class="header-anchor" href="#ä»£ç å—">Â¶</a>ä»£ç å—</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">```cpp</span></span><br><span class="line"><span class="code">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="code">int main() &#123;</span></span><br><span class="line"><span class="code">  std::cout &lt;&lt; &quot;Hello Markdown\n&quot;;</span></span><br><span class="line"><span class="code">  return 0;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code">\```</span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cout &lt;&lt; <span class="string">&quot;Hello Markdown\n&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>å¾ˆå¤š Shell å‘½ä»¤éƒ½è¦ç²˜è´´åˆ°ç»ˆç«¯ä¸­å»æ‰§è¡Œï¼Œå› æ­¤æœ€å¥½é¿å…åœ¨ Shell å‘½ä»¤ä¸­ä½¿ç”¨ä»»ä½•æ¢è¡Œæ“ä½œï¼›å¯ä»¥åœ¨è¡Œå°¾ä½¿ç”¨ä¸€ä¸ª<code>\</code>ï¼Œè¿™æ ·æ—¢èƒ½é¿å…å‘½ä»¤æ¢è¡Œï¼Œåˆèƒ½æé«˜æºç çš„å¯è¯»æ€§ã€‚</p></li><li><p>å»ºè®®ä¸è¦åœ¨æ²¡æœ‰è¾“å‡ºå†…å®¹çš„ Shell å‘½ä»¤å‰åŠ <code>$</code>ã€‚åœ¨å‘½ä»¤æ²¡æœ‰è¾“å‡ºå†…å®¹çš„æƒ…å†µä¸‹ï¼Œ<code>$</code>æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œå› ä¸ºå†…å®¹å…¨æ˜¯å‘½ä»¤ï¼Œæˆ‘ä»¬ä¸ä¼šæŠŠå‘½ä»¤å’Œè¾“å‡ºçš„å†…å®¹æ··æ·†ã€‚</p></li><li><p>å»ºè®®åœ¨æœ‰è¾“å‡ºå†…å®¹çš„ Shell å‘½ä»¤å‰åŠ ä¸Š<code>$</code>ï¼Œè¿™æ ·ä¼šæ¯”è¾ƒå®¹æ˜“åŒºåˆ†å‘½ä»¤å’Œè¾“å‡ºçš„å†…å®¹ã€‚ï¼ˆ<code>$</code>ä»£è¡¨æ™®é€šç”¨æˆ·ï¼Œ<code>#</code>ä»£è¡¨è¶…çº§ç”¨æˆ·ï¼‰</p></li></ul><h3 id="åˆ é™¤çº¿"><a class="header-anchor" href="#åˆ é™¤çº¿">Â¶</a>åˆ é™¤çº¿</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~~åˆ é™¤æ–‡æœ¬~~</span><br></pre></td></tr></table></figure><p><s>åˆ é™¤æ–‡æœ¬</s></p><h3 id="ä»»åŠ¡åˆ—è¡¨"><a class="header-anchor" href="#ä»»åŠ¡åˆ—è¡¨">Â¶</a>ä»»åŠ¡åˆ—è¡¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- [x] å·²å®Œæˆ</span><br><span class="line">- [ ] TODO</span><br></pre></td></tr></table></figure><ul><li><input type="checkbox" id="checkbox1" checked="true"><label for="checkbox1">å·²å®Œæˆ</label></li><li><input type="checkbox" id="checkbox2"><label for="checkbox2">TODO</label></li></ul><hr><p>è¡¨æƒ…ç¬¦å·ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:cry: :joy: :smile: :warning: :memo: :bulb:</span><br></pre></td></tr></table></figure><p>ğŸ˜¢ğŸ˜‚ğŸ˜„âš ï¸ğŸ“ğŸ’¡</p><p>å‚é˜… <a href="https://gist.github.com/rxaviers/7360908">è¡¨æƒ…çŸ­ä»£ç åˆ—è¡¨</a></p><h2 id="Tricks"><a class="header-anchor" href="#Tricks">Â¶</a>Tricks</h2><p>ä¸»è¦æ˜¯åˆ©ç”¨ HTML å®ç°ä¸€äº›é¢å¤–çš„åŠŸèƒ½ã€‚</p><h3 id="ä¸‹åˆ’çº¿"><a class="header-anchor" href="#ä¸‹åˆ’çº¿">Â¶</a>ä¸‹åˆ’çº¿</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ins</span>&gt;</span>ä¸‹åˆ’çº¿æ–‡æœ¬<span class="tag">&lt;/<span class="name">ins</span>&gt;</span></span><br></pre></td></tr></table></figure><p><ins>ä¸‹åˆ’çº¿æ–‡æœ¬</ins></p><h3 id="ç¼©è¿›"><a class="header-anchor" href="#ç¼©è¿›">Â¶</a>ç¼©è¿›</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$nbsp <span class="comment">&lt;!-- No-Break Space ä¸æ¢è¡Œç©ºæ ¼ --&gt;</span></span><br><span class="line">$emsp <span class="comment">&lt;!-- Em Space å…¨è§’ç©ºæ ¼ --&gt;</span></span><br><span class="line">$ensp <span class="comment">&lt;!-- En Space åŠè§’ç©ºæ ¼ --&gt;</span></span><br><span class="line"><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>ç¼©è¿›æ–‡æœ¬</span><br></pre></td></tr></table></figure><p>Â Â Â Â ç¼©è¿›æ–‡æœ¬</p><h3 id="å±…ä¸­"><a class="header-anchor" href="#å±…ä¸­">Â¶</a>å±…ä¸­</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;center\&gt;å±…ä¸­æ–‡æœ¬\&lt;/center\&gt; # æ ‡å‡†å·²å¼ƒç”¨</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center&quot;</span>&gt;</span>å±…ä¸­æ–‡æœ¬<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;center&gt;å±…ä¸­æ–‡æœ¬&lt;/center&gt;</p><h3 id="é¢œè‰²"><a class="header-anchor" href="#é¢œè‰²">Â¶</a>é¢œè‰²</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span>çº¢è‰²æ–‡æœ¬<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br></pre></td></tr></table></figure><p><font color="red">çº¢è‰²æ–‡æœ¬</font></p><hr><h3 id="å›¾ç‰‡å¤§å°"><a class="header-anchor" href="#å›¾ç‰‡å¤§å°">Â¶</a>å›¾ç‰‡å¤§å°</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;image.png&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;image.png&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:33%;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç›®å½•"><a class="header-anchor" href="#ç›®å½•">Â¶</a>ç›®å½•</h3><p>[TOC]</p><h3 id="å†…å®¹æŠ˜å "><a class="header-anchor" href="#å†…å®¹æŠ˜å ">Â¶</a>å†…å®¹æŠ˜å </h3><p>éœ€è¦å®‰è£…<code>markdown-it-collapsible</code>æ’ä»¶</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+++ <span class="strong">**ç‚¹å‡»æŸ¥çœ‹**</span></span><br><span class="line">éšè—å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line"><span class="code">```python</span></span><br><span class="line"><span class="code">def expand():</span></span><br><span class="line"><span class="code">  return &quot;exapndable&quot;</span></span><br><span class="line"><span class="code">\```</span></span><br><span class="line"></span><br><span class="line">+++</span><br></pre></td></tr></table></figure><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>éšè—å†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">expand</span>():</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;expandable&quot;</span></span><br></pre></td></tr></table></figure></details><h3 id="æ•°å­¦å…¬å¼"><a class="header-anchor" href="#æ•°å­¦å…¬å¼">Â¶</a>æ•°å­¦å…¬å¼</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$</span>a = b + c * d - e<span class="built_in">_</span>0 * f<span class="built_in">$</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span><span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span> u&#125;&#123;<span class="keyword">\partial</span> t&#125;</span><br><span class="line">= h<span class="built_in">^</span>2 <span class="keyword">\left</span>( <span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span><span class="built_in">^</span>2 u&#125;&#123;<span class="keyword">\partial</span> x<span class="built_in">^</span>2&#125; +</span><br><span class="line"><span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span><span class="built_in">^</span>2 u&#125;&#123;<span class="keyword">\partial</span> y<span class="built_in">^</span>2&#125; +</span><br><span class="line"><span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span><span class="built_in">^</span>2 u&#125;&#123;<span class="keyword">\partial</span> z<span class="built_in">^</span>2&#125;<span class="keyword">\right</span>)<span class="built_in">$</span><span class="built_in">$</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span></span><br><span class="line"><span class="keyword">\left</span>[</span><br><span class="line">    <span class="keyword">\begin</span>&#123;array&#125;&#123;cc|c&#125;</span><br><span class="line">      1<span class="built_in">&amp;</span>2<span class="built_in">&amp;</span>3<span class="keyword">\newline</span></span><br><span class="line">      4<span class="built_in">&amp;</span>5<span class="built_in">&amp;</span>6</span><br><span class="line">    <span class="keyword">\end</span>&#123;array&#125;</span><br><span class="line"><span class="keyword">\right</span>]</span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;eqnarray&#125;</span><br><span class="line"><span class="keyword">\nabla</span><span class="keyword">\cdot</span><span class="keyword">\vec</span>&#123;E&#125; <span class="built_in">&amp;</span>=<span class="built_in">&amp;</span> <span class="keyword">\frac</span>&#123;<span class="keyword">\rho</span>&#125;&#123;<span class="keyword">\epsilon</span><span class="built_in">_</span>0&#125; <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\nabla</span><span class="keyword">\cdot</span><span class="keyword">\vec</span>&#123;B&#125; <span class="built_in">&amp;</span>=<span class="built_in">&amp;</span> 0 <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\nabla</span><span class="keyword">\times</span><span class="keyword">\vec</span>&#123;E&#125; <span class="built_in">&amp;</span>=<span class="built_in">&amp;</span> -<span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span> B&#125;&#123;<span class="keyword">\partial</span> t&#125; <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\nabla</span><span class="keyword">\times</span><span class="keyword">\vec</span>&#123;B&#125; <span class="built_in">&amp;</span>=<span class="built_in">&amp;</span> <span class="keyword">\mu</span><span class="built_in">_</span>0<span class="keyword">\left</span>(<span class="keyword">\vec</span>&#123;J&#125;+<span class="keyword">\epsilon</span><span class="built_in">_</span>0<span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span> E&#125;&#123;<span class="keyword">\partial</span> t&#125; <span class="keyword">\right</span>)</span><br><span class="line"><span class="keyword">\end</span>&#123;eqnarray&#125;</span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span></span><br></pre></td></tr></table></figure><p>$a = b + c * d - e_0 * f$</p><p>$$\frac{\partial u}{\partial t}= h^2 \left( \frac{\partial^2 u}{\partial x^2} +\frac{\partial^2 u}{\partial y^2} +\frac{\partial^2 u}{\partial z^2}\right)$$</p><p>$$\left[\begin{array}{cc|c}1&amp;2&amp;3\newline4&amp;5&amp;6\end{array}\right]$$</p><p>$$\begin{eqnarray}\nabla\cdot\vec{E} &amp;=&amp; \frac{\rho}{\epsilon_0} \\nabla\cdot\vec{B} &amp;=&amp; 0 \\nabla\times\vec{E} &amp;=&amp; -\frac{\partial B}{\partial t} \\nabla\times\vec{B} &amp;=&amp; \mu_0\left(\vec{J}+\epsilon_0\frac{\partial E}{\partial t} \right)\end{eqnarray}$$</p><h2 id="æ’ç‰ˆ-Tips"><a class="header-anchor" href="#æ’ç‰ˆ-Tips">Â¶</a>æ’ç‰ˆ Tips</h2><ol><li>å®‰è£…<code>markdownlint</code>æ’ä»¶ã€‚</li><li>ä½¿ç”¨<code>Trailing Spaces</code>æ’ä»¶ã€‚</li><li>URLå‰ååŠ ç©ºæ ¼ï¼Œè¿™æ ·å¯ä»¥é¿å…å’Œæ–‡å­—ç²˜è¿ã€‚</li><li>å»ºè®®ä¸­æ–‡å’Œè‹±æ–‡ä¹‹é—´åŠ ç©ºæ ¼ï¼Œä¸­æ–‡/è‹±æ–‡å’Œæ•°å­—ä¹‹é—´ä¹Ÿè¦åŠ ç©ºæ ¼ã€‚ï¼ˆè¯•äº†å‡ ä¸ª<code>hexo</code>æ’ä»¶éƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œè¿™æ¡çœ‹æƒ…å†µéµå®ˆå§ï¼›è¿™æ ·åšçš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥è®©ç¼–è¾‘å™¨å¸®ä½ è¿›è¡Œæ‹¼å†™æ£€æŸ¥ï¼‰</li><li>è‹±æ–‡æ ‡ç‚¹ç¬¦å·ï¼ˆå¦‚ï¼Œ.ï¼›ï¼šï¼Ÿï¼‰ä¸åé¢çš„å­—ç¬¦ä¹‹é—´éœ€è¦åŠ ç©ºæ ¼ï¼Œä¸å‰é¢çš„å­—ç¬¦ä¹‹é—´ä¸éœ€è¦åŠ ç©ºæ ¼ã€‚</li><li>ä¸­æ–‡æ ‡ç‚¹ç¬¦å·å’Œæ•°å­—ã€ä¸­æ–‡ã€è‹±æ–‡ä¹‹é—´ä¸éœ€è¦æ·»åŠ ç©ºæ ¼ã€‚</li><li>ä¸­æ–‡æ’ç‰ˆä½¿ç”¨å…¨è§’æ ‡ç‚¹ç¬¦å·ï¼Œè‹±æ–‡æ’ç‰ˆä½¿ç”¨åŠè§’æ ‡ç‚¹ç¬¦å·ã€‚</li><li>ä¸“æœ‰åè¯æ³¨æ„å¤§å°å†™é—®é¢˜ã€‚</li><li>æ‹¬å·çš„ç”¨æ³•ï¼šåœ¨æ‹¬å·å†…åªæœ‰è‹±æ–‡æ—¶ç”¨è‹±æ–‡æ‹¬å·ï¼Œå¹¶åœ¨æ‹¬å·å‰ååŠ ä¸€ä¸ªåŠè§’ç©ºæ ¼ï¼›åœ¨æ‹¬å·å†…æœ‰ä¸­æ–‡æ—¶ç”¨ä¸­æ–‡æ‹¬å·ã€‚</li><li>è‹±æ–‡æ²¡æœ‰é¡¿å·ï¼Œå› æ­¤åœ¨è‹±æ–‡å’Œé˜¿æ‹‰ä¼¯æ•°å­—å¹¶åˆ—æ—¶ç”¨é€—å·ï¼Œå¦åˆ™ç”¨é¡¿å·ã€‚</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç«èµ›å›¾</title>
      <link href="/2022/06/20/jing-sai-tu/"/>
      <url>/2022/06/20/jing-sai-tu/</url>
      
        <content type="html"><![CDATA[<p>è‹¥ç«èµ›å›¾å­˜åœ¨ç¯ï¼Œåˆ™ä¸€å®šå­˜åœ¨ä¸‰å…ƒç¯ã€‚</p><p>å¤§å°ä¸º$n$($n&gt;1$)çš„å¼ºè¿é€šå—ï¼Œå¤§å°ä¸º$[3,n]$çš„ç®€å•ç¯å‡å­˜åœ¨ã€‚</p><p>ä»»æ„ç«èµ›å›¾éƒ½æœ‰å“ˆå¯†é¡¿è·¯å¾„ï¼ˆç»è¿‡æ¯ä¸ªç‚¹ä¸€æ¬¡çš„è·¯å¾„ï¼Œä¸è¦æ±‚å›åˆ°å‡ºå‘ç‚¹ï¼‰ã€‚</p><p><strong>å¢é‡æ„é€ </strong>ï¼šå¯¹äºç¬¬$i$ä¸ªç‚¹ï¼Œè¦ä¹ˆæ”¾åœ¨ç¬¬ä¸€ä¸ªï¼Œè¦ä¹ˆä»åå¾€å‰æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³$j\rightarrow i$çš„ï¼Œç„¶åæ’åœ¨$j$çš„åé¢ã€‚</p><p>ç«èµ›å›¾å­˜åœ¨å“ˆå¯†é¡¿å›è·¯çš„å……è¦æ¡ä»¶æ˜¯å¼ºè”é€šã€‚</p><p>å…ˆæ„é€ å“ˆå¯†é¡¿è·¯å¾„ï¼Œç„¶åæ„é€ å“ˆå¯†é¡¿å›è·¯ã€‚</p><p>ç»´æŠ¤é“¾$v_1,\dots,v_k,\dots,v_i$â€‹ï¼Œå…¶ä¸­$v_k\rightarrowv_1$â€‹ï¼Œç„¶åè€ƒè™‘æ‰©å±•åˆ°èŠ‚ç‚¹$i+1$æ¥æ‰©å¤§ç¯ï¼š</p><ol><li>$v_{i+1}\rightarrow v_1$â€‹ï¼Œç›´æ¥æ‰©å¤§</li><li>æ‰¾åˆ°æœ€å°çš„$j$ï¼Œæ»¡è¶³$v_{i+1}\rightarrow v_{j} (j\le k)$ï¼Œç„¶åä¿®æ”¹è·¯å¾„ä¸º$v_{i+1},v_j,\dots,v_k,v_1,\dots,v_{j-1},v_{k+1},\dots,v_i$</li><li>ç›´æ¥è€ƒè™‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">gao</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; path)</span> </span>&#123;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; npath;</span><br><span class="line">  <span class="comment">// å“ˆå¯†é¡¿è·¯</span></span><br><span class="line">  npath.<span class="built_in">push_back</span>(path.<span class="built_in">front</span>());</span><br><span class="line">  <span class="type">int</span> sz = path.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;sz; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (G[path[i]][npath.<span class="built_in">front</span>()]) npath.<span class="built_in">insert</span>(npath.<span class="built_in">begin</span>(), path[i]);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> j=(<span class="type">int</span>)npath.<span class="built_in">size</span>()<span class="number">-1</span>; j&gt;=<span class="number">0</span>; j--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (G[npath[j]][path[i]]) &#123;</span><br><span class="line">          npath.<span class="built_in">insert</span>(npath.<span class="built_in">begin</span>()+j+<span class="number">1</span>, path[i]);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å“ˆå¯†é¡¿å›è·¯</span></span><br><span class="line">  <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;sz; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (G[npath[i]][npath[<span class="number">0</span>]]) k = i;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>; j&lt;=k; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (G[npath[i]][npath[j]]) &#123;</span><br><span class="line">          vector&lt;<span class="type">int</span>&gt; tmp;</span><br><span class="line">          tmp.<span class="built_in">push_back</span>(npath[i]);</span><br><span class="line">          tmp.<span class="built_in">insert</span>(tmp.<span class="built_in">end</span>(), npath.<span class="built_in">begin</span>()+j, npath.<span class="built_in">begin</span>()+k+<span class="number">1</span>);</span><br><span class="line">          tmp.<span class="built_in">insert</span>(tmp.<span class="built_in">end</span>(), npath.<span class="built_in">begin</span>(), npath.<span class="built_in">begin</span>()+j);</span><br><span class="line">          tmp.<span class="built_in">insert</span>(tmp.<span class="built_in">end</span>(), npath.<span class="built_in">begin</span>()+k+<span class="number">1</span>, npath.<span class="built_in">begin</span>()+i);</span><br><span class="line">          tmp.<span class="built_in">insert</span>(tmp.<span class="built_in">end</span>(), npath.<span class="built_in">begin</span>()+i+<span class="number">1</span>, npath.<span class="built_in">end</span>());</span><br><span class="line">          <span class="built_in">swap</span>(tmp, npath);</span><br><span class="line">          k = i;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">swap</span>(path, npath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼ºè¿é€šç¼©ç‚¹åå‘ˆé“¾çŠ¶ï¼Œæ‹“æ‰‘åºå°çš„ç‚¹å‘æ‰€æœ‰æ‹“æ‰‘åºå¤§çš„ç‚¹è¿è¾¹ï¼ˆå› æ­¤å¯ä»¥ç›´æ¥æ ¹æ®å¼ºè¿é€šåˆ†é‡åˆ¤æ–­ä»»æ„ä¸¤ç‚¹é—´çš„å¯è¾¾æ€§ï¼‰ã€‚</p><p><strong>Diracå®šç†</strong>ï¼š$n$é˜¶($n\ge3$)<strong>æ— å‘</strong>ç®€å•å›¾ï¼Œä»»æ„ä¸ç›¸é‚»çš„ä¸¤ä¸ªé¡¶ç‚¹$v_i,v_j$â€‹ï¼Œå‡æœ‰$d(v_i)+d(v_j)\gen$ï¼Œåˆ™å­˜åœ¨å“ˆå¯†é¡¿å›è·¯ã€‚</p><p>å…ˆä¸æ–­ä»é¦–å°¾æ‰©å±•ï¼Œå¾—åˆ°æå¤§çš„è·¯å¾„$s,v_1,\dots,v_k,t$ï¼Œè‹¥$s$å’Œ$t$æœ‰è¾¹åˆ™å¾—åˆ°å›è·¯ï¼Œå¦åˆ™ä¸€å®šå­˜åœ¨$s\rightarrowv_{i+1},t\rightarrowv_i$â€‹ï¼ˆé¸½å·¢åŸç†ï¼‰ï¼Œæ„é€ å¾—åˆ°å›è·¯$s,v_{i+1},\dots,t,v_i,\dots,s$ã€‚å¦‚æœè¯¥å›è·¯é•¿åº¦å°äº$n$ï¼Œå‰©ä½™ç‚¹ä¸€å®šä¸å›è·¯ä¸­çš„æŸä¸ªç‚¹æœ‰è¾¹ç›¸è¿ï¼Œä»è¯¥å¤„å°†ç¯æ–­å¼€ï¼Œç„¶åé‡å¤æ‰©å±•å³å¯ã€‚</p><p>$n$é˜¶($n\ge2$)<strong>æ— å‘</strong>ç®€å•å›¾ï¼Œä»»æ„ä¸ç›¸é‚»çš„ä¸¤ä¸ªé¡¶ç‚¹$v_i,v_j$â€‹ï¼Œå‡æœ‰$d(v_i)+d(v_j)\gen-1$ï¼Œåˆ™å­˜åœ¨å“ˆå¯†é¡¿é€šè·¯ã€‚</p><p>$n$é˜¶($n\ge3$)<strong>æ— å‘</strong>ç®€å•å›¾ï¼Œä»»æ„é¡¶ç‚¹$v_i$â€‹ï¼Œå‡æœ‰$d(v_i)\ge\frac{n}{2}$â€‹ï¼Œåˆ™å­˜åœ¨å“ˆå¯†é¡¿å›è·¯ã€‚</p><p><strong>å…°é“å®šç†</strong>ï¼šå°†ç«èµ›å›¾çš„å‡ºåº¦ä»å°åˆ°å¤§æ’åºå¾—åˆ°æ¯”åˆ†åºåˆ—$s$ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶åˆ™åˆæ³•ï¼š</p><p>$\forall 1\leq k \leq n,\sum \limits_{i=1}^k s_i \geq\binom{k}{2}$ï¼Œä¸”$k=n$æ—¶å¿…é¡»å–ç­‰å·ã€‚</p><p>å…ˆæ„é€ åºåˆ—$a=(0,1,\dots,n-1)$ï¼Œæ­¤æ—¶$a$çš„å‰ç¼€å°äº$s$ï¼Œåç¼€å¤§äº$s$ï¼ˆå› ä¸º$a$å’Œ$s$çš„æ€»å’Œç›¸åŒï¼‰ï¼Œç„¶åæ‰¾åˆ°ç¬¬ä¸€ä¸ª$a_l&lt;s_l$â€‹ï¼Œä»¥åŠæœ€åä¸€ä¸ª$a_u=a_l$â€‹ï¼ˆä¸ºäº†ä¿è¯ä¿®æ”¹å$a$ä»ç„¶æœ‰åºï¼‰ï¼Œå†æ‰¾åˆ°ç¬¬ä¸€ä¸ª$a_v&gt;s_v$â€‹ï¼Œåˆ™$a_u&lt;s_u\le s_v&lt;a_v$â€‹ï¼Œå³$a_v\gea_u+2$ï¼Œè‹¥$v\rightarrow u$ï¼Œæˆ–$v\rightarrow p,p\rightarrowu$ï¼Œå°±å°†ç›¸åº”è¾¹è¿›è¡Œç¿»è½¬ï¼Œè¿™æ ·ä¸æ–­è°ƒæ•´ï¼Œæœ€ç»ˆ$a=s$ã€‚</p><p>å¼ºè¿å›¾ç«èµ›å›¾è®¡æ•°ï¼š$g_i=f_i-\sum_{j=1}^{i-1}\binom{i}{j}g_jf_{i-j}$â€‹ï¼Œå³æšä¸¾æ‹“æ‰‘åºæœ€å°çš„å¼ºè¿é€šåˆ†é‡çš„å¤§å°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>oneTBB å¹¶è¡Œç¼–ç¨‹æ¡†æ¶</title>
      <link href="/2022/05/21/onetbb-bing-xing-bian-cheng-kuang-jia/"/>
      <url>/2022/05/21/onetbb-bing-xing-bian-cheng-kuang-jia/</url>
      
        <content type="html"><![CDATA[<h3 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">Â¶</a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/oneapi-src/oneTBB.git</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build</span><br><span class="line">cmake ..</span><br><span class="line">make -j 4</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>makeè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°å¦‚ä¸‹é—®é¢˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c++: fatal error: Killed signal terminated program cc1plus</span><br><span class="line">compilation terminated.</span><br></pre></td></tr></table></figure><p>åŸå› å°±æ˜¯å†…å­˜å¤ªå°äº†ï¼Œå‡å°å¹¶è¡Œåº¦æˆ–è€…ä¸´æ—¶æ¢é¡µ ï¼ˆ<a href="https://blog.csdn.net/weixin_44796670/article/details/121234446">å‚è€ƒ</a>ï¼‰</p><h3 id="è®¡æ—¶"><a class="header-anchor" href="#è®¡æ—¶">Â¶</a>è®¡æ—¶</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tbb::tick_count::<span class="built_in">now</span>();</span><br><span class="line">tick_count t0 = tick_count::<span class="built_in">now</span>();</span><br><span class="line">tick_count t1 = tick_count::<span class="built_in">now</span>();</span><br><span class="line"><span class="built_in">printf</span>(â€œwork took %g seconds\nâ€,(t1-t0).<span class="built_in">seconds</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> start = std::chrono::steady_clock::<span class="built_in">now</span>();</span><br><span class="line"><span class="keyword">auto</span> end = std::chrono::steady_clock::<span class="built_in">now</span>();</span><br><span class="line">std::cerr &lt;&lt; std::chrono::<span class="built_in">duration</span>&lt;<span class="type">double</span>, std::milli&gt;(end - start).<span class="built_in">count</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure><p>åªè®°æ—¶ä¸€æ¬¡ï¼Œå®¹æ˜“å‡ºç°æ³¢åŠ¨</p><p>ä½¿ç”¨<code>google benchmark</code>ï¼Œå¯ä»¥è·‘å¤šæ¬¡æ±‚å¹³å‡å€¼</p><h3 id="æ§åˆ¶è¿è¡Œçš„çº¿ç¨‹æ•°"><a class="header-anchor" href="#æ§åˆ¶è¿è¡Œçš„çº¿ç¨‹æ•°">Â¶</a>æ§åˆ¶è¿è¡Œçš„çº¿ç¨‹æ•°</h3><p>Thread local storageï¼š<code>thread_local</code>è¡¨æ˜è¯¥å˜é‡çš„ä½œç”¨åŸŸæ˜¯çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä»½æ‹·è´ã€‚</p><p>å¯¹äºTBBè€Œè¨€ï¼Œä½ ä¸çŸ¥é“ä»»åŠ¡å’Œçº¿ç¨‹ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚</p><p><code>enumerable_thread_specific</code>ï¼šprovides thread local storage that acts like anSTL container with one element per thread. The container permits iteratingover the elements using the usual STL iteration idioms. Any thread can iterateover all the local copies, seeing the other threads localdata.ï¼ˆæ¯ä¸ªçº¿ç¨‹æœ‰ä¸€ä»½æ‹·è´ï¼Œå¹¶ä¸”æ‰€æœ‰æ‹·è´è¢«ç»„ç»‡æˆä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥é¡ºåºéå†å®¹å™¨æ¥ç»“åˆæœ€ç»ˆç»“æœï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="type">ets_vector_t</span> = enumerable_thread_specific&lt;vector&lt;<span class="type">int</span>&gt;&gt;;</span><br><span class="line"><span class="function"><span class="type">ets_vector_t</span> <span class="title">partial</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="built_in">parallel_for</span>(<span class="number">0</span>, <span class="number">10</span>, [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">  <span class="type">ets_vector_t</span>::reference local = partial.<span class="built_in">local</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span>&amp; x : local) x = <span class="number">20</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sum</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span>&amp; it : partial)</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; N; ++j) sum[j] += it[j];</span><br></pre></td></tr></table></figure><p>ç”¨æ³•å°±æ˜¯åŒ…è£…ä¸€ä¸ªtbb::enumerable_thread_specificï¼Œç„¶ååœ¨å†…éƒ¨ä½¿ç”¨localå¾—åˆ°è‡ªå·±çš„é‚£ä»½æ‹·è´ï¼Œæ­¤å¤–å¯ä»¥éå†æ•´ä¸ªå®¹å™¨ï¼Œå¾—åˆ°æ¯ä¸€ä»½æ‹·è´ã€‚ï¼ˆå¦‚æœè¯¥çº¿ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨localï¼Œå°±ä¼šåˆ›å»ºä¸€ä»½ï¼Œå¦åˆ™ä¼šä½¿ç”¨è‡ªå·±å·²ç»åˆ›å»ºçš„é‚£ä»½ï¼‰</p><p>å¯ä»¥ä½¿ç”¨<code>size()</code>å¾—åˆ°æœ‰å‡ ä¸ªæ‹·è´ï¼Œä½†æ˜¯è¯¥å®¹å™¨åªæ”¯æŒé¡ºåºéå†ï¼Œä¸èƒ½éšæœºè®¿é—®(ä¸æ”¯æŒ<code>[]</code>)ã€‚æ‰€ä»¥å¦‚æœæŒ‡å®šçº¿ç¨‹æƒ³æŸ¥çœ‹å¯¹æ–¹çš„ç§æœ‰æ‹·è´ï¼Œè¿™æ˜¯ä¸è¡Œçš„ï¼Œä½ æ—¢ä¸çŸ¥é“å®ƒçš„ä¸‹æ ‡ï¼Œä¹Ÿæ²¡åŠæ³•ç›´æ¥è®¿é—®</p><p><code>combinable</code>ï¼šprovides thread local storage for holding per-threadsubcomputations that will later be reduced to a single result. Each thread canonly see its local data or, after calling combine, the combined data.ï¼ˆç”¨äºå­˜å‚¨ä¸­é—´ç»“æœï¼Œåªèƒ½çœ‹åˆ°è‡ªå·±çš„æ•°æ®ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">combinable&lt;vector&lt;<span class="type">int</span>&gt;&gt; partial&#123;[]()&#123;<span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(N); &#125;&#125;;</span><br><span class="line"><span class="built_in">parallel_for</span>(<span class="number">0</span>, <span class="number">10</span>, [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">  <span class="keyword">auto</span>&amp; local = partial.<span class="built_in">local</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sum</span><span class="params">(N)</span></span>;</span><br><span class="line">partial.<span class="built_in">combine_each</span>([&amp;](<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; a) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) sum[i] += a[i];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>combinableéœ€è¦ä¼ å…¥ä¸€ä¸ªlambdaï¼Œåœ¨localä¸­ä¼šè°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–ã€‚</p><p>é€šè¿‡combine_eachå°†æ¯ä»½æ‹·è´çš„ç»“æœåˆå¹¶èµ·æ¥ã€‚</p><p>noteï¼šä¸ªäººæ„Ÿè§‰è¿™ä¸¤è€…å·®ä¸å¤šï¼Œcombine_eachå…¶å®å°±ç­‰ä»·äºé¡ºåºéå†æ‹·è´æ„æˆçš„å®¹å™¨</p><hr><p>Task</p><p><code>parallel_invoke(f1,f2...)</code>ï¼ˆéšå¼çš„task spawningå’Œbarrierï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">task_group g;</span><br><span class="line">g.<span class="built_in">run</span>(f1);</span><br><span class="line">g.<span class="built_in">run</span>(f2);</span><br><span class="line">...</span><br><span class="line">g.<span class="built_in">wait</span>();</span><br></pre></td></tr></table></figure><p><code>run_and_wait(f)</code>ï¼šwe avoid the overhead of enqueueing-schedulingdequeuingsteps, and second, we avoid the potential stealing that can happen while thetask is in the queue.</p><p><code>cancel()</code></p><p>å¦‚æœæœ‰å¤§é‡ä»»åŠ¡ï¼Œçº¿æ€§spawnä¸å¦‚é€’å½’spawnï¼ˆæ»¡äºŒå‰çš„å½¢å¼ï¼‰</p><hr><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">parallel_for</span>(<span class="number">0</span>, n, [](<span class="type">int</span> i) &#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">parallel_for</span>(<span class="built_in">blocked_range</span>&lt;<span class="type">int</span>&gt;(<span class="number">0</span>, n), [&amp;](<span class="type">const</span> <span class="keyword">auto</span>&amp; range r) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = r.<span class="built_in">begin</span>(); i != r.<span class="built_in">end</span>(); ++i) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">parallel_reduce</span>(<span class="built_in">blocked_range</span>&lt;<span class="type">int</span>&gt;(<span class="number">0</span>, n), init,  <span class="comment">// è§„çº¦</span></span><br><span class="line">  [&amp;](<span class="type">const</span> <span class="keyword">auto</span>&amp; range r, <span class="keyword">auto</span> pre) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  [&amp;](<span class="keyword">auto</span> x, <span class="keyword">auto</span> y) &#123; <span class="comment">// combine</span></span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line">);</span><br><span class="line"><span class="built_in">parallel_scan</span>(<span class="built_in">blocked_range</span>&lt;<span class="type">int</span>&gt;(<span class="number">0</span>, n), init,  <span class="comment">// å‰ç¼€è§„çº¦</span></span><br><span class="line">  [&amp;](<span class="type">const</span> <span class="keyword">auto</span>&amp; range r, <span class="keyword">auto</span> pre, <span class="type">bool</span> is_final_scan) &#123;</span><br><span class="line">    <span class="keyword">if</span> (is_final_scan) &#123;</span><br><span class="line">        <span class="comment">// write</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  [&amp;](<span class="keyword">auto</span> x, <span class="keyword">auto</span> y) &#123; <span class="comment">// combine</span></span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>å¹¶è¡Œè¿‡æ»¤ï¼šè€ƒè™‘å¯¹ä¸€ä¸ªvectoræ‰§è¡Œä¸€ä¸ªè¿‡æ»¤æ¡ä»¶ã€‚æˆ‘ç›®å‰è®¤ä¸ºæœ€å¥½çš„å†™æ³•æ˜¯å…ˆresizeè¶³å¤Ÿå¤§çš„ç©ºé—´ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªatomicè®°å½•ç»“æœvectorçš„å¤§å°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">size_t</span> local_base = res_size.<span class="built_in">fetch_add</span>(local_size);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; local_size; i++) res[local_base + i] = local_res[i];</span><br></pre></td></tr></table></figure><p>POD_vector(?)ï¼šä¸Šè¿°æƒ…å†µä¸­å¿…é¡»å…ˆresizeï¼Œä¸èƒ½reserveï¼Œè€Œresizeçš„ä¸€ä¸ªé—®é¢˜æ˜¯ä¼šå¯¹æ‰€æœ‰å…ƒç´ åšä¸€émemsetï¼Œæœ‰æ—¶å€™è¿™æ˜¯å¾ˆå¤šä½™çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¸€äº›trické¿å…è¿™ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨äºè°ƒè¯•çš„c++æ—¥å¿—åº“-spdlog</title>
      <link href="/2022/05/20/yong-yu-diao-shi-de-cri-zhi-ku-spdlog/"/>
      <url>/2022/05/20/yong-yu-diao-shi-de-cri-zhi-ku-spdlog/</url>
      
        <content type="html"><![CDATA[<h3 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">Â¶</a>ä½¿ç”¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/gabime/spdlog.git</span><br></pre></td></tr></table></figure><p>header-only æ‰€ä»¥ç›´æ¥includeå¤´æ–‡ä»¶å³å¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥installæˆé™æ€åº“</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_include_directories</span>(xxx</span><br><span class="line">PRIVATE</span><br><span class="line">  spdlog/<span class="keyword">include</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æ—¥å¿—çº§åˆ«ï¼šinfoã€warnã€errorã€critical</p><p>mtåç¼€è¡¨ç¤ºå¤šçº¿ç¨‹ï¼ˆmulti threadedï¼‰ï¼Œståç¼€è¡¨ç¤ºå•çº¿ç¨‹</p><blockquote><p>spdlog takes the â€œinclude what you needâ€ approach - your code should includethe features that actually needed.</p></blockquote><p>è¾“å‡ºä½¿ç”¨fmtåº“ï¼Œç±»ä¼¼python</p><p>ç¼–è¯‘å™¨logè¿‡æ»¤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SPDLOG_ACTIVE_LEVEL SPDLOG_LEVEL_DEBUG</span></span><br><span class="line"></span><br><span class="line">spdlog::<span class="built_in">set_level</span>(spdlog::level::debug); <span class="comment">// or spdlog::set_level(spdlog::level::trace);</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">SPDLOG_LOGGER_TRACE</span>(file_logger , <span class="string">&quot;Some trace message that will not be evaluated.&#123;&#125; ,&#123;&#125;&quot;</span>, <span class="number">1</span>, <span class="number">3.23</span>);</span><br><span class="line"><span class="built_in">SPDLOG_LOGGER_DEBUG</span>(file_logger , <span class="string">&quot;Some Debug message that will be evaluated.. &#123;&#125; ,&#123;&#125;&quot;</span>, <span class="number">1</span>, <span class="number">3.23</span>);</span><br><span class="line"><span class="built_in">SPDLOG_DEBUG</span>(<span class="string">&quot;Some debug message to default logger that will be evaluated&quot;</span>);</span><br></pre></td></tr></table></figure><p>set level</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">spdlog::<span class="built_in">set_level</span>(spdlog::level::info); <span class="comment">// Set global log level to info</span></span><br><span class="line">spdlog::<span class="built_in">debug</span>(<span class="string">&quot;This message should not be displayed!&quot;</span>);</span><br><span class="line">spdlog::<span class="built_in">set_level</span>(spdlog::level::trace); <span class="comment">// Set specific logger&#x27;s log level</span></span><br><span class="line">spdlog::<span class="built_in">debug</span>(<span class="string">&quot;This message should be displayed..&quot;</span>);</span><br><span class="line">```cpp</span><br><span class="line"></span><br><span class="line">backtrace</span><br><span class="line"></span><br><span class="line">```cpp</span><br><span class="line"><span class="comment">// Backtrace support</span></span><br><span class="line"><span class="comment">// Loggers can store in a ring buffer all messages (including debug/trace) for later inspection.</span></span><br><span class="line"><span class="comment">// When needed, call dump_backtrace() to see what happened:</span></span><br><span class="line">spdlog::<span class="built_in">enable_backtrace</span>(<span class="number">10</span>); <span class="comment">// create ring buffer with capacity of 10 messages</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">  spdlog::<span class="built_in">debug</span>(<span class="string">&quot;Backtrace message &#123;&#125;&quot;</span>, i); <span class="comment">// not logged..</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// e.g. if some error happened:</span></span><br><span class="line">spdlog::<span class="built_in">dump_backtrace</span>(); <span class="comment">// log them now!</span></span><br></pre></td></tr></table></figure><p>shutdown</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Release all spdlog resources, and drop all loggers in the registry.</span></span><br><span class="line"><span class="comment">// This is optional (only mandatory if using windows + async log).</span></span><br><span class="line">spdlog::<span class="built_in">shutdown</span>();</span><br></pre></td></tr></table></figure><h3 id="logger"><a class="header-anchor" href="#logger">Â¶</a>logger</h3><blockquote><p>Each logger contains a vector of one or more<code>std::shared_ptr&lt;spdlog::sink&gt;</code>.</p><p>On each log call (if the log level is right) the logger will call the<code>sink(log_msg)</code> function on each of them.</p></blockquote><p>spdlogä¼šé»˜è®¤åˆ›å»ºä¸€ä¸ªå…¨å±€çš„loggerï¼ˆstdoutã€colorã€mtï¼‰ï¼Œç›´æ¥ä½¿ç”¨<code>spdlog::info(..)</code>è°ƒç”¨çš„å°±æ˜¯è¯¥logger</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">spdlog::<span class="built_in">set_default_logger</span>(some_other_logger);</span><br><span class="line">spdlog::<span class="built_in">info</span>(<span class="string">&quot;Use the new default logger&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> console = spdlog::<span class="built_in">stdout_color_mt</span>(<span class="string">&quot;some_unique_name&quot;</span>); <span class="comment">// create logger</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> file_logger = spdlog::<span class="built_in">rotating_logger_mt</span>(<span class="string">&quot;file_logger&quot;</span>, <span class="string">&quot;logs/mylogfile&quot;</span>, <span class="number">1048576</span> * <span class="number">5</span>, <span class="number">3</span>); <span class="comment">// rotate 3ä¸ªæ–‡ä»¶å¾ªç¯log</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> sink = std::<span class="built_in">make_shared</span>&lt;spdlog::sinks::stdout_sink_mt&gt;();</span><br><span class="line"><span class="keyword">auto</span> my_logger= std::<span class="built_in">make_shared</span>&lt;spdlog::logger&gt;(<span class="string">&quot;mylogger&quot;</span>, sink); <span class="comment">// manually,ä¸ä¼šregister</span></span><br><span class="line"></span><br><span class="line">std::vector&lt;spdlog::sink_ptr&gt; sinks;</span><br><span class="line">sinks.<span class="built_in">push_back</span>(std::<span class="built_in">make_shared</span>&lt;spdlog::sinks::stdout_sink_st&gt;());</span><br><span class="line">sinks.<span class="built_in">push_back</span>(std::<span class="built_in">make_shared</span>&lt;spdlog::sinks::daily_file_sink_st&gt;(<span class="string">&quot;logfile&quot;</span>, <span class="number">23</span>, <span class="number">59</span>));</span><br><span class="line"><span class="keyword">auto</span> combined_logger = std::<span class="built_in">make_shared</span>&lt;spdlog::logger&gt;(<span class="string">&quot;name&quot;</span>, <span class="built_in">begin</span>(sinks), <span class="built_in">end</span>(sinks)); <span class="comment">// one log and multiple sink</span></span><br><span class="line"><span class="comment">//register it if you need to access it globally</span></span><br><span class="line">spdlog::<span class="built_in">register_logger</span>(combined_logger);</span><br></pre></td></tr></table></figure><h3 id="sink"><a class="header-anchor" href="#sink">Â¶</a>sink</h3><p>logå’Œsinkéƒ½åˆ†åˆ«ç”±stå’Œmt</p><p>loggerçš„åŠŸèƒ½ç”±sinkå†³å®š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">loggerï¼š</span><br><span class="line">spdlog::rotating_logger_mt</span><br><span class="line">spdlog::daily_logger_mt</span><br><span class="line">spdlog::basic_logger_mt</span><br><span class="line">spdlog::stdout_logger_mt</span><br><span class="line">spdlog::stderr_logger_st</span><br><span class="line">spdlog::stdout_color_mt</span><br><span class="line">spdlog::stderr_color_st</span><br><span class="line">-----------------------</span><br><span class="line">sinkï¼š</span><br><span class="line">exampleï¼šspdlog::sinks::rotating_file_sink_mt</span><br></pre></td></tr></table></figure><h3 id="register"><a class="header-anchor" href="#register">Â¶</a>register</h3><blockquote><p>spdlog maintains a global (per process) registry of the created loggers.</p><p>The purpose is for loggers to be accessed easily from anywhere in theproject without passing them around.ï¼ˆé¿å…å‚æ•°ä¼ é€’ï¼‰</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spdlog::<span class="built_in">get</span>(<span class="string">&quot;logger_name&quot;</span>); <span class="comment">// å†…éƒ¨æœ‰lockï¼Œæœ€å¥½ä½¿ç”¨ä¸€ä¸ªå˜é‡ä¿å­˜</span></span><br><span class="line">spdlog::<span class="built_in">register_logger</span>(some_logger);</span><br><span class="line">spdlog::<span class="built_in">drop</span>(<span class="string">&quot;logger_name&quot;</span>);</span><br><span class="line"><span class="comment">//or remove them all</span></span><br><span class="line">spdlog::<span class="built_in">drop_all</span>()</span><br></pre></td></tr></table></figure><h3 id="format"><a class="header-anchor" href="#format">Â¶</a>format</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spdlog::<span class="built_in">set_pattern</span>(<span class="string">&quot;*** [%H:%M:%S %z] [thread %t] %v ***&quot;</span>); <span class="comment">// global to all</span></span><br><span class="line">some_logger-&gt;<span class="built_in">set_pattern</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; %H:%M:%S %z %v &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>);</span><br><span class="line">some_logger-&gt;<span class="built_in">sinks</span>()[<span class="number">0</span>]-&gt;<span class="built_in">set_pattern</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; %H:%M:%S %z %v &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>google benchmark</title>
      <link href="/2022/05/07/google-benchmark/"/>
      <url>/2022/05/07/google-benchmark/</url>
      
        <content type="html"><![CDATA[<h3 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">Â¶</a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/google/benchmark.git</span><br><span class="line"><span class="built_in">cd</span> benchmark</span><br><span class="line">cmake -E make_directory <span class="string">&quot;build&quot;</span></span><br><span class="line">cmake -E <span class="built_in">chdir</span> <span class="string">&quot;build&quot;</span> cmake -DBENCHMARK_DOWNLOAD_DEPENDENCIES=on -DCMAKE_BUILD_TYPE=Release ../</span><br><span class="line">cmake --build <span class="string">&quot;build&quot;</span> --config Release</span><br><span class="line"></span><br><span class="line">cmake -E <span class="built_in">chdir</span> <span class="string">&quot;build&quot;</span> ctest --build-config Release</span><br><span class="line"></span><br><span class="line">sudo cmake --build <span class="string">&quot;build&quot;</span> --config Release --target install</span><br></pre></td></tr></table></figure><h3 id="cmake"><a class="header-anchor" href="#cmake">Â¶</a>cmake</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(benchmark REQUIRED)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(xxx</span><br><span class="line">PRIVATE</span><br><span class="line">  benchmark::benchmark</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">Â¶</a>ä½¿ç”¨</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">SomeFunction</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> std::<span class="built_in">max</span>(a, b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">BM_SomeFunction</span><span class="params">(benchmark::State&amp; state)</span> </span>&#123; <span class="comment">// a wrapper</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> _ : state) &#123;</span><br><span class="line">    <span class="built_in">SumeFunction</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">BENCHMARK</span>(BM_SomeFunction);</span><br><span class="line"></span><br><span class="line"><span class="built_in">BENCHMARK_MAIN</span>();</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰mainå‡½æ•°ï¼Œåªéœ€è¦åœ¨æœ€ååŠ ä¸Šä»¥ä¸‹ä¸¤è¡Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">::benchmark::<span class="built_in">Initialize</span>(&amp;argc, argv);</span><br><span class="line">::benchmark::<span class="built_in">RunSpecifiedBenchmarks</span>();</span><br></pre></td></tr></table></figure><p>å®˜æ–¹å¯¹æ•´å‹å˜é‡çš„æ”¯æŒæ¯”è¾ƒå¥½ï¼Œæœ‰å„ç§rangeçš„ä¼ å‚æ–¹å¼ã€‚å¦‚æœéœ€è¦ä¼ å…¥å…¶ä»–å˜é‡ï¼Œéœ€è¦ä½¿ç”¨CAPTUREï¼Œä¼ å‚æ–¹å¼ç±»ä¼¼emplace_backä¹‹ç±»çš„Iterationså¯ä»¥æŒ‡å®šè¿­ä»£æ¬¡æ•°UnitæŒ‡å®šæ—¶é—´å•ä½ï¼ˆé»˜è®¤æ˜¯nsï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BENCHMARK_CAPTURE</span>(BM_xxx, xxx_test, arg)</span><br><span class="line">  -&gt;<span class="built_in">Iterations</span>(<span class="number">5</span>)</span><br><span class="line">  -&gt;<span class="built_in">Unit</span>(benchmark::kMillisecond);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›ºå®šåŒºé—´æœ€å€¼æŸ¥è¯¢</title>
      <link href="/2021/09/28/gu-ding-qu-jian-zui-zhi-cha-xun/"/>
      <url>/2021/09/28/gu-ding-qu-jian-zui-zhi-cha-xun/</url>
      
        <content type="html"><![CDATA[<p>å¯¹äºä¸€ç»´ï¼Œç”¨å•è°ƒé˜Ÿåˆ—å°±å¯ä»¥è§£å†³ã€‚äºŒç»´çš„è¯ï¼Œå…ˆå¯¹æ¯ä¸€åˆ—åšä¸€éï¼Œç„¶åå‹ç¼©æˆä¸€ç»´æ›´é«˜ç»´åŒç†ã€‚ã€‚ã€‚</p><p>è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹å‰kä¼˜æœ€å€¼çš„è®°å½•ä¾‹å¦‚ç°åœ¨è¦æ±‚å›ºå®šåŒºé—´çš„æœ€å°å€¼å’Œæ¬¡å°å€¼ã€‚æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªå•å¢é˜Ÿåˆ—ã€‚æ¯å½“ç§»åŠ¨ræŒ‡é’ˆï¼Œå…ˆç»´æŠ¤ç¬¬ä¸€ä¸ªé˜Ÿåˆ—çš„å•è°ƒæ€§ï¼Œå¼¹å‡ºçš„å…ƒç´ å¡åˆ°ç¬¬äºŒä¸ªé˜Ÿåˆ—ä¸­ã€‚é‚£ä¹ˆæ¬¡å¤§å€¼å°±æ˜¯ç¬¬ä¸€ä¸ªæ ˆä¸­çš„æ¬¡å¤§å€¼æˆ–è€…ç¬¬äºŒä¸ªæ ˆä¸­çš„æœ€å¤§å€¼ã€‚</p><p>å¦å¤–å¯ä»¥é‡‡ç”¨åŒæ ˆæ¨¡æ‹Ÿé˜Ÿåˆ—çš„æ–¹å¼ï¼Œæ ˆä¸­å­˜çš„æ˜¯pair(å½“å‰å…ƒç´ å¤§å°ï¼Œæ ˆåº•åˆ°å½“å‰å…ƒç´ çš„æœ€å°å€¼)ã€‚åŒç†å¯¹äºkå°å€¼åªè¦ä¿®æ”¹secondä¸ºkç»´çš„tupleå³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æåˆæ ‘ï¼ˆpermutation treeï¼‰</title>
      <link href="/2021/09/13/xi-he-shu-permutation-tree/"/>
      <url>/2021/09/13/xi-he-shu-permutation-tree/</url>
      
        <content type="html"><![CDATA[<p>ä»…é™äºè§£å†³<strong>æ’åˆ—</strong>ä¸­ä¸è¿ç»­æ®µç›¸å…³çš„é—®é¢˜ï¼Œå±€é™æ€§æ¯”è¾ƒå¤§ï¼Œè™½ç„¶å¹³å‡¡åºåˆ—ä¹Ÿèƒ½åšï¼Œä½†æ˜¯ä¼šå¤æ‚å¾ˆå¤šä¸€äº›å®šä¹‰ï¼šæ®µï¼šè¯¥åŒºé—´æ’åºåå€¼åŸŸè¿ç»­æœ¬åŸæ®µï¼šä¸å…¶å®ƒè¿ç»­æ®µåªæœ‰åŒ…å«å’Œç›¸ç¦»çš„å…³ç³»ï¼Œæ²¡æœ‰ç›¸äº¤å…³ç³»å„¿å­æ’åˆ—ï¼šå„ä¸ªå„¿å­ç¦»æ•£åŒ–åçš„ç¼–å·å½¢æˆçš„æ’åˆ—åˆç‚¹ï¼šå„¿å­æ’åˆ—ä¸ºé¡ºåºæˆ–é€†åºï¼ˆå¶å­ä¹Ÿè®¤ä¸ºæ˜¯åˆç‚¹ï¼‰æç‚¹ï¼šä¸æ˜¯åˆç‚¹çš„èŠ‚ç‚¹</p><ul><li>åˆç‚¹çš„å„¿å­åºåˆ—çš„ä»»æ„å­åŒºé—´éƒ½æ˜¯ä¸€ä¸ªè¿ç»­æ®µ</li><li>æç‚¹çš„å„¿å­åºåˆ—çš„ä»»æ„é•¿åº¦å¤§äº1çš„å­åŒºé—´éƒ½ä¸æ˜¯è¿ç»­æ®µï¼ˆå¦åˆ™è¯¥åŒºé—´å°±æ˜¯ä¸€ä¸ªæœ¬åŸæ®µï¼‰</li></ul><p>æåˆæ ‘å°±æ˜¯ç”±è‹¥å¹²æœ¬åŸæ®µæ„æˆï¼Œä¸”æ¯ä¸ªæœ¬åŸæ®µæ˜¯åˆç‚¹å’Œæç‚¹ä¸­çš„ä¸€ç§ã€‚å¢é‡æ„é€ $O(n\log n)$ï¼Œç»´æŠ¤å‰$i$ä¸ªç»“ç‚¹çš„æ ˆï¼Œç„¶åè€ƒè™‘å½“å‰ç»“ç‚¹$P_i$â€‹</p><ol><li>æ ˆé¡¶ä¸ºåˆç‚¹ä¸”å¯ä»¥æˆä¸ºå®ƒçš„å„¿å­</li><li>æ ˆçš„æŸä¸ªåç¼€å¯ä»¥ç”Ÿæˆä¸€ä¸ªåˆç‚¹ä½œä¸ºçˆ¶äº²</li><li>æ ˆçš„æŸä¸ªåç¼€å¯ä»¥ç”Ÿæˆä¸€ä¸ªæç‚¹ä½œä¸ºçˆ¶äº²</li></ol><p>æœ€ä¸»è¦çš„ä¸€ä¸ªè¾…åŠ©å·¥å…·æ˜¯å¿«é€ŸæŸ¥è¯¢$[j,i]$è¿™ä¸ªåŒºé—´æ˜¯å¦æ˜¯è¿ç»­æ®µï¼Œç”±äºæ˜¯æ’åˆ—ï¼Œæ‰€ä»¥åªéœ€è¦æ£€æŸ¥$Q_j=\max\limits_{i\lek\le j}P_k-\min\limits_{i\le k\le j}P_k-(i-j)=0$ï¼Œåˆæ³¨æ„åˆ°$Q_j\ge 0$ï¼Œå› æ­¤ç”¨å•è°ƒæ ˆå’Œçº¿æ®µæ ‘ç»´æŠ¤$Q$ï¼Œå€¼ä¸º0çš„ç‚¹å°±å¯ä»¥ä½œä¸ºè¿ç»­æ®µçš„å·¦ç«¯ç‚¹ã€‚</p><p>ä»£ç è§£é‡Šï¼šèŠ‚ç‚¹æ•°è¦å¼€ä¸¤å€$id_i$â€‹ï¼šè¡¨ç¤ºæ’åˆ—ä¸­ç¬¬$i$ä¸ªæ•°åœ¨æåˆæ ‘ä¸­çš„ç¼–å·$L_i,R_i$â€‹ï¼šç¼–å·ä¸º$i$çš„ç‚¹åœ¨æ’åˆ—ä¸­å¯¹åº”çš„ä¸‹æ ‡èŒƒå›´$SR_i$â€‹ï¼šç¼–å·ä¸º$i$çš„ç‚¹å½“å‰æœ€é å³ï¼ˆæœ€ååŠ å…¥ï¼‰çš„å„¿å­çš„$L$$type_i$â€‹ï¼šç¼–å·ä¸º$i$çš„ç‚¹çš„ç±»å‹ï¼Œ1è¡¨ç¤ºåˆç‚¹ï¼Œ0è¡¨ç¤ºæç‚¹$rt$ï¼šæåˆæ ‘çš„æ ¹èŠ‚ç‚¹$cnt$ï¼šæåˆæ ‘çš„èŠ‚ç‚¹æ•°$askmn$ï¼šå•ç‚¹æŸ¥è¯¢ä¸€ä¸ªç‚¹çš„$Q$ï¼Œç”¨äºæ£€æŸ¥æ˜¯å¦ä¸ºè¿ç»­æ®µ$askpos$ï¼šæ‰¾åˆ°æœ€é å·¦çš„å¯ä»¥ä¸å½“å‰å³ç«¯ç‚¹æ„æˆè¿ç»­æ®µä¸‹æ ‡å¯¹äºå½“å‰ç‚¹$i$ï¼Œå…ˆç»´æŠ¤å¥½$Q$åºåˆ—</p><ol><li>å¦‚æœèƒ½ä¸æ ˆé¡¶æœ€å³çš„å„¿å­å½¢æˆè¿ç»­æ®µå°±ä½œä¸ºå®ƒçš„å„¿å­ï¼ˆæ­¤æ—¶æ ˆé¡¶å¿…ç„¶æ˜¯åˆç‚¹ï¼Œå› ä¸ºæç‚¹ä¸å¯èƒ½æœ‰å­åŒºé—´æ˜¯è¿ç»­æ®µï¼‰</li><li>å¦‚æœèƒ½ä¸æ ˆé¡¶æ„æˆè¿ç»­æ®µï¼Œåˆ™ç”Ÿæˆä¸€ä¸ªåˆç‚¹</li><li>å¦åˆ™å¦‚æœæŸä¸ªåç¼€æ˜¯è¿ç»­æ®µï¼Œå°±ç”Ÿæˆä¸€ä¸ªæç‚¹</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Ptree &#123;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = N&lt;&lt;<span class="number">1</span>, LOG = <span class="number">17</span>;</span><br><span class="line"><span class="type">int</span> id[M], L[M], R[M], SR[M], type[M], rt, cnt;</span><br><span class="line"><span class="type">int</span> stk[M], stk1[M], stk2[M], tp, tp1, tp2;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[M];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; G[x].<span class="built_in">push_back</span>(y); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">    <span class="keyword">while</span>(tp1 &amp;&amp; a[i]&lt;=a[stk1[tp1]]) &#123;</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, stk1[tp1<span class="number">-1</span>]+<span class="number">1</span>, stk1[tp1], a[stk1[tp1]]);</span><br><span class="line">      --tp1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, stk1[tp1]+<span class="number">1</span>, i, -a[i]);</span><br><span class="line">    stk1[++tp1] = i;</span><br><span class="line">    <span class="keyword">while</span>(tp2 &amp;&amp; a[i]&gt;=a[stk2[tp2]]) &#123;</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, stk2[tp2<span class="number">-1</span>]+<span class="number">1</span>, stk2[tp2], -a[stk2[tp2]]);</span><br><span class="line">      --tp2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, stk2[tp2]+<span class="number">1</span>, i, a[i]);</span><br><span class="line">    stk2[++tp2] = i;</span><br><span class="line">    id[i] = ++cnt;</span><br><span class="line">    L[cnt] = R[cnt] = i;</span><br><span class="line">    <span class="type">int</span> pos = <span class="built_in">askpos</span>(<span class="number">1</span>), now = cnt;</span><br><span class="line">    <span class="keyword">while</span>(tp &amp;&amp; L[stk[tp]]&gt;=pos) &#123;</span><br><span class="line">      <span class="keyword">if</span>(type[stk[tp]] &amp;&amp; <span class="built_in">askmn</span>(<span class="number">1</span>, SR[stk[tp]])==<span class="number">0</span>) &#123;</span><br><span class="line">        R[stk[tp]] = i, SR[stk[tp]] = L[now], <span class="built_in">add</span>(stk[tp], now), now = stk[tp--];</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">askmn</span>(<span class="number">1</span>, L[stk[tp]])==<span class="number">0</span>) &#123;</span><br><span class="line">        type[++cnt] = <span class="number">1</span>;</span><br><span class="line">        L[cnt] = L[stk[tp]], R[cnt] = i, SR[cnt] = L[now];</span><br><span class="line">        <span class="built_in">add</span>(cnt, stk[tp--]), <span class="built_in">add</span>(cnt, now);</span><br><span class="line">        now = cnt;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">add</span>(++cnt, now);</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">          <span class="built_in">add</span>(cnt, stk[tp--]);</span><br><span class="line">        &#125; <span class="keyword">while</span>(tp &amp;&amp; <span class="built_in">askmn</span>(<span class="number">1</span>, L[stk[tp]])!=<span class="number">0</span>);</span><br><span class="line">        L[cnt] = L[stk[tp]], R[cnt] = i, <span class="built_in">add</span>(cnt, stk[tp--]);</span><br><span class="line">        now = cnt;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stk[++tp] = now;</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, <span class="number">1</span>, i, <span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  rt = stk[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">//namespace Ptree</span></span><br></pre></td></tr></table></figure><ul><li><p>Codeforces 526F â€“ Pudding MonstersæŸ¥è¯¢ä¸€ä¸ªæ’åˆ—çš„è¿ç»­æ®µä¸ªæ•°ï¼Œæ˜¾ç„¶åªéœ€è¦å®ŒæˆQåºåˆ—çš„ç»´æŠ¤å³å¯</p></li><li><p>CERC 17 Problem I â€“ Instrinsic Intervalç»™å‡ºä¸€ä¸ªæ’åˆ—ï¼Œæ¯æ¬¡æŸ¥è¯¢ç»™å‡º$l,r$ï¼Œé—®ä½ æœ€çŸ­çš„åŒ…å«è¯¥åŒºé—´çš„è¿ç»­æ®µçš„å·¦å³ç«¯ç‚¹æˆ‘ä»¬å…ˆæ±‚å‡ºLCAï¼Œå¦‚æœæ˜¯æç‚¹ï¼Œè¯´æ˜ç­”æ¡ˆåªèƒ½æ˜¯LCAçš„å·¦å³ç«¯ç‚¹ï¼›å¦åˆ™å¯ä»¥åœ¨å„¿å­åºåˆ—ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„åŒ…å«$l,r$çš„å­åŒºé—´ï¼Œå®è´¨ä¸Šåˆ©ç”¨å€å¢è·³åˆ°LCAçš„å„¿å­å³å¯</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hdu 6356 åå‘STè¡¨/çº¿æ®µæ ‘å‰ªæ</title>
      <link href="/2021/09/07/hdu-6536-fan-xiang-st-biao-xian-duan-shu-jian-zhi/"/>
      <url>/2021/09/07/hdu-6536-fan-xiang-st-biao-xian-duan-shu-jian-zhi/</url>
      
        <content type="html"><![CDATA[<p>ç»™å‡ºmæ¬¡åŒºé—´å–maxçš„æ“ä½œ<code>(l,r,v)</code>ï¼Œé—®ä½ æœ€åæ•°ç»„çš„çŠ¶æ€(åˆå§‹å‡ä¸º0)ï¼Œæ“ä½œé€šè¿‡éšæœºçš„æ–¹å¼ç»™å‡ºã€‚</p><p>åŒºé—´å–maxï¼Œå¯ä»¥ç”¨sgbtæ¥åšï¼Œä¸è¿‡æ³¨æ„åˆ°æœ¬é¢˜æ“ä½œéšæœº(æ—¢ç„¶æ˜¯éšæœºç»™å‡ºçš„ï¼Œå¿…ç„¶æœ‰å®ƒçš„ç”¨æ„)ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å‰ªæçš„æ–¹å¼ï¼šç»´æŠ¤åŒºé—´æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œå½“å‰æœ€å¤§å€¼æ¯”vè¿˜å°å°±æ˜¯åŒºé—´è¦†ç›–ï¼Œæœ€å°å€¼æ¯”vè¿˜å¤§å°±ç›´æ¥reutrnã€‚</p><p>æ­¤å¤–è¿˜æœ‰ä¸€ç§åå‘STè¡¨çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¾—åˆ°é«˜å±‚STè¡¨çš„çŠ¶æ€ï¼Œç„¶åå†ä»é«˜åˆ°ä½é€’æ¨å‡ºåº•å±‚çš„çŠ¶æ€å³å¯ã€‚å½“ç„¶è¿™ç§æ–¹å¼æœ‰å¾ˆå¤§çš„é™åˆ¶ï¼Œæ„Ÿè§‰åªé€‚ç”¨äºåŒºé—´å–æœ€å€¼ï¼Œåªæœ‰æœ€åä¸€æ¬¡è¯¢é—®çš„æƒ…å†µã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> uint = <span class="type">uint32_t</span>;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">uint x, y, z, w;</span><br><span class="line"><span class="function">uint <span class="title">rng61</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  x = x^(x&lt;&lt;<span class="number">11</span>);</span><br><span class="line">  x = x^(x&gt;&gt;<span class="number">4</span>);</span><br><span class="line">  x = x^(x&lt;&lt;<span class="number">5</span>);</span><br><span class="line">  x = x^(x&gt;&gt;<span class="number">14</span>);</span><br><span class="line">  w = x^(y^z);</span><br><span class="line">  x = y;</span><br><span class="line">  y = z;</span><br><span class="line">  z = w;</span><br><span class="line">  <span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Max</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">if</span>(x&lt;y) x = y; &#125;</span><br><span class="line"><span class="type">int</span> st[N][<span class="number">18</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%u%u%u&quot;</span>, &amp;n, &amp;m, &amp;x, &amp;y, &amp;z);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n; j++) st[i][j] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) &#123;</span><br><span class="line">    uint f0 = <span class="built_in">rng61</span>(), f1 = <span class="built_in">rng61</span>(), f2 = <span class="built_in">rng61</span>();</span><br><span class="line">    <span class="type">int</span> l = <span class="built_in">min</span>(f0%n+<span class="number">1</span>, f1%n+<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> r = <span class="built_in">max</span>(f0%n+<span class="number">1</span>, f1%n+<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> v = f2%(<span class="number">1</span>&lt;&lt;<span class="number">30</span>);</span><br><span class="line">    <span class="type">int</span> k = <span class="number">31</span> - __builtin_clz(r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">Max</span>(st[l][k], v);</span><br><span class="line">    <span class="built_in">Max</span>(st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k], v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">16</span>; j&gt;=<span class="number">0</span>; j--)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i+(<span class="number">1</span>&lt;&lt;(j+<span class="number">1</span>))<span class="number">-1</span>&lt;=n; i++) &#123;</span><br><span class="line">      <span class="built_in">Max</span>(st[i][j], st[i][j+<span class="number">1</span>]);</span><br><span class="line">      <span class="built_in">Max</span>(st[i+(<span class="number">1</span>&lt;&lt;j)][j], st[i][j+<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) ans ^= <span class="number">1ll</span>*i*st[i][<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bzoj2724 è’²å…¬è‹± åŒºé—´ä¼—æ•°+å¼ºåˆ¶åœ¨çº¿</title>
      <link href="/2021/09/03/bzoj2724-pu-gong-ying-qu-jian-zhong-shu-qiang-zhi-zai-xian/"/>
      <url>/2021/09/03/bzoj2724-pu-gong-ying-qu-jian-zhong-shu-qiang-zhi-zai-xian/</url>
      
        <content type="html"><![CDATA[<p>å¯ä»¥ç¦»çº¿çš„è¯æ€ä¹ˆåšï¼Ÿé¦–å…ˆæƒ³åˆ°çš„è‚¯å®šæ˜¯è«é˜Ÿï¼Œä¸è¿‡åˆ é™¤æ“ä½œæœ‰ç‚¹æ£˜æ‰‹ã€‚ç›®å‰åªæœ‰ä¸¤ä¸ªæƒ³æ³•ï¼š1.æ— è„‘ä¸Šå›æ»šè«é˜Ÿã€‚2.å†åŠ ä¸€ä¸ªåˆ†å—æ¥ç»´æŠ¤å‡ºç°æ¬¡æ•°ï¼Œç§»åŠ¨O(1)ï¼ŒæŸ¥è¯¢$O(\sqrtn)$ã€‚ä¸è¿‡æ„Ÿè§‰éƒ½æ²¡æœ‰åœ¨çº¿ç®€å•</p><p>åˆ†å—ä¹‹åï¼Œå¦‚æœç»´æŠ¤çš„ä¿¡æ¯å¯ä»¥é€’æ¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç»´æŠ¤å‡ºä»»æ„ä¸¤ä¸ªå—ä¹‹é—´çš„ä¿¡æ¯ã€‚æœ¬é¢˜å°±æ˜¯ä»»æ„ä¸¤ä¸ªå—ä¹‹é—´çš„ä¼—æ•°ï¼Œè¿™æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œè€Œä¸”æ˜¯$O(\frac{N^2}{B})$çš„ã€‚å¯ä»¥å‘ç°ç­”æ¡ˆè‚¯å®šè¦ä¹ˆæ˜¯ä¸Šé¢è¿™ä¸ªï¼Œè¦ä¹ˆæ˜¯ä¸¤ä¸ªè¾¹ç¼˜å—ä¸­å‡ºç°çš„æ•°å­—ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æšä¸¾è¾¹ç¼˜å—çš„æ•°å­—æ¥è¿›è¡Œæ›´æ–°å³å¯ã€‚ä¸€ç§æ˜¾ç„¶çš„æƒ³æ³•å°±æ˜¯å¯¹æ¯ä¸ªæ•°å­—è¿›è¡ŒäºŒåˆ†æ¥æ±‚è§£å‡ºç°æ¬¡æ•°ï¼Œè¿™æ ·æ˜¯$O(MB\logN)$çš„ï¼Œéœ€è¦å¯¹Bè¿›è¡Œæƒè¡¡ã€‚å¦å¤–ä¸€ç§å¾ˆå¦™çš„æ€è·¯ï¼Œè€ƒè™‘åˆ°ä¸¤ä¸ªè¾¹ç¼˜å—å¯¹ç­”æ¡ˆçš„è´¡çŒ®æœ€å¤šæ˜¯$2B$ï¼Œé‚£æˆ‘ç›´æ¥O(1)å»checkè´¡çŒ®èƒ½ä¸èƒ½å†+1ï¼Œè¿™æ ·å°±æ˜¯$O(MB)$çš„äº†(æ³¨ï¼šMæ˜¯è¯¢é—®æ¬¡æ•°ï¼ŒNæ˜¯æ•°å­—ä¸ªæ•°ï¼ŒBæ˜¯å—å¤§å°ï¼Œæ ¹æ®å‡å€¼ä¸ç­‰å¼ä½¿ä¸¤ä¸ªå¤æ‚åº¦ç›¸ç­‰ï¼Œé€‰æ‹©æœ€ä¼˜çš„Bå³å¯ï¼Œå½“ç„¶å…·ä½“å®ç°æ—¶åªè¦å¤§è‡´ä¼°è®¡ä¸€ä¸ªå¸¸æ•°å³å¯)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">4e4</span> + <span class="number">5</span>, B = <span class="number">250</span>;</span><br><span class="line"><span class="type">int</span> n, m, a[N], v[N], tot;</span><br><span class="line"><span class="type">int</span> f[B][B], g[B][B], cnt[N];</span><br><span class="line"><span class="type">int</span> blo, num, bl[N], l[B], r[B], pos[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lsh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> tmp[N];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) tmp[i] = a[i];</span><br><span class="line">  <span class="built_in">sort</span>(tmp+<span class="number">1</span>, tmp+n+<span class="number">1</span>);</span><br><span class="line">  tot = <span class="built_in">unique</span>(tmp+<span class="number">1</span>, tmp+n+<span class="number">1</span>) - tmp - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">    <span class="type">int</span> pre = a[i];</span><br><span class="line">    a[i] = <span class="built_in">lower_bound</span>(tmp+<span class="number">1</span>, tmp+tot+<span class="number">1</span>, a[i]) - tmp;</span><br><span class="line">    v[a[i]] = pre;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=tot; i++) cnt[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> y=x; y&lt;=num; y++) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l[y]; i&lt;=r[y]; i++) &#123;</span><br><span class="line">      <span class="type">int</span> cur = a[i];</span><br><span class="line">      cnt[cur]++;</span><br><span class="line">      <span class="keyword">if</span>(!res || cnt[cur]&gt;cnt[res] || (cnt[cur]==cnt[res] &amp;&amp; cur&lt;res)) &#123;</span><br><span class="line">        res = cur;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    f[x][y] = res;</span><br><span class="line">    g[x][y] = cnt[res];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  blo = <span class="built_in">sqrt</span>(n);</span><br><span class="line">  num = (n+blo<span class="number">-1</span>)/blo;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) bl[i] = (i<span class="number">-1</span>)/blo + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=num; i++) l[i] = (i<span class="number">-1</span>)*blo + <span class="number">1</span>, r[i] = i*blo;</span><br><span class="line">  r[num] = n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=num; i++) <span class="built_in">build</span>(i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">    p[a[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    pos[i] = (<span class="type">int</span>)p[a[i]].<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qry</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> res = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(bl[x]+<span class="number">1</span>&lt;=bl[y]<span class="number">-1</span>) res = f[bl[x]+<span class="number">1</span>][bl[y]<span class="number">-1</span>], cnt = g[bl[x]+<span class="number">1</span>][bl[y]<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=<span class="built_in">min</span>(r[bl[x]], y); i++) &#123;</span><br><span class="line">    <span class="type">int</span> nxt = (a[i]&lt;res ? cnt : cnt+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span>(pos[i]+nxt<span class="number">-1</span>&lt;(<span class="type">int</span>)p[a[i]].<span class="built_in">size</span>() &amp;&amp; p[a[i]][pos[i]+nxt<span class="number">-1</span>]&lt;=y) &#123;</span><br><span class="line">      res = a[i];</span><br><span class="line">      cnt = nxt++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(bl[x]!=bl[y]) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l[bl[y]]; i&lt;=y; i++) &#123;</span><br><span class="line">      <span class="type">int</span> nxt = (a[i]&lt;res ? cnt : cnt+<span class="number">1</span>);</span><br><span class="line">      <span class="keyword">while</span>(pos[i]-nxt+<span class="number">1</span>&gt;=<span class="number">0</span> &amp;&amp; p[a[i]][pos[i]-nxt+<span class="number">1</span>]&gt;=x) &#123;</span><br><span class="line">        res = a[i];</span><br><span class="line">        cnt = nxt++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="built_in">lsh</span>();</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="type">int</span> lstans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(m--) &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    l = (l + lstans - <span class="number">1</span>)%n + <span class="number">1</span>, r = (r + lstans - <span class="number">1</span>)%n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;r) <span class="built_in">swap</span>(l, r);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, lstans = v[<span class="built_in">qry</span>(l, r)]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€ä¸‹å„ç§è½¯ä»¶çš„é…ç½®</title>
      <link href="/2021/08/29/ji-lu-yi-xia-ge-chong-ruan-jian-de-pei-zhi/"/>
      <url>/2021/08/29/ji-lu-yi-xia-ge-chong-ruan-jian-de-pei-zhi/</url>
      
        <content type="html"><![CDATA[<p>ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œç»Ÿä¸€æ”¾åˆ°D:\environmentç›®å½•ä¸‹</p><h2 id="MinGW"><a class="header-anchor" href="#MinGW">Â¶</a>MinGW</h2><p><a href="https://www.jianshu.com/p/ee1ccb0a3062">https://www.jianshu.com/p/ee1ccb0a3062</a> ç…§è¿™ä¸ªåšå³å¯gcc/g++ 8.1.0</p><h2 id="Clangä»¥åŠClangd"><a class="header-anchor" href="#Clangä»¥åŠClangd">Â¶</a>Clangä»¥åŠClangd</h2><p><a href="https://www.cnblogs.com/FrankOu/p/14215850.html">https://www.cnblogs.com/FrankOu/p/14215850.html</a></p><h2 id="sublime-text"><a class="header-anchor" href="#sublime-text">Â¶</a>sublime text</h2><p>sublimeçš„é…è‰²æˆ‘æ¯”è¾ƒå–œæ¬¢ï¼Œè€Œä¸”å¾ˆè½»é‡ï¼Œç”¨äºå†™ä¸€äº›ç®—æ³•ç«èµ›é¢˜å’Œä¸€äº›ç®€å•çš„pythonã€shellè„šæœ¬å®˜ç½‘æœ‰æœ€æ–°çš„4ç‰ˆæœ¬fontsizeæ”¹æˆ10.5å·¦å³æ¯”è¾ƒèˆ’æœctrl+x åˆ é™¤å½“å‰è¡Œ<a href="https://blog.csdn.net/qq_39599067/article/details/81270330">https://blog.csdn.net/qq_39599067/article/details/81270330</a> ä»£ç ç‰‡æ®µé…ç½®<a href="https://jingyan.baidu.com/article/cb5d6105ae0c44005c2fe0f1.html">https://jingyan.baidu.com/article/cb5d6105ae0c44005c2fe0f1.html</a> æ‹¬å·é«˜äº®<a href="https://blog.csdn.net/qq_43816826/article/details/108406114">https://blog.csdn.net/qq_43816826/article/details/108406114</a> repl pythonå¿«æ·é”®é…ç½®<a href="https://segmentfault.com/a/1190000004463984">https://segmentfault.com/a/1190000004463984</a> AdvancedNewFilec++17 build systemä¼¼ä¹åœ¨c++17ä¸­bits/stdc++.hæœ‰ç‚¹é—®é¢˜ï¼Ÿï¼ˆå½“ç„¶linuxä¸‹æ²¡é—®é¢˜ï¼‰ï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨c++14å§ï¼Œæ‡’å¾—æŠ˜è…¾äº†</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;g++&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-Wall&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-std=c++17&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file_path&#125;/$&#123;file_base_name&#125;&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;file_regex&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;working_dir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;file_path&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;source.c, source.c++&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span><span class="string">&quot;cp936&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;variants&quot;</span><span class="punctuation">:</span></span><br><span class="line">  <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RunInCommand&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;cmd&quot;</span><span class="punctuation">,</span> <span class="string">&quot;/c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;g++&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-Wall&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-std=c++17&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file_path&#125;/$&#123;file_base_name&#125;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&amp;&amp;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;start&quot;</span><span class="punctuation">,</span> <span class="string">&quot;cmd&quot;</span><span class="punctuation">,</span> <span class="string">&quot;/c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file_path&#125;/$&#123;file_base_name&#125; &amp; echo.&amp;pause&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>file iconæ’ä»¶ï¼šç¾åŒ–ä½œç”¨trailingspaceï¼šæ£€æµ‹è¡Œæœ«å¤šä½™ç©ºæ ¼sublimelinterï¼šé™æ€æ£€æŸ¥sublimelinter-clangclang-formatï¼šæ ¼å¼åŒ–lspï¼šlanguage server port</p><h2 id="typora"><a class="header-anchor" href="#typora">Â¶</a>typora</h2><p>å†™markdownç›´æ¥ä¸‹è½½å³å¯</p><h2 id="Adobe-Acrobat"><a class="header-anchor" href="#Adobe-Acrobat">Â¶</a>Adobe Acrobat</h2><p>pdf reader</p><h2 id="Velocity"><a class="header-anchor" href="#Velocity">Â¶</a>Velocity</h2><p>ç¦»çº¿æ–‡æ¡£</p><h2 id="DeepL"><a class="header-anchor" href="#DeepL">Â¶</a>DeepL</h2><p>ç¿»è¯‘ctrl+q</p><h2 id="CopyQ"><a class="header-anchor" href="#CopyQ">Â¶</a>CopyQ</h2><p>å‰ªè´´æ¿ctrl+shift+qï¼šå»é™¤æ¢è¡Œç¬¦</p><h2 id="vscode"><a class="header-anchor" href="#vscode">Â¶</a>vscode</h2>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021ä¸­å›½å¤§å­¦ç”Ÿç¨‹åºè®¾è®¡ç«èµ›ï¼ˆCCPCï¼‰- ç½‘ç»œé€‰æ‹”èµ›</title>
      <link href="/2021/08/28/2021-zhong-guo-da-xue-sheng-cheng-xu-she-ji-jing-sai-ccpc-wang-luo-xuan-ba-sai/"/>
      <url>/2021/08/28/2021-zhong-guo-da-xue-sheng-cheng-xu-she-ji-jing-sai-ccpc-wang-luo-xuan-ba-sai/</url>
      
        <content type="html"><![CDATA[<p>hduçš„æœåŠ¡å™¨æœ‰ç‚¹é—®é¢˜ï¼Œä½“éªŒæ¯”è¾ƒå·®æ„Ÿè§‰æ‰“çš„ä¸­è§„ä¸­çŸ©ï¼Œä¸è¿‡èƒ½æ’åˆ°å‰50è¿˜æ˜¯æ¯”è¾ƒæƒŠè®¶ï¼Œä¼°è®¡å—é¢˜ç›®é£æ ¼ä»¥åŠæœåŠ¡å™¨é—®é¢˜çš„å½±å“ã€‚ï¼ˆçœ‹æ¥å¤§éƒ¨åˆ†é˜Ÿä¼å—ç½‘ç»œçš„å½±å“æŒºå¤§çš„ï¼Œè€Œä¸”å¬è¯´æœ‰å¤šé“ç–‘ä¼¼åŸé¢˜ï¼Œè¦é‡èµ›äº†ï¼Œä¸è¿‡ä¹Ÿæ— æ‰€è°“ï¼‰</p><h2 id="1001"><a class="header-anchor" href="#1001">Â¶</a>1001</h2><p>ç®€å•çš„åˆ†ç±»è®¨è®ºï¼Œè§£ä¸ç­‰å¼å³å¯</p><h2 id="1002"><a class="header-anchor" href="#1002">Â¶</a>1002</h2><p>é˜Ÿå‹è¿‡çš„ï¼Œæš´åŠ›</p><h2 id="1006"><a class="header-anchor" href="#1006">Â¶</a>1006</h2><p>æ„é€ é¢˜ï¼Œå‘ç°$x^2+(x+3)^2-(x+1)^2-(x+2)^2=4$åï¼Œæ ¹æ®æ¨¡4çš„å€¼åˆ†åˆ«æ„é€ å³å¯</p><h2 id="1007"><a class="header-anchor" href="#1007">Â¶</a>1007</h2><p>æšä¸¾$g(x)$ï¼Œè½¬æˆäºŒæ¬¡å‡½æ•°ï¼Œå‰©ä¸‹çš„å°±æ˜¯äºŒåˆ†åŠ å–æ•´çš„çç¢é—®é¢˜</p><h2 id="1008"><a class="header-anchor" href="#1008">Â¶</a>1008</h2><p>æˆ‘å…ˆæƒ³äº†ä¸€ä¸ªçœ‹ä¸Šå»å¾ˆå¯è¡Œçš„è§£æ³•ï¼Œä¸è¿‡æœ€åç»Ÿè®¡ç­”æ¡ˆå¤æ‚åº¦ä¼šç‚¸æœ€åé˜Ÿå‹ç»™å‡ºæ­£è§£ï¼Œè€ƒè™‘æ±‚è§£$v(l,r)\leqx$çš„åŒºé—´ä¸ªæ•°ï¼Œä»å¤§åˆ°å°æšä¸¾gcdï¼Œç„¶åæŠ å‡ºæ‰€æœ‰gcdçš„å€æ•°ï¼Œè€ƒè™‘ç›¸é‚»ä¸¤ä¸ªæ•°å½¢æˆçš„åŒºé—´$[L,R]$ï¼Œåˆ™ä»¥$[1,L]$ä¸­çš„ç‚¹ä¸ºå·¦ç«¯ç‚¹æ—¶ï¼Œå³ç«¯ç‚¹å¿…é¡»æ»¡è¶³å°äºRï¼Œæ‰æœ‰å¯èƒ½ä½¿å¾—$v(l,r)\lex$ï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªå‰ç¼€å–minï¼Œæ•´ä½“æ±‚sumçš„segment beatsäº†ã€‚ï¼ˆäº‹å®ä¸Šç”±äºç»´æŠ¤çš„åºåˆ—æ˜¯å•è°ƒçš„ï¼Œä¹Ÿå¯ä»¥äºŒåˆ†+åŒºé—´è¦†ç›–æ¥åšï¼Œ<s>ç„¶è€Œæˆ‘å†™Täº†</s> ï¼Œå¯èƒ½æ˜¯æˆ‘å†™æŒ‚äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯å¡äº†3logï¼Œè€Œsgbtæ›´è¶‹è¿‘äºå•ä¸ªlogï¼Œçœ‹äº†é¢˜è§£ï¼Œç›´æ¥åœ¨çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å°±è¡Œäº†ï¼Œæˆ‘åœ¨å¤–é¢å¥—ä¸ªäºŒåˆ†æ˜¯è¯¥tï¼‰</p><h2 id="1009"><a class="header-anchor" href="#1009">Â¶</a>1009</h2><p>å‰ç¼€å’Œ+map ç±»ä¼¼äºæ±‚å¤šå°‘ä¸ªå­åŒºé—´çš„å’Œä¸º0ï¼Œåªä¸è¿‡æ‰©å±•æˆäºŒç»´çš„äº†</p><h2 id="1011"><a class="header-anchor" href="#1011">Â¶</a>1011</h2><p>é˜Ÿå‹è¿‡çš„ï¼Œæ²¡å‚ä¸</p><h2 id="1012"><a class="header-anchor" href="#1012">Â¶</a>1012</h2><p>è€ƒè™‘dpæ¥æ±‚è§£ï¼Œå½“æ±‚è§£å®Œ$dp_x$â€‹ï¼Œæšä¸¾æ‰€æœ‰$p \midx$ï¼Œè®©$[dp_{x+1},dp_{x+p-1}]$ä¸$dp_x+1$å–minå³å¯ã€‚å®¹æ˜“å‘ç°åªè¦å¯¹æ¯ä¸ªxï¼Œè€ƒè™‘åœ¨è´¨æ•°é›†ä¸­<strong>æœ€å¤§</strong>çš„xçš„å› å­å³å¯ï¼Œåˆå®¹æ˜“å‘ç°è¿™ä¸ª$dp$æ˜¯å•å¢çš„ï¼Œæ‰€ä»¥ä¸æ–­ç»´æŠ¤å½“å‰è¦†ç›–åˆ°çš„æœ€å¤§å³ç«¯ç‚¹å³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨debian8ä¸Šä½¿ç”¨æ”¯æŒc++17çš„g++ç‰ˆæœ¬</title>
      <link href="/2021/06/22/zai-debian8-shang-shi-yong-zhi-chi-c17-de-gban-ben/"/>
      <url>/2021/06/22/zai-debian8-shang-shi-yong-zhi-chi-c17-de-gban-ben/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘è°ƒè¯•ç¼–è¯‘å™¨é‡åˆ°ä¸€ä¸ªæ¯”è¾ƒçŸ›ç›¾çš„äº‹æƒ…ã€‚cppæ–‡ä»¶é€šè¿‡æˆ‘çš„compilerè½¬æˆarmæ±‡ç¼–ï¼Œç„¶åé€šè¿‡qemu-armçš„debianè™šæ‹Ÿæœºä¸Šçš„g++å°†armæ–‡ä»¶æ±‡ç¼–ã€é“¾æ¥åè½¬æˆå¯æ‰§è¡Œæ–‡ä»¶å°±å¯ä»¥è·‘ç»“æœäº†ã€‚ç„¶è€Œæˆ‘çš„compilerç”¨äº†ä¸€äº›c++17çš„ç‰¹æ€§ï¼ˆoptionalã€stringviewï¼‰ï¼Œdebian8æœ€æ–°åªæœ‰g++4.9.2ï¼Œæ²¡æ³•æ”¯æŒc++17ã€‚æˆ‘åªèƒ½åœ¨æœ¬åœ°è½¬æˆarmæ±‡ç¼–å†ä¼ ä¸Šå»æµ‹è¯•ï¼Œæ•ˆç‡å¤ªä½ã€‚æˆ‘æƒ³æŠŠä¸¤ä¸ªè¿‡ç¨‹éƒ½æ”¾åˆ°debianä¸Šï¼Œç„¶åå†™ä¸ªè„šæœ¬ä¸€é”®æµ‹è¯•ã€‚äºæ˜¯æœ‰ä¸¤ç§é€‰æ‹©</p><ul><li>æŠŠä»£ç çš„c++17ç›¸å…³åˆ äº†ğŸ¤¡</li><li>è®©è™šæ‹Ÿæœºæ”¯æŒ-std=c++17</li></ul><p>æ˜¾ç„¶è¿˜æ˜¯è¦åŠªåŠ›è¯•ä¸€ä¸‹åè€…ã€‚çœ‹äº†ä¸€ä¸‹debian9æœ‰g++6ï¼Œdebian10æœ‰g++8ã€‚æˆ‘ä¸€å¼€å§‹ä»¥ä¸ºè¦æŠŠæ•´ä¸ªç³»ç»Ÿéƒ½å‡çº§ï¼Œç»“æœå¤§åŠå¤œè·‘äº†2ä¸ªå°æ—¶è¿˜æ²¡å®Œï¼Œç­‰ä¸äº†å°±ctrl+cäº†ï¼Œç„¶åå‘ç°è™šæ‹Ÿæœºåäº†ï¼Œggã€‚ç¬¬äºŒå¤©é‡ä¸‹äº†è™šæ‹Ÿæœºï¼Œé‡æ–°æ¥è¿‡ã€‚å°è¯•äº†ä¸€ä¸‹ç›´æ¥è£…debian10çš„g++åˆ°debian8ä¸Šã€‚å…·ä½“åšæ³•å°±æ˜¯åœ¨é•œåƒæºé‡ŒåŠ äº†busterï¼Œï¼ˆ8çš„åˆ«åæ˜¯jessieï¼Œ9çš„åˆ«åæ˜¯stretchï¼Œ10çš„åˆ«åæ˜¯busterï¼‰ã€‚ç„¶åapt-get updateï¼Œapt-get install g++ï¼Œå®ƒä¼šè‡ªåŠ¨å¸®ä½ æŠŠå„ç§ä¾èµ–éƒ½å®‰è£…å‡çº§ã€‚<a data-fancybox="gallery" data-src="/post-images/1624337438397.png" data-caption=""><img src="/post-images/1624337438397.png" alt=""></a>ç„¶åå°±èƒ½æ„‰å¿«çš„è·‘äº†<a data-fancybox="gallery" data-src="/post-images/1624337477434.png" data-caption=""><img src="/post-images/1624337477434.png" alt=""></a><a data-fancybox="gallery" data-src="/post-images/1624337482828.png" data-caption=""><img src="/post-images/1624337482828.png" alt=""></a>æœ€åè®°å¾—apt-get autoremoveæ¸…ç†ä¸‹æ—§ç‰ˆæœ¬</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wsl</title>
      <link href="/2021/04/09/wsl/"/>
      <url>/2021/04/09/wsl/</url>
      
        <content type="html"><![CDATA[<p>WSLå’ŒVMwareä¹‹é—´åˆ‡æ¢éœ€è¦åœ¨PowerShellä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¹¶é‡å¯ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p><p>ä½†å…¶å®Wslå’ŒVMwareæ˜¯å¯ä»¥å…±å­˜çš„ï¼Œåªæ˜¯VMwareä¼šæ…¢ä¸€äº›ï¼ˆæˆ‘å®é™…ä½¿ç”¨æ²¡æœ‰æ˜æ˜¾æ„Ÿè§‰ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /set hypervisorlaunchtype off/auto</span><br></pre></td></tr></table></figure><p>WSLä½äº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\è¿™é‡Œæ˜¯ä½ è‡ªå·±çš„userçš„åå­—\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ä»¥å°†WSLä»Cç›˜ç§»åŠ¨åˆ°Dç›˜<br><a href="https://blog.csdn.net/w851685279/article/details/108904106?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-1&amp;spm=1001.2101.3001.4242">https://blog.csdn.net/w851685279/article/details/108904106?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-1&amp;spm=1001.2101.3001.4242</a></p><p>WSLä¼šä½¿ç”¨Windowsä¸­ä»¥vhdxä¸ºåç¼€çš„è™šæ‹Ÿç£ç›˜æ–‡ä»¶ï¼Œå®ƒä¼šè‡ªåŠ¨æ‰©å®¹ï¼Œä½†æ˜¯ä¸ä¼šç¼©å®¹ã€‚<br>æ‰€ä»¥åœ¨WSLä¸­åˆ é™¤æ–‡ä»¶ï¼ŒWindowsä¸Šçš„ç£ç›˜å¤§å°ä¸ä¼šå˜ï¼Œæ­¤æ—¶åªèƒ½è¿›è¡Œæ‰‹åŠ¨å‹ç¼©ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wsl --shutdown</span><br><span class="line">diskpart</span><br><span class="line"><span class="keyword">select</span> vdisk file=<span class="string">&quot;D:\wsl-ubuntu22.04\ext4.vhdx&quot;</span></span><br><span class="line">compact vdisk</span><br><span class="line">detach vdisk</span><br></pre></td></tr></table></figure><p>WSLçš„æ—¶é—´ç»å¸¸ä¼šä¸å‡†ï¼Œå¯ä»¥ç”¨<code>sudo ntpdate pool.ntp.org</code>æ ¡å‡†ã€‚</p><p>Windowsæ›´æ–°åˆ°23H2åå¯åŠ¨WSLä¼šå‡ºç°â€wsl: æ£€æµ‹åˆ° localhost ä»£ç†é…ç½®ï¼Œä½†æœªé•œåƒåˆ° WSL ã€‚NAT æ¨¡å¼ä¸‹çš„ WSL ä¸æ”¯æŒ localhost ä»£ç†ã€‚â€çš„æŠ¥é”™ï¼Œ<br>è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><p>åœ¨C:\Users\xxx.wslconfigä¸­æ·»åŠ ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[experimental]</span><br><span class="line">autoMemoryReclaim=gradual  # gradual  | dropcache | disabled</span><br><span class="line">networkingMode=mirrored</span><br><span class="line">dnsTunneling=true</span><br><span class="line">firewall=true</span><br><span class="line">autoProxy=true</span><br></pre></td></tr></table></figure><p>ç„¶å<code>wsl --shutdown</code>é‡å¯å³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¦ç‘Ÿå¤«ç¯</title>
      <link href="/2021/03/28/yue-se-fu-huan/"/>
      <url>/2021/03/28/yue-se-fu-huan/</url>
      
        <content type="html"><![CDATA[<p>nä¸ªäººï¼ˆç¼–å·ä»0å¼€å§‹ï¼‰ï¼Œä»1å¼€å§‹ä¾æ¬¡æŠ¥æ•°ï¼ŒæŠ¥åˆ°kçš„é‚£ä¸ªäººé€€å‡ºï¼Œå¹¶ç»§ç»­å¾ªç¯æŠ¥æ•°ï¼Œé—®æœ€åå‰©ä¸‹çš„äººçš„ç¼–å·è¿™ä¸ªé—®é¢˜è¿˜æ˜¯è¦ä»é€’å½’çš„è§’åº¦å»è€ƒè™‘è®¾$f_{n-1}$â€‹è¡¨ç¤ºnä¸ªäººæ—¶æœ€åå‰©ä¸‹çš„é‚£ä¸ªäººé‚£ä¹ˆå¯¹äºnä¸ªäººçš„æƒ…å†µï¼Œç¬¬ä¸€ä¸ªå‡ºå±€çš„äººæ˜¯k-1ï¼Œä¹‹åå°±ç›¸å½“äºæ˜¯ä»kå¼€å§‹çš„n-1ä¸ªäººçš„çº¦ç‘Ÿå¤«ç¯é—®é¢˜æ‰€ä»¥å¾ˆå®¹æ˜“å¾—åˆ°é€’æ¨å¼$f_n = (f_{n-1} + k)%n$åŒæ ·çš„å¦‚æœè¦æ±‚ç¬¬mä¸ªå‡ºå±€çš„äººï¼Œä¹Ÿå¯ä»¥ç”¨ä¸Šè¿°å…¬å¼$f_{n,m}=(f_{n-1,m-1}+k)%n$å¯¹äº$k \ll n$çš„æƒ…å†µï¼Œè€ƒè™‘$f_{i+x-1}=(f_{i-1}+x*k)%(i+x-1)$ï¼Œå½“$f_{i-1}+x*k\leq i+x-1$æ—¶ä¸ä¼šå–æ¨¡ï¼Œæ‰€ä»¥å¿«é€Ÿé€’æ¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">J</span><span class="params">(ll n, ll k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(k==<span class="number">1</span>) <span class="keyword">return</span> n;</span><br><span class="line">  ll ans = <span class="number">0</span>, i = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=n)</span><br><span class="line">  &#123;</span><br><span class="line">    ll cnt = (i-ans<span class="number">-2</span>)/(k<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span>(!cnt)</span><br><span class="line">    &#123;</span><br><span class="line">      ans = (ans + k)%i;</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(i+cnt&gt;n)</span><br><span class="line">      &#123;</span><br><span class="line">        ans = (ans + k*(n-i+<span class="number">1</span>))%n;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        i += cnt;</span><br><span class="line">        ans = (ans + k*cnt)%i;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–å¯¹äºk=2çš„ç‰¹æ®Šæƒ…å†µï¼Œå¯ä»¥è€ƒè™‘å½“nä¸º2çš„å¹‚æ¬¡çš„æ—¶å€™ç­”æ¡ˆå°±æ˜¯1ï¼Œæ‰€ä»¥å½“nä¸º$2^x+y$çš„å½¢å¼æ—¶ï¼Œç­”æ¡ˆä¸º$2*y+1$</p><p>æ±‚ç¬¬xä¸ªäººæ˜¯ç¬¬å‡ ä¸ªæ­»çš„ï¼ˆ0ä¸‹æ ‡ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll n, ll k, ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(n)</span><br><span class="line">  &#123;</span><br><span class="line">    x = (x+n)%n;</span><br><span class="line">    <span class="keyword">if</span>(k&gt;n) x += (k-x<span class="number">-1</span>+n<span class="number">-1</span>)/n*n;</span><br><span class="line">    <span class="keyword">if</span>((x+<span class="number">1</span>)%k==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ans += (x+<span class="number">1</span>)/k;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(k&gt;n)</span><br><span class="line">      &#123;</span><br><span class="line">        ans += x/k;</span><br><span class="line">        ll tmp = x;</span><br><span class="line">        x = x-(x/n+<span class="number">1</span>)*(x/k)+(x+n)/n*n-k;</span><br><span class="line">        n -= tmp/k;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        ans += n/k;</span><br><span class="line">        x = x-x/k;</span><br><span class="line">        x += n-n/k*k;</span><br><span class="line">        n -= n/k;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1-k bfs</title>
      <link href="/2021/03/24/1-k-bfs/"/>
      <url>/2021/03/24/1-k-bfs/</url>
      
        <content type="html"><![CDATA[<p>è€ƒè™‘ä¸€ä¸ªå•æºæœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œä½†æ˜¯å›¾çš„è¾¹æƒèŒƒå›´æ˜¯1-kï¼Œkä¸å¤§ï¼Œé‚£å°±å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æœ¬è´¨ä¸Šåœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­åŒæ—¶æœ€å¤šåªæœ‰k+1ç§ä¸åŒçš„disçš„å–å€¼ï¼Œå› æ­¤åªéœ€è¦ç”¨k+1ä¸ªé˜Ÿåˆ—æ¥ç»´æŠ¤å³å¯ï¼Œå½“å‰é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œå°±å¾ªç¯ç§»ä½æ‰¾åˆ°ä¸‹ä¸€ä¸ªéç©ºçš„é˜Ÿåˆ—å³å¯å¤æ‚åº¦ä¸º$O(nk+m)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">queue&lt;<span class="type">int</span>&gt; q[K+<span class="number">1</span>];</span><br><span class="line">q[<span class="number">0</span>].<span class="built_in">push</span>(s);</span><br><span class="line">d[s] = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> idx = <span class="number">0</span>, inq = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(inq&gt;<span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">while</span>(q[idx].<span class="built_in">empty</span>()) idx = (idx+<span class="number">1</span>)%(k+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> u = q[idx].<span class="built_in">front</span>(); q[dx].<span class="built_in">pop</span>();</span><br><span class="line">  inq--;</span><br><span class="line">  <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">  vis[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u]) &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(d[v]&gt;d[u]+w) &#123;</span><br><span class="line">      d[v] = d[u] + w;</span><br><span class="line">      q[d[v]%(k+<span class="number">1</span>)].<span class="built_in">push</span>(v);</span><br><span class="line">      ++inq;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‹Ÿé˜µ</title>
      <link href="/2021/03/22/ni-zhen/"/>
      <url>/2021/03/22/ni-zhen/</url>
      
        <content type="html"><![CDATA[<p>$M(S,I)$è¡¨ç¤ºä¸€ä¸ªæ‹Ÿé˜µï¼Œå…¶ä¸­Iæ˜¯Sçš„æŸäº›å­é›†çš„é›†åˆï¼Œæ»¡è¶³è¿™äº›å­é›†åœ¨æŸç§å®šä¹‰ä¸‹æ˜¯ç‹¬ç«‹çš„ä¸€ä¸ªæ‹Ÿé˜µMéœ€è¦æ»¡è¶³å¦‚ä¸‹ä¸‰ä¸ªæ€§è´¨ï¼š</p><ul><li>ç©ºé›†å±äºI</li><li>è‹¥é›†åˆAå±äºIï¼Œåˆ™Açš„ä»»æ„ä¸€ä¸ªå­é›†ä¹Ÿå±äºIï¼ˆé—ä¼ æ€§ï¼‰</li><li>è‹¥é›†åˆAå±äºIï¼Œä»»æ„ä¸€ä¸ªsizeå¤§äºAçš„å±äºIçš„é›†åˆBä¸­æ€»èƒ½æ‰¾åˆ°å…ƒç´ åŠ å…¥Aï¼Œä½¿å…¶ä»åœ¨Iä¸­ï¼ˆäº¤æ¢æ€§ï¼‰</li></ul><p>æ»¡è¶³ä»¥ä¸Šå®šä¹‰çš„æœ€å¥½çš„è§£é‡Šä¾‹å­å°±æ˜¯çº¿æ€§æ— å…³å‘é‡ç»„ã€‚åŸºï¼šæœ€å¤§ç‹¬ç«‹é›†ï¼Œå³Iä¸­sizeæœ€å¤§çš„é‚£ä¸ªå­é›†ç¯ï¼šæœ€å°çš„éç‹¬ç«‹é›†ï¼Œå»æ‰ä»»æ„å…ƒç´ åå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹é›†</p><p>å…¸å‹çš„æ‹Ÿé˜µï¼š</p><ul><li>uniform matroidï¼šsize$\leq k$çš„å­é›†</li><li>linear matroidï¼šçº¿æ€§æ— å…³çš„å­é›†</li><li>colorful matroidï¼šæ¯ä¸ªå…ƒç´ æœ‰ä¸€ç§é¢œè‰²ï¼Œå¦‚æœä¸€ä¸ªé›†åˆä¸­æ‰€æœ‰å…ƒç´ é¢œè‰²å„ä¸ç›¸åŒå°±ç‹¬ç«‹</li><li>graphic matroidï¼šæ¯ä¸ªå…ƒç´ æ˜¯ä¸€æ¡è¾¹ï¼Œä¸€ä¸ªé›†åˆä¸­çš„è¾¹æ²¡æœ‰ç¯å°±ç‹¬ç«‹</li><li>ä¸Šä¸€ä¸ªæ‹Ÿé˜µçš„å¯¹å¶æ‹Ÿé˜µï¼šå¯¹äºä¸€ä¸ªé›†åˆï¼Œä¿ç•™åœ¨Sä¸­ä¸”ä¸åœ¨è¯¥é›†åˆä¸­çš„æ‰€æœ‰è¾¹åï¼Œæ•´ä¸ªå›¾è¿é€šåˆ™ç‹¬ç«‹ã€‚æ³¨ï¼šå¿…é¡»æ˜¯åˆ è¾¹ï¼Œå¦‚æœæ˜¯è€ƒè™‘é›†åˆä¸­çš„è¾¹è¿é€šçš„è¯ï¼Œæ˜¾ç„¶ä¸æ»¡è¶³é—ä¼ æ€§ã€‚</li></ul><p>æ‹Ÿé˜µäº¤è€ƒè™‘ç°åœ¨æœ‰ä¸¤ä¸ªæ‹Ÿé˜µï¼ˆå…¶ä¸­çš„ä¸€ä¸ªç‹¬ç«‹é›†æœ¬è´¨ä¸Šå°±ä»£è¡¨ç€æ»¡è¶³äº†æŸç§çº¦æŸçš„é›†åˆï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ±‚åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ‹Ÿé˜µçš„çº¦æŸæ¡ä»¶ä¸‹çš„æœ€å¤§ç‹¬ç«‹é›†ï¼Œè¿™æ—¶å€™å°±è¦ç”¨åˆ°æ‹Ÿé˜µäº¤äº†ã€‚è¯¥ç®—æ³•çš„æµç¨‹æ˜¯ä¸æ–­ç»´æŠ¤å½“å‰çš„å…±åŒç‹¬ç«‹é›†Iï¼Œç„¶åå°è¯•åŠ å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ sï¼šå®šä¹‰ä¸€ç§äº¤æ¢å›¾ï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªå…ƒç´ xï¼Œyï¼Œè‹¥æ»¡è¶³$x\in I, y \notinI,I-\{x\}+\{y\}\in{I_1}$â€‹ï¼Œå°±ä»xå‘yè¿ä¸€æ¡æœ‰å‘è¾¹ï¼›è‹¥æ»¡è¶³$x\in I, y\notin I,I-\{x\}+\{y\}\in{I_2}$â€‹ï¼Œå°±ä»yå‘xè¿ä¸€æ¡æœ‰å‘è¾¹ã€‚ç®€å•è¯´æ¥å°±æ˜¯å¦‚æœæŠŠIä¸­çš„æŸä¸ªå…ƒç´ xæ›¿æ¢æˆæ²¡æœ‰é€‰çš„æŸä¸ªå…ƒç´ yåï¼Œå¦‚æœè¯¥ç‹¬ç«‹é›†ç¬¦åˆ$I_1$â€‹çš„å®šä¹‰ï¼Œå°±åŠ ä¸€æ¡$x\rightarrowy$çš„è¾¹ï¼Œå¦‚æœç¬¦åˆ$I_2$â€‹çš„å®šä¹‰ï¼Œå°±åŠ ä¸€æ¡$x \leftarrow y$çš„è¾¹ã€‚å¯¹äºæ‰€æœ‰ä¸åœ¨Iä¸­çš„å…ƒç´ xï¼Œè‹¥$I+\{x\}\in I_1$â€‹ï¼Œåˆ™æºç‚¹Så‘å…¶è¿è¾¹å¯¹äºæ‰€æœ‰ä¸åœ¨Iä¸­çš„å…ƒç´ xï¼Œè‹¥$I+\{x\}\in I_2$â€‹ï¼Œåˆ™å…¶å‘æ±‡ç‚¹Tè¿è¾¹ç„¶åä»Så‘Tè·‘ä¸€é<strong>æœ€çŸ­è·¯</strong>ï¼Œå¦‚æœæœ‰è¿™æ ·çš„è·¯å¾„å°±æŠŠè·¯å¾„ä¸Šçš„æ‰€æœ‰å…ƒç´ çš„çŠ¶æ€å–åï¼ˆå¯¹ç§°å·®ï¼‰ä¸Šè¿°è¿‡ç¨‹ç§°ä¸ºä¸€æ¬¡å¢å¹¿ä¸æ–­è¿›è¡Œå¢å¹¿æ“ä½œå°±å¯ä»¥å¾—åˆ°æœ€å¤§ç‹¬ç«‹é›†äº†å¤æ‚åº¦ä¸º$O(r^2n(C_1+C_2))$ï¼Œå…¶ä¸­rä¸ºç§©ï¼Œ$C_1$â€‹å’Œ$C_2$â€‹åˆ†åˆ«è¡¨ç¤ºM1å’ŒM2æ£€æŸ¥å½“å‰é›†åˆæ˜¯å¦ä¸ºç‹¬ç«‹é›†çš„è°ƒç”¨æ¬¡æ•°å†è€ƒè™‘å¦‚æœæ¯ä¸ªå…ƒç´ æ˜¯å¸¦æƒçš„è¯ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚æœä¸€ä¸ªå…ƒç´ å½“å‰åœ¨Iï¼Œå°±æŠŠå®ƒçš„æƒå€¼å®šä¸º$-w$ï¼Œå¦åˆ™å®šä¸º$w$ï¼Œç„¶åè·‘æœ€é•¿è·¯å°±å¯ä»¥å¾—åˆ°æœ€å¤§æƒç‹¬ç«‹é›†äº†ã€‚ä¸Šè¿°ç®—æ³•çš„ä¸€ä¸ªç“¶é¢ˆå…¶å®æ˜¯åœ¨æ£€æŸ¥æ˜¯å¦ä¸ºç‹¬ç«‹é›†ä¸Šï¼Œè¿™ç‚¹ä¸€å®šè¦ä»”ç»†å®ç°ã€‚è¦æ”¯æŒåŠ å…¥ä¸€ä¸ªå…ƒç´ åˆ¤æ–­æ˜¯å¦è¿˜æ˜¯ç‹¬ç«‹é›†ï¼Œåˆ é™¤ä¸€ä¸ªå…ƒç´ å¹¶åŠ å…¥ä¸€ä¸ªå…ƒç´ åˆ¤æ–­æ˜¯å¦æ˜¯ç‹¬ç«‹é›†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">aug</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> S = n, T = n + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="keyword">if</span>(in[i])</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;n; j++) <span class="keyword">if</span>(!in[j])</span><br><span class="line">    &#123;</span><br><span class="line">      in[i] = <span class="number">0</span>, in[j] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span>(m1.<span class="built_in">check</span>(in)) G[i].<span class="built_in">push_back</span>(j);</span><br><span class="line">      <span class="keyword">if</span>(m2.<span class="built_in">check</span>(in)) G[j].<span class="built_in">push_back</span>(i);</span><br><span class="line">      in[i] = <span class="number">1</span>, in[j] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="keyword">if</span>(!in[i])</span><br><span class="line">  &#123;</span><br><span class="line">    in[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(m1.<span class="built_in">check</span>(in)) G[S].<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">if</span>(m2.<span class="built_in">check</span>(in)) G[i].<span class="built_in">push_back</span>(T);</span><br><span class="line">    in[i] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dis</span><span class="params">(n+<span class="number">2</span>, -inf)</span>, <span class="title">pre</span><span class="params">(n+<span class="number">2</span>)</span>, <span class="title">inq</span><span class="params">(n+<span class="number">2</span>)</span></span>;</span><br><span class="line">  queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(S), dis[S] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    inq[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(u&lt;n) cost = in[u] ? -w[u] : w[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(dis[v]&lt;dis[u]+cost)</span><br><span class="line">      &#123;</span><br><span class="line">        dis[v] = dis[u] + cost;</span><br><span class="line">        pre[v] = u;</span><br><span class="line">        <span class="keyword">if</span>(!inq[v]) q.<span class="built_in">push</span>(v), inq[v] = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(pre[T]==<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> x=pre[T]; x!=S; x=pre[x]) in[x] ^= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nä¸ªæ•°ï¼Œæ¯ä¸ªæ•°å¯ä»¥ä»»æ„+1,-1</title>
      <link href="/2021/03/18/n-ge-shu-mei-ge-shu-ke-yi-ren-yi-1-1/"/>
      <url>/2021/03/18/n-ge-shu-mei-ge-shu-ke-yi-ren-yi-1-1/</url>
      
        <content type="html"><![CDATA[<h2 id="å˜æˆéé™åºåˆ—çš„æœ€å°ä»£ä»·"><a class="header-anchor" href="#å˜æˆéé™åºåˆ—çš„æœ€å°ä»£ä»·">Â¶</a>å˜æˆéé™åºåˆ—çš„æœ€å°ä»£ä»·</h2><p>æ˜¾ç„¶å¯¹äºç¬¬iä¸ªæ•°å¦‚æœè¦å˜å°±å˜æˆä¹‹å‰å·²ç»å‡ºç°è¿‡çš„æ•°ï¼Œæ‰€ä»¥ç¦»æ•£åŒ–ådpå³å¯ï¼Œ$O(n^2)$è€ƒè™‘å½“å‰æ•°yï¼Œä»¥åŠä¹‹å‰çš„æœ€å¤§å€¼xï¼Œå¦‚æœ$y\lt x$ï¼Œæ­¤æ—¶éœ€è¦å°†xå˜å°ï¼Œyå˜å¤§ï¼Œå®¹æ˜“å‘ç°ä¸ç®¡æ€ä¹ˆè°ƒæ•´ä»£ä»·éƒ½æ˜¯$y-x$ï¼Œè¿™è¾¹çš„ç­–ç•¥æ˜¯ç›´æ¥æŠŠyå˜æˆxã€‚è€ƒè™‘yä¹‹å‰çš„æœ€å¤§å€¼zï¼Œå¦‚æœ$z\leq x$ï¼Œæ˜¾ç„¶æ²¡æœ‰é—®é¢˜ï¼Œå¦åˆ™æˆ‘ä»¬ä¹Ÿä¸ç”¨å…³å¿ƒæ”¹æˆäº†ä»€ä¹ˆï¼Œå› ä¸ºç°åœ¨æœ€å¤§å€¼å˜æˆäº†zï¼Œé‚£å°±å°½å¯èƒ½å‡å°æ‰€ä»¥ç”¨ä¸€ä¸ªå¤§æ ¹å †ï¼Œå¦‚æœå½“å‰æ•°å°äºå †é¡¶ï¼Œå°±æŠŠå †é¡¶å˜æˆå½“å‰æ•°</p><h2 id="å˜æˆä¸¥æ ¼é™åºåˆ—"><a class="header-anchor" href="#å˜æˆä¸¥æ ¼é™åºåˆ—">Â¶</a>å˜æˆä¸¥æ ¼é™åºåˆ—</h2><p>å¯¹æ¯ä¸ªæ•°å‡å»ä¸‹æ ‡åï¼Œå¥—ç”¨ä¸Šé¢çš„åšæ³•ï¼Œä¸€ä¸ªå°trick</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒæ ˆæ¨¡æ‹Ÿé˜Ÿåˆ—</title>
      <link href="/2021/03/12/shuang-zhan-mo-ni-dui-lie/"/>
      <url>/2021/03/12/shuang-zhan-mo-ni-dui-lie/</url>
      
        <content type="html"><![CDATA[<h2 id="æ™®é€šé˜Ÿåˆ—"><a class="header-anchor" href="#æ™®é€šé˜Ÿåˆ—">Â¶</a>æ™®é€šé˜Ÿåˆ—</h2><p>æ”¯æŒpushå’Œpopæ“ä½œ</p><p>ä½¿ç”¨ä¸¤ä¸ªå¯¹é¡¶æ ˆstk1å’Œstk2ï¼Œpushæ“ä½œå°±ç›´æ¥åŠ åˆ°stk2çš„å°¾éƒ¨ï¼Œpopæ“ä½œå°±ä»stk1ä¸­å¼¹å‡ºï¼Œå¦‚æœstk1ä¸ºç©ºï¼Œå°±æŠŠstk2ä¸­çš„æ‰€æœ‰å…ƒç´ ä¾æ¬¡popåpushå…¥stk1</p><h2 id="åŒç«¯é˜Ÿåˆ—"><a class="header-anchor" href="#åŒç«¯é˜Ÿåˆ—">Â¶</a>åŒç«¯é˜Ÿåˆ—</h2><p>æ”¯æŒpush_frontã€push_backã€pop_frontã€pop_backæ“ä½œ</p><p>åŒæ ·ç”¨ä¸¤ä¸ªå¯¹é¡¶æ ˆæ¥å®ç°ï¼Œä½†æ˜¯å¦‚æœpop_frontå’Œpop_backæ“ä½œäº¤æ›¿è¿›è¡Œï¼Œä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•å°±ä¼šTLEã€‚è€ƒè™‘å‡æ‘Šçš„æ€æƒ³ï¼Œå¦‚æœåœ¨popæ—¶è¯¥æ ˆç©ºäº†ï¼Œå°±æŠŠå¦ä¸€ä¸ªæ ˆæ ˆåº•çš„$\fracn2$â€‹ä¸ªå…ƒç´ pushè¿‡å»</p><h2 id="æ‘Šè¿˜"><a class="header-anchor" href="#æ‘Šè¿˜">Â¶</a>æ‘Šè¿˜</h2><p>è€ƒè™‘ç°åœ¨æ€»å…±æœ‰nä¸ªç‰©å“ï¼Œç„¶ååœ¨mä¸ªä½ç½®å¯èƒ½ä¼šæ¶ˆè€—ç‰©å“ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™nä¸ªç‰©å“å‡åˆ†åˆ°è¿™mä¸ªä½ç½®ï¼Œå¦‚æœæŸä¸ªä½ç½®çš„ç‰©å“è¢«æ¶ˆè€—å®Œè¯´æ˜ç‰©å“æ•°è‡³å°‘å‡å°‘äº†$\frac1m$â€‹ï¼Œä¹‹åæˆ‘ä»¬ç»Ÿè®¡å½“å‰ç‰©å“çš„æ•°é‡åå†è¿›è¡Œå‡åˆ†ã€‚$T(n)=T(\frac{n(m-1)}{m})+O(n)$$T(n)=O(n)$</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº³ä»€å‡è¡¡</title>
      <link href="/2021/03/08/na-shi-jun-heng/"/>
      <url>/2021/03/08/na-shi-jun-heng/</url>
      
        <content type="html"><![CDATA[<p>ç”²ä¹™ä¸¤äººè¿›è¡Œä¸€ä¸ªåšå¼ˆï¼Œæœ‰Aã€Bä¸¤ç§é€‰æ‹©ï¼Œè€Œä»–ä»¬çš„ç»„åˆé€‰æ‹©ä¼šå¯¹åº”æŸç§æ”¶ç›Šï¼ˆåŒæ–¹å‡çŸ¥é“è¿™äº›ç»„åˆé€‰æ‹©çš„åæœï¼‰ï¼Œè€Œæ¯ä¸ªäººä¸çŸ¥é“å¯¹æ–¹å¦‚ä½•é€‰æ‹©ï¼Œæ‰€ä»¥æ¯ä¸ªäººä¼šé€‰æ‹©è‡ªå·±æœŸæœ›æ„ä¹‰ä¸‹æœ‰æœ€å¤§æ”¶ç›Šçš„é‚£ä¸ªï¼ˆå³å¯¹æ–¹é€‰Aæˆ–é€‰Bä¸¤ç§æƒ…å†µç»¼åˆä¹‹ä¸‹ï¼‰ã€‚ç°åœ¨ç«™åœ¨ç”²çš„è§’åº¦å»è€ƒè™‘ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li>ä¹™é€‰Açš„æ—¶å€™æˆ‘é€‰Aæ¯”Bæ›´ä¼˜ï¼Œä¹™é€‰Bçš„æ—¶å€™æˆ‘é€‰Aè¿˜æ˜¯æ¯”Bæ›´ä¼˜ï¼Œé‚£ä¹ˆæ¯«æ— ç–‘é—®æˆ‘ä¼šé€‰æ‹©A</li><li>åŒç†å¯èƒ½é€‰æ‹©Bå®Œå…¨ä¼˜äºé€‰æ‹©A</li></ul><p>åŒæ ·çš„ï¼Œç«™åœ¨ä¹™çš„è§’åº¦ä¹Ÿä¼šå‡ºç°è¿™ä¸¤ç§æƒ…å†µã€‚æ­¤æ—¶å¦å¤–ä¸€è€…èƒ½å¤Ÿæƒ³åˆ°å¯¹æ–¹çš„é€‰æ‹©ï¼Œè€Œè‡ªå·±åªèƒ½åœ¨è¿™ä¸ªå‰æä¸‹é€‰æ‹©æ›´ä¼˜çš„ä¸€ç§å½“ç„¶ä¹Ÿå¯èƒ½å‡ºç°ï¼ŒæŸç§æƒ…å†µä¸‹Aä¼˜ï¼ŒæŸç§æƒ…å†µä¸‹Bä¼˜ï¼Œè¿™æ—¶å€™å°±æ¶‰åŠåˆ°ä¸€ç§æ··åˆç­–ç•¥ï¼Œå‡è®¾æˆ‘æœ‰pçš„æ¦‚ç‡é€‰æ‹©Aï¼Œ(1-p)çš„æ¦‚ç‡é€‰æ‹©Bï¼Œä¸ºäº†åˆ©ç›Šæœ€å¤§åŒ–ï¼Œé‚£ä¹ˆæˆ‘è¦ä½¿å¾—å¯¹æ–¹åœ¨é€‰Aæˆ–é€‰Bçš„æ—¶å€™è‡ªå·±æœŸæœ›å¾—åˆ°çš„æ”¶ç›Šç›¸åŒï¼Œå³$pV(A,A) + (1-p)V(B, A) = pV(A, B) + (1-p)V(B,B)$</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨dpè§£å†³å„ä¸ªæœ¬è´¨ä¸åŒæ–¹æ¡ˆçš„å¹³æ–¹å’Œ</title>
      <link href="/2021/03/05/li-yong-dp-jie-jue-ge-ge-ben-zhi-bu-tong-fang-an-de-ping-fang-he/"/>
      <url>/2021/03/05/li-yong-dp-jie-jue-ge-ge-ben-zhi-bu-tong-fang-an-de-ping-fang-he/</url>
      
        <content type="html"><![CDATA[<p>å‰æï¼šå¦‚æœåªæ˜¯ç®€å•çš„æ±‚å’Œï¼Œå¯ä»¥åˆ©ç”¨dp[s]æ¥è§£å†³é‚£ä¹ˆå†åŠ ä¸€ç»´ï¼Œdp[s1][s2]ï¼Œç„¶ååœ¨è½¬ç§»çš„æ—¶å€™å½“ä¸”ä»…å½“ä¸‹ä¸€ä¸ªçŠ¶æ€ä¸¤è€…ç›¸åŒæ‰è½¬ç§»ï¼Œè¿™æ ·å¾—åˆ°çš„ç»“æœå°±æ˜¯å¹³æ–¹å’Œï¼Œå¯ä»¥å‘ç°è¿™å®é™…ä¸Šæ˜¯åœ¨å¯¹s1å’Œs2è¿™ä¸¤ç§çŠ¶æ€ä½œåŒ¹é…ï¼Œå¦‚æœæŸç§çŠ¶æ€æœ‰xä¸ªï¼Œé‚£ä¹ˆè¿™ä¸¤è€…ä¹‹é—´å°±ä¼šåŒ¹é…$x^2$æ¬¡åŒç†ï¼Œç»§ç»­åŠ ç»´ï¼Œå¯ä»¥å¾—åˆ°æ›´é«˜æ¬¡æ–¹å’Œçš„ç»“æœ</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒºé—´kæ¬¡è¦†ç›– è´¹ç”¨æµæ¨¡å‹</title>
      <link href="/2021/02/28/qu-jian-k-ci-fu-gai-fei-yong-liu-mo-xing/"/>
      <url>/2021/02/28/qu-jian-k-ci-fu-gai-fei-yong-liu-mo-xing/</url>
      
        <content type="html"><![CDATA[<p>å„å‡ºnä¸ªå¸¦æƒåŒºé—´ï¼Œè®©ä½ ä¿ç•™æœ€å¤šçš„åŒºé—´ï¼Œä½¿å¾—æ•°è½´ä¸Šçš„æ¯ä¸ªç‚¹æœ€å¤šè¢«è¦†ç›–äº†kæ¬¡</p><p>å»ºç«‹è¶…æº0ï¼Œè¶…æ±‡maxv+1iå’Œi+1è¿ä¸€æ¡è´¹ç”¨ä¸º0ï¼Œæµé‡ä¸ºkçš„è¾¹å¯¹äºæ¯ä¸ªåŒºé—´ï¼Œså‘t+1è¿ä¸€æ¡è´¹ç”¨ä¸º-wï¼Œæµé‡ä¸º1çš„è¾¹è·‘ä¸€éæœ€å°è´¹ç”¨æµå³å¯å®¹æ˜“å‘ç°è¿™ä¸ªå›¾æ˜¯ä¸ªdagï¼Œå¯ä»¥ç›´æ¥dpæ±‚å‡ºåŠ¿èƒ½håè·‘dijkstra</p><p>gym102759FåŒºé—´2æ¬¡è¦†ç›–æ¿å­ï¼Œå¡äº†spfa</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">namespace</span> MCMF</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>, M = <span class="number">1e6</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;</span><br><span class="line">  <span class="type">const</span> ll linf = <span class="number">1e18</span>;</span><br><span class="line">  <span class="type">int</span> cnt, head[N];</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> next, to, w;</span><br><span class="line">    ll f;</span><br><span class="line">  &#125;e[M&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w, ll f)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    e[++cnt] = &#123;head[u], v, w, f&#125;;</span><br><span class="line">    head[u] = cnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> n, s, t;</span><br><span class="line">  <span class="type">int</span> flow;</span><br><span class="line">  <span class="type">int</span> p[N], a[N];</span><br><span class="line">  ll d[N], h[N], cost;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _n, <span class="type">int</span> _s, <span class="type">int</span> <span class="type">_t</span>)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    n = _n, s = _s, t = <span class="type">_t</span>;</span><br><span class="line">    cnt = <span class="number">1</span>, flow = cost = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">0</span>, (n+<span class="number">1</span>)&lt;&lt;<span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> cap, ll cost)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">addedge</span>(u, v, cap, cost), <span class="built_in">addedge</span>(v, u, <span class="number">0</span>, -cost);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">getH</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) h[i] = linf;</span><br><span class="line">    h[s] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=s; i&lt;t; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=head[i]; j; j=e[j].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[j].to;</span><br><span class="line">        <span class="keyword">if</span>(e[j].w &amp;&amp; h[v]&gt;h[i]+e[j].f) h[v] = h[i] + e[j].f;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">Dijkstra</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) d[i] = linf;</span><br><span class="line">    d[s] = <span class="number">0</span>, a[s] = inf;</span><br><span class="line">    priority_queue&lt;pli, vector&lt;pli&gt;, greater&lt;pli&gt;&gt; pq;</span><br><span class="line">    pq.<span class="built_in">push</span>(&#123;<span class="number">0</span>, s&#125;);</span><br><span class="line">    <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">auto</span> cur = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="type">int</span> u = cur.se;</span><br><span class="line">      <span class="keyword">if</span>(cur.fi&gt;d[u]) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].to;</span><br><span class="line">        ll w = e[i].f + h[u] - h[v];</span><br><span class="line">        <span class="keyword">if</span>(e[i].w&amp;&amp;d[v]&gt;d[u]+w)</span><br><span class="line">        &#123;</span><br><span class="line">          p[v] = i;</span><br><span class="line">          a[v] = <span class="built_in">min</span>(a[u], e[i].w);</span><br><span class="line">          pq.<span class="built_in">push</span>(&#123;d[v]=d[u]+w, v&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(d[i]&lt;linf) h[i] += d[i];</span><br><span class="line">      <span class="keyword">else</span> h[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> d[t]!=linf;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">getH</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">Dijkstra</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      flow += a[t], cost += a[t]*h[t];</span><br><span class="line">      <span class="type">int</span> u = t;</span><br><span class="line">      <span class="keyword">while</span>(u!=s)</span><br><span class="line">      &#123;</span><br><span class="line">        e[p[u]].w -= a[t], e[p[u]^<span class="number">1</span>].w += a[t];</span><br><span class="line">        u = e[p[u]^<span class="number">1</span>].to;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  MCMF::<span class="built_in">init</span>(<span class="number">500002</span>, <span class="number">0</span>, <span class="number">500001</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> s, e; ll w; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%lld&quot;</span>, &amp;s, &amp;e, &amp;w);</span><br><span class="line">    MCMF::<span class="built_in">add</span>(s, e+<span class="number">1</span>, <span class="number">1</span>, -w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;MCMF::t; i++) MCMF::<span class="built_in">add</span>(i, i+<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  MCMF::<span class="built_in">go</span>();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, -MCMF::cost);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AtCoder Regular Contest 111</title>
      <link href="/2021/01/10/atcoder-regular-contest-111/"/>
      <url>/2021/01/10/atcoder-regular-contest-111/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>æ±‚$\lfloor \frac{10^n}{m} \rfloor$$1\leq n \leq 10^{18},1\leq m \leq 10000$</p><p>æŠŠ$x % y$æ”¹å†™æˆ$\lfloor \frac{x}{y} \rfloor$æ±‚å‡º$p=10^n % m$ï¼Œå†æ±‚å‡º$q=(10^n-p) % m^2$é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯$\frac{10^n-p}{m} - \frac{10^n-p-q}{m}$â€‹ï¼Œå³$\frac{q}{m}$å¿«é€Ÿå¹‚å³å¯</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>æœ‰nå¼ ç‰Œï¼Œæ¯å¼ æœ‰ä¸¤é¢ï¼Œå„æœ‰æ•°å­—$a_i$â€‹å’Œ$b_i$â€‹ï¼Œæ¯å¼ ç‰Œé€‰æ‹©ä¸€é¢æœä¸Šï¼Œé—®ä½ æœ€å¤šèƒ½æœ‰å‡ ç§æ•°å­—ã€‚</p><p>ç›¸å½“äºç»™$a_i$â€‹å’Œ$b_i$â€‹è¿è¾¹ï¼Œç„¶åå¯¹äºæ¯ä¸ªè¿é€šå—å¦‚æœæ˜¯æ ‘ï¼Œé‚£å°±è¦å°‘ä¸€ç§ï¼Œå¦åˆ™å…¨å¯ä»¥æœ‰ç„¶åæ¯”èµ›æ—¶å€™æˆ‘å´åªæƒ³åˆ°ä¸€ä¸ªäºŒåˆ†å›¾çš„å»ºæ³•ï¼Œç”šè‡³è¿˜åœ¨çŠ¹è±«è¦ä¸è¦ç”¨HKå†²ï¼ˆå¤ªèœæƒ¹ã€‚ã€‚ï¼‰æœ€åä¹Ÿæ˜¯ä¹±æè¿‡å»çš„ï¼Œå¦‚æœæŸä¸ªæ•°å­—åªæœ‰ä¸€å¼ ç‰Œæœ‰ï¼Œé‚£å°±è®©ç¿»ï¼Œè¿™æ ·æŒ‰ç…§æ‹“æ‰‘æŠŠè¿™äº›è´ªå¿ƒæ‰ä¹‹åï¼Œå‰©ä¸‹çš„æ¯ä¸ªæ•°å­—éƒ½è‡³å°‘æœ‰ä¸¤ä¸ªç‰Œæœ‰ï¼Œé‚£ä¹ˆè¿™äº›æ•°å­—éƒ½å¯ä»¥æœ‰ï¼ˆå…¶å®å’Œé¢˜è§£çš„ç»“è®ºä¸€æ ·ï¼‰</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>æ¯ä¸ªäººæœ‰æƒå€¼$a_i$â€‹ï¼Œæœ‰ç‰©å“$p_i$â€‹ï¼Œä¸”é‡$b_i$â€‹ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸¤ä¸ªäººäº¤æ¢ä»–ä»¬çš„ç‰©å“ï¼Œé—®ä½ æœ€å°‘å¤šå°‘æ¬¡ä½¿å¾—æ‰€æœ‰iæ»¡è¶³$p_i=i$ï¼Œä¸€ä¸ªé¢å¤–æ¡ä»¶æ˜¯å¦‚æœ$a_i\le b_i$â€‹åè¿™ä¸ªäººå°±ä¸èƒ½å†äº¤æ¢äº†ã€‚</p><p>å¯ä»¥ä»»æ„äº¤æ¢ï¼Œè¦æœ€å°‘æ¬¡æ•°ï¼Œæ˜¾ç„¶æ˜¯è€ƒè™‘æ¯ä¸ªç½®æ¢ç¯è´ªå¿ƒçš„æƒ³è‚¯å®šæ˜¯å…ˆè®©$a_i$â€‹å°çš„äººå…ˆå½’ä½ï¼Œå°½å¯èƒ½è®©$a_i$â€‹å¤§çš„äººä½œä¸­ä»‹æ‰€ä»¥æŒ‰ç…§$a$æ’åºåä¸€ä¸ªä¸ªæ¢å³å¯é¢˜è§£è¯´çš„æ˜¯å¦‚æœæ¢ä¸äº†å°±ä¸€å®šæ— è§£ã€‚æˆ‘å†™çš„æ—¶å€™æ˜¯å¦‚æœä¸€æ¬¡æ¢ä¸äº†ï¼Œå°±å°è¯•è®©$a$æœ€å¤§çš„é‚£ä¸ªä½œä¸­ä»‹ï¼Œä¼¼ä¹ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿ</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>ä¸€ä¸ªæ— å‘å›¾ï¼Œè®©ä½ ç»™æ‰€æœ‰è¾¹å®šå‘ï¼Œä½¿å¾—æ¯ä¸ªç‚¹å¯ä»¥è¾¾åˆ°çš„ç‚¹æ•°æ»¡è¶³ç»™å®šçš„æ•°ç»„$c$ï¼Œä¿è¯å­˜åœ¨è§£</p><p>å› ä¸ºä¸€å®šæœ‰è§£ï¼Œé‚£ä¹ˆå¯¹äºä¸€æ¡è¾¹ï¼Œå¦‚æœä¸¤ä¸ªç‚¹çš„cä¸åŒï¼Œä¸€å®šæ˜¯è®©å¤§çš„è¿å‘å°çš„ï¼Œæ‰€ä»¥åªç”¨è€ƒè™‘ç›¸ç­‰çš„ã€‚æˆ‘å½“æ—¶æƒ³çš„æ˜¯è‚¯å®šæ˜¯ç¯ï¼Œä½†æ˜¯è¿™æ ·å¾ˆéš¾æ„é€ ã€‚å…¶å®æœ¬è´¨å°±æ˜¯è®©ä½ æŠŠè¿™ä¸ªæ— å‘å›¾å®šå‘æˆä¸€ä¸ªå¼ºè¿é€šçš„å›¾ã€‚å…ˆè·‘å‡ºä¸€ä¸ªdfsæ ‘ï¼Œç„¶åå¯¹äºæ ‘è¾¹ä»dfsåºå°çš„åˆ°å¤§çš„ï¼Œå¯¹äºéæ ‘è¾¹ä»dfsåºå¤§çš„åˆ°å°çš„å³å¯ã€‚æˆ‘è¾¹çš„æ•°ç»„ä¹Ÿåªå¼€äº†100ï¼Œå¯¼è‡´ä¸€ç›´waï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸æ˜¯reï¼‰ï¼Œè‡ªé—­äº†</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ç»™å®šA,B,C,Dï¼Œè®©ä½ æ±‚æœ‰å¤šå°‘ä¸ªæ­£æ•´æ•°iæ»¡è¶³$[A+Bi,A+Ci]$åŒºé—´å†…æ²¡æœ‰Dçš„å€æ•°æ˜¾ç„¶åŒºé—´é•¿åº¦$\geq D$çš„æ—¶å€™ä¸€å®šæœ‰Dçš„å€æ•°æ‰€æœ‰iä¸€å®šæ»¡è¶³$\leq \lfloor \frac{D-2}{C-B} \rfloor$å…¶æ¬¡å°±æ˜¯$\lfloor \frac{A+Bi-1}{D} \rfloor= \lfloor \frac{A+Ci}{D}\rfloor$åˆç”±äºè¿™ä¸¤è€…æœ€å¤šç›¸å·®1ï¼Œæ‰€ä»¥åªè¦æ±‚å‡º$\sum \limits_{i=1}^{up} \lfloor\frac{A+Ci}{D} \rfloor - \lfloor \frac{A+Bi-1}{D}\rfloor$ï¼Œå°±æ˜¯åŒ…å«Dçš„å€æ•°çš„ä¸åˆæ³•åŒºé—´äº†ï¼Œç”¨upå‡æ‰å³å¯ã€‚è¿™ä¸œè¥¿å°±æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç±»æ¬§å‡ é‡Œå¾—äº†$\sum\limits_{i=0}^{n} \lfloor \frac{ai+b}{c} \rfloor$ï¼Œå¥—ä¸ªæ¿å­å³å¯</p><p>æ¯”èµ›å°±å†™ABCï¼ŒDæ²¡å†™å‡ºæ¥ï¼ŒEæ²¡çœ‹ï¼Œæ„Ÿè§‰è¿™æ¬¡DEæŒºå¥—è·¯çš„ï¼Œç„¶åABCæˆ‘å†™çš„æœ‰ç‚¹æ…¢ï¼ŒBCä¹Ÿéƒ½æ˜¯çŒœçš„ç»“è®ºä¸å¤ªæ•¢å†™ï¼Œæƒ³äº†å¥½ä¹…</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018-2019 ACM-ICPC, Asia Jiaozuo Regional Contest gym102028</title>
      <link href="/2021/01/09/2018-2019-acm-icpc-asia-jiaozuo-regional-contest-gym102028/"/>
      <url>/2021/01/09/2018-2019-acm-icpc-asia-jiaozuo-regional-contest-gym102028/</url>
      
        <content type="html"><![CDATA[<p>å‰äº”é¢˜ä¸éš¾ï¼ˆé“¶ï¼‰ï¼Œç¬¬å…­é¢˜ï¼ˆB or Hï¼‰éƒ½ä¸ä¼š</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>çœŸç­¾åˆ°</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>åˆä¸­é¢˜ï¼Œæœ‰ç‚¹çƒ¦æœ‰ä¸¤ç§æƒ…å†µï¼Œæ‡’å¾—å†™äº†</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>å¾ˆå®¹æ˜“æ‰“è¡¨æ‰¾åˆ°è§„å¾‹</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>å¾ˆç›´ç™½çš„bfsï¼Œéœ€è¦å¯¹ç»™å‡ºçš„å›¾è¿›è¡Œä¸€äº›è½¬åŒ–ï¼ˆæˆ‘çš„è½¬åŒ–æ–¹æ³•ä¸å¤ªå¥½ï¼Œå¯¼è‡´æœ‰ç‚¹éš¾å†™ï¼‰</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>æ¨ªè½´ä¸Šæœ‰nä¸ªç‚¹ï¼Œè®©ä½ é€‰æ‹©kä¸ªç‚¹ï¼Œæœ€å¤§åŒ–ä»–ä»¬ä¸¤ä¸¤ä¹‹é—´è·ç¦»çš„å’Œkä»1~néƒ½å›ç­”ä¸€éä¸¤ä¸ªç‚¹ä¸€å®šæ˜¯å–æœ€å·¦å’Œæœ€å³ï¼Œä¸‰ä¸ªç‚¹éšä¾¿å†å–ä¸€ä¸ªï¼Œå››ä¸ªç‚¹ä¸€å®šæ˜¯å–æœ€å·¦ä¸¤ä¸ªå’Œæœ€å³ä¸¤ä¸ªï¼Œé‚£ä¹ˆç»“è®ºå°±å¾ˆæ˜¾ç„¶äº†</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>ç»™å®šnä¸ªæ•°ï¼Œå®šä¹‰ä¸€ä¸ªå­åŒºé—´çš„å€¼ä¸ºè¯¥åŒºé—´çš„æœ€å¤§å€¼ï¼Œè®©ä½ æ±‚æ‰€æœ‰æœ¬è´¨ä¸åŒçš„å­åŒºé—´çš„å€¼çš„å’Œæ²¡æœ‰æœ¬è´¨ä¸åŒé‚£å°±å¾ˆæ¨¡æ¿äº†ï¼Œå•è°ƒæ ˆæˆ–è€…ç¬›å¡å°”æ ‘å³å¯ä½†æ˜¯æœ¬è´¨ä¸åŒå°±å¾ˆæ£˜æ‰‹ï¼Œæƒ³äº†æƒ³åç¼€è‡ªåŠ¨æœºæ„Ÿè§‰åšä¸äº†ï¼Œåˆæƒ³äº†æƒ³å•è°ƒæ ˆå’Œç¬›å¡å°”æ ‘æ„Ÿè§‰ä¹Ÿä¸è¡Œï¼Œå“ˆå¸Œä¹Ÿæ²¡æ³•æã€‚çœ‹åˆ°é¢˜è§£çš„åç¼€æ•°ç»„åå°±çŸ¥é“äº†ã€‚å¿˜äº†æœ¬è´¨ä¸åŒè¿˜å¯ä»¥åç¼€æ•°ç»„äº†ã€‚å…ˆæƒ³ä¸€ä¸‹åç¼€æ•°ç»„æ˜¯æ€ä¹ˆæ±‚æœ¬è´¨ä¸åŒçš„ä¸²çš„ï¼Œå°±æ˜¯æ±‚å‡º$height_i$â€‹ï¼Œé‚£ä¹ˆå¯¹äºä»ä½ç½®iå¼€å§‹çš„åç¼€ï¼Œä»–ä¼šå¤šç»Ÿè®¡$height_{rk_i}$â€‹â€‹ä¸ªå‰ç¼€ï¼Œå³ä»iå¼€å§‹ï¼Œä»¥$i$ ~ $i+height_{rk_i}-1$ç»“æŸçš„è¿™äº›åŒºé—´çš„å€¼é‡å¤ç®—äº†ï¼Œå‡æ‰å³å¯ä»¤$r_i = i+height_{rk_i}-1$å…ˆå»ºå‡ºç¬›å¡å°”æ ‘ï¼Œå¯¹äºå½“å‰ç‚¹uï¼Œå½“å‰èŒƒå›´ä¸º[L,R],åˆ™å·¦å­æ ‘å†…æ‰€æœ‰$r_i$â€‹å¤§äºç­‰äºuçš„ï¼Œéƒ½è¦å‡æ‰$a_u$â€‹çš„è´¡çŒ®å³è¦æ±‚å‡ºå·¦å­æ ‘(åŒ…æ‹¬u)å†…$\sum_{i=L}^u max(r_i-u+1,0) -\sum_{i=L}^u max(r_i-R,0)$å¯ä»¥ç”¨çº¿æ®µæ ‘åˆå¹¶æ¥ç»´æŠ¤</p><p>è¿™é¢˜å‘ç°äº†æˆ‘saæ¿å­çš„ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨æ±‚heightæ•°ç»„çš„æ—¶å€™è¦æ³¨æ„i+kå’Œj+kçš„èŒƒå›´ï¼Œå¦åˆ™åœ¨å¤šç»„æ•°æ®+æ•°ç»„æ˜¯intçš„æ—¶å€™ä¼šæŒ‚æ‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(i+k&lt;=n&amp;&amp;j+k&lt;=n&amp;&amp;a[i+k]==a[j+k]) k++;</span><br></pre></td></tr></table></figure><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>æœ‰ä¸¤ç§æ€ªç‰©ï¼Œè¡€é‡æ”»å‡»åŠ›åˆ†åˆ«ä¸º$HP_A,ATK_A,HP_B,ATK_B$ç¬¬iå›åˆä½ ä¼šå…ˆå—åˆ°æ´»ç€çš„æ€ªç‰©çš„æ”»å‡»ï¼Œç„¶åä½ å¯ä»¥é€‰æ‹©ä¸€åªæ€ªç‰©é€ æˆiçš„ä¼¤å®³ï¼Œè®©ä½ æœ€å°åŒ–è‡ªå·±æ‰€å—çš„ä¼¤å®³çš„åŒæ—¶æœ€å°åŒ–æ”»å‡»åºåˆ—çš„å­—å…¸åºï¼ˆå°½å¯èƒ½ä¼˜å…ˆæ‰“Aï¼‰å…ˆè€ƒè™‘æ€ä¹ˆæœ€å°åŒ–è‡ªå·±å—åˆ°çš„ä¼¤å®³å®šä¹‰f(t)è¡¨ç¤ºæœ€å°çš„xï¼Œä½¿å¾—$\sum_{i=1}^x \geq t$ä¸€å®šæ˜¯åœ¨$f(HP_A+HP_B)$å›åˆä»¥å†…ï¼Œå…ˆä¼˜å…ˆæ‰“æ­»Aï¼Œæˆ–è€…å…ˆä¼˜å…ˆæ‰“æ­»Bè€ƒè™‘å…ˆæ‰“æ­»Aï¼Œå¦‚æœå‰$f(HP_A)$å›åˆéƒ½ç”¨æ¥æ‰“Aï¼Œå‰©ä½™å›åˆæ‰“Bä¹Ÿèƒ½æŠŠBæ‰“æ­»é‚£è¿™å°±æ˜¯æœ€ä¼˜çš„ï¼Œå¦åˆ™å‡è®¾ç¼ºäº†xç‚¹ä¼¤å®³ï¼Œæ‰“Aå¯Œä½™äº†yç‚¹ä¼¤å®³ï¼Œå¿…ç„¶æœ‰å…³ç³»$y\geqx$ï¼Œä¸ºäº†è®©Bå°½å¯èƒ½é åï¼Œåªè¦åœ¨ç¬¬yå›åˆæ”¹æˆæ‰“Bå³å¯è€ƒè™‘å…ˆæ‰“æ­»Bï¼Œå…ˆåœ¨å‰$f(HP_B)$å›åˆéƒ½æ‰“Bï¼Œåé¢æ‰“Aï¼Œå¦‚æœæ‰“Bå¯Œä½™äº†xç‚¹ä¼¤å®³ï¼Œæˆ‘ä»¬è®©å‰$f(x+1)-1$ä¸ªå›åˆæ”¹æˆæ‰“Aå³å¯ï¼Œå¦‚æœAè¿˜ç¼ºäº†xçš„ä¼¤å®³ï¼Œé‚£å°±è®©å‰é¢æœ€åä¸€ä¸‹æ‰“Aå»¶è¿Ÿxå›åˆ</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ä¸€ä¸ª$n \times n$çš„æ£‹ç›˜ï¼Œæ¯ä¸€åˆ—ä¸Šéƒ½ä¸€ä¸ªæ£‹å­ï¼ˆä¸”éƒ½ä¸åŒè¡Œï¼‰ï¼Œç°åœ¨æœ‰å››ç§æ“ä½œå’Œä¸¤ç§è¯¢é—®</p><ul><li>L Kï¼šæ‰€æœ‰æ£‹å­åŒæ—¶å‘å·¦ç§»åŠ¨kæ­¥ï¼Œå¦‚æœç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨</li><li>R Kï¼šæ‰€æœ‰æ£‹å­åŒæ—¶å‘å³ç§»åŠ¨kæ­¥ï¼Œå¦‚æœç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨</li><li>U Kï¼šæ‰€æœ‰æ£‹å­åŒæ—¶å‘ä¸Šç§»åŠ¨kæ­¥ï¼Œå¦‚æœç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨</li><li>D Kï¼šæ‰€æœ‰æ£‹å­åŒæ—¶å‘ä¸‹ç§»åŠ¨kæ­¥ï¼Œå¦‚æœç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨</li><li>è¯¢é—®åˆå§‹ç¬¬iä¸ªæ£‹å­ç°åœ¨çš„ä½ç½®</li><li>è¯¢é—®æœ‰å¤šå°‘å¯¹æ£‹å­ç°åœ¨åœ¨åŒä¸€ä¸ªä½ç½®ä¸Š</li></ul><p>$n \leq 3\times 10^5$è¿™ç§äºŒç»´é—®é¢˜ï¼Œä¸€ä¸ªæƒ³æ³•å°±æ˜¯è¡Œåˆ—åˆ†ç¦»åšï¼Œè¿™è¾¹æ˜¾ç„¶ä¹Ÿå¯ä»¥è¡Œåˆ—åˆ†ç¦»è½¬æˆä¸€ç»´å»æ€è€ƒå°±è€ƒè™‘æ‰€æœ‰æ£‹å­åœ¨ä¸€æ¡æ¨ªè½´ä¸Šï¼Œå¯ä»¥åŒæ—¶å·¦å³ç§»åŠ¨kæ­¥å¯¹äºç¢°åˆ°è¿‡å·¦è¾¹ç•Œçš„æ£‹å­ï¼Œä»¥åå°±æ°¸è¿œåœ¨ä¸€èµ·äº†ï¼Œå³è¾¹ç•Œä¹Ÿæ˜¯è¿™æ ·ç¬¬ä¸€æ­¥å·¦ç§»kï¼Œé‚£ä¹ˆ1~kçš„æ£‹å­ä¹‹åå°±ç›¸åŒäº†å¦ä¸€ä¸ªå¥—è·¯æ˜¯nä¸ªæ£‹å­ä¸€èµ·åŠ¨ä¸å¥½ç»´æŠ¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å»ç»´æŠ¤è¾¹ç•Œï¼Œå·¦ç§»kï¼Œæˆ‘ä»¬è®©å·¦è¾¹ç•Œå³ç§»kå°±è¡Œäº†ï¼Œè¿™æ ·$\leq$å·¦è¾¹ç•Œçš„æ£‹å­éƒ½ç›¸å½“äºæ˜¯åœ¨å·¦è¾¹ç•Œä¸Šï¼Œè¿™æ ·ä¸€æ¥ç›¸å½“äºæ˜¯å·¦å³è¾¹ç•Œä¸æ–­åœ¨å‘ä¸­é—´é æ‹¢ï¼Œå› ä¸ºä¸æ–­ç§»åŠ¨ä¸‹å»åˆå¹¶çš„æ£‹å­å°±è¶Šæ¥è¶Šå¤šäº†ã€‚ä½†æ˜¯æˆ‘ä»¬ç»´æŠ¤çš„å¹¶ä¸æ˜¯çœŸå®çš„å·¦è¾¹ç•Œåæ ‡ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»´æŠ¤ä¸€ä¸ªå˜é‡dã€‚å·¦ç§»å°±è®©d+kï¼Œå³ç§»å°±è®©d-kï¼Œåˆ™l-kå’Œr-kå°±æ˜¯çœŸå®çš„è¾¹ç•Œäº†ï¼Œå½“ç„¶è¿˜éœ€è¦ä¿è¯çœŸå®è¾¹ç•Œåœ¨1~nèŒƒå›´å†…ï¼Œå› ä¸ºç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨äº†è¿™æ ·æ¨ªè½´çºµè½´åˆ†åˆ«ç»´æŠ¤å°±å¯ä»¥è§£å†³ç¬¬ä¸€ä¸ªè¯¢é—®äº†ï¼Œå¯¹äºç¬¬äºŒä¸ªè¯¢é—®ï¼Œæˆ‘ä»¬ç›¸å½“äºæ˜¯LRDUå››ä¸ªè¾¹ç•Œåœ¨ä¸æ–­çš„å¾€ä¸­é—´å‹ç¼©ï¼Œç”±äºåˆå§‹è¡Œåˆ—å‡ä¸åŒï¼Œè¦ä½äºåŒä¸€ä¸ªæ ¼å­ï¼Œå¿…é¡»åŒåœ¨LRè½´ä¸­çš„ä¸€ä¸ªï¼ŒUDè½´çš„ä¸€ä¸ªï¼Œç”¨å››ä¸ªå˜é‡LDï¼ŒLUï¼ŒRDï¼ŒRUåˆ†åˆ«ç»´æŠ¤ä¸€ä¸‹ï¼Œæ³¨æ„ç‰¹åˆ¤L=Rï¼ŒD=Uçš„æƒ…å†µã€‚å…·ä½“ç»´æŠ¤çš„è¯ï¼Œå› ä¸ºlrudè¿™å››ä¸ªè½´éƒ½æ˜¯å•è°ƒå˜åŒ–çš„ï¼Œé‚£ä¹ˆæ¯æ¬¡ç§»åŠ¨çš„æ—¶å€™åˆ¤æ–­ä¸€ä¸‹å½“å‰ç¢°åˆ°è¾¹ç•Œçš„ç‚¹å³å¯ï¼Œæ³¨æ„ä¸è¦é‡å¤ç»Ÿè®¡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, ul, ur, dl, dr;</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">ll C[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">check</span><span class="params">(<span class="type">int</span> id)</span></span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Bound</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, d;</span><br><span class="line">  <span class="type">int</span> p[N], id[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; l = <span class="number">1</span>, r = n, d = <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">set</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; p[x] = y, id[y] = x; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">movel</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r &amp;&amp; l+d-k&lt;<span class="number">1</span>) <span class="built_in">check</span>(id[++l]);</span><br><span class="line">    <span class="keyword">if</span>(l+d-k&gt;=<span class="number">1</span>) d -= k;</span><br><span class="line">    <span class="keyword">else</span> d = <span class="number">1</span> - l;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">mover</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r &amp;&amp; r+d+k&gt;n) <span class="built_in">check</span>(id[--r]);</span><br><span class="line">    <span class="keyword">if</span>(r+d+k&lt;=n) d += k;</span><br><span class="line">    <span class="keyword">else</span> d = n - r;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p[k]&lt;=l) <span class="keyword">return</span> l + d;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p[k]&gt;=r) <span class="keyword">return</span> r + d;</span><br><span class="line">    <span class="keyword">return</span> p[k] + d;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;lr, ud;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">check</span><span class="params">(<span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(vis[id]) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(lr.p[id]&lt;=lr.l &amp;&amp; ud.p[id]&lt;=ud.l) ul++, vis[id] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(lr.p[id]&lt;=lr.l &amp;&amp; ud.p[id]&gt;=ud.r) dl++, vis[id] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(lr.p[id]&gt;=lr.r &amp;&amp; ud.p[id]&lt;=ud.l) ur++, vis[id] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(lr.p[id]&gt;=lr.r &amp;&amp; ud.p[id]&gt;=ud.r) dr++, vis[id] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(lr.l==lr.r &amp;&amp; ud.l==ud.r) <span class="keyword">return</span> C[ul+dl+ur+dr];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(lr.l==lr.r) <span class="keyword">return</span> C[ul+ur] + C[dl+dr];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(ud.l==ud.r) <span class="keyword">return</span> C[ul+dl] + C[ur+dr];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> C[ul] + C[ur] + C[dl] + C[dr];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ul = ur = dl = dr = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">  lr.<span class="built_in">init</span>(n), ud.<span class="built_in">init</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    lr.<span class="built_in">set</span>(i, y); ud.<span class="built_in">set</span>(i, x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">check</span>(lr.id[<span class="number">1</span>]), <span class="built_in">check</span>(lr.id[n]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> op[<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">    <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, ud.<span class="built_in">get</span>(k), lr.<span class="built_in">get</span>(k));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;!&#x27;</span>) <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">ask</span>());</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;L&#x27;</span>) lr.<span class="built_in">movel</span>(k);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) lr.<span class="built_in">mover</span>(k);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;U&#x27;</span>) ud.<span class="built_in">movel</span>(k);</span><br><span class="line">      <span class="keyword">else</span> ud.<span class="built_in">mover</span>(k);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;N; i++) C[i] = <span class="number">1ll</span>*i*(i<span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 695 (Div. 2)</title>
      <link href="/2021/01/09/codeforces-round-695-div-2/"/>
      <url>/2021/01/09/codeforces-round-695-div-2/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>æœ‰nä¸ªæ•°å­—ï¼ŒåŒæ—¶ä»0å¼€å§‹ï¼ŒæŒ‰ç…§0~9çš„é¡ºåºå¾ªç¯ï¼Œæ¯ä¸€ç§’å˜åŒ–ä¸€æ¬¡ã€‚ç°åœ¨å¯ä»¥æš‚åœæŸä¸ªæ•°å­—çš„å˜åŒ–ï¼Œç„¶åè·ç¦»å®ƒxçš„æ•°å­—ä¼šåœ¨xç§’åæš‚åœå˜åŒ–ï¼Œé—®æ‰€æœ‰æ•°å­—éƒ½æš‚åœåçš„æœ€å¤§æ•°å­—æ˜¯å¤šå°‘ã€‚æ˜¾ç„¶é«˜ä½è¶Šå¤§è¶Šå¥½ï¼Œå‘ç°æ“ä½œç¬¬2ä¸ªæ•°å­—åå¯ä»¥ä½¿å‰ä¸‰ä½ä¸º989ï¼Œè¿™æ ·å¿…ç„¶æ˜¯æœ€å¤§çš„</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™å®šä¸€ä¸ªæ•°ç»„aï¼Œå¦‚æœ$a_i\lt a_{i-1},a_i\lt a_{i+1}$â€‹ï¼Œæˆ–è€…$a_i\gt a_{i-1},a_i\gt a_{i+1}$â€‹ï¼Œåˆ™æ˜¯åçš„ä¸‰å…ƒç»„ï¼Œè¦æ±‚ä½ è‡³å¤šä¿®æ”¹ä¸€ä¸ªæ•°ä½¿åçš„ä¸‰å…ƒç»„ä¸ªæ•°æœ€å°‘è€ƒè™‘ä¿®æ”¹ä¸€ä¸ªæ•°ï¼Œåªä¼šå½±å“åˆ°ä»¥$a_{i-1},a_i,a_{i+1}$â€‹è¿™ä¸‰ä¸ªæ•°ä¸ºä¸­å¿ƒçš„ä¸‰å…ƒç»„ï¼Œåœ¨æœ€ä¼˜çš„æƒ…å†µä¸‹ï¼Œ$a_i$â€‹çš„å–å€¼å¿…ç„¶æ˜¯$a_{i-2},a_{i-1},a_i,a_{i+1},a_{i+2},\inf,-\inf$è¿™ä¸ƒç§ä¹‹ä¸€ï¼Œæš´åŠ›æšä¸¾ä¸€ä¸‹ï¼ˆè¿™è¾¹æ²¡ç»†æƒ³ï¼Œä¸çŸ¥é“åªå–$a_{i-1}$â€‹æˆ–$a_{i+1}$â€‹è¡Œä¸è¡Œï¼‰</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>æœ‰ä¸‰ä¸ªå¤šé‡é›†ï¼Œå®šä¹‰ä¸€ç§æ“ä½œæ˜¯ï¼Œé€‰æ‹©æŸä¸ªå¤šé‡é›†ä¸­çš„æ•°xï¼Œå¦ä¸€ä¸ªå¤šé‡é›†ä¸­çš„æ•°yï¼Œç„¶ååˆ é™¤è¿™ä¸¤ä¸ªæ•°ï¼ŒæŠŠx-yæ”¾åˆ°xæ‰€åœ¨çš„å¤šé‡é›†ä¸­ï¼Œè®©ä½ æœ€å¤§åŒ–æœ€åå‰©ä¸‹çš„é‚£ä¸ªæ•°çš„å€¼æˆ‘ä»¬å¯ä»¥è®©xå»å‡æ‰æ‰€æœ‰çš„yï¼Œå†è®©zå»å‡æ‰xï¼Œé‚£å°±ç›¸å½“äºåªæŸå¤±äº†ä¸€ä¸ªxå…ˆæšä¸¾å‰©ä¸‹çš„é‚£ä¸ªæ•°åœ¨å“ªä¸ªå¤šé‡é›†ä¸­ï¼Œå¿…ç„¶æ˜¯è®©æœ€å°çš„é‚£ä¸ªæ•°å½“ä½œxçš„è§’è‰²ï¼Œå†è€ƒè™‘æ€ä¹ˆå»æ‰åŒä¸€é›†åˆä¸­çš„å…¶ä»–æ•°tï¼Œå¯ä»¥é€‰æ‹©å¦å¤–ä¸¤ä¸ªå¤šé‡é›†ä¸­çš„æœ€å°å€¼mnï¼Œç„¶åè®©tå’Œmnä¸­çš„è¾ƒå°è€…å……å½“xçš„è§’è‰²ï¼Œè¿™æ ·æŸå¤±å°±æ˜¯$\min(t,mn)$ã€‚æ‰€ä»¥æœ€å°æŸå¤±å°±æ˜¯è¯¥å¤šé‡é›†çš„æœ€å°å€¼ï¼Œä»¥åŠè¯¥å¤šé‡é›†çš„æ¬¡å°å€¼å’Œå…¶ä½™ä¸¤ä¸ªå¤šé‡é›†çš„æœ€å°å€¼ä¸­çš„æœ€å°å€¼çš„å’Œï¼ˆæœ‰ç‚¹ç»•ã€‚ã€‚ï¼‰</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>ä¸€ä¸ªäººåˆå§‹åœ¨1~nçš„ä»»æ„ä¸€ç‚¹ï¼Œç„¶åæ¯æ¬¡å¯ä»¥å‘å·¦æˆ–è€…å‘å³èµ°ä¸€æ­¥ï¼Œèµ°kæ­¥åå°±å½¢æˆä¸€æ¡è·¯å¾„$c_0,c_1,â€¦,c_k$â€‹ï¼Œå®šä¹‰è¯¥è·¯å¾„çš„ä»·å€¼ä¸º$\sum_{i=0}^ka_{c_i}$â€‹â€‹ï¼Œæ±‚æ‰€æœ‰ä¸åŒçš„è·¯å¾„çš„ä»·å€¼å’Œï¼Œè¦æ±‚æ”¯æŒå•ç‚¹ä¿®æ”¹$a_i$â€‹å…ˆæ±‚å‡º$dp_{i,j}$â€‹è¡¨ç¤ºç¬¬iæ­¥åœ¨jçš„æ–¹æ¡ˆæ•°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªdpçš„è½¬ç§»æ­£å‘å’Œåå‘æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆåˆ°$dp_k$â€‹çš„æ—¶å€™$dp_{i,j}$â€‹çš„è´¡çŒ®å°±ç›¸å½“äº$dp_{k-i,j}$â€‹ï¼Œæ‰€ä»¥éšä¾¿ç»´æŠ¤ä¸€ä¸‹å‰ç¼€å’Œå°±å¯ä»¥$O(1)$å¸¦ä¿®äº†</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ç»™ä¸€æ£µå¸¦ç‚¹æƒçš„æ— æ ¹æ ‘ï¼Œä¸€ä¸ªç‚¹uä½œä¸ºæ ¹æ˜¯åˆæ³•çš„ï¼Œä»…å½“å¯¹äºå…¶å®ƒä»»æ„ç‚¹vï¼Œuåˆ°vçš„è·¯å¾„ä¸Šçš„ç‚¹æƒå‡ä¸åŒå¯ä»¥ç”¨æ¢æ ¹dpæ¥åšå›ºå®š1ä¸ºæ ¹ï¼Œå…ˆdfsä¸€éè·‘å‡º$dp_u$â€‹ï¼Œè¡¨ç¤ºåªè€ƒè™‘uçš„å­æ ‘æ—¶ï¼Œä»¥uä¸ºæ ¹æ˜¯å¦åˆæ³•ã€‚è¿™ä¸ªå¾ˆç®€å•ï¼Œåªè¦uçš„æ‰€æœ‰å„¿å­våˆæ³•ï¼Œä¸”uçš„ç‚¹æƒåœ¨å­æ ‘ä¸­æ²¡æœ‰å‡ºç°è¿‡å³å¯ã€‚å†è€ƒè™‘æ±‚å‡º$dp2_u$â€‹ï¼Œè¡¨ç¤ºè€ƒè™‘é™¤å»uçš„å­æ ‘åçš„éƒ¨åˆ†ï¼Œä»¥uä¸ºæ ¹æ˜¯å¦åˆæ³•ã€‚é¦–å…ˆuçš„ç‚¹æƒåªèƒ½åœ¨uçš„å­æ ‘å½“ä¸­å‡ºç°ï¼Œuçš„çˆ¶äº²façš„ç‚¹æƒä¹Ÿåªèƒ½åœ¨uçš„å­æ ‘ä¸­å‡ºç°ï¼Œ$dp2_{fa}$â€‹è¦åˆæ³•ã€‚æ­¤å¤–å¯¹äºfaï¼Œé™¤å»uç‚¹åå…¶ä½™å„¿å­çš„dpè¦éƒ½æ˜¯1ã€‚æ»¡è¶³ä»¥ä¸Šæ‰€æœ‰æ¡ä»¶ï¼Œ$dp2_u$â€‹å°±æ˜¯1ã€‚æœ€åå½“$dp_u=1$ä¸”$dp2_u=1$æ—¶ï¼Œè¡¨æ˜uæ˜¯åˆæ³•çš„å…·ä½“å®ç°éœ€è¦ç”¨mapå¯å‘å¼åˆå¹¶</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ICPC Central Russia Regional Contest (CRRC 19) gym102780</title>
      <link href="/2021/01/09/icpc-central-russia-regional-contest-crrc-19-gym102780/"/>
      <url>/2021/01/09/icpc-central-russia-regional-contest-crrc-19-gym102780/</url>
      
        <content type="html"><![CDATA[<p>é™¤äº†ä¸¤é“é¢˜æ²¡ä»€ä¹ˆäººè¿‡å¤–æ¯”è¾ƒç®€å•</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>å°å­¦æ•°å­¦</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>åˆä¸­ç‰©ç†</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>æ¨¡æ‹Ÿé¢˜ï¼Œå¸¦ä¸€ç‚¹ç‚¹æ¨ç†</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>ç»™å®ša,bï¼Œè®©ä½ æ±‚ä¸€ä¸ªxï¼Œæ»¡è¶³$a^x=x^b$å…¶ä¸­$2\leq a,b \leq 10000$å®¹æ˜“æƒ³åˆ°xå¯ä»¥è¡¨ç¤º$a^t$çš„å½¢å¼è€ƒè™‘$t\geq 1$çš„æƒ…å†µ$a^t = tb$å¯ä»¥ç›´æ¥æš´åŠ›æšä¸¾tï¼Œå¹‚æ¬¡çš„å¢é€Ÿæ˜¯è¿…é€Ÿçš„è€ƒè™‘$t\le 1$çš„æƒ…å†µå°æ•°æ²¡æ³•æšä¸¾äº†ï¼Œä½†æ˜¯å¯ä»¥æ‰¾åˆ°açš„å› å­dï¼Œä½¿å¾—dçš„å¹‚æ¬¡=aï¼Œè½¬è€Œç”¨dçš„å¹‚æ¬¡å»è¡¨ç¤ºxå³å¯</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸¤ä¸ªäººè½®æµæ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€ç§å­—æ¯ï¼Œç„¶ååˆ é™¤ä¸€ä¸ªæˆ–è€…äºŒä¸ªæˆ–è€…å…¨éƒ¨ï¼Œé—®è°èµ¢ã€‚å¯ä»¥æŠŠæ¯ç§å­—æ¯æƒ³æˆä¸€å †çŸ³å­ï¼Œé‚£å°±æ˜¯ä¸€ä¸ªåªèƒ½å–1ä¸ªæˆ–2ä¸ªæˆ–å…¨éƒ¨çš„NIMæ¸¸æˆï¼Œè·‘ä¸€ä¸‹sgå³å¯ï¼Œå…¶å®ç›´æ¥æ‰‹æ¨ä¹Ÿè¡Œ</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>ä¸€ä¸ªæ•°nï¼Œä¸¤ä¸ªè½®æµè®©å…¶å‡1ï¼Œå‡5ï¼Œæˆ–è€…å‡13ï¼Œé—®è°èµ¢è·ŸFå·®ä¸å¤šï¼Œè·‘ä¸€ä¸‹dpå³å¯</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>æœ‰ä¸€ä¸ª$n \times n$çš„ç½‘æ ¼ï¼Œç°åœ¨æœ‰ä¸€ä¸ªç‰¹æ®Šç‚¹ï¼Œç„¶åæ¯æ¬¡ä½ å¯ä»¥è¿›è¡Œä¸‰ç§è¯¢é—®</p><ul><li>è¯¢é—®æŸä¸ªç‚¹æ˜¯ä¸æ˜¯ç‰¹æ®Šç‚¹</li><li>è¯¢é—®æŸæ¡çº¿æ®µæ˜¯å¦åŒ…å«ç‰¹æ®Šç‚¹</li><li>è¯¢é—®æŸä¸ªä¸‰è§’å½¢æ˜¯å¦åŒ…å«ç‰¹æ®Šç‚¹</li></ul><p>$n \leq 10^8$ï¼Œè¯¢é—®æ¬¡æ•°ä¸è¶…è¿‡60çœ‹åˆ°è¿™ä¸ªæ•°æ®èŒƒå›´å’Œè¯¢é—®æ¬¡æ•°å°±æƒ³åˆ°äºŒåˆ†ï¼Œxå’Œyå¯ä»¥åˆ†å¼€åšï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›¸å½“äºè¦é€šè¿‡ä¸€æ¬¡è¯¢é—®åˆ¤æ–­è¿™ä¸ªç‰¹æ®Šç‚¹çš„åæ ‡æ˜¯å°äºxè¿˜æ˜¯å¤§äºxã€‚è¿™è¾¹æœ‰ä¸ªæ¡ä»¶å°±æ˜¯è¯¢é—®çš„ç‚¹çš„åæ ‡å¯ä»¥è¶…è¿‡nï¼Œåœ¨$10^9$ä»¥å†…å°±è¡Œï¼Œé‚£å°±å¾ˆç®€å•äº†ï¼Œæ¯æ¬¡é—®ä¸€ä¸ªå³è¾¹çš„ç‰¹åˆ«å¤§çš„ä¸‰è§’å½¢ï¼Œä¿è¯å¯ä»¥ç›–ä½å¤§äºxçš„è¿™å—çŸ©å½¢å°±å¯ä»¥äº†</p><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>è®©ä½ ç”¨ä¸è¶…è¿‡5ä¸ªæ•°ï¼Œä½¿å¾—å®ƒä»¬çš„ç«‹æ–¹å’Œç­‰äºx$x\leq 10^{100000}$è€ƒè™‘$(x-1)^3 + (x+1)^3 = 2x^3 + 6x$é‚£å¦‚æœxæ˜¯6çš„å€æ•°ï¼Œè®©y=x/6ï¼Œç„¶åç”¨y-1ï¼Œy+1ï¼Œ-y, -yè¿™å››ä¸ªæ•°å°±å¯ä»¥è¡¨ç¤ºå‡ºxäº†å…¶ä½™æŒ‰ç…§%6è®¨è®ºä¸€ä¸‹å³å¯æ¯”å¦‚x%6=2ï¼Œå°±å…ˆè¡¨ç¤ºå‡ºx-8ï¼Œå†åŠ ä¸ª$2^3$å³å¯</p><h2 id="K"><a class="header-anchor" href="#K">Â¶</a>K</h2><p>ç»™å®šnä¸ªä¸åŒçš„æ•°ï¼Œæ¯æ¬¡å¯ä»¥äº¤æ¢ç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œé—®ä½ æœ€å°‘äº¤æ¢å‡ æ¬¡ï¼Œä½¿å¾—è¿™nä¸ªæ•°å…ˆå‡åå¢ä»å¤§åˆ°å°è€ƒè™‘æ¯ä¸ªæ•°ï¼Œæœ€å¤§çš„æ•°åªèƒ½æ”¾åœ¨æœ€å·¦è¾¹æˆ–è€…æœ€å³è¾¹ï¼Œç„¶åä¼¼ä¹å°±æœ‰ç§$n^2$çš„dpäº†ï¼Œä½†æ˜¯ä»”ç»†æ€è€ƒå¯ä»¥å‘ç°æœ€å¤§çš„æ•°æ”¾åœ¨å·¦è¾¹è¿˜æ˜¯å³è¾¹æ˜¯ä¸å½±å“æ¬¡å¤§çš„æ•°çš„ï¼Œæ‰€ä»¥æ¯ä¸ªæ•°è´ªå¿ƒçš„æ”¾å°±è¡Œäº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬›å¡å°”æ ‘</title>
      <link href="/2020/12/23/di-qia-er-shu/"/>
      <url>/2020/12/23/di-qia-er-shu/</url>
      
        <content type="html"><![CDATA[<p>ç±»ä¼¼treapï¼Œæƒå€¼æ»¡è¶³äºŒå‰æœç´¢æ ‘ï¼Œé”®å€¼æ»¡è¶³å †ä¸€èˆ¬ç”¨åœ¨åºåˆ—ä¸Šï¼Œä»¥ä¸‹æ ‡ä¸ºæƒå€¼ï¼Œå€¼ä¸ºé”®å€¼ï¼Œåˆ©ç”¨å•è°ƒæ ˆå¯ä»¥$O(n)$å»ºæ ‘å› ä¸ºä¸‹æ ‡æ˜¯å•è°ƒé€’å¢çš„ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨å•è°ƒæ ˆä¸­ç»´æŠ¤å‡ºæœ€å³é“¾ï¼Œåœ¨æ’å…¥ä¸€ä¸ªæ–°ç‚¹çš„æ—¶å€™ï¼Œä¸æ–­æ’æ‰å¤§äºè‡ªå·±å€¼çš„ç‚¹ï¼Œç„¶åè‡ªå·±æˆä¸ºæ ˆé¡¶çš„å³å„¿å­ï¼Œæ’æ‰çš„æœ€åä¸€ä¸ªç‚¹ä½œå…¶å·¦å„¿å­æœ‰ä»€ä¹ˆç”¨å‘¢ç¬›å¡å°”æ ‘ä¸Šä¸¤ä¸ªç‚¹çš„LCAå°±ä»£è¡¨è¿™ä¸ªåŒºé—´çš„RMQå¯¹ä¸€ä¸ªç‚¹ï¼Œå®ƒæ˜¯å…¶ä»£è¡¨çš„åŒºé—´çš„æœ€å€¼ï¼Œå·¦å­æ ‘æ˜¯å·¦åŒºé—´ï¼Œå³å­æ ‘æ˜¯å³åŒºé—´ï¼Œè¿™å°±å½¢æˆäº†è‰¯å¥½çš„é€’å½’æ€§è´¨ï¼Œå¯ä»¥æ–¹ä¾¿æ€è€ƒå’Œè§£é¢˜</p><h2 id="P4755"><a class="header-anchor" href="#P4755">Â¶</a>P4755</h2><p>å®šä¹‰ç‚¹å¯¹$(i,j)$æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“$a_i\times a_j \leq \max(a_i,â€¦,a_j)$æ˜¾ç„¶å¯ä»¥å¯å‘å¼åˆ†æ²»åšï¼Œåˆ©ç”¨stè¡¨æ‰¾åˆ°æœ€å€¼çš„ä½ç½®ï¼Œç„¶åå¯å‘å¼éå†å·¦å³åŒºé—´ä¸­å°çš„é‚£ä¸€è¾¹ç„¶åæ±‚æœ€å€¼å³å¯ã€‚å…¶å®è¿™ç§æ€æƒ³æ”¾åœ¨ç¬›å¡å°”æ ‘ä¸Šä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œdfséå†ï¼Œç„¶åé€šè¿‡éå†å°çš„é‚£é¢—å­æ ‘æ¥ç»Ÿè®¡ç­”æ¡ˆã€‚ç»Ÿè®¡ç­”æ¡ˆå¯ä»¥ç›´æ¥ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œç„¶åçº¿æ®µæ ‘åˆå¹¶å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="type">int</span> n, a[N], sz[N];</span><br><span class="line"><span class="type">int64_t</span> ans;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, cnt;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line"><span class="type">int</span> rt[N&lt;&lt;<span class="number">5</span>], tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].cnt = t[t[p].l].cnt + t[t[p].r].cnt; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) p = ++tot;</span><br><span class="line">  t[p].cnt++;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(t[p].l, l, mid, x);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">upd</span>(t[p].r, mid+<span class="number">1</span>, r, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(r&lt;=v) <span class="keyword">return</span> t[p].cnt;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> ans = <span class="built_in">ask</span>(t[p].l, l, mid, v);</span><br><span class="line">  <span class="keyword">if</span>(v&gt;mid) ans += <span class="built_in">ask</span>(t[p].r, mid+<span class="number">1</span>, r, v);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) <span class="keyword">return</span> x|y;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    t[x].cnt += t[y].cnt;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  t[x].l = <span class="built_in">merge</span>(t[x].l, t[y].l, l, mid);</span><br><span class="line">  t[x].r = <span class="built_in">merge</span>(t[x].r, t[y].r, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">up</span>(x);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> st[N], ch[N][<span class="number">2</span>], top;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, j; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    j = top;</span><br><span class="line">    <span class="keyword">while</span>(j&amp;&amp;a[st[j]]&lt;a[i]) j--;</span><br><span class="line">    <span class="keyword">if</span>(j) ch[st[j]][<span class="number">1</span>] = i;</span><br><span class="line">    <span class="keyword">if</span>(j&lt;top) ch[i][<span class="number">0</span>] = st[j+<span class="number">1</span>];</span><br><span class="line">    top = j;</span><br><span class="line">    st[++top] = i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p || l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(ch[p][<span class="number">0</span>], l, p<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">dfs</span>(ch[p][<span class="number">1</span>], p+<span class="number">1</span>, r);</span><br><span class="line">  sz[p] = sz[ch[p][<span class="number">0</span>]] + sz[ch[p][<span class="number">1</span>]] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]&lt;sz[ch[p][<span class="number">1</span>]]) <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=p<span class="number">-1</span>; i++) ans += <span class="built_in">ask</span>(rt[ch[p][<span class="number">1</span>]], <span class="number">1</span>, inf, a[p]/a[i]);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>; i&lt;=r; i++) ans += <span class="built_in">ask</span>(rt[ch[p][<span class="number">0</span>]], <span class="number">1</span>, inf, a[p]/a[i]);</span><br><span class="line">  rt[p] = <span class="built_in">merge</span>(rt[ch[p][<span class="number">0</span>]], rt[ch[p][<span class="number">1</span>]], <span class="number">1</span>, inf);</span><br><span class="line">  <span class="built_in">upd</span>(rt[p], <span class="number">1</span>, inf, a[p]);</span><br><span class="line">  ans += <span class="built_in">ask</span>(rt[p], <span class="number">1</span>, inf, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="built_in">build</span>();</span><br><span class="line">  <span class="built_in">dfs</span>(st[<span class="number">1</span>], <span class="number">1</span>, n);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç‰›å®¢å¤šæ ¡3-Sort-the-Strings-Revision"><a class="header-anchor" href="#ç‰›å®¢å¤šæ ¡3-Sort-the-Strings-Revision">Â¶</a>ç‰›å®¢å¤šæ ¡3 Sort the Strings Revision</h2><p>æœ‰ä¸€ä¸ªåºåˆ—ï¼Œç¬¬iä¸ªå…ƒç´ çš„å€¼ä¸º$i % 10$ï¼Œnæ¬¡æ“ä½œï¼Œæ¯æ¬¡å°†$p_i$â€‹ä½ç½®çš„å€¼æ¢æˆ$d_i$â€‹ï¼Œå…¶ä¸­$p_i$â€‹ä¸ºä¸€ä¸ªæ’åˆ—ï¼Œé—®ä½ æ“ä½œå‰åå…±$n+1$ä¸ªåºåˆ—çš„å­—å…¸åºæ’åæ˜¾ç„¶è¶Šå°çš„$p_i$â€‹è¶Šå æ®ä¸»å¯¼åœ°ä½ï¼Œæ ¹æ®åºåˆ—på»ºå‡ºç¬›å¡å°”æ ‘ï¼Œç„¶åå¦‚æœ$p_i&gt;d_i$â€‹ï¼Œè¯´æ˜ä¿®æ”¹åå­—å…¸åºæ›´å°ï¼Œä¼˜å…ˆéå†å³å­æ ‘ï¼Œåä¹‹ä¼˜å…ˆéå†å·¦å­æ ‘ã€‚æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚æœ$p_i=d_i$â€‹ï¼Œæ­¤æ—¶å°±ä¸çŸ¥é“å·¦å³å­æ ‘å“ªä¸ªå°äº†ï¼Œå¯ä»¥äººä¸ºçš„å…ˆè®©è¿™æ ·çš„$p_i$â€‹å–ä¸€ä¸ªæå¤§å€¼ï¼Œè¿™æ ·è¿™äº›$p_i$â€‹åªå¯èƒ½åœ¨å¶å­èŠ‚ç‚¹äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e6</span> + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>, base = <span class="number">10000019</span>;</span><br><span class="line"><span class="type">int</span> n, p[N], d[N];</span><br><span class="line"><span class="type">int</span> st[N], ch[N][<span class="number">2</span>], rk[N], top, rnk;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> *a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) ch[i][<span class="number">0</span>] = ch[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, j; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    j = top;</span><br><span class="line">    <span class="keyword">while</span>(j &amp;&amp; a[st[j]]&gt;a[i]) j--;</span><br><span class="line">    <span class="keyword">if</span>(j) ch[st[j]][<span class="number">1</span>] = i;</span><br><span class="line">    <span class="keyword">if</span>(j&lt;top) ch[i][<span class="number">0</span>] = st[j+<span class="number">1</span>];</span><br><span class="line">    top = j;</span><br><span class="line">    st[++top] = i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> rt, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r || p[rt]==mod)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) rk[i] = rnk++;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(p[rt]%<span class="number">10</span>&gt;d[rt]) <span class="built_in">dfs</span>(ch[rt][<span class="number">1</span>], rt+<span class="number">1</span>, r), <span class="built_in">dfs</span>(ch[rt][<span class="number">0</span>], l, rt);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">dfs</span>(ch[rt][<span class="number">0</span>], l, rt), <span class="built_in">dfs</span>(ch[rt][<span class="number">1</span>], rt+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> pseed, pa, pb, pmod;</span><br><span class="line">  <span class="type">int</span> dseed, da, db, dmod;</span><br><span class="line">  rnk = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;pseed, &amp;pa, &amp;pb, &amp;pmod);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;dseed, &amp;da, &amp;db, &amp;dmod);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) p[i] = i;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">swap</span>(p[pseed%(i+<span class="number">1</span>)], p[i]);</span><br><span class="line">    pseed = (<span class="number">1ll</span>*pseed*pa + pb)%pmod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    d[i] = dseed%<span class="number">10</span>;</span><br><span class="line">    dseed = (<span class="number">1ll</span>*dseed*da + db)%dmod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="keyword">if</span>(d[i]==p[i]%<span class="number">10</span>) p[i] = mod;</span><br><span class="line">  <span class="built_in">build</span>(p);</span><br><span class="line">  <span class="type">int</span> rt = st[<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">dfs</span>(rt, <span class="number">0</span>, n);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>, pw = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    ans = (ans + <span class="number">1ll</span>*rk[i]*pw%mod)%mod;</span><br><span class="line">    pw = <span class="number">1ll</span>*pw*base%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢ç»ƒä¹ èµ›74</title>
      <link href="/2020/12/22/niu-ke-lian-xi-sai-74/"/>
      <url>/2020/12/22/niu-ke-lian-xi-sai-74/</url>
      
        <content type="html"><![CDATA[<p>ABCDéƒ½å¾ˆä¸€çœ¼</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>çœ‹åˆ°é¢˜ä¹Ÿæƒ³åˆ°æ€è·¯äº†ï¼Œç„¶è€Œå†™æ³•å¤æ‚äº†ï¼ŒåŠ ä¸Šå†™é”™ä¸€ä¸ªåœ°æ–¹ï¼Œå†åŠ ä¸Šå‡ºé¢˜äººæ•°æ®èŒƒå›´ä¸ç»™ä¸‹é™ï¼Œæ­£æ•´æ•°åŒ…å«0å¯è¿˜è¡Œï¼Œå†™äº†ä¸€ä¸ªå¤šå°æ—¶ç»™å®šä¸€ä¸ªè”é€šç®€å•æ— å‘å›¾ï¼Œå®šä¹‰ä¸€ç§æ“ä½œæ˜¯ï¼Œéšæœºé€‰æ‹©ä¸¤ä¸ªä¸åŒçš„ç‚¹ï¼Œå°†ä»–ä»¬ä¹‹é—´æœ€çŸ­è·¯å¾„ä¸Šçš„æ‰€æœ‰ç‚¹éƒ½å˜æˆé»‘è‰²ï¼Œé—®ä½ æ“ä½œkæ¬¡åé»‘è‰²ç‚¹çš„ä¸ªæ•°çš„æœŸæœ›$n \leq 500$æ€è·¯å¾ˆç®€å•ï¼Œè€ƒè™‘æ¯ä¸ªç‚¹å˜é»‘çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Œä¸€æ¬¡æ“ä½œå˜é»‘ï¼Œå°±æ˜¯æšä¸¾æœ‰å¤šå°‘å¯¹ç‚¹ï¼Œå®ƒä»¬ä¹‹é—´å­˜åœ¨ä¸€æ¡æœ€çŸ­è·¯ç»è¿‡è¯¥ç‚¹ã€‚ç„¶åè¿™é¢˜å°±æ²¡äº†å…ˆè·‘ä¸€éfloydï¼Œç„¶åæšä¸¾i,j,kï¼Œå¦‚æœ$d_{ik}+d_{kj}=d_{ij}$â€‹ï¼Œè¯´æ˜iå’Œjçš„æœ€çŸ­è·¯ä¸­æœ‰kæˆ‘å†™å¤æ‚äº†ï¼Œè€ƒè™‘ä»¥æ¯ä¸ªç‚¹ä¸ºæ ¹çš„æœ€çŸ­è·¯å¾„å›¾ï¼Œå›ºå®šé€‰æ ¹ï¼Œé‚£ä¹ˆè¦è®©ç¬¬iä¸ªç‚¹å˜é»‘ï¼Œå°±å¿…é¡»é€‰æ‹©ç¬¬iä¸ªç‚¹çš„åç»§å¯è¾¾ç‚¹ï¼ˆæœ€çŸ­è·¯å¾„å›¾æ˜¯ä¸ªDAGï¼Œæ‹“æ‰‘æ’åº+bitsetï¼Œå¤æ‚åº¦å…¶å®æœ‰ç‚¹ç‚¸ï¼Œä¸è¿‡é¢˜ç›®æ•°æ®wå­˜åœ¨0ï¼Œè¿™æ—¶å€™å°±ä¸æ˜¯DAGäº†ï¼Œè¿™åšæ³•å°±æŒ‚äº†ï¼‰å¦å¤–æˆ‘ç«Ÿç„¶åœ¨åˆå§‹åŒ–æ—¶å†™å‡º</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G[i][j] = (i^j)*inf</span><br></pre></td></tr></table></figure><p>æ²¡å¤šæƒ³æŠŠi!=jæ”¹æˆäº†i^jï¼Œè ¢äº†</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>ä¸€ä¸ªnä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œå¯¹å…¶æŸ“è‡³å¤šmç§é¢œè‰²ï¼Œå®šä¹‰ä¸€é¢—æ ‘æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“å­˜åœ¨ä¸€æ¡é“¾ä½¿å¾—ç«¯ç‚¹æ˜¯åŒè‰²ï¼Œä¸”é™¤ç«¯ç‚¹å¤–å­˜åœ¨ä¸€ä¸ªç‚¹ä¸ç«¯ç‚¹ä¸åŒè‰²ã€‚é—®æŸ“è‰²æ–¹æ¡ˆæ•°çš„æœŸæœ›ï¼ˆæ ‘çš„å½¢æ€ä»»æ„ï¼‰$n \leq 10^7, m \leq 10^7$å­˜åœ¨é—®é¢˜è½¬æˆåé—®é¢˜ï¼Œæ¯æ¡é“¾éƒ½ä¸åˆæ³•ï¼Œè¦ä¹ˆæ•´æ¡é“¾åŒè‰²ï¼Œè¦ä¹ˆéƒ½ä¸åŒè‰²ï¼Œ <s>ç„¶åå°±ä¸ä¼šäº†</s>æŒ‰ç…§dfsåºæ¥dp$dp_{ij}$â€‹è¡¨ç¤ºè€ƒè™‘åˆ°dfsåºä¸ºiçš„ç‚¹æ—¶ï¼Œå·²ç»æŸ“äº†jç§é¢œè‰²ï¼Œä¸”æ•´æ£µæ ‘ä¸åˆæ³•åˆ™$dp_{ij} = dp_{i-1j} + dp_{i-1j-1}(m-j+1)$è¦ä¹ˆå’Œçˆ¶äº²åŒè‰²ï¼Œè¦ä¹ˆé€‰æ‹©ä¸€ç§æ²¡å‡ºç°è¿‡çš„é¢œè‰²å®¹æ˜“å‘ç°æ‰€æœ‰å½¢æ€æ ‘çš„æŸ“è‰²æ–¹æ¡ˆæ ‘æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ç­”æ¡ˆç­‰ä»·äºæ±‚ä¸€æ£µæ ‘çš„æŸ“è‰²æ–¹æ¡ˆæ•°è€ƒè™‘è¿™ä¸ªå¼å­çš„ç»„åˆæ„ä¹‰ï¼Œå°±æ˜¯iä¸ªæœ‰æ ‡å·çƒï¼Œmä¸ªæœ‰æ ‡å·ç›’å­ï¼Œç„¶åæ”¾å…¥å…¶ä¸­çš„jä¸ªçš„æ–¹æ¡ˆæ•°å¯ä»¥ç›´æ¥æ±‚å‡ºæ¥æ˜¯$\binom{m}{j}\binom{i-1}{j-1}$ï¼Œå³å…ˆä»mä¸ªç›’å­é‡Œé€‰jä¸ªï¼Œç„¶åè¿™jä¸ªä»»æ„æ’åˆ—ï¼Œä¹‹åå°±æ˜¯ä¸ªéš”æ¿æ³•äº†æœ€åçš„ç­”æ¡ˆæ˜¯$m^n - \sum_{i=1}^m dp_{ni}$</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„æ¨¡æ¿æ•´åˆ</title>
      <link href="/2020/12/16/shu-ju-jie-gou-mo-ban-zheng-he/"/>
      <url>/2020/12/16/shu-ju-jie-gou-mo-ban-zheng-he/</url>
      
        <content type="html"><![CDATA[<h2 id="æ›¿ç½ªç¾Šæ ‘"><a class="header-anchor" href="#æ›¿ç½ªç¾Šæ ‘">Â¶</a>æ›¿ç½ªç¾Šæ ‘</h2><p>ç»´æŠ¤æƒå€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> alpha = <span class="number">0.7</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> val, sz, cnt;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + t[p].cnt; &#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bad</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; <span class="keyword">return</span> t[p].cnt &amp;&amp; t[p].sz*alpha&lt;<span class="built_in">max</span>(t[t[p].ls].sz, t[t[p].rs].sz); &#125;</span><br><span class="line"><span class="type">int</span> ord[N], top;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(t[p].ls);</span><br><span class="line">  <span class="keyword">if</span>(t[p].cnt) ord[++top] = p;</span><br><span class="line">  <span class="built_in">dfs</span>(t[p].rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, p = ord[mid];</span><br><span class="line">  t[p].ls = <span class="built_in">build</span>(l, mid<span class="number">-1</span>);</span><br><span class="line">  t[p].rs = <span class="built_in">build</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(p);</span><br><span class="line">  p = <span class="built_in">build</span>(<span class="number">1</span>, top);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  p = ++tot;</span><br><span class="line">  t[p].val = v, t[p].ls = t[p].rs = <span class="number">0</span>;</span><br><span class="line">  t[p].cnt = t[p].sz = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="built_in">newnode</span>(p, v);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==t[p].val) t[p].cnt++;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="built_in">ins</span>(t[p].ls, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">ins</span>(t[p].rs, v);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">bad</span>(p)) <span class="built_in">rebuild</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(v==t[p].val) t[p].cnt--;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="built_in">del</span>(t[p].ls, v);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">del</span>(t[p].rs, v);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">bad</span>(p)) <span class="built_in">rebuild</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Less</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v, <span class="type">bool</span> eq)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].cnt&amp;&amp;v==t[p].val) <span class="keyword">return</span> t[t[p].ls].sz + t[p].cnt*eq;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="keyword">return</span> <span class="built_in">Less</span>(t[p].ls, v, eq);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> t[t[p].ls].sz + t[p].cnt + <span class="built_in">Less</span>(t[p].rs, v, eq);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(t[t[p].ls].sz+t[p].cnt&gt;=k) <span class="keyword">return</span> t[p].val;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[p].cnt-t[t[p].ls].sz);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="fhq-treap"><a class="header-anchor" href="#fhq-treap">Â¶</a>fhq treap</h2><p>ç»´æŠ¤åŒºé—´çš„ï¼ˆæŒ‰sizeåˆ†è£‚ï¼‰ï¼Œå¸¦æœ‰upã€downä»¥åŠfaçš„ç»´æŠ¤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnd</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>|<span class="built_in">rand</span>(); &#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> fa, key, sz;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = ++tot;</span><br><span class="line">  t[p].ls = t[p].rs = t[p].fa = <span class="number">0</span>;</span><br><span class="line">  t[p].key = <span class="built_in">rnd</span>();</span><br><span class="line">  t[p].sz = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y, <span class="type">int</span> k, <span class="type">int</span> fx=<span class="number">0</span>, <span class="type">int</span> fy=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; x = y = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz)</span><br><span class="line">  &#123;</span><br><span class="line">    y = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].ls, x, t[p].ls, k, fx, p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    x = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].rs, t[p].rs, y, k-t[t[p].ls].sz<span class="number">-1</span>, p, fy);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(x) t[x].fa = fx;</span><br><span class="line">  <span class="keyword">if</span>(y) t[y].fa = fy;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) &#123; p = x|y; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[x].key&lt;t[y].key)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">down</span>(x);</span><br><span class="line">    p = x;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].rs, t[p].rs, y);</span><br><span class="line">    t[t[p].rs].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">down</span>(y);</span><br><span class="line">    p = y;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].ls, x, t[p].ls);</span><br><span class="line">    t[t[p].ls].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">downall</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">downall</span>(t[p].fa);</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">downall</span>(p);</span><br><span class="line">  <span class="type">int</span> rk = t[t[p].ls].sz + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(t[p].fa)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(t[t[p].fa].rs==p) rk += t[t[p].fa].sz - t[p].sz;</span><br><span class="line">    p = t[p].fa;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> rk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(k==t[t[p].ls].sz+<span class="number">1</span>) <span class="keyword">return</span> t[p].c;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[t[p].ls].sz<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="splay"><a class="header-anchor" href="#splay">Â¶</a>splay</h2><p>ç»´æŠ¤åŒºé—´ï¼Œæ³¨æ„åŠæ—¶upï¼Œåªéœ€è¦åœ¨kthä¸­downå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> rt;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], fa[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> l = ch[p][<span class="number">0</span>], r = ch[p][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> p = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  sz[p] = <span class="number">1</span>, fa[p] = f, ch[f][p&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">build</span>(l, p<span class="number">-1</span>, p); <span class="built_in">build</span>(p+<span class="number">1</span>, r, p);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">split</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, r+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="keyword">return</span> ch[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LCT"><a class="header-anchor" href="#LCT">Â¶</a>LCT</h2><p>ç»´æŠ¤è¾¹æƒï¼šæ‹†ç‚¹ç»´æŠ¤è¾¹åŒï¼šæ¯æ¬¡åŠ è¾¹ï¼Œå¦‚æœä¸¤ç«¯ç‚¹å·²ç»è¿é€šï¼Œåˆ™ç”¨å¹¶æŸ¥é›†ç¼©èµ·æ¥ï¼Œç„¶ååœ¨accessçš„æ—¶å€™ï¼Œx=fa[x]=find(fa[x])</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], fa[N], rev[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">notrt</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">0</span>]==x || ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">  rev[x] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(rev[x])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(ch[x][<span class="number">0</span>]) <span class="built_in">reverse</span>(ch[x][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span>(ch[x][<span class="number">1</span>]) <span class="built_in">reverse</span>(ch[x][<span class="number">1</span>]);</span><br><span class="line">    rev[x] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">notrt</span>(x)) <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">  <span class="built_in">down</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">notrt</span>(y)) ch[z][ch[z][<span class="number">1</span>]==y] = x;</span><br><span class="line">    ch[y][k] = ch[x][!k]; fa[ch[x][!k]] = y;</span><br><span class="line">    ch[x][!k] = y, fa[y] = x, fa[x] = z;</span><br><span class="line">    <span class="built_in">up</span>(y), <span class="built_in">up</span>(x), <span class="built_in">up</span>(z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">pushall</span>(x);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> f=fa[x]; f=fa[x], <span class="built_in">notrt</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">notrt</span>(f)) <span class="built_in">rotate</span>(<span class="built_in">rs</span>(x) == <span class="built_in">rs</span>(f) ? f : x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> y=<span class="number">0</span>; x; y=x, x=fa[x])</span><br><span class="line">    <span class="built_in">splay</span>(x), ch[x][<span class="number">1</span>] = y, <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">makert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">access</span>(x); <span class="built_in">splay</span>(x);</span><br><span class="line">  <span class="built_in">reverse</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">findrt</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">access</span>(x); <span class="built_in">splay</span>(x);</span><br><span class="line">  <span class="keyword">while</span>(ch[x][<span class="number">0</span>]) <span class="built_in">down</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">splay</span>(x);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">makert</span>(x);</span><br><span class="line">  <span class="built_in">access</span>(y); <span class="built_in">splay</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">makert</span>(x);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">findrt</span>(y)!=x) fa[x] = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">makert</span>(x);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">findrt</span>(y)==x&amp;&amp;fa[y]==x&amp;&amp;!ch[y][<span class="number">0</span>])</span><br><span class="line">  &#123;</span><br><span class="line">    fa[y] = ch[x][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">up</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å“ˆå¸Œè¡¨"><a class="header-anchor" href="#å“ˆå¸Œè¡¨">Â¶</a>å“ˆå¸Œè¡¨</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">2174729</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HashTable</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span> &#123; <span class="type">int</span> next, v; ull k; &#125;e[M+<span class="number">5</span>];</span><br><span class="line">  <span class="type">int</span> head[M], st[N], tp, sz;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(ull k)</span> </span>&#123; <span class="keyword">return</span> k % M; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; sz = <span class="number">0</span>; <span class="keyword">while</span>(tp) head[st[tp--]] = <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(ull k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">f</span>(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> p = head[t]; p; p = e[p].next)</span><br><span class="line">      <span class="keyword">if</span>(e[p].k==k) <span class="keyword">return</span> e[p].v;</span><br><span class="line">    ++sz;</span><br><span class="line">    e[sz] = &#123;head[t], sz, k&#125;;</span><br><span class="line">    head[t] = sz; st[++tp] = t;</span><br><span class="line">    <span class="keyword">return</span> sz;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å“ˆå¸Œset"><a class="header-anchor" href="#å“ˆå¸Œset">Â¶</a>å“ˆå¸Œset</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">HashSet</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span> &#123; <span class="type">int</span> next; ull k; &#125;e[M+<span class="number">5</span>];</span><br><span class="line">  <span class="type">int</span> head[M], st[N], tp, sz;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(ull k)</span> </span>&#123; <span class="keyword">return</span> k % M; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; sz = <span class="number">0</span>; <span class="keyword">while</span>(tp) head[st[tp--]] = <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">get</span><span class="params">(ull k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> p = head[<span class="built_in">f</span>(k)]; p; p = e[p].next)</span><br><span class="line">      <span class="keyword">if</span>(e[p].k==k) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(ull k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">get</span>(k)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">f</span>(k);</span><br><span class="line">    e[++sz] = &#123;head[t], k&#125;;</span><br><span class="line">    head[t] = sz; st[++tp] = t;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="gp-hash"><a class="header-anchor" href="#gp-hash">Â¶</a>gp_hash</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">custom_hash</span> &#123;</span><br><span class="line">  <span class="function"><span class="type">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">uint64_t</span> x)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">uint64_t</span> FIXED_RANDOM = chrono::steady_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>();</span><br><span class="line">    <span class="keyword">return</span> x + FIXED_RANDOM;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">custom_hash</span> &#123;</span><br><span class="line">  <span class="function"><span class="type">static</span> <span class="type">uint64_t</span> <span class="title">splitmix64</span><span class="params">(<span class="type">uint64_t</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// http://xorshift.di.unimi.it/splitmix64.c</span></span><br><span class="line">    x += <span class="number">0x9e3779b97f4a7c15</span>;</span><br><span class="line">    x = (x ^ (x &gt;&gt; <span class="number">30</span>)) * <span class="number">0xbf58476d1ce4e5b9</span>;</span><br><span class="line">    x = (x ^ (x &gt;&gt; <span class="number">27</span>)) * <span class="number">0x94d049bb133111eb</span>;</span><br><span class="line">    <span class="keyword">return</span> x ^ (x &gt;&gt; <span class="number">31</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">uint64_t</span> x)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">uint64_t</span> FIXED_RANDOM = chrono::steady_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">splitmix64</span>(x + FIXED_RANDOM);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">int</span>, custom_hash&gt;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">bool</span>&gt;</span><br><span class="line">gp_hash_table&lt;ull, null_type&gt;</span><br></pre></td></tr></table></figure><h2 id="bitsetå‹ä½-64ä½å’Œ32ä½é€Ÿåº¦å·®ä¸å¤š"><a class="header-anchor" href="#bitsetå‹ä½-64ä½å’Œ32ä½é€Ÿåº¦å·®ä¸å¤š">Â¶</a>bitsetå‹ä½(64ä½å’Œ32ä½é€Ÿåº¦å·®ä¸å¤š)</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Bitset</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">using</span> uint = <span class="type">uint32_t</span>;</span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> B = <span class="number">32</span>;</span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> uint up = numeric_limits&lt;uint&gt;::<span class="built_in">max</span>();</span><br><span class="line">  vector&lt;uint&gt; b; <span class="type">int</span> sz;</span><br><span class="line">  <span class="built_in">Bitset</span>(<span class="type">int</span> _sz=<span class="number">0</span>) &#123; sz = _sz; b.<span class="built_in">resize</span>((sz+B<span class="number">-1</span>)/B, <span class="number">0</span>); &#125;</span><br><span class="line">  Bitset <span class="keyword">operator</span> | (<span class="type">const</span> Bitset &amp;oth) <span class="type">const</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="function">Bitset <span class="title">res</span><span class="params">(sz)</span></span>;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i+<span class="number">3</span>&lt;(<span class="type">int</span>)b.<span class="built_in">size</span>(); i+=<span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      res.b[i] = b[i] | oth.b[i];</span><br><span class="line">      res.b[i+<span class="number">1</span>] = b[i+<span class="number">1</span>] | oth.b[i+<span class="number">1</span>];</span><br><span class="line">      res.b[i+<span class="number">2</span>] = b[i+<span class="number">2</span>] | oth.b[i+<span class="number">2</span>];</span><br><span class="line">      res.b[i+<span class="number">3</span>] = b[i+<span class="number">3</span>] | oth.b[i+<span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;(<span class="type">int</span>)b.<span class="built_in">size</span>())</span><br><span class="line">      res.b[i] = b[i] | oth.b[i], i++;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">set</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; b[p/B] |= (<span class="number">1ull</span>&lt;&lt;(p%B)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; b[p/B] &amp;= (up^(<span class="number">1ull</span>&lt;&lt;(p%B))); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span> </span>&#123; (v ? <span class="built_in">set</span>(p) : <span class="built_in">reset</span>(p)); &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">get</span><span class="params">(uint x, <span class="type">int</span> bit)</span> </span>&#123; <span class="keyword">return</span> (x&gt;&gt;bit)&amp;<span class="number">1</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getf0</span><span class="params">(uint x)</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;B; i++) <span class="keyword">if</span>(!<span class="built_in">get</span>(x, i)) <span class="keyword">return</span> i; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getf1</span><span class="params">(uint x)</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;B; i++) <span class="keyword">if</span>(<span class="built_in">get</span>(x, i)) <span class="keyword">return</span> i; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getl0</span><span class="params">(uint x)</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=B<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) <span class="keyword">if</span>(!<span class="built_in">get</span>(x, i)) <span class="keyword">return</span> i; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getl1</span><span class="params">(uint x)</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=B<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) <span class="keyword">if</span>(<span class="built_in">get</span>(x, i)) <span class="keyword">return</span> i; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findr0</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = x/B, q = x%B;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=q; i&lt;B; i++) <span class="keyword">if</span>(!<span class="built_in">get</span>(b[p], i)) <span class="keyword">return</span> x+i-q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>; i&lt;(<span class="type">int</span>)b.<span class="built_in">size</span>(); i++)</span><br><span class="line">      <span class="keyword">if</span>(b[i]!=up) <span class="keyword">return</span> x+B<span class="number">-1</span>-q+(i-p<span class="number">-1</span>)*B+<span class="built_in">getf0</span>(b[i])+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> sz + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findr1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = x/B, q = x%B;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=q; i&lt;B; i++) <span class="keyword">if</span>(<span class="built_in">get</span>(b[p], i)) <span class="keyword">return</span> x+i-q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>; i&lt;(<span class="type">int</span>)b.<span class="built_in">size</span>(); i++)</span><br><span class="line">      <span class="keyword">if</span>(b[i]) <span class="keyword">return</span> x+B<span class="number">-1</span>-q+(i-p<span class="number">-1</span>)*B+<span class="built_in">getf1</span>(b[i])+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> sz + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findl0</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = x/B, q = x%B;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=q; i&gt;=<span class="number">0</span>; i--) <span class="keyword">if</span>(!<span class="built_in">get</span>(b[p], i)) <span class="keyword">return</span> x+i-q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">      <span class="keyword">if</span>(b[i]!=up) <span class="keyword">return</span> x-q-(p<span class="number">-1</span>-i)*B-(B-<span class="built_in">getl0</span>(b[i]));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findl1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = x/B, q = x%B;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=q; i&gt;=<span class="number">0</span>; i--) <span class="keyword">if</span>(<span class="built_in">get</span>(b[p], i)) <span class="keyword">return</span> x+i-q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">      <span class="keyword">if</span>(b[i]) <span class="keyword">return</span> x-q-(p<span class="number">-1</span>-i)*B-(B-<span class="built_in">getl1</span>(b[i]));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Honorable Mention å¹³è¡¡æ ‘+æ ‘çŠ¶æ•°ç»„</title>
      <link href="/2020/12/13/honorable-mention-ping-heng-shu-shu-zhuang-shu-zu/"/>
      <url>/2020/12/13/honorable-mention-ping-heng-shu-shu-zhuang-shu-zu/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ’åˆ—$p_i$â€‹ï¼Œè¡¨ç¤ºç¬¬iä¸ªäººçš„æ’åï¼Œè¦æ±‚æ”¯æŒä¸¤ç§æ“ä½œï¼š</p><ul><li>ç¬¬xä¸ªäººçš„æ’åä¸Šå‡åˆ°yï¼Œæ˜¾ç„¶åŸæ¥y$\sim$rank(x)-1çš„äººçš„æ’åå°±è¦ä¸‹é™1</li><li>é—®ç¬¬xåˆ°ç¬¬yä¸ªäººä¸­æœ‰å¤šå°‘äººçš„æ’ååœ¨å40%</li></ul><p>æˆ‘ä»¬å‘ç°ç¬¬ä¸€ä¸ªæ“ä½œéœ€è¦ä»¥æ’åä¸ºä¸‹æ ‡è¿›è¡Œç»´æŠ¤ï¼Œè€Œç¬¬äºŒä¸ªæ“ä½œåˆéœ€è¦ä»¥ç¼–å·ä¸ºä¸‹æ ‡è¿›è¡Œç»´æŠ¤ã€‚ä¼¼ä¹ä¸å¤ªå¯åšã€‚ä½†æ˜¯ä»”ç»†æƒ³æƒ³ï¼Œå¯¹äºå40%ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒè°åœ¨å‰è°åœ¨åï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“å“ªäº›äººæ˜¯åœ¨å40%é‚£ä¹ˆç”¨ä¸€ä¸ªæ ‘çŠ¶æ•°ç»„ï¼Œä»¥ç¼–å·ä¸ºä¸‹æ ‡ç»´æŠ¤å“ªäº›äººæ˜¯å40%ç„¶åç”¨ä¸€ä¸ªå¹³è¡¡æ ‘ï¼Œä»¥æ’åä¸ºä¸‹æ ‡æ¥ç»´æŠ¤ç¬¬ä¸€ä¸ªæ“ä½œã€‚å½“xçš„æ’ååŸå…ˆåœ¨å40%ï¼Œç„¶åæå‡åä¸å†å40%ï¼Œå°±éœ€è¦å¯¹æ ‘çŠ¶æ•°ç»„çš„x-1ï¼Œç„¶åå¯¹åŸæ¥æ’å40%çš„é‚£ä¸ªåœ¨æ ‘çŠ¶æ•°ç»„ä¸­+1ã€‚ç„¶ååªéœ€è¦å°†xè¿™ä¸ªèŠ‚ç‚¹åˆ æ‰ï¼Œå†æ’åˆ°æ’åä¸ºyèŠ‚ç‚¹çš„å‰é¢å°±å¯ä»¥äº†ã€‚è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œxçš„æ’åæ€ä¹ˆæ±‚ï¼Œæˆ‘ä»¬ä»¥æ’åä¸ºä¸‹æ ‡æ€ä¹ˆæ±‚æ’åå‘¢ã€‚å®¹æ˜“å‘ç°å¯¹äºæ¯ä¸ªç¼–å·åœ¨å¹³è¡¡æ ‘ä¸­çš„èŠ‚ç‚¹æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨æ•°ç»„ä¿å­˜xæ˜¯å¹³è¡¡æ ‘ä¸­çš„å“ªä¸ªèŠ‚ç‚¹ï¼Œç„¶åæŠŠå®ƒsplayåˆ°æ ¹ï¼Œåˆ™å·¦å„¿å­çš„size+1å°±æ˜¯æ’åäº†ã€‚æœ€åä¸è¦å¿˜è®°åœ¨splayä¸­å‰åå„æ’å…¥ä¸€ä¸ªå“¨å…µï¼ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, q, p[N], rp[N];</span><br><span class="line"><span class="type">int</span> c[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) c[i] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += c[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> rt;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], val[N], fa[N], id[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; <span class="keyword">if</span>(p) sz[p] = sz[ch[p][<span class="number">0</span>]] + sz[ch[p][<span class="number">1</span>]] + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bld</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> p = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  sz[p] = <span class="number">1</span>;</span><br><span class="line">  ch[p][<span class="number">0</span>] = ch[p][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(p&gt;=<span class="number">2</span>&amp;&amp;p&lt;=n+<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    val[p] = rp[p<span class="number">-1</span>];</span><br><span class="line">    id[rp[p<span class="number">-1</span>]] = p;</span><br><span class="line">  &#125;</span><br><span class="line">  fa[p] = f, ch[f][p&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">bld</span>(l, p<span class="number">-1</span>, p); <span class="built_in">bld</span>(p+<span class="number">1</span>, r, p);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnk</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">splay</span>(p);</span><br><span class="line">  <span class="keyword">return</span> sz[ch[p][<span class="number">0</span>]] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, l+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="type">int</span> z = ch[y][<span class="number">0</span>];</span><br><span class="line">  ch[y][<span class="number">0</span>] = <span class="number">0</span>; fa[z] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">  <span class="type">int</span> x2 = <span class="built_in">kth</span>(rt, r<span class="number">-1</span>), y2 = <span class="built_in">kth</span>(rt, r);</span><br><span class="line">  <span class="built_in">splay</span>(x2); <span class="built_in">splay</span>(y2, x2);</span><br><span class="line">  ch[y2][<span class="number">0</span>] = z; fa[z] = y2;</span><br><span class="line">  <span class="built_in">up</span>(y2); <span class="built_in">up</span>(fa[y2]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, p+i);</span><br><span class="line">    rp[p[i]] = i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">  <span class="type">int</span> lim = n*<span class="number">0.6</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) c[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=lim+<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">upd</span>(rp[i], <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">bld</span>(<span class="number">1</span>, n+<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  rt = (n+<span class="number">3</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(y&lt;=lim)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> rkx = <span class="built_in">rnk</span>(id[x]) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(rkx&gt;lim)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">upd</span>(x, <span class="number">-1</span>);</span><br><span class="line">          <span class="built_in">upd</span>(val[<span class="built_in">kth</span>(rt, lim+<span class="number">1</span>)], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">ins</span>(rkx+<span class="number">1</span>, y+<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">ask</span>(y)-<span class="built_in">ask</span>(x<span class="number">-1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rope å—çŠ¶é“¾è¡¨å®ç°çš„STLå®¹å™¨</title>
      <link href="/2020/12/13/rope-kuai-zhuang-lian-biao-shi-xian-de-stl-rong-qi/"/>
      <url>/2020/12/13/rope-kuai-zhuang-lian-biao-shi-xian-de-stl-rong-qi/</url>
      
        <content type="html"><![CDATA[<p>crope = ropeï¼ˆå¯ä»¥ç›´æ¥cin coutï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¾ƒå¿«é€Ÿçš„è§£å†³åŒºé—´ç§»åŠ¨ã€åŒºé—´æ’å…¥åˆ é™¤ã€åŒºé—´ç¿»è½¬é—®é¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rp.<span class="built_in">push_back</span>(x); <span class="comment">// åœ¨æœ«å°¾æ’å…¥ x</span></span><br><span class="line">rp.<span class="built_in">insert</span>(pos, x); <span class="comment">// ä»pos å¤„æ’å…¥ä¸€ä¸ªæ•°ç»„x</span></span><br><span class="line">rp.<span class="built_in">erase</span>(pos, x); <span class="comment">// ä»pos å¤„åˆ é™¤ x ä¸ªå…ƒç´ </span></span><br><span class="line">rp.<span class="built_in">length</span>(); <span class="comment">// è¿”å› rp çš„å¤§å°</span></span><br><span class="line">rp.<span class="built_in">size</span>(); <span class="comment">// åŒä¸Š</span></span><br><span class="line">rp.<span class="built_in">replace</span>(pos, x); <span class="comment">// å°† pos å¤„çš„å…ƒç´ æ›¿æ¢æˆ x</span></span><br><span class="line">rp.<span class="built_in">substr</span>(pos, x); <span class="comment">// ä» pos å¤„å¼€å§‹æå– x ä¸ªå…ƒç´ </span></span><br><span class="line">rp.<span class="built_in">copy</span>(pos, x, s); <span class="comment">// ä» pos å¤„å¼€å§‹å¤åˆ¶ x ä¸ªå…ƒç´ åˆ° s(string or char*(æœ«å°¾è¦æ‰‹åŠ¨åŠ 0)) ä¸­</span></span><br><span class="line">rp[x]; <span class="comment">// è®¿é—®ç¬¬ x ä¸ªå…ƒç´ </span></span><br><span class="line">rp.<span class="built_in">at</span>(x); <span class="comment">// åŒä¸Š</span></span><br><span class="line"><span class="keyword">operator</span>.+() <span class="comment">//æ‹¼æ¥æ“ä½œï¼Œå¾ˆå¿«é€Ÿ</span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line">rope&lt;<span class="type">int</span>&gt;s;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n,m,k,l;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)s.<span class="built_in">push_back</span>(i);</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;l,&amp;k);</span><br><span class="line">    s=s.<span class="built_in">substr</span>(l<span class="number">-1</span>,k)+s.<span class="built_in">substr</span>(<span class="number">0</span>,l<span class="number">-1</span>)+s.<span class="built_in">substr</span>(l+k<span class="number">-1</span>,n+<span class="number">1</span>-k-l);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> c:s)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,c);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line">rope&lt;<span class="type">int</span>&gt;a;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">int</span> n,m,x,y;</span><br><span class="line">  cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    a.<span class="built_in">push_back</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">    cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">    a.<span class="built_in">insert</span>(<span class="number">0</span>,a.<span class="built_in">substr</span>(x<span class="number">-1</span>,y));</span><br><span class="line">    a.<span class="built_in">erase</span>(x+y<span class="number">-1</span>,y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span><br><span class="line">      cout&lt;&lt;a[i];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      cout&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;a[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cã€Shuffle Cards åŒºé—´ç§»ä½ splay</title>
      <link href="/2020/12/12/cshuffle-cards-qu-jian-yi-wei-splay/"/>
      <url>/2020/12/12/cshuffle-cards-qu-jian-yi-wei-splay/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ä¸ªåºåˆ—åˆå§‹ä¸º1-nçš„æ’åˆ—ï¼Œç°åœ¨æœ‰mæ¬¡æ“ä½œï¼Œå°†ä¸€ä¸ªåŒºé—´ç§»åˆ°æœ€å‰é¢ã€‚é—®æ‰€æœ‰æ“ä½œç»“æŸåçš„åºåˆ—æ˜¯ä»€ä¹ˆ</p><p>çªç„¶å‘ç°æ²¡æœ‰å†™è¿‡åŒºé—´å¹³ç§»çš„é—®é¢˜ï¼Œç„¶åå»æ‰¾äº†ä¸€é“ï¼Œç„¶åå°±è°ƒäº†2å°æ—¶ï¼Œå¾ˆéš¾å—ã€‚</p><p>ç½—åˆ—ä¸€ä¸‹å‡ ä¸ªæ˜“é”™ç‚¹ï¼špushupçš„æ—¶å€™æœ€å¥½ç‰¹åˆ¤ä¸€ä¸‹p==0ï¼Œè¿™æ—¶å€™å°±ç›´æ¥returnï¼Œå¦åˆ™æ€»æ„Ÿè§‰å®¹æ˜“å‡ºé—®é¢˜splayä¸€ä¸ªä¸å¥½çš„åœ°æ–¹å°±æ˜¯è¦åŠ å“¨å…µï¼Œåæ­£å·¦åå„åŠ ä¸€ä¸ªå°±å®Œäº‹äº†å·æ‡’æŠŠå–åŒºé—´å†™äº†ä¸ªsplitï¼Œç„¶åå°±å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼ˆbugæ ¹æºï¼‰å½“è¦æå–çš„åŒºé—´æ˜¯ä¸€ä¸ªç©ºåŒºé—´å°±ä¼šå‡ºç°å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼ˆæ’å…¥å’Œåˆ é™¤çš„æ—¶å€™éœ€è¦ï¼‰ï¼Œå› ä¸ºè¿™æ—¶å€™å®ƒä¼šè¿”å›0ï¼Œæˆ‘å°±æ²¡åŠæ³•ç»´æŠ¤æˆ‘æœ¬æ¥éœ€è¦çš„è¿”å›èŠ‚ç‚¹çš„çˆ¶äº²äº†ã€‚æ‰€ä»¥æœ€å¥½è¿˜æ˜¯ä¸è¦å†™splitå‡½æ•°äº†ğŸ˜­</p><p>è¯´ä¸€ä¸‹åŒºé—´å¹³ç§»æ€ä¹ˆåšå…¶å®å°±æ˜¯åŒºé—´æ’å…¥é—®é¢˜ï¼Œå…ˆæŠŠä¸€ä¸ªåŒºé—´æå–å‡ºæ¥ï¼ŒæŠŠè¿™ä¸ªåŒºé—´åˆ é™¤æ‰ï¼Œç„¶åå‡è®¾è¿™ä¸ªèŠ‚ç‚¹è¦æ’å…¥åˆ°pï¼ˆè¦æ³¨æ„å‰é¢è¿™ä¸ªåŒºé—´åˆ é™¤å¸¦æ¥çš„å½±å“ï¼‰èŠ‚ç‚¹çš„åé¢ï¼Œé‚£å°±æŠŠpè½¬åˆ°æ ¹ï¼Œp+1è½¬åˆ°pçš„å„¿å­ï¼Œåˆ™æŠŠåˆšæ‰æå–çš„åŒºé—´æ’åˆ°p+1çš„å·¦å„¿å­å°±å¯ä»¥äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> rt;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], fa[N], val[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">if</span>(!x) <span class="keyword">return</span>; sz[x] = sz[ch[x][<span class="number">0</span>]] + sz[ch[x][<span class="number">1</span>]] + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> p = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  sz[p] = <span class="number">1</span>, fa[p] = f, val[p] = p;</span><br><span class="line">  ch[f][p&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">build</span>(l, p<span class="number">-1</span>, p), <span class="built_in">build</span>(p+<span class="number">1</span>, r, p);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">go</span>(ch[p][<span class="number">0</span>]);</span><br><span class="line">  <span class="keyword">if</span>(val[p]&gt;=<span class="number">2</span> &amp;&amp; val[p]&lt;=n+<span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, val[p]<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">go</span>(ch[p][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, n+<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  rt = (n+<span class="number">3</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">    ++a;</span><br><span class="line">    <span class="type">int</span> x = <span class="built_in">kth</span>(rt, <span class="number">1</span>), y = <span class="built_in">kth</span>(rt, a);</span><br><span class="line">    <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">    <span class="type">int</span> z = ch[y][<span class="number">0</span>];</span><br><span class="line">    fa[z] = <span class="number">0</span>;</span><br><span class="line">    ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">    <span class="type">int</span> tx = <span class="built_in">kth</span>(rt, b+<span class="number">1</span>), ty = <span class="built_in">kth</span>(rt, b+<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">splay</span>(tx); <span class="built_in">splay</span>(ty, tx);</span><br><span class="line">    ch[ty][<span class="number">0</span>] = z;</span><br><span class="line">    fa[z] = ty;</span><br><span class="line">    <span class="built_in">up</span>(ty); <span class="built_in">up</span>(fa[ty]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">go</span>(rt);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P2042 [NOI2005]ç»´æŠ¤æ•°åˆ—</title>
      <link href="/2020/12/11/p2042-noi2005wei-hu-shu-lie/"/>
      <url>/2020/12/11/p2042-noi2005wei-hu-shu-lie/</url>
      
        <content type="html"><![CDATA[<p>å¤§æ¯’ç˜¤é¢˜åŒºé—´æ’å…¥ï¼ŒåŒºé—´åˆ é™¤ï¼ŒåŒºé—´è¦†ç›–ï¼ŒåŒºé—´ç¿»è½¬ï¼ŒåŒºé—´å’Œï¼ŒåŒºé—´æœ€å¤§å­æ®µå’Œ</p><p>åªè¯´ä¸€ä¸‹splayçš„è¯ï¼ŒåŒºé—´æ’å…¥å’Œåˆ é™¤æ€ä¹ˆåšæ’å…¥ï¼šå…ˆæŠŠæ’å…¥çš„æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§ä¸­åºéå†å»ºæˆä¸€æ£µå¹³è¡¡æ ‘ï¼Œç„¶åæŠŠlè½¬åˆ°æ ¹ï¼Œl+1è½¬åˆ°lçš„å„¿å­ï¼Œé‚£ä¹ˆç›´æ¥æŠŠè¿™é¢—å¹³è¡¡æ ‘çš„æ ¹ä½œä¸ºl+1çš„å·¦å„¿å­å³å¯åˆ é™¤ï¼šåŒæ ·çš„ï¼ŒæŠŠl-1è½¬åˆ°æ ¹ï¼Œr+1è½¬åˆ°l-1çš„å„¿å­ï¼Œç„¶åç›´æ¥æŠŠrçš„å·¦å„¿å­å˜æˆ0å³å¯ã€‚è¿™é“é¢˜æ“ä½œæ¯”è¾ƒå¤šï¼Œéœ€è¦è€ƒè™‘ç©ºé—´å›æ”¶ã€‚å¾ˆç®€å•ï¼Œåªè¦æŠŠè¿™è¯¾ä¸¢æ‰çš„æ ‘éå†ä¸€ä¸‹æ¯ä¸ªèŠ‚ç‚¹çš„ç¼–å·å¡åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶åæ¯æ¬¡æ–°å¼€èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå¦‚æœæ•°ç»„ä¸­æœ‰ç¼–å·å°±ç›´æ¥å–ä¸€ä¸ªï¼Œå¦åˆ™å†æ–°å¼€èŠ‚ç‚¹ï¼Œä¸è¿‡å¤ç”¨èŠ‚ç‚¹è¦æ³¨æ„ä¿¡æ¯çš„æ¸…ç©ºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e6</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="type">int</span> n, m, a[N], id[N];</span><br><span class="line"><span class="type">int</span> buc[N], tp;</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (tp ? buc[tp--] : ++tot); &#125;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], val[N], sum[N], mx[N], lx[N], rx[N], fa[N];</span><br><span class="line"><span class="type">bool</span> same[N], rev[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> l = ch[p][<span class="number">0</span>], r = ch[p][<span class="number">1</span>];</span><br><span class="line">  sum[p] = sum[l] + sum[r] + val[p];</span><br><span class="line">  sz[p] = sz[l] + sz[r] + <span class="number">1</span>;</span><br><span class="line">  mx[p] = <span class="built_in">max</span>(&#123;mx[l], mx[r], rx[l]+lx[r]+val[p]&#125;);</span><br><span class="line">  lx[p] = <span class="built_in">max</span>(lx[l], sum[l]+val[p]+lx[r]);</span><br><span class="line">  rx[p] = <span class="built_in">max</span>(rx[r], sum[r]+val[p]+rx[l]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  val[p] = v, sum[p] = v*sz[p];</span><br><span class="line">  lx[p] = rx[p] = (sum[p]&gt;<span class="number">0</span> ? sum[p] : <span class="number">0</span>);</span><br><span class="line">  mx[p] = (sum[p]&gt;<span class="number">0</span> ? sum[p] : val[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setrev</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">swap</span>(ch[p][<span class="number">0</span>], ch[p][<span class="number">1</span>]);</span><br><span class="line">  <span class="built_in">swap</span>(lx[p], rx[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = ch[p][<span class="number">0</span>], r = ch[p][<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span>(same[p])</span><br><span class="line">  &#123;</span><br><span class="line">    same[l] = <span class="number">1</span>, <span class="built_in">setv</span>(l, val[p]);</span><br><span class="line">    same[r] = <span class="number">1</span>, <span class="built_in">setv</span>(r, val[p]);</span><br><span class="line">    same[p] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(rev[p])</span><br><span class="line">  &#123;</span><br><span class="line">    rev[l] ^= <span class="number">1</span>, <span class="built_in">setrev</span>(l);</span><br><span class="line">    rev[r] ^= <span class="number">1</span>, <span class="built_in">setrev</span>(r);</span><br><span class="line">    rev[p] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x], z = fa[y];</span><br><span class="line">    <span class="keyword">if</span>(z!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">split</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, r+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="keyword">return</span> ch[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">makesame</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setv</span>(x, v), same[x] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setrev</span>(x), rev[x] ^= <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rec</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> l = ch[x][<span class="number">0</span>], r = ch[x][<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">rec</span>(l); <span class="built_in">rec</span>(r);</span><br><span class="line">  buc[++tp] = x;</span><br><span class="line">  fa[x] = ch[x][<span class="number">0</span>] = ch[x][<span class="number">1</span>] = <span class="number">0</span>, rev[x] = same[x] = <span class="number">0</span>;</span><br><span class="line">  sz[x] = val[x] = sum[x] = mx[x] = lx[x] = rx[x] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">rec</span>(ch[y][<span class="number">0</span>]); ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bld</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, p = id[mid];</span><br><span class="line">  val[p] = a[mid];</span><br><span class="line">  <span class="keyword">if</span>(f) fa[p] = id[f], ch[id[f]][mid&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    mx[p] = sum[p] = a[l];</span><br><span class="line">    same[p] = rev[p] = <span class="number">0</span>;</span><br><span class="line">    lx[p] = rx[p] = <span class="built_in">max</span>(a[l], <span class="number">0</span>);</span><br><span class="line">    sz[p] = <span class="number">1</span>;</span><br><span class="line">    ch[p][<span class="number">0</span>] = ch[p][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">bld</span>(l, mid<span class="number">-1</span>, mid);</span><br><span class="line">  <span class="built_in">bld</span>(mid+<span class="number">1</span>, r, mid);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=r-l+<span class="number">1</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    id[i] = <span class="built_in">newnode</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">bld</span>(<span class="number">1</span>, r-l+<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l), y = <span class="built_in">kth</span>(rt, l+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="type">int</span> z = id[(r-l+<span class="number">2</span>)&gt;&gt;<span class="number">1</span>];</span><br><span class="line">  fa[z] = y, ch[y][<span class="number">0</span>] = z;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  mx[<span class="number">0</span>] = -inf, a[<span class="number">1</span>] = -inf, a[n+<span class="number">2</span>] = inf;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i+<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n+<span class="number">2</span>; i++) id[i] = <span class="built_in">newnode</span>();</span><br><span class="line">  <span class="built_in">bld</span>(<span class="number">1</span>, n+<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  rt = (n+<span class="number">3</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> com[<span class="number">10</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, com);</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]!=<span class="string">&#x27;M&#x27;</span>||com[<span class="number">2</span>]!=<span class="string">&#x27;X&#x27;</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    ++l, r = l + r - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;I&#x27;</span>) <span class="built_in">ins</span>(l, r);</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>) <span class="built_in">del</span>(l, r);</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;M&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(com[<span class="number">2</span>]==<span class="string">&#x27;X&#x27;</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, mx[<span class="built_in">split</span>(<span class="number">2</span>, sz[rt]<span class="number">-1</span>)]);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">        <span class="built_in">makesame</span>(l, r, v);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) <span class="built_in">reverse</span>(l, r);</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;G&#x27;</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum[<span class="built_in">split</span>(l, r)]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P3215 [HNOI2011]æ‹¬å·ä¿®å¤ / [JSOI2011]æ‹¬å·åºåˆ—</title>
      <link href="/2020/12/11/p3215-hnoi2011gua-hao-xiu-fu-jsoi2011gua-hao-xu-lie/"/>
      <url>/2020/12/11/p3215-hnoi2011gua-hao-xiu-fu-jsoi2011gua-hao-xu-lie/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œè¦æ±‚æ”¯æŒä¸‹é¢çš„æ“ä½œ</p><ul><li>æ›¿æ¢æŸä¸ªåŒºé—´çš„æ‰€æœ‰æ‹¬å·ä¸ºå·¦æ‹¬å·æˆ–è€…å³æ‹¬å·</li><li>å°†ä¸€ä¸ªåŒºé—´çš„æ‹¬å·è¿›è¡Œç¿»è½¬</li><li>å°†ä¸€ä¸ªåŒºé—´çš„æ‹¬å·è¿›è¡Œåè½¬ï¼Œå·¦æ‹¬å·&lt;-&gt;å³æ‹¬å·</li><li>è¯¢é—®ä¸€ä¸ªåŒºé—´å†…è‡³å°‘æ”¹å˜å‡ ä¸ªæ‹¬å·æ‰èƒ½æˆä¸ºä¸€ä¸ªåˆæ³•çš„æ‹¬å·åºåˆ—</li></ul><p>æ¯’ç˜¤é¢˜ä¸è¿‡æˆ‘è¿è¯¢é—®çš„ç­”æ¡ˆæ˜¯ä»€ä¹ˆéƒ½æƒ³é”™äº†ï¼ˆå¥½èœå•Šï¼‰å…ˆæ¶ˆæ‰åˆæ³•çš„æ‹¬å·ï¼Œæœ€åè‚¯å®šæ˜¯))))((((çš„å½¢å¼ï¼Œç»´æŠ¤åŒºé—´å‰ç¼€æœ€å°å’Œåç¼€æœ€å¤§å³å¯ï¼Œç”±äºæœ‰åè½¬æ“ä½œè¿˜è¦ç»´æŠ¤åŒºé—´å‰ç¼€æœ€å¤§å’Œåç¼€æœ€å°ã€‚æ„Ÿè§‰è‡ªå·±å¯¹å¹³è¡¡æ ‘ç»´æŠ¤çš„é¢˜è¿˜æ˜¯ä¸ç†Ÿï¼Œæ¯æ¬¡éƒ½ä¸€å †é”™è¯¯ã€‚æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯å¿˜è®°äº†æœ¬èŠ‚ç‚¹ä¿¡æ¯ï¼Œä¸»è¦æ˜¯çº¿æ®µæ ‘çš„ä¿¡æ¯å®Œå…¨ç”±å­èŠ‚ç‚¹åˆå¹¶è€Œæ¥ï¼Œä½†æ˜¯åœ¨å¹³è¡¡æ ‘ä¸­æœ¬èŠ‚ç‚¹çš„ä¿¡æ¯æ˜¯ä¸åŒ…å«åœ¨å­èŠ‚ç‚¹ä¸­çš„ã€‚æ­¤å¤–åœ¨å»ºæ ‘çš„æ—¶å€™æ¯ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯éƒ½è¦è®°å½•ä¸‹æ¥ï¼Œè€Œä¸æ˜¯åƒçº¿æ®µæ ‘ä¸€æ ·åªåœ¨å¶å­èŠ‚ç‚¹çš„æ—¶å€™è®°å½•ï¼Œç„¶åå…¶ä½™èŠ‚ç‚¹ç›´æ¥é€šè¿‡pushupå¾—åˆ°å³å¯ï¼Œåˆ‡è®°ï¼ï¼ç„¶åå°±æ˜¯ä¸‹ä¼ æ ‡è®°çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯åè½¬å’Œè¦†ç›–æ“ä½œçš„å…ˆåé¡ºåºä¼šæœ‰å½±å“ï¼Œç„¶åæˆ‘ç«Ÿç„¶å°±ä¸ä¼šäº†ï¼ˆä¸æ˜¯å’ŒåŠ æ³•ä¹˜æ³•ä¸€æ ·å—ï¼Œ <s>å¥½ä¹…æ²¡å†™äº†</s> ï¼‰åœ¨è¦†ç›–çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠåè½¬å’Œç¿»è½¬çš„æ ‡è®°æ¸…é›¶ã€‚åœ¨åè½¬çš„æ—¶å€™ï¼Œéœ€è¦æŠŠè¦†ç›–çš„æ ‡è®°å–åã€‚ç„¶åä¸‹ä¼ çš„æ—¶å€™å…ˆä¼ åè½¬ï¼Œç„¶åå†ä¼ è¦†ç›–ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™è‚¯å®šæ˜¯å…ˆæœ‰åè½¬å†æœ‰è¦†ç›–çš„ï¼Œå¦åˆ™è¦†ç›–ä¼šæŠŠåè½¬çš„æ ‡è®°æ¸…æ‰ã€‚é¡ºä¾¿å›å¿†ä¸€ä¸‹åŠ æ³•å’Œä¹˜æ³•æ ‡è®°ï¼Œåœ¨ä¹˜æ³•çš„æ—¶å€™è¦æŠŠåŠ æ³•æ ‡è®°ä¹Ÿä¹˜ä¸€ä¸‹ï¼Œåœ¨ä¸‹ä¼ çš„æ—¶å€™å…ˆä¼ ä¹˜æ³•å†ä¼ åŠ æ³•ã€‚è¿™ç§å¤šæ ‡è®°çš„é—®é¢˜ï¼Œæœ€å¥½å¯¹æ¯ä¸ªæ ‡è®°å†™ä¸€ä¸ªå‡½æ•°ï¼Œå¦åˆ™ä¼šå¾ˆä¹±ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, q;</span><br><span class="line"><span class="type">char</span> c[N];</span><br><span class="line"><span class="type">int</span> rt;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], val[N], fa[N], lmn[N], rmn[N], lmx[N], rmx[N], sum[N];</span><br><span class="line"><span class="type">int</span> rev[N], cov[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> l = ch[p][<span class="number">0</span>], r = ch[p][<span class="number">1</span>];</span><br><span class="line">  sz[p] = sz[l] + sz[r] + <span class="number">1</span>;</span><br><span class="line">  lmn[p] = <span class="built_in">min</span>(lmn[l], sum[l]+val[p]+lmn[r]);</span><br><span class="line">  lmx[p] = <span class="built_in">max</span>(lmx[l], sum[l]+val[p]+lmx[r]);</span><br><span class="line">  rmn[p] = <span class="built_in">min</span>(rmn[r], sum[r]+val[p]+rmn[l]);</span><br><span class="line">  rmx[p] = <span class="built_in">max</span>(rmx[r], sum[r]+val[p]+rmx[l]);</span><br><span class="line">  sum[p] = sum[l] + sum[r] + val[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  val[p] = v, sum[p] = v*sz[p];</span><br><span class="line">  lmn[p] = rmn[p] = <span class="built_in">min</span>(<span class="number">0</span>, sum[p]);</span><br><span class="line">  lmx[p] = rmx[p] = <span class="built_in">max</span>(<span class="number">0</span>, sum[p]);</span><br><span class="line">  cov[p] = v;</span><br><span class="line">  inv[p] = <span class="number">0</span>;</span><br><span class="line">  rev[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setrev</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">swap</span>(ch[p][<span class="number">0</span>], ch[p][<span class="number">1</span>]);</span><br><span class="line">  <span class="built_in">swap</span>(lmn[p], rmn[p]);</span><br><span class="line">  <span class="built_in">swap</span>(lmx[p], rmx[p]);</span><br><span class="line">  rev[p] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setinv</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">swap</span>(lmn[p], lmx[p]);</span><br><span class="line">  <span class="built_in">swap</span>(rmn[p], rmx[p]);</span><br><span class="line">  lmn[p] *= <span class="number">-1</span>;</span><br><span class="line">  lmx[p] *= <span class="number">-1</span>;</span><br><span class="line">  rmn[p] *= <span class="number">-1</span>;</span><br><span class="line">  rmx[p] *= <span class="number">-1</span>;</span><br><span class="line">  sum[p] *= <span class="number">-1</span>;</span><br><span class="line">  val[p] *= <span class="number">-1</span>;</span><br><span class="line">  inv[p] ^= <span class="number">1</span>;</span><br><span class="line">  cov[p] *= <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(inv[p])</span><br><span class="line">  &#123;</span><br><span class="line">    inv[p] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">setinv</span>(ch[p][<span class="number">0</span>]); <span class="built_in">setinv</span>(ch[p][<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cov[p])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setv</span>(ch[p][<span class="number">0</span>], cov[p]); <span class="built_in">setv</span>(ch[p][<span class="number">1</span>], cov[p]);</span><br><span class="line">    cov[p] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(rev[p])</span><br><span class="line">  &#123;</span><br><span class="line">    rev[p] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">setrev</span>(ch[p][<span class="number">0</span>]); <span class="built_in">setrev</span>(ch[p][<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> p = (l+r)&gt;&gt;<span class="number">1</span>, v = (c[p<span class="number">-1</span>]==<span class="string">&#x27;(&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>);</span><br><span class="line">  sz[p] = <span class="number">1</span>, sum[p] = val[p] = v;</span><br><span class="line">  fa[p] = f, ch[f][p&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    lmx[p] = rmx[p] = <span class="built_in">max</span>(<span class="number">0</span>, v);</span><br><span class="line">    lmn[p] = rmn[p] = <span class="built_in">min</span>(<span class="number">0</span>, v);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">build</span>(l, p<span class="number">-1</span>, p); <span class="built_in">build</span>(p+<span class="number">1</span>, r, p);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">split</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, r+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="keyword">return</span> ch[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">replace</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setv</span>(x, v);</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setrev</span>(x);</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">invert</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setinv</span>(x);</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, c+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, n+<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  rt = (n+<span class="number">3</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> com[<span class="number">10</span>], cc[<span class="number">2</span>];</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d&quot;</span>, com, &amp;l, &amp;r);</span><br><span class="line">    ++l, ++r;</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, cc);</span><br><span class="line">      <span class="built_in">replace</span>(l, r, (cc[<span class="number">0</span>]==<span class="string">&#x27;(&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x = <span class="built_in">split</span>(l, r);</span><br><span class="line">      <span class="type">int</span> pmn = lmn[x], smx = rmx[x];</span><br><span class="line">      <span class="type">int</span> y = fa[x];</span><br><span class="line">      <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">      <span class="built_in">assert</span>(pmn&lt;=<span class="number">0</span>); <span class="built_in">assert</span>(smx&gt;=<span class="number">0</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ((-pmn+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>)+((smx+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;S&#x27;</span>) <span class="built_in">reverse</span>(l, r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;I&#x27;</span>) <span class="built_in">invert</span>(l, r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³è¡¡æ ‘ä¹‹splay</title>
      <link href="/2020/12/11/ping-heng-shu-zhi-splay/"/>
      <url>/2020/12/11/ping-heng-shu-zhi-splay/</url>
      
        <content type="html"><![CDATA[<p>ä¼¸å±•æ ‘çš„æ ¸å¿ƒæ“ä½œå°±æ˜¯splayäº†ï¼Œå°†æ¯æ¬¡è®¿é—®çš„ç‚¹splayåˆ°æ ¹èŠ‚ç‚¹ï¼ˆç±»ä¼¼è¾“å…¥æ³•ï¼Œé¢‘ç¹æ‰“çš„è¯ä¼šæ¯”è¾ƒé å‰ï¼‰ã€‚è€Œæ­£ç¡®çš„splayæ“ä½œå¯ä»¥ä¿è¯åœ¨å°†xæ—‹è½¬åˆ°æ ¹èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œæ²¿é€”çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹çš„æ·±åº¦éƒ½ä¼šè‡³å°‘å‡å°‘ä¸€åŠï¼Œè¿™ç§è‡ªæˆ‘è°ƒæ•´çš„ç‰¹æ€§ä¿è¯äº†splayæ ‘åœ¨å„ç§æ“ä½œä¸‹å‡æ‘Š$O(\log n)$rotateéœ€è¦åˆ†3ç§æƒ…å†µï¼Œsplayéœ€è¦åˆ†6ç§æƒ…å†µæ¯”è¾ƒéº»çƒ¦ï¼Œä¸å†èµ˜è¿°ï¼ˆ <s>å…¶å®æ˜¯ä¸ä¼š</s> ï¼‰ï¼Œåªç»™å‡ºä»£ç å®ç°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>splay(x,g)è¡¨ç¤ºå°†xæ—‹è½¬åˆ°gçš„å„¿å­å¤„ï¼Œå½“g=0æ—¶å³å°†xæ—‹è½¬åˆ°æ ¹ã€‚ç”¨splayæ¥ç»´æŠ¤æƒå€¼å¤§å°æˆ‘è§‰å¾—å¾ˆéº»çƒ¦ï¼Œç é‡å’Œå¸¸æ•°éƒ½æ¯”è¾ƒå¤§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç”¨pbdsæˆ–è€…fhqtreapæ›¿ä»£å³å¯ã€‚ä½†æ˜¯ç”¨splayæ¥ç»´æŠ¤åŒºé—´è¿˜æ˜¯éœ€è¦åªè¦çš„ã€‚åšæ³•ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚æœè¦ç»´æŠ¤[l,r]ï¼Œå…ˆæŠŠl-1æ—‹è½¬åˆ°æ ¹ï¼Œå†æŠŠr+1æ—‹è½¬åˆ°l-1çš„å„¿å­ï¼Œé‚£ä¹ˆæ­¤æ—¶r+1çš„å·¦å­æ ‘å°±æ˜¯è¦æ“ä½œçš„[l,r]éƒ¨åˆ†ï¼Œç›´æ¥å¯¹è¿™ä¸ªæ ¹èŠ‚ç‚¹æ‰“ä¸Šç›¸åº”çš„æ ‡è®°å³å¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">split</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, r+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="keyword">return</span> ch[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pushdownæ“ä½œåªéœ€è¦åœ¨kthå‡½æ•°ä¸­è¿›è¡Œå³å¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œpushupæ“ä½œåœ¨æ¯æ¬¡è¿›è¡ŒsplitåŒºé—´æ“ä½œåéƒ½è¦æ‰§è¡Œï¼Œå‡è®¾splitè¿”å›çš„èŠ‚ç‚¹æ˜¯xï¼Œé‚£ä¹ˆå°±è¦pushup(y)ä»¥åŠpushup(fa[y])ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">replace</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setv</span>(x, v);</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®splayçš„æ‰€æœ‰æ“ä½œéƒ½å¯ä»¥ç”¨fhqtreapæ¥æ›¿ä»£ï¼Œä¸è¿‡åœ¨åŒºé—´æ“ä½œä¸­è¦æ‰¾åˆ°åŒºé—´ä¸‹æ ‡xçš„ç‚¹è¿™ä¸€åŠŸèƒ½è¿˜æ˜¯splayæ–¹ä¾¿ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªç‚¹splayåˆ°æ ¹å°±å¯ä»¥äº†ï¼Œè€Œtreapåˆ™éœ€è¦é¢å¤–ç»´æŠ¤çˆ¶äº²ï¼Œè€Œè‡ªä¸‹è€Œä¸Šæ‰¾ã€‚å½“ç„¶splayæ— å¯æ›¿ä»£çš„åœ°æ–¹å°±æ˜¯LCTäº†ï¼Œå¦‚æœç”¨treapå°±ä¼šå¤šä¸€ä¸ªlogã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P5217 è´«ç©· fhq treap</title>
      <link href="/2020/12/07/p5217-pin-qiong-fhq-treap/"/>
      <url>/2020/12/07/p5217-pin-qiong-fhq-treap/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²åºåˆ—è¦æ±‚æ”¯æŒä»¥ä¸‹æ“ä½œ</p><ul><li>åœ¨xä½ç½®åæ’å…¥ä¸€ä¸ªå­—æ¯</li><li>åˆ é™¤xä½ç½®çš„å­—æ¯</li><li>ç¿»è½¬åŒºé—´[x,y]</li><li>è¾“å‡ºåˆå§‹å­—ç¬¦ä¸²åºåˆ—ç¬¬xä¸ªå­—æ¯å½“å‰ä½ç½®</li><li>è¾“å‡ºå½“å‰å­—ç¬¦ä¸²åºåˆ—ç¬¬xä¸ªå­—æ¯</li><li>è¾“å‡ºåŒºé—´[x,y]å­—æ¯ç§ç±»æ•°</li></ul><p>å‰ä¸‰ä¸ªå¾ˆç®€å•ã€‚ç¬¬å››ä¸ªè¦æŸ¥èŠ‚ç‚¹å·ä¸ºxçš„å­—æ¯çš„ä½ç½®ï¼Œç”±äºæ˜¯ç»´æŠ¤åŒºé—´ï¼ŒæŒ‰sizeåˆ†è£‚ï¼Œæ‰€ä»¥è‡ªä¸Šè€Œä¸‹æ‰¾ä¸äº†ï¼Œåªèƒ½é¢å¤–ç»´æŠ¤çˆ¶äº²ï¼Œç„¶åè‡ªä¸‹è€Œä¸Šæ‰¾ã€‚ç”±äºç¬¬ä¸‰ä¸ªåŒºé—´ç¿»è½¬æ“ä½œï¼Œå¯¼è‡´å·¦å³å„¿å­å¯èƒ½ä¼šæ”¹å˜ï¼Œæ‰€ä»¥è¦å…ˆåˆ°æ ¹èŠ‚ç‚¹æŠŠæ‰€æœ‰æ‡’æ ‡è®°pushdownä¸‹æ¥ï¼Œå†è‡ªä¸‹è€Œä¸Šæ‰¾æ‰èƒ½æ­£ç¡®ç¬¬äº”ä¸ªå°±æ˜¯æŸ¥ç¬¬kå¤§ï¼ˆåŒºé—´æ„ä¹‰ä¸‹ï¼‰ï¼Œç›´æ¥splitå’Œmergeæ¯”è¾ƒå¥½ï¼Œå¦‚æœæ˜¯ä»æ ¹é€’å½’ç€èµ°ï¼Œä¸è¦å¿˜è®°pushdownç¬¬å…­ä¸ªçŠ¶å‹ç»´æŠ¤ä¸€ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnd</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>|<span class="built_in">rand</span>(); &#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> mask, sz, fa, key, c;</span><br><span class="line">  <span class="type">bool</span> rev;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = ++tot;</span><br><span class="line">  t[p].ls = t[p].rs = t[p].fa = <span class="number">0</span>;</span><br><span class="line">  t[p].mask = <span class="number">1</span>&lt;&lt;c, t[p].c = c, t[p].key = <span class="built_in">rnd</span>();</span><br><span class="line">  t[p].sz = <span class="number">1</span>;</span><br><span class="line">  t[p].rev = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + <span class="number">1</span>;</span><br><span class="line">  t[p].mask = t[t[p].ls].mask | t[t[p].rs].mask | (<span class="number">1</span>&lt;&lt;t[p].c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(t[p].rev)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">swap</span>(t[p].ls, t[p].rs);</span><br><span class="line">    t[t[p].ls].rev ^= <span class="number">1</span>;</span><br><span class="line">    t[t[p].rs].rev ^= <span class="number">1</span>;</span><br><span class="line">    t[p].rev = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y, <span class="type">int</span> k, <span class="type">int</span> fx=<span class="number">0</span>, <span class="type">int</span> fy=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; x = y = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz)</span><br><span class="line">  &#123;</span><br><span class="line">    y = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].ls, x, t[p].ls, k, fx, p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    x = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].rs, t[p].rs, y, k-t[t[p].ls].sz<span class="number">-1</span>, p, fy);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(x) t[x].fa = fx;</span><br><span class="line">  <span class="keyword">if</span>(y) t[y].fa = fy;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) &#123; p = x|y; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[x].key&lt;t[y].key)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">down</span>(x);</span><br><span class="line">    p = x;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].rs, t[p].rs, y);</span><br><span class="line">    t[t[p].rs].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">down</span>(y);</span><br><span class="line">    p = y;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].ls, x, t[p].ls);</span><br><span class="line">    t[t[p].ls].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">downall</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">downall</span>(t[p].fa);</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">downall</span>(p);</span><br><span class="line">  <span class="type">int</span> rk = t[t[p].ls].sz + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(t[p].fa)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(t[t[p].fa].rs==p) rk += t[t[p].fa].sz - t[p].sz;</span><br><span class="line">    p = t[p].fa;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> rk*(p==rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(k==t[t[p].ls].sz+<span class="number">1</span>) <span class="keyword">return</span> t[p].c;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[t[p].ls].sz<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="built_in">newnode</span>(s[i]-<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="built_in">merge</span>(rt, rt, x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> opt[<span class="number">2</span>], c[<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, opt);</span><br><span class="line">    <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;I&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%s&quot;</span>, &amp;k, c);</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">split</span>(rt, x, y, k);</span><br><span class="line">      z = <span class="built_in">newnode</span>(c[<span class="number">0</span>]-<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">      <span class="built_in">merge</span>(x, x, z);</span><br><span class="line">      <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">split</span>(rt, x, y, k);</span><br><span class="line">      <span class="built_in">split</span>(x, x, z, k<span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">split</span>(rt, x, y, r);</span><br><span class="line">      <span class="built_in">split</span>(x, z, x, l<span class="number">-1</span>);</span><br><span class="line">      t[x].rev ^= <span class="number">1</span>;</span><br><span class="line">      <span class="built_in">merge</span>(x, z, x);</span><br><span class="line">      <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;P&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">get</span>(k));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, <span class="built_in">char</span>(<span class="built_in">kth</span>(rt, k)+<span class="string">&#x27;a&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">split</span>(rt, x, y, r);</span><br><span class="line">      <span class="built_in">split</span>(x, z, x, l<span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, __builtin_popcount(t[x].mask));</span><br><span class="line">      <span class="built_in">merge</span>(x, z, x);</span><br><span class="line">      <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³è¡¡æ ‘ä¹‹FHQ Treap</title>
      <link href="/2020/12/06/ping-heng-shu-zhi-fhq-treap/"/>
      <url>/2020/12/06/ping-heng-shu-zhi-fhq-treap/</url>
      
        <content type="html"><![CDATA[<p>treapï¼Œé¡¾åæ€ä¹‰tree+heapæ—¢æœ‰å¹³è¡¡æ ‘çš„æ€§è´¨ï¼šå·¦å„¿å­æƒå€¼&lt;æœ¬èŠ‚ç‚¹æƒå€¼&lt;å³å„¿å­æƒå€¼ï¼Œä¸­åºéå†æœ‰åºï¼Œä¸”æ ‘é«˜å°½å¯èƒ½å°åˆæœ‰heapçš„æ€§è´¨ï¼šé”®å€¼æ»¡è¶³å°æ ¹å †ï¼Œå·¦å„¿å­çš„é”®å€¼å’Œå³å„¿å­çš„é”®å€¼éƒ½å¤§äºæœ¬èŠ‚ç‚¹çš„é”®å€¼è€ŒFHQ Treapä»…ä»…é€šè¿‡ä¸¤ä¸ªå‡½æ•°å°±èƒ½å¤Ÿè¿›è¡Œç»´æŠ¤ï¼Œæ€æƒ³å¥½æ‡‚ï¼Œä»£ç ä¹Ÿå¾ˆç®€æ´ã€‚æ›´é‡è¦çš„æ˜¯ç›¸æ¯”äºä¹‹å‰çš„æ›¿ç½ªç¾Šæ ‘æˆ–è€…pbdsè¿™ç§åªèƒ½ç»´æŠ¤å¤§å°å…³ç³»çš„å¹³è¡¡æ ‘è€Œè¨€ï¼Œå®ƒå¯ä»¥èƒœä»»splayæ‹¥æœ‰çš„ç»´æŠ¤åŒºé—´çš„ç‰¹è´¨ã€‚é¦–å…ˆæ˜¯æ™®é€šçš„ç»´æŠ¤å¤§å°å…³ç³»ï¼šsplitå‡½æ•°ï¼Œå°†ä¸€æ£µæ ‘æŒ‰ç…§ç»™å®šçš„æƒå€¼våˆ’åˆ†æˆä¸¤æ£µæ ‘ï¼Œå¹¶ä¸”ä¿è¯ç¬¬ä¸€æ£µæ ‘çš„æƒå€¼å‡å°äºç­‰äºvï¼Œç¬¬äºŒæ£µæ ‘çš„æƒå€¼å‡å¤§äºvã€‚æ˜¾ç„¶åªè¦é€’å½’åˆ†è£‚çš„æ ‘ï¼Œè€ƒè™‘å½“å‰èŠ‚ç‚¹çš„æƒå€¼å’Œç»™å®šçš„vçš„å…³ç³»å³å¯ã€‚æ³¨æ„åˆ†è£‚çš„ä¸¤ä¸ªèŠ‚ç‚¹ä¼ å¼•ç”¨ã€‚mergeå‡½æ•°ï¼Œå°†ä¸¤æ£µæ ‘åˆæˆä¸€æ£µæ ‘ï¼Œè¦æ±‚ç¬¬ä¸€æ£µæ ‘çš„æƒå€¼å‡å°äºç­‰äºç¬¬äºŒæ£µæ ‘åŒæ ·æ˜¯é€’å½’è€ƒè™‘ï¼Œé‚£ä¹ˆå½“å‰ä¸¤æ£µæ ‘è°çš„æ ¹ä½œä¸ºåˆå¹¶çš„æ ‘çš„æ ¹å‘¢ï¼ŸæŒ‰ç…§æƒå€¼æ¥çœ‹éƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¸ºäº†ä¿æŒå¹³è¡¡æ€§ï¼Œå°±è¦ç»´æŠ¤é”®å€¼çš„å°æ ¹å †æ€§è´¨ï¼Œæ‰€ä»¥è®©é”®å€¼å°çš„é‚£ä¸ªèŠ‚ç‚¹ä½œä¸ºæ ¹å³å¯ã€‚æ³¨æ„åˆå¹¶çš„é‚£ä¸ªèŠ‚ç‚¹è¦ä¼ å¼•ç”¨ã€‚ç”±äºsplitå’Œmergeéƒ½ä¼šæ”¹å˜çˆ¶å­å…³ç³»ï¼Œæ‰€ä»¥æœ€åè¦pushupç»´æŠ¤å¥½å­æ ‘çš„ä¿¡æ¯ã€‚è€Œå¯¹äºæ™®é€šå¹³è¡¡æ ‘æ‰€æ”¯æŒçš„æ’å…¥ã€åˆ é™¤ã€ç¬¬kå¤§ã€æ’åã€å‰é©±ã€åç»§ç­‰ç­‰ï¼Œåªè¦åŸºäºsplitå’Œmergeä¸¤ä¸ªå‡½æ•°å°±å¯ä»¥è½»æ¾å®ç°ï¼Œæ¯”è¾ƒç®€å•ï¼Œ <s>æ‡’å¾—å†™äº†</s>p6136ï¼šfhq treap 8.2sï¼Œæ›¿ç½ªç¾Š5.81sï¼Œä¸è¿‡fhq treapä»£ç çŸ­ç‚¹ã€‚å½“ç„¶ä¸¤è€…éƒ½å¾ˆå¥½ç†è§£ã€‚ä¸€èˆ¬æƒ…å†µä¸‹fhqtreapè¶³ä»¥åº”å¯¹æ‰€æœ‰æƒ…å†µï¼ˆé™¤äº†LCTä»¥åŠé‡åº¦å¡å¸¸é¢˜ï¼ˆç´«è†èŠ±ä¹‹æ‹ï¼Ÿå¬è¯´ï¼‰ï¼Œæ‰€ä»¥splayè¿˜æ˜¯å¾—æ‡‚ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> val, key, sz;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> tot, rt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnd</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (<span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>)|<span class="built_in">rand</span>(); &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = ++tot;</span><br><span class="line">  t[p].val = v, t[p].sz = <span class="number">1</span>;</span><br><span class="line">  t[p].ls = t[p].rs = <span class="number">0</span>;</span><br><span class="line">  t[p].key = <span class="built_in">rnd</span>();</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;a, <span class="type">int</span> &amp;b, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; a = b = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].val&lt;=v) &#123; a = p; <span class="built_in">split</span>(t[p].rs, t[a].rs, b, v); &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; b = p; <span class="built_in">split</span>(t[p].ls, a, t[b].ls, v); &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!a||!b) &#123; p = a|b; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[a].key&lt;t[b].key) &#123; p = a; <span class="built_in">merge</span>(t[p].rs, t[a].rs, b); &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; p = b; <span class="built_in">merge</span>(t[p].ls, a, t[b].ls); &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="built_in">newnode</span>(v);</span><br><span class="line">  <span class="built_in">split</span>(p, x, y, v);</span><br><span class="line">  <span class="built_in">merge</span>(x, x, z); <span class="built_in">merge</span>(p, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">split</span>(p, x, y, v); <span class="built_in">split</span>(x, x, z, v<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">merge</span>(z, t[z].ls, t[z].rs);</span><br><span class="line">  <span class="built_in">merge</span>(x, x, z); <span class="built_in">merge</span>(p, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(k==t[t[p].ls].sz+<span class="number">1</span>) <span class="keyword">return</span> t[p].val;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[t[p].ls].sz<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Less</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v, <span class="type">bool</span> eq)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">split</span>(p, x, y, v<span class="number">-1</span>+eq);</span><br><span class="line">  <span class="type">int</span> ans = t[x].sz;</span><br><span class="line">  <span class="built_in">merge</span>(p, x, y);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">srand</span>(<span class="built_in">int</span>(<span class="built_in">time</span>(<span class="number">0</span>)));</span><br><span class="line">  <span class="type">int</span> n, m;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, x; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">    <span class="built_in">ins</span>(rt, x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> last = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;x);</span><br><span class="line">    x ^= last;</span><br><span class="line">    <span class="keyword">switch</span>(op)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>: <span class="built_in">ins</span>(rt, x); <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>: <span class="built_in">del</span>(rt, x); <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>: last = <span class="built_in">Less</span>(rt, x, <span class="number">0</span>) + <span class="number">1</span>; ans ^= last; <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>: last = <span class="built_in">kth</span>(rt, x); ans ^= last; <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>: last = <span class="built_in">kth</span>(rt, <span class="built_in">Less</span>(rt, x, <span class="number">0</span>)); ans ^= last; <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>: last = <span class="built_in">kth</span>(rt, <span class="built_in">Less</span>(rt, x, <span class="number">1</span>)+<span class="number">1</span>); ans ^= last;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯ç»´æŠ¤åŒºé—´ï¼Œä¹Ÿå¾ˆç®€å•ï¼Œæ”¹ä¸€ä¸‹splitå’Œmergeçš„å®šä¹‰å³å¯ã€‚splitï¼Œç»™å®šä¸€ä¸ªæ ‘ï¼ŒæŠŠä¸€æ£µæ ‘çš„å‰kä¸ªèŠ‚ç‚¹åˆ’åˆ†ç»™ä¸€æ£µæ ‘ï¼Œå‰©ä½™èŠ‚ç‚¹åˆ’åˆ†ç»™å¦ä¸€æ£µæ ‘mergeï¼Œå°†ä¸¤æ£µæ ‘åˆå¹¶æˆä¸€æ£µæ ‘ï¼Œéœ€è¦ä¿è¯ä¸€æ£µæ ‘å®Œå…¨å¤„åœ¨å¦ä¸€æ£µæ ‘çš„å‰é¢å†™æ³•å’Œä¸Šé¢ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°è€ƒè™‘å¯¹åŒºé—´[l,r]çš„æ“ä½œæ€ä¹ˆåšï¼šå…ˆæŠŠrtçš„å‰rä¸ªèŠ‚ç‚¹splitç»™xï¼Œå…¶ä»–çš„ä¸¢ç»™yå†æŠŠxçš„å‰l-1ä¸ªèŠ‚ç‚¹splitç»™zæ­¤æ—¶xå°±æ˜¯[l,r]åŒºé—´å†…æ‰€æœ‰èŠ‚ç‚¹æ„æˆçš„treapçš„æ ¹äº†ï¼Œç›´æ¥åœ¨æ ¹ä¸Šæ‰“æ ‡è®°å³å¯ã€‚æœ€åæŒ‰ç…§é¡ºåºzï¼Œxï¼Œyè¿›è¡Œmergeã€‚è€ƒè™‘pushupå’Œpushdownåœ¨ä»€ä¹ˆæ—¶å€™è¿›è¡Œã€‚pushupæ˜¯è¦ç»´æŠ¤å½“å‰å­æ ‘çš„ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦åœ¨å·¦å³å„¿å­æ”¹å˜åè°ƒç”¨ï¼Œè€Œpushdownæ˜¯ä¸ºäº†ä¸‹æ”¾èµ–åœ¨å½“å‰èŠ‚ç‚¹ä¸Šçš„æ‡’æ ‡è®°ï¼Œæ‰€ä»¥è¦åœ¨å·¦å³å„¿å­æ”¹å˜å‰è°ƒç”¨ï¼Œæƒ³æ¸…æ¥šè¿™ä¸¤ç‚¹å°±çŸ¥é“äº†ï¼Œåº”è¯¥åœ¨splitå’Œmergeè¿›å…¥å­æ ‘å‰pushdownï¼Œåœ¨å›æº¯ä¸Šæ¥ä¹‹åå†pushupã€‚p3391 æ–‡è‰ºå¹³è¡¡æ ‘ï¼ŒåŒºé—´ç¿»è½¬ï¼Œæ˜¾ç„¶åªè¦æŠŠè¦æ“ä½œçš„åŒºé—´splitå‡ºæ¥ç„¶ååœ¨æ ¹ä¸Šæ‰“ä¸€ä¸ªç¿»è½¬æ ‡è®°å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnd</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>|<span class="built_in">rand</span>(); &#125;</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> val, key, sz;</span><br><span class="line">  <span class="type">bool</span> tag;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">swap</span>(t[p].ls, t[p].rs);</span><br><span class="line">  <span class="keyword">if</span>(t[p].ls) t[t[p].ls].tag ^= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].rs) t[t[p].rs].tag ^= <span class="number">1</span>;</span><br><span class="line">  t[p].tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = ++tot;</span><br><span class="line">  t[p].val = v;</span><br><span class="line">  t[p].sz = <span class="number">1</span>; t[p].tag = <span class="number">0</span>;</span><br><span class="line">  t[p].ls = t[p].rs = <span class="number">0</span>;</span><br><span class="line">  t[p].key = <span class="built_in">rnd</span>();</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; x = y = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) &#123; y = p; <span class="built_in">split</span>(t[p].ls, x, t[p].ls, k); &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; x = p, <span class="built_in">split</span>(t[p].rs, t[p].rs, y, k-t[t[p].ls].sz<span class="number">-1</span>); &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) &#123; p = x|y; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[x].key&lt;t[y].key)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(t[x].tag) <span class="built_in">down</span>(x);</span><br><span class="line">    p = x;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].rs, t[x].rs, y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(t[y].tag) <span class="built_in">down</span>(y);</span><br><span class="line">    p = y;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].ls, x, t[y].ls);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">newnode</span>(v);</span><br><span class="line">  <span class="built_in">merge</span>(p, p, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rev</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x, y, z;</span><br><span class="line">  <span class="built_in">split</span>(rt, x, y, r);</span><br><span class="line">  <span class="built_in">split</span>(x, z, x, l<span class="number">-1</span>);</span><br><span class="line">  t[x].tag ^= <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">merge</span>(x, z, x);</span><br><span class="line">  <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="built_in">print</span>(t[p].ls);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t[p].val);</span><br><span class="line">  <span class="built_in">print</span>(t[p].rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">srand</span>(<span class="built_in">int</span>(<span class="built_in">time</span>(<span class="number">0</span>)));</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">ins</span>(rt, i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    <span class="built_in">rev</span>(l, r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">print</span>(rt);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»´æŠ¤åŒºé—´ä¿¡æ¯çš„æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„å¹³è¡¡æ ‘å’Œçº¿æ®µæ ‘æ˜¯ä¸ä¸€æ ·çš„ï¼Œçº¿æ®µæ ‘åªè¦å·¦å³å„¿å­å–ä¼˜å³å¯ï¼ˆå› ä¸ºæœ¬èŠ‚ç‚¹ç»´æŠ¤çš„åŒºé—´æ˜¯å·¦å³å„¿å­ç»´æŠ¤çš„åŒºé—´çš„å¹¶ï¼‰ï¼Œè€Œå¹³è¡¡æ ‘å·¦å³å„¿å­ç»´æŠ¤çš„ä¿¡æ¯æ˜¯ä¸åŒ…å«æœ¬èŠ‚ç‚¹çš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»´æŠ¤æœ¬èŠ‚ç‚¹çš„å€¼ï¼Œå’Œè¯¥å€¼å†å–ä¼˜ã€‚åœ¨ç»´æŠ¤åŒºé—´çš„æ—¶å€™ï¼Œå°±ä¸§å¤±äº†æƒå€¼å¤§å°çš„æ¯”è¾ƒäº†ï¼Œé‚£ä¹ˆå¦‚ä½•çŸ¥é“ç¼–å·ä¸ºiçš„èŠ‚ç‚¹åœ¨åŒºé—´ä¸­çš„å“ªä¸ªä½ç½®å‘¢ï¼Ÿæ˜¾ç„¶ä»æ ¹å¼€å§‹æ˜¯ä¸çŸ¥é“è¯¥èµ°å·¦è¿˜æ˜¯å³çš„ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä»ièŠ‚ç‚¹ä¸æ–­è·³çˆ¶äº²ç›´è‡³æ ¹ï¼Œç„¶åä¸æ–­ç»´æŠ¤å°äºä½ çš„èŠ‚ç‚¹ä¸ªæ•°å°±å¯ä»¥äº†ï¼Œè€Œtreapçš„æ ‘é«˜æ˜¯$\log n$çº§åˆ«çš„ï¼Œå¤æ‚åº¦æ²¡é—®é¢˜ã€‚è¦ç»´æŠ¤èŠ‚ç‚¹çš„çˆ¶äº²ï¼Œä¸€ç§ç®€å•çš„åšæ³•æ˜¯åœ¨pushupçš„æ—¶å€™ç»´æŠ¤ä¸€ä¸‹pçš„å·¦å³å„¿å­çš„çˆ¶äº²ä¸ºpï¼Œä½†è¿™æ ·å­æ˜¯æœ‰é—®é¢˜çš„ï¼Œæ ¹èŠ‚ç‚¹çš„faå€¼æ˜¯é”™è¯¯çš„ï¼Œæ²¡æ³•åŠæ—¶æ¸…é›¶ï¼Œå½“ç„¶å¦‚æœåªæœ‰ä¸€æ£µtreapï¼Œä¸”çŸ¥é“æ ¹èŠ‚ç‚¹çš„ç¼–å·ï¼Œå°±å¯ä»¥é€šè¿‡==rtæ¥åˆ¤æ–­ï¼Œå¦åˆ™å°±åº”è¯¥åœ¨splitå’Œmergeä¸­ç»´æŠ¤faï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y, <span class="type">int</span> fx, <span class="type">int</span> fy, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; x = y = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz)</span><br><span class="line">  &#123;</span><br><span class="line">    y = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].ls, x, t[p].ls, fx, p, k);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    x = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].rs, t[p].rs, y, p, fy, k-t[t[p].ls].sz<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(x) t[x].fa = fx;</span><br><span class="line">  <span class="keyword">if</span>(y) t[y].fa = fy;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) &#123; p = x|y; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[x].key&lt;t[y].key)</span><br><span class="line">  &#123;</span><br><span class="line">    p = x;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].rs, t[p].rs, y);</span><br><span class="line">    t[t[p].rs].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    p = y;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].ls, x, t[p].ls);</span><br><span class="line">    t[t[p].ls].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿”å›ç¼–å·ä¸ºpçš„èŠ‚ç‚¹æ‰€åœ¨treapçš„æ ¹èŠ‚ç‚¹ï¼Œä»¥åŠåœ¨åŸæ•°ç»„ä¸­çš„ä¸‹æ ‡ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">get</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> rk = t[t[p].ls].sz + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(t[p].fa)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p==t[t[p].fa].rs) rk += t[t[p].fa].sz - t[p].sz;</span><br><span class="line">    p = t[p].fa;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">make_pair</span>(p, rk);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³è¡¡æ ‘ä¹‹æ›¿ç½ªç¾Šæ ‘</title>
      <link href="/2020/12/06/ping-heng-shu-zhi-ti-zui-yang-shu/"/>
      <url>/2020/12/06/ping-heng-shu-zhi-ti-zui-yang-shu/</url>
      
        <content type="html"><![CDATA[<p>å¾ˆç®€å•çš„æ€è·¯ï¼Œåœ¨æ¯æ¬¡æ’å…¥å’Œåˆ é™¤çš„æ—¶å€™ï¼Œæ£€æŸ¥ä¸€ä¸‹å·¦å³å­æ ‘æ˜¯ä¸æ˜¯å¤±è¡¡ï¼Œå¦‚æœå¤±è¡¡å°±å°†æ•´æ£µå­æ ‘è¿›è¡Œæ‹æ‰(ä¸­åºéå†å­˜åˆ°æ•°ç»„)ï¼Œé‡æ„(æ¯æ¬¡ä»¥ä¸­å¿ƒç‚¹ä¸ºå½“å‰çš„æ ¹ï¼Œç„¶åé€’å½’å·¦å³åŒºé—´)ã€‚å¤±è¡¡çš„åˆ¤å®šï¼šå½“å·¦å­æ ‘æˆ–è€…å³å­æ ‘çš„å¤§å°è¶…è¿‡äº†æ•´ä¸ªå­æ ‘å¤§å°çš„æŸä¸ªæ¯”ä¾‹alphaï¼ˆä¸€èˆ¬å®šä¹‰åœ¨0.7~0.8ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bad</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; <span class="keyword">return</span> t[p].cnt &amp;&amp; t[p].sz*alpha&lt;<span class="built_in">max</span>(t[t[p].ls].sz, t[t[p].rs].sz); &#125;</span><br></pre></td></tr></table></figure><p>å‡ ä¸ªç»†èŠ‚ï¼š</p><ul><li>åˆ é™¤çš„å®ç°é‡‡ç”¨æœ€ç®€å•çš„æƒ°æ€§åˆ é™¤ï¼Œæ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹åè®©cntâ€“å³å¯ï¼Œå³ä½¿ç­‰äº0ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºåœ¨æ‹æ‰é‡æ„çš„æ—¶å€™å¯ä»¥æŠŠç­‰äº0çš„èŠ‚ç‚¹ç›´æ¥ä¸¢å¼ƒæ‰</li><li>ç”±äºæ’å…¥åˆ é™¤çš„æ—¶å€™å¯èƒ½éœ€è¦é‡æ„ï¼Œå› æ­¤ä¸€å®šè¦è®°å¾—ä¼ å¼•ç”¨</li><li>è¿™ç§å¹³è¡¡æ ‘æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¥½å†™åŠ å¸¸æ•°å°(å‡æ‘Šmlogn)</li></ul><p>è®°ä½æ‹æ‰é‡æ„çš„æ€æƒ³åº”è¯¥å°±å¾ˆå®¹æ˜“æ‰‹å†™äº†å§</p><p>å‰é©±ã€åç»§ã€ç¬¬kå¤§ã€æ’åå…¶å®æ²¡å¿…è¦æ¯ä¸ªéƒ½å®ç°ä¸€ä¸ªå‡½æ•°ã€‚åªéœ€è¦å®ç°æ±‚ç¬¬kå¤§ï¼Œç„¶åæ±‚å°äºxçš„æ•°çš„ä¸ªæ•°ä»¥åŠå°äºç­‰äºxçš„æ•°çš„ä¸ªæ•°å³å¯ï¼Œåªä¸åä¸¤è€…åªæœ‰ç»†å¾®çš„å·®å¼‚ï¼Œå®Œå…¨å¯ä»¥åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­æ´›è°·æ¨¡æ¿p3369å¼€O2 170msï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> alpha = <span class="number">0.7</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> val, sz, cnt;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + t[p].cnt; &#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bad</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; <span class="keyword">return</span> t[p].cnt &amp;&amp; t[p].sz*alpha&lt;<span class="built_in">max</span>(t[t[p].ls].sz, t[t[p].rs].sz); &#125;</span><br><span class="line"><span class="type">int</span> ord[N], top;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(t[p].ls);</span><br><span class="line">  <span class="keyword">if</span>(t[p].cnt) ord[++top] = p;</span><br><span class="line">  <span class="built_in">dfs</span>(t[p].rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, p = ord[mid];</span><br><span class="line">  t[p].ls = <span class="built_in">build</span>(l, mid<span class="number">-1</span>);</span><br><span class="line">  t[p].rs = <span class="built_in">build</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(p);</span><br><span class="line">  p = <span class="built_in">build</span>(<span class="number">1</span>, top);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  p = ++tot;</span><br><span class="line">  t[p].val = v, t[p].ls = t[p].rs = <span class="number">0</span>;</span><br><span class="line">  t[p].cnt = t[p].sz = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="built_in">newnode</span>(p, v);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==t[p].val) t[p].cnt++;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="built_in">ins</span>(t[p].ls, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">ins</span>(t[p].rs, v);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">bad</span>(p)) <span class="built_in">rebuild</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(v==t[p].val) t[p].cnt--;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="built_in">del</span>(t[p].ls, v);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">del</span>(t[p].rs, v);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">bad</span>(p)) <span class="built_in">rebuild</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Less</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v, <span class="type">bool</span> eq)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].cnt&amp;&amp;v==t[p].val) <span class="keyword">return</span> t[t[p].ls].sz + t[p].cnt*eq;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="keyword">return</span> <span class="built_in">Less</span>(t[p].ls, v, eq);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> t[t[p].ls].sz + t[p].cnt + <span class="built_in">Less</span>(t[p].rs, v, eq);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(t[t[p].ls].sz+t[p].cnt&gt;=k) <span class="keyword">return</span> t[p].val;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[p].cnt-t[t[p].ls].sz);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">while</span>(n--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> t, x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;t, &amp;x);</span><br><span class="line">    <span class="keyword">if</span>(t==<span class="number">1</span>) <span class="built_in">ins</span>(rt, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">2</span>) <span class="built_in">del</span>(rt, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">3</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">Less</span>(rt, x, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">4</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">kth</span>(rt, x));</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">5</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">kth</span>(rt, <span class="built_in">Less</span>(rt, x, <span class="number">0</span>)));</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">kth</span>(rt, <span class="built_in">Less</span>(rt, x, <span class="number">1</span>)+<span class="number">1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ECPC 2019 Kickoff</title>
      <link href="/2020/12/04/ecpc-2019-kickoff/"/>
      <url>/2020/12/04/ecpc-2019-kickoff/</url>
      
        <content type="html"><![CDATA[<p>é™¤äº†Iæ²¡äººè¿‡ï¼ˆæ²¡çœ‹ï¼‰ï¼Œéƒ½ä¸éš¾ç‰¹åˆ«ç®€å•çš„ç•¥è¿‡</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™ä¸‰æ ¹æœ¨æ£é•¿åº¦a,b,cï¼Œå†ç»™ä¸€ä¸ªkï¼Œä½ å¯ä»¥é€‰æ‹©<strong>ä¸€æ ¹</strong>æœ¨æ£è®©å®ƒçš„é•¿åº¦æœ€å¤šå»¶é•¿kï¼Œé—®ä½ è¿™ä¸‰æ ¹æœ¨æ£æ„æˆçš„ä¸‰è§’å½¢çš„æœ€å¤§é¢ç§¯</p><p>è€ƒè™‘æšä¸¾å»¶é•¿çš„è¾¹ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡ºè¿™æ¡è¾¹çš„èŒƒå›´ï¼Œç„¶ååˆ©ç”¨ä½™å¼¦å®šç†æ±‚å‡ºè¿™æ¡è¾¹å¯¹è§’çš„èŒƒå›´ï¼Œæœ€å¤§åŒ–è¿™ä¸ªè§’çš„sinå€¼å³å¯</p><h2 id="K"><a class="header-anchor" href="#K">Â¶</a>K</h2><p>nç›†æ¤ç‰©ï¼Œç¬¬iç›†åˆå§‹é«˜åº¦ä¸º$h_i$â€‹ï¼Œç”Ÿæˆé€Ÿåº¦ä¸º$g_i$â€‹ï¼Œé—®ä½ æœ€çŸ­ç¬¬å‡ å¤©æ‰€æœ‰æ¤ç‰©ä¼šå½¢æˆéé™åºåˆ—</p><p>æ˜¾ç„¶è€ƒè™‘ç›¸é‚»ä¸¤ç›†ï¼ŒæŠ½è±¡æˆç›´çº¿å³å¯ï¼Œè¦ä¹ˆæ˜¯$[0,l]$,è¦ä¹ˆæ˜¯$[r,\inf]$ï¼Œç»´æŠ¤lå’Œrå³å¯</p><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>ä¸€ä¸ªåºåˆ—ï¼Œåªæœ‰â€™aâ€™,â€˜bâ€™,â€˜câ€™ï¼Œä¸”â€™bâ€™æœ€å¤šä¸€ä¸ªï¼Œç°åœ¨å¯ä»¥äº¤æ¢ä»»æ„ä¸¤ä¸ªä½ç½®ï¼Œé—®ä½ æ»¡è¶³ç›¸é‚»ä¸¤ä¸ªä½ç½®çš„å­—æ¯è¦ä¹ˆç›¸ç­‰ï¼Œè¦ä¹ˆæœ‰ä¸€ä¸ªæ˜¯â€™bâ€™</p><p>æ²¡æœ‰bçš„æ—¶å€™ï¼Œæ˜¾ç„¶åªæœ‰å…¨æ˜¯aæˆ–è€…å…¨æ˜¯cæ‰èƒ½æ»¡è¶³æœ‰1ä¸ªbï¼Œåªèƒ½æ˜¯aaabccccæˆ–è€…ccccbaaaçš„å½¢å¼ï¼Œå–ä¸ªminå³å¯</p><h2 id="L"><a class="header-anchor" href="#L">Â¶</a>L</h2><p>ç»™ä¸€ä¸ªæ•°nï¼Œåˆå§‹æœ‰x=0ï¼Œæ¯æ¬¡æ“ä½œä»$[0, 2^n-1]$ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæ•°rï¼Œè®©$x=x^r$ï¼Œè®¾æœŸæœ›pæ­¥åè¯¥æ•°å˜ä¸º0ï¼Œé—®æœŸæœ›æ­¥æ•°çš„å¹³æ–¹</p><p>ç­”æ¡ˆå°±æ˜¯$\sum_{i=1}^{\infty}i^2(1-\frac{1}{2^n})^{i-1}\frac{1}{2^n}$</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p><a data-fancybox="gallery" data-src="/post-images/1607088246259.png" data-caption=""><img src="/post-images/1607088246259.png" alt=""></a>ç»™å‡ºä¸€ä¸ªåºåˆ—ï¼Œç„¶åæ‰§è¡Œä¸€æ¬¡ä¸Šè¿°å‡½æ•°åï¼Œé—®ä½ å¾—åˆ°çš„åºåˆ—è¿™ä¸ªå‡½æ•°å°±æ˜¯æ¯æ¬¡ä¼˜å…ˆæ‰¾åˆ°è·Ÿä½ ä¸è¿ç®—ä¸ç­‰äº0çš„æ•°ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„æ•°ï¼Œå†æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸è¿ç®—ç­‰äº0çš„ã€‚è€ƒè™‘ä¼˜åŒ–æ‰¾è¿™ä¸ªæ•°çš„è¿‡ç¨‹ä¸ä¸ç­‰äº0ï¼Œé‚£è‚¯å®šæœ‰ä¸€ä½ä½ æ˜¯1ï¼Œå®ƒä¹Ÿæ˜¯1ã€‚ç”¨30ä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—å­˜ç¬¬iä½ä¸º1çš„æ•°çš„ä¸‹æ ‡é‚£ä¹ˆå¦‚æœå½“å‰è¿›è¡Œåˆ°uï¼Œæšä¸¾30ä½ï¼Œæ‰¾åˆ°é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªæ²¡è®¿é—®è¿‡çš„æ•°ï¼Œå–å®ƒä»¬çš„æœ€å°æ•°å°±æ˜¯ä¸‹ä¸€ä¸ªæ•°äº†ã€‚æ˜¾ç„¶è®¿é—®è¿‡çš„æ•°å¯ä»¥popæ‰ã€‚å¦‚æœæ²¡æœ‰è¿™æ ·çš„æ•°äº†ï¼Œå‰©ä¸‹æ²¡è®¿é—®è¿‡çš„æ˜¾ç„¶è·Ÿä½ ä¸è¿ç®—éƒ½æ˜¯0ï¼Œç”¨ä¸ªé“¾è¡¨ç»´æŠ¤å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a[N], b[N], top;</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">queue&lt;<span class="type">int</span>&gt; q[<span class="number">32</span>];</span><br><span class="line"><span class="type">int</span> to[N], from[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(vis[u]) <span class="keyword">return</span>;</span><br><span class="line">  vis[u] = <span class="number">1</span>; b[++top] = a[u]; to[from[u]] = to[u]; from[to[u]] = from[u];</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> nxt = n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=<span class="number">30</span>; i++)</span><br><span class="line">      <span class="keyword">if</span>((a[u]&gt;&gt;i)&amp;<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span>(!q[i].<span class="built_in">empty</span>() &amp;&amp; vis[q[i].<span class="built_in">front</span>()]) q[i].<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(!q[i].<span class="built_in">empty</span>()) nxt = <span class="built_in">min</span>(nxt, q[i].<span class="built_in">front</span>());</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">if</span>(nxt==n+<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(nxt);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> nxt = to[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">while</span>(nxt&lt;=n &amp;&amp; vis[nxt]) nxt = to[nxt];</span><br><span class="line">  <span class="keyword">if</span>(nxt&lt;=n) <span class="built_in">dfs</span>(nxt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">freopen</span>(<span class="string">&quot;sorting.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    to[i] = i + <span class="number">1</span>; from[i] = i - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;=<span class="number">30</span>; j++)</span><br><span class="line">      <span class="keyword">if</span>((a[i]&gt;&gt;j)&amp;<span class="number">1</span>) q[j].<span class="built_in">push</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, b[i], <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h3><p>æœ‰ä¸€ä¸ªæ— å‘å›¾ï¼Œç„¶åç»™ä½ qä¸ªäºŒå…ƒç»„(d,c)ï¼Œè¡¨ç¤ºåœ¨ç¬¬då¤©ä¹‹å‰è®¿é—®è¿‡cï¼Œé—®ä½ ç¬¬0å¤©çš„èµ·ç‚¹å¯èƒ½æœ‰å‡ ä¸ªæŒ‰ç…§då‡åºç»™å‡ºï¼Œå…¶ä¸­ç¬¬iå¤©ä½ å¯ä»¥é€‰æ‹©ä¸åŠ¨ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç§»åˆ°ç›¸é‚»çš„ä¸€ä¸ªèŠ‚ç‚¹$n \leq 2000,m\leq 10^4$</p><p>æ˜¾ç„¶åœ¨æ¯ä¸ªç‚¹è·‘ä¸€ébfsæ±‚å‡ºä¸¤ä¸¤çš„æœ€çŸ­è·¯ï¼Œç›¸é‚»äºŒå…ƒç»„çš„åŸå¸‚æˆ‘ä»¬éƒ½èµ°æœ€çŸ­è·¯ï¼Œå¦‚æœåé¢å¤©æ•°ä¸å¤Ÿï¼Œåªèƒ½å¾€å‰é¢å€Ÿï¼Œå‡è®¾åé¢æœ€å¤šæ¬ äº†xå¤©ï¼Œé‚£ä¹ˆèµ·ç‚¹å’Œ$c_1$â€‹çš„è·ç¦»è¦æ»¡è¶³$\leq d_1-x$ã€‚ä¸€ä¸ªé”™è¯¯æ˜¯æˆ‘æŠŠbfsçš„è·ç¦»åˆå§‹åŒ–æˆ-1ï¼Œç„¶åæŸäº›ç‚¹å’Œ$c_1$â€‹å¯èƒ½ä¸è¿é€šï¼Œæˆ‘ä¹ŸæŠŠå®ƒç®—ä½œå¯è¡Œç‚¹äº†</p><h3 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h3><p>è¿˜ä»¥ä¸ºæ˜¯é“é«˜æ·±è®¡ç®—å‡ ä½•ï¼Œç„¶è€Œæ˜¯ä¸ªæ•°ä½dpæœ‰ä¸¤æ¡æ–œç‡ä¸º$s_1,s_2$â€‹,ä¸”éƒ½æ˜¯2çš„å¹‚æ¬¡çš„è¿‡åŸç‚¹çš„ç›´çº¿ï¼Œç»™å®š$x_l,x_r$â€‹è®©ä½ æ±‚$\sum_{i=x_l}^{x_r} (s_1i) \otimes (s_2i)$é¦–å…ˆå¯ä»¥è½¬æˆå‰ç¼€å’Œï¼ŒæŠŠä¸‹ç•Œé™å˜æˆ0ï¼Œç„¶åè®¾$2^{k_1}=s_1,2^{k_2}=s_2$æŠŠå¼å­å˜æˆ$\sum_{i=0}^{n}(i&lt;&lt;k_1) \otimes(i&lt;&lt;k_2)$è®¾$k_1&lt;k_2$â€‹ï¼Œå»æ‰$k_1$â€‹ï¼Œ$k_2$â€‹å˜æˆ$k=k_2-k_1$â€‹ï¼Œæœ€åç­”æ¡ˆä¹˜ä¸Š$2^{k_1}$â€‹åˆ™$\sum_{i=0}^{n}i \otimes (i&lt;&lt;k)$æ˜¾ç„¶æŒ‰ä½è€ƒè™‘å¯¹äº$[0,k-1]$ä½ï¼Œæˆ‘ä»¬åªè¦ç»Ÿè®¡$[0,n]$ä¸­é‚£ä½ç­‰äº1çš„æ•°é‡å¯¹äº$[41-k,40]$ä½ï¼Œæˆ‘ä»¬ä¹Ÿåªè¦ç»Ÿè®¡$[0,n]$ä¸­é‚£ä½ç­‰äº1çš„æ•°é‡å¯¹äº$[k,40]$ä½ï¼Œæˆ‘ä»¬è¦ç»Ÿè®¡$[0,n]$ä¸­xä½ä¸ç­‰äºx-kä½çš„æ•°é‡å†™ä¸¤ä¸ªæ•°ä½dpå°±è¡Œäº†ã€‚ã€‚å†™å®Œä¸€ä¸ªï¼Œcvä¸€ä¸‹æ”¹æ”¹å°±è¡Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll s1, s2, xl, xr;</span><br><span class="line">ll dp[<span class="number">45</span>][<span class="number">2</span>], dp2[<span class="number">45</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> a[<span class="number">45</span>], top;</span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> lim, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  ll &amp;x = dp[p][lim];</span><br><span class="line">  <span class="keyword">if</span>(~x) <span class="keyword">return</span> x;</span><br><span class="line">  x = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> up = lim ? a[p] : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(p==t)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(up==<span class="number">1</span>) x = <span class="built_in">dfs</span>(p<span class="number">-1</span>, lim, t);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=up; i++)</span><br><span class="line">      x = (x + <span class="built_in">dfs</span>(p<span class="number">-1</span>, lim&amp;&amp;i==up, t))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">dfs2</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> lim, <span class="type">int</span> tv, <span class="type">int</span> t, <span class="type">int</span> t2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  ll &amp;x = dp2[p][lim][tv];</span><br><span class="line">  <span class="keyword">if</span>(~x) <span class="keyword">return</span> x;</span><br><span class="line">  x = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> up = lim ? a[p] : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=up; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p==t) x = (x + <span class="built_in">dfs2</span>(p<span class="number">-1</span>, lim&amp;&amp;i==up, i, t, t2))%mod;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p==t2 &amp;&amp; tv!=i) x = (x + <span class="built_in">dfs2</span>(p<span class="number">-1</span>, lim&amp;&amp;i==up, tv, t, t2))%mod;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p!=t2) x = (x + <span class="built_in">dfs2</span>(p<span class="number">-1</span>, lim&amp;&amp;i==up, tv, t, t2))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">work</span><span class="params">(<span class="type">int</span> k, ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">    ll n = x;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    &#123;</span><br><span class="line">      a[top++] = n&amp;<span class="number">1</span>;</span><br><span class="line">      n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top&lt;=<span class="number">40</span>) a[top++] = <span class="number">0</span>;</span><br><span class="line">    ans = (ans + (<span class="number">1ll</span>&lt;&lt;i)%mod*<span class="built_in">dfs</span>(top<span class="number">-1</span>, <span class="number">1</span>, i))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">41</span>-k; i&lt;=<span class="number">40</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">    ll n = x;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    &#123;</span><br><span class="line">      a[top++] = n&amp;<span class="number">1</span>;</span><br><span class="line">      n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top&lt;=<span class="number">40</span>) a[top++] = <span class="number">0</span>;</span><br><span class="line">    ans = (ans + (<span class="number">1ll</span>&lt;&lt;(i+k))%mod*<span class="built_in">dfs</span>(top<span class="number">-1</span>, <span class="number">1</span>, i))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=k; i&lt;=<span class="number">40</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp2, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp2));</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">    ll n = x;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    &#123;</span><br><span class="line">      a[top++] = n&amp;<span class="number">1</span>;</span><br><span class="line">      n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top&lt;=<span class="number">40</span>) a[top++] = <span class="number">0</span>;</span><br><span class="line">    ans = (ans + (<span class="number">1ll</span>&lt;&lt;i)%mod*<span class="built_in">dfs2</span>(top<span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, i, i-k))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> k1 = <span class="number">0</span>, k2 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>, &amp;s1, &amp;s2, &amp;xl, &amp;xr);</span><br><span class="line">  <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;k1)&lt;s1) ++k1;</span><br><span class="line">  <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;k2)&lt;s2) ++k2;</span><br><span class="line">  <span class="keyword">if</span>(k1&gt;k2) <span class="built_in">swap</span>(k1, k2);</span><br><span class="line">  <span class="type">int</span> k = k2 - k1;</span><br><span class="line">  <span class="keyword">if</span>(!k) &#123; <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">  ll ans = (<span class="built_in">work</span>(k, xr) - <span class="built_in">work</span>(k, xl<span class="number">-1</span>) + mod)%mod;</span><br><span class="line">  ans = (<span class="number">1ll</span>&lt;&lt;k1)%mod*ans%mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">freopen</span>(<span class="string">&quot;geometry.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h3><p>æœ‰ä¸€ä¸ªæ— å‘å›¾ï¼Œç„¶åç»™ä½ ä¸€ä¸ªæŸä¸ªç‚¹såˆ°å…¶ä»–ç‚¹æœ€çŸ­è·¯çš„æ•°ç»„dï¼Œä¸”è¦æ±‚æœ€çŸ­è·¯è‡³å°‘è¦ç»è¿‡ä¸€æ¡è¾¹è¿™ä¸ªé™åˆ¶æ˜¯ä¸ºäº†é˜²æ­¢$d_s=0$ï¼Œè®©ä½ æ‰¾åˆ°æœ€å°çš„æ»¡è¶³æ¡ä»¶çš„s</p><p>æ²¡æœ‰æƒ³åˆ°å¾ˆå¥½çš„åšæ³•ï¼Œç»™å‡ºä¸€ç§å¥‡æ€ªçš„åšæ³•è€ƒè™‘ä»¥sä¸ºæºç‚¹çš„è·ç¦»æ•°ç»„æ„æˆçš„æœ€çŸ­è·¯å›¾å¦‚æœè¿™ä¸ªè·ç¦»æ•°ç»„æ˜¯åˆæ³•çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæœ€çŸ­è·¯å›¾è¦æ»¡è¶³æ˜¯ä¸€ä¸ªè¿é€šçš„DAGï¼Œä¸”åªæœ‰sçš„å…¥åº¦ç­‰äº0æˆ‘ä»¬å¯¹æ¯ä¸ªç‚¹iï¼Œè®©$d_i=0$ï¼Œç„¶åå»ºå‡ºæœ€çŸ­è·¯å›¾åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦æ»¡è¶³ä»¥ä¸Šæ¡ä»¶å°±çŸ¥é“ièƒ½ä¸èƒ½æ˜¯æºç‚¹äº†ä¸‹é¢è€ƒè™‘åŠ é€Ÿä»¥ä¸Šåšæ³•æˆ‘ä»¬å…ˆæŠŠåŸæ•°ç»„çš„æœ€çŸ­è·¯å›¾å»ºå‡ºæ¥ï¼Œå¯¹äºæ¯ä¸ªiï¼ŒæŠŠå’Œå®ƒæœ‰å…³çš„è¾¹å»æ‰ï¼Œç„¶åè®©$d_i=0$ï¼Œå†æšä¸¾å’Œå®ƒç›¸è¿çš„è¾¹å»ºå‡ºæ–°è¾¹å³å¯ã€‚é‚£ä¹ˆå¯¹äºåŸæ•°ç»„å»ºå‡ºçš„æœ€çŸ­è·¯å›¾ä¸­çš„æŸæ¡è¾¹$(i,j)$(i&lt;j)æ¥è¯´ï¼Œå®ƒå­˜åœ¨äº[1,iâˆ’1],[i+1,jâˆ’1]ï¼Œ[j+1,n][1,i-1],[i+1,j-1]ï¼Œ[j+1,n][1,iâˆ’1],[i+1,jâˆ’1]ï¼Œ[j+1,n]è¿™ä¸‰ä¸ªåŒºé—´æ‰€ä»¥çº¿æ®µæ ‘åˆ†æ²»å³å¯ï¼Œåœ¨å¶å­çš„æ—¶å€™å†å»ºå‡ºæ–°è¾¹ã€‚æ³¨æ„ç»´æŠ¤è¿é€šå—æ•°é‡ä»¥åŠå…¥åº¦ä¸º0çš„ç‚¹æ•°è¿˜éœ€è¦æ³¨æ„è¦æ»¡è¶³içš„æ‰€æœ‰è¾¹çš„æƒå€¼çš„æœ€å°å€¼è¦æ˜¯$d_i$â€‹çš„ä¸€åŠ</p><p>çº¿æ®µæ ‘åˆ†æ²»åœ¨å¶å­ä¸è¦å¿˜è®°rollback<code>if(l==r)</code>ä¸è¦return</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">ll s[N];</span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; G[N];</span><br><span class="line"><span class="type">int</span> fa[N], sz[N], undo[N*<span class="number">3</span>], top, scc, ans, deg[N], zcnt;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(x!=fa[x]) x = fa[x];</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  x = <span class="built_in">find</span>(x), y = <span class="built_in">find</span>(y);</span><br><span class="line">  <span class="keyword">if</span>(x==y) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(sz[x]&gt;sz[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">  undo[++top] = x;</span><br><span class="line">  --scc;</span><br><span class="line">  fa[x] = y;</span><br><span class="line">  sz[y] += sz[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rollback</span><span class="params">(<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(top&gt;t)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x = undo[top];</span><br><span class="line">    sz[fa[x]] -= sz[x];</span><br><span class="line">    fa[x] = x;</span><br><span class="line">    ++scc;</span><br><span class="line">    --top;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; op[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> px, <span class="type">int</span> py)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">  &#123;</span><br><span class="line">    op[p].<span class="built_in">emplace_back</span>(px, py);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ins</span>(p&lt;&lt;<span class="number">1</span>, l, mid, x, y, px, py);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">ins</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r, x, y, px, py);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(~ans) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> dfn = top;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : op[p])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">merge</span>(it.fi, it.se);</span><br><span class="line">    <span class="keyword">if</span>(!deg[it.se]) --zcnt;</span><br><span class="line">    ++deg[it.se];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> tmp = top, mn = inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[l])</span><br><span class="line">    &#123;</span><br><span class="line">      mn = <span class="built_in">min</span>(mn, it.se);</span><br><span class="line">      <span class="keyword">if</span>(it.se==s[it.fi])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">merge</span>(l, it.fi);</span><br><span class="line">        <span class="keyword">if</span>(!deg[it.fi]) --zcnt;</span><br><span class="line">        ++deg[it.fi];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(scc==<span class="number">1</span> &amp;&amp; zcnt==<span class="number">1</span> &amp;&amp; mn*<span class="number">2</span>==s[l]) ans = l;</span><br><span class="line">    <span class="built_in">rollback</span>(tmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[l])</span><br><span class="line">      <span class="keyword">if</span>(it.se==s[it.fi])</span><br><span class="line">        <span class="keyword">if</span>(!(--deg[it.fi])) ++zcnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">go</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">go</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">rollback</span>(dfn);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : op[p])</span><br><span class="line">    <span class="keyword">if</span>(!(--deg[it.se])) ++zcnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">freopen</span>(<span class="string">&quot;hide.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, s+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">    G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fa[i] = i, sz[i] = <span class="number">1</span>;</span><br><span class="line">  scc = n, ans = <span class="number">-1</span>, zcnt = n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[i])</span><br><span class="line">      <span class="keyword">if</span>(s[i]+it.se==s[it.fi])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> x = i, y = it.fi;</span><br><span class="line">        <span class="keyword">if</span>(x&gt;y) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span>(x&gt;<span class="number">1</span>) <span class="built_in">ins</span>(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, x<span class="number">-1</span>, i, it.fi);</span><br><span class="line">        <span class="keyword">if</span>(y&lt;n) <span class="built_in">ins</span>(<span class="number">1</span>, <span class="number">1</span>, n, y+<span class="number">1</span>, n, i, it.fi);</span><br><span class="line">        <span class="keyword">if</span>(x+<span class="number">1</span>&lt;y) <span class="built_in">ins</span>(<span class="number">1</span>, <span class="number">1</span>, n, x+<span class="number">1</span>, y<span class="number">-1</span>, i, it.fi);</span><br><span class="line">      &#125;</span><br><span class="line">  <span class="built_in">go</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒæ¬¡å‰©ä½™</title>
      <link href="/2020/12/03/er-ci-sheng-yu/"/>
      <url>/2020/12/03/er-ci-sheng-yu/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šnå’Œå¥‡ç´ æ•°pï¼Œæ±‚xæ»¡è¶³$x^2 \equiv n ($mod$\ p)$</p><p>é¦–å…ˆè€ƒè™‘æœ‰æ²¡æœ‰è§£ï¼Œæœ‰è§£çš„nç§°ä¸ºäºŒæ¬¡å‰©ä½™ï¼Œæ— è§£çš„nç§°ä¸ºéäºŒæ¬¡å‰©ä½™æ ¹æ®è´¹é©¬å°å®šç†ï¼Œå½“pä¸ºè´¨æ•°æ—¶ï¼Œæ»¡è¶³$n^p \equiv n ($mod$\ p)$ç”±äºpæ˜¯å¥‡è´¨æ•°ï¼Œåˆ™$n^{2\frac{p-1}{2}} \equiv 1 ($mod$\ p)$å³$n^{\frac{p-1}{2}}$â€‹ä¸º1åœ¨æ¨¡pæ„ä¹‰ä¸‹å¼€æ ¹çš„ç»“æœï¼Œåªæœ‰1å’Œ-1ä¸¤ç§å¯èƒ½æœ‰æ¬§æ‹‰å‡†åˆ™ï¼Œå½“$n^{\frac{p-1}{2}} \equiv 1$æ—¶ï¼Œnæ˜¯äºŒæ¬¡å‰©ä½™ï¼Œå¦åˆ™æ˜¯éäºŒæ¬¡å‰©ä½™ã€‚å½“næ˜¯äºŒæ¬¡å‰©ä½™æ—¶ï¼Œæ˜“å¾—$x^{2\frac{p-1}{2}} \equiv x^{p-1} \equiv 1$æˆç«‹ï¼Œå¿…è¦æ€§å¾—åˆ°ã€‚å……åˆ†æ€§ä»¥åŠéäºŒæ¬¡å‰©ä½™çš„è¯æ˜é¸½äº†ã€‚</p><p>å†è€ƒè™‘æœ‰è§£æ—¶æœ‰å‡ ä¸ªè§£ï¼Œè®¾ä¸¤ä¸ªä¸åŒçš„è§£$x_1,x_2$â€‹ï¼Œåˆ™æ»¡è¶³$x_1^2 \equivx_2^2$â€‹ï¼Œå³$x_1^2-x_2^2 \equiv (x_1+x_2)(x_1-x_2)\equiv 0$ï¼Œç”±äº$x_1 \neq x_2$â€‹ï¼Œåªæœ‰å¯èƒ½$x_1$å’Œ$x_2$äº’ä¸ºç›¸åæ•°ï¼Œç”±äº$p$æ˜¯å¥‡æ•°ï¼Œ$x_1$å’Œ$x_2$çš„å¥‡å¶æ€§ä¸€å®šä¸åŒï¼Œå› æ­¤å€¼ä¸€å®šä¸åŒã€‚æ‰€ä»¥é™¤0å¤–æ¯ä¸ªäºŒæ¬¡å‰©ä½™éƒ½å¯¹åº”ä¸¤ä¸ªè§£ï¼Œä¸”è¿™ä¸¤ä¸ªè§£äº’ä¸ºç›¸åæ•°ã€‚åŒæ ·çš„ï¼Œä¸¤ä¸ªç›¸åæ•°å¯¹åº”äº†ä¸€ä¸ªäºŒæ¬¡å‰©ä½™ï¼Œå› æ­¤åœ¨$[1,p-1]$ä¸­æ€»å…±æœ‰$\frac{p-1}{2}$â€‹ä¸ªäºŒæ¬¡å‰©ä½™</p><p>æœ€åè€ƒè™‘æœ‰è§£æ—¶æ€ä¹ˆæ±‚ã€‚å…ˆæ‰¾åˆ°ä¸€ä¸ªaï¼Œæ»¡è¶³$a^2-n$æ˜¯éäºŒæ¬¡å‰©ä½™ï¼Œéšæœºæ‰¾å³å¯ï¼Œä¸€æ¬¡æœ‰$\frac{1}{2}$â€‹çš„æ¦‚ç‡æ‰¾åˆ°ä»¤$i^2 \equiv a^2-n$æœ‰$(a+i)^{p+1} \equiv n$</p><ul><li>$i^p \equiv i(a^2-n)^{\frac{p-1}{2}} \equiv -i$</li><li>$(a+b)^p \equiv a^p+b^p$ è€ƒè™‘äºŒé¡¹å¼å®šç†$(a+i)^{p+1} \equiv (a^p+i^p)(a+i) \equiv (a-i)(a+i) \equiv n$é‚£ä¹ˆ$(a+i)^{\frac{p+1}{2}}$â€‹å°±æ˜¯ä¸€ä¸ªè§£ç”±äº$a^2-n$æ˜¯éäºŒæ¬¡å‰©ä½™ï¼Œå› æ­¤$i$å®é™…ä¸å­˜åœ¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç±»ä¼¼å¤æ•°ä¸€æ ·å®šä¹‰ï¼Œç„¶åå®šä¹‰ä¹˜æ³•å³å¯è®¡ç®—å¿«é€Ÿå¹‚äº†ï¼Œå®šä¹‰å½¢å¦‚$a+bi$ï¼Œåˆ™$a+i$å°±æ˜¯$a+1i$$(a+bi)(c+di) \equiv (ac+bdi^2+adi+bci)$ï¼ŒæŠŠ$i^2$ç”¨$a^2-n$ä»£æ›¿å³å¯</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">ll w, n, p;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Complex</span></span><br><span class="line">&#123;</span><br><span class="line">  ll x, y;</span><br><span class="line">  <span class="built_in">Complex</span>(<span class="type">int</span> _x,<span class="type">int</span> _y) : <span class="built_in">x</span>(_x), <span class="built_in">y</span>(_y) &#123;&#125;</span><br><span class="line">  Complex <span class="keyword">operator</span> * (<span class="type">const</span> Complex &amp;b) <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Complex</span>(((x*b.x%p+y*b.y%p*w%p)%p+p)%p,((x*b.y%p+y*b.x%p)%p+p)%p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">ll <span class="title">powcp</span><span class="params">(Complex a,ll b,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="function">Complex <span class="title">ans</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = ans*a;</span><br><span class="line">    a = a*a;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll n,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  n %= p;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">2</span>) <span class="keyword">return</span> n;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">powmod</span>(n,(p<span class="number">-1</span>)/<span class="number">2</span>,p)==p<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">//æ— è§£</span></span><br><span class="line">  ll a;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    a = <span class="built_in">rand</span>()%p;</span><br><span class="line">    w = ((a*a%p-n)%p+p)%p;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">powmod</span>(w,(p<span class="number">-1</span>)/<span class="number">2</span>,p)==p<span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">Complex <span class="title">x</span><span class="params">(a,<span class="number">1</span>)</span></span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">powcp</span>(x,(p+<span class="number">1</span>)/<span class="number">2</span>,p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">int</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>)));</span><br><span class="line">ll ans1 = <span class="built_in">solve</span>(n,p), ans2;</span><br><span class="line"><span class="keyword">if</span>(ans1==<span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">&quot;Hola!\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  ans2 = p - ans1;</span><br><span class="line">  <span class="keyword">if</span>(ans1&gt;ans2) <span class="built_in">swap</span>(ans1,ans2);</span><br><span class="line">  <span class="keyword">if</span>(ans1==ans2) <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans1);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>,ans1,ans2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°åšæ³•ç”±äºè¦æ‰‹å†™ä¸€ä¸ªå¤æ•°ç±»ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”å¸¸æ•°ä¹Ÿå¤§ï¼Œè¿˜æœ‰ä¸€ç§<code>ToneLLi_Shanks</code>ç®—æ³•åŸç†é¸½äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">TS</span><span class="params">(ll n, ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">2</span>) <span class="keyword">return</span> (n&amp;<span class="number">1</span>) ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">Pow</span>(n, p&gt;&gt;<span class="number">1</span>, p)!=<span class="number">1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span>(p&amp;<span class="number">2</span>) <span class="keyword">return</span> <span class="built_in">Pow</span>(n, (p+<span class="number">1</span>)&gt;&gt;<span class="number">2</span>, p);</span><br><span class="line">  <span class="type">int</span> s = __builtin_ctzll(p^<span class="number">1</span>);</span><br><span class="line">  ll q = p&gt;&gt;s, z = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">for</span>(; <span class="built_in">Pow</span>(z, p&gt;&gt;<span class="number">1</span>, p)==<span class="number">1</span>; z++);</span><br><span class="line">  ll c = <span class="built_in">Pow</span>(z, q, p);</span><br><span class="line">  ll r = <span class="built_in">Pow</span>(n, (q+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>, p);</span><br><span class="line">  ll t = <span class="built_in">Pow</span>(n, q, p), tmp;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> m=s, i; t!=<span class="number">1</span>; )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>, tmp=t; tmp!=<span class="number">1</span>; i++) tmp = tmp*tmp%p;</span><br><span class="line">    <span class="keyword">for</span>(; i&lt;--m; ) c = c*c%p;</span><br><span class="line">    r = r*c%p;</span><br><span class="line">    c = c*c%p;</span><br><span class="line">    t = t*c%p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;p);</span><br><span class="line">  ll ans = <span class="built_in">TS</span>(n, p);</span><br><span class="line">  <span class="keyword">if</span>(ans==<span class="number">-1</span>) <span class="built_in">puts</span>(<span class="string">&quot;Hola!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(!ans) <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    ll ans2 = p - ans;</span><br><span class="line">    <span class="keyword">if</span>(ans&gt;ans2) <span class="built_in">swap</span>(ans, ans2);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, ans, ans2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¡¥å……ï¼šå¯¹äºä¸‰æ¬¡å‰©ä½™è‹¥$p % 3 = 2$ï¼Œåˆ™æ¯ä¸ªæ•°éƒ½æ˜¯ä¸‰æ¬¡å‰©ä½™ï¼Œå¹¶ä¸”æœ‰å”¯ä¸€è§£$n^{\frac{2p-1}{3}}$â€‹è‹¥$p % 3 = 1$ï¼Œåˆ™æœ‰$\frac{p-1}{3}$â€‹ä¸ªæ•°æ˜¯ä¸‰æ¬¡å‰©ä½™ï¼Œä¸”æ¯ä¸ªæ•°æœ‰ä¸‰ä¸ªè§£</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ç§¦çš‡å²› J Jewel Splitting</title>
      <link href="/2020/12/03/2020-qin-huang-dao-j-jewel-splitting/"/>
      <url>/2020/12/03/2020-qin-huang-dao-j-jewel-splitting/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ä¸€ä¸ªé•¿åº¦ä¸ºnçš„å­—ç¬¦ä¸²ï¼Œè®©ä½ æ’æˆé•¿ä¸ºdï¼Œå®½ä¸º$\lfloor \frac{n}{d}\rfloor$çš„çŸ©å½¢ï¼Œå³å°†è¿ç»­çš„é•¿åº¦dçš„å­ä¸²ä½œä¸ºä¸€è¡Œï¼Œå¤šä½™çš„n%dä¸ªä¸¢å¼ƒï¼Œé—®æœ‰å¤šå°‘ç§ä¸åŒçš„çŸ©å½¢ï¼Œmod 998244353$n \leq 3 \times 10^5$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>æ˜¾ç„¶ä¸åŒçš„däº’ä¸å½±å“ï¼Œå¯ä»¥åˆ†å¼€åšå½“$d \mid n$ï¼Œå°±æ˜¯ä¸€ä¸ªå¯é‡é›†æ’åˆ—ï¼Œç”¨mapæ¥ç»´æŠ¤æ¯ç§hashå€¼å‡ºç°çš„ä¸ªæ•°å½“$d \nmid n$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šä¸¢å¼ƒ$[1,n%d],[d+1,d+n%d]â€¦$ï¼Œå®¹æ˜“å‘ç°ç›¸é‚»ä¸¤ç§åªæœ‰ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸åŒçš„ï¼Œå› æ­¤åŠ¨æ€ç»´æŠ¤å³å¯ã€‚æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œä¸¢å¼ƒä¸åŒçš„åŒºé—´ï¼Œå‰©ä½™çš„ä¸²çš„ç±»å‹æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œå³è¿™ä¸ªçŠ¶æ€çš„mapæ˜¯ä¸€æ ·çš„ï¼Œè¿™æ—¶å€™ä¸èƒ½é‡å¤ç®—ï¼Œå› æ­¤è¿˜è¦å¯¹æ¯ä¸ªæ—¶åˆ»çš„mapçŠ¶æ€è¿›è¡Œhashã€‚æ€è·¯ä¸éš¾ï¼Œä½†æ˜¯å¡å¸¸ã€‚ä¸åŒhashä¼šwaï¼ŒåŒhashåˆtleğŸ¤¡</p><p>å­—ç¬¦ä¸²çš„rollinghashçš„æœ¬è´¨å…¶å®å°±æ˜¯å°†è¿™ä¸ªå­—ç¬¦ä¸²ç”¨baseè¿›åˆ¶çš„æ•°æ¥è¡¨ç¤ºï¼Œç„¶åå¯ä»¥O(1)çš„æ±‚æ¯ä¸ªå­åŒºé—´çš„hashå€¼ï¼ˆæˆ‘å¥½åƒåˆ°ç°åœ¨æ‰æ˜ç™½å­—ç¬¦ä¸²hashå°±æ˜¯ç”¨baseè¿›åˆ¶æ•°æ¥è¡¨ç¤ºã€‚ã€‚ã€‚ï¼‰è€ƒè™‘mapçš„çŠ¶æ€æ€ä¹ˆæ±‚ï¼Œå°±ç›¸å¯¹äºæœ‰å¾ˆå¤špairsï¼Œï¼ˆhashï¼Œcntï¼‰ã€‚æˆ‘çš„åšæ³•æ˜¯æŠŠhashå€¼ä¸¢åˆ°mapé‡Œç„¶åæ˜ å°„æˆå°çš„ç¼–å·ï¼Œç„¶åcntå°±å¯ä»¥ç”¨æ•°ç»„æ¥å­˜äº†ï¼Œç„¶åmapçš„çŠ¶æ€å°±ç›¸å½“äºç¬¬id[hash]ä½çš„å€¼ä¸ºcntï¼Œç”¨cnt*pw[id[hash]]æ¥è¡¨ç¤ºå³å¯ã€‚å¦‚æœåªè¦æ•´ä¸ªä¸²çš„hashå€¼ï¼Œå„ä¸ªä½çš„å€¼ç”¨å¼‚æˆ–ä¹Ÿæ˜¯å¯ä»¥ï¼Œè¿™æ ·å¯ä»¥å¿«ç‚¹ã€‚ç„¶åå°±æ˜¯åŒhashçš„å€¼ï¼Œç”¨pairçš„è¯è‚¯å®šä¼šæ…¢ï¼Œè¿™é‡Œç”¨intå­˜ï¼Œç„¶åé«˜ä½ä½åˆå¹¶æˆä¸€ä¸ªullå³å¯ã€‚</p><p>é€šè¿‡è¿™é¢˜æµ‹äº†ä¸€ä¸‹å„ç§mapå’Œsetunordered_setå¾ˆæ²¡ç”¨ï¼Œsetå’Œmapæ¯”è¾ƒç¨³å®šï¼Œunordered_mapæœ‰æ—¶å¿«æœ‰æ—¶æ…¢ï¼ŒåŠ äº†æ‰‹å†™hashä¹Ÿæ…¢ï¼Œå¾ˆä¸ç¨³å®šã€‚æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹è¿˜æ˜¯ç”¨setå’Œmapå°±è¡Œäº†ï¼Œç¨³å®šlogï¼Œunorderedå®¹æ˜“å¡æˆnå¦‚æœè¦å®ç°æ— åºçš„setï¼Œä¸æ¨èunordered_setã€‚å¦‚æœå¯ä»¥ç¦»çº¿ï¼Œé‚£å°±vectoræ­¤å¤–pbdsçš„gp_hash_tableå¾ˆå¿«ï¼Œè¢«å¡mapå¯ä»¥ç”¨è¿™ä¸ªä»£æ›¿unordered_map</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">int</span>&gt; id;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">bool</span>&gt; vis;</span><br><span class="line">gp_hash_table&lt;ull, null_type&gt; vis;</span><br></pre></td></tr></table></figure><p>æ— åºsetä¹Ÿå¯ä»¥ç”¨ä¸‹é¢ä¸¤ä¸ªï¼Œæµ‹å‡ºæ¥boolå¿«ä¸€ç‚¹ï¼Œnull_typeå†…å­˜å°ç‚¹gp_hash_tableå°è£…çš„å‡½æ•°ä¸å¤šï¼Œåªæœ‰ä¸‹æ ‡ã€insertè¦å®ç°countï¼Œè¦é find==endæ‰€ä»¥æœ€å¥½å¼€å±€éƒ¨ï¼Œä¸è¦å¼€å…¨å±€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapï¼š2700ms</span><br><span class="line">gp_hash_tableï¼š1700ms</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ull = <span class="type">uint64_t</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, mod2 = <span class="number">1e9</span> + <span class="number">9</span>, base = <span class="number">19260817</span>;</span><br><span class="line"><span class="type">int</span> kase;</span><br><span class="line"><span class="type">int</span> n, fac[N&lt;&lt;<span class="number">1</span>], ifac[N&lt;&lt;<span class="number">1</span>], cnt[N&lt;&lt;<span class="number">1</span>], ans, tot;</span><br><span class="line"><span class="type">int</span> HSH, HSH2;</span><br><span class="line"><span class="comment">//map&lt;ull, int&gt; id;</span></span><br><span class="line">gp_hash_table&lt;ull, <span class="type">int</span>&gt; id;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">bool</span>&gt; vis;</span><br><span class="line"><span class="comment">//map&lt;int, bool&gt; vis;</span></span><br><span class="line"><span class="comment">//set&lt;int&gt; st;</span></span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> pw[N&lt;&lt;<span class="number">1</span>], pw2[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> hsh[N], hsh2[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123; x += y; <span class="keyword">if</span>(x&gt;=mod) x -= mod; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Pow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  pw[<span class="number">0</span>] = pw2[<span class="number">0</span>] = fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">2</span>*n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    pw[i] = <span class="number">1ll</span>*pw[i<span class="number">-1</span>]*base%mod;</span><br><span class="line">    pw2[i] = <span class="number">1ll</span>*pw2[i<span class="number">-1</span>]*base%mod2;</span><br><span class="line">    fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  ifac[n] = <span class="built_in">Pow</span>(fac[n], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    hsh[i] = (<span class="number">1ll</span>*hsh[i<span class="number">-1</span>]*base%mod + s[i])%mod;</span><br><span class="line">    hsh2[i] = (<span class="number">1ll</span>*hsh2[i<span class="number">-1</span>]*base%mod2 + s[i])%mod2;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; x -= y; <span class="keyword">if</span>(x&lt;<span class="number">0</span>) x += mod; <span class="keyword">return</span> x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub2</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; x -= y; <span class="keyword">if</span>(x&lt;<span class="number">0</span>) x += mod2; <span class="keyword">return</span> x; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">Sub</span>(hsh[r], <span class="number">1ll</span>*hsh[l<span class="number">-1</span>]*pw[r-l+<span class="number">1</span>]%mod); &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get2</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">Sub2</span>(hsh2[r], <span class="number">1ll</span>*hsh2[l<span class="number">-1</span>]*pw2[r-l+<span class="number">1</span>]%mod2); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ull hv = (ull)<span class="built_in">get</span>(l, r)&lt;&lt;<span class="number">32</span>|<span class="built_in">get2</span>(l, r), p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">auto</span> it = id.<span class="built_in">find</span>(hv);</span><br><span class="line">  <span class="keyword">if</span>(it==id.<span class="built_in">end</span>()) p = id[hv] = ++tot;</span><br><span class="line">  <span class="keyword">else</span> p = it-&gt;second;</span><br><span class="line">  HSH ^= <span class="number">1ll</span>*pw[p]*cnt[p]%mod;</span><br><span class="line">  HSH2 ^= <span class="number">1ll</span>*pw2[p]*cnt[p]%mod2;</span><br><span class="line">  ans = <span class="number">1ll</span>*ans*fac[cnt[p]]%mod*ifac[cnt[p] + v]%mod;</span><br><span class="line">  cnt[p] += v;</span><br><span class="line">  HSH ^= <span class="number">1ll</span>*pw[p]*cnt[p]%mod;</span><br><span class="line">  HSH2 ^= <span class="number">1ll</span>*pw2[p]*cnt[p]%mod2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(gp_hash_table&lt;ull, <span class="type">int</span>&gt; &amp;table)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  gp_hash_table&lt;ull, <span class="type">int</span>&gt; tmp;</span><br><span class="line">  table.<span class="built_in">swap</span>(tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(gp_hash_table&lt;ull, <span class="type">bool</span>&gt; &amp;table)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  gp_hash_table&lt;ull, <span class="type">bool</span>&gt; tmp;</span><br><span class="line">  table.<span class="built_in">swap</span>(tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">work</span><span class="params">(<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=tot; i++) cnt[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//st.clear();</span></span><br><span class="line">  <span class="built_in">clear</span>(id); <span class="built_in">clear</span>(vis);</span><br><span class="line">  tot = HSH = HSH2 = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">  ans = fac[n/d];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n%d+<span class="number">1</span>; i&lt;=n; i+=d) <span class="built_in">upd</span>(i, i+d<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="comment">//vector&lt;pair&lt;ull, int&gt;&gt; lsh;</span></span><br><span class="line">  <span class="comment">//lsh.push_back(&#123;(ull)HSH&lt;&lt;32|HSH2, ans&#125;);</span></span><br><span class="line">  <span class="built_in">Add</span>(sum, ans); vis.<span class="built_in">insert</span>(&#123;(ull)HSH&lt;&lt;<span class="number">32</span>|HSH2, <span class="number">1</span>&#125;);</span><br><span class="line">  <span class="keyword">if</span>(n%d)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> m = n/d*d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;m; i+=d)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">upd</span>(i, i+d<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="built_in">upd</span>(i+n%d, i+n%d+d<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">      <span class="comment">//lsh.push_back(&#123;(ull)HSH&lt;&lt;32|HSH2, ans&#125;);</span></span><br><span class="line">      <span class="keyword">if</span>(vis.<span class="built_in">find</span>((ull)HSH&lt;&lt;<span class="number">32</span>|HSH2)==vis.<span class="built_in">end</span>()) <span class="built_in">Add</span>(sum, ans), vis.<span class="built_in">insert</span>(&#123;(ull)HSH&lt;&lt;<span class="number">32</span>|HSH2, <span class="number">1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  sort(begin(lsh), end(lsh));</span></span><br><span class="line"><span class="comment">  for(int i=0; i&lt;(int)lsh.size(); )</span></span><br><span class="line"><span class="comment">  &#123;</span></span><br><span class="line"><span class="comment">    int j = i + 1;</span></span><br><span class="line"><span class="comment">    while(j&lt;(int)lsh.size() &amp;&amp; lsh[j]==lsh[i])</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">      //assert(lsh[j].second==lsh[i].second);</span></span><br><span class="line"><span class="comment">      ++j;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    Add(sum, lsh[i].second);</span></span><br><span class="line"><span class="comment">    i = j;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s+<span class="number">1</span>);</span><br><span class="line">  <span class="comment">//for(int i=1; i&lt;=300000; i++) s[i] = char(&#x27;a&#x27;+i%26);</span></span><br><span class="line">  <span class="comment">//s[300001] = 0;</span></span><br><span class="line">  n = <span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> d=<span class="number">1</span>; d&lt;=n; d++) <span class="built_in">Add</span>(res, <span class="built_in">work</span>(d));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: %d\n&quot;</span>, ++kase, res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">pre</span>(N<span class="number">-5</span>);</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codechef Counting Spaghetti æ•°å­¦</title>
      <link href="/2020/11/25/codechef-counting-spaghetti-shu-xue/"/>
      <url>/2020/11/25/codechef-counting-spaghetti-shu-xue/</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨æœ‰$L, L+1,â€¦R-1,R$è¿™R-L+1ä¸ªæ•°å­—ï¼Œé—®ä½ èƒ½å¤Ÿç»„æˆå¤šå°‘ç§ä¸åŒçš„æ•°å­—å’Œ$L \leq 10^9, R \leq 10^9$</p><p>è€ƒè™‘ç”¨xä¸ªæ•°å­—æ¥ç»„åˆ1ä¸ªæ•°å­—ï¼š$[L, R]$å†…çš„æ‰€æœ‰æ•°å­—</p><p>2ä¸ªæ•°å­—ï¼š$[L+L+1, R+R-1]$å†…çš„æ‰€æœ‰æ•°å­—</p><p>3ä¸ªæ•°å­—ï¼š$[L+L+1+L+2, R+R-1-R-2]$å†…çš„æ‰€æœ‰æ•°å­—</p><p>åˆ™å¯¹äºxä¸ªæ•°å­—æœ‰ï¼š$l_x = \frac{x(2L+x-1)}{2}$, $r_x = \frac{x(2R-x+1)}{2}$</p><p>å› æ­¤åªè¦æ±‚ç”¨1$\sim$R-L+1ä¸ªæ•°å­—æ„æˆçš„å„ä¸ªåŒºé—´çš„å¹¶é›†çš„é•¿åº¦å³å¯è€ƒè™‘$l_x&gt;r_{x-1}$åˆ™è¦æ»¡è¶³$x^2 + (L-R-2)x + R + 1 &gt; 0$å½“$(R-L+2)^2 - 4R - 4&lt;0$æ—¶ï¼Œæ‰€æœ‰åŒºé—´éƒ½ä¸ç›¸äº¤ï¼Œåˆå‘ç°æ­¤æ—¶R-L+1åœ¨$O(\sqrt Râ€‹$)çº§åˆ«ï¼Œæ‰€ä»¥æš´åŠ›æ±‚å‡ºå„ä¸ªåŒºé—´çš„é•¿åº¦ç›¸åŠ å³å¯å¦åˆ™ï¼Œæ±‚å‡ºä¸¤ä¸ªæ ¹x1ï¼Œx2ï¼Œåˆ™åœ¨$[x1,x2]$è¿™ä¸€æ®µåŒºé—´éƒ½æ˜¯ç›¸äº¤çš„ï¼ŒåŒºé—´å¹¶çš„å·¦ç«¯ç‚¹ä¸ºx1çš„å·¦ç«¯ç‚¹ï¼Œå³ç«¯ç‚¹x2çš„å³ç«¯ç‚¹ã€‚è€ƒè™‘$\frac{R-L+2 \pm \sqrt{(R-L+2)^2-4R-4}}{2}$è®¾R-L+2ä¸ºaï¼Œ4R-4ä¸ºbï¼Œä¸”æ»¡è¶³$a \geq \sqrt b$$a-\sqrt{a^2-b} = a-\sqrt{(a+\sqrt b)(a - \sqrt b)} \leq a - \sqrt{(a-\sqrt b)^2} = \sqrt b$æ‰€ä»¥1$\sim$x1çš„é•¿åº¦åœ¨$O(\sqrt b)$çº§åˆ«ï¼Œè€Œx2$\sim$açš„é•¿åº¦ä¸º$a-\frac{R-L+2 + \sqrt{(R-L+2)^2-4R-4}}{2} = \frac{R-L+2 - \sqrt{(R-L+2)^2-4R-4}}{2}$â€‹ï¼Œä¹Ÿåœ¨$O(\sqrt b)$çº§åˆ«ï¼Œæ‰€ä»¥åªéœ€è¦å¯¹ä¸¤ç«¯ä¸ç›¸äº¤çš„éƒ¨åˆ†æš´åŠ›å³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ICPC æ±Ÿè¥¿çœå¤§å­¦ç”Ÿç¨‹åºè®¾è®¡ç«èµ›</title>
      <link href="/2020/11/20/2020icpc-jiang-xi-sheng-da-xue-sheng-cheng-xu-she-ji-jing-sai/"/>
      <url>/2020/11/20/2020icpc-jiang-xi-sheng-da-xue-sheng-cheng-xu-she-ji-jing-sai/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®éƒ½ä¸éš¾ï¼ŒDé¢˜é¢˜é¢å‡ºé”…</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>å®šä¹‰$F_j$â€‹ä¸ºjå„ä½æ•°å­—ä¹‹å’Œæ±‚$\sum_{i=1}^n\sum_{j=1}^i [gcd(i,j)==1]F(j)$è«æ¯”ä¹Œæ–¯åæ¼”ï¼ŒçŸ¥é“$\mu * I = \epsilon$ï¼Œåˆ™$\sum \limits_{d \mid gcd(i,j)} 1 = [gcd(i,j)==1]$$d\mid gcd(i,j)$ç­‰ä»·äº$d\mid i,d\mid j$è½¬æ¢æˆæšä¸¾dï¼Œç„¶åå°±å¯ä»¥$O(n\log n)$æšä¸¾å€æ•°ç®—äº†</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç­¾åˆ°</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>æœ‰nä¸ªåŒºé—´ï¼Œè¦æ±‚é€‰æ‹©æŸäº›åŒºé—´ï¼Œå®šä¹‰é€‰æ‹©å‡ºçš„åŒºé—´çš„ä»·å€¼ä¸ºmin(é€‰æ‹©çš„åŒºé—´ä¸ªæ•°ï¼ŒåŒºé—´äº¤é›†çš„é•¿åº¦)ï¼Œè¦æ±‚æœ€å¤§åŒ–è¯¥ä»·å€¼$n \leq 3\times 10^5$æ˜¾ç„¶å¯ä»¥äºŒåˆ†ï¼Œ$O(n\log n)$çš„checkä¹Ÿå¾ˆç®€å•ï¼Œä½†æ˜¯ä¼šè¢«å¡tè€ƒè™‘å¦‚ä½•$O(n)$çš„checkçœ‹ä»·å€¼èƒ½ä¸èƒ½è¾¾åˆ°vï¼Œå°±ç­‰ä»·äºé€‰æ‹©vä¸ªåŒºé—´ï¼Œä¸”è¿™äº›åŒºé—´çš„äº¤é›†çš„é•¿åº¦$\geq v$å°†æ‰€æœ‰åŒºé—´æŒ‰ç…§å·¦ç«¯ç‚¹å…ˆæ’åºæšä¸¾äº¤é›†çš„åŒºé—´çš„å·¦ç«¯ç‚¹lï¼Œåˆ™å³ç«¯ç‚¹ä¸ºl+v-1ï¼Œåªè¦å·¦ç«¯ç‚¹å°äºç­‰äºlçš„åŒºé—´ä¸­å­˜åœ¨è‡³å°‘vä¸ªå³ç«¯ç‚¹$\geq l+v-1$å³å¯ï¼Œå°ºå–æ³•</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>æœ‰nä¸ªæ•°å­—ï¼Œæ€»é•¿åº¦ä¸è¶…è¿‡$10^6$ï¼Œè®©ä½ æ±‚è¿™äº›æ•°å­—çš„æ‰€æœ‰æœ¬è´¨ä¸åŒå­ä¸²çš„ä»·å€¼ï¼ˆæ•°å­—å¤§å°ï¼‰å’Œæˆ‘æè¿°æˆæœ¬è´¨ä¸åŒå­ä¸²ä¹‹åï¼Œåº”è¯¥å¾ˆå®¹æ˜“æƒ³åˆ°exsam<s>å‡ ä¸ªæœˆæ²¡å†™æ¦‚å¿µéƒ½å¿˜å®Œ</s>åªéœ€è¦å»ºå‡ºexsamçš„dagå›¾ï¼Œç„¶åæŒ‰ç…§æ‹“æ‰‘åºdpå³å¯ï¼Œåªéœ€è¦çŸ¥é“ä»¥æ¯ä¸ªendposé›†åˆï¼ˆå³å›¾ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹ï¼‰ç»“å°¾çš„æ‰€æœ‰å­ä¸²çš„å’Œï¼Œå¦‚uæœ‰ä¸ªiçš„å‡ºè¾¹è¿å‘vï¼Œåˆ™å°±æœ‰$dp[u]\times 10+i\times |u|$çš„è´¡çŒ®ï¼Œ$|u|$å°±è¡¨ç¤ºuè¿™ä¸ªendposé›†åˆçš„å¤§å°ï¼Œå°±æ˜¯len[u] - len[fa[u]]äº¤ä¸Šå»waäº†ï¼Œæƒ³åˆ°ä¸€ä¸ªå‰å¯¼0çš„å‘ç‚¹ï¼Œæ¯”å¦‚302ä¸­ï¼Œ02å’Œ2åº”è¯¥ç®—åŒä¸€ä¸ªï¼Ÿè¿™æ ·åº”è¯¥ä¹Ÿèƒ½åšï¼Œåªè¦æŠŠåŸç‚¹çš„0å‡ºè¾¹çš„çŠ¶æ€èƒ½åˆ°è¾¾çš„ç‚¹çš„endposé›†åˆå¤§å°-1å°±è¡Œã€‚å…¶å®å¹¶ä¸æ˜¯é¢˜é¢æ¨¡998244353ï¼Œæ•°æ®æ˜¯æ¨¡1000000007ï¼Œç¦»è°±</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ä¸€ä¸ªé•¿åº¦ä¸ºnçš„åºåˆ—cï¼Œæ±‚æœ‰å¤šå°‘ä¸ªå­åºåˆ—æ»¡è¶³æ¯ç§æ•°å­—å‡ºç°å¶æ•°æ¬¡$n\leq 10^6,c_i\leq 20$å­åºåˆ—è€ƒè™‘å‰ç¼€å’Œï¼Œå¯¹20ç§æ•°å­—çŠ¶å‹å³å¯</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>è®©ä½ æ„é€ ä¸€ä¸ªæœ€å¤§çš„æ•°ï¼Œæ»¡è¶³å®ƒçš„æ¯ä¸ªå‰ç¼€éƒ½èƒ½è¢«è¿™ä¸ªå‰ç¼€çš„é•¿åº¦æ•´é™¤ï¼Œæ„é€ çš„æ•°å­—è¦æ±‚ç”¨ç«æŸ´æ£’è¡¨ç¤ºï¼Œä¸”è¦æ±‚æ°å¥½ä½¿ç”¨næ ¹$n \leq 10^{100}$ç¨å¾®æƒ³æƒ³å°±èƒ½æ„Ÿè§‰åˆ°ç¬¦åˆçš„æ•°ä½æ•°ä¸ä¼šå¾ˆå¤§ï¼Œäº‹å®ä¸Šé•¿åº¦è¶…è¿‡3å°±ä¸€å®šä¸è¡Œäº†ï¼Œæ‰€ä»¥æš´åŠ›dfså°±å®Œäº‹äº†</p><h2 id="G"><a class="header-anchor" href="#G">Â¶</a>G</h2><p>ä¸€ä¸ªé›†åˆåŒ…å«1-n nä¸ªæ•°ï¼Œè¦æ±‚ä½ ä¾æ¬¡é€‰æ‹©mä¸ªæ•°çš„é›†åˆï¼Œè¦æ±‚é›†åˆé—´æ²¡æœ‰äº¤é›†ï¼Œé›†åˆå¯ä»¥ç©ºï¼Œæ±‚æ“ä½œçš„æ–¹æ¡ˆæ•°è½¬åŒ–ä¸€ä¸‹ï¼Œå¯ä»¥è€ƒè™‘ç¬¬iä¸ªæ•°å½’å±å“ªä¸ªé›†åˆï¼Œæ˜¾ç„¶æœ‰m+1ç§é€‰æ‹©ï¼Œæ²¡è¢«é€‰æˆ–è€…é€‰åˆ°ç¬¬jä¸ªé›†åˆã€‚æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯$(m+1)^n$pythonçš„powè‡ªå¸¦å¿«é€Ÿå¹‚</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>ä¸€ä¸ªåºåˆ—ï¼Œè¦æ±‚æ”¯æŒä¿®æ”¹ä¸€ä¸ªæ•°ï¼Œè¯¢é—®ä»¥æŸä¸ªæ•°ä¸ºæœ€å°å€¼çš„åŒºé—´ä¸ªæ•°ã€‚ä¿è¯åºåˆ—ä¸­æ²¡æœ‰é‡å¤æ•°å­—æ˜¾ç„¶åªè¦æ‰¾åˆ°å·¦å³ä¸¤è¾¹ç¬¬ä¸€ä¸ªå°äºä½ çš„æ•°å³å¯è®°å½•åŒºé—´æœ€å°å€¼ï¼Œçº¿æ®µæ ‘ä¸Šè´ªå¿ƒç€èµ°å³å¯</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>è§„å¾‹é¢˜</p><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>äºŒç»´SG</p><h2 id="K"><a class="header-anchor" href="#K">Â¶</a>K</h2><p>å¯ä»¥ä»èµ·ç‚¹å‡ºå‘å¸¦xä¸ªç‰©å“ï¼Œèµ°ç¬¬yæ­¥è·¯çš„æ¶ˆè´¹æ˜¯$x^y$ï¼Œå¤šæ¬¡è¯¢é—®ä»såˆ°tï¼Œä½ æ‹¥æœ‰må…ƒé’±ï¼Œåˆ™åœ¨èµ·ç‚¹æœ€å¤šå¸¦å¤šå°‘ä¸ªç‰©å“ã€‚ç‚¹æ•°æ˜¯100å…ˆè·‘ä¸ªfloydï¼Œåˆ™såˆ°tçš„èŠ±è´¹å°±æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—ï¼ŒäºŒåˆ†ä¸€ä¸‹å…¬æ¯”å³å¯ï¼Œæ³¨æ„å…¬æ¯”ä¸º1çš„æƒ…å†µ</p><h2 id="L"><a class="header-anchor" href="#L">Â¶</a>L</h2><p>nçš‡åï¼Œä½†æ˜¯å¯ä»¥åœ¨ä¸€æ¡æ–œçº¿çŠ¶å‹dp</p><h2 id="M"><a class="header-anchor" href="#M">Â¶</a>M</h2><p>è¾“å‡ºstring s+string t</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ccpc ç»µé˜³</title>
      <link href="/2020/11/02/2020ccpc-mian-yang/"/>
      <url>/2020/11/02/2020ccpc-mian-yang/</url>
      
        <content type="html"><![CDATA[<h2 id="Dï¼š-Defuse-the-Bombs"><a class="header-anchor" href="#Dï¼š-Defuse-the-Bombs">Â¶</a>Dï¼š Defuse the Bombs</h2><p>æœ‰nä¸ªè®¡æ•°å™¨ï¼Œåˆå€¼ä¸º$a_i$â€‹ï¼Œæ¯ç§’é’Ÿå¯ä»¥å°†ä¸€ä¸ªè®¡æ•°å™¨çš„å€¼+1ï¼Œç„¶åæ‰€æœ‰çš„è®¡æ•°å™¨çš„å€¼-1ã€‚é—®æœ€å¤šå‡ ç§’åæ‰€æœ‰è®¡æ•°å™¨çš„æœ€å°å€¼$\lt 0$$n\leq 10^5, 0 \leq a_i \leq 10^9$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è½¬åŒ–ä¸€ä¸‹é—®é¢˜ï¼šæ¯ç§’é’Ÿå¯ä»¥è®©ä¸€ä¸ªè®¡æ•°å™¨å€¼+1ï¼Œç¬¬iç§’é’Ÿè¦æ±‚æ‰€æœ‰è®¡æ•°å™¨çš„å€¼$\geq i$ï¼Œé—®ç¬¬å‡ ç§’åä¸æ»¡è¶³ã€‚å‡å¦‚ç¬¬xç§’é’Ÿæ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¦æ»¡è¶³$sum_p+x \geq x*p$ï¼Œå…¶ä¸­$a_p$â€‹ä¸ºå°äºxçš„æœ€å¤§çš„pã€‚å…ˆæšä¸¾$a_i$â€‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³çš„ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯$\frac{sum_i}{i-1}+1$ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a[N];</span><br><span class="line">ll sum[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; a[i];</span><br><span class="line">  <span class="built_in">sort</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) sum[i] = sum[i<span class="number">-1</span>] + a[i];</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  ll p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">1ll</span>*i*a[i]-sum[i]&gt;a[i]) <span class="keyword">break</span>;</span><br><span class="line">    p = i;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; sum[p]/(p<span class="number">-1</span>)+<span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> kase=<span class="number">1</span>; kase&lt;=_; kase++) <span class="built_in">solve</span>(kase);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="K-Knowledge-is-Power"><a class="header-anchor" href="#K-Knowledge-is-Power">Â¶</a>K Knowledge is Power</h2><p>ç»™å®šæ•°xï¼Œè¦æ±‚å°†å…¶åˆ†è§£æˆè‹¥å¹²å¤§äº1çš„æ•°ï¼Œè¦æ±‚æ»¡è¶³ä¸¤ä¸¤äº’è´¨ä¸”å’Œä¸ºxã€‚æœ€å°åŒ–è¿™äº›æ•°çš„æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®å€¼ã€‚$5 \leq x \leq 10^9$</p><h3 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h3><p>xä¸ºå¥‡æ•°ï¼Œæ˜¾ç„¶$2\frac{x-1}{2}, \frac{x+1}{2}$â€‹æœ€ä¼˜ï¼Œä¸º1è€ƒè™‘xä¸ºå¶æ•°ï¼šx=6æ— è§£x=8ï¼Œåˆ†æˆ3å’Œ5å³å¯ï¼ˆæˆ‘ä¸€å¼€å§‹è¯¯åˆ¤æˆæ— è§£ï¼‰é€šè¿‡æ‰“è¡¨å¾—åˆ°ç­”æ¡ˆåªå¯èƒ½æ˜¯2ï¼Œ3ï¼Œ4xæ˜¯3çš„å€æ•°ï¼Œæ˜¾ç„¶å¯ä»¥åˆ†æˆy, y+1, y+2çš„å½¢å¼ï¼Œåˆç”±äºyä¸€å®šæ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥åˆæ³•ï¼Œç­”æ¡ˆä¸º2$x%3==1$ï¼Œå¦‚æœèƒ½åˆ†æˆäº’è´¨çš„y, y+1, y+3åˆ™ä¸º3ï¼Œå¦åˆ™ä¸º4$x%3==2$ï¼Œå¦‚æœèƒ½åˆ†æˆäº’è´¨çš„y, y+2, y+3åˆ™ä¸º3ï¼Œå¦åˆ™ä¸º4</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x; cin &gt;&gt; x;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  <span class="keyword">if</span>(x==<span class="number">6</span>) cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(x&amp;<span class="number">1</span>) cout &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x%<span class="number">3</span>==<span class="number">0</span>) cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(__gcd(x/<span class="number">2</span><span class="number">-1</span>, x/<span class="number">2</span>+<span class="number">1</span>)==<span class="number">1</span>) cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">bool</span> ok = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span>(x%<span class="number">3</span>==<span class="number">2</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> a = (x<span class="number">-5</span>)/<span class="number">3</span>, b = a+<span class="number">2</span>, c = a+<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>(__gcd(a, b)==<span class="number">1</span> &amp;&amp; __gcd(a, c)==<span class="number">1</span> &amp;&amp; __gcd(b, c)==<span class="number">1</span>) ok = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(x%<span class="number">3</span>==<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> a = (x<span class="number">-4</span>)/<span class="number">3</span>, b = a+<span class="number">1</span>, c = a+<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>( __gcd(a, b)==<span class="number">1</span> &amp;&amp; __gcd(a, c)==<span class="number">1</span> &amp;&amp; __gcd(b, c)==<span class="number">1</span>) ok = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(ok) cout &lt;&lt; <span class="number">3</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> cout &lt;&lt; <span class="number">4</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=_; k++) <span class="built_in">solve</span>(k);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="J-Joy-of-Handcraft"><a class="header-anchor" href="#J-Joy-of-Handcraft">Â¶</a>J Joy of Handcraft</h2><p>æœ‰nä¸ªç¯æ³¡ï¼Œåˆ†åˆ«æœ‰å‘¨æœŸ$t_i$â€‹ï¼Œæ¯ä¸¤ä¸ªå‘¨æœŸä¸­ï¼Œå‰ä¸€ä¸ªå‘¨æœŸäº®ï¼Œåä¸€ä¸ªå‘¨æœŸæš—ï¼Œæœ‰äº®åº¦$x_i$â€‹ã€‚é—®1-mæ¯ä¸ªæ—¶é—´å†…çš„æœ€å¤§äº®åº¦$n \leq 10^5, m \leq 10^5, t_i \leq 10^5, x_i \leq 10^5$</p><h3 id="åšæ³•-s3"><a class="header-anchor" href="#åšæ³•-s3">Â¶</a>åšæ³•</h3><p>å‘¨æœŸç›¸åŒçš„åªè¦å–äº®åº¦æœ€å¤§çš„é‚£ä¸ªï¼Œç„¶åæš´åŠ›æšä¸¾æ¯ç§å‘¨æœŸçš„ç¯æ³¡äº®çš„æ—¶é—´ï¼Œå¤æ‚åº¦æ˜¯$O(n\log n)$ï¼Œæ³¨æ„åˆ°å°†äº®åº¦æ’åºåï¼Œå°±æ˜¯ä¸ªåŒºé—´è¦†ç›–é—®é¢˜äº†ï¼Œçº¿æ®µæ ‘å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> cov[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cov[p&lt;&lt;<span class="number">1</span>] = cov[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = cov[p];</span><br><span class="line">  cov[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cover</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">  &#123;</span><br><span class="line">    cov[p] = v;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cov[p]) <span class="built_in">push</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">cover</span>(p&lt;&lt;<span class="number">1</span>, l, mid, x, y, v);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">cover</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r, x, y, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) &#123; cout &lt;&lt; cov[p] &lt;&lt; <span class="string">&quot; \n&quot;</span>[l==m]; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(cov[p]) <span class="built_in">push</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">print</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">print</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">4</span>*m; i++) cov[i] = <span class="number">0</span>;</span><br><span class="line">  vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; <span class="built_in">lamb</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;it : lamb) cin &gt;&gt; it.first &gt;&gt; it.second;</span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(lamb), <span class="built_in">end</span>(lamb));</span><br><span class="line">  vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; tmp;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;(<span class="type">int</span>)lamb.<span class="built_in">size</span>(); )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = i + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(j&lt;(<span class="type">int</span>)lamb.<span class="built_in">size</span>() &amp;&amp; lamb[j].first==lamb[i].first) ++j;</span><br><span class="line">    tmp.<span class="built_in">push_back</span>(&#123;lamb[j<span class="number">-1</span>].second, lamb[j<span class="number">-1</span>].first&#125;);</span><br><span class="line">    i = j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(tmp), <span class="built_in">end</span>(tmp));</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : tmp)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=m; k+=<span class="number">2</span>*it.second) <span class="built_in">cover</span>(<span class="number">1</span>, <span class="number">1</span>, m, k, <span class="built_in">min</span>(m, k+it.second<span class="number">-1</span>), it.first);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  <span class="built_in">print</span>(<span class="number">1</span>, <span class="number">1</span>, m);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=_; k++) <span class="built_in">solve</span>(k);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="L-Lottery"><a class="header-anchor" href="#L-Lottery">Â¶</a>L Lottery</h2><p>æœ‰nç§çŸ³å¤´ï¼Œç¬¬iç§çŸ³å¤´ä½“ç§¯ä¸º$2^{a_i}$â€‹ï¼Œæ•°é‡ä¸º$x_i$â€‹ï¼Œé—®èƒ½æ‹¼æˆçš„ä½“ç§¯æ•°é‡ã€‚$n \leq 10^5, a_i, x_i \leq 10^9$</p><h3 id="åšæ³•-s4"><a class="header-anchor" href="#åšæ³•-s4">Â¶</a>åšæ³•</h3><p>æŒ‰ç…§ä½“ç§¯ä»å°åˆ°å¤§è€ƒè™‘è®¾å½“å‰æšä¸¾åˆ°ç¬¬iå—çŸ³å¤´ï¼Œå‰$i-1$å—çŸ³å¤´(å‰mxçš„ä½“ç§¯ä¸­)ä¸èƒ½æ‹¼æˆçš„ä½“ç§¯ä¸ºansï¼Œå‰$2^{a_{i-1}}$â€‹çš„ä½“ç§¯ä¸­æœ‰deltaä¸ªä¸èƒ½è¢«æ‹¼æˆï¼Œä¹‹å‰æ‰€æœ‰çŸ³å¤´èƒ½æ‹¼æˆçš„æœ€å¤§ä½“ç§¯ä¸º$mx$ã€‚$mx\geq 2^{a_i}$â€‹ï¼šé‚£ä¹ˆå¯¹äº$2^{a_{i-1}}$â€‹åˆ°$2^{a_i}$â€‹ä¹‹é—´ï¼Œæ¯$2^{a_{i-1}}$â€‹ä¸ªå°±æœ‰deltaä¸ªä½“ç§¯ä¸èƒ½è¢«æ‹¼æˆã€‚å› æ­¤$\leq 2^{a_i}$â€‹çš„ä½“ç§¯ä¸­ä¸èƒ½æ‹¼æˆçš„ä½“ç§¯çš„æ•°é‡å°±æ˜¯$2^{a_i-a_{i-1}}\times delta$ï¼Œå‰iå—çŸ³å¤´ä¸èƒ½æ‹¼æˆçš„ä½“ç§¯å°±è¦å¢åŠ $delta\times x_i$â€‹ä¸ª$mx\lt 2^{a_i}$â€‹ï¼šé‚£ä¹ˆ$mx+1$åˆ°$2^{a_i}-1$ä¹‹é—´çš„ä½“ç§¯å°±æ— æ³•æ‹¼æˆå‰$2^{a_{i}}$â€‹çš„ä½“ç§¯ä¸­æœ‰$ans+2^{a_i}-mx-1$ä¸èƒ½è¢«æ‹¼æˆå‰iå—çŸ³å¤´ä¸èƒ½æ‹¼æˆçš„ä½“ç§¯å¢åŠ $delta\times x_i$â€‹ä¸ª</p><p>ç”±äºæœ‰å–æ¨¡æ“ä½œï¼Œä¸èƒ½ç›´æ¥åˆ¤æ–­$mx$å’Œ$2^{a_i}$â€‹çš„å¤§å°å…³ç³»ï¼Œç”¨ä¸€ä¸ªmapæ¥å­˜å‚¨mxçš„äºŒè¿›åˆ¶è¡¨ç¤ºå³å¯ï¼Œåªè¦mxçš„äºŒè¿›åˆ¶ä¸­æœ€é«˜ä½high$\geq a_i$â€‹ï¼Œå°±è¯´æ˜$mx \geq 2^{a_i}$â€‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Pow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; p[i].fi &gt;&gt; p[i].se;</span><br><span class="line">  map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; bit;</span><br><span class="line">  <span class="built_in">sort</span>(p+<span class="number">1</span>, p+n+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> mx = <span class="number">0</span>, delta = <span class="number">0</span>, ans = <span class="number">0</span>, high = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="built_in">Pow</span>(<span class="number">2</span>, p[i].fi);</span><br><span class="line">    <span class="keyword">if</span>(high&gt;=p[i].fi)</span><br><span class="line">    &#123;</span><br><span class="line">      delta = <span class="number">1ll</span>*delta*<span class="built_in">Pow</span>(<span class="number">2</span>, p[i].fi-p[i<span class="number">-1</span>].fi)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      delta = ((cur-mx<span class="number">-1</span>+ans)%mod+mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (ans + <span class="number">1ll</span>*delta*p[i].se)%mod;</span><br><span class="line">    mx = (mx + <span class="number">1ll</span>*cur*p[i].se)%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="number">30</span>; j++)</span><br><span class="line">      <span class="keyword">if</span>((p[i].se&gt;&gt;j)&amp;<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> x = p[i].fi + j;</span><br><span class="line">        bit[x]++;</span><br><span class="line">        <span class="keyword">while</span>(bit[x]==<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          bit[x] = <span class="number">0</span>;</span><br><span class="line">          ++x;</span><br><span class="line">          bit[x]++;</span><br><span class="line">        &#125;</span><br><span class="line">        high = <span class="built_in">max</span>(high, x);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  cout &lt;&lt; ((mx - ans + <span class="number">1</span>)%mod+mod)%mod &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=_; k++) <span class="built_in">solve</span>(k);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="G-Game-of-Cards"><a class="header-anchor" href="#G-Game-of-Cards">Â¶</a>G Game of Cards</h2><p>æœ‰$c_0$â€‹ä¸ª0å·ç‰Œï¼Œ$c_1$â€‹ä¸ª1å·ç‰Œï¼Œ$c_2$â€‹ä¸ª2å·ç‰Œï¼Œ$c_3$â€‹ä¸ª3å·ç‰Œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰å–ä¸¤å¼ å’Œä¸è¶…è¿‡3çš„ç‰Œï¼Œç„¶åå°†è¿™ä¸¤å¼ ç‰Œæ¢æˆä¸€å¼ å®ƒä»¬çš„å’Œçš„å·çš„ç‰Œï¼Œä¸èƒ½æ“ä½œè€…è¾“ã€‚$0\leq c_0,c_1,c_2, c_3\leq 10^9$</p><h3 id="åšæ³•-s5"><a class="header-anchor" href="#åšæ³•-s5">Â¶</a>åšæ³•</h3><p>ç®€å•åˆ†æä¸€ä¸‹ï¼š3å·ç‰Œåªèƒ½å’Œ0å·ç‰Œç»„åˆï¼Œä¸”åªä¼šå¢åŠ ä¸ä¼šå‡å°‘ï¼Œå½±å“åˆ°å±€é¢çš„å°±æ˜¯3å·ç‰Œæœ‰è¿˜æ˜¯æ²¡æœ‰ã€‚å¦‚æœæ“ä½œ0å·ç‰Œï¼Œæ¯æ¬¡å¿…ç„¶ä¼šå‡å°‘1ï¼Œæ‰€ä»¥0å·ç‰Œå½±å“å±€é¢çš„æ˜¯å®ƒçš„å¥‡å¶æ€§ã€‚ç„¶ååªéœ€è¦å¯¹1å’Œ2çš„æ•°ç›®ä»¥åŠ3å·ç‰Œæ˜¯0è¿˜æ˜¯1ï¼Œ0å·ç‰Œæ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°æ‰“ä¸ªsgè¡¨å³å¯ã€‚å‘ç°åªæœ‰0å·ç‰Œæ—¶ï¼Œéœ€è¦ç‰¹åˆ¤ã€‚æ­¤å¤–3å·ç‰Œæ²¡æœ‰å½±å“ã€‚0å·ç‰Œæœ‰å¶æ•°ä¸ªæ—¶ï¼Œ2å·ç‰Œä¸º0å’Œé0æ—¶ï¼Œ1å·ç‰Œæ¨¡3å„æœ‰ä¸€ä¸ªè§„å¾‹0å·ç‰Œæœ‰å¥‡æ•°ä¸ªæ—¶ï¼Œ2å·ç‰Œä¸º0å’Œ1å’Œ&gt;1æ—¶ï¼Œ1å·ç‰Œæ¨¡3å„æœ‰ä¸€è§„å¾‹if elseä¸€ä¸‹å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">win</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;Rabbit\n&quot;</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lose</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;Horse\n&quot;</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> a, b, c, d;</span><br><span class="line">  cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  <span class="type">bool</span> ok = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(a%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!c)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">2</span>) ok = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">0</span>) ok = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!c)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">2</span>) ok = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">0</span>) ok = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!b&amp;&amp;!c&amp;&amp;!d)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(a&lt;=<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(a&amp;<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> ok = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  ok ? <span class="built_in">win</span>() : <span class="built_in">lose</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=_; k++) <span class="built_in">solve</span>(k);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019ccpc ç§¦çš‡å²›A. Angle Beats</title>
      <link href="/2020/10/09/2019ccpc-qin-huang-dao-a-angle-beats/"/>
      <url>/2020/10/09/2019ccpc-qin-huang-dao-a-angle-beats/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šnä¸ªç‚¹ï¼Œæœ‰qæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡ºä¸€å®šç‚¹ï¼Œé—®ä»åŸæ¥çš„nä¸ªç‚¹ä¸­é€‰å‡ºä¸¤ä¸ªå’Œå½“å‰ç‚¹æ„æˆç›´è§’ä¸‰è§’å½¢çš„æ–¹æ¡ˆæ•°$n\leq2000,q\leq2000$æ€è·¯å¾ˆæ˜¾ç„¶ï¼Œç¬¬ä¸€ç§æ˜¯è¯¢é—®ç‚¹ä½œä¸ºç›´è§’é¡¶ç‚¹ï¼Œç¬¬äºŒç§æ˜¯è¯¢é—®ç‚¹ä¸æ˜¯ç›´è§’é¡¶ç‚¹ï¼Œåˆ†åˆ«ç»Ÿè®¡å³å¯å¯¹äºç¬¬ä¸€ç§ï¼Œåªè¦è®°å½•æ‰€æœ‰ç‚¹å’Œè¯¢é—®ç‚¹çš„æ–œç‡ï¼Œç¬¬äºŒç§åªè¦é¢„å¤„ç†å‡ºåˆå§‹çš„æ¯ä¸ªç‚¹å’Œå…¶å®ƒç‚¹çš„æ–œç‡å¦‚æœç”¨atan2ï¼Œç²¾åº¦ä¼šç‚¸ï¼Œè¿™é‡Œç”¨åˆ†æ•°çš„å½¢å¼æ¥è¡¨ç¤ºï¼Œå¦‚æœæ–œç‡ä¸º$\dfrac{y}{x}$â€‹,é‚£å°±è¦æŸ¥æ‰¾$\dfrac{-x}{y}$çš„ä¸ªæ•°ï¼Œæå‰å°†æ–œç‡é¢„å¤„ç†å¥½å¹¶æ’åºï¼Œç„¶åæŸ¥è¯¢åªè¦upper_bound - lower_boundå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="type">double</span>;</span><br><span class="line"><span class="type">const</span> db eps = <span class="number">1e-15</span>, pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Frac</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> a, b;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> !b ? a : <span class="built_in">gcd</span>(b, a%b); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (x&gt;<span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>); &#125;</span><br><span class="line">  <span class="built_in">Frac</span>() : <span class="built_in">a</span>(<span class="number">0</span>), <span class="built_in">b</span>(<span class="number">1</span>) &#123;&#125;</span><br><span class="line">  <span class="built_in">Frac</span>(<span class="type">int</span> x) : <span class="built_in">a</span>(x), <span class="built_in">b</span>(<span class="number">1</span>) &#123;&#125;</span><br><span class="line">  <span class="built_in">Frac</span>(<span class="type">int</span> x, <span class="type">int</span> y) &#123; a = x, b = y; <span class="built_in">norm</span>(); &#125;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Frac f) <span class="type">const</span> &#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*f.b &lt; <span class="number">1ll</span>*b*f.a; &#125;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> == (Frac f) &#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*f.b == <span class="number">1ll</span>*b*f.a; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">norm</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> g = <span class="built_in">gcd</span>(<span class="built_in">abs</span>(a), <span class="built_in">abs</span>(b));</span><br><span class="line">    a = a/g*<span class="built_in">sgn</span>(b);</span><br><span class="line">    <span class="keyword">if</span>(!a) b = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!b) a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> b = <span class="built_in">abs</span>(b/g);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> (x&lt;-eps ? <span class="number">-1</span> : x&gt;eps); &#125;</span><br><span class="line"><span class="type">int</span> n, q;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">P</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x, y;</span><br><span class="line">&#125;p[N];</span><br><span class="line">Frac seq[N][N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">1</span>; x&lt;=n; x++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(i&lt;x) seq[x][i] = <span class="built_in">Frac</span>(p[i].y-p[x].y, p[i].x-p[x].x);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(i&gt;x) seq[x][i<span class="number">-1</span>] = <span class="built_in">Frac</span>(p[i].y-p[x].y, p[i].x-p[x].x);</span><br><span class="line">    <span class="built_in">sort</span>(seq[x]+<span class="number">1</span>, seq[x]+n);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; p[i].x &gt;&gt; p[i].y;</span><br><span class="line">  <span class="built_in">pre</span>();</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; p[<span class="number">0</span>].x &gt;&gt; p[<span class="number">0</span>].y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) seq[<span class="number">0</span>][i] = <span class="built_in">Frac</span>(p[i].y-p[<span class="number">0</span>].y, p[i].x-p[<span class="number">0</span>].x);</span><br><span class="line">    <span class="built_in">sort</span>(seq[<span class="number">0</span>]+<span class="number">1</span>, seq[<span class="number">0</span>]+n+<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, ans2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="function">Frac <span class="title">k</span><span class="params">(-p[<span class="number">0</span>].x+p[i].x, p[<span class="number">0</span>].y-p[i].y)</span></span>;</span><br><span class="line">      ans += <span class="built_in">upper_bound</span>(seq[i]+<span class="number">1</span>, seq[i]+n, k) - <span class="built_in">lower_bound</span>(seq[i]+<span class="number">1</span>, seq[i]+n, k);</span><br><span class="line">      ans2 += <span class="built_in">upper_bound</span>(seq[<span class="number">0</span>]+<span class="number">1</span>, seq[<span class="number">0</span>]+n+<span class="number">1</span>, k) - <span class="built_in">lower_bound</span>(seq[<span class="number">0</span>]+<span class="number">1</span>, seq[<span class="number">0</span>]+n+<span class="number">1</span>, k);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans + ans2/<span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; q) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cf487E tourists æ ‘å‰–+çº¿æ®µæ ‘ç»´æŠ¤åœ†æ–¹æ ‘</title>
      <link href="/2020/10/09/cf487e-tourists-shu-pou-xian-duan-shu-wei-hu-yuan-fang-shu/"/>
      <url>/2020/10/09/cf487e-tourists-shu-pou-xian-duan-shu-wei-hu-yuan-fang-shu/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šæ— å‘å›¾ï¼Œæ¯ä¸ªç‚¹æœ‰ç‚¹æƒï¼Œå¤šæ¬¡è¯¢é—®ä¸¤ç‚¹é—´æ‰€æœ‰ç®€å•è·¯å¾„ä¸Šçš„ç‚¹æƒçš„æœ€å°å€¼ï¼Œå¹¶è¦æ±‚æ”¯æŒä¿®æ”¹ç‚¹æƒ</p><p>è€ƒè™‘å»ºå‡ºåœ†æ–¹æ ‘ï¼Œå°†æ–¹ç‚¹çš„ç‚¹æƒç½®ä¸ºæ‰€æœ‰ç›¸é‚»åœ†ç‚¹çš„ç‚¹æƒçš„æœ€å°å€¼ï¼Œé‚£ç­”æ¡ˆå°±æ˜¯ä¸¤ä¸ªç‚¹åœ¨åœ†æ–¹æ ‘ä¸Šçš„è·¯å¾„ä¸Šçš„ç‚¹æƒæœ€å°å€¼ã€‚ä½†æ˜¯å¦‚æœä¸€ä¸ªåœ†ç‚¹å’Œå¤šä¸ªæ–¹ç‚¹ç›¸é‚»ï¼Œåœ¨ä¿®æ”¹çš„æ—¶å€™å¤æ‚åº¦å°±ç‚¸äº†ã€‚æ­¤æ—¶çš„trickæ˜¯è®©1ä¸ºæ ¹ï¼Œæ–¹ç‚¹ç»´æŠ¤æ‰€æœ‰å„¿å­çš„åœ†ç‚¹çš„æƒå€¼æœ€å°å€¼ï¼Œè¿™æ ·åœ¨ä¿®æ”¹æ—¶åœ†ç‚¹åªéœ€è¦å•ç‚¹ä¿®æ”¹å…¶çˆ¶äº²å³å¯ï¼Œè€Œåœ¨æŸ¥è¯¢æ—¶ï¼Œå¦‚æœlcaæ˜¯ä¸€ä¸ªæ–¹ç‚¹ï¼Œå†ç»Ÿè®¡ä¸€ä¸‹æ–¹ç‚¹çš„çˆ¶äº²è¿™ä¸ªåœ†ç‚¹çš„ç­”æ¡ˆå³å¯ã€‚æ ‘å‰–ï¼Œçº¿æ®µæ ‘æ”¯æŒå•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢æœ€å°å€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m, q;</span><br><span class="line"><span class="type">int</span> low[N], dfn[N], stk[N], clk, top, cnt;</span><br><span class="line"><span class="type">int</span> val[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N], T[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  low[u] = dfn[u] = ++clk;</span><br><span class="line">  stk[++top] = u;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">tarjan</span>(v, u);</span><br><span class="line">      low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">      <span class="keyword">if</span>(low[v]&gt;=dfn[u])</span><br><span class="line">      &#123;</span><br><span class="line">        ++cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">0</span>; x!=v; top--)</span><br><span class="line">        &#123;</span><br><span class="line">          x = stk[top];</span><br><span class="line">          T[cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">          T[x].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">        &#125;</span><br><span class="line">        T[cnt].<span class="built_in">push_back</span>(u);</span><br><span class="line">        T[u].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(v!=fa) low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = N&lt;&lt;<span class="number">1</span>;</span><br><span class="line">multiset&lt;<span class="type">int</span>&gt; mst[M];</span><br><span class="line"><span class="keyword">namespace</span> HLD</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> sz[M], top[M], son[M], dep[M], fa[M], dfn[M], idfn[M], tot;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    dep[u] = dep[f] + <span class="number">1</span>; fa[u] = f;</span><br><span class="line">    sz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(u&lt;=n) mst[u].<span class="built_in">insert</span>(val[u]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : T[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(v!=f)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span>(u&gt;n) mst[u].<span class="built_in">insert</span>(val[v]);</span><br><span class="line">        <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">        sz[u] += sz[v];</span><br><span class="line">        <span class="keyword">if</span>(sz[v]&gt;sz[son[u]]) son[u] = v;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    top[u] = t;</span><br><span class="line">    dfn[u] = ++tot;</span><br><span class="line">    idfn[tot] = u;</span><br><span class="line">    <span class="keyword">if</span>(!son[u]) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(son[u], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : T[u])</span><br><span class="line">      <span class="keyword">if</span>(v!=son[u]&amp;&amp;v!=fa[u]) <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> HLD::fa;</span><br><span class="line"><span class="keyword">using</span> HLD::idfn;</span><br><span class="line"><span class="keyword">using</span> HLD::dep;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, mn;</span><br><span class="line">&#125;t[M&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pull</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].mn = <span class="built_in">min</span>(t[p&lt;&lt;<span class="number">1</span>].mn, t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].mn); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].l = l, t[p].r = r;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn = *mst[idfn[l]].<span class="built_in">begin</span>();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">pull</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn = y;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>, x, y);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y);</span><br><span class="line">  <span class="built_in">pull</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> t[p].mn;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, ans = inf;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">askt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = inf;</span><br><span class="line">  <span class="keyword">while</span>(HLD::top[x]!=HLD::top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[HLD::top[x]]&lt;dep[HLD::top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(<span class="number">1</span>, HLD::dfn[HLD::top[x]], HLD::dfn[x]));</span><br><span class="line">    x = fa[HLD::top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(<span class="number">1</span>, HLD::dfn[x], HLD::dfn[y]));</span><br><span class="line">  <span class="keyword">if</span>(x&gt;n) ans = <span class="built_in">min</span>(ans, val[fa[x]]);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; val[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(v); G[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">  &#125;</span><br><span class="line">  cnt = n; <span class="built_in">tarjan</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  HLD::<span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>), HLD::<span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>*n);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">char</span> op; <span class="type">int</span> x, y;</span><br><span class="line">    cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(fa[x])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> pre = *mst[fa[x]].<span class="built_in">begin</span>();</span><br><span class="line">        mst[fa[x]].<span class="built_in">erase</span>(mst[fa[x]].<span class="built_in">find</span>(val[x]));</span><br><span class="line">        mst[fa[x]].<span class="built_in">insert</span>(y);</span><br><span class="line">        <span class="type">int</span> cur = *mst[fa[x]].<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">if</span>(pre!=cur) <span class="built_in">upd</span>(<span class="number">1</span>, HLD::dfn[fa[x]], cur);</span><br><span class="line">      &#125;</span><br><span class="line">      val[x] = y;</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, HLD::dfn[x], y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="built_in">askt</span>(x, y) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Capture Stars åœ†çš„åæ¼”</title>
      <link href="/2020/10/08/capture-stars-yuan-de-fan-yan/"/>
      <url>/2020/10/08/capture-stars-yuan-de-fan-yan/</url>
      
        <content type="html"><![CDATA[<p><a href="https://ac.nowcoder.com/acm/contest/7830/D">https://ac.nowcoder.com/acm/contest/7830/D</a>æœ‰ä¸€ä¸ªå¤§åœ†å’Œä¸€ä¸ªå°åœ†ï¼Œä¸¤è€…å†…åˆ‡äºåŸç‚¹ï¼Œç„¶åå†å¤§åœ†å†…å°åœ†å¤–æœ‰è‹¥å¹²ä¸ªç‚¹ï¼Œç°åœ¨è®©ä½ æ‰¾ä¸€ä¸ªåœ†ä½¿å…¶å’Œå°åœ†å¤–åˆ‡ï¼Œå¤§åœ†å†…åˆ‡ï¼Œå¹¶ä¸”æœ€å¤§åŒ–è¯¥åœ†è¦†ç›–çš„ç‚¹æ•°è¿™ç§å¤šä¸ªåœ†æœ‰ç›¸åˆ‡å…³ç³»çš„é¢˜ï¼Œè€ƒè™‘åœ†çš„åæ¼”åæ¼”ï¼šä¸€ä¸ªåæ¼”ç‚¹Oï¼Œä¸€ä¸ªåæ¼”åŠå¾„Rï¼Œåœ¨Oçš„åŒä¾§æœ‰ä¸¤ä¸ªç‚¹På’ŒPâ€™ï¼Œè‹¥æ»¡è¶³|OP||OPâ€™|=R*Rï¼Œåˆ™På’ŒPâ€™äº’ä¸ºåæ¼”ç‚¹ä¸ç»è¿‡åæ¼”ç‚¹çš„åœ†çš„åæ¼”ä»ç„¶æ˜¯ä¸€ä¸ªåœ†ç»è¿‡åæ¼”ç‚¹çš„åœ†çš„åæ¼”æ˜¯ä¸€æ¡ç›´çº¿ç‚¹åæ¼”è¿˜æ˜¯ç‚¹</p><p>å†è€ƒè™‘æœ¬é¢˜ï¼Œä»¥å°åœ†å’Œå¤§åœ†çš„å†…åˆ‡ç‚¹å³åŸç‚¹ä¸ºåæ¼”ç‚¹ï¼Œåæ¼”åŠå¾„ä»»æ„ï¼Œè¿™æ ·å°±å˜æˆäº†ä¸¤æ¡ç›´çº¿ï¼Œè€Œè¦æ‰¾çš„åœ†åœ¨åæ¼”åå°±æ˜¯ç›¸åˆ‡äºè¿™ä¸¤æ¡ç›´çº¿çš„åœ†ï¼Œç‚¹åæ¼”åä»ä¸ºç‚¹å¯¹äºæ¯ä¸ªç‚¹ï¼Œä»…å½“åœ†å¿ƒçš„çºµåæ ‡å¤„äºä¸€ä¸ªåŒºé—´å†…æ‰èƒ½è¦†ç›–ï¼Œå…¨éƒ¨æ±‚å‡ºåå·®åˆ†å‰ç¼€å’Œå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="type">double</span>;</span><br><span class="line"><span class="keyword">using</span> pdi = pair&lt;db, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> db eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> (x&lt;-eps ? <span class="number">-1</span> : x&gt;eps); &#125;</span><br><span class="line"><span class="function">db <span class="title">sqr</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> x*x; &#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">db R, r, invr;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">P</span></span><br><span class="line">&#123;</span><br><span class="line">  db x, y;</span><br><span class="line">  <span class="built_in">P</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">P</span>(db _x, db _y) : <span class="built_in">x</span>(_x), <span class="built_in">y</span>(_y) &#123;&#125;</span><br><span class="line">  P <span class="keyword">operator</span> * (<span class="type">const</span> db k) &#123; <span class="keyword">return</span> <span class="built_in">P</span>(k*x, k*y); &#125;</span><br><span class="line">&#125;p[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; R &gt;&gt; r;</span><br><span class="line">  invr = <span class="number">2</span>*R;</span><br><span class="line">  db xl = <span class="number">0.5</span>*<span class="built_in">sqr</span>(invr)/R, xr = <span class="number">0.5</span>*<span class="built_in">sqr</span>(invr)/r;</span><br><span class="line">  db O = (xl+xr)/<span class="number">2</span>, Or = (xr-xl)/<span class="number">2</span>;</span><br><span class="line">  vector&lt;pdi&gt; seg;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; p[i].x &gt;&gt; p[i].y;</span><br><span class="line">    db d = <span class="built_in">sqrt</span>(<span class="built_in">sqr</span>(p[i].x) + <span class="built_in">sqr</span>(p[i].y));</span><br><span class="line">    db dd = <span class="built_in">sqr</span>(invr)/d;</span><br><span class="line">    p[i] = p[i]*(dd/d);</span><br><span class="line">    db t = <span class="built_in">fabs</span>(O-p[i].x);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sgn</span>(Or-t)&lt;<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    db delta = <span class="built_in">sqrt</span>(<span class="built_in">sqr</span>(Or)-<span class="built_in">sqr</span>(t));</span><br><span class="line">    seg.<span class="built_in">push_back</span>(&#123;p[i].y-delta, <span class="number">1</span>&#125;);</span><br><span class="line">    seg.<span class="built_in">push_back</span>(&#123;p[i].y+delta+eps, <span class="number">-1</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(seg), <span class="built_in">end</span>(seg));</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>, cur = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : seg)</span><br><span class="line">  &#123;</span><br><span class="line">    cur += it.second;</span><br><span class="line">    <span class="keyword">if</span>(cur&gt;ans) ans = cur;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Naomi with Graph æœ€å°å‰²</title>
      <link href="/2020/10/08/naomi-with-graph-zui-xiao-ge/"/>
      <url>/2020/10/08/naomi-with-graph-zui-xiao-ge/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€å¼ nä¸ªç‚¹mæ¡è¾¹çš„æ— å‘å›¾ï¼Œæ¯ä¸ªç‚¹æœ‰æƒå€¼$a_i$â€‹ï¼Œç°åœ¨å¯ä»¥ä»»æ„åŠ è¾¹ï¼Œè¦æ±‚æœ€å°åŒ–$\sum_{i=1}^n(a_i-dist_i)^2$ï¼Œå…¶ä¸­$dist_i$â€‹è¡¨ç¤º1åˆ°iç‚¹çš„æœ€çŸ­è·¯$n \leq 40,m \leq 1600$</p><p>ä»»æ„åŠ è¾¹å¹¶ä¸ä»£è¡¨æ¯ä¸ªç‚¹çš„çš„$dist_i$â€‹éƒ½å¯ä»¥ä»»æ„ï¼Œä»ç„¶è¦æ»¡è¶³ä¸€ä¸‹æ¡ä»¶$dist_1 = 0$$dist_i \not = 0, i \not= 1$$|dist_i-dist_j| \leq 1,(i,j) \in E$</p><p>è€ƒè™‘å¯¹æ¯ä¸ªç‚¹æ‹†æˆn-1ä¸ªç‚¹ï¼ŒSå’Œç¬¬ä¸€ä¸ªç‚¹ç›¸è¿ï¼Œç¬¬iä¸ªç‚¹å’Œç¬¬i+1ä¸ªç‚¹ç›¸è¿ï¼Œç¬¬n-1ä¸ªç‚¹å’ŒTç›¸è¿ï¼Œè¾¹æƒå³ä¸º$(a_i-j)^2$ï¼Œç”±äº$dist_1=0$ï¼Œæ‰€ä»¥ç›´æ¥è®©1æ‹†å‡ºçš„ç¬¬ä¸€ä¸ªç‚¹å’ŒSä¸è¿è¾¹ï¼Œæœ€åå†åŠ ä¸Š$a_i^2$â€‹çš„è´¡çŒ®ã€‚å†è€ƒè™‘ç¬¬ä¸‰ä¸ªé™åˆ¶ï¼Œå¦‚æœiå’Œjæœ‰è¾¹ï¼Œå°±è®©iæ‹†å‡ºçš„ç¬¬xä¸ªç‚¹å‘jæ‹†å‡ºçš„ç¬¬x-1ä¸ªç‚¹è¿è¾¹ï¼ŒjåŒç†ã€‚è¿™æ ·å¦‚æœå‰²æ‰iç‚¹æ‹†å‡ºçš„xå’Œx+1ä¹‹é—´çš„è¾¹ï¼Œå°±è¡¨ç¤º$dist_i=x$ï¼Œå¹¶ä¸”æ­¤æ—¶å¯¹äºå’Œiæœ‰è¾¹çš„jï¼Œå¿…é¡»å‰²æ‰x-1å’Œxæˆ–è€…xå’Œx+1æˆ–è€…x+1å’Œx+2è¿™ä¸‰æ¡è¾¹ä¹‹ä¸€ã€‚æ‰€ä»¥è¿™æ ·å»ºå›¾å†è·‘æœ€å°å‰²å³å¯ã€‚<a data-fancybox="gallery" data-src="/post-images/1602154040898.jpg" data-caption=""><img src="/post-images/1602154040898.jpg" alt=""></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å°åœ†è¦†ç›–è‡³å°‘xä¸ªç‚¹</title>
      <link href="/2020/10/06/zui-xiao-yuan-fu-gai-zhi-shao-x-ge-dian/"/>
      <url>/2020/10/06/zui-xiao-yuan-fu-gai-zhi-shao-x-ge-dian/</url>
      
        <content type="html"><![CDATA[<p>å…ˆè€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œå¹³é¢ä¸Šæœ‰nä¸ªç‚¹ï¼Œé—®ç”¨ä¸€ä¸ªå•ä½åœ†æœ€å¤šèƒ½è¦†ç›–å‡ ä¸ªç‚¹å¯ä»¥è½¬åŒ–æˆå°†æ‰€æœ‰ç‚¹å˜æˆä»¥è¯¥ç‚¹ä¸ºåœ†å¿ƒçš„å•ä½åœ†ï¼Œè¢«åœ†è¦†ç›–æœ€å¤šæ¬¡çš„ç‚¹å°±æ˜¯ç­”æ¡ˆè€ƒè™‘æšä¸¾ä¸€ä¸ªåœ†ï¼Œå…¶ä½™åœ†å’Œè¯¥åœ†å¦‚æœæœ‰äº¤ï¼Œå°±æ˜¯è¯¥åœ†ä¸Šçš„ä¸€æ®µåœ†å¼§ï¼Œæ±‚å‡ºæè§’åå°±å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªåŒºé—´è¦†ç›–æœ€å¤šæ¬¡çš„é—®é¢˜ï¼Œå·®åˆ†+å‰ç¼€å’Œå³å¯ã€‚è¯¥é¢˜å¯ä»¥äºŒåˆ†æœ€å°åœ†çš„åŠå¾„ï¼Œç„¶åç”¨ä»¥ä¸Šæ–¹æ³•æ¥checkå³å¯<a href="https://www.zhihu.com/question/266750532/answer/312982493">https://www.zhihu.com/question/266750532/answer/312982493</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="type">double</span>;</span><br><span class="line"><span class="keyword">using</span> pdi = pair&lt;db, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> db eps = <span class="number">1e-8</span>, pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> (x&lt;-eps ? <span class="number">-1</span> : x&gt;eps); &#125;</span><br><span class="line"><span class="function">db <span class="title">sqr</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> x*x; &#125;</span><br><span class="line"><span class="type">int</span> n, s;</span><br><span class="line">db R;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">P</span></span><br><span class="line">&#123;</span><br><span class="line">  db x, y;</span><br><span class="line">  <span class="built_in">P</span>() &#123;&#125;</span><br><span class="line">  <span class="function">db <span class="title">dis</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(<span class="built_in">sqr</span>(x-p.x) + <span class="built_in">sqr</span>(y-p.y)); &#125;</span><br><span class="line">&#125;p[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">norm</span><span class="params">(db&amp; theta)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">sgn</span>(theta)&lt;<span class="number">0</span>) theta += <span class="number">2</span>*pi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(db r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    vector&lt;pdi&gt; pre;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      db d = p[i].<span class="built_in">dis</span>(p[j]);</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">sgn</span>(d)==<span class="number">0</span>) &#123; ++cnt; <span class="keyword">continue</span>; &#125;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">sgn</span>(d<span class="number">-2</span>*r)&gt;=<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">      db p1 = <span class="built_in">atan2</span>(p[j].y-p[i].y, p[j].x-p[i].x);</span><br><span class="line">      db p2 = <span class="built_in">acos</span>(<span class="number">0.5</span>*d/r);</span><br><span class="line">      db l = p1 - p2, r = p1 + p2;</span><br><span class="line">      <span class="built_in">norm</span>(l), <span class="built_in">norm</span>(r);</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">sgn</span>(r-l)&gt;=<span class="number">0</span>) pre.<span class="built_in">push_back</span>(&#123;l, <span class="number">1</span>&#125;), pre.<span class="built_in">push_back</span>(&#123;r+eps, <span class="number">-1</span>&#125;);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        pre.<span class="built_in">push_back</span>(&#123;<span class="number">0</span>, <span class="number">1</span>&#125;), pre.<span class="built_in">push_back</span>(&#123;r+eps, <span class="number">-1</span>&#125;);</span><br><span class="line">        pre.<span class="built_in">push_back</span>(&#123;l, <span class="number">1</span>&#125;), pre.<span class="built_in">push_back</span>(&#123;<span class="number">2</span>*pi+eps, <span class="number">-1</span>&#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mx = cnt, cur = cnt;</span><br><span class="line">    <span class="built_in">sort</span>(<span class="built_in">begin</span>(pre), <span class="built_in">end</span>(pre));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;(<span class="type">int</span>)pre.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">      cur += pre[i].se;</span><br><span class="line">      <span class="keyword">if</span>(cur&gt;mx) mx = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(mx&gt;=s) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  db l = <span class="number">0.0</span>, r = <span class="number">0.0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      r = <span class="built_in">max</span>(r, p[i].<span class="built_in">dis</span>(p[j]));</span><br><span class="line">  db ans = <span class="number">0.0</span>;</span><br><span class="line">  <span class="keyword">while</span>(r-l&gt;eps)</span><br><span class="line">  &#123;</span><br><span class="line">    db mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">check</span>(mid)) r = mid, ans = mid;</span><br><span class="line">    <span class="keyword">else</span> l = mid;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans + R;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; s;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; p[i].x &gt;&gt; p[i].y;</span><br><span class="line">  cin &gt;&gt; R;</span><br><span class="line">  <span class="keyword">if</span>(s&gt;n) cout &lt;&lt; <span class="string">&quot;The cake is a lie.\n&quot;</span>;</span><br><span class="line">  <span class="keyword">else</span> cout &lt;&lt; <span class="built_in">work</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>), cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cout &lt;&lt; fixed &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">4</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ç‰›å®¢å›½åº†é›†è®­æ´¾å¯¹day1</title>
      <link href="/2020/10/01/2020-niu-ke-guo-qing-ji-xun-pai-dui-day1/"/>
      <url>/2020/10/01/2020-niu-ke-guo-qing-ji-xun-pai-dui-day1/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®éƒ½ä¸éš¾ï¼Œè²Œä¼¼æ˜¯å»å¹´æ¬§æ´²åŒºåŸŸèµ›é¢˜</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„å­—ç¬¦ä¸²ï¼Œé—®ä½ æœ€å°‘åœ¨ <strong>åé¢</strong> æ·»åŠ å¤šå°‘ä¸ªå­—ç¬¦ï¼Œä½¿å…¶å˜æˆå›æ–‡ä¸²$n \leq 4 \times10^5$æ³¨æ„æ˜¯åªèƒ½åŠ åœ¨åé¢ï¼Œæ‰€ä»¥é©¬æ‹‰è½¦ä¸€ä¸‹å°±è¡Œï¼Œæ‰¾ä¸€ä¸ªæœ€é•¿çš„å›æ–‡åç¼€ï¼Œç„¶åè¡¥é½å‰ç¼€å³å¯ï¼ˆå¦‚æœæ˜¯ä»»æ„æ·»åŠ ï¼Œé‚£ç­”æ¡ˆå°±æ˜¯æ­£ä¸²å’Œåä¸²çš„LCSï¼Œåªèƒ½$n^2$</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„aï¼Œå®šä¹‰$g(i, j) =gcd(a_i,\dots,a_j),m(i,j) =max(a_i,\dots,a_j)$ï¼Œæ±‚$\sum_{i=1}^n\sum_{j=i}^ng(i,j)m(i,j)$$n \leq 2\times10^5$å¾ˆå¥—è·¯çš„é¢˜ï¼Œgcdå¯ä»¥åˆ†æˆä¸åŒçš„logæ®µæšä¸¾å³ç«¯ç‚¹ï¼Œåˆ©ç”¨å•è°ƒæ ˆå’Œçº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤åç¼€æœ€å€¼ï¼Œç„¶åäºŒåˆ†gcdä¸åŒçš„æ®µçš„å·¦ç«¯ç‚¹å³å¯ä¸€ç§æ›´å¥½çš„å†™æ³•æ˜¯åˆ©ç”¨è·¯å¾„å‹ç¼©ï¼Œå¯ä»¥å»æ‰ä¸€ä¸ªlogä»¤$g_i$â€‹è¡¨ç¤ºiåˆ°å½“å‰å³ç«¯ç‚¹çš„gcdçš„å€¼ï¼Œ$nxt_i$â€‹è¡¨ç¤ºiå·¦è¾¹ç¬¬ä¸€ä¸ªgä¸$g_i$â€‹ä¸åŒçš„ç‚¹ï¼Œä¸æ–­è·³$nxt_i$â€‹ï¼Œå½“iå’Œ$nxt_i$â€‹çš„gcdç›¸åŒæ—¶ï¼Œå°±åˆå¹¶$nxt_i= nxt_{nxt_i}$</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ç»™å®šä¸€æ£µæ ‘ï¼Œæ¯æ¬¡å¯ä»¥ä¿®æ”¹ä¸€ä¸ªç‚¹çš„çˆ¶äº²ï¼Œé—®æœ€å°‘å‡ æ¬¡æ“ä½œå˜æˆä¸€æ¡é“¾ç­”æ¡ˆå°±æ˜¯æ‰€æœ‰å¤§äº2çš„ç‚¹çš„åº¦æ•°-2çš„å’Œå› ä¸ºåº¦æ•°$\leq 2$å¯ä»¥ä¸ç®¡ï¼Œ$&gt;2$ï¼Œå°±å¿…é¡»æŠŠå…¶å®ƒçš„ç‚¹æŒªèµ°</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>ç»™å®šnä¸ªç‚¹ï¼Œ1æ¡ç›´çº¿ï¼Œå‚æ•°rè®©ä½ åœ¨è¿™æ¡ç›´çº¿ä¸Šé€‰æ‹©ä¸€ä¸ªç‚¹ä½œä¸ºåœ†å¿ƒï¼Œä½œä¸€ä¸ªåŠå¾„ä¸ºrçš„åœ†ï¼Œè¦†ç›–æœ€å¤šçš„ç‚¹ï¼Œæ±‚ç‚¹æ•°$n \leq 3 \times 10^5$è€ƒè™‘æ¯ä¸ªç‚¹èƒ½è¢«è¦†ç›–çš„éƒ½æ˜¯ç›´çº¿ä¸Šçš„ä¸€ä¸ªåŒºé—´ï¼Œæ±‚å‡ºåŒºé—´åï¼Œå°±ç›¸å½“äºç”¨ä¸€ä¸ªé•¿åº¦ä¸º$2r$çš„åŒºé—´è¦†ç›–æœ€å¤šçš„åŒºé—´ï¼Œå› ä¸ºåŒºé—´çš„é•¿åº¦éƒ½æ˜¯å°äº$2r$çš„ï¼Œæ‰€ä»¥ç¦»æ•£åŒ–ä¹‹åå·®åˆ†å‰ç¼€å’Œå–maxå³å¯å¦ä¸€ç§åšæ³•æ˜¯å…ˆæŒ‰åŒºé—´çš„å·¦ç«¯ç‚¹å‡åºæ’åºï¼Œæšä¸¾ç¬¬iä¸ªåŒºé—´ä½œä¸ºæœ€åä¸€ä¸ªè¢«è¦†ç›–çš„åŒºé—´ï¼Œè´ªå¿ƒçš„è€ƒè™‘è‚¯å®šå°†åœ†å¿ƒæ”¾åœ¨è¯¥åŒºé—´çš„å·¦ç«¯ç‚¹ä¸Šï¼ˆå³å°½å¯èƒ½çš„é å·¦ï¼‰ï¼Œæ­¤æ—¶è¦†ç›–çš„ç‚¹çš„ä¸ªæ•°å°±æ˜¯å‰é¢æ‰€æœ‰å³ç«¯ç‚¹$\geq$è¯¥å·¦ç«¯ç‚¹çš„åŒºé—´ä¸ªæ•°ï¼Œpbdså³å¯</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>æ±‚$\sum\limits_{i=n}^m \sum\limits_{d\mid i} 1$$n\leq m \leq 10^{12}$è½¬æˆæšä¸¾å› æ•°dçš„è´¡çŒ®å°±æ˜¯ä¸€ä¸ªæ•´é™¤åˆ†å—äº†</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>æœ‰nä¸ªæ•°ï¼Œè®©ä½ æ‰¾kä¸ªä½¿å¾—å®ƒä»¬ç›¸ä¸çš„ç»“æœæœ€å¤§ä»é«˜ä½å¾€ä½ä½è´ªå¿ƒå³å¯ï¼Œè¯¥ä½æœ‰è¶…è¿‡kä¸ª1å°±å–</p><h2 id="G"><a class="header-anchor" href="#G">Â¶</a>G</h2><p>ç»™å‡ºqä¸ªå­—ç¬¦ä¸²$s_i$â€‹ï¼Œè¯¢é—®é•¿åº¦nçš„å­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘ä¸²ä¸åŒ…å«è¿™qä¸ªå­—ç¬¦ä¸²$\sum\limits_{i=1}^q |s_i| \leq 100$ï¼Œ$n\leq10^9$åˆ°æœ€åæ‰æƒ³åˆ°acè‡ªåŠ¨æœºï¼Œä¸€å¼€å§‹ä¸€ç›´åœ¨æƒ³å®¹æ–¥å¯¹è¿™qä¸ªä¸²å»ºå‡ºtrieå›¾ï¼Œç„¶åæ ‡è®°å‡ºä¸åˆæ³•çš„ä½ï¼ˆæ¯ä¸ªä¸²çš„æœ«ç«¯ï¼Œä»¥åŠæ¯ä¸ªä¸²å¯è¯†åˆ«çš„åç¼€ï¼‰æ¥ä¸‹æ¥å°±è½¬æˆå›¾ä¸Šnæ­¥è·¯å¾„é—®é¢˜ï¼Œå¯¹é‚»æ¥çŸ©é˜µä½œå¿«é€Ÿå¹‚å³å¯</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>ç»™å‡ºä¸¤ä¸ªå­—ç¬¦ä¸²så’Œtï¼ŒåªåŒ…å«å­—ç¬¦AGCTï¼Œä¿è¯tå¯ç”±säº¤æ¢å­—ç¬¦å¾—åˆ°ï¼Œé—®æœ€å°‘çš„äº¤æ¢æ¬¡æ•°è€ƒè™‘ç½®æ¢ï¼Œå¯¹äºä¸€ä¸ªé•¿åº¦ä¸ºxçš„å¾ªç¯ï¼Œéœ€è¦x-1æ¬¡äº¤æ¢ï¼Œæ‰€ä»¥åªè¦è´ªå¿ƒçš„æœ€å¤§åŒ–å¾ªç¯ä¸ªæ•°å³å¯ï¼Œå³æœ€å°åŒ–æ¯ä¸ªå¾ªç¯çš„é•¿åº¦ã€‚ç”±äºåªæœ‰è¿™å››ç§å­—ç¬¦ï¼Œæ‰€ä»¥åªæœ‰å¯èƒ½æ˜¯1234å…ƒç¯ï¼Œä»å°åˆ°å¤§æå°±è¡Œ</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>ç»™å‡ºä¸€å¼ æ— å‘å›¾ï¼Œå¤šæ¬¡è¯¢é—®åªè€ƒè™‘ç»™å®šçš„ä¸€ä¸ªå¤§å°ä¸ºsçš„ç‚¹é›†æ—¶è¿é€šå—çš„ä¸ªæ•°è¯¢é—®çš„ç‚¹é›†å¤§å°å’Œä¸è¶…è¿‡$10^5$ä¹Ÿå¾ˆå¥—è·¯ï¼Œè€ƒè™‘åº¦æ•°å°çš„ç‚¹ï¼Œç›´æ¥æš´åŠ›æšä¸¾æ‰€æœ‰å‡ºè¾¹ï¼Œå¦‚æœåœ¨å½“å‰ç‚¹é›†ä¸­å°±ç”¨å¹¶æŸ¥é›†åˆå¹¶å†è€ƒè™‘åº¦æ•°å¤§çš„ç‚¹ï¼Œå¯¹äºåº¦æ•°å¤§çš„ç‚¹å’Œåº¦æ•°å°çš„ç‚¹çš„è¾¹ï¼Œæˆ‘ä»¬åœ¨åº¦æ•°å°çš„ç‚¹ä¸­å·²ç»æšä¸¾äº†ï¼Œæ‰€ä»¥åªè€ƒè™‘åº¦æ•°å¤§çš„ç‚¹å’Œåº¦æ•°å¤§çš„ç‚¹ä¹‹é—´çš„è¾¹ï¼Œè®¾ç½®é˜ˆå€¼$n\sqrt n$â€‹ï¼Œæ˜¾ç„¶è¿™æ ·çš„ç‚¹ä¸ªæ•°ä¸è¶…è¿‡$2\sqrt n$â€‹ï¼Œç›´æ¥é¢„å¤„ç†å‡ºè¿™äº›ç‚¹ä¹‹é—´æœ‰æ²¡æœ‰è¾¹ï¼ˆç”¨ä¸€ä¸ªäºŒç»´çŸ©é˜µå­˜å‚¨ï¼‰ï¼Œå†å¯¹äºç‚¹é›†å†…æ‰€æœ‰åº¦æ•°å¤§çš„ç‚¹å•ç‹¬åšä¸€æ¬¡äºŒç»´forå¾ªç¯åˆå¹¶å³å¯</p><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>ç»™å‡ºä¸€ä¸ªæ•°ç»„ï¼Œç„¶åè¯¢é—®æ˜¯å¦å­˜åœ¨ç›¸åº”çš„å¤§å°å…³ç³»çš„ä¸‰å…ƒç»„$(x_1, x_2, x_3)$æ€»å…±æœ‰13ç§ï¼Œåˆ†åˆ«åšå³å¯</p><ul><li>ä¸‰ä¸ªç›¸ç­‰111ï¼Œçœ‹æœ‰æ²¡æœ‰ä¸€ä¸ªæ•°å‡ºç°3æ¬¡ä»¥ä¸Šï¼Œmapè®°å½•</li><li>$x_1=x_2$â€‹ï¼Œæšä¸¾$x_2$â€‹ï¼Œå¦‚æœå‰é¢æœ‰ç›¸ç­‰çš„$x_1$â€‹ï¼Œå°±çœ‹åé¢æœ‰æ²¡æœ‰å¤§äºå’Œå°äº$x_2$â€‹çš„ï¼Œ112ï¼Œ221</li><li>$x_2 = x_3$â€‹ï¼Œä¸Šä¸€ç§å€’ç€åšï¼Œ122ï¼Œ211</li><li>$x_1=x_3$â€‹ï¼Œå¯¹æ¯ç§æ•°ï¼Œå–æœ€å·¦å‡ºç°å’Œæœ€å³å‡ºç°çš„ï¼Œç„¶ååªè¦çœ‹ä¸¤è€…é—´çš„æœ€å¤§å€¼å’Œæœ€å°å€¼å’Œè¿™ä¸ªæ•°çš„å…³ç³»ï¼Œ121ï¼Œ212</li><li>$x_1&lt;x_2&lt;x_3$â€‹ï¼Œæšä¸¾ä¸­é—´æ•°ï¼Œ123</li><li>$x_1&gt;x_2&gt;x_3$â€‹ï¼ŒåŒç†ï¼Œ321</li><li>$x_1&lt;x_2&gt;x_3$â€‹ï¼Œæšä¸¾ä¸­é—´æ•°ï¼Œç„¶åçœ‹å·¦å³ä¸¤ä¾§å°äº$x_2$â€‹çš„æœ€å¤§çš„å’Œæœ€å°çš„æ•°çš„å¤§å°å…³ç³»ï¼Œ132ï¼Œ231</li><li>$x_1&gt;x_2&lt;x_3$â€‹ï¼ŒåŒç†ï¼Œ213ï¼Œ312</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ACL Beginner Contest F - Heights and Pairs</title>
      <link href="/2020/09/29/acl-beginner-contest-f-heights-and-pairs/"/>
      <url>/2020/09/29/acl-beginner-contest-f-heights-and-pairs/</url>
      
        <content type="html"><![CDATA[<p>æœ‰2nä¸ªäººï¼Œèº«é«˜åˆ†åˆ«ä¸º$h_i$â€‹ï¼Œæ±‚å°†ä»–ä»¬ä¸¤ä¸¤é…å¯¹ï¼Œä¸”æ¯å¯¹äººèº«é«˜å‡ä¸åŒçš„æ–¹æ¡ˆæ•°(mod 998244353)$n\leq 5\times 10^4,h_i \leq 10^5$</p><p>è®¾æ°å¥½æœ‰iå¯¹äººèº«é«˜ä¸åŒçš„æ–¹æ¡ˆæ•°ä¸º$g_i$â€‹ï¼Œè‡³å°‘æœ‰iå¯¹äººèº«é«˜ä¸åŒçš„æ–¹æ¡ˆæ•°ä¸º$f_i$æ°å¥½ä¸å¥½æ±‚ï¼Œå…ˆæ±‚è‡³å°‘$f_i = \sum \limits_{j=i}^n \binom{j}{i}g_j$åˆ©ç”¨äºŒé¡¹å¼åæ¼”$g_i = \sum \limits_{j=i}^n(-1)^{j-i}\binom{j}{i}f_j$ç­”æ¡ˆå³ä¸º$g_0$â€‹å•ç‹¬è€ƒè™‘æ¯ç§èº«é«˜ï¼Œè‹¥èº«é«˜ä¸ºhçš„æœ‰xä¸ªäººï¼Œåˆ™å°†ä»–ä»¬é…æˆèº«é«˜ç›¸åŒçš„iç»„äººçš„æ–¹æ¡ˆæ•°æ˜¯$\dfrac{\sum\limits_{j=1}^i \binom{x-2*j+2}{2}}{i!}$è¿™æ ·å¯¹æ¯ç§èº«é«˜å°±å¯ä»¥å†™å‡ºä¸€ä¸ªOGFï¼Œå…¨éƒ¨ä¹˜èµ·æ¥å$x^i$çš„ç³»æ•°å°±æ˜¯iç»„äººé…å¯¹çš„æ–¹æ¡ˆæ•°ï¼Œå†è€ƒè™‘å‰©ä½™çš„$2n-2i$ä¸ªäººï¼Œä»»æ„é…å¯¹çš„æ–¹æ¡ˆæ•°ä¸º$\dfrac{(2n-2i)!}{(n-i)!2^{(n-i)}}$â€‹ï¼Œä¸¤é¡¹ç›¸ä¹˜å°±æ˜¯$f_i$â€‹ï¼Œå†ç”¨ä¸Šè¿°å¼å­å³å¯å¾—åˆ°$g_0$â€‹å…¶ä¸­nä¸ªOGFç›¸ä¹˜åˆ©ç”¨åˆ†æ²»NTTå³å¯</p><p>åœ¨reverseä¸€ä¸ªç©ºæ•°ç»„æ—¶ä¼šreï¼Œè¦æ³¨æ„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, h[N], cnt[N], d[N], sd[N];</span><br><span class="line"><span class="type">int</span> *f[N], buf[N&lt;&lt;<span class="number">5</span>], *<span class="built_in">np</span>(buf);</span><br><span class="line"><span class="type">int</span> fac[N], ifac[N], g[N];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myassert</span><span class="params">(<span class="type">bool</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x) <span class="keyword">while</span>(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> poly</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = <span class="number">1ll</span>*(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">    up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">    <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n)</span> </span>&#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">    <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">          t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">    <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">conv</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> l)</span> </span>&#123; <span class="built_in">DFT</span>(a, l); <span class="built_in">DFT</span>(b, l); <span class="built_in">dot</span>(a, b, l, a); <span class="built_in">IDFT</span>(a, l); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> *b, <span class="type">int</span> m, <span class="type">int</span> *c)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> l, ta[N], tb[N];</span><br><span class="line">    <span class="keyword">if</span>(n+m==<span class="number">0</span>) <span class="comment">//æ­¤æ—¶l=1ï¼ŒIDFTä¼šreï¼ï¼</span></span><br><span class="line">    &#123;</span><br><span class="line">      c[<span class="number">0</span>] = <span class="number">1ll</span>*a[<span class="number">0</span>]*b[<span class="number">0</span>]%mod;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    l = <span class="built_in">getlen</span>(n+m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) ta[i] = a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=m; i++) tb[i] = b[i];</span><br><span class="line">    <span class="built_in">conv</span>(ta, tb, l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n+m; i++) c[i] = ta[i];</span><br><span class="line">    <span class="built_in">clear</span>(ta, l), <span class="built_in">clear</span>(tb, l);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  ifac[n] = <span class="built_in">fpw</span>(fac[n], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a&lt;b||b&lt;<span class="number">0</span>||a&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*fac[a]*ifac[b]%mod*ifac[a-b]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  f[p] = np, np += sd[r] - sd[l<span class="number">-1</span>] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=d[l]; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      f[p][i] = cur;</span><br><span class="line">      cur = <span class="number">1ll</span>*cur*<span class="built_in">comb</span>(cnt[l]<span class="number">-2</span>*i, <span class="number">2</span>)%mod*inv[i+<span class="number">1</span>]%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">solve</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">solve</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  poly::<span class="built_in">mul</span>(f[p&lt;&lt;<span class="number">1</span>], sd[mid]-sd[l<span class="number">-1</span>], f[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>], sd[r]-sd[mid], f[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="type">int</span> mx = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">init</span>(<span class="number">2</span>*n);</span><br><span class="line">  poly::<span class="built_in">init</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">2</span>*n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; h[i];</span><br><span class="line">    cnt[h[i]]++;</span><br><span class="line">    mx = <span class="built_in">max</span>(mx, h[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=mx; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    d[i] = cnt[i]/<span class="number">2</span>;</span><br><span class="line">    sd[i] = sd[i<span class="number">-1</span>] + d[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">solve</span>(<span class="number">1</span>, <span class="number">1</span>, mx);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=sd[mx]; i++) g[i] = <span class="number">1ll</span>*f[<span class="number">1</span>][i]*fac[<span class="number">2</span>*n<span class="number">-2</span>*i]%mod*ifac[n-i]%mod*<span class="built_in">fpw</span>(<span class="built_in">fpw</span>(<span class="number">2</span>, n-i), mod<span class="number">-2</span>)%mod;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=sd[mx]; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(i&amp;<span class="number">1</span>) ans = (ans - g[i] + mod)%mod;</span><br><span class="line">    <span class="keyword">else</span> ans = (ans + g[i])%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>poj2821 å¾ªç¯å·ç§¯ bluesteinç®—æ³•</title>
      <link href="/2020/09/25/poj2821-xun-huan-juan-ji-bluestein-suan-fa/"/>
      <url>/2020/09/25/poj2821-xun-huan-juan-ji-bluestein-suan-fa/</url>
      
        <content type="html"><![CDATA[<p>å·²çŸ¥å¤šé¡¹å¼A*B=C,å…¶ä¸­*ä¸ºå¾ªç¯å·ç§¯ï¼Œç»™å‡ºBå’ŒCæ±‚Aå¯¹Bå’ŒCè¿›è¡Œä»»æ„é•¿åº¦çš„DFTï¼ˆbluesteinï¼Œç‹­ä¹‰çš„CZTï¼‰ï¼Œç„¶åç‚¹å€¼ç›¸é™¤å†å˜æ¢å›å»å³å¯$ij = \binom{i+j}{2} - \binom{i}{2} - \binom{j}{2}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = (<span class="number">1</span>&lt;&lt;<span class="number">19</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cp</span></span><br><span class="line">&#123;</span><br><span class="line">  db x, y;</span><br><span class="line">  <span class="built_in">cp</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">cp</span>(db _x, db _y): <span class="built_in">x</span>(_x), <span class="built_in">y</span>(_y) &#123;&#125;</span><br><span class="line">  cp <span class="keyword">operator</span> + (cp &amp;oth) &#123; <span class="keyword">return</span> <span class="built_in">cp</span>(x+oth.x, y+oth.y); &#125;</span><br><span class="line">  cp <span class="keyword">operator</span> - (cp &amp;oth) &#123; <span class="keyword">return</span> <span class="built_in">cp</span>(x-oth.x, y-oth.y); &#125;</span><br><span class="line">  cp <span class="keyword">operator</span> * (cp &amp;oth) &#123; <span class="keyword">return</span> <span class="built_in">cp</span>(x*oth.x-y*oth.y, x*oth.y+y*oth.x); &#125;</span><br><span class="line">  cp <span class="keyword">operator</span> / (cp &amp;oth) &#123; <span class="keyword">return</span> <span class="built_in">cp</span>((x*oth.x+y*oth.y)/(oth.x*oth.x+oth.y*oth.y), (y*oth.x-x*oth.y)/(oth.x*oth.x+oth.y*oth.y)); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> up, rev[N];</span><br><span class="line">cp w[N], pw[N];</span><br><span class="line"><span class="type">const</span> db pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;up; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;i; j++)</span><br><span class="line">      w[i+j] = <span class="built_in">cp</span>(<span class="built_in">cos</span>(pi*j/i), <span class="built_in">sin</span>(pi*j/i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(cp *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> cp t;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) <span class="keyword">if</span>(i&lt;rev[i]) <span class="built_in">swap</span>(a[i], a[rev[i]]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">        t = a[i|j|k]*w[i|k], a[i|j|k] = a[j|k]-t, a[j|k] = a[j|k]+t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(cp *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i].x /= l, a[i].y /= l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">cp a[N], b[N], c[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*x*(x<span class="number">-1</span>)/<span class="number">2</span>%n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bluestein</span><span class="params">(cp *a, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> cp x[N], y[N];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) x[i].x = x[i].y = y[i].x = y[i].y = <span class="number">0.0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) x[i] = pw[n-<span class="built_in">comb</span>(i)]*a[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>*n<span class="number">-1</span>; i++) y[i] = pw[<span class="built_in">comb</span>(i)];</span><br><span class="line">  <span class="built_in">reverse</span>(x, x+n);</span><br><span class="line">  <span class="built_in">DFT</span>(x, up); <span class="built_in">DFT</span>(y, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) x[i] = x[i]*y[i];</span><br><span class="line">  <span class="built_in">IDFT</span>(x, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>; i&lt;=<span class="number">2</span>*n<span class="number">-2</span>; i++) a[i-n+<span class="number">1</span>] = x[i]*pw[n-<span class="built_in">comb</span>(i-n+<span class="number">1</span>)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Ibluestein</span><span class="params">(cp *a, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+n); <span class="built_in">bluestein</span>(a, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) a[i].x /= n, a[i].y /= n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">div</span><span class="params">(cp *a, cp * b, cp * c, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">bluestein</span>(a, n);</span><br><span class="line">  <span class="built_in">bluestein</span>(b, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) c[i] = a[i]/b[i];</span><br><span class="line">  <span class="built_in">Ibluestein</span>(c, n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;b[i].x);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;c[i].x);</span><br><span class="line">  <span class="built_in">init</span>(<span class="number">3</span>*n<span class="number">-3</span>);</span><br><span class="line">  pw[<span class="number">0</span>] = <span class="built_in">cp</span>(<span class="number">1</span>, <span class="number">0</span>); pw[<span class="number">1</span>] = <span class="built_in">cp</span>(<span class="built_in">cos</span>(<span class="number">2</span>*pi/n), <span class="built_in">sin</span>(<span class="number">2</span>*pi/n));</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) pw[i] = pw[i<span class="number">-1</span>]*pw[<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">div</span>(c, b, a, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.4f\n&quot;</span>, a[i].x);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢ å¯¼ä¸€å¯¼ è±å¸ƒå°¼èŒ¨æ±‚å¯¼å…¬å¼</title>
      <link href="/2020/09/24/niu-ke-dao-yi-dao-lai-bu-ni-ci-qiu-dao-gong-shi/"/>
      <url>/2020/09/24/niu-ke-dao-yi-dao-lai-bu-ni-ci-qiu-dao-gong-shi/</url>
      
        <content type="html"><![CDATA[<p>æ±‚$\sum\limits_{i=1}^k a_i\frac{sinx}{x^i}^{(n)}$è¾“å‡º$\frac{sinx}{x^i}$ å’Œ$\frac{cosx}{x^i}$â€‹å‰çš„ç³»æ•°$n, k \leq 10^5$</p><p>$(uv)^{(n)} = \sum\limits_{k=0}^n \binom{n}{k}u^{(k)}v^{(n-k)}$$\sum\limits_{j=0}^k \binom{k}{j} sinx^{(k-j)}\sum\limits_{i=1}^k(a_ix^{-i})^{(j)}$å‘ç°æ˜¯ä¸€ä¸ªå¤šé¡¹å¼ä¹˜æ³•çš„å½¢å¼ï¼Œç»§ç»­åŒ–ç®€$\sum\limits_{j=0}^k \binom{k}{j}sinx^{(k-j)}\sum\limits_{i=1}^ka_i(-i)^{\underline{j}}x^{-i-j}$$\sum\limits_{j=0}^k\binom{k}{j} sinx^{(k-j)}x^{-j}(-1)^j\sum\limits_{i=1}^ka_i\frac{(i+j-1)!}{(i-1)!}x^{-i}$æŠŠ$(i+j-1)!$æå‡ºæ¥ï¼Œå…¶ä½™çš„å°±æ˜¯ä¸¤ä¸ªå¤šé¡¹å¼ï¼ŒNTTç›¸ä¹˜åï¼Œæœ€åå†ä¹˜ä¸Š$(i+j-1)!$çš„è´¡çŒ®å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, k, fac[N], ifac[N], a[N], b[N], bb[N], c[N];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> poly</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">    <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n)</span> </span>&#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">    <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">          t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">    <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(n&lt;m||n&lt;<span class="number">0</span>||m&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*fac[n]*ifac[m]%mod*ifac[n-m]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">  poly::<span class="built_in">init</span>(n+k);</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n+k; i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  ifac[n+k] = <span class="built_in">fpw</span>(fac[n+k], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n+k<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; a[i];</span><br><span class="line">    a[i] = <span class="number">1ll</span>*a[i]*ifac[i<span class="number">-1</span>]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  poly::<span class="built_in">DFT</span>(a, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    b[i] = <span class="built_in">comb</span>(n, i);</span><br><span class="line">    <span class="keyword">if</span>((n-i)%<span class="number">4</span>&gt;<span class="number">1</span>) b[i] = mod - b[i];</span><br><span class="line">    <span class="keyword">if</span>(i&amp;<span class="number">1</span>) b[i] = mod - b[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i+=<span class="number">2</span>) bb[i] = b[i];</span><br><span class="line">  poly::<span class="built_in">DFT</span>(bb, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) c[i] = <span class="number">1ll</span>*a[i]*bb[i]%mod;</span><br><span class="line">  poly::<span class="built_in">IDFT</span>(c, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n+k; i++) cout &lt;&lt; <span class="number">1ll</span>*c[i]*fac[i<span class="number">-1</span>]%mod &lt;&lt; <span class="string">&quot; \n&quot;</span>[i==n+k];</span><br><span class="line"></span><br><span class="line">  poly::<span class="built_in">clear</span>(bb, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i+=<span class="number">2</span>) bb[i] = b[i];</span><br><span class="line">  poly::<span class="built_in">DFT</span>(bb, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) c[i] = <span class="number">1ll</span>*a[i]*bb[i]%mod;</span><br><span class="line">  poly::<span class="built_in">IDFT</span>(c, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n+k; i++) cout &lt;&lt; <span class="number">1ll</span>*c[i]*fac[i<span class="number">-1</span>]%mod &lt;&lt; <span class="string">&quot; \n&quot;</span>[i==n+k];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P5394 ã€æ¨¡æ¿ã€‘ä¸‹é™å¹‚å¤šé¡¹å¼ä¹˜æ³•</title>
      <link href="/2020/09/24/p5394-mo-ban-xia-jiang-mi-duo-xiang-shi-cheng-fa/"/>
      <url>/2020/09/24/p5394-mo-ban-xia-jiang-mi-duo-xiang-shi-cheng-fa/</url>
      
        <content type="html"><![CDATA[<p>ä¸‹é™å¹‚å¤šé¡¹å¼ï¼šFalling Factorial Polynomial(FFP)å½¢å¼$f(x) = \sum \limits_{i=0}^{n}a_ix^{\underline{i}}$æ™®é€šå¤šé¡¹å¼ä¸ä¸‹é™å¹‚å¤šé¡¹å¼æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼ˆä»é«˜å¹‚æ¬¡å‘ä½å¹‚æ¬¡é…ç³»æ•°å³å¯ï¼‰ç°åœ¨ç»™å‡ºä¸¤ä¸ªä¸‹é™å¹‚å¤šé¡¹å¼fï¼Œgï¼Œè¦æ±‚å‡ºè¿™ä¸¤ä¸ªå¤šé¡¹å¼ä¹˜æ³•çš„ç»“æœï¼ˆè¾“å‡ºæ™®é€šå¤šé¡¹å¼çš„ç³»æ•°ï¼‰$n \leq 10^5$åœ¨FFTä¸‹ï¼Œæ™®é€šå¤šé¡¹å¼åœ¨å•ä½æ ¹å¤„çš„ç‚¹å€¼å¯ä»¥å¿«é€Ÿè®¡ç®—è€Œä¸‹é™å¹‚å¤šé¡¹å¼åœ¨$0 \dots n$å¤„çš„ç‚¹å€¼å¯ä»¥å¿«é€Ÿè®¡ç®—è€ƒè™‘f(x)çš„EGFï¼š$\sum\limits_{i=0}^{\infty} \frac{f(i)}{i!}x^i = \sum \limits_{i=0}^{\infty}\frac{\sum \limits_{j=0}^{n} a_ji^{\underline{j}}}{i!}x^i = \sum\limits_{j=0}^n a_j \sum\limits_{i=0}^\infty \frac{1}{(i-j)!}x^i =\sum\limits_{j=0}^n a_jx^j \sum\limits_{i=0}^\infty \frac{x^i}{i!} =e^x\sum\limits_{i=0}^na_ix^i$æ‰€ä»¥æˆ‘ä»¬åªè¦æŠŠä¸‹é™å¹‚å¤šé¡¹å¼å½“æˆæ™®é€šå¤šé¡¹å¼ï¼Œç„¶åå·ä¸Šä¸€ä¸ª$e^x$å°±å¯ä»¥å¿«é€Ÿè®¡ç®—å‡ºf(x)åœ¨$0\dots n$å¤„çš„å–å€¼ï¼ˆå®è´¨æ˜¯$\frac{f(x)}{x!}$â€‹ï¼‰é‚£ä¹ˆå°†få’Œgåˆ†åˆ«å·ä¸Š$e^x$ç„¶åå¯¹åº”ç‚¹å€¼ç›¸ä¹˜ï¼Œå†åå˜æ¢å›å»ï¼ˆä¹˜ä¸Š$e^{-x} =\sum\limits_{i=0}^\infty \frac{(-x)^i}{i!}$â€‹ï¼‰å³å¯å¤æ‚åº¦$O(n\log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">8e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N], fac[N], ifac[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> poly</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">    <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n)</span> </span>&#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">    <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">          t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">    <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">conv</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> l)</span> </span>&#123; <span class="built_in">DFT</span>(a, l); <span class="built_in">DFT</span>(b, l); <span class="built_in">dot</span>(a, b, l, a); <span class="built_in">IDFT</span>(a, l); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, m, a[N], b[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ffp</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> tmp[N];</span><br><span class="line">  poly::<span class="built_in">clear</span>(tmp, up);</span><br><span class="line">  <span class="keyword">if</span>(op) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) tmp[i] = ifac[i];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) <span class="keyword">if</span>(i&amp;<span class="number">1</span>) tmp[i] = mod - ifac[i]; <span class="keyword">else</span> tmp[i] = ifac[i];</span><br><span class="line">  poly::<span class="built_in">conv</span>(a, tmp, up);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="type">int</span> deg = n + m;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=deg; i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  ifac[deg] = <span class="built_in">fpw</span>(fac[deg], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=deg<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">  poly::<span class="built_in">init</span>(deg&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) cin &gt;&gt; a[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=m; i++) cin &gt;&gt; b[i];</span><br><span class="line">  <span class="built_in">ffp</span>(a, deg, <span class="number">1</span>); <span class="built_in">ffp</span>(b, deg, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) a[i] = <span class="number">1ll</span>*a[i]*b[i]%mod*fac[i]%mod;</span><br><span class="line">  <span class="built_in">ffp</span>(a, deg, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=deg; i++) cout &lt;&lt; a[i] &lt;&lt; <span class="string">&quot; \n&quot;</span>[i==deg];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ç©æ„é™¤äº†åšè¿™ç§<s>æ²¡å•¥ç”¨</s>çš„æ¨¡æ¿é¢˜è¿˜èƒ½å¹²å•¥å‘¢</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢æŒ‘æˆ˜èµ›41 Dä¹°ç³–æœ æŠ˜åŠ å¤šç‚¹æ±‚å€¼</title>
      <link href="/2020/09/23/niu-ke-tiao-zhan-sai-41-d-mai-tang-guo-zhe-ban-duo-dian-qiu-zhi/"/>
      <url>/2020/09/23/niu-ke-tiao-zhan-sai-41-d-mai-tang-guo-zhe-ban-duo-dian-qiu-zhi/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šnä¸ªæ•°ï¼Œæ±‚æ‰€æœ‰éç©ºå­é›†çš„å’Œçš„ä¹˜ç§¯mod 998244353$n \leq 32$</p><p>è€ƒè™‘æŠ˜åŠLï¼ŒRï¼Œå¾ˆå®¹æ˜“çŠ¶å‹æ±‚å‡ºä¸¤éƒ¨åˆ†å†…éƒ¨å„è‡ªçš„è´¡çŒ®ï¼Œä¸¤éƒ¨åˆ†å…±åŒçš„è´¡çŒ®å¯ä»¥ç”¨$\prod\limits_{i=1}^{(1&lt;&lt;L)-1} \prod \limits_{j=1}^{(1&lt;&lt;R)-1} (c_i + d_j)$ä»¤$f(x) = \prod \limits_{j=1}^{(1&lt;&lt;R)-1}(x+d_j)$ï¼Œæ˜¾ç„¶å¯ä»¥ç”¨åˆ†æ²»NTTæ±‚å¾—è¯¥å¤šé¡¹å¼ï¼Œç„¶ååªè¦å¯¹æ¯ä¸ª$c_i$â€‹æ±‚å€¼åä¹˜ç§¯å³å¯ï¼Œå¤šç‚¹æ±‚å€¼æ¿å­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = (<span class="number">1</span>&lt;&lt;<span class="number">17</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> poly</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = <span class="number">1ll</span>*(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">    up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">    <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n)</span> </span>&#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">    <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">          t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">    <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">conv</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> l)</span> </span>&#123; <span class="built_in">DFT</span>(a, l); <span class="built_in">DFT</span>(b, l); <span class="built_in">dot</span>(a, b, l, a); <span class="built_in">IDFT</span>(a, l); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">Inv</span><span class="params">(<span class="type">const</span> <span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> c[N], l;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>) &#123; b[<span class="number">0</span>] = <span class="built_in">fpw</span>(a[<span class="number">0</span>], mod<span class="number">-2</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="built_in">Inv</span>(a, b, n&gt;&gt;<span class="number">1</span>); l = <span class="built_in">getlen</span>(n&lt;&lt;<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) c[i] = a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n+<span class="number">1</span>; i&lt;l; i++) c[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">DFT</span>(c, l); <span class="built_in">DFT</span>(b, l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) b[i] = (<span class="number">2ll</span><span class="number">-1ll</span>*c[i]*b[i]%mod+mod)%mod*b[i]%mod;</span><br><span class="line">    <span class="built_in">IDFT</span>(b, l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n+<span class="number">1</span>; i&lt;l; i++) b[i] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> *f[N], *g[N], buf[N&lt;&lt;<span class="number">5</span>], *<span class="built_in">np</span>(buf);</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> *b, <span class="type">int</span> m, <span class="type">int</span> *c, <span class="type">int</span> deg, <span class="type">int</span> st)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> A[N], B[N], l;</span><br><span class="line">    l = <span class="built_in">getlen</span>(deg), <span class="built_in">copy</span>(a, a+n+<span class="number">1</span>, A), <span class="built_in">copy</span>(b, b+m+<span class="number">1</span>, B);</span><br><span class="line">    <span class="built_in">conv</span>(A, B, l); <span class="built_in">copy</span>(A+st, A+deg+<span class="number">1</span>, c);</span><br><span class="line">    <span class="built_in">clear</span>(A, l), <span class="built_in">clear</span>(B, l);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">eval_init</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> *a)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    g[p] = np, np += r-l+<span class="number">2</span>, f[p] = np, np += r-l+<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123; g[p][<span class="number">0</span>] = (mod-a[l])%mod, g[p][<span class="number">1</span>] = <span class="number">1</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="type">int</span> lc = p&lt;&lt;<span class="number">1</span>, rc = lc|<span class="number">1</span>, mid = (l+r)&gt;&gt;<span class="number">1</span>, up1 = mid-l+<span class="number">1</span>, up2 = r-mid;</span><br><span class="line">    <span class="built_in">eval_init</span>(lc, l, mid, a); <span class="built_in">eval_init</span>(rc, mid+<span class="number">1</span>, r, a);</span><br><span class="line">    <span class="built_in">mul</span>(g[lc], up1, g[rc], up2, g[p], up1+up2, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">eval_work</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> *a)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123; a[l] = f[p][<span class="number">0</span>]; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="type">int</span> lc = p&lt;&lt;<span class="number">1</span>, rc = lc|<span class="number">1</span>, mid = (l+r)&gt;&gt;<span class="number">1</span>, up1 = mid-l+<span class="number">1</span>, up2 = r-mid;</span><br><span class="line">    <span class="built_in">mul</span>(f[p], r-l, g[rc], up2, f[lc], r-l, up2);</span><br><span class="line">    <span class="built_in">eval_work</span>(lc, l, mid, a);</span><br><span class="line">    <span class="built_in">mul</span>(f[p], r-l, g[lc], up1, f[rc], r-l, up1);</span><br><span class="line">    <span class="built_in">eval_work</span>(rc, mid+<span class="number">1</span>, r, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">eval</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> *b, <span class="type">int</span> m, <span class="type">int</span> *c)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> invg[N], q[N];</span><br><span class="line">    <span class="built_in">eval_init</span>(<span class="number">1</span>, <span class="number">1</span>, m, b);</span><br><span class="line">    <span class="built_in">reverse</span>(g[<span class="number">1</span>], g[<span class="number">1</span>]+m+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">Inv</span>(g[<span class="number">1</span>], invg, m);</span><br><span class="line">    <span class="built_in">reverse</span>(invg, invg+m+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">mul</span>(a, n, invg, m, q, n+m, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">copy</span>(q+n+<span class="number">1</span>, q+n+m+<span class="number">1</span>, f[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">eval_work</span>(<span class="number">1</span>, <span class="number">1</span>, m, c);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) c[i] = (<span class="number">1ll</span>*c[i]*b[i]%mod+a[<span class="number">0</span>])%mod;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, a[<span class="number">35</span>];</span><br><span class="line"><span class="type">int</span> c[N], d[N], v[N];</span><br><span class="line"><span class="type">int</span> *f[N], pool[N&lt;&lt;<span class="number">5</span>], *<span class="built_in">ptr</span>(pool);</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  f[p] = ptr, ptr += r-l+<span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r) &#123; f[p][<span class="number">0</span>] = d[l], f[p][<span class="number">1</span>] = <span class="number">1</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="type">int</span> lc = p&lt;&lt;<span class="number">1</span>, rc = lc|<span class="number">1</span>, mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">solve</span>(lc, l, mid); <span class="built_in">solve</span>(rc, mid+<span class="number">1</span>, r);</span><br><span class="line">  poly::<span class="built_in">mul</span>(f[lc], mid-l+<span class="number">1</span>, f[rc], r-mid, f[p], r-l+<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>); cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) cin &gt;&gt; a[i];</span><br><span class="line">  <span class="type">int</span> L = n/<span class="number">2</span>, R = n - L, ans = <span class="number">1</span>;</span><br><span class="line">  poly::<span class="built_in">init</span>((<span class="number">1</span>&lt;&lt;(R+<span class="number">1</span>))<span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;(<span class="number">1</span>&lt;&lt;L); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;L; j++)</span><br><span class="line">        <span class="keyword">if</span>((i&gt;&gt;j)&amp;<span class="number">1</span>) cur += a[j];</span><br><span class="line">    ans = <span class="number">1ll</span>*ans*cur%mod;</span><br><span class="line">    c[i] = cur;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;(<span class="number">1</span>&lt;&lt;R); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;R; j++)</span><br><span class="line">        <span class="keyword">if</span>((i&gt;&gt;j)&amp;<span class="number">1</span>) cur += a[L+j];</span><br><span class="line">    ans = <span class="number">1ll</span>*ans*cur%mod;</span><br><span class="line">    d[i] = cur;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">solve</span>(<span class="number">1</span>, <span class="number">1</span>, (<span class="number">1</span>&lt;&lt;R)<span class="number">-1</span>);</span><br><span class="line">  poly::<span class="built_in">eval</span>(f[<span class="number">1</span>], (<span class="number">1</span>&lt;&lt;R)<span class="number">-1</span>, c, (<span class="number">1</span>&lt;&lt;R)<span class="number">-1</span>, v);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;(<span class="number">1</span>&lt;&lt;L); i++) ans = <span class="number">1ll</span>*ans*v[i]%mod;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‹„åˆ©å…‹é›·å·ç§¯ç›¸å…³</title>
      <link href="/2020/09/18/di-li-ke-lei-juan-ji-xiang-guan/"/>
      <url>/2020/09/18/di-li-ke-lei-juan-ji-xiang-guan/</url>
      
        <content type="html"><![CDATA[<p>ç‹„åˆ©å…‹é›·å·ç§¯å³ä¹˜æ³•å·ç§¯$f_n = \sum \limits_{d\mid n} g_dh_{\frac{n}{d}}$ä¸¤ä¸ªç§¯æ€§å‡½æ•°çš„ç‹„åˆ©å…‹é›·å·ç§¯ä»ç„¶ç§¯æ€§</p><h2 id="Dirichlet-k-th-root"><a class="header-anchor" href="#Dirichlet-k-th-root">Â¶</a>Dirichlet k-th root</h2><p>ç»™å®šfï¼Œä»¤$g^k = f$ï¼Œæ±‚gæ­¤å¤„ä¹˜æ³•ä¸ºç‹„åˆ©å…‹é›·å·ç§¯æœ‰ç»“è®º$f^{mod} = \epsilon$ï¼Œå› è€Œ$f^{mod+1} = f$ï¼Œå°è¯•æ‰¾ä¸€ä¸ªxï¼Œä½¿å¾—$x * k = p * mod+1$ï¼Œè¿™æ ·$f^x$å³ä¸ºç­”æ¡ˆã€‚$x=inv(k)$å³å¯ç”±äºç‹„åˆ©å…‹é›·å·ç§¯å…·æœ‰ç»“åˆå¾‹ï¼Œå¥—ä¸€ä¸ªå¿«é€Ÿå¹‚</p><h2 id="P4714-ã€Œæ•°å­¦ã€çº¦æ•°ä¸ªæ•°å’Œ"><a class="header-anchor" href="#P4714-ã€Œæ•°å­¦ã€çº¦æ•°ä¸ªæ•°å’Œ">Â¶</a>P4714 ã€Œæ•°å­¦ã€çº¦æ•°ä¸ªæ•°å’Œ</h2><p>æ±‚$f_n = \sum \limits_{i_1\mid n}\sum \limits_{i_2\midi_1} \dots \sum \limits_{i_k\mid i_{k-1}} 1$</p><p>$n \leq 10^{18},k \leq 10^{18}$</p><p>ä¸Šé¢è¿™ä¸ªæ±‚å’Œå½¢å¼å¯ä»¥è½¬åŒ–æˆç‹„åˆ©å…‹é›·å·ç§¯çš„å½¢å¼ä»¤$g_i = 1$ï¼Œåˆ™$f = \epsilon^k * g$ç„¶è€Œè¿™é‡Œæ•°å­—å¤ªå¤§ï¼Œåšä¸äº†è¿™æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥å¯¹nè´¨å› æ•°åˆ†è§£åè€ƒè™‘å•ä¸ªç´ å› å­çš„å¹‚æ¬¡çš„å€¼ï¼ˆè¿™é‡Œè¦pollard-rhoï¼‰å¯¹äº$f_{p^x}$â€‹ï¼Œæˆ‘ä»¬ç›¸å½“äºæšä¸¾äº†æ‰€æœ‰æ»¡è¶³$x_1+x_2+\dots + x_k \leqx$ï¼Œå…¶ä¸­$x_i \geq 0$çš„xçš„ç»„åˆï¼Œæ ¹æ®æ’æ¿æ³•å…¶å€¼ä¸º$\binom{x+k}{k}$ï¼Œç”±äºå¹‚æ¬¡ä¸ä¼šå¾ˆå¤§ï¼Œå¯ä»¥è½¬åŒ–æˆ$\binom{x+k}{x}$ï¼Œæš´åŠ›è®¡ç®—å³å¯</p><h2 id="hdu5628-Clarke-and-math"><a class="header-anchor" href="#hdu5628-Clarke-and-math">Â¶</a>hdu5628 Clarke and math</h2><p>æ±‚$f_n = \sum \limits_{i_1\mid n}\sum \limits_{i_2\midi_1} \dots \sum \limits_{i_k\mid i_{k-1}}g_{i_k}$</p><p>$n \leq 10^5, k\leq 10^5$</p><p>è¿™é¢˜å°±æ˜¯æŠŠä¸Šé¢˜çš„1æ¢æˆäº†$kg_{i_k}$â€‹â€‹æ˜¾ç„¶çš„åšæ³•å°±æ˜¯ç‹„åˆ©å…‹é›·å·ç§¯åŠ å¿«é€Ÿå¹‚è¿™è¾¹è€ƒè™‘ä»¿ç…§ä¸Šä¸€é¢˜çš„åšæ³•ï¼Œä»¤$h_i$â€‹è¡¨ç¤º$g_j$â€‹è½¬ç§»ç»™$jf_{ij}$â€‹çš„è´¡çŒ®ï¼Œå¦‚æœèƒ½ç®—å‡º$h_i$â€‹ï¼Œé‚£ä¹ˆ$O(n\log n)$æšä¸¾å€æ•°å³å¯è§£å†³è¿™åŒæ ·æ˜¯ä¸ªç§¯æ€§å‡½æ•°ï¼Œè€ƒè™‘$h_{p^x}$â€‹ï¼Œç›¸å½“äºæšä¸¾äº†æ‰€æœ‰æ»¡è¶³$x_1+x_2+\dots + x_k = x$ï¼Œå…¶ä¸­$x_i \geq 0$çš„xçš„ç»„åˆï¼Œæ ¹æ®æ’æ¿æ³•å€¼ä¸º$\binom{x+k-1}{x}$è¿™é‡Œnå¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨ç´ æ•°ç­›$O(n)$æ±‚å¾—è¯¥ç§¯æ€§å‡½æ•°hæ‰€ä»¥æ€»å¤æ‚åº¦æ˜¯$O(n\log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>, up = <span class="number">2e5</span>;</span><br><span class="line"><span class="type">int</span> fac[N], ifac[N], f[N], g[N], h[N];</span><br><span class="line"><span class="type">int</span> n, k, pr[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fac[i] = <span class="number">1ll</span>*i*fac[i<span class="number">-1</span>]%mod;</span><br><span class="line">  ifac[n] = <span class="built_in">fpw</span>(fac[n], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*(i+<span class="number">1</span>)*ifac[i+<span class="number">1</span>]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a&lt;<span class="number">0</span>||b&lt;<span class="number">0</span>||a&lt;b) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*fac[a]*ifac[b]%mod*ifac[a-b]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  h[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!vis[i]) h[i] = k, pr[++pr[<span class="number">0</span>]] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=pr[<span class="number">0</span>]&amp;&amp;<span class="number">1ll</span>*pr[j]*i&lt;=n; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      vis[pr[j]*i] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span>(i%pr[j]==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> tmp = i/pr[j], cnt = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span>(tmp%pr[j]==<span class="number">0</span>) ++cnt, tmp /= pr[j];</span><br><span class="line">        h[pr[j]*i] = <span class="number">1ll</span>*h[tmp]*<span class="built_in">comb</span>(cnt+k<span class="number">-1</span>, cnt)%mod;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> h[pr[j]*i] = <span class="number">1ll</span>*h[i]*h[pr[j]]%mod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, f+i), g[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">get</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; i*j&lt;=n; j++)</span><br><span class="line">      g[i*j] = (g[i*j] + <span class="number">1ll</span>*f[i]*h[j])%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, g[i], <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">init</span>(up);</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ABC178</title>
      <link href="/2020/09/17/abc178/"/>
      <url>/2020/09/17/abc178/</url>
      
        <content type="html"><![CDATA[<p>æ¯”è¾ƒæ°´çš„ä¸€åœº</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>ï¼è¿ç®—ç¬¦</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>å››ç§è¾¹ç•Œå–ä¸ªmax</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ç®€å•å®¹æ–¥</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>é—®ä½ æœ‰å¤šå°‘ä¸ªåºåˆ—æ»¡è¶³æ‰€æœ‰å…ƒç´ éƒ½$\geq 3$å¹¶ä¸”å’Œç­‰äºs$s\leq 2000$è€ƒè™‘æšä¸¾è¿™ä¸ªåºåˆ—çš„é•¿åº¦ä¸ºné‚£ä¹ˆå°±è¦æ»¡è¶³$x_1+\dots +x_n = s - 2n$ï¼Œå…¶ä¸­$x_i$â€‹ä¸ºæ­£æ•´æ•°ï¼Œæ¯ä¸ªæ•°$\geq 3$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»™æ¯ä¸ªæ•°å‡æ‰2å°±è½¬åŒ–ä¸ºæ­£æ•´æ•°çš„è¦æ±‚ï¼Œä¸‹é¢å°±æ˜¯ä¸€ä¸ªç»å…¸çš„ç»„åˆæ•°æ’æ¿é—®é¢˜ï¼Œç­”æ¡ˆæ˜¯$\binom{s-2n-1}{n-1}$</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ç»™å®šnä¸ªç‚¹çš„åæ ‡ï¼Œæ±‚ä¸¤ç‚¹é—´çš„æœ€å¤§æ›¼å“ˆé¡¿è·ç¦»å¾ˆå¥—è·¯çš„é¢˜ï¼Œä¿å­˜(+x,+y),(+x,-y),(-x,+y),(-x,-y)å››ç§æƒ…å†µçš„æœ€å€¼ï¼Œæšä¸¾å–maxå³å¯ï¼Œå®¹æ˜“å‘ç°è™½ç„¶æšä¸¾ä¸­æœ‰ä¸åˆæ³•çš„æƒ…å†µï¼Œä½†ä¸€å®šä¸æ˜¯æœ€ä¼˜è§£ï¼ˆå› ä¸ºè¿™æ—¶å€™æˆ‘ä»¬æŠŠç»å¯¹å€¼å–è´Ÿäº†ï¼‰</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸ºné€’å¢åºåˆ—aå’Œbï¼Œè¦æ±‚é‡æ’bï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰iï¼Œæ»¡è¶³$a_i \neq b_i$â€‹$n \leq 2\times 10^5$å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªç½‘ç»œæµé—®é¢˜ï¼Œå¯¹äºæ¯ä¸ª$b_i$â€‹ï¼Œä½ å¯ä»¥æ”¾çš„ä½ç½®å°±æ˜¯aä¸­æ‰€æœ‰$a_j \neq b_i$â€‹çš„jï¼Œè¿è¾¹è·‘æœ€å¤§æµå³å¯ï¼Œç„¶è€Œæ˜¾ç„¶ä¼šçˆ†è¿™ç§ç‰¹æ®Šçš„ç½‘ç»œæµï¼Œè€ƒè™‘è´ªå¿ƒçš„è§£æ³•ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼Œå¯¹äºæ¯ä¸ª$a_i$â€‹ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸ç­‰äº$a_i$â€‹çš„ä¸”å¯æ”¾ç½®ä½ç½®æœ€å°‘çš„é‚£ä¸ª$b_j$â€‹ï¼Œå³åœ¨aä¸­å’Œå®ƒç›¸ç­‰çš„å…ƒç´ æœ€å¤šã€‚è¿™æ ·è´ªå¿ƒå³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EDU95</title>
      <link href="/2020/09/15/edu95/"/>
      <url>/2020/09/15/edu95/</url>
      
        <content type="html"><![CDATA[<h2 id="D-Trash-Problem"><a class="header-anchor" href="#D-Trash-Problem">Â¶</a>D. Trash Problem</h2><p>æœ‰nå †ç‰©å“æ’æˆä¸€æ¡çº¿ï¼Œå¯ä»¥å°†åŒä¸€ä½ç½®çš„<strong>æ‰€æœ‰</strong>ç‰©å“åŒæ—¶ç§»åŠ¨åˆ°ç›¸é‚»çš„ä½ç½®ï¼Œqæ¬¡æ“ä½œï¼Œæ¯æ¬¡å¯ä»¥æ·»åŠ ä¸€å †ç‰©å“æˆ–è€…åˆ é™¤ä¸€å †ç‰©å“ï¼Œå¹¶è¯¢é—®å°†æ‰€æœ‰ç‰©å“ç§»åŠ¨æˆå°äºç­‰äº2å †çš„æœ€å°ä»£ä»·$n \leq 10^5,q \leq 10^5$ç¬¬ä¸€ååº”åº”è¯¥æ˜¯ä¸­ä½æ•°ï¼Œä½†è¦å‘ç°æ¯æ¬¡å¿…é¡»åŒæ—¶ç§»åŠ¨åŒä¸€ä½ç½®çš„æ‰€æœ‰ç‰©å“ï¼Œé‚£ä¹ˆå¦‚æœç§»æˆä¸€å †ï¼Œç­”æ¡ˆå°±æ˜¯æœ€å¤§åæ ‡$x_n$â€‹-æœ€å°åæ ‡$x_1$â€‹ï¼Œè€ƒè™‘ç§»æˆä¸¤å †ï¼Œåªè¦æšä¸¾ä¸€ä¸ªåˆ†å‰²ç‚¹iï¼Œç„¶åå‰é¢çš„ä»£ä»·æ˜¯$x_i-x_1$â€‹ï¼Œåé¢çš„ä»£ä»·æ˜¯$x_n-x_{i+1}$â€‹ï¼Œæ‰€ä»¥æœ€å°ä»£ä»·å°±æ˜¯æœ€å¤§åæ ‡-æœ€å°åæ ‡-ç›¸é‚»åæ ‡çš„æœ€å¤§å·®å€¼ã€‚åˆ©ç”¨multisetåŠ¨æ€ç»´æŠ¤å³å¯tips:å¯ä»¥ç”¨rbeginæ¥æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ¯”--endæ–¹ä¾¿ç‚¹</p><h2 id="E-Expected-Damage"><a class="header-anchor" href="#E-Expected-Damage">Â¶</a>E. Expected Damage</h2><p>æœ‰nä¸ªæ€ªç‰©ï¼Œç¬¬iä¸ªæ€ªç‰©çš„ä¼¤å®³ä¸º$d_i$â€‹ï¼Œç°åœ¨æœ‰ä¸€ä¸ªç›¾ç‰Œï¼Œæœ‰å±æ€§aå’Œbï¼Œå½“$a\gt 0$æ—¶ï¼Œå¯ä»¥å…ç–«$\lt b$çš„ä¼¤å®³ï¼Œè€Œ$\geq b$çš„ä¼¤å®³ä¼šä½¿$a-1$ï¼ˆä¸ä¼šå—åˆ°ä¼¤å®³ï¼‰ï¼Œè€Œå½“$a=0$æ—¶ï¼Œä¼šå—åˆ°æ‰€æœ‰çš„ä¼¤å®³ã€‚ç°åœ¨æœ‰mç§ç›¾ç‰Œï¼Œå¯¹äºæ¯ç§éœ€è¦å›ç­”åœ¨n!ç§æ‰“æ€ªæ–¹å¼ä¸‹ï¼Œå—åˆ°çš„ä¼¤å®³çš„æœŸæœ›$n \leq 2\times 10^5,m \leq 2\times 10^5$è€ƒè™‘æ¯ç§æ€ªç‰©çš„è´¡çŒ®ï¼Œå®¹æ˜“å‘ç°å¯ä»¥åˆ†æˆä¼¤å®³$&lt;b$å’Œ$\geq b$ä¸¤ç±»è®¡ç®—æœ€å¥½çš„åšæ³•æ˜¯ä»æ•´ä½“ä¸Šè€ƒè™‘å®šä¹‰geä¸ºä¼¤å®³$\geq b$çš„æ€ªç‰©æ•°é‡ï¼Œleä¸º$&lt;b$çš„æ€ªç‰©æ•°é‡ï¼Œå°†dæ’åºålowerboundå³å¯å¯¹äºä¼¤å®³$\geq b$çš„geä¸ªæ€ªç‰©ï¼Œæ’åœ¨å‰aä¸ªæ˜¯æ²¡æœ‰ä¼¤å®³çš„ï¼Œå› ä¸ºä¼šè¢«ç›¾ç‰ŒæŒ¡æ‰ï¼Œæ‰€ä»¥æœ‰è´¡çŒ®çš„æ¦‚ç‡å°±æ˜¯$\frac{ge-a}{ge}$ï¼Œå†ä¹˜ä¸Šè¿™äº›æ€ªç‰©çš„ä¼¤å®³å’Œå³å¯å¯¹äºä¼¤å®³$\lt b$çš„leä¸ªæ€ªç‰©ï¼Œå¿…é¡»ä¿è¯å‰é¢æœ‰è‡³å°‘aä¸ªä¼¤å®³$\geq b$çš„æ€ªç‰©ï¼Œå¯ä»¥å›ºå®šä½geä¸ªæ€ªç‰©çš„ä½ç½®ï¼Œé‚£ä¹ˆç°åœ¨æœ‰ge+1ä¸ªç©ºä½ï¼Œå‰aä¸ªæ˜¯æ²¡æœ‰è´¡çŒ®çš„ï¼Œæ‰€ä»¥æœ‰è´¡çŒ®çš„æ¦‚ç‡å°±æ˜¯$\frac{ge+1-a}{ge+1}$â€‹ï¼Œå†ä¹˜ä¸Šä¸€ä¸ªå‰ç¼€å’Œå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>, mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">int</span> n, m, d[N], sum[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = <span class="number">1ll</span>*(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; d[i];</span><br><span class="line">  <span class="built_in">sort</span>(d+<span class="number">1</span>, d+n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) sum[i] = (sum[i<span class="number">-1</span>] + d[i])%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="type">int</span> le = <span class="built_in">lower_bound</span>(d+<span class="number">1</span>, d+n+<span class="number">1</span>, b) - d - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ge = n - le;</span><br><span class="line">    <span class="type">int</span> x = (ge &lt; a ? <span class="number">0</span> : <span class="number">1ll</span>*(ge-a)*inv[ge]%mod*(sum[n]-sum[le])%mod);</span><br><span class="line">    <span class="type">int</span> y = (ge &lt; a ? <span class="number">0</span> : <span class="number">1ll</span>*(ge+<span class="number">1</span>-a)*inv[ge+<span class="number">1</span>]%mod*sum[le]%mod);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ((x+y)%mod+mod)%mod);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="G-Three-Occurrences"><a class="header-anchor" href="#G-Three-Occurrences">Â¶</a>G. Three Occurrences</h2><p>ç»™å‡ºä¸€ä¸ªæ•°ç»„aï¼Œå®šä¹‰ä¸€ä¸ªåŒºé—´æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“æ¯ä¸ªæ•°æ°å¥½å‡ºç°0æ¬¡æˆ–è€…3æ¬¡ï¼Œè¯¢é—®å¥½åŒºé—´çš„ä¸ªæ•°$n\leq 5\times 10^5, 1\leq a_i \leq n$è€ƒè™‘å›ºå®šå·¦ç«¯ç‚¹ä¸ºiï¼Œé‚£ä¹ˆ$a_i$â€‹å‡ºç°0æ¬¡å’Œ3æ¬¡å°±æ˜¯ä¸¤ä¸ªè¿ç»­çš„åŒºé—´ï¼Œæˆ‘ä»¬å¯¹$1-n$çš„æ¯ä¸ªæ•°ç»´æŠ¤å®ƒçš„åˆæ³•åŒºé—´ï¼Œå¦‚æœæ˜¯åˆæ³•çš„å°±è®©è¿™æ®µåŒºé—´çš„æ¯ä¸ªæ•°éƒ½ç­‰äº1ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€é¢—çº¿æ®µæ ‘æ¥ç»´æŠ¤ã€‚ä»åå¾€å‰æšä¸¾å·¦ç«¯ç‚¹ï¼Œå¯¹äº$a_i$â€‹ï¼Œæˆ‘ä»¬å…ˆåˆ é™¤å®ƒä¹‹å‰çš„åˆæ³•åŒºé—´(ä¸¤æ®µåŒºé—´-1)ï¼Œç„¶åå†åŠ ä¸Šå®ƒå½“å‰çš„åˆæ³•åŒºé—´(ä¸¤ç«¯åŒºé—´+1)ï¼Œåªéœ€è¦æŸ¥è¯¢å·¦ç«¯ç‚¹-nä¸­å¤§å°ç­‰äºnçš„å€¼çš„ä¸ªæ•°å³å¯(æ˜¾ç„¶æœ€å¤§å€¼$\leq n$ï¼Œæ‰€ä»¥ç»´æŠ¤æœ€å¤§å€¼ä»¥åŠæœ€å¤§å€¼ä¸ªæ•°å³å¯)$O(n\log n)$è¿™é¢˜è¿˜æœ‰ä¸€ç§æ›´åŠ æ™®é€‚çš„å“ˆå¸Œåšæ³•ï¼Œè€Œä¸”å¤æ‚åº¦æ˜¯$O(n)$çš„ï¼Œå…ˆå’•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, mx, cnt, tag;</span><br><span class="line">  <span class="built_in">seg</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">seg</span>(<span class="type">int</span> _l, <span class="type">int</span> _r) : <span class="built_in">l</span>(_l), <span class="built_in">r</span>(_r), <span class="built_in">mx</span>(<span class="number">0</span>), <span class="built_in">cnt</span>(<span class="number">0</span>), <span class="built_in">tag</span>(<span class="number">0</span>) &#123;&#125;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pull</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].mx = <span class="built_in">max</span>(t[p&lt;&lt;<span class="number">1</span>].mx, t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].mx);</span><br><span class="line">  t[p].cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mx==t[p&lt;&lt;<span class="number">1</span>].mx) t[p].cnt += t[p&lt;&lt;<span class="number">1</span>].cnt;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mx==t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].mx) t[p].cnt += t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].mx += v;</span><br><span class="line">  t[p].tag += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setv</span>(p&lt;&lt;<span class="number">1</span>, t[p].tag); <span class="built_in">setv</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, t[p].tag);</span><br><span class="line">  t[p].tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p] = <span class="built_in">seg</span>(l, r);</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mx = n, t[p].cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">pull</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setv</span>(p, v);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">push</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>, x, y, v);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y, v);</span><br><span class="line">  <span class="built_in">pull</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">chk</span><span class="params">(pii &amp;a, pii b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a.fi==b.fi) a.se += b.se;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(a.fi&lt;b.fi) a = b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pii <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> &#123;t[p].mx, t[p].cnt&#125;;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">push</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>; pii ans = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">chk</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">chk</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; a[i];</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="type">int64_t</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) p[i].<span class="built_in">push_back</span>(n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n; i&gt;=<span class="number">1</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> sz = p[a[i]].<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span>(sz&gt;=<span class="number">4</span>) <span class="built_in">upd</span>(<span class="number">1</span>, p[a[i]][sz<span class="number">-3</span>], p[a[i]][sz<span class="number">-4</span>]<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="type">int</span> suf = p[a[i]][sz<span class="number">-1</span>];</span><br><span class="line">    p[a[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    ++sz;</span><br><span class="line">    <span class="keyword">if</span>(sz&gt;=<span class="number">4</span>) <span class="built_in">upd</span>(<span class="number">1</span>, p[a[i]][sz<span class="number">-3</span>], p[a[i]][sz<span class="number">-4</span>]<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, i, suf<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">auto</span> cur = <span class="built_in">ask</span>(<span class="number">1</span>, i, n);</span><br><span class="line">    <span class="keyword">if</span>(cur.fi==n) ans += cur.se;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P6800 ã€æ¨¡æ¿ã€‘Chirp-Z Transform</title>
      <link href="/2020/09/13/p6800-mo-ban-chirp-z-transform/"/>
      <url>/2020/09/13/p6800-mo-ban-chirp-z-transform/</url>
      
        <content type="html"><![CDATA[<p>ç»™å‡ºä¸€ä¸ªné¡¹å¤šé¡¹å¼Pï¼Œè¦æ±‚å‡ºåœ¨$c^0,c^1,â€¦,c^{m-1}$å¤„å¤šé¡¹å¼çš„å€¼$n\leq 10^6,m\leq 10^6$</p><h4 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h4><p>ç›´æ¥å¤šç‚¹æ±‚å€¼ä¼št$\sum \limits_{i=0}^{n-1}a_ic^{mi}P(cm)$è€ƒè™‘æŠŠ$mi$æ¢ä¸€ä¸‹$mi = \binom{m+i}{2} - \binom{m}{2} -\binom{i}{2}$$P(c^m) = c^{-\binom{m}{2}}\sum\limits_{i=0}^{n-1}(a_ic^{-\binom{i}{2}})(c^{\binom{m+i}{2}})$å‡æ³•å·ç§¯ï¼ŒæŠŠå‰ä¸€ä¸ªç¿»è½¬åNTTå³å¯æ³¨æ„æŒ‡æ•°ä¸Šçš„å–æ¨¡è¦ç”¨æ‰©å±•æ¬§æ‹‰å®šç†å¦‚æœæŠŠcæ¢æˆ$\omega_n^1$â€‹å³$complex(cos(2\pi/n),sin(2\pi/n))$ï¼Œå°±æ˜¯bluesteinç®—æ³•äº†ï¼Œå¯ä»¥è§£å†³ä»»æ„é•¿åº¦çš„å·ç§¯ï¼Œå°±æ˜¯å¸¸æ•°å¾ˆå¤§ï¼Œå› ä¸ºä¸€æ¬¡DFTå°±ç›¸å½“äºä¸€æ¬¡å¤šé¡¹å¼ä¹˜æ³•ï¼Œå³ä¸‰æ¬¡DFTå°ä¼˜åŒ–ï¼šç”±äºæˆ‘ä»¬åªéœ€è¦å¾—åˆ°nåˆ°n+mé¡¹çš„å€¼ï¼Œæ‰€ä»¥næ¬¡å¤šé¡¹å¼å’Œn+mæ¬¡å¤šé¡¹å¼æˆ‘ä»¬åªéœ€è¦æ±‚åˆ°n+må³å¯ï¼Œè€Œä¸ç”¨æ±‚åˆ°2*n+m</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">6e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> n, c, m, a[N], b[N];</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">  <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">  <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">        t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">  <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;c, &amp;m);</span><br><span class="line">  --n, --m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    a[i] = <span class="number">1ll</span>*a[i]*<span class="built_in">fpw</span>(c, (mod<span class="number">-1</span>)<span class="number">-1ll</span>*i*(i<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n+m; i++) b[i] = <span class="built_in">fpw</span>(c, <span class="number">1ll</span>*i*(i<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>));</span><br><span class="line">  <span class="built_in">init</span>(<span class="number">2</span>*n+m);</span><br><span class="line">  <span class="built_in">reverse</span>(a, a+n+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> l = <span class="built_in">getlen</span>(<span class="number">2</span>*n+m);</span><br><span class="line">  <span class="built_in">DFT</span>(a, l); <span class="built_in">DFT</span>(b, l); <span class="built_in">dot</span>(a, b, l, a); <span class="built_in">IDFT</span>(a, l);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n; i&lt;=n+m; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, <span class="number">1ll</span>*a[i]*<span class="built_in">fpw</span>(c, (mod<span class="number">-1</span>)<span class="number">-1ll</span>*(i-n)*(i-n<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>))%mod, <span class="string">&quot; \n&quot;</span>[i==n+m]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gã€Pikachu é—®é¢˜è½¬åŒ–+æ¢æ ¹dp</title>
      <link href="/2020/09/03/gpikachu-wen-ti-zhuan-hua-huan-gen-dp/"/>
      <url>/2020/09/03/gpikachu-wen-ti-zhuan-hua-huan-gen-dp/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€æ£µnä¸ªç‚¹çš„æ ‘ï¼Œå®šä¹‰ä¸€å¼ å®Œå…¨å›¾ï¼Œ$w(u, v) = dis(u, v)$ï¼Œé—®ä½ å„å¯¹èŠ‚ç‚¹é—´çš„æœ€å¤§æµçš„å’Œ$n \leq 10^5$æœ€å¤§æµä¸å¥½æƒ³ï¼Œè½¬åŒ–æˆæœ€å°å‰²ï¼Œé‚£ä¹ˆsåˆ°tçš„æœ€å°å‰²å°±æ˜¯å°†å®Œå…¨å›¾åˆ†æˆä¸¤ä¸ªä¸è¿é€šçš„å®Œå…¨å›¾ï¼Œå…¶ä¸­ä¸€ä¸ªåŒ…å«sï¼Œå¦ä¸€ä¸ªåŒ…å«tï¼Œç„¶åè¦æœ€å¤§åŒ–è¿™ä¸¤ä¸ªå®Œå…¨å›¾å†…éƒ¨çš„è¾¹æƒå’Œã€‚å®¹æ˜“å‘ç°å½“å…¶ä¸­ä¸€ä¸ªç‚¹ä¸ºå­¤ç«‹ç‚¹ï¼Œå¦ä¸€ä¸ªä¸ºn-1ä¸ªç‚¹çš„å®Œå…¨å›¾æ˜¯æœ€ä¼˜ï¼Œç›¸å½“äºå‰²å»å­¤ç«‹ç‚¹ä¸å…¶ä»–n-1ä¸ªç‚¹é—´çš„æ‰€æœ‰è¾¹ã€‚æ‰€ä»¥sä¸té—´çš„æœ€å¤§æµç­‰äºmin(sä¸å…¶ä»–æ‰€æœ‰ç‚¹åœ¨æ ‘ä¸Šçš„è·ç¦»å’Œï¼Œtä¸å…¶ä»–æ‰€æœ‰ç‚¹åœ¨æ ‘ä¸Šçš„è·ç¦»å’Œ)ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¢æ ¹dpæ±‚å‡ºæ¯ä¸ªèŠ‚ç‚¹ä¸å…¶ä»–æ‰€æœ‰ç‚¹åœ¨æ ‘ä¸Šçš„è·ç¦»å’Œï¼Œç„¶åä»å¤§åˆ°å°æ’åºåï¼Œæ¯ä¸ªçš„è´¡çŒ®å°±æ˜¯(rank-1)æ¬¡ï¼Œç²—ç•¥ä¼°ç®—å¯ä»¥å‘ç°ç­”æ¡ˆéœ€è¦ç”¨__int128å­˜å‚¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, sz[N];</span><br><span class="line">vector&lt;pii&gt; G[N];</span><br><span class="line">ll dp[N][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  sz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">    sz[u] += sz[v];</span><br><span class="line">    dp[u][<span class="number">0</span>] += dp[v][<span class="number">0</span>] + w*sz[v];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    dp[v][<span class="number">1</span>] = dp[u][<span class="number">0</span>] - dp[v][<span class="number">0</span>] - w*sz[v] + w*(sz[u] - sz[v]) + dp[u][<span class="number">1</span>] + w*(n - sz[u]);</span><br><span class="line">    <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(__int128 x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> buf[<span class="number">70</span>], tp;</span><br><span class="line">  tp = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(!x) buf[tp = <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    buf[++tp] = x%<span class="number">10</span>;</span><br><span class="line">    x /= <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=tp; i&gt;=<span class="number">1</span>; i--) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, buf[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) G[i].<span class="built_in">clear</span>(), dp[i][<span class="number">0</span>] = dp[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">    G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>); <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="function">vector&lt;ll&gt; <span class="title">alldis</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) alldis[i<span class="number">-1</span>] = dp[i][<span class="number">0</span>] + dp[i][<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(alldis), <span class="built_in">end</span>(alldis)); <span class="built_in">reverse</span>(<span class="built_in">begin</span>(alldis), <span class="built_in">end</span>(alldis));</span><br><span class="line">  __int128 ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++) ans += (__int128)i*alldis[i];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, kase); <span class="built_in">print</span>(ans); <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> kase=<span class="number">1</span>; kase&lt;=_; ++kase) <span class="built_in">solve</span>(kase);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kinetic Tournament</title>
      <link href="/2020/09/03/kinetic-tournament/"/>
      <url>/2020/09/03/kinetic-tournament/</url>
      
        <content type="html"><![CDATA[<p>åˆæ˜¯ä¸€ä¸ªå‡¸å£³é—®é¢˜ç°åœ¨æœ‰næ¡ç›´çº¿ï¼Œç¬¬iæ¡çš„æ–œç‡ä¸º$k_i$â€‹ï¼Œæˆªè·ä¸º$b_i$â€‹ï¼Œå½“å‰xåæ ‡çš„å€¼ä¸º$x_i$â€‹ï¼Œè¦æ±‚æ”¯æŒä»¥ä¸‹æ“ä½œ1.ä¿®æ”¹ç¬¬iæ¡ç›´çº¿çš„æ–œç‡ã€æˆªè·2.è®©$[l, r]$èŒƒå›´å†…æ‰€æœ‰ç›´çº¿çš„xåæ ‡çš„å€¼å¢åŠ delta3.è¯¢é—®$[l, r]$èŒƒå›´å†…æ‰€æœ‰ç›´çº¿çš„yåæ ‡çš„æœ€å¤§å€¼<a href="https://codeforces.com/blog/entry/82094">https://codeforces.com/blog/entry/82094</a>ç¬¬äºŒä¸ªæ“ä½œå¿…é¡»æ˜¯å¢åŠ ï¼Œä¸èƒ½å‡å°‘å…¶å®å°±æ˜¯ç”¨æ™®é€šçš„çº¿æ®µæ ‘æ¥åšï¼Œå¦‚æœä¸å¸¦ä¿®æ”¹ï¼Œå°±æ˜¯ä¸€æ£µèƒœè€…æ ‘(tournament)ï¼Œè‡ªåº•å‘ä¸Šè¿›è¡Œpushupæ“ä½œï¼Œpç»“ç‚¹å­˜å‚¨çš„æ˜¯å­æ ‘å†…æ‰€æœ‰ç›´çº¿ä¸­yåæ ‡æœ€å¤§çš„é‚£æ¡ï¼Œç¬¬ä¸€ä¸ªæ“ä½œå’Œç¬¬ä¸‰ä¸ªæ“ä½œå°±æ˜¯æ™®é€šçš„çº¿æ®µæ ‘äº†ã€‚å¯¹äºç¬¬äºŒä¸ªæ“ä½œï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªç»“ç‚¹é¢å¤–ç»´æŠ¤ä¸€ä¸ªå«waitçš„å˜é‡ï¼Œè¡¨ç¤º<strong>å¦‚æœå­æ ‘å†…èƒœè€…å‘ç”Ÿå˜åŒ–ï¼Œæœ€å°‘è¦è®©æ•´ä¸ªå­æ ‘çš„xåæ ‡å¢åŠ wait</strong>ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥pushupæ¥ç»´æŠ¤ï¼Œè€ŒåŒºé—´å¢åŠ deltaï¼Œç”¨ä¸€ä¸ªlazytagå³å¯ã€‚ä½†æ˜¯å½“ä¸”ä»…å½“å½“å‰åŒºé—´çš„waitå€¼å¤§äºè¿™ä¸ªå¢é‡deltaæ—¶æˆ‘ä»¬æ‰ç›´æ¥æ•´ä¸ªå­æ ‘ä¿®æ”¹ï¼Œå¦åˆ™ç”±äºèƒœè€…ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­é€’å½’ä¸‹å»ï¼ˆç±»ä¼¼äºsegment beatsï¼Œä¹Ÿæ˜¯ç”¨æ‘Šè¿˜åˆ†æ(<s>ä¸ä¼š</s>)ï¼‰ï¼Œå¤æ‚åº¦å¤§æ¦‚æ˜¯$\lt O(n\log^3n) \ or \approx O(n\log^2n)$é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¿™ç©æ„æœ‰å•¥ç”¨ç¬¬ä¸€ä¸ªæ“ä½œå¯ä»¥å½“æˆæ’å…¥å’Œåˆ é™¤ç›´çº¿ï¼Œç¬¬äºŒä¸ªæ“ä½œç›¸å½“äºä¿®æ”¹è¯¢é—®çš„å€¼ï¼Œå¦‚æœè¯¢é—®éå¢æˆ‘ä»¬å¯ä»¥ç¦»çº¿ä¸‹æ¥ï¼Œç¬¬ä¸‰ä¸ªæ“ä½œå°±æ˜¯åŒºé—´å‡¸å£³è¯¢é—®ï¼Œè€Œä¸”æ–œç‡æ˜¯å¦å•è°ƒæ— å…³ç´§è¦ã€‚å¦‚æœç”¨ä¸€èˆ¬çš„CHTï¼Œè¦å®ç°åŒºé—´æŸ¥è¯¢ï¼Œè¿˜è¦åœ¨å¤–é¢å¥—ä¸€ä¸ªfenwicktreeæˆ–è€…æ˜¯segtreeï¼Œå¤æ‚åº¦ä¸Šå¹¶æ²¡æœ‰ä¼˜åŠ¿ï¼Œæ­¤å¤–è¿™ä¸ªä¸œè¥¿è¿˜èƒ½æ”¯æŒåˆ é™¤æ“ä½œï¼Œä¼¼ä¹æœ‰ç‚¹ç”¨ã€‚è€ƒè™‘ä¸€ä¸ªæ ‘ä¸Šçš„æ–œç‡ä¼˜åŒ–ï¼Œæ–œç‡å•è°ƒæˆ‘ä»¬å¯ä»¥ç”¨å¯å›é€€çš„é˜Ÿåˆ—æ¥ç»´æŠ¤å‡¸å£³ï¼Œä½†æ˜¯æœ‰äº†è¿™ä¸ªæˆ‘ä»¬ç›´æ¥æ— è„‘æ ‘å‰–ï¼Œç®¡ä»–æ–œç‡å•ä¸å•è°ƒã€‚ä»¥ä¸Šçº¯å±çŒœæƒ³ï¼Œæœªç»å®è·µã€‚ã€‚</p><h2 id="cf1178-G-The-Awesomest-Vertex"><a class="header-anchor" href="#cf1178-G-The-Awesomest-Vertex">Â¶</a>cf1178 G. The Awesomest Vertex</h2><p>è¿™ä¸ªé—®é¢˜ç›¸å½“äºä¸Šé¢çš„æ”¯æŒ2å’Œ3æ“ä½œçš„ç‰ˆæœ¬ï¼ŒåŒæ—¶æ˜¯å­æ ‘é—®é¢˜ï¼ˆdfsåºå³å¯ï¼‰è¿™è¾¹è¦ç»´æŠ¤çš„æ˜¯$|b_ix + a_ib_i|$çš„æœ€å¤§å€¼ï¼Œç”±äºå¸¦ç»å¯¹å€¼ï¼Œè¦åŒæ—¶ç»´æŠ¤æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œæˆ‘ä»¬è€ƒè™‘ç»´æŠ¤$-b_ix - a_ib_i$â€‹çš„æœ€å¤§å€¼å³å¯ã€‚ä¼¼ä¹è¦å»ºä¸¤æ£µçº¿æ®µæ ‘ï¼Œä¸è¿‡è¿™è¾¹ç”¨ä¸€ä¸ªæŠ€å·§ã€‚æˆ‘ä»¬å¼€ä¸€ä¸ª2*nçš„çº¿æ®µæ ‘ï¼ŒæŠŠè¿™ä¸¤æ£µæ ‘åˆèµ·æ¥ï¼Œä¸€é¢—æ”¾åœ¨$2i-1$çš„ä½ç½®ï¼Œä¸€é¢—æ”¾åœ¨$2i$çš„ä½ç½®ï¼Œç„¶åå°±å¯ä»¥å½“æˆä¸€æ£µæ¥æ“ä½œäº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll inf = LLONG_MAX;</span><br><span class="line"><span class="type">int</span> n, q, a[N], b[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="type">int</span> in[N], out[N], num[N], id;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  in[u] = ++id;</span><br><span class="line">  num[id] = u;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    a[v] += a[u]; b[v] += b[u];</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  out[u] = id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line">  ll k, b, x;</span><br><span class="line">  <span class="function">ll <span class="title">eval</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> k*x + b; &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> Line&amp; oth)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    ll x1 = <span class="built_in">eval</span>(), x2 = oth.<span class="built_in">eval</span>();</span><br><span class="line">    <span class="keyword">if</span>(x1!=x2) <span class="keyword">return</span> x1 &gt; x2;</span><br><span class="line">    <span class="keyword">return</span> k &gt; oth.k;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">ll <span class="title">isect</span><span class="params">(<span class="type">const</span> Line&amp; oth)</span> </span>&#123; <span class="keyword">return</span> (<span class="built_in">eval</span>()-oth.<span class="built_in">eval</span>())/(oth.k-k) + <span class="number">1</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r;</span><br><span class="line">  Line L;</span><br><span class="line">  ll wait, tag;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, ll add)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].L.x += add;</span><br><span class="line">  t[p].tag += add;</span><br><span class="line">  t[p].wait -= add;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> l1 = t[p&lt;&lt;<span class="number">1</span>].L, l2 = t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].L;</span><br><span class="line">  <span class="keyword">if</span>(!l1.<span class="built_in">cmp</span>(l2)) <span class="built_in">swap</span>(l1, l2);</span><br><span class="line">  t[p].L = l1;</span><br><span class="line">  t[p].wait = <span class="built_in">min</span>(t[p&lt;&lt;<span class="number">1</span>].wait, t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].wait);</span><br><span class="line">  <span class="keyword">if</span>(l1.k&lt;l2.k) t[p].wait = <span class="built_in">min</span>(t[p].wait, l1.<span class="built_in">isect</span>(l2));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setv</span>(p&lt;&lt;<span class="number">1</span>, t[p].tag), <span class="built_in">setv</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, t[p].tag);</span><br><span class="line">  t[p].tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].l = l, t[p].r = r, t[p].wait = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x = num[(l+<span class="number">1</span>)/<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">if</span>(l&amp;<span class="number">1</span>) t[p].L = &#123;b[x], <span class="number">1ll</span>*a[x]*b[x], <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">else</span> t[p].L = &#123;-b[x], <span class="number">-1ll</span>*a[x]*b[x], <span class="number">0</span>&#125;;</span><br><span class="line">    t[p].wait = inf;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y, ll add)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y &amp;&amp; t[p].wait&gt;add)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setv</span>(p, add);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>, x, y, add);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y, add);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qry</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> t[p].L.<span class="built_in">eval</span>();</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>; ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) ans = <span class="built_in">max</span>(ans, <span class="built_in">qry</span>(p&lt;&lt;<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) ans = <span class="built_in">max</span>(ans, <span class="built_in">qry</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> fa; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;fa);</span><br><span class="line">    G[fa].<span class="built_in">push_back</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, b+i);</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>*n);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;v);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ll x; <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;x);</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, in[v]*<span class="number">2</span><span class="number">-1</span>, out[v]*<span class="number">2</span>, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">qry</span>(<span class="number">1</span>, in[v]*<span class="number">2</span><span class="number">-1</span>, out[v]*<span class="number">2</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cache friendly</title>
      <link href="/2020/09/02/cache-friendly/"/>
      <url>/2020/09/02/cache-friendly/</url>
      
        <content type="html"><![CDATA[<p>å°½é‡å‡å°‘cache missä¿è¯æ—¶ç©ºå±€éƒ¨æ€§ï¼Œå°½é‡è¿ç»­åœ°è®¿å­˜ï¼Œä½¿ç”¨å±€éƒ¨å˜é‡ä½¿ç”¨æŒ‡é’ˆè®¿é—®å¯ä»¥åŠ å¿«é€Ÿåº¦ï¼ˆä»…é™äºå¡å¸¸ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *st = a + <span class="number">1</span>, *ed = a + n + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(st!=ed) <span class="built_in">work</span>(*(st++));</span><br></pre></td></tr></table></figure><ul><li>å¯¹æ ‘è¿›è¡Œæ ‘é“¾å‰–åˆ†åï¼Œå­æ ‘æ˜¯ä¸€ä¸ªè¿ç»­çš„åŒºé—´ï¼Œæ ‘ä¸Šçš„è·¯å¾„ä¹Ÿå¯ä»¥è¢«åˆ’åˆ†æˆlogæ®µè¿ç»­åŒºé—´ã€‚ç„¶ååˆ©ç”¨æ•°æ®ç»“æ„å¯¹è¿™äº›è¿ç»­åŒºé—´è¿›è¡Œæ“ä½œå³å¯ã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™æ•°æ®ç»“æ„è¿™å—ä¸å¥½å†™ï¼Œæˆ–è€…å¸¸æ•°å¾ˆå¤§ï¼Œæ¯”å¦‚è¯´éœ€è¦$O(n\sqrt n \logn)$æ¥ç»´æŠ¤$10^5$ä¸ªèŠ‚ç‚¹çš„æ“ä½œï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹æ‰€æœ‰è¿ç»­æ®µforå¾ªç¯æš´åŠ›$O(n^2)$ç»´æŠ¤ï¼Œç„¶åæ³¨æ„è®¿é—®çš„è¿ç»­æ€§ï¼Œè¿™æ ·cacheçš„missç‡æ˜¯logçº§åˆ«çš„ï¼Œé€šè¿‡pragmaç­‰é¢„ç¼–è¯‘å‘½ä»¤åŠ é€Ÿä¼šæœ‰ä¸é”™çš„æ•ˆæœ</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;Ofast,no-stack-protector&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC target(<span class="string">&quot;sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,tune=native&quot;</span>)</span></span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•å¯ä»¥ç”¨äºæ ‘ä¸Šdpï¼Œå¦‚æœæ˜¯å­æ ‘dpçš„è¯ç›´æ¥åˆ©ç”¨dfsåºå³å¯å¦‚æœæ˜¯åˆ°æ ¹çš„æ ‘é“¾ä¸Šdpï¼Œé‚£å°±å…ˆæ ‘å‰–ï¼Œç„¶åå¯¹æ¯ä¸ªç‚¹æŠŠåˆ°æ ¹çš„è·¯å¾„åŒ–æˆlogä¸ªè¿ç»­æ®µï¼Œç„¶åæš´åŠ›æˆ‘ä»¬ç”¨ä¸€ä¸ªå±€éƒ¨å˜é‡å­˜å‚¨éœ€è¦æ›´æ–°çš„dp[u]ï¼Œç„¶åç”¨æ¥æ›´æ–°çš„dp[v]å°±æ˜¯è¿ç»­è®¿å­˜çš„ï¼Œå¯ä»¥è¾¾åˆ°ä¸€å®šçš„åŠ é€Ÿæ•ˆæœï¼Œç”¨æŒ‡é’ˆå¯ä»¥ç•¥å¾®åŠ é€Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">updt</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll cur = LLONG_MAX, a = dep[u], b = p[u];</span><br><span class="line">  <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    ll *p=tmpdep+dfn[top[x]]<span class="number">-1</span>, *q = dp+dfn[top[x]]<span class="number">-1</span>, *ped = tmpdep + dfn[x];</span><br><span class="line">    <span class="keyword">while</span>(p!=ped) <span class="built_in">chk</span>(cur, *(++q)+(a-*(++p)*b));</span><br><span class="line">    x = fa[<span class="number">0</span>][top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  ll *p=tmpdep+dfn[x]<span class="number">-1</span>, *ped = tmpdep+dfn[y], *q = dp+dfn[x] - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(p!=ped) <span class="built_in">chk</span>(cur, *(++q)+(a-*(++p)*b));</span><br><span class="line">  dp[dfn[u]] = cur + q[u];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•$10^5$æ¬¡çš„æ•°æ®çº§åˆ«2.5sèƒ½å‡ºç»“æœï¼Œè¿™åœ¨ä¸€äº›æ—¶é™æ¯”è¾ƒå®½æ¾ï¼Œæ­£è§£å¤æ‚åº¦è¦å¤šä¸ªlogæˆ–è€…æ ¹å·çš„æƒ…å†µä¸‹å¯èƒ½å¯ä»¥éª—è¿‡å»ï¼Œè€Œ$2\times 10^5$å°±æ˜¯10så·¦å³æ‰èƒ½å‡ºç»“æœäº†ã€‚</p><ul><li>ç‚¹åˆ†æ²»çš„æ—¶å€™æˆ‘ä»¬è¦å¤„ç†è·¨è¶Šé‡å¿ƒçš„å„éƒ¨åˆ†çš„è´¡çŒ®ï¼Œè¿™éœ€è¦åŒæŒ‡é’ˆæˆ–è€…ä¸€äº›æ•°æ®ç»“æ„æ¥ç»´æŠ¤ï¼ŒåŒæ ·çš„æˆ‘ä»¬æŠŠå®ƒä»¬æ˜ å°„åˆ°è¿ç»­çš„æ•°ç»„æ®µä¸Šï¼Œåœ¨è¿›è¡Œæš´åŠ›ä¹Ÿä¼šæœ‰ä¸€å®šåŠ é€Ÿ</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4072 [SDOI2016]å¾é€” æ¨å¼å­ æ–œç‡ä¼˜åŒ–dp</title>
      <link href="/2020/09/02/p4072-sdoi2016zheng-tu-tui-shi-zi-xie-lu-you-hua-dp/"/>
      <url>/2020/09/02/p4072-sdoi2016zheng-tu-tui-shi-zi-xie-lu-you-hua-dp/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šnæ®µè·¯çš„é•¿åº¦ï¼Œæ¯å¤©å¯ä»¥èµ°è¿ç»­çš„å‡ æ®µè·¯ï¼Œè¦æ±‚ä½ èµ°må¤©ï¼Œå¹¶æœ€å°åŒ–æ¯å¤©èµ°çš„è·¯ç¨‹é•¿åº¦çš„æ–¹å·®$\times m^2$çš„å¤§å°$n \leq 3000,m \leq 3000$</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>æ–¹å·®ï¼š$\frac{1}{m}\sum (x_i - \bar{x})^2m$ = $\frac{1}{m}(\sum x_i^2 + \sum \bar{x}^2 - 2\sum x_i\bar{x}) = \sum x_i$$\frac{1}{m}(\sum (x_i - \bar{x})^2) = m(\sum x_i^2 - \bar{x}\sum x_i)$ = $m\sum x_i^2 - (\sum x_i)^2$å®¹æ˜“å‘ç°åä¸€é¡¹æ˜¯å®šå€¼ï¼Œæ‰€ä»¥åªéœ€è¦æœ€å°åŒ–$\sum x_i^2$â€‹å³å¯$dp_{i,j}$â€‹è¡¨ç¤ºå‰iæ®µè·¯èµ°äº†jå¤©çš„æœ€å°æ–¹å·®$dp_{i,j} = \min \limits_{k&lt;i} \{dp_{k,j-1} + (sum_i-sum_k)^2\}$æ¯æ¬¡è¯¢é—®$sum_i$â€‹å¤„yçš„æœ€å°å€¼ï¼Œç„¶åæ’å…¥ä¸€æ¡æ–œç‡ä¸º$-2sum_i$â€‹ï¼Œæˆªè·ä¸º$sum_i^2 + dp_{i,j-1}$â€‹çš„ç›´çº¿ã€‚æ–œç‡å•è°ƒé€’å‡ï¼Œè¯¢é—®å•è°ƒé€’å¢ï¼ŒåŒç«¯é˜Ÿåˆ—ç»´æŠ¤ä¸‹å‡¸å£³å³å¯é€šè¿‡æ–œç‡ä¼˜åŒ–å°±å¯ä»¥$n^2$é€šè¿‡æœ¬é¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="type">long</span> <span class="type">double</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, d[N];</span><br><span class="line">ll sum[N], dp[N][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line">  ll k, b;</span><br><span class="line">  <span class="function">ll <span class="title">eval</span><span class="params">(ll x)</span> </span>&#123; <span class="keyword">return</span> k*x + b; &#125;</span><br><span class="line">  <span class="function">db <span class="title">insect</span><span class="params">(Line oth)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">db</span>(b-oth.b)/(oth.k-k); &#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="type">int</span> ql, qr;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, d+i), sum[i] = sum[i<span class="number">-1</span>] + d[i], dp[i][<span class="number">0</span>] = sum[i]*sum[i];</span><br><span class="line">  <span class="type">int</span> p = <span class="number">1</span>;</span><br><span class="line">  ll ans = dp[n][<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> c=<span class="number">2</span>; c&lt;=m; c++, p^=<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    q[ql=qr=<span class="number">1</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span>(ql&lt;qr &amp;&amp; q[ql].<span class="built_in">insect</span>(q[ql+<span class="number">1</span>])&lt;=sum[i]) ++ql;</span><br><span class="line">      dp[i][p] = q[ql].<span class="built_in">eval</span>(sum[i]) + sum[i]*sum[i];</span><br><span class="line">      Line cur = &#123;<span class="number">-2</span>*sum[i], sum[i]*sum[i]+dp[i][p^<span class="number">1</span>]&#125;;</span><br><span class="line">      <span class="keyword">while</span>(ql&lt;qr &amp;&amp; cur.<span class="built_in">insect</span>(q[qr])&lt;=cur.<span class="built_in">insect</span>(q[qr<span class="number">-1</span>])) --qr;</span><br><span class="line">      q[++qr] = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="built_in">min</span>(ans, dp[n][p]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, m*ans-sum[n]*sum[n]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4655 [CEOI2017]Building Bridges æ–œç‡ä¼˜åŒ–</title>
      <link href="/2020/09/02/p4655-ceoi2017building-bridges-xie-lu-you-hua/"/>
      <url>/2020/09/02/p4655-ceoi2017building-bridges-xie-lu-you-hua/</url>
      
        <content type="html"><![CDATA[<p>æœ‰næ ¹æŸ±å­ï¼Œç¬¬iæ ¹æŸ±å­çš„é«˜åº¦ä¸º$h_i$â€‹ï¼Œè¢«æ‹†é™¤çš„ä»£ä»·ä¸º$w_i$â€‹ï¼Œåœ¨jå’Œiä¸¤æ ¹æŸ±å­é—´æ¶æ¡¥çš„è´¹ç”¨ä¸º$(h_i-h_j)^2 + \sum \limits_{k=j+1}^{i-1} w_k$â€‹ï¼Œé—®è¿æ¥1å’Œnçš„æœ€å°ä»£ä»·</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>$dp_i = \min \limits_{j&lt;i} \{dp_j + (h_i-h_j)^2 + s_{i-1} - s_j\}$ æ­¤å¤„sä¸ºwçš„å‰ç¼€å’Œæ˜¾ç„¶å¯ä»¥åŒ–ä¸ºæ–œç‡ä¼˜åŒ–çš„å½¢å¼æ¯æ¬¡è¯¢é—®$h_i$â€‹å¤„yçš„æœ€å°å€¼ï¼Œç„¶åæ’å…¥ä¸€æ¡æ–œç‡ä¸º$-2h_i$â€‹ï¼Œæˆªè·ä¸º$h_i^2-s_i+dp_i$â€‹çš„ç›´çº¿ã€‚ç”±äºè¿™é‡Œçš„$h_i$â€‹ä¸å…·å¤‡å•è°ƒæ€§ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨é˜Ÿåˆ—æ¥ç»´æŠ¤ã€‚å¯ä»¥ç”¨å¹³è¡¡æ ‘ã€æè¶…æ ‘æˆ–è€…cdqåˆ†æ²»è§£å†³</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, h[N];</span><br><span class="line">ll w[N], dp[N];</span><br><span class="line"><span class="type">bool</span> Cmp;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">mutable</span> ll k, b, p;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Line&amp; oth) <span class="type">const</span> &#123; <span class="keyword">return</span> Cmp ? p &lt; oth.p : k &lt; oth.k; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ConvecHull</span> : multiset&lt;Line&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> ll inf = LLONG_MAX;</span><br><span class="line">  <span class="function">ll <span class="title">div</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) <span class="keyword">return</span> a&gt;<span class="number">0</span> ? inf : -inf;</span><br><span class="line">    <span class="keyword">return</span> a / b - ((a ^ b) &lt; <span class="number">0</span> &amp;&amp; a % b);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">isect</span><span class="params">(iterator x, iterator y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (y == <span class="built_in">end</span>()) &#123; x-&gt;p = inf; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (x-&gt;k == y-&gt;k) x-&gt;p = x-&gt;b &gt; y-&gt;b ? inf : -inf;</span><br><span class="line">    <span class="keyword">else</span> x-&gt;p = <span class="built_in">div</span>((y-&gt;b - x-&gt;b), (x-&gt;k - y-&gt;k));</span><br><span class="line">    <span class="keyword">return</span> x-&gt;p &gt;= y-&gt;p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(ll k, ll b)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> z = <span class="built_in">insert</span>(&#123;k, b, <span class="number">0</span>&#125;), y = z++, x = y;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isect</span>(y, z)) z = <span class="built_in">erase</span>(z);</span><br><span class="line">    <span class="keyword">if</span> (x != <span class="built_in">begin</span>() &amp;&amp; <span class="built_in">isect</span>(--x, y)) <span class="built_in">isect</span>(x, y = <span class="built_in">erase</span>(y));</span><br><span class="line">    <span class="keyword">while</span> ((y = x) != <span class="built_in">begin</span>() &amp;&amp; (--x)-&gt;p &gt;= y-&gt;p) <span class="built_in">isect</span>(x, <span class="built_in">erase</span>(y));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">ll <span class="title">qry</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    Cmp = <span class="number">1</span>; <span class="keyword">auto</span> l = *<span class="built_in">lower_bound</span>(&#123;<span class="number">0</span>, <span class="number">0</span>, x&#125;); Cmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> l.k * x + l.b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;ch;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, h+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, w+i), w[i] += w[i<span class="number">-1</span>];</span><br><span class="line">  ch.<span class="built_in">add</span>(<span class="number">2</span>*h[<span class="number">1</span>], <span class="number">-1ll</span>*h[<span class="number">1</span>]*h[<span class="number">1</span>]+w[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    dp[i] = -ch.<span class="built_in">qry</span>(h[i]) + w[i<span class="number">-1</span>] + <span class="number">1ll</span>*h[i]*h[i];</span><br><span class="line">    ch.<span class="built_in">add</span>(<span class="number">2</span>*h[i], <span class="number">-1ll</span>*h[i]*h[i]+w[i]-dp[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, dp[n]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codeforces1396C</title>
      <link href="/2020/08/31/codeforces1396c/"/>
      <url>/2020/08/31/codeforces1396c/</url>
      
        <content type="html"><![CDATA[<p>æœ‰nä¸ªå…³å¡ï¼Œæ¯å…³æœ‰$a_i$â€‹ä¸ªå°æ€ª(1hp)å’Œ1ä¸ªboss(2hp)ï¼Œåœ¨ç¬¬iå…³å¯ä»¥è½¬ç§»åˆ°i-1å’Œi+1å…³ï¼Œéœ€è¦èŠ±è´¹dï¼Œæœ‰ä¸‰ç§æ­¦å™¨</p><ul><li>èŠ±è´¹r1ï¼Œè®©ä¸€åªæ€ªç‰©-1hp</li><li>èŠ±è´¹r2ï¼Œè®©æ‰€æœ‰æ€ªç‰©-1hp</li><li>èŠ±è´¹r3ï¼Œç§’æ€ä¸€åªæ€ªç‰©</li></ul><p>å…¶ä¸­ç¬¬ä¸€å’Œç¬¬ä¸‰ç§æ­¦å™¨å¿…é¡»åœ¨æ²¡æœ‰å°æ€ªçš„æƒ…å†µä¸‹æ‰èƒ½æ”»å‡»bossï¼Œå¹¶ä¸”å¦‚æœæ²¡æœ‰ç§’æ‰bossï¼ˆè¿˜å‰©1æ»´è¡€ï¼‰ï¼Œåˆ™ä¼šè¢«å¼ºåˆ¶è½¬ç§»åˆ°ç›¸é‚»çš„å…³å¡ï¼ˆèŠ±è´¹dï¼‰ï¼Œé—®ä½ æ€æ­»æ‰€æœ‰æ€ªç‰©çš„æœ€å°èŠ±è´¹$n \leq 10^6,1\leq r1 \leq r2 \leq r3 \leq 10^9$</p><h3 id="è§£æ³•"><a class="header-anchor" href="#è§£æ³•">Â¶</a>è§£æ³•</h3><p>åœ¨æŸä¸€å…³ä¸­æˆ‘ä»¬è¦ä¹ˆç”¨r3ç›´æ¥ç§’æ‰bossé¿å…å¼ºåˆ¶è½¬ç§»(å…ˆç”¨r1æ¸…å°æ€ª)ï¼Œè¦ä¹ˆå°±å…ˆè®©bosså°‘ä¸€æ»´è¡€(ç”¨r1æ¸…å°æ€ªå†ç‚¹ä¸€ä¸‹bossæˆ–è€…ä¸€ä¸‹r2)è½¬ç§»èµ°ï¼Œä¹‹åå†å›æ¥ç”¨ä¸€ä¸‹r1ç‚¹æ­»bossã€‚æ‰€ä»¥æ¯å…³å…¶å®åªæœ‰ä¸¤ç§é€‰æ‹©ï¼Œä¸€æ˜¯ç”¨r1æ€æ‰å°æ€ªåç”¨r3ç§’æ‰boss(cost1=a[i]*r1+r3)ï¼ŒäºŒæ˜¯ç”¨r2æˆ–è€…(a[i]*r1+r1)è®©bosså‰©1hpç„¶åå¼ºåˆ¶è½¬ç§»èµ°å›æ¥åå†èŠ±r1æ€æ­»boss(cost2=min(a[i]*r1+r1,r2))ï¼Œç„¶åå°±å¯ä»¥dpäº†$dp_{i,0}$â€‹è¡¨ç¤ºç¬¬iå…³å·²ç»è§£å†³çš„æœ€å°è´¹ç”¨ï¼Œ$dp_{i,1}$â€‹è¡¨ç¤ºç¬¬iå…³çš„bossè¿˜å‰©1hpç„¶åè¿˜æ²¡å¼ºåˆ¶è·³è½¬çš„æœ€å°è´¹ç”¨$dp_{0,0}=min(dp_{i-1,0}+d+min(cost1,2*d+cost2+r1),dp_{i-1,1}+3*d+r1+min(cost1,cost2+r1))$å¦‚æœä¸Šä¸€å…³å·²ç»æ¶ˆç­($dp_{i-1,0}$â€‹)ï¼Œè¿™ä¸€å…³è¦ä¹ˆå°±cost1ï¼Œè¦ä¹ˆå°±cost2ç„¶åæ¥å›è·³ä¸¤ä¸ªdï¼Œå†ä¸€ä¸ªr1è¡¥æ­»å¦‚æœä¸Šä¸€å…³è¿˜æœ‰1hpï¼Œé‚£ä¹ˆè¿™å…³æ¶ˆç­åå†å›å»è¡¥æ­»ä¸Šä¸€å…³å†å›æ¥$dp_{i,1} = dp_{i-1,0}+d+cost2$è¿˜æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µå°±æ˜¯åœ¨å€’æ•°ç¬¬äºŒå…³å¼ºåˆ¶è½¬ç§»åˆ°æœ€åä¸€å…³ï¼Œç„¶åæ¶ˆç­æœ€åä¸€å…³å†è½¬ç§»åˆ°å€’æ•°ç¬¬äºŒå…³è¡¥æ­»ä¹‹åç»“æŸã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a[N];</span><br><span class="line">ll r1, r2, r3, d, dp[N][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%lld%lld%lld%lld&quot;</span>, &amp;n, &amp;r1, &amp;r2, &amp;r3, &amp;d);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">  dp[<span class="number">0</span>][<span class="number">0</span>] = -d;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    ll c1 = <span class="built_in">min</span>(a[i]*r1+r1, r2), c2 = a[i]*r1 + r3;</span><br><span class="line">    dp[i][<span class="number">0</span>] = <span class="built_in">min</span>(dp[i<span class="number">-1</span>][<span class="number">0</span>]+d+<span class="built_in">min</span>(c2, <span class="number">2</span>*d+c1+r1), dp[i<span class="number">-1</span>][<span class="number">1</span>]+<span class="number">3</span>*d+r1+<span class="built_in">min</span>(r1+c1, c2));</span><br><span class="line">    dp[i][<span class="number">1</span>] = dp[i<span class="number">-1</span>][<span class="number">0</span>]+d+c1;</span><br><span class="line">  &#125;</span><br><span class="line">  ll ans = <span class="built_in">min</span>(dp[n][<span class="number">0</span>], dp[n<span class="number">-2</span>][<span class="number">0</span>]+d+a[n]*r1+r3+r1+<span class="number">2</span>*d+<span class="built_in">min</span>(a[n<span class="number">-1</span>]*r1+r1, r2));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‡¸åŒ…</title>
      <link href="/2020/08/30/convex-hull-trick/"/>
      <url>/2020/08/30/convex-hull-trick/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¡ç®—å‡ ä½•ä¸­çš„å‡¸åŒ…"><a class="header-anchor" href="#è®¡ç®—å‡ ä½•ä¸­çš„å‡¸åŒ…">Â¶</a>è®¡ç®—å‡ ä½•ä¸­çš„å‡¸åŒ…</h2><p>ç»™å®šnä¸ªç‚¹æ±‚å‡¸åŒ…åˆ©ç”¨andrewç®—æ³•ï¼ˆæ¯”grahamå¥½å†™ä¸€ç‚¹è€Œä¸”å¸¸æ•°å°ï¼‰å°†æ‰€æœ‰ç‚¹æŒ‰ç…§xä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œyä¸ºç¬¬äºŒå…³é”®å­—æ’åºç„¶åä»å‰å¾€åç”¨æ ˆç»´æŠ¤å‡ºä¸‹å‡¸å£³ï¼Œå†ä»åå¾€å‰ç”¨æ ˆç»´æŠ¤å‡ºä¸Šå‡¸å£³å³å¯è€ƒè™‘å½“å‰æ ˆä¸­çš„æœ€åä¸¤ä¸ªç‚¹pï¼Œqï¼Œç°åœ¨åŠ å…¥ä¸€ä¸ªç‚¹oï¼Œé‚£ä¹ˆåªè¦çœ‹q-på’Œo-pè¿™ä¸¤æ¡ç›´çº¿çš„å·¦å³å…³ç³»å³å¯ï¼Œç”¨å‰ç§¯åˆ¤æ–­å¤šè¾¹å½¢ç”¨vectorå­˜å‚¨ï¼Œå‡¸åŒ…åˆ†ä¸ºä¸¥æ ¼å‡¸åŒ…å’Œéä¸¥æ ¼å‡¸åŒ…ï¼ˆä¸€èˆ¬éƒ½æ˜¯å»ºæˆä¸¥æ ¼çš„ï¼‰ï¼ŒåŒºåˆ«å°±æ˜¯å¦‚æœå‰ç§¯ç­‰äº0çš„æ—¶å€™ä¸å†popï¼Œé‚£ä¹ˆå°±æ˜¯éä¸¥æ ¼çš„ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¤šç‚¹å…±çº¿çš„æƒ…å†µå¦å¤–è¦æ³¨æ„å¤šè¾¹å½¢ç‚¹æ•°å°‘äº3çš„æƒ…å†µ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Polygon <span class="title">ConvexHull</span><span class="params">(Polygon&amp; s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n = s.<span class="built_in">size</span>(), sz = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">sort</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>());</span><br><span class="line">  <span class="function">Polygon <span class="title">res</span><span class="params">(<span class="number">2</span>*n)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(sz&gt;<span class="number">0</span> &amp;&amp; <span class="built_in">crossop</span>(res[sz<span class="number">-1</span>], res[sz], s[i])&lt;=<span class="number">0</span>) --sz;</span><br><span class="line">    res[++sz] = s[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> pre = sz;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-2</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(sz&gt;pre &amp;&amp; <span class="built_in">crossop</span>(res[sz<span class="number">-1</span>], res[sz], s[i])&lt;=<span class="number">0</span>) --sz;</span><br><span class="line">    res[++sz] = s[i];</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="built_in">resize</span>(sz);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤šè¾¹å½¢é¢ç§¯(ç›¸é‚»ç‚¹å‰ç§¯æ±‚å’Œï¼Œé€†æ—¶é’ˆä¸ºæ­£ï¼Œé¡ºæ—¶é’ˆä¸ºè´Ÿ)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">getarea</span><span class="params">(Polygon&amp; s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  db ans = <span class="number">0</span>; <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) ans += (s[i]^s[(i+<span class="number">1</span>)%n]);</span><br><span class="line">  <span class="keyword">return</span> ans/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡¸åŒ…å‘¨é•¿(ç›¸é‚»ç‚¹è·ç¦»æ±‚å’Œå³å¯)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">getcir</span><span class="params">(Polygon&amp; s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">db ans = <span class="number">0</span>; <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) ans += s[i].<span class="built_in">dis</span>(s[(i+<span class="number">1</span>)%n]);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡¸åŒ…ç›´å¾„(æ—‹è½¬å¡å£³ï¼Œå¯¹äºæ¯æ¡è¾¹(i,i+1)ï¼Œæ‰¾åˆ°è·ç¦»è¿™æ¡è¾¹æœ€è¿œçš„ç‚¹jï¼Œå®¹æ˜“å‘ç°å…·æœ‰å•è°ƒæ€§ï¼Œå¯ä»¥ç”¨åŒæŒ‡é’ˆå®ç°)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">ConvexDiameter</span><span class="params">(Polygon&amp; s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">if</span>(n==<span class="number">2</span>) <span class="keyword">return</span> s[<span class="number">0</span>].<span class="built_in">dis</span>(s[<span class="number">1</span>]);</span><br><span class="line">  <span class="type">int</span> j = <span class="number">2</span>; db ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cross</span>(s[i], s[i+<span class="number">1</span>], s[j])&lt;<span class="built_in">cross</span>(s[i], s[i+<span class="number">1</span>], s[(j+<span class="number">1</span>)%n])) j = (j+<span class="number">1</span>)%n;</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, <span class="built_in">max</span>(s[i].<span class="built_in">dis</span>(s[j]), s[i+<span class="number">1</span>].<span class="built_in">dis</span>(s[j])));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡¸åŒ…çš„é—µå¯å¤«æ–¯åŸºå’Œè¿˜æ˜¯å‡¸åŒ…(å®šä¹‰å°±æ˜¯ä¸€ä¸ªå‡¸åŒ…ä¸­çš„ç‚¹æŒ‰ç…§åŸç‚¹å’Œå¦ä¸€ä¸ªå‡¸åŒ…ä¸­çš„ç‚¹å½¢æˆçš„å‘é‡ç§»åŠ¨åå½¢æˆçš„å›¾å½¢)é—µå¯å¤«æ–¯åŸºå’Œåçš„å‡¸åŒ…çš„è¾¹æ˜¯ç”±åŸæ¥çš„ä¸¤ä¸ªå‡¸åŒ…ä¸Šçš„è¾¹æ„æˆçš„ï¼Œæ‰€ä»¥å½’å¹¶æ’åºä¸€ä¸‹å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Polygon <span class="title">Minkowski</span><span class="params">(Polygon&amp; a, Polygon&amp; b)</span> <span class="comment">//å¯èƒ½æœ‰ä¸‰ç‚¹å…±çº¿ï¼Œå¯ä»¥å†æ±‚ä¸€æ¬¡å‡¸åŒ…</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Polygon c;</span><br><span class="line">  <span class="type">int</span> n = a.<span class="built_in">size</span>(), m = b.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, j=<span class="number">0</span>; i&lt;n||j&lt;m; )</span><br><span class="line">  &#123;</span><br><span class="line">    c.<span class="built_in">push_back</span>(a[i%n]+b[j%m]);</span><br><span class="line">    <span class="keyword">if</span>(i&gt;=n) ++j;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(j&gt;=m) ++i;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">sgn</span>((a[(i+<span class="number">1</span>)%n]-a[i])^(b[(j+<span class="number">1</span>)%m]-b[j]))&gt;=<span class="number">0</span>) ++i;</span><br><span class="line">    <span class="keyword">else</span> ++j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’ä¸­çš„å‡¸åŒ…"><a class="header-anchor" href="#åŠ¨æ€è§„åˆ’ä¸­çš„å‡¸åŒ…">Â¶</a>åŠ¨æ€è§„åˆ’ä¸­çš„å‡¸åŒ…</h2><p>ä¸€èˆ¬ç”¨äºæ–œç‡ä¼˜åŒ–ï¼Œè€ƒè™‘ä¸€ä¸ªdpè½¬ç§»å¼$f_i = \max \limits_{k&lt;i} \{ f_k + a_ib_k\}$å¯ä»¥æŠŠåé¢çš„ä¸œè¥¿çœ‹æˆ$b_ka_i + f_k$â€‹ï¼Œå³$kx+b$çš„ç›´çº¿å½¢å¼ï¼Œç„¶åæˆ‘ä»¬å°±æ˜¯è¦å¯¹æ¯ä¸ª$a_i$â€‹æ‰¾åˆ°ä¹‹å‰æ‰€æœ‰ç›´çº¿ä¸­åœ¨è¯¥ç‚¹å¤„çš„æœ€å¤§å€¼(åˆ«äººçš„æ–œç‡ä¼˜åŒ–å¯èƒ½æ˜¯æŒ‰ç…§æ–œç‡çš„ï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿™æ ·å­æ›´ç›´è§‚ä¸€ç‚¹ï¼Œä¹Ÿä¸éœ€è¦ç§»é¡¹ï¼Œå¦‚æœäº†è§£æè¶…æ ‘ï¼Œå¾ˆå®¹æ˜“å‘ç°è¿™å®Œå…¨å¯ä»¥ç”¨æè¶…æ ‘æ¥åš)å½“ç„¶ç”¨æè¶…æ ‘æ¥åšä¼¼ä¹æœ‰ç‚¹å¤§æå°ç”¨ï¼Œå®¹æ˜“å‘ç°ç­”æ¡ˆä¸€å®šæ˜¯åœ¨æ‰€æœ‰ç›´çº¿å½¢æˆçš„ä¸Šå‡¸å£³ä¸Šï¼Œè€Œä¸”æ¯æ¡ç›´çº¿ä¼šæœ‰ä¸€ä¸ªè´¡çŒ®èŒƒå›´</p><ul><li><p>å¦‚æœæ’å…¥çš„ç›´çº¿æ–œç‡å•è°ƒ($b_k$â€‹)ï¼Œä¸”è¯¢é—®ç‚¹ä¹Ÿå•è°ƒ($a_i$â€‹)è¿™æ—¶å€™æˆ‘ä»¬åªéœ€è¦ç”¨åŒç«¯é˜Ÿåˆ—æ¥ç»´æŠ¤ä¸Šå‡¸å£³å³å¯ï¼Œåœ¨é˜Ÿå°¾ä¸æ–­æ’å…¥ç›´çº¿å¹¶ä¸”ç»´æŠ¤å‡¸å£³ï¼Œåœ¨é˜Ÿé¦–åŠæ—¶æ’æ‰å·²ç»ç»“æŸè´¡çŒ®äº†çš„ç‚¹ï¼Œå¯¹äºå½“å‰è¯¢é—®çš„æœ€ä¼˜ç‚¹å°±æ˜¯é˜Ÿé¦–</p></li><li><p>å¦‚æœæ’å…¥çš„ç›´çº¿æ–œç‡å•è°ƒ($b_k$â€‹)ï¼Œä½†è¯¢é—®ç‚¹ä¸å•è°ƒ($a_i$â€‹)æ–œç‡å•è°ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ä»ç„¶å¯ä»¥çº¿æ€§åœ°ç»´æŠ¤ä¸Šå‡¸å£³ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½pop_frontæ¥ç»´æŠ¤æœ€ä¼˜ç‚¹ï¼Œå› ä¸ºæœ€ä¼˜ç‚¹æ²¡æœ‰å•è°ƒæ€§äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å‡¸å£³ä¸ŠäºŒåˆ†ï¼Œæ‰¾åˆ°æœ€ä¼˜å†³ç­–ç‚¹</p></li><li><p>å¦‚æœæ’å…¥çš„ç›´çº¿æ–œç‡ä¸å•è°ƒ($b_k$â€‹)ï¼Œä¸”è¯¢é—®ç‚¹ä¹Ÿä¸å•è°ƒ($a_i$â€‹)ä¸€ç§æ–¹æ³•å°±æ˜¯æè¶…æ ‘äº†ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨å¹³è¡¡æ ‘æ¥ç»´æŠ¤ï¼Œä»¥ä¸‹ç»™å‡ºä¸€ä»½setå®ç°çš„ä»£ç ï¼ˆå¾ˆå¥½ç”¨ï¼Œå¦‚æœæ’å…¥çš„æ˜¯ç›´çº¿å°±ç”¨è¿™ä¸ªï¼Œå¦‚æœæ˜¯çº¿æ®µçš„è¯å°±åªèƒ½æè¶…æ ‘äº†ï¼‰kå’Œbåˆ†åˆ«æ˜¯æ–œç‡å’Œæˆªè·ï¼Œpç±»ä¼¼äºæœ€ä¼˜å†³ç­–ç‚¹ï¼ˆä¸ç”¨ç®¡ï¼‰divå‡½æ•°æ˜¯ä¸€ä¸ªä¸‹å–æ•´å‡½æ•°ï¼Œè´Ÿæ•°çš„æ—¶å€™çš„å–æ•´å’Œæ­£æ•°ä¼šæœ‰åŒºåˆ«isectæ˜¯æ±‚ä¸¤æ¡ç›´çº¿çš„äº¤ç‚¹ï¼Œç„¶åè¿›è¡Œåˆ¤æ–­ï¼ˆç±»ä¼¼äºæè¶…æ ‘ä¸­çš„åˆ¤æ–­ï¼‰ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦add(k,b)æ¥æ·»åŠ ä¸€æ¡ç›´çº¿ï¼Œqry(x)æ¥è¯¢é—®åœ¨xç‚¹å¤„çš„æœ€å¤§å€¼å½“ç„¶å¦‚æœè¦æ±‚æœ€å°å€¼ï¼Œåªéœ€è¦add(-k,-b)ï¼Œç„¶å-qry(x)å°±æ˜¯ç­”æ¡ˆäº†</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> Cmp;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">mutable</span> ll k, b, p;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Line&amp; oth) <span class="type">const</span> &#123; <span class="keyword">return</span> Cmp ? p &lt; oth.p : k &lt; oth.k; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ConvecHull</span> : multiset&lt;Line&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> ll inf = LLONG_MAX;</span><br><span class="line">  <span class="function">ll <span class="title">div</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) <span class="keyword">return</span> a&gt;<span class="number">0</span> ? inf : -inf;</span><br><span class="line">    <span class="keyword">return</span> a / b - ((a ^ b) &lt; <span class="number">0</span> &amp;&amp; a % b);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">isect</span><span class="params">(iterator x, iterator y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (y == <span class="built_in">end</span>()) &#123; x-&gt;p = inf; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (x-&gt;k == y-&gt;k) x-&gt;p = x-&gt;b &gt; y-&gt;b ? inf : -inf;</span><br><span class="line">    <span class="keyword">else</span> x-&gt;p = <span class="built_in">div</span>((y-&gt;b - x-&gt;b), (x-&gt;k - y-&gt;k));</span><br><span class="line">    <span class="keyword">return</span> x-&gt;p &gt;= y-&gt;p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(ll k, ll b)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> z = <span class="built_in">insert</span>(&#123;k, b, <span class="number">0</span>&#125;), y = z++, x = y;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isect</span>(y, z)) z = <span class="built_in">erase</span>(z);</span><br><span class="line">    <span class="keyword">if</span> (x != <span class="built_in">begin</span>() &amp;&amp; <span class="built_in">isect</span>(--x, y)) <span class="built_in">isect</span>(x, y = <span class="built_in">erase</span>(y));</span><br><span class="line">    <span class="keyword">while</span> ((y = x) != <span class="built_in">begin</span>() &amp;&amp; (--x)-&gt;p &gt;= y-&gt;p) <span class="built_in">isect</span>(x, <span class="built_in">erase</span>(y));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">ll <span class="title">qry</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    Cmp = <span class="number">1</span>; <span class="keyword">auto</span> l = *<span class="built_in">lower_bound</span>(&#123;<span class="number">0</span>, <span class="number">0</span>, x&#125;); Cmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> l.k * x + l.b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¦‚ä½•åˆ é™¤ä¸€æ¡ç›´çº¿"><a class="header-anchor" href="#å¦‚ä½•åˆ é™¤ä¸€æ¡ç›´çº¿">Â¶</a>å¦‚ä½•åˆ é™¤ä¸€æ¡ç›´çº¿</h3><p>åˆ é™¤æ“ä½œä¸å¥½åšï¼ˆç±»ä¼¼å¹¶æŸ¥é›†ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç¦»çº¿åæŠŠæ¯æ¡ç›´çº¿çš„å­˜æ´»æ—¶é—´å¡åˆ°çº¿æ®µæ ‘ä¸Šçš„logä¸ªèŠ‚ç‚¹ä¸Šï¼ˆå³çº¿æ®µæ ‘åˆ†æ²»ï¼‰ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªå‡¸å£³ï¼Œç„¶åå¯¹äºä¸€ä¸ªè¯¢é—®å°±æ˜¯çº¿æ®µæ ‘ä¸ŠåŒ…å«è¯¥ç‚¹çš„èŠ‚ç‚¹çš„å‡¸å£³ä¸Šçš„æœ€å¤§å€¼çš„æœ€å¤§å€¼ç»™å‡ºæ‰€æœ‰ç›´çº¿å†å»ºå‡¸å£³ï¼Œå¯ä»¥åˆ©ç”¨andrewæ¥å®ç°ï¼ˆæ’åºåï¼Œä»å‰å¾€åç”¨æ ˆç»´æŠ¤ï¼‰ï¼Œè¯¢é—®æœ€å€¼ä¸€æ¬¡äºŒåˆ†å³å¯ï¼ˆæ²¡å¿…è¦ä¸‰åˆ†ï¼‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gym101482G è·ç¦»è½¬åŒ– ä¸‰åˆ† æ€ç»´</title>
      <link href="/2020/08/29/gym101482g-ju-chi-zhuan-hua-san-fen-si-wei/"/>
      <url>/2020/08/29/gym101482g-ju-chi-zhuan-hua-san-fen-si-wei/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šäºŒç»´å¹³é¢ä¸Šnä¸ªç‚¹çš„åæ ‡ï¼Œè®©ä½ æ‰¾ä¸€ä¸ªç‚¹ï¼Œæœ€å°åŒ–æ‰€æœ‰ç‚¹åˆ°è¿™ä¸ªç‚¹çš„æ›¼å“ˆé¡¿è·ç¦»ä¹‹å’Œï¼Œå¹¶ä¸”è¦æ±‚æ¯ä¸ªç‚¹åˆ°è¯¥ç‚¹çš„æ›¼å“ˆé¡¿è·ç¦»ä¸èƒ½è¶…è¿‡d$n \leq 100000,d \leq 2\times 10^9$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å¦‚æœæ²¡æœ‰dçš„é™åˆ¶ï¼Œç­”æ¡ˆå°±æ˜¯è¿™nä¸ªç‚¹xåæ ‡çš„ä¸­ä½æ•°å’Œyåæ ‡çš„ä¸­ä½æ•°ã€‚åŠ ä¸Šdçš„é™åˆ¶åï¼Œå¯¹äºæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªè±å½¢çš„é™åˆ¶åŒºåŸŸï¼Œæ‰€ä»¥æœ€åçš„å¯è¡ŒåŸŸå°±æ˜¯è¿™nä¸ªç‚¹é™åˆ¶çš„è±å½¢åŒºåŸŸçš„å¹¶ï¼Œè±å½¢ä¸å¥½å¤„ç†ï¼Œæˆ‘ä»¬è½¬åŒ–æˆåˆ‡æ¯”é›ªå¤«è·ç¦»åå°±å˜æˆäº†æ­£æ–¹å½¢ï¼Œç»´æŠ¤Lï¼ŒRï¼ŒDï¼ŒUï¼Œé‚£ä¹ˆä¸¤ä¸ªæ­£æ–¹å½¢çš„å¹¶å°±æ˜¯max(L)ï¼ŒminÂ®ï¼Œmax(D)ï¼Œmin(U)ã€‚æ›¼å“ˆé¡¿è·ç¦»ä¸­xã€yä¸¤ç»´æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œæ¯ä¸€ç»´åˆæ˜¯ä¸€ä¸ªå‡¹å‡½æ•°ï¼Œæ‰€ä»¥åœ¨å¯è¡ŒåŸŸèŒƒå›´å†…ä¸‰åˆ†å¥—ä¸‰åˆ†å³å¯ã€‚ç»™å®šä¸€ä¸ªç‚¹çš„åæ ‡ï¼Œè®¡ç®—nä¸ªç‚¹åˆ°è¿™ä¸ªç‚¹çš„æ›¼å“ˆé¡¿è·ç¦»å’Œå¯ä»¥é€šè¿‡äºŒåˆ†$O(\log n)$è§£å†³ã€‚(x,y) -&gt; (x+y,x-y) åŸåæ ‡ç³»çš„æ›¼å“ˆé¡¿è·ç¦»-&gt;æ–°åæ ‡ç³»çš„åˆ‡æ¯”é›ªå¤«è·ç¦»(x,y) -&gt; ((x+y)/2,(x-y)/2) åŸåæ ‡ç³»çš„åˆ‡æ¯”é›ªå¤«è·ç¦»-&gt;æ–°åæ ‡ç³»çš„æ›¼å“ˆé¡¿è·ç¦»æˆ‘ä»¬ç»´æŠ¤çš„LRDUæ˜¯åœ¨åˆ‡æ¯”é›ªå¤«åæ ‡ç³»ä¸­ï¼Œè€Œä¸‰åˆ†çš„èŒƒå›´æ˜¯åœ¨æ›¼å“ˆé¡¿åæ ‡ä¸­çš„ï¼Œæ‰€ä»¥xçš„ä¸‰åˆ†èŒƒå›´åº”è¯¥æ˜¯[(L+D)/2,(R+U)/2]ï¼Œç¡®å®šäº†xåï¼Œ$L\leqx+y \leq R,D\leq x-y \leq U$ï¼Œé‚£ä¹ˆyçš„ä¸‰åˆ†èŒƒå›´å°±æ˜¯[max(L-x,x-U),min(R-x,x-D)]äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, x[N], y[N], d;</span><br><span class="line">ll U, D, L, R, prex[N], prey[N];</span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = <span class="built_in">upper_bound</span>(x+<span class="number">1</span>, x+n+<span class="number">1</span>, a) - x - <span class="number">1</span>, q = <span class="built_in">upper_bound</span>(y+<span class="number">1</span>, y+n+<span class="number">1</span>, b) - y - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> a*p - prex[p] + b*q - prey[q] - (n-p)*a + (prex[n] - prex[p]) - (n-q)*b + (prey[n] - prey[q]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">cal</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll l = <span class="built_in">max</span>(x-U, L-x), r = <span class="built_in">min</span>(x-D, R-x), ans = LINF;</span><br><span class="line">  <span class="keyword">while</span>(l&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    ll mid = (<span class="number">2</span>*l+r)/<span class="number">3</span>, mmid = (<span class="number">2</span>*r+l+<span class="number">2</span>)/<span class="number">3</span>;</span><br><span class="line">    ll fmid = <span class="built_in">f</span>(x, mid), fmmid = <span class="built_in">f</span>(x, mmid);</span><br><span class="line">    <span class="keyword">if</span>(fmid&lt;=fmmid)</span><br><span class="line">    &#123;</span><br><span class="line">      ans = <span class="built_in">min</span>(ans, fmid);</span><br><span class="line">      r = mmid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ans = <span class="built_in">min</span>(ans, fmmid);</span><br><span class="line">      l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, x+i, y+i);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;d);</span><br><span class="line">    U = LINF, D = -LINF, L = -LINF, R = LINF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      ll cx = x[i] + y[i], cy = x[i] - y[i];</span><br><span class="line">      U = <span class="built_in">min</span>(U, cy+d);</span><br><span class="line">      D = <span class="built_in">max</span>(D, cy-d);</span><br><span class="line">      L = <span class="built_in">max</span>(L, cx-d);</span><br><span class="line">      R = <span class="built_in">min</span>(R, cx+d);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(D&gt;U||L&gt;R)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;impossible&quot;</span>);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(x+<span class="number">1</span>, x+n+<span class="number">1</span>); <span class="built_in">sort</span>(y+<span class="number">1</span>, y+n+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) prex[i] = prex[i<span class="number">-1</span>] + x[i], prey[i] = prey[i<span class="number">-1</span>] + y[i];</span><br><span class="line">    ll l = (L+D)/<span class="number">2</span>, r = (R+U)/<span class="number">2</span>, ans = LINF;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;=r)</span><br><span class="line">    &#123;</span><br><span class="line">      ll mid = (<span class="number">2</span>*l+r)/<span class="number">3</span>, mmid = (<span class="number">2</span>*r+l+<span class="number">2</span>)/<span class="number">3</span>;</span><br><span class="line">      ll fmid = <span class="built_in">cal</span>(mid), fmmid = <span class="built_in">cal</span>(mmid);</span><br><span class="line">      <span class="keyword">if</span>(fmid&lt;=fmmid)</span><br><span class="line">      &#123;</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, fmid);</span><br><span class="line">        r = mmid - <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, fmmid);</span><br><span class="line">        l = mid + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>min_25ç­›</title>
      <link href="/2020/08/28/min_25-shai/"/>
      <url>/2020/08/28/min_25-shai/</url>
      
        <content type="html"><![CDATA[<p>å½“f$f(i)$æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œä¸”$f(p)$æ˜¯ä¸€ä¸ªå…³äºpçš„ä½é˜¶å¤šé¡¹å¼ï¼Œ$f(p^k)$æ˜¯ä¸€ä¸ªå®¹æ˜“è®¡ç®—çš„å¼å­ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨è¯¥äºšçº¿æ€§ç­›ï¼Œå¿«é€Ÿç®—å‡º$\sum_{i=1}^nf(i)$ï¼Œ$n \leq 10^{11}$</p><h3 id="ç¬¬ä¸€æ­¥"><a class="header-anchor" href="#ç¬¬ä¸€æ­¥">Â¶</a>ç¬¬ä¸€æ­¥</h3><p>åˆ©ç”¨å¦ä¸€ä¸ªå‡½æ•°$g(n,j)$ï¼Œå¿«é€Ÿè®¡ç®—å‡ºfåœ¨è´¨æ•°å¤„çš„å‰ç¼€å’Œ</p><p>$g(n, j) = \sum \limits_{i=1}^n [i \ is \ prime || minp &gt; p_j] i^k$</p><p>è¡¨ç¤º$\leq n$ä¸­çš„æ‰€æœ‰è´¨æ•°ä»¥åŠæœ€å°è´¨å› å­<strong>å¤§äº</strong>ç¬¬jå°è´¨æ•°$p_j$â€‹çš„æ‰€æœ‰æ•°çš„kæ¬¡æ–¹å’Œï¼Œå› ä¸ºf(p)æ˜¯ä¸€ä¸ªå…³äºpçš„å¤šé¡¹å¼ï¼Œè¿™æ ·æˆ‘ä»¬æŠŠè¿™ä¸ªå¤šé¡¹å¼æ‹†æˆå•é¡¹å¼ï¼Œå†å–ä¸åŒçš„kï¼Œè€Œå½“$p_j$â€‹ç­‰äºæœ€åä¸€ä¸ªå°äºç­‰äº$\sqrt nâ€‹$çš„è´¨å› å­æ—¶ï¼Œ$g(n, j)$å°±è¡¨ç¤ºå°äºç­‰äºnçš„æ‰€æœ‰è´¨æ•°çš„kæ¬¡æ–¹å’Œäº†ã€‚ä¸€ä¸ªæ•°çš„æœ€å°è´¨å› å­ä¸€å®šæ˜¯$\leq \sqrt n$â€‹çš„è€ƒè™‘ä»$g(n, j-1)$è½¬ç§»åˆ°$g(n, j)$æ—¶ï¼Œåªéœ€è¦å»æ‰æœ€å°è´¨å› å­$=p_j$â€‹çš„æ‰€æœ‰åˆæ•°å³å¯</p><p>$g(n, j) = g(n, j-1) -p_j^k(g(\frac{n}{p_j}, j-1) - g(p_{j-1}, j-1))$</p><p>å…¶ä¸­$g(p_{j-1}, j-1)$è¡¨ç¤ºå‰$j-1$ä¸ªè´¨æ•°çš„kæ¬¡æ–¹å’Œï¼Œå¯ä»¥åœ¨çº¿æ€§ç­›çš„æ—¶å€™é¢„å¤„ç†å‡ºæ¥åœ¨è½¬ç§»çš„æ—¶å€™æˆ‘ä»¬åªéœ€è¦ç”¨åˆ°$\lfloor \dfrac{n}{x} \rfloor$å¤„çš„å–å€¼ï¼Œè€Œè¿™ç§å€¼çš„ä¸ªæ•°æ˜¯$O(\sqrt n)$çº§åˆ«çš„ï¼Œå¯ä»¥åˆ©ç”¨ä¸€ä¸ªid1æ•°ç»„å’Œä¸€ä¸ªid2æ•°ç»„æ˜ å°„ä¸€ä¸‹ï¼Œå¯¹äº$\leq \sqrt n$â€‹çš„æ•°ï¼Œå­˜åœ¨id1é‡Œï¼Œå¯¹äºå…¶ä»–æ•°å­˜åœ¨id2ä¸­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ll w[M], g1[M], g2[M];</span><br><span class="line"><span class="type">int</span> id1[M], id2[M];</span><br><span class="line"><span class="keyword">auto</span> id = [&amp;](ll x) &#123; <span class="keyword">return</span> x&lt;=B ? id1[x] : id2[n/x]; &#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(ll _n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> sz = <span class="number">0</span>;</span><br><span class="line">  n = _n, B = <span class="built_in">sqrt</span>(n) + <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">getprime</span>(B);</span><br><span class="line">  <span class="keyword">for</span>(ll l=<span class="number">1</span>, r, v; l&lt;=n; l=r+<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    v = n/l, r = n/v;</span><br><span class="line">    w[++sz] = v; g1[sz] = <span class="built_in">prex1</span>(v); g2[sz] = <span class="built_in">prex2</span>(v);</span><br><span class="line">    <span class="keyword">if</span>(v&lt;=B) id1[v] = sz; <span class="keyword">else</span> id2[r] = sz;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=pc; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=sz&amp;&amp;<span class="number">1ll</span>*pr[i]*pr[i]&lt;=w[j]; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> t = <span class="built_in">id</span>(w[j]/pr[i]);</span><br><span class="line">      g1[j] = ((g1[j] - (g1[t] - sp1[i<span class="number">-1</span>])*<span class="built_in">x1</span>(pr[i]))%mod + mod)%mod;</span><br><span class="line">      g2[j] = ((g2[j] - (g2[t] - sp2[i<span class="number">-1</span>])*<span class="built_in">x2</span>(pr[i]))%mod + mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸€æ­¥æˆ‘ä»¬å°±å¯ä»¥æ±‚fåœ¨è´¨æ•°å¤„çš„å‰ç¼€å’Œäº†ï¼Œå¦‚æœè¦å¿«é€Ÿç»Ÿè®¡è´¨æ•°ä¸ªæ•°ï¼Œç­”æ¡ˆå°±æ˜¯$g_{id(n)}$â€‹</p><h3 id="ç¬¬äºŒæ­¥"><a class="header-anchor" href="#ç¬¬äºŒæ­¥">Â¶</a>ç¬¬äºŒæ­¥</h3><p>åŒæ ·çš„ï¼Œè®¾$S(n,k)$è¡¨ç¤ºæ±‚æ‰€æœ‰è´¨å› å­å¤§äº$p_k$â€‹çš„æ•°(å¤§äº$p_k$â€‹çš„è´¨æ•°ä¹Ÿç®—)çš„å‡½æ•°fä¹‹å’Œï¼Œç­”æ¡ˆå°±æ˜¯$S(n,0)$</p><p>$S(n,x) = g(n) - sp_x + \sum\limits_{p_k^e \leq n \land k&gt;x} f(p_k^e)S(\frac{n}{p_k^e} + [e \neq 1])$</p><p>å…¶ä¸­$g(n)-sp_x$â€‹è¡¨ç¤ºå¤§äº$p_k$â€‹çš„è´¨æ•°çš„å‡½æ•°fä¹‹å’Œï¼Œè¿™åœ¨ç¬¬ä¸€æ­¥ä¸­å·²ç»é¢„å¤„ç†å‡ºæ¥ï¼Œå†æšä¸¾åˆæ•°ä¸­æœ€å°è´¨å› å­çš„å¤§å°ä»¥åŠå¹‚æ¬¡ï¼Œé€’å½’å¤„ç†å³å¯ï¼Œæ³¨æ„æˆ‘ä»¬åœ¨æ‰€æœ‰è®¡ç®—ä¸­éƒ½æ˜¯ä¸ç»Ÿè®¡1å¤„çš„ç­”æ¡ˆçš„ï¼Œæ‰€ä»¥å½“$e\gt 1$æ—¶ï¼Œè¦é¢å¤–ç®—ä¸Š$f(p_k^e)$)å¤„çš„å€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">go</span><span class="params">(ll x, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(pr[k]&gt;=x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> t = <span class="built_in">id</span>(x); ll ans = (<span class="built_in">f</span>(g1[t]-sp1[k], g2[t]-sp2[k])%mod + mod)%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=k+<span class="number">1</span>; i&lt;=pc&amp;&amp;<span class="number">1ll</span>*pr[i]*pr[i]&lt;=x; i++)</span><br><span class="line">    <span class="keyword">for</span>(ll pp=pr[i], e=<span class="number">1</span>; pp&lt;=x; e++, pp=pp*pr[i])</span><br><span class="line">      ans = (ans + <span class="built_in">fp</span>(pp%mod)*(<span class="built_in">go</span>(x/pp, i)+(e!=<span class="number">1</span>)))%mod;</span><br><span class="line">  <span class="keyword">return</span> (ans+mod)%mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åçš„ç­”æ¡ˆå°±æ˜¯go(n, 0)+f(1)äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gym102501H Pseudo-Random Number Generator å¾ªç¯èŠ‚</title>
      <link href="/2020/08/27/gym102501h-pseudo-random-number-generator-xun-huan-jie/"/>
      <url>/2020/08/27/gym102501h-pseudo-random-number-generator-xun-huan-jie/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ•°åˆ—çš„é€’æ¨æ–¹å¼ï¼Œæ±‚å…¶å‰né¡¹ä¸­å¶æ•°çš„ä¸ªæ•°$M=1ull&lt;&lt;40$$s0=0x600DCAFE$$s_{n+1} = (s_n + (s_n &gt;&gt; 20) + 12345)%M$$n \lt 2^{63}$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å› ä¸ºè¦æ¨¡Mï¼Œæ‰€ä»¥çŒœæƒ³æœ‰å¾ªç¯èŠ‚æ‰¾å¾ªç¯èŠ‚çš„æ–¹å¼æ˜¯ç”¨é“¾è¡¨çš„åˆ¤ç¯ç®—æ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰å¿«æ…¢æŒ‡é’ˆåŒæ—¶ä½äºèµ·ç‚¹ï¼Œç„¶åå¿«æŒ‡é’ˆä¸€æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆä¸€æ¬¡èµ°ä¸€æ­¥ï¼Œè‹¥ä¸¤è€…ç›¸é‡è¯´æ˜æœ‰ç¯ï¼Œæ­¤æ—¶è®©ä¸€ä¸ªæŒ‡é’ˆä»èµ·ç‚¹å¼€å§‹ï¼Œä¸€ä¸ªæŒ‡é’ˆä»ç›¸é‡ç‚¹å¼€å§‹ï¼Œä¸€æ¬¡å„èµ°ä¸€æ­¥ï¼Œå½“ä¸¤è€…ç›¸é‡ï¼Œè¯¥ç‚¹å°±æ˜¯å…¥ç¯ç‚¹ä»¥ä¸‹ä»£ç è¿”å›å…¥ç¯ç‚¹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ull <span class="title">findloop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ull fst = <span class="number">0x600DCAFE</span>, slw = <span class="number">0x600DCAFE</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    slw = <span class="built_in">nxt</span>(slw);</span><br><span class="line">    fst = <span class="built_in">nxt</span>(<span class="built_in">nxt</span>(fst));</span><br><span class="line">    <span class="keyword">if</span>(fst==slw) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  slw = <span class="number">0x600DCAFE</span>;</span><br><span class="line">  <span class="keyword">while</span>(slw!=fst) slw = <span class="built_in">nxt</span>(slw), fst = <span class="built_in">nxt</span>(fst);</span><br><span class="line">  <span class="keyword">return</span> slw;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çŸ¥é“å…¥ç¯ç‚¹åï¼Œè®©ä¸€ä¸ªæŒ‡é’ˆåœ¨èµ·ç‚¹èµ°è‡³è¯¥ç‚¹çš„æ­¥æ•°å°±æ˜¯å¾ªç¯èŠ‚å¼€å§‹çš„ä½ç½®</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ull x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ull s = <span class="number">0x600DCAFE</span>; ll len = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(s!=x) len++, s = <span class="built_in">nxt</span>(s);</span><br><span class="line">  <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®©ä¸€ä¸ªæŒ‡é’ˆä»å…¥ç¯ç‚¹ä¸‹ä¸€ä¸ªå¼€å§‹å†èµ°è‡³å…¥ç¯ç‚¹çš„æ­¥æ•°+1å°±æ˜¯å¾ªç¯èŠ‚çš„é•¿åº¦ï¼ˆç¯é•¿ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">g</span><span class="params">(ull x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ull s = <span class="built_in">nxt</span>(x); ll len = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(s!=x) len++, s = <span class="built_in">nxt</span>(s);</span><br><span class="line">  <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœæ˜¯st = 350125310, loop = 182129209è¿™æ ·è¿˜æ˜¯è¿‡ä¸äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åˆ†æ®µæ‰“è¡¨ï¼Œå°†å‰sté¡¹æ¯éš”1e6ä¸ªæ•°è®°å½•ä¸€ä¸‹å‰ç¼€ç­”æ¡ˆï¼Œå¾ªç¯èŠ‚ä¹Ÿæ¯éš”1e6ä¸ªæ•°è®°å½•ä¸€ä¸‹å‰ç¼€ç­”æ¡ˆï¼Œæ­¤å¤–è¿˜è¦è®°å½•ä¸€ä¸‹è¯¥ç‚¹å¯¹åº”å¤„çš„æ•°åˆ—çš„å–å€¼ã€‚è¿™æ ·å¯¹äºæ•´å—æˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—åˆ°ç­”æ¡ˆï¼Œè€Œåé¢ä¸å®Œæ•´çš„å—å†æš´åŠ›ä¸€ä¸‹å³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p5488 å·®åˆ†ä¸å‰ç¼€å’Œ</title>
      <link href="/2020/08/25/p5488-chai-fen-yu-qian-zhui-he-2/"/>
      <url>/2020/08/25/p5488-chai-fen-yu-qian-zhui-he-2/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>å¿«é€Ÿæ±‚ä¸€ä¸ªæ•°åˆ—açš„ké˜¶å·®åˆ†æˆ–è€…ké˜¶å‰ç¼€å’Œ$n \leq 10^5,k\leq 10^{2333},mod=1004535809$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å°†æ•°åˆ—açœ‹æˆOGF:$F(x) = \sum \limits_{i=0}^{\infty}a_ix^i$ä½œä¸€æ¬¡å‰ç¼€å’Œç›¸å½“äºä¹˜ä»¥$\sum \limits_{i=0}^{\infty} x^i =\dfrac{1}{1-x}$ä½œä¸€æ¬¡å·®åˆ†ç›¸å½“äºä¹˜ä»¥$(1-x)$åˆ©ç”¨äºŒé¡¹å¼å®šç†ï¼š$\dfrac{1}{(1-x)^k} =(1-x)^{-k} = \sum \limits_{i=0}^{\infty} \dfrac{(-k)^{\underline{i}}}{i!}(-x)^i = \sum \limits_{i=0}^{\infty} \dfrac{(k+i-1)^{\underline{i}}}{i!}x^i$çº¿æ€§é€’æ¨å‡ºå‰né¡¹çš„ç³»æ•°ï¼Œç„¶åå’Œaä½œä¸€æ¬¡å·ç§¯å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, mod = <span class="number">1004535809</span>, gen = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> n, k, t, a[N], b[N], inv[N];</span><br><span class="line"><span class="type">int</span> up, l, rev[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">read</span><span class="params">(<span class="type">int</span> &amp;k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) c = <span class="built_in">getchar</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) k = (<span class="number">1ll</span>*k*<span class="number">10</span> + c - <span class="number">48</span>)%mod, c = <span class="built_in">getchar</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  up = <span class="number">1</span>, l = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">NTT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) <span class="keyword">if</span>(i&lt;rev[i]) <span class="built_in">swap</span>(a[i], a[rev[i]]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;up; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> gn = <span class="built_in">powmod</span>(gen, (mod<span class="number">-1</span>)/(i&lt;&lt;<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">-1</span>) gn = <span class="built_in">powmod</span>(gn, mod<span class="number">-2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;up; j+=(i&lt;&lt;<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>,g=<span class="number">1</span>; k&lt;i; k++,g=<span class="number">1ll</span>*g*gn%mod)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x = a[j+k], y = <span class="number">1ll</span>*g*a[j+k+i]%mod;</span><br><span class="line">      a[j+k] = (x+y)%mod, a[j+k+i] = (x-y+mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(op==<span class="number">-1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> invup = <span class="built_in">powmod</span>(up, mod<span class="number">-2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) a[i] = <span class="number">1ll</span>*a[i]*invup%mod;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = <span class="number">1ll</span>*(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">  <span class="built_in">read</span>(k);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">  b[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(t) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) b[i] = (<span class="number">-1ll</span>*b[i<span class="number">-1</span>]*(k-i+<span class="number">1</span>)%mod*inv[i]%mod+mod)%mod;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) b[i] = <span class="number">1ll</span>*b[i<span class="number">-1</span>]*(k+i<span class="number">-1</span>)%mod*inv[i]%mod;</span><br><span class="line">  <span class="built_in">init</span>(<span class="number">2</span>*n<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">NTT</span>(a, <span class="number">1</span>); <span class="built_in">NTT</span>(b, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) a[i] = <span class="number">1ll</span>*a[i]*b[i]%mod;</span><br><span class="line">  <span class="built_in">NTT</span>(a, <span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, a[i], <span class="string">&quot; \n&quot;</span>[i==n<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨æ°çŸ©é˜µ(æ¨è¡¨ï¼‰</title>
      <link href="/2020/08/25/yang-shi-ju-zhen-yang-biao/"/>
      <url>/2020/08/25/yang-shi-ju-zhen-yang-biao/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¨å›¾"><a class="header-anchor" href="#æ¨å›¾">Â¶</a>æ¨å›¾</h2><p>å¯¹äºnçš„ä¸€ä¸ªåˆ’åˆ†$\lambda=(\lambda_1 \geq \lambda_2 \ldots) \vdash n$ï¼Œæ¨å›¾ç¬¬$i$è¡Œæœ‰$\lambda_i$â€‹ä¸ªæ–¹å—</p><h2 id="æ ‡å‡†æ¨è¡¨"><a class="header-anchor" href="#æ ‡å‡†æ¨è¡¨">Â¶</a>æ ‡å‡†æ¨è¡¨</h2><p>å°†1-nè¿™nä¸ªæ•°å¡«å…¥ä¸€ä¸ªæ¨å›¾$\lambda$çš„æ¯ä¸€ä¸ªæ–¹å—ä¸­ï¼Œä½¿å¾—ä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³æ•°å­—éƒ½é€’å¢</p><h2 id="è¿‘ä¼¼æ¨è¡¨"><a class="header-anchor" href="#è¿‘ä¼¼æ¨è¡¨">Â¶</a>è¿‘ä¼¼æ¨è¡¨</h2><p>å°†nä¸ªä¸åŒçš„æ•°å­—å¡«å…¥æ¨å›¾ä¸­å­˜åœ¨ä¸€ç§æ’å…¥ç®—æ³•RSKï¼Œä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œæ¯æ¬¡æ›¿æ¢å½“å‰è¡Œç¬¬ä¸€ä¸ªå¤§äºè‡ªå·±çš„æ•°ï¼ˆå¦‚æœæœ‰ç›¸åŒæ•°å­—å°±æ›¿æ¢ç¬¬ä¸€ä¸ªå¤§äºç­‰äºè‡ªå·±çš„æ•°ï¼‰ï¼Œå¹¶å°†æ›¿æ¢çš„æ•°å»æ’å…¥ä¸‹ä¸€è¡Œï¼Œè‹¥æ‰¾ä¸åˆ°è¿™æ ·ä¸€ä¸ªæ•°ï¼Œåˆ™å°†è¯¥æ•°æ’å…¥åˆ°è¯¥è¡Œæœ«å°¾å¹¶ç»“æŸ</p><h2 id="é’©å­å®šç†"><a class="header-anchor" href="#é’©å­å®šç†">Â¶</a>é’©å­å®šç†</h2><p>$h_{i,j}$â€‹å®šä¹‰ä¸º(i,j)è¿™ä¸ªæ ¼å­ä¸‹é¢çš„æ ¼å­æ•°+å³è¾¹çš„æ ¼å­æ•°+1å¯¹äº$\lambda \vdash n$ï¼Œæœ‰$f^\lambda = \dfrac{n!}{\prod h_{i,j}}$è¡¨ç¤º$\lambda$å¯¹åº”çš„æ¨å›¾çš„å¡«æ³•</p><h2 id="Robinsonâ€“Schensted-correspondence"><a class="header-anchor" href="#Robinsonâ€“Schensted-correspondence">Â¶</a>Robinsonâ€“Schensted correspondence</h2><p>ä¸€ä¸ª1åˆ°nä¸ªæ•°çš„æ’åˆ—å’Œä¸€å¯¹ç›¸åŒå½¢çŠ¶çš„æ ‡å‡†æ¨è¡¨ä¸€ä¸€å¯¹åº”$\sum \limits_{\lambda \vdash n} (f^\lambda)^2$</p><h2 id="nä¸ªå…ƒç´ çš„æ¨æ°çŸ©é˜µçš„ä¸ªæ•°"><a class="header-anchor" href="#nä¸ªå…ƒç´ çš„æ¨æ°çŸ©é˜µçš„ä¸ªæ•°">Â¶</a>nä¸ªå…ƒç´ çš„æ¨æ°çŸ©é˜µçš„ä¸ªæ•°</h2><p>$f_n = f_{n-1} + (n-1)f_{n-2}$â€‹</p><h2 id="æ¨è¡¨ä¸LIS"><a class="header-anchor" href="#æ¨è¡¨ä¸LIS">Â¶</a>æ¨è¡¨ä¸LIS</h2><p>å°†ä¸€ä¸ªæ’åˆ—æŒ‰åºç”¨RSKç®—æ³•æ’å…¥åˆ°æ¨è¡¨ä¸­ï¼Œåˆ™æ¨è¡¨ç¬¬ä¸€è¡Œçš„é•¿åº¦ç­‰äºå…¶LISé•¿åº¦ï¼ˆæ„å»ºçš„æ¨è¡¨ä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³é€’å¢ï¼‰å°†æ¨è¡¨çš„æ¯”è¾ƒæ–¹å¼å–å($\lt$å˜$\geq$,$gt$å˜$\leq$)ï¼Œæ‰€å¾—æ¨è¡¨çš„å½¢çŠ¶ä¸ºåŸæ¨è¡¨çš„è½¬ç½®(ä»…å½¢çŠ¶è€Œè¨€)æ¨è¡¨ç¬¬ä¸€åˆ—çš„é•¿åº¦ç­‰äºæœ€é•¿ä¸ä¸Šå‡å­åºåˆ—é•¿åº¦(è€ƒè™‘è½¬ç½®)æ¨è¡¨å‰kåˆ—çš„é•¿åº¦å’Œç­‰äºLIS$\leq k$çš„k-LISçš„é•¿åº¦(åˆ©ç”¨Dilworthå®šç†ï¼Œç­‰ä»·äºåˆ’åˆ†å‡ºkä¸ªä¸ç›¸äº¤çš„æœ€é•¿ä¸ä¸Šå‡å­åºåˆ—)</p><h2 id="P3774-CTSC2017-æœ€é•¿ä¸Šå‡å­åºåˆ—"><a class="header-anchor" href="#P3774-CTSC2017-æœ€é•¿ä¸Šå‡å­åºåˆ—">Â¶</a>P3774 [CTSC2017]æœ€é•¿ä¸Šå‡å­åºåˆ—</h2><p>ç»™å®šä¸€ä¸ªé•¿ä¸ºnçš„åºåˆ—aï¼Œqæ¬¡è¯¢é—®açš„æŸä¸ªå‰ç¼€çš„æœ€é•¿k-LISçš„é•¿åº¦$n\leq 50000, q \leq 200000$å¯¹äºæ¯ä¸ªè¯¢é—®çš„ç­”æ¡ˆå°±æ˜¯å°†açš„è¿™ä¸ªå‰ç¼€ä¾æ¬¡æ’å…¥æ¨è¡¨åï¼Œå‰kåˆ—é•¿åº¦çš„å’Œè€ƒè™‘ç¦»çº¿è¯¢é—®ååŠ¨æ€ç»´æŠ¤å‰kåˆ—é•¿åº¦å’Œæ¯æ¬¡æ’å…¥çš„å¤æ‚åº¦æ˜¯$O(n\log n)$çš„æˆ‘ä»¬å¯ä»¥åªç»´æŠ¤æ¨è¡¨çš„å‰$\sqrt n$â€‹è¡Œï¼Œç„¶ååè½¬æ¯”è¾ƒæ–¹å¼ï¼Œå†ç»´æŠ¤è¿™ä¸ªæ¨è¡¨çš„è½¬ç½®çš„å‰$\sqrt n$â€‹è¡Œ(ç­‰ä»·äºç»´æŠ¤äº†åŸæ¨è¡¨çš„å‰$\sqrt n$â€‹åˆ—ï¼Œå½“è¿™ä¸€åˆ—çš„é•¿åº¦è¶…è¿‡$\sqrt n$â€‹æ—¶ï¼Œè¡¨æ˜è¿™ä¸ªå…ƒç´ åœ¨åŸæ¨è¡¨ä¸­æ²¡æœ‰ç»´æŠ¤åˆ°ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œç»´æŠ¤å³å¯)ï¼Œæ˜¾ç„¶æ¯ä¸ªå…ƒç´ çš„è¡Œæˆ–åˆ—çš„ä¸‹æ ‡è‡³å°‘æœ‰ä¸€ä¸ª$\leq \sqrt n$â€‹ï¼Œæ‰€ä»¥è¿™æ ·æ˜¯æ­£ç¡®çš„å¤æ‚åº¦ä¸º$O(n\sqrt n \log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, M = <span class="number">255</span>;</span><br><span class="line"><span class="type">int</span> n, qq, blo, a[N], c[N], ans[<span class="number">4</span>*N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; YT[M], YT2[M];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qry</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> m, k, idx;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> qry&amp; oth) &#123; <span class="keyword">return</span> m &lt; oth.m; &#125;</span><br><span class="line">&#125;q[<span class="number">4</span>*N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) c[i] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += c[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, x=v; i&lt;blo; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(YT[i].<span class="built_in">empty</span>() || YT[i].<span class="built_in">back</span>()&lt;x)</span><br><span class="line">    &#123;</span><br><span class="line">      YT[i].<span class="built_in">push_back</span>(x);</span><br><span class="line">      <span class="built_in">upd</span>(YT[i].<span class="built_in">size</span>(), <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">swap</span>(YT[i][<span class="built_in">lower_bound</span>(YT[i].<span class="built_in">begin</span>(), YT[i].<span class="built_in">end</span>(), x)-YT[i].<span class="built_in">begin</span>()], x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add2</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, x=v; i&lt;blo; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(YT2[i].<span class="built_in">empty</span>() || YT2[i].<span class="built_in">back</span>()&gt;=x)</span><br><span class="line">    &#123;</span><br><span class="line">      YT2[i].<span class="built_in">push_back</span>(x);</span><br><span class="line">      <span class="keyword">if</span>((<span class="type">int</span>)YT2[i].<span class="built_in">size</span>()&gt;=blo) <span class="built_in">upd</span>(i, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">swap</span>(YT2[i][<span class="built_in">upper_bound</span>(YT2[i].<span class="built_in">begin</span>(), YT2[i].<span class="built_in">end</span>(), x, <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;())-YT2[i].<span class="built_in">begin</span>()], x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;qq);</span><br><span class="line">  blo = <span class="built_in">sqrt</span>(n) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=qq; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;q[i].m, &amp;q[i].k), q[i].idx = i;</span><br><span class="line">  <span class="built_in">sort</span>(q+<span class="number">1</span>, q+qq+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> pre = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=qq; )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = i;</span><br><span class="line">    <span class="keyword">while</span>(pre&lt;=q[i].m) <span class="built_in">add</span>(a[pre]), <span class="built_in">add2</span>(a[pre]), pre++;</span><br><span class="line">    <span class="keyword">while</span>(j&lt;=qq &amp;&amp; q[j].m==q[i].m)</span><br><span class="line">    &#123;</span><br><span class="line">      ans[q[j].idx] = <span class="built_in">ask</span>(q[j].k);</span><br><span class="line">      j++;</span><br><span class="line">    &#125;</span><br><span class="line">    i = j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=qq; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="P4484-BJWC2018-æœ€é•¿ä¸Šå‡å­åºåˆ—"><a class="header-anchor" href="#P4484-BJWC2018-æœ€é•¿ä¸Šå‡å­åºåˆ—">Â¶</a>P4484 [BJWC2018]æœ€é•¿ä¸Šå‡å­åºåˆ—</h2><p>æ±‚é•¿åº¦ä¸ºnçš„éšæœºæ’åˆ—çš„LISçš„é•¿åº¦çš„æœŸæœ›$n \leq 28$<s>æš´åŠ›è·‘å‰å‡ ä¸ªç„¶åoeis</s>æˆ‘ä»¬åªéœ€è¦æšä¸¾nçš„æ‰€æœ‰æ•´æ•°åˆ’åˆ†$\lambda$ï¼Œç„¶ååˆ©ç”¨é’©å­å…¬å¼è®¡ç®—å‡ºç›¸åº”çš„$f^\lambda$ï¼Œé‚£ä¹ˆæ‰€æœ‰æ’åˆ—çš„LISé•¿åº¦çš„å’Œæ˜¯$\sum\limits_{\lambda \vdash n} (f^\lambda)^2 \lambda_1$â€‹ï¼Œå†é™¤ä»¥æ’åˆ—æ•°$n!$å³å¯nçš„æ•´æ•°åˆ’åˆ†ä¸ªæ•°$p(n) \approx \frac{1}{4n\sqrt 3}exp(\pi\sqrt{\frac{2n}{3}})$å¤æ‚åº¦$O(p(n))$ï¼Œå¤§æ¦‚èƒ½è·‘$\leq 63$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, N = <span class="number">30</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">ll inv[N], ans;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x)</span><br><span class="line">  &#123;</span><br><span class="line">    ll cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) cur = cur*i%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;y; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=a[i]; j++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> R = a[i] - j, D = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=i; k&lt;y; k++)</span><br><span class="line">          <span class="keyword">if</span>(a[k]&gt;=j) D++;</span><br><span class="line">        cur = cur*inv[R+D]%mod;</span><br><span class="line">      &#125;</span><br><span class="line">    ans = (ans + cur*cur%mod*a[<span class="number">1</span>]%mod)%mod;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=x; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(y!=<span class="number">1</span> &amp;&amp; i&gt;a[y<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    a[y] = i;</span><br><span class="line">    <span class="built_in">dfs</span>(x-i, y+<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) inv[i] = <span class="built_in">powmod</span>(i, mod<span class="number">-2</span>);</span><br><span class="line">  <span class="built_in">dfs</span>(n, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) ans = ans*inv[i]%mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ±‚ä¸ç›¸äº¤çš„LIS"><a class="header-anchor" href="#æ±‚ä¸ç›¸äº¤çš„LIS">Â¶</a>æ±‚ä¸ç›¸äº¤çš„LIS</h2><p>è€ƒè™‘$dp_{i,j}$â€‹è¡¨ç¤ºç¬¬ä¸€ä¸ªLISçš„æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼ä¸ºiï¼Œç¬¬äºŒä¸ªLISçš„æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼ä¸ºjï¼Œæœ´ç´ è½¬ç§»çš„å¤æ‚åº¦æ˜¯$O(n^3)$ï¼Œåˆ©ç”¨æ ‘çŠ¶æ•°ç»„å¯ä»¥ä¼˜åŒ–åˆ°$O(n^2\log n)$æ­¤å¤–ä¹Ÿå¯ä»¥ç”¨è´¹ç”¨æµå¦‚æœè¯¢é—®çš„æ˜¯ä¸ç›¸äº¤LISçš„é•¿åº¦ï¼Œåªè¦ç»´æŠ¤å‡ºæ¨è¡¨çš„å‰ä¸¤è¡Œå³å¯ï¼Œç„¶åç­”æ¡ˆå°±æ˜¯å‰ä¸¤è¡Œçš„é•¿åº¦å’Œ$O(2n\log n)$ï¼Œå¯¹äºkä¸ç›¸äº¤LISï¼Œå¯ä»¥åšåˆ°$O(kn\log n)$hdu5406</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">YT</span></span><br><span class="line">&#123;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; t[<span class="number">3</span>];</span><br><span class="line">  <span class="built_in">YT</span>() &#123; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">2</span>; i++) t[i].<span class="built_in">clear</span>(); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, x=v; i&lt;=<span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(t[i].<span class="built_in">empty</span>() || t[i].<span class="built_in">back</span>()&lt;=x)</span><br><span class="line">      &#123;</span><br><span class="line">        t[i].<span class="built_in">push_back</span>(x);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">swap</span>(t[i][<span class="built_in">upper_bound</span>(t[i].<span class="built_in">begin</span>(), t[i].<span class="built_in">end</span>(), x)-t[i].<span class="built_in">begin</span>()], x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;p[i].first, &amp;p[i].second);</span><br><span class="line">  <span class="built_in">sort</span>(p+<span class="number">1</span>, p+n+<span class="number">1</span>, [](pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; x, pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; y) &#123;</span><br><span class="line">    <span class="keyword">if</span>(x.first==y.first) <span class="keyword">return</span> x.second &lt; y.second;</span><br><span class="line">    <span class="keyword">return</span> x.first &gt; y.first;</span><br><span class="line">  &#125;);</span><br><span class="line">  YT T;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) T.<span class="built_in">add</span>(p[i].second);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">int</span>(T.t[<span class="number">1</span>].<span class="built_in">size</span>() + T.t[<span class="number">2</span>].<span class="built_in">size</span>()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾ªç¯çŸ©é˜µ</title>
      <link href="/2020/08/25/xun-huan-ju-zhen/"/>
      <url>/2020/08/25/xun-huan-ju-zhen/</url>
      
        <content type="html"><![CDATA[<p>çŸ©é˜µçš„ç¬¬iè¡Œæ˜¯å…¶ä¸Šä¸€è¡Œå¾ªç¯å³ç§»çš„ç»“æœ</p><h2 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h2><p>å¾ªç¯çŸ©é˜µçš„çº¿æ€§è¿ç®—åŠä¹˜ç§¯ä»æ˜¯å¾ªç¯çŸ©é˜µå¾ªç¯çŸ©é˜µçš„é€†çŸ©é˜µä»¥åŠè½¬ç½®çŸ©é˜µä»æ˜¯å¾ªç¯çŸ©é˜µå¾ªç¯çŸ©é˜µä¹˜æ³•æ»¡è¶³äº¤æ¢å¾‹</p><h2 id="ä¼˜åŠ¿"><a class="header-anchor" href="#ä¼˜åŠ¿">Â¶</a>ä¼˜åŠ¿</h2><p>ç”±äºä¸¤ä¸ªå¾ªç¯çŸ©é˜µçš„ä¹˜æ³•çš„ç»“æœä»ç„¶æ˜¯ä¸€ä¸ªå¾ªç¯çŸ©é˜µï¼Œæ‰€ä»¥å¯ä»¥$O(n^2)$æ±‚å¾—ç»“æœçš„ç¬¬ä¸€è¡Œï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°å…¶ä»–å„è¡Œçš„ç»“æœï¼Œå°†çŸ©é˜µä¹˜æ³•çš„å¤æ‚åº¦ä¸‹é™äº†ä¸€çº§è‹¥ä¸‹æ ‡ä»0å¼€å§‹ï¼š$c[1][(i+j)$ % $n] += a[1][i] * b[1][j]$è‹¥ä¸‹æ ‡ä»1å¼€å§‹ï¼š$c[1][(i+j-2)$ % $(n+1)] += a[1][i] * b[1][j]$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">cirmat</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> mat[N];</span><br><span class="line">    <span class="built_in">cirmat</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">cirmat</span>(<span class="type">int</span> _) : <span class="built_in">n</span>(_) &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="built_in">cirmat</span>() &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span> </span>&#123; mat[<span class="number">0</span>] = <span class="number">1</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">cirmat <span class="keyword">operator</span> * (cirmat a, cirmat b)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      (res.mat[(i+j<span class="number">-2</span>)%n+<span class="number">1</span>] += <span class="number">1ll</span>*a.mat[i]*b.mat[j]%mod) %= mod;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">cirmat <span class="keyword">operator</span> ^ (cirmat a, ll x)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="bzoj2510-å¼±é¢˜"><a class="header-anchor" href="#bzoj2510-å¼±é¢˜">Â¶</a>bzoj2510 å¼±é¢˜</h2><p>æœ‰mä¸ªå¸¦æ ‡å·çƒï¼Œæ ‡å·èŒƒå›´ä¸º1-nï¼Œæ¯æ¬¡æ“ä½œç­‰æ¦‚ç‡é€‰æ‹©ä¸€ä¸ªçƒï¼Œä½¿å¾—è¯¥çƒçš„æ ‡å·åŠ 1ï¼ˆå¦‚æœæ˜¯nï¼Œå°±å˜æˆ1ï¼‰é—®kæ¬¡æ“ä½œåï¼Œå„ä¸ªæ ‡å·çƒçš„ä¸ªæ•°çš„æœŸæœ›$n \leq 1000,m \leq 10^9,k \leq INT\_MAX$è½¬ç§»çŸ©é˜µæ˜¯ä¸€ä¸ªå¾ªç¯çŸ©é˜µ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, k;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cirmat</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">double</span> mat[N];</span><br><span class="line">  <span class="built_in">cirmat</span>() &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span> </span>&#123; mat[<span class="number">0</span>] = <span class="number">1.0</span>; &#125;</span><br><span class="line">&#125;a, b;</span><br><span class="line">cirmat <span class="keyword">operator</span> * (cirmat a, cirmat b)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;n; j++)</span><br><span class="line">      res.mat[(i+j)%n] += a.mat[i]*b.mat[j];</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">cirmat <span class="keyword">operator</span> ^ (cirmat a, <span class="type">int</span> x)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;a.mat[i]);</span><br><span class="line">  b.mat[<span class="number">0</span>] = <span class="number">1.0</span> - <span class="number">1.0</span>/m, b.mat[<span class="number">1</span>] = <span class="number">1.0</span>/m;</span><br><span class="line">  b = b ^ k;</span><br><span class="line">  a = a * b;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.3f\n&quot;</span>, a.mat[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç‰›å®¢14532-æ²¡æœ‰åå­—"><a class="header-anchor" href="#ç‰›å®¢14532-æ²¡æœ‰åå­—">Â¶</a>ç‰›å®¢14532 æ²¡æœ‰åå­—</h2><p>è½¬ç§»æ˜¯ä¸€ä¸ªå¾ªç¯çŸ©é˜µ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">205</span>;</span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line">ll m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cirmat</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> mat[N];</span><br><span class="line">  <span class="built_in">cirmat</span>() &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span> </span>&#123; mat[<span class="number">1</span>] = <span class="number">1</span>; &#125;</span><br><span class="line">&#125;a, b;</span><br><span class="line">cirmat <span class="keyword">operator</span> * (cirmat a, cirmat b)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      (res.mat[(i+j<span class="number">-2</span>)%n+<span class="number">1</span>] += <span class="number">1ll</span>*a.mat[i]*b.mat[j]%mod) %= mod;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">cirmat <span class="keyword">operator</span> ^ (cirmat a, ll x)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%lld%d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a.mat[i]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> dis = <span class="built_in">min</span>(i<span class="number">-1</span>, n+<span class="number">1</span>-i);</span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">1</span> || dis&gt;=k) b.mat[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> b.mat[i] = k - dis;</span><br><span class="line">  &#125;</span><br><span class="line">  b = b ^ m;</span><br><span class="line">  a = a * b;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, a.mat[i], <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œåˆ©ç”¨FFTè¿˜å¯ä»¥å°†å¾ªç¯çŸ©é˜µä¹˜æ³•ä¼˜åŒ–åˆ°$O(n\log n)$ï¼Œè¿˜ä¸ä¼šï¼Œå…ˆå’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å°å‰²ç›¸å…³</title>
      <link href="/2020/08/16/zui-xiao-ge-xiang-guan/"/>
      <url>/2020/08/16/zui-xiao-ge-xiang-guan/</url>
      
        <content type="html"><![CDATA[<h2 id="æœ€å°å‰²çš„æ–¹æ¡ˆ"><a class="header-anchor" href="#æœ€å°å‰²çš„æ–¹æ¡ˆ">Â¶</a>æœ€å°å‰²çš„æ–¹æ¡ˆ</h2><p>è·‘ä¸€éæœ€å¤§æµï¼Œè®°å½•ä»så‡ºå‘èƒ½åˆ°è¾¾çš„ç‚¹é›†Sï¼Œä¸èƒ½åˆ°è¾¾çš„ç‚¹é›†ä¸ºTï¼Œåˆ™è·¨è¶ŠSå’ŒTçš„æ»¡æµè¾¹ï¼ˆæ®‹ç•™ç½‘ç»œä¸­å®¹é‡=0ï¼‰æ˜¯æœ€å°å‰²ä¸­çš„è¾¹</p><h2 id="å¯è¡Œè¾¹ä¸å¿…é¡»è¾¹"><a class="header-anchor" href="#å¯è¡Œè¾¹ä¸å¿…é¡»è¾¹">Â¶</a>å¯è¡Œè¾¹ä¸å¿…é¡»è¾¹</h2><p>å¯è¡Œè¾¹ï¼šå±äºæ‰€æœ‰å¯èƒ½çš„æœ€å°å‰²é›†çš„å¹¶é›†ä¸­çš„è¾¹å¿…é¡»è¾¹ï¼šå±äºæ‰€æœ‰å¯èƒ½çš„æœ€å°å‰²é›†çš„äº¤é›†ä¸­çš„è¾¹è·‘ä¸€éæœ€å¤§æµï¼Œç„¶åå¯¹æ®‹ä½™ç½‘ç»œï¼ˆå®¹é‡å¤§äº0çš„è¾¹ï¼‰è·‘ä¸€étarjanå¦‚æœè¯¥è¾¹è¿˜æœ‰å®¹é‡ï¼Œä¸å±äºæœ€å°å‰²é›†ï¼Œæ‰€ä»¥æ—¢ä¸æ˜¯å¯è¡Œè¾¹ä¹Ÿä¸æ˜¯å¿…é¡»è¾¹å¦‚æœæŸæ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹åˆ†å±äºä¸¤ä¸ªsccï¼Œåˆ™ä¸ºå¯è¡Œè¾¹å¦‚æœæŸæ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹ä¸€ä¸ªä¸SåŒåœ¨ä¸€ä¸ªsccï¼Œä¸€ä¸ªä¸TåŒåœ¨ä¸€ä¸ªsccï¼Œåˆ™ä¸ºå¿…é¡»è¾¹</p><h2 id="æ±‚è¾¹æ•°æœ€å°‘çš„æœ€å°å‰²"><a class="header-anchor" href="#æ±‚è¾¹æ•°æœ€å°‘çš„æœ€å°å‰²">Â¶</a>æ±‚è¾¹æ•°æœ€å°‘çš„æœ€å°å‰²</h2><p>è®¾åŸå›¾æ€»è¾¹æ•°=Mè®©åŸå›¾çš„æ¯ä¸€æ¡è¾¹çš„æƒå€¼wå˜æˆ$(M+1)w+1$å†è·‘æœ€å¤§æµå³å¯</p><h2 id="æ¯æ¡è¾¹æœ‰ä¸¤ä¸ªæƒå€¼ï¼Œåœ¨æœ€å°åŒ–ç¬¬ä¸€ä¸ªæƒå€¼çš„å‰²åï¼Œæ‰¾ä¸€ä¸ªç¬¬äºŒä¸ªæƒå€¼å­—å…¸åºæœ€å°çš„å‰²"><a class="header-anchor" href="#æ¯æ¡è¾¹æœ‰ä¸¤ä¸ªæƒå€¼ï¼Œåœ¨æœ€å°åŒ–ç¬¬ä¸€ä¸ªæƒå€¼çš„å‰²åï¼Œæ‰¾ä¸€ä¸ªç¬¬äºŒä¸ªæƒå€¼å­—å…¸åºæœ€å°çš„å‰²">Â¶</a>æ¯æ¡è¾¹æœ‰ä¸¤ä¸ªæƒå€¼ï¼Œåœ¨æœ€å°åŒ–ç¬¬ä¸€ä¸ªæƒå€¼çš„å‰²åï¼Œæ‰¾ä¸€ä¸ªç¬¬äºŒä¸ªæƒå€¼å­—å…¸åºæœ€å°çš„å‰²</h2><p>å…ˆéšä¾¿æ±‚ä¸€ä¸ªæœ€å°å‰²ï¼Œå°†è¿™äº›è¾¹æŒ‰ç…§ç¬¬äºŒä¸ªæƒå€¼æ’åºï¼Œåˆ¤æ–­è¯¥è¾¹æ˜¯å¦æ˜¯å¯è¡Œè¾¹ï¼Œå¦‚æœæ˜¯å°±é€‰æ‹©ï¼Œå‰²æ‰ä¸€æ¡è¾¹éœ€è¦åˆ©ç”¨é€€æµæ“ä½œï¼Œå…·ä½“åšæ³•æ˜¯å¯¹äºè¾¹(u,v)ï¼Œè®©uå‘Sè·‘ä¸€éæœ€å¤§æµï¼Œå†è®©Tå‘vè·‘ä¸€éæœ€å¤§æµï¼Œæœ€åè®©(u,v)è¿™æ¡è¾¹åŠå…¶åè¾¹çš„æ®‹ä½™æµé‡ç½®0ï¼Œå³w=0</p><h2 id="æœ€å°å‰²æ ‘"><a class="header-anchor" href="#æœ€å°å‰²æ ‘">Â¶</a>æœ€å°å‰²æ ‘</h2><p>æ±‚ä»»æ„ä¸¤ç‚¹é—´çš„æœ€å°å‰²æœ¬è´¨åªæœ‰$O(n)$ç§ï¼Œå»ºå‡ºæœ€å°å‰²æ ‘åï¼Œuï¼Œvä¸¤ç‚¹çš„æœ€å°å‰²ç­‰äºè·¯å¾„ä¸Šçš„æœ€å°è¾¹æƒå»ºæ ‘æ–¹æ³•ï¼šè·‘næ¬¡æœ€å¤§æµæ¯æ¬¡éšæœºå–ä¸¤ä¸ªç‚¹ï¼Œæ±‚å®ƒä»¬çš„æœ€å°å‰²ï¼Œå°†å›¾åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåœ¨è¿™ä¸¤ä¸ªé›†åˆé—´è¿ä¸€æ¡è¾¹æƒä¸ºæœ€å°å‰²çš„è¾¹ï¼Œç„¶ååˆ†æ²»å¤„ç†ä¸¤ä¸ªé›†åˆã€‚è¿™æ ·æœ€åä¼šå¾—åˆ°ä¸€æ£µæ ‘ã€‚åˆ™ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æœ€å°å‰²å¤§å°ä¸ºå…¶æ ‘ä¸Šå”¯ä¸€è·¯å¾„çš„æœ€å°å€¼ã€‚æ¯æ¬¡ç½‘ç»œæµçš„æµé‡è¦å¤åŸï¼Œæ‰€ä»¥ç”¨å˜é‡fwè®°å½•æ¯æ¡è¾¹å·²ç»æµè¿‡çš„æµé‡ï¼Œå˜é‡wè®°å½•å®¹é‡ä¿æŒä¸å˜ï¼Œå½“fw=wæ—¶è¯´æ˜è¯¥è¾¹æ»¡æµï¼Œå¤åŸåªéœ€è¦æ¸…é›¶fwå³å¯æ±‚è·¯å¾„æœ€å°å€¼æ²¡å¿…è¦å€å¢ï¼Œå› ä¸ºç‚¹æ•°ä¸ä¼šå¾ˆå¤§ï¼Œç›´æ¥å»ºå‡ºæ ‘ï¼Œä»¥æ¯ä¸ªç‚¹ä¸ºæ ¹bfsä¸€æ¬¡å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">505</span>, M = <span class="number">2e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> cnt, head[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> next, to, w, fw;</span><br><span class="line">&#125;e[M&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  e[++cnt] = &#123;head[u], v, w, <span class="number">0</span>&#125;;</span><br><span class="line">  head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m, s, t;</span><br><span class="line">  <span class="type">int</span> dep[N], cur[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">    cnt = <span class="number">1</span>, m = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> cap)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(u, v, cap);</span><br><span class="line">    <span class="built_in">add</span>(v, u, cap);</span><br><span class="line">    m += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dep,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">memcpy</span>(cur,head,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s); dep[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].to;</span><br><span class="line">        <span class="keyword">if</span>(!dep[v]&amp;&amp;e[i].fw&lt;e[i].w)</span><br><span class="line">        &#123;</span><br><span class="line">          dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">          q.<span class="built_in">push</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[t];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> flow)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u==t||!flow) <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="type">int</span> used = flow;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=cur[u];i;i=e[i].next)</span><br><span class="line">    &#123;</span><br><span class="line">      cur[u] = i;</span><br><span class="line">      <span class="type">int</span> v = e[i].to;</span><br><span class="line">      <span class="keyword">if</span>(dep[v]==dep[u]+<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> low = <span class="built_in">dfs</span>(v,<span class="built_in">min</span>(flow,e[i].w-e[i].fw));</span><br><span class="line">        e[i].fw += low; e[i^<span class="number">1</span>].fw -= low;</span><br><span class="line">        flow -= low;</span><br><span class="line">        <span class="keyword">if</span>(!flow) <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> used - flow;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">go</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> maxflow = <span class="number">0</span>; s = x, t = y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=cnt; i++) e[i].fw = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>()) maxflow += <span class="built_in">dfs</span>(s,INF);</span><br><span class="line">    <span class="keyword">return</span> maxflow;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;MF;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GHT</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> pt[N], col[N], tmpt[N], cnt, cut[N][N];</span><br><span class="line">  vector&lt;pii&gt; G[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    col[u] = cnt;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">      <span class="keyword">if</span>(e[i].fw&lt;e[i].w &amp;&amp; col[e[i].to]!=cnt)</span><br><span class="line">        <span class="built_in">dfs</span>(e[i].to);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> x = pt[l], y = pt[l+<span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> cutw = MF.<span class="built_in">go</span>(x, y);</span><br><span class="line">    ++cnt; <span class="built_in">dfs</span>(x); <span class="type">int</span> p = l, q = r;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++)</span><br><span class="line">      <span class="keyword">if</span>(col[pt[i]]==cnt) tmpt[p++] = pt[i];</span><br><span class="line">      <span class="keyword">else</span> tmpt[q--] = pt[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) pt[i] = tmpt[i];</span><br><span class="line">    G[x].<span class="built_in">pb</span>(&#123;y, cutw&#125;); G[y].<span class="built_in">pb</span>(&#123;x, cutw&#125;);</span><br><span class="line">    <span class="built_in">build</span>(l, p<span class="number">-1</span>); <span class="built_in">build</span>(q+<span class="number">1</span>, r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> *dis)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) dis[i] = <span class="number">-1</span>;</span><br><span class="line">    dis[s] = INF;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q; q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">sz</span>(q))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">        <span class="keyword">if</span>(~dis[v]) <span class="keyword">continue</span>;</span><br><span class="line">        dis[v] = <span class="built_in">min</span>(dis[u], w);</span><br><span class="line">        q.<span class="built_in">push</span>(v);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  MF.<span class="built_in">init</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">    MF.<span class="built_in">addedge</span>(u, v, w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">iota</span>(T.pt+<span class="number">1</span>, T.pt+n+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  T.<span class="built_in">build</span>(<span class="number">1</span>, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) T.<span class="built_in">bfs</span>(i, T.cut[i]);</span><br><span class="line">  <span class="type">int</span> q; cin &gt;&gt; q;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">    cout &lt;&lt; T.cut[u][v] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•´æ•°æ‹†åˆ†</title>
      <link href="/2020/08/15/zheng-shu-chai-fen/"/>
      <url>/2020/08/15/zheng-shu-chai-fen/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸èƒ½ç›¸ç­‰"><a class="header-anchor" href="#ä¸èƒ½ç›¸ç­‰">Â¶</a>ä¸èƒ½ç›¸ç­‰</h2><p>å°†æ­£æ•´æ•°nåˆ’åˆ†æˆä¸èƒ½ç›¸ç­‰çš„è‹¥å¹²ä¸ªæ­£æ•´æ•°çš„å’Œçš„æ–¹æ¡ˆæ•°ç”±äºä¸èƒ½ç›¸ç­‰ï¼Œæ‰€ä»¥åˆ’åˆ†æˆçš„æ•°å­—ä¸ªæ•°ä¸è¶…è¿‡$\sqrt n$â€‹è®¾$f_{i,j}$â€‹è¡¨ç¤ºå°†iåˆ’åˆ†æˆjä¸ªä¸åŒæ•°å­—çš„å’Œçš„æ–¹æ¡ˆæ•°$f_{i,j} = f_{i-j,j} + f_{i-j,j-1}$â€‹$O(n\sqrt n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, B = <span class="number">350</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, f[N][B];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> (x+y&gt;=mod) ? x+y-mod : x+y; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=i &amp;&amp; j&lt;B; j++)</span><br><span class="line">      f[i][j] = <span class="built_in">add</span>(f[i-j][j], f[i-j][j<span class="number">-1</span>]);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;B; j++) ans = <span class="built_in">add</span>(ans, f[n][j]);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="èƒ½ç›¸ç­‰"><a class="header-anchor" href="#èƒ½ç›¸ç­‰">Â¶</a>èƒ½ç›¸ç­‰</h2><p>å°†æ­£æ•´æ•°nåˆ’åˆ†æˆè‹¥å¹²æ­£æ•´æ•°çš„å’Œçš„æ–¹æ¡ˆæ•°è®¾å®šé˜ˆå€¼$B=\sqrt n$å¯¹äº&lt;Bçš„éƒ¨åˆ†ï¼Œç›´æ¥åšå®Œå…¨èƒŒåŒ…å¯¹äº&gt;=Bçš„éƒ¨åˆ†ï¼Œé€‰æ‹©çš„æ•°å­—ä¸ªæ•°ä¸è¶…è¿‡Bè®¾$f_{i,j}$â€‹è¡¨ç¤ºå°†iåˆ’åˆ†æˆjä¸ªä¸åŒæ•°å­—çš„å’Œçš„æ–¹æ¡ˆæ•°$f_{i,j} = f_{i-B,j-1} + f_{i-j,j}$$O(n\sqrt n)O$ ä½†åªèƒ½è§£å†³å•æ¬¡è¯¢é—®</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, B = <span class="number">350</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, f0[N], f1[N], f[N][B];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> (a+b&gt;=mod) ? a+b-mod : a+b; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  f0[<span class="number">0</span>] = f1[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;B &amp;&amp; j&lt;=n; j++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=j; i&lt;=n; i++)</span><br><span class="line">      f0[i] = <span class="built_in">Add</span>(f0[i], f0[i-j]);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=B; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=B; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      f[i][j] = <span class="built_in">Add</span>(f[i-B][j<span class="number">-1</span>], f[i-j][j]);</span><br><span class="line">      f1[i] = <span class="built_in">Add</span>(f1[i], f[i][j]);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) <span class="built_in">add</span>(ans, <span class="built_in">Mul</span>(f0[i], f1[n-i]));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº”è¾¹å½¢æ•°$\frac{n(3n-1)}{2}$æ¬§æ‹‰å‡½æ•°$\phi(n) = \prod \limits_{i=1}^{\infty}(1-x^i) = \prod\limits_{i=-\infty}^{\infty}(-1)^ix^{\frac{i(3i-1)}{2}}$â€‹å³å±•å¼€ååªç•™ä¸‹å¹‚æ¬¡ä¸ºå¹¿ä¹‰äº”è¾¹å½¢æ•°çš„é¡¹è€ƒè™‘æ•´æ•°æ‹†åˆ†çš„ç”Ÿæˆå‡½æ•°$F(x) = \sum\limits_{i=1}^{\infty} P(i)x^i =\prod \limits_{i=1}^{\infty}(1+x^i+x^{2i}â€¦)= \prod\limits_{i=1}^{\infty}\frac{1}{1-x^i}$â€‹å³$F(x)\phi(x)=1$å¯ä»¥å¾—åˆ°$P(n)-P(n-1)-P(n-2)+P(n-5)+P(n-7)-â€¦=0$å®¹æ˜“å‘ç°P(n)å¯ç”±$n-\dfrac{i(3*i-1)}{2}$â€‹ä»¥åŠ$n-\dfrac{i(3*i+1)}{2}$â€‹æ›´æ–°å¾—åˆ°ç”±äºäº”è¾¹å½¢æ•°æ˜¯$n^2$çº§åˆ«å¢é•¿çš„ï¼Œæ‰€ä»¥å¯ä»¥$O(n\sqrt n)$é€’æ¨å¾—åˆ°$P(1)\dots P(n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, B = <span class="number">350</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, i, j, f[B], g[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(f[<span class="number">1</span>]=<span class="number">1</span>,f[<span class="number">2</span>]=<span class="number">2</span>,f[<span class="number">3</span>]=<span class="number">5</span>,f[<span class="number">4</span>]=<span class="number">7</span>,i=<span class="number">5</span>; f[i<span class="number">-1</span>]&lt;n; i++) f[i] = <span class="number">3</span> + <span class="number">2</span>*f[i<span class="number">-2</span>] - f[i<span class="number">-4</span>];</span><br><span class="line">  <span class="keyword">for</span>(g[<span class="number">0</span>]=i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">1</span>; f[j]&lt;=i; j++)</span><br><span class="line">      <span class="keyword">if</span>((j+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>&amp;<span class="number">1</span>) g[i] = (g[i] + g[i-f[j]])%mod;</span><br><span class="line">      <span class="keyword">else</span> g[i] = (g[i]-g[i-f[j]]+mod)%mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (g[n]&lt;<span class="number">0</span>) ? g[n]+mod : g[n]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²ˆé˜³çš„Ié¢˜æ˜¯è¯¢é—®nä¸ªç‚¹æ·±åº¦ä¸è¶…è¿‡2çš„æ ‘çš„ä¸ªæ•°ï¼Œæ˜¾ç„¶æ˜¯ä¸ªn-1çš„æ•´æ•°æ‹†åˆ†ï¼Œç„¶è€Œ$n \leq 5\times10^5$</p><ol><li><p>$O(n\sqrt n)$å–æ¨¡ä¼˜åŒ–ï¼Œgæ•°ç»„å¼€æˆlonglongï¼Œè¿™æ ·å¯¹äº$g_i$â€‹åªè¦åœ¨æœ€åå–ä¸€æ¬¡æ¨¡å³å¯ï¼Œå› ä¸ºæœ€å¤šæ ¹å·æ¬¡åŠ æ³•æ‰€ä»¥ä¸ä¼šçˆ†longlongcachemissä¼˜åŒ–ï¼Œ$g_i$â€‹ç”¨å˜é‡xä»£æ›¿ï¼Œè¿™æ ·å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘cacheçš„misså¾ªç¯ä¼˜åŒ–ï¼Œå¤§åŠ›å¾ªç¯å±•å¼€ç„¶åå°±èƒ½è¿‡äº†</p></li><li><p>$O(n\log n)$æ›´å¿«ä¹Ÿæ›´ç®€å•ï¼Œåªéœ€è¦å¯¹$\phi$æ±‚ä¸ªé€†å³å¯</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³é¢å›¾</title>
      <link href="/2020/08/13/ping-mian-tu/"/>
      <url>/2020/08/13/ping-mian-tu/</url>
      
        <content type="html"><![CDATA[<h2 id="å®šä¹‰"><a class="header-anchor" href="#å®šä¹‰">Â¶</a>å®šä¹‰</h2><p>ç”»åœ¨å¹³é¢ä¸Šï¼Œä»»æ„ä¸¤æ¡è¾¹é™¤é¡¶ç‚¹å¤–æ— äº¤ç‚¹åŒ…å›´ä¸€ä¸ªé¢çš„è¾¹çš„æ¡æ•°ç§°ä¸ºè¯¥é¢çš„æ¬¡æ•°</p><h2 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h2><p>æ¬§æ‹‰å…¬å¼ï¼šn - m + r = 2ç‚¹æ•°-è¾¹æ•°+é¢æ•°=2ç‚¹æ•°$n \geq 3$çš„å¹³é¢å›¾çš„è¾¹æ•°$m \leq 3n-6$ (è¾¹æ•°æ˜¯çº¿æ€§çš„)</p><h2 id="å¯¹å¶å›¾"><a class="header-anchor" href="#å¯¹å¶å›¾">Â¶</a>å¯¹å¶å›¾</h2><p>æ¯ä¸ªé¢ä¸ºä¸€ä¸ªé¡¶ç‚¹ï¼Œå¯¹äºå¹³é¢å›¾ä¸Šçš„æ¯æ¡è¾¹ï¼ˆä¸€å®šåªä¸ä¸¤ä¸ªé¢ç›¸è¿ï¼‰ï¼Œç”¨è¾¹è¿æ¥è¿™ä¸¤ä¸ªé¢å¯¹åº”çš„é¡¶ç‚¹å¹³é¢å›¾æœ€å°å‰²=å¯¹å¶å›¾æœ€çŸ­è·¯ï¼ˆå¯¹å¶å›¾çš„è¾¹æƒç›¸å½“äºå‰²æ‰å¹³é¢å›¾ä¸€æ¡è¾¹çš„ä»£ä»·ï¼Œæ‰€ä»¥ç»´æŠ¤å¯¹å¶å›¾çš„è¿é€šæ€§ï¼Œç­‰ä»·äºç»´æŠ¤å¹³é¢å›¾çš„éè¿é€šæ€§ï¼‰Gçš„é¢æ•°ç­‰äºGçš„ç‚¹æ•°ï¼Œ Gä¸Gçš„è¾¹æ•°ç›¸åŒ(æ¯ä¸ªé¢ä¸ºä¸€ä¸ªç‚¹ï¼Œæ¯æ¡è¾¹ä¹Ÿå¯¹åº”äº†ä¸€æ¡è¾¹)</p><h2 id="P4001-ICPC-Beijing-2006-ç‹¼æŠ“å…”å­"><a class="header-anchor" href="#P4001-ICPC-Beijing-2006-ç‹¼æŠ“å…”å­">Â¶</a>P4001 [ICPC-Beijing 2006]ç‹¼æŠ“å…”å­</h2><p>æ±‚ç½‘æ ¼å›¾çš„æœ€å°å‰²ç½‘æ ¼å›¾æ˜¾ç„¶æ˜¯å¹³é¢å›¾ï¼Œè½¬æˆå¯¹å¶å›¾åè·‘æœ€çŸ­è·¯å³å¯<s>ç„¶åå¯¹å¶å›¾éš¾å»ºè¿˜æ¯”ç½‘ç»œæµæ…¢</s></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> ll LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T;</span><br><span class="line">vector&lt;pii&gt; G[<span class="number">2</span>*N*N];</span><br><span class="line">ll dis[<span class="number">2</span>*N*N];</span><br><span class="line"><span class="type">bool</span> vis[<span class="number">2</span>*N*N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, (T+<span class="number">1</span>)*<span class="built_in">sizeof</span>(ll));</span><br><span class="line">  <span class="built_in">memset</span>(vis, <span class="number">0</span>, (T+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">  dis[s] = <span class="number">0</span>;</span><br><span class="line">  priority_queue&lt;pli,vector&lt;pli&gt;,greater&lt;pli&gt;&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>, s));</span><br><span class="line">  <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">top</span>().se; q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">      <span class="keyword">if</span>(dis[v]&gt;dis[u]+w)</span><br><span class="line">      &#123;</span><br><span class="line">        dis[v] = dis[u] + w;</span><br><span class="line">        q.<span class="built_in">push</span>(<span class="built_in">mp</span>(dis[v], v));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  S = <span class="number">0</span>, T = (<span class="number">2</span>*n<span class="number">-2</span>)*(m<span class="number">-1</span>) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">auto</span> id = [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">0</span>||y==m) <span class="keyword">return</span> S;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">2</span>*n<span class="number">-1</span>||y==<span class="number">0</span>) <span class="keyword">return</span> T;</span><br><span class="line">    <span class="keyword">return</span> (x<span class="number">-1</span>)*(m<span class="number">-1</span>) + y;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = <span class="built_in">id</span>(<span class="number">2</span>*i<span class="number">-2</span>, j), v = <span class="built_in">id</span>(<span class="number">2</span>*i<span class="number">-1</span>, j), w; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">      G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = <span class="built_in">id</span>(<span class="number">2</span>*i<span class="number">-1</span>, j<span class="number">-1</span>), v = <span class="built_in">id</span>(<span class="number">2</span>*i, j), w; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">      G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = <span class="built_in">id</span>(<span class="number">2</span>*i<span class="number">-1</span>, j), v = <span class="built_in">id</span>(<span class="number">2</span>*i, j), w; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">      G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="built_in">Dijkstra</span>(S);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, dis[T]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç‰›å®¢å¤šæ ¡2-Interval"><a class="header-anchor" href="#ç‰›å®¢å¤šæ ¡2-Interval">Â¶</a>ç‰›å®¢å¤šæ ¡2 Interval</h2><p>åˆå§‹æœ‰ä¸€ä¸ªåŒºé—´$[1,n]$å¯¹äºä¸€ä¸ªåŒºé—´$[l,r]$(l&lt;r)ï¼Œå¯ä»¥å˜æ¢æˆ$[l+1,r]$,$[l,r-1]$,$[lâˆ’1,r]$,$[l,r+1]$ç°åœ¨ç»™å®šmç§æ–¹å¼ï¼Œå¯ä»¥èŠ±è´¹ä¸€å®šçš„ä»£ä»·é™åˆ¶æŸç§å˜æ¢ï¼Œé—®æœ€å°‘èŠ±è´¹å¤šå°‘ä»£ä»·ä½¿å¾—åŒºé—´$[1,n]$æ— æ³•å˜æ¢æˆé•¿åº¦ä¸º1çš„åŒºé—´$n \leq 500$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è€ƒè™‘ç½‘ç»œæµæœ€å°å‰²å»ºå›¾ï¼Œå¯¹æ¯ä¸ªåŒºé—´å»ºä¸€ä¸ªç‚¹ï¼Œæ¯ç§å˜æ¢è¿è¾¹æµé‡ä¸ºINFï¼Œå¦‚æœæŸç§å˜æ¢è¢«é™åˆ¶ï¼Œåˆ™è¿è¾¹æµé‡ä¸ºcostï¼Œè¡¨ç¤ºå‰²æ‰è¿™æ¡è¾¹çš„ä»£ä»·ã€‚ç‚¹æ•°æ˜¯$n^2$,è¾¹æ•°ä¹Ÿæ˜¯$n^2$çš„å‘ç°è¿™æ˜¯ä¸€ä¸ªå¹³é¢å›¾ï¼Œæ‰€ä»¥è½¬æˆå¯¹å¶å›¾è·‘æœ€çŸ­è·¯å°±å¯ä»¥äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pil = pair&lt;<span class="type">int</span>,ll&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">505</span>;</span><br><span class="line"><span class="keyword">constexpr</span> ll LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T, idx[N][N], tot;</span><br><span class="line">ll dis[N*N];</span><br><span class="line"><span class="type">bool</span> vis[N*N];</span><br><span class="line">vector&lt;pil&gt; G[N*N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, ll w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  G[u].<span class="built_in">emplace_back</span>(v, w);</span><br><span class="line">  G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, (tot+<span class="number">1</span>)*<span class="built_in">sizeof</span>(ll));</span><br><span class="line">  <span class="built_in">memset</span>(vis, <span class="number">0</span>, (tot+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">  dis[s] = <span class="number">0</span>;</span><br><span class="line">  priority_queue&lt;pli,vector&lt;pli&gt;,greater&lt;pli&gt;&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>, s));</span><br><span class="line">  <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">top</span>().se; q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> v = it.fi; ll w = it.se;</span><br><span class="line">      <span class="keyword">if</span>(dis[v]&gt;dis[u]+w)</span><br><span class="line">      &#123;</span><br><span class="line">        dis[v] = dis[u] + w;</span><br><span class="line">        q.<span class="built_in">push</span>(<span class="built_in">mp</span>(dis[v], v));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i; j&lt;n; j++)</span><br><span class="line">      idx[i][j] = ++tot;</span><br><span class="line">  S = <span class="number">0</span>; T = ++tot;</span><br><span class="line">  <span class="keyword">auto</span> id = [&amp;](<span class="type">int</span> x, <span class="type">int</span> y)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">0</span>) <span class="keyword">return</span> S;</span><br><span class="line">    <span class="keyword">if</span>(y==n) <span class="keyword">return</span> T;</span><br><span class="line">    <span class="keyword">return</span> idx[x][y];</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i; j&lt;n; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">addedge</span>(<span class="built_in">id</span>(i<span class="number">-1</span>, j), <span class="built_in">id</span>(i, j), LINF);</span><br><span class="line">      <span class="built_in">addedge</span>(<span class="built_in">id</span>(i, j), <span class="built_in">id</span>(i, j+<span class="number">1</span>), LINF);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">addedge</span>(<span class="built_in">id</span>(i, i), <span class="built_in">id</span>(i<span class="number">-1</span>, i<span class="number">-1</span>), LINF);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, c;</span><br><span class="line">    <span class="type">char</span> dir;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; r &gt;&gt; dir &gt;&gt; c;</span><br><span class="line">    <span class="keyword">if</span>(dir==<span class="string">&#x27;L&#x27;</span>) <span class="built_in">addedge</span>(<span class="built_in">id</span>(l, r<span class="number">-1</span>), <span class="built_in">id</span>(l, r), c);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">addedge</span>(<span class="built_in">id</span>(l<span class="number">-1</span>, r<span class="number">-1</span>), <span class="built_in">id</span>(l, r<span class="number">-1</span>), c);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">Dijkstra</span>(S);</span><br><span class="line">  cout &lt;&lt; (dis[T]&gt;=LINF ? <span class="number">-1</span> : dis[T]) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ€§è§„åˆ’ å•çº¯å‹ç®—æ³•</title>
      <link href="/2020/08/11/xian-xing-gui-hua-dan-chun-xing-suan-fa/"/>
      <url>/2020/08/11/xian-xing-gui-hua-dan-chun-xing-suan-fa/</url>
      
        <content type="html"><![CDATA[<p>nä¸ªå˜é‡$x_1,â€¦,x_n$â€‹ï¼Œmä¸ªçº¿æ€§çº¦æŸï¼Œå½¢å¦‚$\sum \limits_{i=1}^na_{ij}x_i \leq b_j$â€‹,è¦æ±‚ç¡®å®šè¿™nä¸ªå˜é‡çš„å€¼ï¼Œ$\max z =\sum\limits_{i=1}^n c_ix_i$å•çº¯å‹å¯ä»¥è¢«å¡åˆ°æŒ‡æ•°çº§ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹é€Ÿåº¦è¾ƒå¿«ï¼Œç›¸æ¯”äºMCMFï¼Œä»£ç æ›´çŸ­ï¼Œè€Œä¸”æ›´ç›´è§‚ä»¥ä¸‹ç”¨çŸ©é˜µå½¢å¼è¡¨è¾¾ï¼ˆè§„å®šå°å†™ä¸ºåˆ—å‘é‡ï¼Œå¤§å†™ä¸ºçŸ©é˜µï¼‰</p><h3 id="æ ‡å‡†å½¢å¼"><a class="header-anchor" href="#æ ‡å‡†å½¢å¼">Â¶</a>æ ‡å‡†å½¢å¼</h3><p>æœ€å¤§åŒ–$c^Tx$ï¼Œæ»¡è¶³çº¦æŸ$Ax\leq b,x_i \geq 0$</p><h3 id="æ¾å¼›å½¢å¼"><a class="header-anchor" href="#æ¾å¼›å½¢å¼">Â¶</a>æ¾å¼›å½¢å¼</h3><p>æœ€å¤§åŒ–$c^Tx$ï¼Œæ»¡è¶³çº¦æŸ$Ax=b,x_i \geq 0$åªè¦å¯¹æ¯ä¸ªæ ‡å‡†å½¢å¼çš„çº¦æŸæ¡ä»¶å¢åŠ ä¸€ä¸ªå˜é‡$x_{n+i} \geq 0$å³å¯</p><h3 id="å¯¹å¶é—®é¢˜"><a class="header-anchor" href="#å¯¹å¶é—®é¢˜">Â¶</a>å¯¹å¶é—®é¢˜</h3><p>æœ€å°åŒ–$b^Tx$ï¼Œæ»¡è¶³çº¦æŸ$A^Tx \leq c,x_i \geq 0$ç›®æ ‡å‡½æ•°çš„ç³»æ•°cä¸çº¦æŸæ¡ä»¶å³è¾¹çš„ç³»æ•°bäº¤æ¢ï¼Œå¹¶å°†çº¦æŸç³»æ•°çŸ©é˜µè½¬ç½®ï¼Œæœ€å¤§åŒ–ä¸æœ€å°åŒ–äº’æ¢ï¼Œæ”¹å˜ä¸ç­‰å¼å·</p><p>$a_{00}=-z,a_{0i}=c_i,a_{i0}=b_i$mè¡Œnåˆ—ï¼Œè¡¨ç¤ºnä¸ªå˜é‡ï¼Œmä¸ªçº¦æŸï¼Œå•çº¯å‹ä½¿ç”¨çš„æ˜¯æ¾å¼›å½¢å¼ï¼Œåªä¸è¿‡æ²¡æœ‰æ˜¾ç¤ºè¡¨ç¤ºå‡ºæ¥å½“çº¦æŸç³»æ•°$a_{ij}$â€‹ä¸º0ï¼Œ1ï¼Œ-1ï¼ˆå…¨å¹ºæ¨¡çŸ©é˜µï¼‰æ—¶ç”¨ä»¥ä¸‹ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> a[N][M], q[M];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cal</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  a[l][e] = <span class="number">1</span>; <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;=n; j++) <span class="keyword">if</span>(a[l][j]) q[++p] = j;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, t=<span class="number">0</span>; i&lt;=m; i++)</span><br><span class="line">    <span class="keyword">if</span>(i!=l &amp;&amp; (t=a[i][e]))</span><br><span class="line">    &#123;</span><br><span class="line">      a[i][e] = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=p; j++) a[i][q[j]] -= t*a[l][q[j]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, e = <span class="number">0</span>, mn = INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      <span class="keyword">if</span>(a[<span class="number">0</span>][j]&gt;<span class="number">0</span>) &#123; e = j; <span class="keyword">break</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span>(!e) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">      <span class="keyword">if</span>(a[i][e]&gt;<span class="number">0</span> &amp;&amp; a[i][<span class="number">0</span>]&lt;mn) mn = a[i][<span class="number">0</span>], l = i;</span><br><span class="line">    <span class="built_in">assert</span>(l);</span><br><span class="line">    <span class="built_in">cal</span>(l, e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> -a[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŸé—®é¢˜æˆ–è€…å¯¹å¶é—®é¢˜ä¸­è‡³å°‘æœ‰ä¸€ä¸ªé›¶è§£æ˜¯å¯è¡Œè§£ï¼Œæ‰€ä»¥ä¸éœ€è¦initï¼Œå¦åˆ™éœ€è¦å…ˆé€šè¿‡initæ‰¾åˆ°ä¸€ç»„åˆå§‹è§£ï¼Œå†è¿›è¡Œsimplexä¼˜åŒ–</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-8</span>, INF = <span class="number">1e15</span>;</span><br><span class="line"><span class="type">int</span> n, m, type, id[M*<span class="number">2</span>], q[M];</span><br><span class="line"><span class="type">double</span> a[N][M], ans[M];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pivot</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">swap</span>(id[l+n], id[e]);</span><br><span class="line">  <span class="type">double</span> t = a[l][e]; a[l][e] = <span class="number">1.0</span>; <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;=n; j++) a[l][j] /= t;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;=n; j++) <span class="keyword">if</span>(<span class="built_in">fabs</span>(a[l][j])&gt;eps) q[++p] = j;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=m; i++)</span><br><span class="line">    <span class="keyword">if</span>(i!=l &amp;&amp; <span class="built_in">fabs</span>(a[i][e])&gt;eps)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">double</span> t = a[i][e]; a[i][e] = <span class="number">0.0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=p; j++) a[i][q[j]] -= t*a[l][q[j]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">      <span class="keyword">if</span>(a[i][<span class="number">0</span>]&lt;-eps &amp;&amp; (!l || (<span class="built_in">rand</span>()&amp;<span class="number">1</span>))) l = i;</span><br><span class="line">    <span class="keyword">if</span>(!l) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      <span class="keyword">if</span>(a[l][j]&lt;-eps &amp;&amp; (!e || (<span class="built_in">rand</span>()&amp;<span class="number">1</span>))) e = j;</span><br><span class="line">    <span class="keyword">if</span>(!e) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Infeasible&quot;</span>), <span class="literal">false</span>; <span class="comment">//æ— è§£</span></span><br><span class="line">    <span class="built_in">pivot</span>(l, e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">simplex</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, e = <span class="number">0</span>; <span class="type">double</span> w = eps;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++) <span class="comment">//é€‰æ‹©æœ€å¤§çš„é‚£ä¸ªï¼ˆæ›´å¿«æ‰¾åˆ°æœ€ä¼˜è§£ï¼‰ï¼Œæˆ–è€…é€‰æ‹©ç¬¬ä¸€ä¸ªå¤§äº0çš„ï¼ˆå¯ä»¥é˜²æ­¢æ­»å¾ªç¯ï¼‰</span></span><br><span class="line">      <span class="keyword">if</span>(a[<span class="number">0</span>][j]&gt;w) w = a[<span class="number">0</span>][j], e = j;</span><br><span class="line">    <span class="keyword">if</span>(!e) <span class="keyword">break</span>;</span><br><span class="line">    w = INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">      <span class="keyword">if</span>(a[i][e]&gt;eps &amp;&amp; a[i][<span class="number">0</span>]/a[i][e]&lt;w)</span><br><span class="line">        w = a[i][<span class="number">0</span>]/a[i][e], l = i;</span><br><span class="line">    <span class="keyword">if</span>(!l) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Unbounded&quot;</span>), <span class="literal">false</span>;<span class="comment">//è§£æ— ç•Œ</span></span><br><span class="line">    <span class="built_in">pivot</span>(l, e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">iota</span>(id+<span class="number">1</span>, id+n+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">init</span>() &amp;&amp; <span class="built_in">simplex</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.8f\n&quot;</span>, -a[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) ans[id[n+i]] = a[i][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span>(type) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.8f &quot;</span>, ans[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¿æ€§è§„åˆ’è½¬è´¹ç”¨æµï¼šåˆ—å‡ºæ ‡å‡†å½¢å¼ï¼Œæ·»åŠ æ¾å¼›å˜é‡è½¬åŒ–ä¸ºæ¾å¼›å‹æ¯ä¸ªå¼å­ä¸å‰ä¸€ä¸ªå¼å­ç›¸å‡ï¼Œå¦‚æœæ¯ä¸ªå˜é‡åªå‡ºç°ä¸¤æ¬¡ï¼Œä¸”ç³»æ•°ä¸€æ­£ä¸€è´Ÿï¼Œå°±å¯ä»¥è½¬åŒ–ä¸ºè´¹ç”¨æµå¯¹äºæ¯ä¸ªç­‰å¼æ–°å»ºä¸€ä¸ªç‚¹ï¼Œå¦‚æœç­‰å¼ä¸­å³è¾¹å¸¸æ•°bä¸ºæ­£æ•°ï¼Œä»æºç‚¹så‘è¯¥ç‚¹è¿è¾¹ï¼ˆb,0ï¼‰ï¼Œå¦åˆ™è¯¥ç‚¹å‘æ±‡ç‚¹è¿è¾¹ï¼ˆ-b,0ï¼‰ã€‚å¯¹æ¯ä¸ªå˜é‡ï¼ˆåŒ…æ‹¬æ·»åŠ çš„ç”¨æ¥æ¾å¼›çš„å˜é‡ï¼‰ä»å®ƒç³»æ•°ä¸ºæ­£çš„ç­‰å¼ä»£è¡¨çš„ç‚¹å‘å®ƒç³»æ•°ä¸ºè´Ÿçš„ç­‰å¼ä»£è¡¨çš„ç‚¹è¿è¾¹ï¼ˆINFï¼Œcï¼‰ï¼Œcä¸ºç›®æ ‡å‡½æ•°ä¸­çš„ç³»æ•°</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†æ•£å±‚å ç®—æ³•(Fractional Cascading)</title>
      <link href="/2020/08/07/fen-san-ceng-die-suan-fa-fractional-cascading/"/>
      <url>/2020/08/07/fen-san-ceng-die-suan-fa-fractional-cascading/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®škä¸ªé•¿åº¦ä¸ºnæœ‰åºæ•°ç»„Lï¼Œè¦æ±‚<strong>åœ¨çº¿</strong>qæ¬¡å›ç­”æ¯ä¸ªæ•°ç»„ä¸­$\geq x$çš„æœ€å°çš„æ•°$k\leq 100,n\leq 10^4, q\leq 3\times 10^5$ç¦»çº¿çš„è¯å¯ä»¥æ•´ä½“äºŒåˆ†åœ¨çº¿ç”¨è¯¥ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º$O(k+\log n)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º$O(n)$ç”¨ä¸€ä¸ª$k\times n$çš„äºŒç»´æ•°ç»„Mï¼ŒM[i]çš„æ¯ä¸€ä½è®°å½•ä¸‰ä¸ªä¿¡æ¯ï¼Œï½›é”®å€¼ï¼Œåœ¨L[i]ä¸­åç»§çš„ä½ç½®ï¼Œåœ¨M[i+1]ä¸­åç»§çš„ä½ç½®ï½è€ƒè™‘ä»åå¾€å‰æ„é€ ï¼ŒM[k]=L[k]ç”±äºæ˜¯æœ‰åºçš„ï¼Œåˆ©ç”¨å½’å¹¶$O(n)$åˆå¹¶L[i]å’ŒM[i+1]ï¼Œæ³¨æ„å¯¹äºM[i+1]åªåˆå¹¶å¶æ•°ä½ç½®ï¼ˆèŠ‚çœç©ºé—´ï¼‰å¯¹äºæŸ¥è¯¢ï¼Œå…ˆåˆ©ç”¨ä¸€æ¬¡äºŒåˆ†åœ¨M[1]ä¸­æ‰¾åˆ°åç»§çš„ä½ç½®ï¼Œæ­¤æ—¶è¯¥ä½çš„ç¬¬äºŒä¸ªä¿¡æ¯å°±è¡¨ç¤ºäº†åœ¨L[1]æ•°ç»„ä¸­çš„ç­”æ¡ˆï¼Œè€Œè¯¥ä½çš„ç¬¬ä¸‰ä¸ªä¿¡æ¯è¡¨ç¤ºäº†åœ¨M[2]ä¸­åç»§çš„ä½ç½®ï¼Œæ³¨æ„ç”±äºæ˜¯é—´éš”æ’å…¥ï¼Œæ‰€ä»¥éœ€è¦å’Œè¯¥ä½ç½®çš„å‰ä¸€ä¸ªä½ç½®å–ä¼˜ã€‚è¿™æ ·åªéœ€è¦ä¸€æ¬¡äºŒåˆ†ï¼Œç„¶åå„æ•°ç»„é—´åˆ©ç”¨ä¿å­˜çš„ä¿¡æ¯ï¼ˆæŒ‡é’ˆï¼‰å¯ä»¥$O(1)$è½¬ç§»</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n, k, q, d;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;k, &amp;q, &amp;d);</span><br><span class="line">  vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">L</span>(k, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n));</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;n; j++)</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;L[i][j]);</span><br><span class="line">  vector&lt;vector&lt;pair&lt;<span class="type">int</span>,pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt;&gt; <span class="built_in">M</span>(k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    M[k<span class="number">-1</span>].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(L[k<span class="number">-1</span>][i], <span class="built_in">mp</span>(i, <span class="number">0</span>)));</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=k<span class="number">-2</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>, b = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(a&lt;n &amp;&amp; b&lt;<span class="built_in">sz</span>(M[i+<span class="number">1</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(L[i][a]&lt;=M[i+<span class="number">1</span>][b].first) M[i].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(L[i][a], <span class="built_in">mp</span>(a, b))), a++;</span><br><span class="line">      <span class="keyword">else</span> M[i].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(M[i+<span class="number">1</span>][b].first, <span class="built_in">mp</span>(a, b))), b += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(a&lt;n) M[i].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(L[i][a], <span class="built_in">mp</span>(a, b))), a++;</span><br><span class="line">    <span class="keyword">while</span>(b&lt;<span class="built_in">sz</span>(M[i+<span class="number">1</span>])) M[i].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(M[i+<span class="number">1</span>][b].first, <span class="built_in">mp</span>(a, b))), b += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> lstans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> _=<span class="number">1</span>; _&lt;=q; _++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">    x ^= lstans;</span><br><span class="line">    <span class="type">int</span> p = <span class="built_in">lower_bound</span>(M[<span class="number">0</span>].<span class="built_in">begin</span>(), M[<span class="number">0</span>].<span class="built_in">end</span>(), <span class="built_in">mp</span>(x, <span class="built_in">mp</span>(<span class="number">0</span>, <span class="number">0</span>))) - M[<span class="number">0</span>].<span class="built_in">begin</span>();</span><br><span class="line">    <span class="type">int</span> curans = <span class="number">0</span>, idx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(idx&lt;k &amp;&amp; p&lt;<span class="built_in">sz</span>(M[idx]))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(M[idx][p].second.first&lt;n) curans ^= L[idx][M[idx][p].second.first];</span><br><span class="line">      <span class="keyword">if</span>(idx&lt;k<span class="number">-1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> nxtp = M[idx][p].second.second;</span><br><span class="line">        <span class="keyword">if</span>(nxtp<span class="number">-1</span>&lt;<span class="built_in">sz</span>(M[idx+<span class="number">1</span>]) &amp;&amp; M[idx+<span class="number">1</span>][nxtp<span class="number">-1</span>].first&gt;=x) --nxtp;</span><br><span class="line">        p = nxtp;</span><br><span class="line">      &#125;</span><br><span class="line">      ++idx;</span><br><span class="line">    &#125;</span><br><span class="line">    lstans = curans;</span><br><span class="line">    <span class="keyword">if</span>(_%d==<span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, curans);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kosarajuæ±‚å¼ºè¿é€šåˆ†é‡</title>
      <link href="/2020/08/07/kosaraju-qiu-qiang-lian-tong-fen-liang/"/>
      <url>/2020/08/07/kosaraju-qiu-qiang-lian-tong-fen-liang/</url>
      
        <content type="html"><![CDATA[<p>åå›¾çš„å¼ºè¿é€šåˆ†é‡å’ŒåŸå›¾ç›¸åŒæŒ‰ç…§åå›¾çš„é€†ååºæ–¹å‘éå†åŸå›¾å³å¯é€†ååºæ–¹å‘ï¼šå…ˆéå†ä¸è¯¥ç‚¹ç›¸è¿çš„èŠ‚ç‚¹ï¼Œæœ€åå°†è¯¥ç‚¹å…¥æ ˆï¼Œæ ˆçš„ååºä¸ºé€†ååºåˆ©ç”¨bitsetå¯ä»¥ä¼˜åŒ–åˆ°$O(n^2/32)$ï¼Œé€‚åˆç¨ å¯†å›¾</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Kosaraju</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ord[N], tp, num[N], scc;</span><br><span class="line">  bitset&lt;N&gt; tag, G[N], rG[N], t;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) G[i].<span class="built_in">reset</span>(), rG[i].<span class="built_in">reset</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    tag[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t=rG[u]&amp;tag).<span class="built_in">any</span>())</span><br><span class="line">      <span class="built_in">dfs</span>(t._Find_first());</span><br><span class="line">    ord[++tp] = u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    num[u] = scc;</span><br><span class="line">    tag[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t=G[u]&amp;tag).<span class="built_in">any</span>())</span><br><span class="line">      <span class="built_in">dfs2</span>(t._Find_first());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">gao</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    tp = scc = <span class="number">0</span>;</span><br><span class="line">    tag.<span class="built_in">set</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span>(tag[i]) <span class="built_in">dfs</span>(i);</span><br><span class="line">    tag.<span class="built_in">set</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n; i&gt;=<span class="number">1</span>; i--)</span><br><span class="line">      <span class="keyword">if</span>(tag[ord[i]])</span><br><span class="line">      &#123;</span><br><span class="line">        ++scc;</span><br><span class="line">        <span class="built_in">dfs2</span>(ord[i]);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—…è¡Œ æœ‰å‘å›¾ä¸¤ç‚¹å¯è¾¾æ€§</title>
      <link href="/2020/08/06/lu-xing-you-xiang-tu-liang-dian-ke-da-xing/"/>
      <url>/2020/08/06/lu-xing-you-xiang-tu-liang-dian-ke-da-xing/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å‡ºä¸€å¼ éšæœºç”Ÿæˆçš„æœ‰å‘å›¾ï¼Œå¤šæ¬¡è¯¢é—®xç‚¹èƒ½å¦åˆ°è¾¾yç‚¹$n \leq 10^5,m \leq n + 5000,q \leq 3\times 10^5$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è·‘ä¸€étarjanç¼©ç‚¹æˆDAGè®¾ç½®æ ¹å·ä¸ªæ ‡è®°ç‚¹ï¼Œç„¶åæš´åŠ›è·‘å‡ºè¿™äº›æ ‡è®°ç‚¹èƒ½å¤Ÿåˆ°è¾¾çš„ç‚¹ï¼Œç”¨bitsetè®°å½•å¯¹äºæ¯ä¸ªè¯¢é—®ä»xæš´åŠ›dfsï¼Œé‡åˆ°æ ‡è®°ç‚¹åˆ™è¿”å›æ ‡è®°ç‚¹é€‰æ‹©åº¦æ•°æœ€å¤§çš„æ ¹å·ä¸ªå¤æ‚åº¦ï¼šO(èƒ½è¿‡)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, M = <span class="number">405</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N], DAG[N];</span><br><span class="line">vector&lt;pii&gt; edges;</span><br><span class="line"><span class="type">int</span> n, m, _;</span><br><span class="line"><span class="type">int</span> dfn[N], num[N], low[N], id, tot, sta[N], top, deg[N], idx[N];</span><br><span class="line"><span class="type">bool</span> in[N];</span><br><span class="line"><span class="type">int</span> vis[N], spe[N];</span><br><span class="line">bitset&lt;N&gt; bit[M];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  in[u] = <span class="number">1</span>;</span><br><span class="line">  low[u] = dfn[u] = ++id;</span><br><span class="line">  sta[++top] = u;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">tarjan</span>(v);</span><br><span class="line">      low[u] = <span class="built_in">min</span>(low[u],low[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(in[v]) low[u] = <span class="built_in">min</span>(low[u],dfn[v]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(low[u]==dfn[u])</span><br><span class="line">  &#123;</span><br><span class="line">    tot++;</span><br><span class="line">    <span class="keyword">while</span>(top)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> tmp = sta[top--];</span><br><span class="line">      in[tmp] = <span class="number">0</span>;</span><br><span class="line">      num[tmp] = tot;</span><br><span class="line">      <span class="keyword">if</span>(tmp==u) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(spe[u]) &#123; bit[t] |= bit[spe[u]]; <span class="keyword">return</span>; &#125;</span><br><span class="line">  vis[u] = t;</span><br><span class="line">  bit[t].<span class="built_in">set</span>(u);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : DAG[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[v]==t) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, t);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prework</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span>(!dfn[i]) <span class="built_in">tarjan</span>(i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : edges)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = num[it.fi], v = num[it.se];</span><br><span class="line">    <span class="keyword">if</span>(u!=v) DAG[u].<span class="built_in">pb</span>(v), deg[u]++, deg[v]++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> lim = (<span class="type">int</span>)<span class="built_in">sqrt</span>(tot) + <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">iota</span>(idx+<span class="number">1</span>, idx+tot+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">sort</span>(idx+<span class="number">1</span>, idx+tot+<span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">    <span class="keyword">return</span> deg[x] &gt; deg[y];</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lim; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">dfs</span>(idx[i], i);</span><br><span class="line">    spe[idx[i]] = i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t, <span class="type">int</span> tt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(s==t) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(spe[s]) <span class="keyword">return</span> bit[spe[s]].<span class="built_in">test</span>(t);</span><br><span class="line">  vis[s] = tt;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> ss : DAG[s])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[ss]==tt) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">dfs2</span>(ss, t, tt)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> u, v;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">  ++u, ++v;</span><br><span class="line">  <span class="keyword">if</span>(num[u]==num[v]) <span class="built_in">puts</span>(<span class="string">&quot;Good&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">puts</span>((<span class="built_in">dfs2</span>(num[u], num[v], t) ? <span class="string">&quot;Good&quot;</span> : <span class="string">&quot;Bad&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    ++u, ++v;</span><br><span class="line">    G[u].<span class="built_in">pb</span>(v);</span><br><span class="line">    edges.<span class="built_in">emplace_back</span>(u, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">prework</span>();</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=_; i++) <span class="built_in">solve</span>(<span class="number">400</span>+i);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‹¬å·åºåˆ—é—®é¢˜</title>
      <link href="/2020/07/30/gua-hao-xu-lie-wen-ti/"/>
      <url>/2020/07/30/gua-hao-xu-lie-wen-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰ç½®ç»“è®º"><a class="header-anchor" href="#å‰ç½®ç»“è®º">Â¶</a>å‰ç½®ç»“è®º</h2><p>å®šä¹‰å·¦æ‹¬å·â€™(â€˜ä¸º+1ï¼Œå³æ‹¬å·â€™)'ä¸º-1ï¼Œä½œå‰ç¼€å’Œå¾—åˆ°ä¸€ä¸ªåºåˆ—på½“ä¸”ä»…å½“$p_n = 0 \wedge \forall i \ p_i &gt;=0$æ—¶ï¼Œè¯¥æ‹¬å·åºåˆ—åˆæ³•</p><p>å–$mn = \min_{i=1}^n p_i$â€‹ï¼Œåˆ™è¯¥æ‹¬å·åºåˆ—çš„æœ€é•¿åˆæ³•æ‹¬å·å­åºåˆ—çš„é•¿åº¦ä¸º$n - p_n + 2mn$è€ƒè™‘ä½ç½®posï¼Œå…¶ä¸­$p_{pos}=mn$ï¼Œåˆ™åœ¨$1â€¦pos$ä¸­ï¼Œæœ‰-mnä¸ªå³æ‹¬å·å¤±é…ï¼Œåœ¨$pos+1â€¦n$ä¸­æœ‰$p_n-mn$ä¸ªå·¦æ‹¬å·å¤±é…</p><p>ä¸€ä¸ªé•¿åº¦ä¸ºnï¼Œå³æ‹¬å·ä¸ªæ•°ä¸ºmï¼Œå¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼ä¸ºtçš„æ‹¬å·åºåˆ—çš„ä¸ªæ•°æœ‰$\binom{n}{n-m-t} - \binom{n}{n-m-t+1}$å…ˆè€ƒè™‘å¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼ä¸å°äºtçš„æ–¹æ¡ˆæ•°ï¼šåˆ©ç”¨è®¡ç®—å¡ç‰¹å…°æ•°çš„æ–¹æ³•ï¼Œæ‰€æœ‰å‡å»ä¸åˆæ³•ã€‚å…¶ä¸­æ‰€æœ‰å³$\binom{n}{m}$ã€‚ä¸åˆæ³•çš„å³åºåˆ—pçš„æœ€å°å€¼æ˜¯&lt;=t-1çš„ï¼Œè€ƒè™‘ä½ç½®posï¼Œå…¶ä¸­$p_{pos}=t-1$ï¼Œåˆ™åœ¨$1â€¦pos$ä¸­å·¦æ‹¬å·æ¯”å³æ‹¬å·å°‘$âˆ’(tâˆ’1)$ä¸ªï¼Œ$pos+1â€¦n$ä¸­å·¦æ‹¬å·æ¯”å³æ‹¬å·å¤š$nâˆ’2mâˆ’(tâˆ’1)$ï¼Œå°†$1â€¦pos$çš„å·¦å³æ‹¬å·ç¿»è½¬ï¼Œåˆ™$1â€¦n$ä¸­å·¦æ‹¬å·æ¯”å³æ‹¬å·å¤š$nâˆ’2mâˆ’2(tâˆ’1)$ä¸ªï¼Œå®¹æ˜“å‘ç°ä¸åˆæ³•çš„æ‹¬å·åºåˆ—ä¸å·¦æ‹¬å·æ¯”å³æ‹¬å·å¤š$nâˆ’2mâˆ’2(tâˆ’1)$ä¸ªçš„æ‹¬å·åºåˆ—ä¸€ä¸€å¯¹åº”ï¼Œæ‰€ä»¥ä¸åˆæ³•å³ä¸º$\binom{n}{n-m-t+1}$é‚£ä¹ˆå¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼ä¸å°äºt+1çš„æ–¹æ¡ˆæ•°ä¸º$\binom{n}{m} - \binom{n}{n-m-t}$åˆ™å¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼ä¸ºtçš„æ–¹æ¡ˆæ•°ä¸º$\binom{n}{n-m-t} - \binom{n}{n-m-t+1}$</p><p>ä¸€ä¸ªæ‹¬å·åºåˆ—å¾ªç¯ç§»ä½ååˆæ³•çš„æ–¹æ¡ˆæ•°ï¼š</p><ul><li>è‹¥å·¦æ‹¬å·æ•°ä¸ç­‰äºå³æ‹¬å·æ•°ï¼Œæ˜¾ç„¶æ— è§£</li><li>ans = pä¸­æœ€å°å€¼å‡ºç°çš„æ¬¡æ•°ï¼Œè‹¥$p_{pos} = mn$ï¼Œåˆ™å°†$1â€¦pos$ç§»åˆ°åé¢ï¼Œ$pos+1â€¦n$ç§»åˆ°å‰é¢åˆ™åˆæ³•</li></ul><h2 id="æ´›è°·p6689-åºåˆ—"><a class="header-anchor" href="#æ´›è°·p6689-åºåˆ—">Â¶</a>æ´›è°·p6689 åºåˆ—</h2><h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ä¸€ä¸ªé•¿åº¦ä¸ºnï¼Œåˆå§‹å…¨ä¸ºâ€™(â€˜çš„æ‹¬å·åºåˆ—ï¼Œç»™å®šå‚æ•°kï¼Œæ¯æ¬¡éšæœºåœ¨[1,n]é€‰æ‹©ä¸€ä¸ªä½ç½®ç„¶åç¿»è½¬è¯¥ä½ç½®çš„æ‹¬å·ï¼Œå½“ç¿»è½¬äº†ä¸€ä¸ªâ€™('ï¼Œå°±è®©k-1ï¼Œé‡å¤ç›´è‡³k=0ã€‚è¯¢é—®æœ€åç”Ÿæˆçš„æ‹¬å·åºåˆ—çš„æœ€é•¿åˆæ³•å­åºåˆ—çš„æœŸæœ›é•¿åº¦$n, k&lt;=5\times 10^3$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>çŸ¥é“ä¸€ä¸ªæ‹¬å·åºåˆ—çš„å·¦å³æ‹¬å·çš„ä¸ªæ•°ä»¥åŠå…¶å¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼å°±å¯ä»¥å¾—åˆ°è¯¥æ‹¬å·åºåˆ—çš„æœ€é•¿åˆæ³•å­åºåˆ—çš„é•¿åº¦ã€‚å…ˆæ±‚å‡ºé•¿åº¦ä¸ºnçš„æ‹¬å·åºåˆ—ä¸­æœ‰mä¸ªå³æ‹¬å·çš„æ¦‚ç‡ï¼Œå†æšä¸¾åºåˆ—pçš„æœ€å°å€¼å³å¯è§£å†³ï¼Œè¿™æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„é—®é¢˜ã€‚é¦–å…ˆæ¦‚ç‡dpï¼š$f_{ij}$è¡¨ç¤ºå½“å‰å‚æ•°ä¸ºiï¼Œå·²ç»æœ‰jä¸ªå³æ‹¬å·çš„æ¦‚ç‡$f_{ij} = \dfrac{n-j+1}{n}\sum_{k=j-1}^{n} f_{ik}\prod_{l=j}^{k}\dfrac{l}{n}$$f_{ij}$â€‹å¯ä»¥ç”±$j-1â€¦n$ä¸ªå³æ‹¬å·çš„æƒ…å†µè½¬ç§»è¿‡æ¥ï¼Œç›¸å½“äºå…ˆè¿ç»­å°†xä¸ªå³æ‹¬å·å˜æˆå·¦æ‹¬å·ï¼Œç„¶åå†å°†1ä¸ªå·¦æ‹¬å·å˜æˆå³æ‹¬å·$\dfrac{f_{0m}}{\binom{n}{m}}$â€‹â€‹å°±ç­‰äºç”Ÿæˆä¸€ä¸ªæœ‰mä¸ªå³æ‹¬å·çš„æ‹¬å·åºåˆ—çš„æ¦‚ç‡æœ€åæšä¸¾è¿™ä¸ªæ‹¬å·åºåˆ—çš„æœ€å°å€¼ï¼Œç„¶åä¾æ®ä¸Šé¢çš„å…¬å¼è®¡ç®—å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, N = <span class="number">5e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a = <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) <span class="keyword">return</span> a-mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) a+=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) <span class="keyword">return</span> a+mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="type">int</span> n, k, f[N][N], fac[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) <span class="built_in">mul</span>(ans, a);</span><br><span class="line">    <span class="built_in">mul</span>(a, a);</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  inv[n] = <span class="built_in">powmod</span>(fac[n], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--) inv[i] = <span class="number">1ll</span>*inv[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a&lt;b||b&lt;<span class="number">0</span>||a&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*fac[a]*inv[b]%mod*inv[a-b]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  <span class="type">int</span> invn = <span class="built_in">powmod</span>(n, mod<span class="number">-2</span>);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">init</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> sum = f[i<span class="number">-1</span>][n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=n; j&gt;=<span class="number">1</span>; j--)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">mul</span>(sum, <span class="built_in">Mul</span>(j, invn));</span><br><span class="line">      <span class="built_in">add</span>(sum, f[i<span class="number">-1</span>][j<span class="number">-1</span>]);</span><br><span class="line">      f[i][j] = <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(invn, (n-j+<span class="number">1</span>)), sum);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">mul</span>(f[k][i], <span class="built_in">powmod</span>(<span class="built_in">comb</span>(n, i), mod<span class="number">-2</span>));</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">auto</span> cal = [](<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)-&gt;<span class="type">int</span> <span class="comment">//é•¿åº¦ä¸ºxçš„æ‹¬å·åºåˆ—ï¼Œæœ‰yä¸ªå³æ‹¬å·ï¼Œå¯¹åº”åºåˆ—pçš„æœ€å°å€¼ä¸ºzçš„æ–¹æ¡ˆæ•°</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Sub</span>(<span class="built_in">comb</span>(x, x-y-z), <span class="built_in">comb</span>(x, x-y-z+<span class="number">1</span>));</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="comment">//æšä¸¾å³æ‹¬å·ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">2</span>; j&lt;=n&amp;&amp;<span class="built_in">min</span>(i, n-i)&gt;=j/<span class="number">2</span>; j+=<span class="number">2</span>) <span class="comment">//æšä¸¾æœ€é•¿åˆæ³•å­åºåˆ—çš„é•¿åº¦ä¸ºjï¼Œåˆ™æ­¤æ—¶påºåˆ—çš„mn=(j-2i)/2</span></span><br><span class="line">      <span class="built_in">add</span>(ans, <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(j, f[k][i]), <span class="built_in">cal</span>(n, i, (j<span class="number">-2</span>*i)/<span class="number">2</span>)));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D2-The-World-Is-Just-a-Programming-Task-Hard-Version"><a class="header-anchor" href="#D2-The-World-Is-Just-a-Programming-Task-Hard-Version">Â¶</a>D2. The World Is Just a Programming Task (Hard Version)</h2><h3 id="é¢˜æ„-s2"><a class="header-anchor" href="#é¢˜æ„-s2">Â¶</a>é¢˜æ„</h3><p>ç»™å®šä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œè¦æ±‚äº¤æ¢å…¶ä¸­ä¸¤ä¸ªä½ç½®çš„æ‹¬å·ï¼Œä½¿å¾—è¯¥æ‹¬å·åºåˆ—å¾ªç¯ç§»ä½ååˆæ³•çš„æ–¹æ¡ˆæ•°æœ€å¤š$n&lt;=3\times 10^5$</p><h4 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h4><p>ç”±ä¸Šé¢ç»“è®ºå¯å¾—ï¼Œå°±æ˜¯è¦æœ€å¤§åŒ–è¯¥æ‹¬å·åºåˆ—å¯¹åº”çš„påºåˆ—çš„æœ€å°å€¼çš„ä¸ªæ•°æ˜¾ç„¶äº¤æ¢ä¸¤ä¸ªç›¸åŒçš„æ‹¬å·æ˜¯æ²¡æœ‰æ„ä¹‰çš„å½“äº¤æ¢ä¸€ä¸ªå·¦æ‹¬å·å’Œä¸€ä¸ªå³æ‹¬å·æ—¶ï¼Œç›¸å½“äºå¯¹è¿™æ®µåŒºé—´çš„påºåˆ—-2å½“äº¤æ¢ä¸€ä¸ªå³æ‹¬å·å’Œä¸€ä¸ªå·¦æ‹¬å·æ—¶ï¼Œç›¸å½“äºå¯¹è¿™æ®µåŒºé—´çš„påºåˆ—+2æ˜¾ç„¶åŒºé—´+2åªä¼šä½¿æœ€å°å€¼ä¸ªæ•°å‡å°‘ä¸‹é¢è€ƒè™‘åŒºé—´-2ï¼šå¦‚æœæ“ä½œçš„åŒºé—´ä¸­åŒ…å«äº†åŸæ¥æœ€å°å€¼çš„æŸä¸ªä½ç½®ï¼Œæ˜¾ç„¶ç­”æ¡ˆä¸ä¼šæ›´ä¼˜æ‰€ä»¥è®¾$pos_1,â€¦,pos_x$â€‹ä¸ºpåºåˆ—æœ€å°å€¼æ‰€å¤„çš„ä½ç½®ï¼Œé‚£ä¹ˆæ“ä½œçš„åŒºé—´åªå¯èƒ½æ˜¯$(pos1,pos2)â€¦$ï¼Œä¹Ÿå¯èƒ½æ˜¯$(pos_x,pos_1)$ï¼Œå‡†ç¡®æ¥è¯´æ˜¯å¯¹$[pos_1,pos_x]+2$ï¼Œç›¸å½“äºæ˜¯å¯¹$(posx,n]$ï¼Œ$[1,pos_1)-2(posxâ€‹,n]$ï¼Œ$[1,pos1â€‹)âˆ’2$æœ€ä¼˜çš„æƒ…å†µåªæœ‰ä¸¤ç§ï¼š</p><ul><li>è®©æœ€å°å€¼å˜æˆmn-1ï¼Œåªè¦ç»Ÿè®¡å‡ºä»¥ä¸ŠåŒºé—´ä¸­ç­‰äºmn+1çš„æœ€å¤šä¸ªæ•°å³å¯ï¼ˆæ˜¾ç„¶æ“ä½œåŒºé—´è¶Šå¤§è¶Šå¥½ï¼Œå³$[pos_i, pos_{i+1}]$ï¼‰</li><li>è®©æœ€å°å€¼ä»ä¸ºmnï¼Œéœ€è¦ç»Ÿè®¡å‡ºä»¥ä¸ŠåŒºé—´ä¸­è¿ç»­çš„ä¸”<strong>ä¸åŒ…å«mn+1</strong>çš„ç„¶åmn+2å€¼æœ€å¤šçš„ä¸ªæ•°ï¼Œè¿˜è¦å†åŠ ä¸ŠåŸæœ¬ç­‰äºmnçš„ä¸ªæ•°ï¼ˆåœ¨ä»¥ä¸Šæ¯ä¸ªæ“ä½œåŒºé—´ä¸­ä½œå°ºå–æ³•å³å¯ï¼Œé‡è§mn+1å°±è®©è®¡æ•°å™¨æ¸…ç©ºï¼Œå¦åˆ™ä¸æ–­å¾€å³ç§»åŠ¨ï¼‰ä»¥ä¸Šä¸¤è€…å–ä¼˜å³å¯</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, p[N];</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; (s+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) p[i] = (p[i<span class="number">-1</span>] + (s[i]==<span class="string">&#x27;(&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>));</span><br><span class="line">  <span class="keyword">if</span>(p[n]) &#123; cout &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="type">int</span> mn = *<span class="built_in">min_element</span>(p+<span class="number">1</span>, p+n+<span class="number">1</span>);</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span>(p[i]==mn) vec.<span class="built_in">pb</span>(i);</span><br><span class="line">  <span class="type">int</span> ans = <span class="built_in">sz</span>(vec);</span><br><span class="line">  pii pos = &#123;<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sz</span>(vec)<span class="number">-1</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = vec[i] + <span class="number">1</span>, k = vec[i+<span class="number">1</span>] - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(j&gt;k) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="type">int</span> one = <span class="number">0</span>, two = <span class="number">0</span>, tmp = <span class="number">0</span>, st = <span class="number">0</span>;</span><br><span class="line">    pii pp = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> _=j; _&lt;=k; _++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(p[_]==mn+<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        ++one;</span><br><span class="line">        tmp = st = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(p[_]==mn+<span class="number">2</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        ++tmp;</span><br><span class="line">        <span class="keyword">if</span>(!st) st = _;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(tmp&gt;two)</span><br><span class="line">      &#123;</span><br><span class="line">        two = tmp;</span><br><span class="line">        pp = &#123;st, _%n+<span class="number">1</span>&#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(one&gt;ans) ans = one, pos = &#123;j, k%n+<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span>(two+<span class="built_in">sz</span>(vec)&gt;ans) ans = two+<span class="built_in">sz</span>(vec), pos = pp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> one = <span class="number">0</span>, two = <span class="number">0</span>, tmp = <span class="number">0</span>, st = <span class="number">0</span>;</span><br><span class="line">  pii pp = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> _=vec.<span class="built_in">back</span>()%n+<span class="number">1</span>; _!=vec.<span class="built_in">front</span>(); _=_%n+<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p[_]==mn+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ++one;</span><br><span class="line">      tmp = st = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p[_]==mn+<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ++tmp;</span><br><span class="line">      <span class="keyword">if</span>(!st) st = _;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tmp&gt;two)</span><br><span class="line">    &#123;</span><br><span class="line">      two = tmp;</span><br><span class="line">      pp = &#123;st, _%n+<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(one&gt;ans) ans = one, pos = &#123;vec.<span class="built_in">back</span>()%n+<span class="number">1</span>, vec.<span class="built_in">front</span>()&#125;;</span><br><span class="line">  <span class="keyword">if</span>(two+<span class="built_in">sz</span>(vec)&gt;ans) ans = two+<span class="built_in">sz</span>(vec), pos = pp;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  cout &lt;&lt; pos.fi &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; pos.se &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ´›è°·7æœˆæœˆèµ›</title>
      <link href="/2020/07/27/luo-gu-7-yue-yue-sai/"/>
      <url>/2020/07/27/luo-gu-7-yue-yue-sai/</url>
      
        <content type="html"><![CDATA[<h2 id="P6685-å¯æŒä¹…åŒ–åŠ¨æ€ä»™äººæŒçš„ç›´å¾„é—®é¢˜"><a class="header-anchor" href="#P6685-å¯æŒä¹…åŒ–åŠ¨æ€ä»™äººæŒçš„ç›´å¾„é—®é¢˜">Â¶</a>P6685 å¯æŒä¹…åŒ–åŠ¨æ€ä»™äººæŒçš„ç›´å¾„é—®é¢˜</h2><h3 id="é¢˜ç›®"><a class="header-anchor" href="#é¢˜ç›®">Â¶</a>é¢˜ç›®</h3><p>ç»™å®šn, mï¼Œæ±‚æ»¡è¶³$x^m \leq n$çš„æ­£æ•´æ•°xä¸ªæ•°ï¼Œ$n\leq 10^9, m\leq 10^9$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><ul><li>m=1, ans = n</li><li>m&gt;=2æ—¶æ˜¾ç„¶ç­”æ¡ˆå¾ˆå°ï¼Œ <s>æ‰€ä»¥éšä¾¿æ€ä¹ˆæå°±è¡Œ</s> ï¼Œå¦‚æœäºŒåˆ†çš„è¯æ³¨æ„ä¸‹ç•Œä»2å¼€å§‹(å› ä¸ºè¿™ä¸ªtäº†å¥½å‡ å‘ğŸ‘€)</li></ul><h2 id="P6686-æ··å‡åœŸæ•°å­¦"><a class="header-anchor" href="#P6686-æ··å‡åœŸæ•°å­¦">Â¶</a>P6686 æ··å‡åœŸæ•°å­¦</h2><h3 id="é¢˜ç›®-s2"><a class="header-anchor" href="#é¢˜ç›®-s2">Â¶</a>é¢˜ç›®</h3><p>ç»™å®šnæ ¹æœ¨æ£çš„é•¿åº¦$a_i$â€‹ï¼Œæ±‚é€‰æ‹©ä¸‰æ ¹æ„æˆç­‰è…°ä¸‰è§’å½¢çš„æ–¹æ¡ˆæ•°(æ— åºå¯¹)</p><h3 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h3><p>æ˜¾ç„¶æ’åºåæšä¸¾è…°é•¿xç„¶åäºŒåˆ†$\lt 2x$çš„æ•°çš„ä¸ªæ•°å³å¯</p><h2 id="P6687-è®ºå¦‚ä½•ç©è½¬-Excel-è¡¨æ ¼"><a class="header-anchor" href="#P6687-è®ºå¦‚ä½•ç©è½¬-Excel-è¡¨æ ¼">Â¶</a>P6687 è®ºå¦‚ä½•ç©è½¬ Excel è¡¨æ ¼</h2><h3 id="é¢˜ç›®-s3"><a class="header-anchor" href="#é¢˜ç›®-s3">Â¶</a>é¢˜ç›®</h3><p>$2 \times n$çš„ç½‘æ ¼ï¼Œä¸é‡å¤çš„å¡«å…¥$1 \sim 2n$ï¼Œç°åœ¨æœ‰ä¸€ç§æ“ä½œï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©$2 \times 2$çš„æ­£æ–¹å½¢åŒºåŸŸç„¶åæ—‹è½¬$180^\circ$ï¼Œé—®ä»ç»™å®šç½‘æ ¼åˆ°ç›®æ ‡ç½‘æ ¼çš„æœ€å°‘æ“ä½œæ¬¡æ•°ï¼Œæˆ–è¾“å‡ºæ— è§£$n&lt;=10^6$</p><p>$$\begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix} \quad$$</p><p>$$\begin{bmatrix} 4 &amp; 3 \\ 2 &amp; 1 \end{bmatrix} \quad$$</p><h3 id="åšæ³•-s3"><a class="header-anchor" href="#åšæ³•-s3">Â¶</a>åšæ³•</h3><p>å®¹æ˜“å‘ç°å¯¹åŒä¸€ä¸ªæ­£æ–¹å½¢åŒºåŸŸæ“ä½œä¸¤æ¬¡ç­‰äºä¸æ“ä½œï¼Œæ“ä½œä¸€æ¬¡ç›¸å½“äºäº¤æ¢ç›¸é‚»ä¸¤åˆ—ï¼Œå¹¶ä¸”ä¸¤è¡Œå…ƒç´ äº¤æ¢ã€‚æ‰€ä»¥ä¸ç®¡æ€ä¹ˆæ“ä½œæ¯åˆ—çš„ä¸¤ä¸ªå…ƒç´ æ˜¯å›ºå®šçš„ï¼Œæœ€å¤šä¸Šä¸‹ä½ç½®äº¤æ¢ä¸€ä¸‹ã€‚è€ƒè™‘å½“å‰ç½‘æ ¼ä¸­ç¬¬iåˆ—çš„ä¸¤ä¸ªå…ƒç´ åœ¨ç›®æ ‡ç½‘æ ¼ä¸­ç¬¬jåˆ—(å¦‚æœä¸¤ä¸ªå…ƒç´ åœ¨ä¸åŒåˆ—ï¼Œæ˜¾ç„¶æ— è§£)ï¼Œå¦‚æœj-iä¸ºå¥‡æ•°åˆ™ä½ç½®åº”è¯¥é¢ å€’ï¼Œå¶æ•°åˆ™ä½ç½®åº”è¯¥ç›¸åŒã€‚è¿™æ ·æ‰«ä¸€éå°±å¯ä»¥åˆ¤å®šæœ‰æ²¡æœ‰è§£ã€‚å¯ä»¥å‘ç°æœ€åå°±æ˜¯è¦è®©ç¬¬iåˆ—è½¬ç§»åˆ°ç¬¬$p_i$â€‹åˆ—ï¼Œè€ƒè™‘ä¸€ä¸ªæ’åˆ—ï¼Œæ¯æ¬¡åªèƒ½äº¤æ¢ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ï¼Œé—®ä½¿å…¶æœ‰åºæœ€å°‘éœ€è¦çš„æ“ä½œæ¬¡æ•°ã€‚ç­”æ¡ˆä¸ºé€†åºå¯¹ä¸ªæ•°ã€‚è®¾fä¸ºä¸€ä¸ªç½®æ¢ï¼Œ$f(p) = 1,2,3,â€¦,n$ï¼Œåˆ™ç­”æ¡ˆä¸º$f^{-1}$çš„é€†åºå¯¹æ•°ï¼Œæ ‘çŠ¶æ•°ç»„å³å¯</p><h2 id="P6688-å¯é‡é›†"><a class="header-anchor" href="#P6688-å¯é‡é›†">Â¶</a>P6688 å¯é‡é›†</h2><h3 id="é¢˜ç›®-s4"><a class="header-anchor" href="#é¢˜ç›®-s4">Â¶</a>é¢˜ç›®</h3><p>ç»™å®šæ•°ç»„$a_i$â€‹ï¼Œæ”¯æŒå•ç‚¹ä¿®æ”¹ï¼Œå¹¶å¤šæ¬¡è¯¢é—®åŒºé—´[l1:r1]ä¸åŒºé—´[l2:r2]æ˜¯å¦æœ¬è´¨ç›¸åŒã€‚å…¶ä¸­æœ¬è´¨ç›¸åŒåªå¯¹è¿™ä¸¤ä¸ªåŒºé—´æ’åºåï¼Œå¯¹åº”å…ƒç´ çš„å·®å€¼å‡ä¸ºæ•´æ•°kã€‚$n&lt;=10^6$</p><h3 id="åšæ³•-s4"><a class="header-anchor" href="#åšæ³•-s4">Â¶</a>åšæ³•</h3><p>å…ˆè¯´ä¸€ä¸‹P3792 ç”±ä¹ƒä¸å¤§æ¯ç¥åŸå‹å’Œå¶åƒå´‡æ‹œè¿™é¢˜ï¼Œæ”¯æŒå•ç‚¹ä¿®æ”¹ï¼Œå¹¶å¤šæ¬¡è¯¢é—®åŒºé—´[l:r]åœ¨é‡æ’åæ˜¯å¦æ˜¯å€¼åŸŸè¿ç»­çš„ã€‚è¿™ä¸¤é“é¢˜çš„ç‰¹ç‚¹éƒ½æ˜¯ä¸€çœ¼ä¸å¯åšï¼Œè€Œè§£æ³•æ˜¯æ•°æ®ç»“æ„+å“ˆå¸Œï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯ä¸€å®šæ­£ç¡®ã€‚ç»´æŠ¤å‡ºåŒºé—´æœ€å°å€¼ï¼ŒåŒºé—´æœ€å¤§å€¼ï¼ŒåŒºé—´å’Œï¼ŒåŒºé—´å¹³æ–¹å’Œï¼Œç„¶ååˆ¤æ–­å³å¯ä»è¿™é¢˜çš„æ€è·¯å®¹æ˜“æƒ³åˆ°é€šè¿‡ç»´æŠ¤åŒºé—´å’Œå¾ˆå®¹æ˜“å¾—åˆ°è¿™ä¸ªå·®å€¼kï¼Œç„¶åå†ç»´æŠ¤å¹³æ–¹å’Œï¼Ÿå¾ˆä¸å¹¸è¢«å‡ºé¢˜äººå¡æˆäº†0ptsã€‚ä¸‰æ¬¡æ–¹ï¼Ÿæ²¡å•¥ç”¨ã€‚ã€‚è€ƒè™‘è®¾ç½®ä¸€ä¸ªæ•°magicï¼Œç„¶åç»´æŠ¤$\sum magic^{a_i}$â€‹ï¼Œç„¶ååªè¦çœ‹$\sum_{i=l1}^{r1}magic^{a_i} * magic^k==\sum_{i=l2}^{r2}magic^{a_i}$ç”±äºå¾ˆå¤§è¦å–æ¨¡ï¼Œmagicå’Œmodéšä¾¿è®¾å°±èƒ½è¿‡ã€‚ã€‚å½“ç„¶åº”è¯¥èƒ½å¡ä¸Šé¢çš„æ–¹æ³•æ˜¯æŠŠåŠ æ³•åˆ©ç”¨å¹‚æ¬¡è½¬æˆä¹˜æ³•ï¼Œå¦ä¸€ç§åšæ³•æ˜¯åˆ©ç”¨sinã€‚$sin(x+y) = sinxcosy + cosxsiny$$cos(x+y) = cosxcosy âˆ’ sinxsiny$ç»´æŠ¤ä¸€ä¸‹$\sum sinx$å’Œ$\sum cosx$ï¼ŒåŒæ ·å…ˆåˆ©ç”¨åŒºé—´å’Œæå‡ºkï¼Œç„¶åç”¨ä¸Šé¢çš„å…¬å¼åˆ¤æ–­å³å¯ï¼Œæ³¨æ„doubleæ¯”è¾ƒç”¨epså…·ä½“æ€ä¹ˆç»´æŠ¤å¯ä»¥çœ‹p6327ï¼ŒåŒºé—´ä¿®æ”¹+åŒºé—´sinå’Œã€‚æœ¬é¢˜æ˜¯å•ç‚¹ä¿®æ”¹+åŒºé—´sinå’Œç”±äºnæ˜¯$10^6$çº§åˆ«ï¼Œè€Œä¸”æ˜¯å•ç‚¹ä¿®+åŒºé—´æŸ¥ï¼Œæ‰€ä»¥æ ‘çŠ¶æ•°ç»„å³å¯å½“ç„¶ä»¥ä¸Šåªæ˜¯éƒ¨åˆ†å¯ä»¥é€šè¿‡çš„è§£æ³•ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ‹“å±•ä¸€ä¸‹æ€è·¯ï¼ˆè½¬æˆå¹‚æ¬¡ï¼Œè½¬æˆsinï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> magic = <span class="number">1919810</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a = <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) <span class="keyword">return</span> a-mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) a+=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) <span class="keyword">return</span> a+mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="keyword">namespace</span> IO</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line">  <span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++); &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">    <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">    t *= f;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">out</span><span class="params">(T p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> sta[<span class="number">70</span>], tp;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>) &#123; <span class="built_in">putchar</span>(<span class="string">&#x27;0&#x27;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;<span class="number">0</span>) &#123; p = -p; <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>); &#125;</span><br><span class="line">    <span class="keyword">while</span>(p) sta[++tp] = p%<span class="number">10</span>, p/=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">while</span>(tp) <span class="built_in">putchar</span>(sta[tp--]+<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO;</span><br><span class="line"><span class="type">int</span> n, q, a[N], pw[N];</span><br><span class="line"><span class="type">int</span> c[N];</span><br><span class="line">ll sum[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) <span class="built_in">add</span>(c[i], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) <span class="built_in">sub</span>(c[i], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) <span class="built_in">add</span>(ans, c[i]);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v, <span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) sum[i] += v*op;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask2</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += sum[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">powmod</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(b&lt;N) <span class="keyword">return</span> pw[b];</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = ans*a%mod;</span><br><span class="line">    a = a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">  pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;N; i++) pw[i] = <span class="built_in">Mul</span>(pw[i<span class="number">-1</span>], magic);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">ins</span>(i, pw[a[i]]);</span><br><span class="line">    <span class="built_in">upd</span>(i, a[i], <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op; <span class="built_in">read</span>(op);</span><br><span class="line">    <span class="keyword">if</span>(!op)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x, y;</span><br><span class="line">      <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">      <span class="built_in">del</span>(x, pw[a[x]]);</span><br><span class="line">      <span class="built_in">upd</span>(x, a[x], <span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">ins</span>(x, pw[a[x]=y]);</span><br><span class="line">      <span class="built_in">upd</span>(x, a[x], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l1, r1, l2, r2;</span><br><span class="line">      <span class="built_in">read</span>(l1), <span class="built_in">read</span>(r1), <span class="built_in">read</span>(l2), <span class="built_in">read</span>(r2);</span><br><span class="line">      <span class="type">int</span> x = <span class="built_in">Sub</span>(<span class="built_in">ask</span>(r1), <span class="built_in">ask</span>(l1<span class="number">-1</span>)), y = <span class="built_in">Sub</span>(<span class="built_in">ask</span>(r2), <span class="built_in">ask</span>(l2<span class="number">-1</span>));</span><br><span class="line">      ll s1 = <span class="built_in">ask2</span>(r1) - <span class="built_in">ask2</span>(l1<span class="number">-1</span>), s2 = <span class="built_in">ask2</span>(r2) - <span class="built_in">ask2</span>(l2<span class="number">-1</span>);</span><br><span class="line">      <span class="keyword">if</span>((s2-s1)%(r1-l1+<span class="number">1</span>)) cout &lt;&lt; <span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        ll k = (s2-s1)/(r1-l1+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(k&lt;<span class="number">0</span>) k = -k, <span class="built_in">swap</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span>(x*<span class="built_in">powmod</span>(magic, k)%mod==y) cout &lt;&lt; <span class="string">&quot;YES\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">namespace</span> IO</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line">  <span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++); &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">    <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">    t *= f;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">out</span><span class="params">(T p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> sta[<span class="number">70</span>], tp;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>) &#123; <span class="built_in">putchar</span>(<span class="string">&#x27;0&#x27;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;<span class="number">0</span>) &#123; p = -p; <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>); &#125;</span><br><span class="line">    <span class="keyword">while</span>(p) sta[++tp] = p%<span class="number">10</span>, p/=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">while</span>(tp) <span class="built_in">putchar</span>(sta[tp--]+<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO;</span><br><span class="line"><span class="type">int</span> n, q, a[N];</span><br><span class="line">ll sum[N];</span><br><span class="line"><span class="type">double</span> snx[N], csx[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">sgn</span><span class="params">(<span class="type">double</span> x)</span> </span>&#123; <span class="keyword">return</span> (x&lt;-eps ? <span class="number">-1</span> : x&gt;eps); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v, <span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">double</span> snv = <span class="built_in">sin</span>(v), csv = <span class="built_in">cos</span>(v);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i))</span><br><span class="line">  &#123;</span><br><span class="line">    sum[i] += v*op;</span><br><span class="line">    snx[i] += snv*op;</span><br><span class="line">    csx[i] += csv*op;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += sum[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="keyword">operator</span> - (pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; a, pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; b) &#123; <span class="keyword">return</span> <span class="built_in">mp</span>(a.fi-b.fi, a.se-b.se); &#125;</span><br><span class="line"><span class="function">pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="title">ask2</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">double</span> sn = <span class="number">0.0</span>, cs = <span class="number">0.0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) sn += snx[i], cs += csx[i];</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">mp</span>(sn, cs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">read</span>(n); <span class="built_in">read</span>(q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">upd</span>(i, a[i], <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">read</span>(op);</span><br><span class="line">    <span class="keyword">if</span>(op)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l1, r1, l2, r2;</span><br><span class="line">      <span class="built_in">read</span>(l1); <span class="built_in">read</span>(r1); <span class="built_in">read</span>(l2); <span class="built_in">read</span>(r2);</span><br><span class="line">      ll x = <span class="built_in">ask</span>(r1) - <span class="built_in">ask</span>(l1<span class="number">-1</span>);</span><br><span class="line">      ll y = <span class="built_in">ask</span>(r2) - <span class="built_in">ask</span>(l2<span class="number">-1</span>);</span><br><span class="line">      <span class="keyword">if</span>((y-x)%(r1-l1+<span class="number">1</span>)) <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        ll k = (y-x)/(r1-l1+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">auto</span> p = <span class="built_in">ask2</span>(r1) - <span class="built_in">ask2</span>(l1<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">auto</span> q = <span class="built_in">ask2</span>(r2) - <span class="built_in">ask2</span>(l2<span class="number">-1</span>);</span><br><span class="line">        <span class="type">double</span> snk = <span class="built_in">sin</span>(k), csk = <span class="built_in">cos</span>(k);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(q.fi-p.fi*csk-p.se*snk) || <span class="built_in">sgn</span>(q.se-p.se*csk+p.fi*snk)) <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x, y;</span><br><span class="line">      <span class="built_in">read</span>(x); <span class="built_in">read</span>(y);</span><br><span class="line">      <span class="built_in">upd</span>(x, a[x], <span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">upd</span>(x, a[x]=y, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shift-and/or å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•</title>
      <link href="/2020/07/22/shift-andor-zi-fu-chuan-pi-pei-suan-fa/"/>
      <url>/2020/07/22/shift-andor-zi-fu-chuan-pi-pei-suan-fa/</url>
      
        <content type="html"><![CDATA[<h2 id="shift-and"><a class="header-anchor" href="#shift-and">Â¶</a>shift-and</h2><p>åœ¨ä¸²sä¸­æŸ¥æ‰¾ä¸²tè§„å®šä¸²sçš„é•¿åº¦ä¸ºnï¼Œä¸²tçš„é•¿åº¦ä¸ºmï¼Œå­—ç¬¦ä¸²ä¸‹æ ‡ä»0å¼€å§‹bitset<m> B[26];é¢„å¤„ç†å­—ç¬¦é›†ä¸­æ¯ä¸ªå­—æ¯åœ¨ä¸²tä¸­çš„å‡ºç°çš„ä½ç½®ï¼Œå„ç”¨ä¸€ä¸ªbitsetè¡¨ç¤ºã€‚B[s[i]-â€˜aâ€™]è¡¨ç¤ºçš„æ˜¯sä¸²ä¸­iä½ç½®ä¸tä¸²ä¸­å“ªäº›ä½ç½®å¯ä»¥åŒ¹é…bitset<m> D;åœ¨sä¸­æšä¸¾ä½ç½®iï¼ŒD[j]=1ä»…å½“ä¸²tçš„å‰ç¼€t[0â€¦j]æ˜¯ä¸²sçš„åç¼€s[i-jâ€¦i]å½“D[m-1]=1æ—¶è¡¨ç¤ºä¸€æ¬¡åŒ¹é…å½“æšä¸¾ä½ç½®i+1ï¼Œå°±è¦æ›´æ–°DD = (D&lt;&lt;1|1)&amp;B[s[i+1]-â€˜aâ€™];å¤æ‚åº¦$O(\frac{nm}{32})$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">shift_and</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n = <span class="built_in">strlen</span>(s), m = <span class="built_in">strlen</span>(t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    B[s[i]-<span class="string">&#x27;A&#x27;</span>].<span class="built_in">set</span>(i);</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    D &lt;&lt;= <span class="number">1</span>; D.<span class="built_in">set</span>(<span class="number">0</span>);</span><br><span class="line">    D &amp;= B[t[i]-<span class="string">&#x27;A&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(D[n<span class="number">-1</span>]) cnt++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="shift-or"><a class="header-anchor" href="#shift-or">Â¶</a>shift-or</h2><p>ä¸shiftandçš„Bå’ŒDå«ä¹‰éƒ½ç›¸åï¼ŒB=0è¡¨ç¤ºå­˜åœ¨ï¼ŒD=0è¡¨ç¤ºåŒ¹é…ï¼Œæ‰€ä»¥åˆå§‹æ—¶Bå’ŒDå…¨ä¸º1ï¼Œæ¯æ¬¡è½¬ç§»D = (D&lt;&lt;1|B[s[i]-â€˜aâ€™])</p><p>åœ¨æ™®é€šçš„å­—ç¬¦ä¸²åŒ¹é…ä¸­è¿™ä¸¤è€…çš„ä½œç”¨æ˜¾ç„¶æ²¡æœ‰kmpå¼ºï¼Œå¤æ‚åº¦åŠ£åŠ¿ä½†æ˜¯åœ¨å¯é€‰å­—ç¬¦åŒ¹é…ä¸­å¾ˆæœ‰ç”¨è§„å®šæ¯ä¸ªä½ç½®å¯ä»¥ä¸å¤šä¸ªå­—ç¬¦ç›¸åŒ¹é…ï¼Œæ­¤æ—¶åªè¦è®©è¿™äº›å­—ç¬¦çš„Bçš„é‚£ä¸ªä½ç½®éƒ½ç½®1å³å¯</p><ul><li>hdu 5972 è¾“å‡ºçš„æ—¶å€™ä»¤s[n+1]=0,ç„¶åputs(s[i-n+1])ï¼Œå†è¿˜åŸs[n+1]ã€‚å¦‚æœå…ˆè®°å½•åŒ¹é…ä½ç½®æœ€ååŒé‡forä¼šT</li><li>hdu 5716</li><li>ç‰›å®¢å¤šæ ¡2Gé¢˜ç»™å®šé•¿åº¦ä¸ºnçš„æ•°ç»„aå’Œé•¿åº¦ä¸ºmçš„æ•°ç»„bï¼Œè¯¢é—®æ•°ç»„aä¸­æ¯ä¸€ä½éƒ½ä¸¥æ ¼å¤§äºæ•°ç»„bçš„å­æ®µä¸ªæ•°å¯ä»¥æŠŠè¿™ä¸ªé—®é¢˜å½“æˆä¸€ä¸ªå¯é€‰å­—ç¬¦åŒ¹é…é—®é¢˜ï¼Œå¯¹äºæ¯ä¸ªa[i]å¯ä»¥ä¸æ‰€æœ‰&lt;=a[i]çš„b[j]ç›¸åŒ¹é…ã€‚è€ƒè™‘é¢„å¤„ç†å‡ºbitset<M> B[N]ï¼Œè¡¨ç¤ºaçš„æ¯ä¸€ä½å¯ä»¥ä¸bçš„å“ªäº›ä½ç›¸åŒ¹é…ï¼Œç„¶åè·‘ä¸€éshift-andå³å¯ã€‚è¿™æ ·ä¼šMLEï¼Œéšç€açš„å¢å¤§ï¼Œèƒ½å¤ŸåŒ¹é…çš„ä½ç½®ä¸æ–­å¢åŠ ï¼Œæ‰€ä»¥æœ¬è´¨ä¸åŒçš„bitsetåªæœ‰mä¸ªï¼Œå¼€æˆbitset<M> B[M]å³å¯ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1.5e5</span> + <span class="number">5</span>, M = <span class="number">4e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, idx[N];</span><br><span class="line">pii a[N], b[M];</span><br><span class="line">bitset&lt;M&gt; B[M], D;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i].fi), a[i].se = i;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i].fi), b[i].se = i;</span><br><span class="line">  <span class="built_in">sort</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>); <span class="built_in">sort</span>(b+<span class="number">1</span>, b+m+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">    B[i] = B[i<span class="number">-1</span>], B[i].<span class="built_in">set</span>(b[i].se);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, j=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(j&lt;=m &amp;&amp; a[i].fi&gt;=b[j].fi) ++j;</span><br><span class="line">    idx[a[i].se] = j<span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    D &lt;&lt;= <span class="number">1</span>; D.<span class="built_in">set</span>(<span class="number">1</span>);</span><br><span class="line">    D &amp;= B[idx[i]];</span><br><span class="line">    <span class="keyword">if</span>(D[m]) ++ans;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ƒè™‘é¢„å¤„ç†bitset<N> B[i]è¡¨ç¤ºbæ•°ç»„ä¸­ç¬¬iä½å¯ä»¥ä¸aæ•°ç»„ä¸­å“ªäº›ä½ç›¸åŒ¹é…ã€‚ç„¶åç”¨ä¸€ä¸ªå…¨1çš„bitset<N>Dï¼Œå½“D[i]=1æ—¶è¡¨ç¤ºaæ•°ç»„ä¸­ä»¥iä¸‹æ ‡èµ·å§‹çš„é•¿åº¦ä¸ºmçš„å­æ®µå¯ä»¥ä¸bæ•°ç»„ç›¸åŒ¹é…ã€‚åªè¦æšä¸¾bæ•°ç»„ä¸­çš„æ‰€æœ‰ä½ç½®è®©D &amp;= (B[i]&gt;&gt;(i-1))å³å¯ï¼Œå¦‚æœB[i][j]=0ï¼Œé‚£ä¹ˆD[j-i+1]èµ·å§‹çš„å­æ®µå°±ä¸å¯èƒ½ä¸bæ•°ç»„ç›¸åŒ¹é…ï¼Œå› ä¸ºa[j]!=b[i]ã€‚ä»¥ä¸Šæ–¹æ³•ä¹Ÿå¯ä»¥ç”¨äºå­—ç¬¦ä¸²åŒ¹é…ã€‚åœ¨ç‰›å®¢å¤šæ ¡è¿™é¢˜ä¸­ï¼Œåˆ©ç”¨è¯¥æ–¹æ³•å¯ä»¥ä»…å¼€ä¸€ä¸ªbitset<N> Bï¼Œå› ä¸ºåœ¨è¿™é‡Œbæ•°ç»„ä¸‹æ ‡çš„æšä¸¾é¡ºåºæ˜¯ä»»æ„çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹bæ’åºåå†æšä¸¾ï¼Œç„¶ååˆ©ç”¨å°ºå–å®ç°Bçš„æ»šåŠ¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1.5e5</span> + <span class="number">5</span>, M = <span class="number">4e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, idx[N];</span><br><span class="line">pii a[N], b[M];</span><br><span class="line">bitset&lt;N&gt; B, D;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i].fi), a[i].se = i;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i].fi), b[i].se = i;</span><br><span class="line">  <span class="built_in">sort</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>); <span class="built_in">sort</span>(b+<span class="number">1</span>, b+m+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n-m+<span class="number">1</span>; i++) D.<span class="built_in">set</span>(i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=m, j=n; i; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(j &amp;&amp; a[j].fi&gt;=b[i].fi) B.<span class="built_in">set</span>(a[j--].se);</span><br><span class="line">    D &amp;= (B&gt;&gt;(b[i].se<span class="number">-1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="type">int</span>)D.<span class="built_in">count</span>());</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç¼€è‡ªåŠ¨æœºå’Œå¹¿ä¹‰åç¼€è‡ªåŠ¨æœºçš„ä¸€äº›ç–‘é—®</title>
      <link href="/2020/07/17/hou-zhui-zi-dong-ji-he-guang-yi-hou-zhui-zi-dong-ji-de-yi-xie-yi-wen/"/>
      <url>/2020/07/17/hou-zhui-zi-dong-ji-he-guang-yi-hou-zhui-zi-dong-ji-de-yi-xie-yi-wen/</url>
      
        <content type="html"><![CDATA[<p>æ„Ÿè§‰samï¼Œç‰¹åˆ«æ˜¯parentæ ‘ä¸Šçš„å¤æ‚åº¦å¾ˆç„å­¦ï¼Ÿï¼</p><ul><li><p>æš´åŠ›è·³parentæ ‘çš„å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿç¬¬ä¸€ç§æƒ…å†µæ˜¯å»ºå¹¿ä¹‰samï¼Œç„¶åæ¯ä¸ªä¸²æš´åŠ›è·³parentæ ‡è®°ï¼Œå¤æ‚åº¦ä¼¼ä¹æ˜¯$n\sqrt n$â€‹ï¼ˆç»´æŠ¤å¤šä¸²çš„æ ¹å·trickï¼‰ç¬¬äºŒç§æ˜¯samä¸Šç›´æ¥æ— è„‘æš´åŠ›è·³åˆ°æŸä¸ªé•¿åº¦èŒƒå›´å†…ï¼Œä¸€èˆ¬æƒ…å†µæ˜¯è¦å†™å€å¢çš„ï¼Œä½†æ˜¯æˆ‘åœ¨2019å¾å·Lã€p4094ä¸Šç›´æ¥æš´åŠ›è·³ä¹Ÿéƒ½è¿‡äº†ï¼Œè€Œä¸”æ¯”å€å¢å¿«ï¼ˆå¸¸æ•°å°ï¼‰ã€‚ã€‚å¦‚æœæ˜¯aaaaaâ€¦çš„è¯parentæ ‘æ˜¯é“¾ï¼Œåº”è¯¥èƒ½å¡ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦å†™å€å¢å§</p></li><li><p>trieä¸Šå»ºå¹¿ä¹‰samæ­£è§£æ˜¯bfsçš„åšæ³•ï¼Œä½†æ˜¯éœ€è¦æ˜¾ç¤ºçš„å»ºå‡ºtrieï¼Œå¦‚æœä¸å»ºä¼šé”™ï¼Œæˆ‘è®¤ä¸ºæ˜¯é‡è¾¹çš„å½±å“ï¼ˆä¸ç¡®å®šï¼‰ã€‚å¦‚æœç›´æ¥dfsï¼Œå¤æ‚åº¦ä¼šå–å†³äºtrieä¸Š$\sum dep(leaf)$ï¼ˆ15å›½å®¶è®ºæ–‡ï¼‰ï¼Œæ„Ÿè§‰å¯ä»¥å¡æˆ$n^2$ï¼Œç„¶è€Œæˆ‘åœ¨2019å¾å·Lã€2019wfGä¸Šç›´æ¥dfså»ºå°±è¿‡äº†ï¼Œç”±äºä¸ç”¨å»ºtrieï¼Œæ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æŒºä¼˜ç§€ï¼Œç›®å‰è¿˜ä¸çŸ¥é“æ˜¯æ•°æ®é—®é¢˜è¿˜æ˜¯ä»€ä¹ˆã€‚p3346ç”±äºå¶å­åªæœ‰20ä¸ªï¼Œæ‰€ä»¥dfsè‚¯å®šæ˜¯å¯¹çš„ã€‚</p></li><li><p>å¹¿ä¹‰samèƒ½ä¸èƒ½åŸºæ•°æ’åºçªç„¶æ„è¯†åˆ°å¹¿ä¹‰samåŸºæ•°æ’åºåçš„ç»“æœä¸æ‹“æ‰‘åºå¯èƒ½æœ‰å‡ºå…¥ï¼Œä¸è¿‡æˆ‘å¥½å‡ é“exsamç”¨åŸºæ•°æ’åºå¾—åˆ°çš„æ‹“æ‰‘åºå»åšä¹Ÿè¿‡äº†ã€‚ã€‚å¾ˆè¿·è¿˜æ˜¯è€è€å®å®æŠŠparentæ ‘å»ºå‡ºæ¥å§ã€‚</p></li><li><p>æ³¨æ„ï¼šçº¿æ®µæ ‘åˆå¹¶æ±‚endposé›†åˆçš„æ—¶å€™ï¼Œä¸€å®šè¦æ–°å¼€ç‚¹ï¼Œå¦åˆ™å¯èƒ½ä¼šå½±å“å­æ ‘çš„ä¿¡æ¯ã€‚</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kmpå­¦ä¹ ç¬”è®°</title>
      <link href="/2020/07/14/kmp-xue-xi-bi-ji/"/>
      <url>/2020/07/14/kmp-xue-xi-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="åº”ç”¨"><a class="header-anchor" href="#åº”ç”¨">Â¶</a>åº”ç”¨</h2><p>ç»™å®šä¸»ä¸²tå’Œæ¨¡å¼ä¸²sï¼Œæ±‚å‡ºsåœ¨tä¸­çš„æ‰€æœ‰åŒ¹é…ä½ç½®æ±‚å‡ºä¸€ä¸ªä¸²çš„æ‰€æœ‰å‰ç¼€çš„æœ€å¤§border(nextæ•°ç»„)</p><h2 id="å®šä¹‰"><a class="header-anchor" href="#å®šä¹‰">Â¶</a>å®šä¹‰</h2><p>å‰ç¼€pre(s, l)ï¼šsé•¿åº¦ä¸ºlçš„å‰ç¼€(s[1â€¦l])åç¼€suf(s, l)ï¼šsé•¿åº¦ä¸ºlçš„åç¼€(s[|s|-l+1â€¦|s|])å‘¨æœŸperiodï¼šs[i]=s[i+p]ï¼Œ$\forall i \in1â€¦|s|-ps[i]=s[i+p]$ï¼Œåˆ™pæ˜¯sçš„å‘¨æœŸborder: pre(s, l) = suf(s, l)ï¼Œåˆ™pre(s, l)æ˜¯sçš„border</p><h2 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h2><p>è‹¥sæœ‰é•¿ä¸ºxçš„borderï¼Œåˆ™|s|-xä¸ºsçš„ä¸€ä¸ªå‘¨æœŸã€‚è¯æ˜å¯ä»¥åˆ†æˆborderç›¸äº¤å’Œä¸ç›¸äº¤ä¸¤ç§æƒ…å†µæœ€å°å‘¨æœŸ=ä¸²é•¿-æœ€å¤§borderborderå…·æœ‰ä¼ é€’æ€§ï¼Œä¸²sçš„æ‰€æœ‰borderå¯ä»¥ç”¨<code>nxt[|s|]ï¼Œnxt[nxt[|s|]]...</code>è¡¨ç¤º<strong>Weak Periodicity Lemma</strong>på’Œqæ˜¯sçš„å‘¨æœŸï¼Œp+q&lt;=|s|ï¼Œåˆ™gcd(p, q)ä¹Ÿæ˜¯sçš„å‘¨æœŸ<strong>Periodicity Lemma</strong>på’Œqæ˜¯sçš„å‘¨æœŸï¼Œp+q-gcd(p, q)&lt;=|s|ï¼Œåˆ™gcd(p, q)ä¹Ÿæ˜¯sçš„å‘¨æœŸ(ç‰›å®¢å¤šæ ¡1çš„ç­¾åˆ°æ˜¯ç»™å‡ºä¸¤ä¸ªæ— é™ä¸²å„è‡ªçš„å‘¨æœŸï¼Œè¦æ±‚æ¯”è¾ƒè¿™ä¸¤ä¸ªä¸²çš„å­—å…¸åºå¤§å°ï¼Œåªéœ€è¦æ¯”è¾ƒå‰p+q-gcd(p,q)æˆ–è€…å‰p+qä¸ªå­—ç¬¦ï¼Œå¦‚æœéƒ½ç›¸åŒï¼Œè¯´æ˜på’Œqéƒ½æ˜¯å„è‡ªçš„å‘¨æœŸï¼Œä¸¤ä¸ªä¸²ç›¸ç­‰)</p><h2 id="æ±‚æ³•"><a class="header-anchor" href="#æ±‚æ³•">Â¶</a>æ±‚æ³•</h2><p>nxtæ•°ç»„çš„æ±‚æ³•å¯ä»¥å½“ä½œæ˜¯sä¸²è‡ªå·±å’Œè‡ªå·±åŒ¹é…çš„è¿‡ç¨‹ã€‚è§„å®š<code>nxt[0]=âˆ’1</code>ï¼Œsä¸²ä»0å¼€å§‹ï¼Œnxt[i]è¡¨ç¤ºs[0â€¦i-1]çš„æœ€å¤§borderè€ƒè™‘å½“å‰å·²ç»æ±‚å‡ºäº†nxt[0â€¦i]ï¼Œä¸”nxt[i]=jï¼Œè¯´æ˜<code>s[i-j...i-1]=s[0...j-1]</code></p><ul><li><code>s[i]==s[j]</code>ï¼Œ<code>nxt[++i] = ++j</code></li><li><code>ss[i]!=s[j]</code>ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ä¸æ–­å¾€å‰è·³nxtï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªborderçš„åä¸€ä¸ªå­—ç¬¦ç­‰äºs[j]ï¼Œç„¶åè½¬ä¸ºç¬¬ä¸€ç§æƒ…å†µ</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">kmp_pre</span><span class="params">(<span class="type">char</span> s[], <span class="type">int</span> n, <span class="type">int</span> nxt[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>, j = nxt[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;n)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(j!=<span class="number">-1</span>&amp;&amp;s[i]!=s[j]) j = nxt[j];</span><br><span class="line">    nxt[++i] = ++j;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²åŒ¹é…çš„è¿‡ç¨‹å’Œæ±‚nextæ•°ç»„çš„è¿‡ç¨‹ç±»ä¼¼ï¼ˆæ¨¡å¼ä¸²éƒ½æ˜¯sï¼Œåªä¸è¿‡ä¸»ä¸²å˜äº†ï¼‰ã€‚è§„å®šsä¸²ä¸ºæ¨¡å¼ä¸²ï¼Œtä¸ºä¸»ä¸²ï¼Œä¸‹æ ‡å‡ä»0å¼€å§‹ã€‚å…ˆæ±‚å‡ºsä¸²çš„nextæ•°ç»„è€ƒè™‘å½“å‰tä¸²åŒ¹é…åˆ°i-1ï¼Œsä¸²åŒ¹é…åˆ°j-1ï¼Œè¯´æ˜<code>t[i-j...i-1]=s[0...j-1]</code></p><ul><li><code>t[i]=s[j]</code>ï¼Œ++iï¼Œ++jã€‚å¦‚æœj&gt;|s|ï¼Œè¯´æ˜æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…ï¼Œè®°å½•ä¸‹ä½ç½®ï¼Œè®©j=nxt[j]</li><li><code>t[i]!=s[j]</code>ï¼Œjä¸æ–­è·³nxtç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªborderçš„åä¸€ä¸ªå­—ç¬¦ç­‰äºt[i]ä¸ºæ­¢ï¼Œç„¶åè½¬åŒ–ä¸ºç¬¬ä¸€ç§æƒ…å†µ</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">kmp_work</span><span class="params">(<span class="type">char</span> s[], <span class="type">int</span> n, <span class="type">char</span> t[], <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">kmp_pre</span>(s, n, nxt);</span><br><span class="line">  <span class="keyword">while</span>(i&lt;m)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(j!=<span class="number">-1</span>&amp;&amp;t[i]!=s[j]) j = nxt[j];</span><br><span class="line">    i++; j++;</span><br><span class="line">    <span class="keyword">if</span>(j&gt;=n)</span><br><span class="line">    &#123;</span><br><span class="line">      ans++;</span><br><span class="line">      match[i-n] = <span class="number">1</span>;</span><br><span class="line">      j = nxt[j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜"><a class="header-anchor" href="#ä¹ é¢˜">Â¶</a>ä¹ é¢˜</h2><ul><li><p>p3375æ±‚å‡ºæ‰€æœ‰åŒ¹é…ä½ç½®+nxtæ•°ç»„</p></li><li><p>p5829å¼•å…¥ä¸€ç§å¤±é…æ ‘ï¼ˆå’Œacè‡ªåŠ¨æœºçš„failæ ‘ç±»ä¼¼ï¼‰ï¼šæŒ‰ç…§nextæ•°ç»„è¿›è¡Œå»ºæ ‘ï¼Œnext[i]ä½œä¸ºiçš„çˆ¶äº²ã€‚æ˜¾ç„¶æ¯ä¸ªç‚¹æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ã€‚å®¹æ˜“å‘ç°æ¯ä¸ªç‚¹çš„æ‰€æœ‰ç¥–å…ˆå°±æ˜¯å®ƒçš„æ‰€æœ‰borderï¼Œè·³nxtçš„è¿‡ç¨‹ç›¸å½“äºä¸æ–­å¾€çˆ¶äº²èµ°æœ¬é¢˜å¤šæ¬¡è¯¢é—®ä¸€ä¸ªä¸²sçš„æŸä¸¤ä¸ªå‰ç¼€çš„æœ€å¤§å…¬å…±borderã€‚å»ºå‡ºå¤±é…æ ‘åå¾ˆç›´è§‚çš„å¯ä»¥å‘ç°ç­”æ¡ˆå°±æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„LCAä»£è¡¨çš„å‰ç¼€</p></li><li><p>p3435æ±‚æ¯ä¸ªå‰ç¼€çš„æœ€å¤§å‘¨æœŸã€‚æ±‚æœ€å¤§å‘¨æœŸç›¸å½“äºæ±‚æœ€å°borderã€‚æ”¾åœ¨å¤±é…æ ‘ä¸Šå°±ç›¸å½“äºæ‰¾åˆ°æ¯ä¸ªç‚¹ç¥–å…ˆä¸­ç¦»æ ¹æœ€è¿‘çš„é‚£ä¸ªã€‚æ ‘ä¸Šdpä¸€ä¸‹å³å¯ã€‚ä¹Ÿå¯ä»¥è·¯å¾„å‹ç¼©ã€‚</p></li><li><p>poj2185ä¸€ä¸ªn*må­—ç¬¦çŸ©é˜µï¼Œæ±‚ä¸€ä¸ªæœ€å°çš„å­çŸ©é˜µï¼Œä½¿å…¶é‡å¤å¤šæ¬¡åæ‰€å¾—çŸ©é˜µåŒ…å«åŸçŸ©é˜µã€‚è¡Œåˆ—åˆ†å¼€åšä¸€ékmpï¼Œæ±‚å‡ºå„è‡ªçš„æœ€å¤§borderã€‚æŒ‰è¡Œåšçš„æ—¶å€™ï¼Œæ¯ä¸€è¡Œçš„å­—ç¬¦å½“ä½œä¸€ä¸ªå­—ç¬¦ï¼ˆhashä¸€ä¸‹ï¼Œç›´æ¥æš´åŠ›ä¹Ÿè¡Œï¼‰</p></li><li><p>p2375å¯¹sçš„æ‰€æœ‰å‰ç¼€ï¼Œæ±‚å‡ºé•¿åº¦ä¸è¶…è¿‡ä¸€åŠçš„borderæ•°é‡æ”¾åˆ°å¤±é…æ ‘ä¸Šï¼Œå€å¢ä¸€ä¸‹ï¼ˆborderé•¿åº¦å•å‡ï¼‰ï¼ˆæ— è„‘+æš´åŠ›ï¼‰$O(n\log n)$$O(n)$åšæ³•ï¼šè€ƒè™‘åœ¨æ±‚è§£nxtæ•°ç»„çš„æ—¶å€™ï¼Œå†å¢åŠ ä¸€ä¸ªkæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆå’ŒjæŒ‡é’ˆä¸€æ ·ï¼Œä½†æ˜¯éœ€è¦é¢å¤–æ»¡è¶³é•¿åº¦çš„é™åˆ¶ï¼Œå¦‚æœä¸æ»¡è¶³ç»§ç»­è·³nxtã€‚iç‚¹çš„ç­”æ¡ˆå°±æ˜¯kç‚¹çš„ç­”æ¡ˆçš„nxtå‰ç¼€å’Œï¼ˆåŒæ—¶dpé€’æ¨å³å¯ï¼‰</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; s;</span><br><span class="line">  <span class="type">int</span> n = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>, j = nxt[<span class="number">0</span>] = <span class="number">-1</span>, k = <span class="number">-1</span>;</span><br><span class="line">  ll ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;n)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(~j &amp;&amp; s[i]!=s[j]) j = nxt[j];</span><br><span class="line">    <span class="keyword">while</span>(~k &amp;&amp; s[i]!=s[k]) k = nxt[k];</span><br><span class="line">    nxt[++i] = ++j;</span><br><span class="line">    ++k;</span><br><span class="line">    dp[i] = dp[nxt[i]] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">2</span>*k&gt;i) k = nxt[k];</span><br><span class="line">    ans = ans*(dp[k]+<span class="number">1</span>)%mod; <span class="comment">//æ±‚çš„æ˜¯æ¯ä¸ªç‚¹ç­”æ¡ˆ+1çš„è¿ä¹˜ç§¯</span></span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>p3426å¯¹äºå­—ç¬¦ä¸²sï¼Œæ±‚ä¸€ä¸ªæœ€çŸ­çš„å­—ç¬¦ä¸²tï¼Œå…¶<strong>å¯é‡å </strong>åœ°é‡å¤æ•°æ¬¡åç­‰äºsæ˜¾ç„¶tæ˜¯sçš„ä¸€ä¸ªborderå¦‚æœå½“å‰ç­‰ä»·äºs[1â€¦i]ï¼Œç›¸å½“äºtæ˜¯pre(s, i)çš„ä¸€ä¸ªborderã€‚æ‰€ä»¥è¿™ä¸ªtæ˜¯sçš„æŸäº›å‰ç¼€çš„borderï¼Œè€Œä¸”è¿™äº›å‰ç¼€çš„ä½ç½®çš„å·®å€¼è¦&lt;=è¿™ä¸ªä¸²tçš„é•¿åº¦ã€‚åœ¨å¤±é…æ ‘ä¸Šè€ƒè™‘ï¼Œç­”æ¡ˆæ˜¯0åˆ°nè¿™æ¡é“¾ä¸Šçš„æŸä¸ªç‚¹x(sçš„æŸä¸ªborder)ï¼Œå¹¶ä¸”è¯¥ç‚¹å­æ ‘å†…æ‰€æœ‰ç‚¹çš„ä½ç½®çš„æœ€å¤§å·®å€¼&lt;=x(xæ˜¯å…¶å­æ ‘å†…çš„æ‰€æœ‰ç‚¹çš„æŸä¸ªborder)ï¼Œå¦‚æœæœ€å¤§å·®å€¼&gt;xï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‰ç¼€é—´å°±ä¸èƒ½é€šè¿‡xæ‹¼æ¥è€Œæˆã€‚å¤±é…æ ‘ä¸Šä»0èµ°åˆ°nï¼Œä¸æ–­åˆ å»éå­æ ‘å†…çš„ç‚¹ï¼Œç”¨setæˆ–åŒå‘é“¾è¡¨ç»´æŠ¤maxgapå³å¯è€ƒè™‘dp[i]ï¼šs[1â€¦i]çš„ç­”æ¡ˆdp[i]è¦ä¹ˆç­‰äºiï¼Œè¦ä¹ˆç­‰äºdp[nxt[i]]ç­‰äºdp[nxt[i]]çš„æ¡ä»¶æ˜¯nxt[i]â€¦i-1é—´$\exists j \ dp[j] = dp[nxt[i]] \land i-j&lt;=dp[nxt[i]]$</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">&#123;</span><br><span class="line">  dp[i] = i;</span><br><span class="line">  <span class="keyword">if</span>(p[dp[nxt[i]]] &amp;&amp; i-p[dp[nxt[i]]]&lt;=dp[nxt[i]])</span><br><span class="line">    dp[i] = dp[nxt[i]];</span><br><span class="line">  p[dp[i]] = i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>p3193ç»™å®šä¸€ä¸ªé•¿ä¸ºmçš„å­—ç¬¦ä¸²tï¼Œé—®èƒ½æ„é€ å‡ºå¤šå°‘ä¸ªé•¿ä¸ºnçš„å­—ç¬¦ä¸²sï¼Œä½¿å¾—tä¸æ˜¯sçš„å­ä¸²ã€‚$m&lt;=20, n&lt;=10^9$f[i][j]ï¼šsä¸²æ„é€ åˆ°iï¼Œtä¸²åŒ¹é…åˆ°jçš„æ–¹æ¡ˆæ•°å…ˆé¢„å¤„ç†å‡ºtä¸²å½“å‰åŒ¹é…åˆ°iï¼ŒåŠ ä¸€ä¸ªå­—ç¬¦ååŒ¹é…åˆ°jçš„æ–¹æ¡ˆæ•°g[i][j]ï¼Œè¿™ä¸ªç”¨kmpå³å¯è½¬ç§»ï¼š$f[i][j] = \sum_{k=0}^{m-1} f[i-1][k] * g[k][j]$æ˜¾ç„¶å¯ä»¥çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–</li></ul><p>$\begin{bmatrix}f[i][0] &amp; \cdots &amp; f[i][m-1] \end{bmatrix} = \begin{bmatrix} f[i-1][0] &amp;\cdots &amp; f[i-1][m-1] \end{bmatrix} \begin{bmatrix} g[0][0] &amp; \cdots &amp;g[0][m-1] \\ \vdots &amp; \ddots &amp; \vdots \\ g[m-1][0] &amp; \cdots &amp; g[m-1][m-1]\\ \end{bmatrix}$</p><p>å…¶ä¸­f[0][0]=1æœ€åç­”æ¡ˆå³ä¸º$g^n$çš„ç¬¬ä¸€è¡Œçš„å’Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">25</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, mod;</span><br><span class="line"><span class="type">int</span> g[N][N], nxt[N];</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">matrix</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m;</span><br><span class="line">  <span class="type">int</span> mat[N][N];</span><br><span class="line">  <span class="built_in">matrix</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">matrix</span>(<span class="type">int</span> a, <span class="type">int</span> b) : <span class="built_in">n</span>(a), <span class="built_in">m</span>(b) &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</span><br><span class="line">        mat[i][j] = (i==j);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">matrix <span class="keyword">operator</span> * (matrix a, matrix b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function">matrix <span class="title">res</span><span class="params">(a.n, b.m)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=a.n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=b.m; j++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=a.m; k++)</span><br><span class="line">        res.mat[i][j] = (res.mat[i][j]+a.mat[i][k]*b.mat[k][j])%mod;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">matrix <span class="keyword">operator</span> ^ (matrix a, ll x)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function">matrix <span class="title">res</span><span class="params">(a.n, a.m)</span></span>; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_nxt</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>, j = nxt[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;m)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(~j &amp;&amp; s[i]!=s[j]) j = nxt[j];</span><br><span class="line">    nxt[++i] = ++j;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init_g</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">-1</span>; i&lt;m<span class="number">-1</span>; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;<span class="number">10</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> j = i + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span>(~j &amp;&amp; s[j]-<span class="string">&#x27;0&#x27;</span>!=k) j = nxt[j];</span><br><span class="line">      g[i+<span class="number">1</span>][j+<span class="number">1</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m &gt;&gt; mod;</span><br><span class="line">  cin &gt;&gt; s;</span><br><span class="line">  <span class="built_in">get_nxt</span>();</span><br><span class="line">  <span class="built_in">init_g</span>();</span><br><span class="line">  <span class="function">matrix <span class="title">f</span><span class="params">(m, m)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</span><br><span class="line">      f.mat[i][j] = g[i<span class="number">-1</span>][j<span class="number">-1</span>];</span><br><span class="line">  f = f ^ n;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) ans = (ans + f.mat[<span class="number">1</span>][i])%mod;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>D-Array æ„é€ </title>
      <link href="/2020/06/18/d-array-gou-zao/"/>
      <url>/2020/06/18/d-array-gou-zao/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šä¸¤ä¸ªæ•°xå’Œyï¼Œè¦æ±‚ç”¨æœ€å°‘çš„nä¸ªæ•°ï¼Œä½¿å¾—ä»–ä»¬çš„å¼‚æˆ–å’Œ=xï¼Œæ±‚å’Œ=y</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è¿™é“é¢˜åœ¨cfä¸Šæœ‰ç±»ä¼¼çš„</p><ul><li>x=y=0 è¾“å‡º0</li><li>x=y!=0 è¾“å‡º1</li><li>x&gt;y è¾“å‡º-1</li><li>(y-x)&amp;1 è¾“å‡º-1</li><li>å¦‚æœå¯ä»¥ç”¨(y+x)/2 å’Œ(y-x)/2ï¼Œå°±è¾“å‡º2</li><li>å¦åˆ™è¾“å‡º3 x, (y-x)/2, (y-x)/2</li></ul><p>é¡ºä¾¿è®°ä¸€ä¸‹pythonå¤šç»„è¾“å…¥(ç«Ÿç„¶è·‘äº†6så¤šã€‚ã€‚)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        x, y = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">        <span class="keyword">if</span> x==y:</span><br><span class="line">            <span class="built_in">print</span>(<span class="number">0</span>) <span class="keyword">if</span>(x==<span class="number">0</span>) <span class="keyword">else</span> <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> x&gt;y:</span><br><span class="line">            <span class="built_in">print</span>(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> (y-x)&amp;<span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> ((y+x)//<span class="number">2</span>) ^ ((y-x)//<span class="number">2</span>) == x:</span><br><span class="line">            <span class="built_in">print</span>(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢ç»ƒä¹ èµ›65</title>
      <link href="/2020/06/18/niu-ke-lian-xi-sai-65/"/>
      <url>/2020/06/18/niu-ke-lian-xi-sai-65/</url>
      
        <content type="html"><![CDATA[<h2 id="C-äºŒç»´åŠ¨ç‚¹"><a class="header-anchor" href="#C-äºŒç»´åŠ¨ç‚¹">Â¶</a>C äºŒç»´åŠ¨ç‚¹</h2><h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>å¹³é¢ä¸Šæœ‰nä¸ªç‚¹ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸å½“å‰ä¸é‡åˆçš„ç‚¹ï¼Œç„¶åç§»åŠ¨åˆ°ä¸¤è€…<strong>ç›´çº¿</strong>ä¸Šçš„ä»»æ„ä¸€ç‚¹ï¼Œå¤šæ¬¡è¯¢é—®ä»åŸç‚¹åˆ°(x, y)æœ€å°‘çš„ç§»åŠ¨æ¬¡æ•°</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å¤§åŠ›åˆ†ç±»è®¨è®ºï¼š</p><ul><li>(0, 0ï¼‰æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¦‚æœå‡ºç°éœ€è¦å»æ‰</li><li>å¦‚æœå¹³é¢ä¸Šæ‰€æœ‰ç‚¹åˆ°åŸç‚¹çš„è¿çº¿æ˜¯ç›¸åŒçš„ï¼Œä¸”è¯¢é—®ç‚¹ä¸åœ¨è¯¥è¿çº¿ä¸Šï¼Œè¾“å‡º-1</li><li>å¦‚æœè¯¢é—®ç‚¹ä¸åŸç‚¹è¿æˆçš„ç›´çº¿ä¸Šå­˜åœ¨å¹³é¢ä¸Šçš„nä¸ªç‚¹ä¸­çš„è‡³å°‘ä¸€ä¸ªï¼Œè¾“å‡º1ï¼Œå¯ä»¥åˆ©ç”¨pairæ¥å­˜æ–œç‡ï¼Œæ³¨æ„å½’çº¦åŒ–å¤„ç†</li><li>å¦‚æœç‚¹æ•°&gt;=3ï¼Œè¾“å‡º2ï¼Œåªè¦æœ‰ä¸¤æ¡ç›´çº¿ç›¸äº¤ï¼Œå°±å¯ä»¥å…ˆç§»åˆ°äº¤ç‚¹ï¼Œå†ç§»è¿‡å»</li><li>å½“åªæœ‰2ä¸ªç‚¹æ—¶ï¼Œè€ƒè™‘ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼ˆæ ·ä¾‹å·²ç»æç¤ºï¼‰ï¼ŒåŸç‚¹+è¿™2ä¸ªç‚¹+è¯¢é—®ç‚¹æ„æˆå¹³è¡Œå››è¾¹å½¢ï¼Œæ­¤æ—¶éœ€è¦3æ¬¡ï¼Œå…ˆéšä¾¿ç§»åˆ°æŸä¸ªç‚¹å¤„ï¼Œå†æŒ‰ä¸Šä¸€æ¡çš„åšæ³•</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, x[N], y[N];</span><br><span class="line">map&lt;pii, <span class="type">int</span>&gt; cnt;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!b) <span class="keyword">return</span> a;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">gcd</span>(b, a%b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (x&gt;<span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>); &#125;</span><br><span class="line"><span class="function">pii <span class="title">cal</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = c - a, y = d - b;</span><br><span class="line">  <span class="built_in">assert</span>(x || y);</span><br><span class="line">  <span class="keyword">if</span>(!x) <span class="keyword">return</span> <span class="built_in">mp</span>(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span>(!y) <span class="keyword">return</span> <span class="built_in">mp</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="type">int</span> f = <span class="built_in">sgn</span>(x)*<span class="built_in">sgn</span>(y);</span><br><span class="line">  <span class="type">int</span> t = <span class="built_in">gcd</span>(<span class="built_in">abs</span>(x), <span class="built_in">abs</span>(y));</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">mp</span>(f*x/t, y/t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">  <span class="type">int</span> m = n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; x[i] &gt;&gt; y[i];</span><br><span class="line">    <span class="keyword">if</span>(!x[i]&amp;&amp;!y[i])</span><br><span class="line">    &#123;</span><br><span class="line">      m--;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt[<span class="built_in">cal</span>(<span class="number">0</span>, <span class="number">0</span>, x[i], y[i])]++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="keyword">if</span>(!a&amp;&amp;!b) cout &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(cnt.<span class="built_in">count</span>(<span class="built_in">cal</span>(<span class="number">0</span>, <span class="number">0</span>, a, b))) cout &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">sz</span>(cnt)&lt;=<span class="number">1</span>) cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(m&gt;=<span class="number">3</span>) cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(m==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">cal</span>(<span class="number">0</span>, <span class="number">0</span>, x[<span class="number">1</span>], y[<span class="number">1</span>])==<span class="built_in">cal</span>(x[<span class="number">2</span>], y[<span class="number">2</span>], a, b) &amp;&amp; <span class="built_in">cal</span>(<span class="number">0</span>, <span class="number">0</span>, x[<span class="number">2</span>], y[<span class="number">2</span>])==<span class="built_in">cal</span>(x[<span class="number">1</span>], y[<span class="number">1</span>], a, b)) cout &lt;&lt; <span class="number">3</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D-æœ€å°å…¬å€æ•°"><a class="header-anchor" href="#D-æœ€å°å…¬å€æ•°">Â¶</a>D æœ€å°å…¬å€æ•°</h2><h3 id="é¢˜æ„-s2"><a class="header-anchor" href="#é¢˜æ„-s2">Â¶</a>é¢˜æ„</h3><p>ç»™å‡ºä¸€ä¸ªæ•°nï¼Œè¦æ±‚æ‹†åˆ†æˆkä¸ªæ•°ï¼Œå®šä¹‰æ‹†åˆ†åçš„ä»·å€¼ä¸ºè¯¥åºåˆ—çš„æ‰€æœ‰å­åºåˆ—çš„lcmçš„<strong>ç§ç±»æ•°</strong> ï¼Œæ³¨æ„ç©ºåºåˆ—çš„lcm=1</p><h3 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h3><p>å› ä¸ºç­”æ¡ˆè¦å–æ¨¡ï¼Œæ‰€ä»¥æ„Ÿè§‰æ²¡æ³•æ¯”è¾ƒå¤§å°ï¼Œæ‰€ä»¥åœ¨åšé¢˜çš„æ—¶å€™ä»¥ä¸ºæ˜¯ä¸ªæ„é€ ã€‚ã€‚ã€‚ç„¶åå…¶å®å°±æ˜¯dpè€ƒè™‘æ•°$p_1*p_2$â€‹ï¼Œæ˜¾ç„¶æ²¡æœ‰æ‹†æˆ$p_1, p_2$â€‹ä¸¤ä¸ªæ•°ä¼˜ï¼Œå› ä¸ºå®ƒä»¬çš„è´¡çŒ®æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åè€…æ›´å°ã€‚æ‰€ä»¥æœ€åä¸€å®šæ˜¯æ‹†æˆè‹¥å¹²ä¸ªç´ æ•°çš„å¹‚æ¬¡ã€‚è€ƒè™‘è¿›è¡ŒèƒŒåŒ…dpï¼Œå› ä¸ºå„ä¸ªç´ æ•°çš„è´¡çŒ®å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸€å®šæ˜¯ä»å°å¾€å¤§é€‰ï¼Œå‰100å¤šä¸ªç´ æ•°çš„å’Œå°±è¶…è¿‡$10^5$äº†ï¼Œå¦‚æœå½“å‰è¿™ä¸ªç´ æ•°é€‰äº†kä¸ªï¼Œå³é€‰æ‹©äº†$p_1,p_2 â€¦ p_k$â€‹ï¼Œå‡è®¾ä¹‹å‰æœ‰xä¸ªä¸åŒçš„ç§ç±»ï¼Œé‚£ç°åœ¨å°±æœ‰(k+1)*xä¸ªä¸åŒçš„ç§ç±»ã€‚ä¸‹é¢çš„é—®é¢˜æ˜¯ç”±äºè¦å–æ¨¡ï¼Œæ²¡æ³•æ¯”è¾ƒæœ€åçš„å¤§å°äº†ï¼ˆæ¯’ç˜¤ï¼‰ï¼Œä¸€ç§æ–¹æ³•æ˜¯ç”¨doubleæ¥å­˜ä»·å€¼ï¼Œå¹¶è®°å½•è½¬ç§»è·¯å¾„ï¼Œæœ€ååœ¨å›æº¯çš„æ—¶å€™ç”¨longlongï¼Œå¹¶ä¸”å–æ¨¡ï¼Œå¦ä¸€ç§æ˜¯ç”¨<code>Pair&lt;double, long long&gt;</code>ï¼Œå‰è€…åˆ©ç”¨logå‡½æ•°å°†ä¹˜æ³•è½¬ä¸ºåŠ æ³•ï¼Œåè€…å­˜ç­”æ¡ˆï¼Œå³å–æ¨¡åçš„å€¼ï¼Œç”±äºpairå·²ç»å°è£…å¥½äº†ï¼Œæ‰€ä»¥ç›´æ¥å–maxå³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, prime[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">pair&lt;<span class="type">double</span>,ll&gt; dp[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getprime</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=x; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!vis[i]) prime[++prime[<span class="number">0</span>]] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=prime[<span class="number">0</span>]&amp;&amp;<span class="number">1ll</span>*prime[j]*i&lt;=x; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      vis[prime[j]*i] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="built_in">getprime</span>(n);</span><br><span class="line">  <span class="type">int</span> cur = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(tot&lt;=prime[<span class="number">0</span>]&amp;&amp;cur+prime[tot]&lt;=n) cur += prime[tot++];</span><br><span class="line">  dp[<span class="number">0</span>].se = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;tot; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=n; j&gt;=prime[i]; j--)</span><br><span class="line">    &#123;</span><br><span class="line">      ll t = prime[i], s = t;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; s&lt;=j; s += (t*=prime[i]), k++)</span><br><span class="line">        dp[j] = <span class="built_in">max</span>(dp[j], <span class="built_in">mp</span>(dp[j-s].fi+<span class="built_in">log2</span>(k+<span class="number">1</span>), dp[j-s].se*(k+<span class="number">1</span>)%mod));</span><br><span class="line">    &#125;</span><br><span class="line">  pair&lt;<span class="type">double</span>, ll&gt; ans = &#123;<span class="number">0.0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) ans = <span class="built_in">max</span>(ans, dp[i]);</span><br><span class="line">  cout &lt;&lt; ans.se &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="E-æ¸¸èµ°é…å¯¹"><a class="header-anchor" href="#E-æ¸¸èµ°é…å¯¹">Â¶</a>E æ¸¸èµ°é…å¯¹</h2><h3 id="é¢˜æ„-s3"><a class="header-anchor" href="#é¢˜æ„-s3">Â¶</a>é¢˜æ„</h3><p>æ— å‘å›¾ä¸Šï¼Œæœ‰qä¸ªè“ç‚¹ï¼Œqä¸ªçº¢ç‚¹ï¼Œè¦æ±‚å°†è“ç‚¹å’Œçº¢ç‚¹è¿›è¡Œé…å¯¹ï¼Œæ¯æ¬¡é…å¯¹äº§ç”Ÿçš„è´¹ç”¨æ˜¯ä»–ä»¬è·¯å¾„ä¸Šç»è¿‡çš„æ‰€æœ‰ç‚¹æƒçš„å’Œï¼Œæ­¤å¤–ä¸€ä¸ªç‚¹å¦‚æœè¢«ç»è¿‡äº†kæ¬¡ï¼Œé‚£ä¹ˆå®ƒçš„ç‚¹æƒæ˜¯$a_i + (k-1)*b_i$â€‹ï¼Œé—®æœ€å°çš„é…å¯¹è´¹ç”¨</p><h3 id="åšæ³•-s3"><a class="header-anchor" href="#åšæ³•-s3">Â¶</a>åšæ³•</h3><p>æ•°æ®é‡è¾ƒå°ï¼ŒMCMFã€‚ç”±äºæ˜¯ç‚¹æƒï¼Œæˆ‘ä»¬æ‹†æˆå…¥ç‚¹å’Œå‡ºç‚¹ï¼Œç‚¹æƒæ”¾åœ¨å…¥ç‚¹åˆ°å‡ºç‚¹çš„è¾¹ä¸Šï¼Œå¹¶ä¸”æ‹†é™¤qæ¡è¾¹ï¼Œæ¯æ¡è¾¹æµé‡ä¸º1ï¼Œè´¹ç”¨ä¸ºç¬¬iæ¬¡ç»è¿‡äº§ç”Ÿçš„è´¹ç”¨ï¼Œå†å°†æºç‚¹ä¸qä¸ªè“ç‚¹çš„å…¥ç‚¹ç›¸è¿ï¼Œqä¸ªçº¢ç‚¹çš„å‡ºç‚¹ä¸æ±‡ç›¸è¿ï¼ŒåŸå›¾çš„mæ¡è¾¹ï¼Œåˆ™å°†uçš„å‡ºç‚¹å’Œvçš„å…¥ç‚¹ç›¸è¿ï¼Œvçš„å‡ºç‚¹å’Œuçš„å…¥ç‚¹ç›¸è¿ï¼Œç„¶åè·‘æœ€å°è´¹ç”¨æœ€å¤§æµç®—æ˜¯ç½‘ç»œæµåŸºç¡€é¢˜äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>, M = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, q, m, x[N], y[N];</span><br><span class="line"><span class="type">int</span> cnt, head[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> next, to, w, f;</span><br><span class="line">&#125;e[M&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w,<span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  e[++cnt] = &#123;head[u],v,w,f&#125;;</span><br><span class="line">  head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MCMF</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m, s, t;</span><br><span class="line">  <span class="type">int</span> flow, cost;</span><br><span class="line">  <span class="type">bool</span> inq[N];</span><br><span class="line">  <span class="type">int</span> d[N], p[N], a[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> s,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;n = n, <span class="keyword">this</span>-&gt;s = s, <span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">    cnt = <span class="number">1</span>, m = <span class="number">0</span>, flow = cost = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> cap,<span class="type">int</span> cost)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(u,v,cap,cost);</span><br><span class="line">    <span class="built_in">add</span>(v,u,<span class="number">0</span>,-cost);</span><br><span class="line">    m += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(d,<span class="number">0x3f</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">memset</span>(inq,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    d[s] = <span class="number">0</span>, a[s] = INF;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      inq[u] = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span>(u==t) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].to;</span><br><span class="line">        <span class="keyword">if</span>(e[i].w&amp;&amp;d[v]&gt;d[u]+e[i].f)</span><br><span class="line">        &#123;</span><br><span class="line">          d[v] = d[u] + e[i].f;</span><br><span class="line">          p[v] = i;</span><br><span class="line">          a[v] = <span class="built_in">min</span>(a[u],e[i].w);</span><br><span class="line">          <span class="keyword">if</span>(!inq[v])</span><br><span class="line">          &#123;</span><br><span class="line">            q.<span class="built_in">push</span>(v);</span><br><span class="line">            inq[v] = <span class="number">1</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d[t] != INF;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">spfa</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      flow += a[t];</span><br><span class="line">      cost += a[t] * d[t];</span><br><span class="line">      <span class="type">int</span> u = t;</span><br><span class="line">      <span class="keyword">while</span>(u!=s)</span><br><span class="line">      &#123;</span><br><span class="line">        e[p[u]].w -= a[t];</span><br><span class="line">        e[p[u]^<span class="number">1</span>].w += a[t];</span><br><span class="line">        u = e[p[u]^<span class="number">1</span>].to;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;MM;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class="line">  MM.<span class="built_in">init</span>(<span class="number">2</span>*n+<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>*n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=q; j++)</span><br><span class="line">      MM.<span class="built_in">addedge</span>(i, n+i, <span class="number">1</span>, (j<span class="number">-1</span>)*b+a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> c, d;</span><br><span class="line">    cin &gt;&gt; c &gt;&gt; d;</span><br><span class="line">    MM.<span class="built_in">addedge</span>(c+n, d, q, <span class="number">0</span>);</span><br><span class="line">    MM.<span class="built_in">addedge</span>(d+n, c, q, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++) cin &gt;&gt; x[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++) cin &gt;&gt; y[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    MM.<span class="built_in">addedge</span>(MM.s, x[i], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    MM.<span class="built_in">addedge</span>(y[i]+n, MM.t, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  MM.<span class="built_in">go</span>();</span><br><span class="line">  cout &lt;&lt; MM.cost &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codeforces1361</title>
      <link href="/2020/06/06/codeforces1361/"/>
      <url>/2020/06/06/codeforces1361/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>ç»™å®šä¸€å¼ æ— å‘å›¾ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªæƒå€¼ï¼Œå¦‚æœè®¿é—®uç‚¹ï¼Œäº§ç”Ÿçš„ä»·å€¼æ˜¯ä¸uç›¸è¿çš„æ‰€æœ‰ç‚¹çš„ç‚¹æƒçš„mexï¼Œç»™å®šä»·å€¼åºåˆ—ï¼Œè®©ä½ æ±‚è®¿é—®é¡ºåº</p><p>æ˜¾ç„¶åªè¦æŒ‰ç…§æƒå€¼ä»å°åˆ°å¤§è®¿é—®ï¼Œç„¶åæ¨¡æ‹Ÿä¸€éçœ‹æ˜¯å¦åˆæ³•å³å¯ã€‚<s>æˆ‘TMåœ¨æ’åºé‡Œç”¨äº†ç­‰äºå·ï¼Œä¸€ç›´reï¼Œäººå¿«æ²¡äº†</s> sortçš„æ¯”è¾ƒå‡½æ•°å¿…é¡»æ˜¯ååºçš„</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>æ¯ä¸ªç‰©å“çš„æƒå€¼ä¸º$p^{k_i}$â€‹ï¼Œç»™å®š$p$å’Œ$k_i$â€‹ï¼Œé—®å°†ç‰©å“åˆ†æˆä¸¤å †ï¼Œä½¿æƒå€¼å’Œçš„å·®æœ€å°ï¼Œé—®æœ€å°å€¼ã€‚</p><p>å¯ä»¥çœ‹æˆä¸€ä¸ªpè¿›åˆ¶çš„æ•°ï¼Œæ¯æ¬¡å°†å½“å‰æœ€é«˜ä½ä¸¢å…¥ç¬¬ä¸€å †ï¼Œç„¶åç”¨åé¢çš„æ•°ä¸æ–­è¡¥ç»™ç¬¬äºŒå †ï¼Œç›´åˆ°ä¸ç¬¬ä¸€å †ç›¸ç­‰ï¼Œç„¶åé‡å¤å³å¯ã€‚è®°å½•ä¸¤å †ç›¸å·®çš„pçš„å¹‚æ¬¡å³å¯ï¼Œç»†èŠ‚è¾ƒå¤šæ„Ÿè§‰æœ€è¿‘å†™é¢˜çš„æ­£ç¡®ç‡æœ‰ç‚¹ä½ï¼Œæ€»æ˜¯çŠ¯äº›å¥‡å¥‡æ€ªæ€ªçš„é”™è¯¯ï¼Œå¯¼è‡´è°ƒçš„æ—¶å€™ä¹Ÿå¾ˆçƒ¦</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ç”¨nä¸ªçº¿æ®µï¼Œæ¯ä¸ªçº¿æ®µçš„ç«¯ç‚¹æœ‰æƒå€¼aå’Œbï¼Œè¦æ±‚å°†å®ƒä»¬ä¸²æˆä¸€ä¸ªç¯ï¼Œå®šä¹‰ä¸¤æ¡çº¿æ®µè¿æ¥ç‚¹å¤„çš„æƒå€¼ä¸º$highbit(a^b)$ï¼Œç¯çš„ä»·å€¼ä¸ºæ‰€æœ‰è¿æ¥ç‚¹å¤„ä»·å€¼çš„æœ€å°å€¼ï¼Œé—®ç¯çš„ä»·å€¼æœ€å¤§æ˜¯å¤šå°‘</p><p>æ˜¾ç„¶äºŒåˆ†ä»·å€¼ï¼ˆç”±äºåªæœ‰20ï¼Œç›´æ¥ä»å¤§åˆ°å°æšä¸¾å³å¯ï¼Œè€ƒè™‘å¦‚ä½•checkã€‚å¦‚æœä»·å€¼ä¸ºxï¼Œè¯´æ˜è¿æ¥ç‚¹å¤„ä¸¤ç‚¹æƒå€¼çš„ä½xä½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æŒ‰ç…§a&amp;((1&lt;&lt;k)-1) â€“ b&amp;((1&lt;&lt;k)-1)å»ºå›¾ï¼Œçœ‹æ˜¯å¦å­˜åœ¨æ¬§æ‹‰å›è·¯å³å¯æˆ‘è²Œä¼¼ä¸ä¼šæ¬§æ‹‰å›è·¯æ€ä¹ˆè®°å½•ã€‚ã€‚ã€‚éšä¾¿ä»ä¸€ç‚¹å‡ºå‘æ‰¾å‡ºæ¬§æ‹‰è·¯å¾„ï¼Œçœ‹å…¶é•¿åº¦æ˜¯å¦ä¸ºnï¼Œå†çœ‹<strong>é¦–å°¾è¿æ¥ç‚¹å¤„çš„æƒå€¼æ˜¯å¦æ»¡è¶³è¦æ±‚</strong>ï¼Œæ³¨æ„åœ¨æ‰¾è·¯å¾„å‰è¦å…ˆåˆ©ç”¨åº¦æ•°è¿›è¡Œåˆ¤æ–­ï¼Œå¦åˆ™æ‰¾çš„è·¯å¾„ä¼šå‡ºé—®é¢˜ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰å¯¹äºæ¬§æ‹‰å›¾ï¼ˆå­˜åœ¨æ¬§æ‹‰å›è·¯ï¼‰ï¼Œæ‰€æœ‰ç‚¹åº¦æ•°ä¸€å®šéƒ½æ˜¯å¶æ•°ï¼Œä¸”ä¸ºè¿é€šå›¾ï¼ˆå¯ä»¥ä¸åˆ¤æ–­ï¼Œå› ä¸ºå¦‚æœæ‰¾åˆ°çš„æ¬§æ‹‰è·¯å¾„&lt;nå°±è¯´æ˜ä¸è¿é€šï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = (<span class="number">1</span>&lt;&lt;<span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, a[N], b[N], cur[N], in[N], out[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; path;</span><br><span class="line">vector&lt;pii&gt; G[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> pre)</span> <span class="comment">//æ‰¾æ¬§æ‹‰è·¯å¾„çš„æ¿å­</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(cur[u]&lt;<span class="built_in">sz</span>(G[u]))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = G[u][cur[u]].fi, id = G[u][cur[u]].se;</span><br><span class="line">    ++cur[u];</span><br><span class="line">    <span class="keyword">if</span>(!vis[id])</span><br><span class="line">    &#123;</span><br><span class="line">      vis[id] = vis[id^<span class="number">1</span>] = <span class="number">1</span>; <span class="comment">//æ¯æ¡è¾¹æ­£å‘å’Œåå‘é€‰å…¶1ï¼Œæ‰€ä»¥èµ°äº†ä¸€ä¸ªåï¼Œå¦ä¸€ä¸ªä¹Ÿè¦æ ‡è®°</span></span><br><span class="line">      <span class="built_in">dfs</span>(v, id);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(pre!=<span class="number">-1</span>) path.<span class="built_in">pb</span>(pre);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; a[i] &gt;&gt; b[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">20</span>; k&gt;=<span class="number">0</span>; k--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> c = (<span class="number">1</span>&lt;&lt;k) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=c; i++) G[i].<span class="built_in">clear</span>(), cur[i] = <span class="number">0</span>, in[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=<span class="number">2</span>*n+<span class="number">1</span>; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      G[a[i]&amp;c].<span class="built_in">emplace_back</span>(b[i]&amp;c, <span class="number">2</span>*i);</span><br><span class="line">      G[b[i]&amp;c].<span class="built_in">emplace_back</span>(a[i]&amp;c, <span class="number">2</span>*i+<span class="number">1</span>);</span><br><span class="line">      in[a[i]&amp;c]++, in[b[i]&amp;c]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> ok = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=c&amp;&amp;ok; i++)</span><br><span class="line">      <span class="keyword">if</span>(in[i]&amp;<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!ok) <span class="keyword">continue</span>;</span><br><span class="line">    path.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="built_in">dfs</span>(a[<span class="number">1</span>]&amp;c, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sz</span>(path)&lt;n) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(path[<span class="number">0</span>]%<span class="number">2</span>&amp;&amp;(a[(path[<span class="number">0</span>]<span class="number">-1</span>)/<span class="number">2</span>]&amp;c)!=(a[<span class="number">1</span>]&amp;c)) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(path[<span class="number">0</span>]%<span class="number">2</span>==<span class="number">0</span>&amp;&amp;(b[path[<span class="number">0</span>]/<span class="number">2</span>]&amp;c)!=(a[<span class="number">1</span>]&amp;c)) <span class="keyword">continue</span>;</span><br><span class="line">    cout &lt;&lt; k &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x : path)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(x&amp;<span class="number">1</span>) cout &lt;&lt; x<span class="number">-2</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; x<span class="number">-1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; x<span class="number">-1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lyndon åˆ†è§£</title>
      <link href="/2020/06/03/lyndon-fen-jie/"/>
      <url>/2020/06/03/lyndon-fen-jie/</url>
      
        <content type="html"><![CDATA[<h3 id="æ¦‚å¿µ"><a class="header-anchor" href="#æ¦‚å¿µ">Â¶</a>æ¦‚å¿µ</h3><p>Lyndonä¸²ï¼šsæ˜¯sæ‰€æœ‰åç¼€ä¸­å­—å…¸åºæœ€å°çš„ï¼ˆsæ˜¯å…¶æ‰€æœ‰å¾ªåä½ç§»ä¸­æœ€å°çš„ä¸€ä¸ªï¼‰Lyndonåˆ†è§£ï¼šLyndon åˆ†è§£æ˜¯å°†å­—ç¬¦ä¸² s åˆ†è§£æˆ $s=s_1s_2 \dots s_n$â€‹,ä½¿å¾—æ¯ä¸ª$s_i$â€‹éƒ½æ˜¯Lyndonä¸²ï¼Œä¸”$s_i\geq s_{i+1}$</p><h3 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h3><p>Lyndonåˆ†è§£å”¯ä¸€ï¼Œä¸”æ¯ä¸ªå­—ç¬¦ä¸²éƒ½å­˜åœ¨Lyndonåˆ†è§£ã€‚</p><h3 id="Duval-ç®—æ³•"><a class="header-anchor" href="#Duval-ç®—æ³•">Â¶</a>Duval ç®—æ³•</h3><p>$O(n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> j = i, k = i+<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(k&lt;=n&amp;&amp;s[j]&lt;=s[k])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(s[j]&lt;s[k]) j = i;</span><br><span class="line">    <span class="keyword">else</span> j++;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=j)</span><br><span class="line">  &#123;</span><br><span class="line">    ans ^= i+k-j<span class="number">-1</span>;  <span class="comment">// [i:i+k-j-1]æ˜¯æŸä¸ªåˆ†è§£çš„s_i</span></span><br><span class="line">    i += k-j;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€å°è¡¨ç¤ºæ³•åªè¦å¯¹s+sè¿›è¡ŒLyndonåˆ†è§£å¹¶æ‰¾åˆ°æœ€åä¸€ä¸ªåˆ†è§£çš„ä¸²çš„èµ·ç‚¹å–é•¿åº¦nå³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Stern-Brocot æ ‘ä¸ Farey åºåˆ—</title>
      <link href="/2020/06/03/stern-brocot-shu-yu-farey-xu-lie/"/>
      <url>/2020/06/03/stern-brocot-shu-yu-farey-xu-lie/</url>
      
        <content type="html"><![CDATA[<h2 id="Stern-Brocot-æ ‘"><a class="header-anchor" href="#Stern-Brocot-æ ‘">Â¶</a>Stern-Brocot æ ‘</h2><h3 id="æ„é€ "><a class="header-anchor" href="#æ„é€ ">Â¶</a>æ„é€ </h3><p>ä»ä¸¤ä¸ªæœ€ç®€å•çš„åˆ†æ•°å¼€å§‹ï¼š $\dfrac 01 \quad \dfrac 10$æ¯æ¬¡åœ¨ç›¸é‚»çš„ä¸¤ä¸ªåˆ†æ•°$\dfrac {a}{b} \quad \dfrac{c}{d}$â€‹ä¸­é—´æ’å…¥ä¸€ä¸ªåˆ†æ•°$\dfrac{a+c}{b+d}$â€‹å³å¯</p><h3 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h3><ul><li><p>æ¯ä¸€å±‚çš„åºåˆ—ä¸­ï¼Œåˆ†æ•°å•è°ƒé€’å¢ï¼Œå³$\dfrac {a}{b} &lt; \dfrac{a+c}{b+d} &lt; \dfrac{c}{d}$è¿™æ˜¯ä¸€æ£µå¹³è¡¡æ ‘ï¼Œä¸­åºéå†æ˜¯æœ‰åºçš„ï¼ˆå»ºæ ‘ã€æŸ¥æ‰¾ï¼‰</p></li><li><p>æ¯ä¸ªåˆ†æ•°éƒ½æ˜¯æœ€ç®€åˆ†æ•°</p></li><li><p>å¯ä»¥è¡¨ç¤ºå‡º<strong>æ‰€æœ‰</strong>çš„æœ€ç®€åˆ†æ•°ï¼Œæ¯ä¸ªåˆ†æ•°å”¯ä¸€</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> a = <span class="number">0</span>, <span class="type">int</span> b = <span class="number">1</span>, <span class="type">int</span> c = <span class="number">1</span>, <span class="type">int</span> d = <span class="number">0</span>, <span class="type">int</span> level = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = a + c, y = b + d;</span><br><span class="line">  <span class="comment">// ... output the current fraction x/y</span></span><br><span class="line">  <span class="comment">// at the current level in the tree</span></span><br><span class="line">  <span class="built_in">build</span>(a, b, x, y, level + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">build</span>(x, y, c, d, level + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Fareyåºåˆ—"><a class="header-anchor" href="#Fareyåºåˆ—">Â¶</a>Fareyåºåˆ—</h2><p>Fiï¼šæŠŠåˆ†æ¯å°äºç­‰äºiçš„æ‰€æœ‰æœ€ç®€çœŸåˆ†æ•°æŒ‰å¤§å°é¡ºåºæ’åˆ—å½¢æˆçš„åºåˆ—ã€‚å¯ä»¥é€šè¿‡SBæ ‘çš„æ–¹æ³•ç±»ä¼¼æ„é€ é•¿åº¦ï¼š$L_i = L_{i-1} + \phi(i)$$L_i = 1 + \sum_{j=1}^n \phi(j)$åˆ†æ¯æ¯å¢å¤§1ï¼Œå¯ä»¥å¤šphi(i)ä¸ªæœ€ç®€çœŸåˆ†æ•°ï¼Œå³ä¸iäº’è´¨</p><p>æ±‚$f(x) = \dfrac{k}{x}$ ä¸ $g(x) = x^{\frac12}$â€‹çš„äº¤ç‚¹çš„æ¨ªåæ ‡çš„æœ€æ¥è¿‘çš„åˆ†æ•°ï¼Œè¦æ±‚åˆ†æ¯å°äº$10^5$ç›¸å½“äºè¦æ‰¾åˆ°æœ€æ¥è¿‘$k^\frac13$â€‹çš„åˆ†æ•°ä»¤åˆå§‹åˆ†æ•°ä¸ºa = x-1, b = 1, c = x, d = 1ç„¶ååœ¨SBæ ‘ä¸Šä¸æ–­è¿­ä»£é è¿‘å³å¯ï¼ˆç±»ä¼¼äºŒåˆ†çš„è¿‡ç¨‹ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll x, k;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;k);</span><br><span class="line">    x = <span class="number">1</span>;</span><br><span class="line">    k = k*k;</span><br><span class="line">    <span class="keyword">while</span>(x*x*x&lt;k) x++;</span><br><span class="line">    <span class="keyword">if</span>(x*x*x==k) <span class="built_in">printf</span>(<span class="string">&quot;%lld/1\n&quot;</span>, x);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ll a = x<span class="number">-1</span>, b = <span class="number">1</span>, c = x, d = <span class="number">1</span>, p = <span class="number">0</span>, q = <span class="number">0</span>;</span><br><span class="line">      <span class="type">long</span> <span class="type">double</span> delta = <span class="built_in">min</span>(x*x*x-k, k-(x<span class="number">-1</span>)*(x<span class="number">-1</span>)*(x<span class="number">-1</span>));</span><br><span class="line">      <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        ll x = a + c, y = b + d;</span><br><span class="line">        <span class="keyword">if</span>(y&gt;<span class="number">100000</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="type">long</span> <span class="type">double</span> tmp = (<span class="type">long</span> <span class="type">double</span>)x*x*x/(y*y*y);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(tmp-k)&lt;delta)</span><br><span class="line">        &#123;</span><br><span class="line">          delta = <span class="built_in">fabs</span>(tmp-k);</span><br><span class="line">          p = x, q = y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(tmp&gt;k) c = x, d = y;</span><br><span class="line">        <span class="keyword">else</span> a = x, b = y;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%lld/%lld\n&quot;</span>, p, q);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YsOI2020 å¹¼å„¿å›­ æ€ç»´</title>
      <link href="/2020/06/02/ysoi2020you-er-yuan-si-wei/"/>
      <url>/2020/06/02/ysoi2020you-er-yuan-si-wei/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šæœ‰å‘å›¾ï¼Œnä¸ªç‚¹mæ¡è¾¹ï¼Œæ¯æ¡è¾¹æœ‰æƒå€¼iï¼Œä¸”æ°å¥½æ˜¯1-mçš„ä¸€ä¸ªæ’åˆ—ï¼Œå¤šæ¬¡è¯¢é—®ä»xç‚¹åªèµ°$[l,r]$çš„è¾¹ï¼Œä¸”è¾¹æƒä¸¥æ ¼å•è°ƒä¸‹é™èƒ½å¦åˆ°è¾¾1å·ç‚¹ï¼Œå¼ºåˆ¶åœ¨çº¿</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>é™åˆ¶äº†è¾¹æƒçš„èŒƒå›´$[l, r]$ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè€ƒè™‘$[1,r]$çš„æ—¶å€™æ€ä¹ˆåšï¼Œè€ƒè™‘dp[u]è¡¨ç¤ºuå·ç‚¹ä¸1è¿é€šéœ€è¦çš„æœ€å°è¾¹æƒï¼Œä»å°åˆ°å¤§æšä¸¾æ¯ä¸€æ¡è¾¹ï¼Œå¦‚æœè¯¥ç‚¹ä¸1ç›¸è¿ï¼Œåˆ™dp[u]=wï¼Œå¦åˆ™å¦‚æœdp[v]æœ‰å€¼ï¼Œåˆ™dp[u]=iï¼Œç„¶ååªè¦çœ‹dp[u]æ˜¯ä¸æ˜¯å°äºrå³å¯åŠ å…¥ä¸‹ç•Œé™åˆ¶åï¼Œå°†dp[u]è½¬åŒ–ä¸ºä¸1è¿é€šæ—¶éœ€è¦ç»è¿‡çš„æœ€å°è¾¹æƒ<strong>æœ€å¤§</strong>æ˜¯å¤šå°‘ï¼Œå¦‚æœè¯¥ç‚¹ä¸1ç›¸è¿ï¼Œåˆ™dp[u]=iï¼Œå¦åˆ™dp[u]=max(dp[u],dp[v])ï¼Œéšç€ä»å°åˆ°å¤§æšä¸¾è¾¹æƒdpï¼Œdp[u]æ˜¯ä¸æ–­å˜å¤§çš„ï¼Œè€ƒè™‘æŒ‰ç…§æšä¸¾é¡ºåºå»ºç«‹ä¸»å¸­æ ‘ï¼Œæ¯æ¬¡å•ç‚¹æ›´æ–°uç‚¹çš„å€¼ï¼Œè¯¢é—®åªè¦æŸ¥è¯¢rt[r]ç‰ˆæœ¬çš„ä¸»å¸­æ ‘ä¸­xç‚¹çš„å€¼æ˜¯å¦&gt;=lå³å¯ã€‚ç›¸å½“äºæ¯ä¸ªç‚¹å¤„æœ‰å¾ˆå¤šå•è°ƒé€’å¢çš„äºŒç»´ç‚¹ï¼ˆxåæ ‡ä¸ºè¾¹æƒï¼Œyåæ ‡ä¸ºdpï¼‰ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªç‚¹ç”¨vectorå­˜è¿™äº›ç‚¹ï¼Œé‚£ä¹ˆåªè¦çœ‹x&lt;=rçš„æœ€åä¸€ä¸ªç‚¹çš„yæ˜¯å¦&gt;=lã€‚</p><h3 id="æ€è€ƒ"><a class="header-anchor" href="#æ€è€ƒ">Â¶</a>æ€è€ƒ</h3><p>ä¸¥æ ¼å•è°ƒä¸‹é™çš„é™åˆ¶åªè¦é€šè¿‡ä»å°åˆ°å¤§çš„é¡ºåºdpå³å¯è§£å†³ï¼Œå¯¹äºæ—¢æœ‰ä¸Šç•Œåˆæœ‰ä¸‹ç•Œçš„é™åˆ¶ï¼Œè€ƒè™‘æšä¸¾ä¸Šç•Œï¼Œç„¶åæœ€å¤§åŒ–ä¸‹ç•Œå³å¯</p><p>ä¸»å¸­æ ‘å†™æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, k, w, dp[N];</span><br><span class="line">pii edges[N];</span><br><span class="line"><span class="keyword">namespace</span> PSegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls(x) t[x].l</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs(x) t[x].r</span></span><br><span class="line">  <span class="type">int</span> rt[N], tot;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, mx;</span><br><span class="line">  &#125;t[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[++tot] = t[p];</span><br><span class="line">    p = tot;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">newnode</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      t[p].mx = <span class="built_in">max</span>(t[p].mx, v);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(<span class="built_in">ls</span>(p), l, mid, x, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">upd</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x, v);</span><br><span class="line">    t[p].mx = <span class="built_in">max</span>(t[<span class="built_in">ls</span>(p)].mx, t[<span class="built_in">rs</span>(p)].mx);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[p].mx;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="built_in">ls</span>(p), l, mid, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> PSegTree;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k, &amp;w);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;edges[i].fi, &amp;edges[i].se);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = edges[i].fi, v = edges[i].se;</span><br><span class="line">    <span class="keyword">if</span>(v==<span class="number">1</span>) dp[u] = i;</span><br><span class="line">    <span class="keyword">else</span> dp[u] = <span class="built_in">max</span>(dp[u], dp[v]);</span><br><span class="line">    rt[i] = rt[i<span class="number">-1</span>];</span><br><span class="line">    <span class="built_in">upd</span>(rt[i], <span class="number">1</span>, m, u, dp[u]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> L = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x, l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;l, &amp;r);</span><br><span class="line">    <span class="keyword">if</span>(w) x ^= L, l ^= L, r ^= L;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1</span>||<span class="built_in">ask</span>(rt[r], <span class="number">1</span>, m, x)&gt;=l) ++L, <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF893F Subtree Minimum Query ä¸»å¸­æ ‘trick</title>
      <link href="/2020/06/02/cf893f-subtree-minimum-query-zhu-xi-shu-trick/"/>
      <url>/2020/06/02/cf893f-subtree-minimum-query-zhu-xi-shu-trick/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šä¸€æ£µæœ‰ç‚¹æƒçš„æ ‘ï¼Œæ¯æ¬¡è¯¢é—®ç‚¹uå­æ ‘ä¸­è·ç¦»u&lt;=kçš„ç‚¹çš„ç‚¹æƒçš„æœ€å°å€¼ï¼Œè¦æ±‚åœ¨çº¿å›ç­”</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è¯¢é—®å­æ ‘ï¼Œè€ƒè™‘dfsåºï¼Œå³è¯¢é—®$[in[u]ï¼šout[u]]$$[dep[u]ï¼šdep[u]+k]$ä¸­çš„min{a}äºŒç»´ååºï¼Œå‘ç°æ¯ä¸ªdfsåºå¯¹åº”äº†ä¸€ä¸ªç‚¹ï¼ŒæŒ‰ç…§æ·±åº¦å»ºä¸»å¸­æ ‘ï¼Œæ¯ä¸ªç‰ˆæœ¬çš„ä¸»å¸­æ ‘ç»´æŠ¤çš„æ˜¯$[1,dep[u]]$è¿™ä¸ªæ·±åº¦å‰ç¼€ä¸­dfsåºåŒºé—´çš„æœ€å°å€¼ï¼ŒæŒ‰ç…§bfsæ·±åº¦é¡ºåºæ›´æ–°ã€‚è¯¢é—®çš„æ—¶å€™åªè¦ask dep[u]+kç‰ˆæœ¬çš„ä¸»å¸­æ ‘ä¸­[in[u], out[u]]åŒºé—´çš„æœ€å°å€¼å³å¯</p><p>ä¸€äº›ä¸ä¸€å®šå¯¹çš„æ€è€ƒï¼šçº¿æ®µæ ‘å¯ä»¥é«˜æ•ˆç»´æŠ¤ä¸€æ®µåŒºé—´çš„ä¿¡æ¯ï¼Œè€Œä¸»å¸­æ ‘å¯ä»¥ç»´æŠ¤å„ä¸ªç‰ˆæœ¬çš„çº¿æ®µæ ‘ï¼Œæ¯ä¸ªç‰ˆæœ¬ç»´æŠ¤çš„æ˜¯å®ƒåŠå…¶ä¹‹å‰çš„æ‰€æœ‰ç‰ˆæœ¬çš„å‰ç¼€ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸»å¸­æ ‘å¯ä»¥ç»´æŠ¤äºŒç»´çš„ä¿¡æ¯ï¼Œé€šè¿‡è½¬å˜ç»´åº¦ï¼Œå·§å¦™çš„åˆ©ç”¨æŸä¸€ç»´æ¥å»ºæ ‘å¯ä»¥è§£å†³å¾ˆå¤šé—®é¢˜ã€‚è¯¥é¢˜ä¸­æœ€å°å€¼ä¸å¯å‡ï¼Œæ‰€ä»¥åªèƒ½è¯¢é—®å‰ç¼€ï¼Œè€Œä¸èƒ½è¯¢é—®rt[l]-rt[r]ï¼Œä½†æ˜¯åœ¨è¯¥dfsåºä¸­çš„ç‚¹dep[u]éƒ½æ˜¯ç¬¦åˆæ¡ä»¶çš„ï¼Œæ‰€ä»¥æ²¡æœ‰é—®é¢˜ã€‚å†è¯´å¸¦ä¿®çš„ä¸»å¸­æ ‘ï¼Œç”±äºä¸»å¸­æ ‘ç»´æŠ¤çš„æ˜¯æ¯ä¸ªç‰ˆæœ¬çš„å‰ç¼€ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨ä¿®æ”¹çš„æ—¶å€™éœ€è¦ä¿®æ”¹åé¢æ¯ä¸ªç‰ˆæœ¬çš„ä¿¡æ¯ï¼Œæ‰€ä»¥è€ƒè™‘åœ¨å¤–å±‚å¥—ä¸€ä¸ªæ ‘çŠ¶æ•°ç»„ï¼Œæ­¤æ—¶æ ‘çŠ¶æ•°ç»„ä¸­æ¯æ£µä¸»å¸­æ ‘ç»´æŠ¤çš„ä¸å†æ˜¯å‰ç¼€ä¿¡æ¯äº†ï¼Œä¸éœ€è¦ç»§æ‰¿å‰ä¸€ä¸ªç‰ˆæœ¬(rt[i]=rt[i-1])ï¼Œæ¯æ¬¡çš„æŸ¥è¯¢å’Œè¯¢é—®æ“ä½œéƒ½åªä¸logæ£µä¸»å¸­æ ‘ç›¸å…³</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, r, a[N], in[N], out[N], dfn, dep[N];</span><br><span class="line"><span class="type">int</span> m, p, q, mxdep;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="keyword">namespace</span> PSegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls(x) t[x].l</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs(x) t[x].r</span></span><br><span class="line">  <span class="type">int</span> rt[N], tot;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, mn;</span><br><span class="line">  &#125;t[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[++tot] = t[p];</span><br><span class="line">    p = tot;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">newnode</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      t[p].mn = <span class="built_in">min</span>(t[p].mn, v);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(<span class="built_in">ls</span>(p), l, mid, x, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">upd</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x, v);</span><br><span class="line">    t[p].mn = <span class="built_in">min</span>(t[<span class="built_in">ls</span>(p)].mn, t[<span class="built_in">rs</span>(p)].mn);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=ql&amp;&amp;r&lt;=qr) <span class="keyword">return</span> t[p].mn;</span><br><span class="line">    <span class="type">int</span> ans = INF, mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql&lt;=mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(<span class="built_in">ls</span>(p), l, mid, ql, qr));</span><br><span class="line">    <span class="keyword">if</span>(qr&gt;mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, ql, qr));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> PSegTree;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  in[u] = ++dfn;</span><br><span class="line">  dep[u] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">  mxdep = <span class="built_in">max</span>(mxdep, dep[u]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  out[u] = dfn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(r);</span><br><span class="line">  <span class="type">int</span> curd = <span class="number">0</span>;</span><br><span class="line">  rt[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  t[<span class="number">0</span>].mn = INF;</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">sz</span>(q))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(dep[u]&gt;curd)</span><br><span class="line">    &#123;</span><br><span class="line">      rt[dep[u]] = rt[curd];</span><br><span class="line">      curd = dep[u];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">upd</span>(rt[dep[u]], <span class="number">1</span>, n, in[u], a[u]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">      <span class="keyword">if</span>(dep[v]==dep[u]+<span class="number">1</span>) q.<span class="built_in">push</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;r);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    G[x].<span class="built_in">pb</span>(y); G[y].<span class="built_in">pb</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(r, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">bfs</span>();</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">  <span class="type">int</span> lstans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;p, &amp;q);</span><br><span class="line">    p = (p+lstans)%n + <span class="number">1</span>;</span><br><span class="line">    q = (q+lstans)%n;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, lstans=<span class="built_in">ask</span>(rt[<span class="built_in">min</span>(mxdep, dep[p]+q)], <span class="number">1</span>, n, in[p], out[p]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P6583 å›é¦–è¿‡å» æ•°è®º+æ•´é™¤åˆ†å—</title>
      <link href="/2020/06/02/p6583-hui-shou-guo-qu-shu-lun-zheng-chu-fen-kuai/"/>
      <url>/2020/06/02/p6583-hui-shou-guo-qu-shu-lun-zheng-chu-fen-kuai/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®š$n&lt;=10^{12}$è¯¢é—®$\sum_{x=1}^n \sum_{y=1}^n \left[ \dfrac{x}{y}\text{æ˜¯æœ‰é™å°æ•°}\right]$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å½“çœŸåˆ†æ•°$\dfrac {x}{y}$â€‹ä¸­åˆ†æ¯yä¸º$2^p5^q$çš„å½¢å¼æ—¶æ‰ä¸ºæœ‰é™å°æ•°å³å¯ä»¥è¡¨ç¤ºæˆ$\dfrac {d*gcd(x, y)}{2^p5^qgcd(x,y)}$è€ƒè™‘æšä¸¾åˆ†æ¯yï¼Œåˆ™å¯è¡Œçš„xçš„ä¸ªæ•°ä¸º$\left \lfloor \dfrac {n}{\zeta(y)} \right\rfloor$ï¼Œ$\zeta(y)$è¡¨ç¤ºå°äºç­‰äºyçš„æœ€å¤§çš„ä¸å«2å’Œ5çš„å› å­çš„æ•´æ•°ï¼Œç›¸å½“äºæ˜¯gcd(x, y)è¿™æ ·æ˜¯O(n)çš„ï¼Œè€ƒè™‘æ”¹å˜æšä¸¾é¡ºåºæšä¸¾$\zeta(y)$ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯$\sum_{k=1}^n [2 \nmid k][5\nmid k] \left \lfloor \dfrac {n}{k} \right \rfloor g(\left \lfloor \dfrac{n}{k} \right \rfloor)$æ˜¾ç„¶å¯ä»¥æ•´é™¤åˆ†å—ï¼Œå…¶ä¸­g(i)ä»£è¡¨å°äºç­‰äºiçš„ä¸”èƒ½è¡¨ç¤ºæˆ$2^p5^q$çš„æ•°çš„ä¸ªæ•°ï¼ˆç›¸å½“äºæ˜¯è´¡çŒ®æ¬¡æ•°ï¼‰ã€‚ç„¶åå¯ä»¥é€šè¿‡å®¹æ–¥è®¡ç®—å‡ºåŒºé—´å†…ä¸è¢«2å’Œ5æ•´é™¤çš„æ•°çš„ä¸ªæ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll n;</span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x - x/<span class="number">2</span> - x/<span class="number">5</span> + x/<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">g</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(ll i=<span class="number">1</span>; i&lt;=x; i*=<span class="number">2</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(ll j=<span class="number">1</span>; j&lt;=x; j*=<span class="number">5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(i*j&gt;x) <span class="keyword">break</span>;</span><br><span class="line">      ans++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(ll l=<span class="number">1</span>,r; l&lt;=n; l=r+<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    r = <span class="built_in">min</span>(n, n/(n/l));</span><br><span class="line">    ans += (<span class="built_in">f</span>(r) - <span class="built_in">f</span>(l<span class="number">-1</span>))*(n/l)*<span class="built_in">g</span>(n/l);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019ICPC å¾å·</title>
      <link href="/2020/05/31/2019icpc-xu-zhou/"/>
      <url>/2020/05/31/2019icpc-xu-zhou/</url>
      
        <content type="html"><![CDATA[<h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>æš´åŠ›æ‰“è¡¨å³å¯ï¼Œä¸è¿‡åœ¨æˆ‘ç”µè„‘ä¸Šè·‘çš„æŒºæ…¢çš„ã€‚ã€‚</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ç´ æ•°å¯†åº¦æ˜¯ä¸æ–­å˜å°çš„</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>åˆ©ç”¨è¿ç»­æ•´æ•°å¼‚æˆ–å’Œçš„trickå³å¯ï¼Œåªè¦å°èŒƒå›´æšä¸¾å·¦å³ä¸¤ç«¯ç‚¹ï¼Œä¸­é—´ä¸€å¤§æ®µå¤§æ¦‚ç‡å¯ä»¥æ˜¯0</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>æ±‚å‡º$\frac{Y!} {\prod {a_i}}$â€‹æ˜¯Xçš„å¤šå°‘æ¬¡æ–¹çš„å€æ•°åˆ©ç”¨pollardrhoæ±‚è§£Xçš„æ‰€æœ‰ç´ å› å­ï¼Œç„¶åæ±‚å‡ºå„ä¸ªé˜¶ä¹˜ä¸­å„ç´ å› å­å¹‚æ¬¡çš„æ•°é‡ï¼Œä¹˜æ³•+ï¼Œé™¤æ³•-ï¼Œæœ€åæ¯ä¸ªç´ å› å­å–ä¸ªminï¼Œæ³¨æ„è´Ÿæ•°å’Œæ­£æ•°ä¸Šä¸‹å–æ•´çš„é—®é¢˜</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´è¯¢é—®è¯¥æ®µåŒºé—´æœ€å°çš„ä¸èƒ½è¢«è¡¨ç¤ºçš„æ•°æ´›è°·p4587+ä¿®æ”¹å…ˆè€ƒè™‘ä¸å¸¦ä¿®æ”¹çš„æƒ…å†µï¼Œå¯¹[l,r]å†…çš„æ•°ä»å°åˆ°å¤§è€ƒè™‘ï¼Œå‡è®¾å½“å‰èƒ½å¤Ÿè¡¨ç¤ºå‡º[1,cur]çš„èŒƒå›´ï¼Œå¦‚æœè¯¢é—®[1,cur+1]çš„å€¼ç­‰äºcurï¼Œè¯´æ˜å‰©ä½™çš„å€¼éƒ½æ˜¯å¤§äºç­‰äºcur+2çš„ï¼Œæ­¤æ—¶cur+1æ˜¯æ— æ³•è¢«è¡¨ç¤ºå‡ºæ¥çš„ï¼Œæ‰€ä»¥breakï¼Œå®¹æ˜“å‘ç°è¯¥æ“ä½œä¸­curçš„å¢é•¿é€Ÿåº¦æ˜¯fibnacciçº§åˆ«çš„ï¼Œåˆ©ç”¨ä¸»å¸­æ ‘å®ŒæˆäºŒç»´æ•°ç‚¹é—®é¢˜ã€‚è‡³äºä¿®æ”¹ï¼Œåœ¨å¤–å±‚å¥—ä¸€ä¸ªæ ‘çŠ¶æ•°ç»„å³å¯ï¼Œå¤æ‚åº¦$O(n \log^3 n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>, up = <span class="number">2e5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, a[N];</span><br><span class="line"><span class="keyword">namespace</span> PSegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls(x) t[x].l</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs(x) t[x].r</span></span><br><span class="line">  <span class="type">int</span> rt[N], tot;</span><br><span class="line">  <span class="type">int</span> lrt[N], rrt[N], lc, rc;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    ll sum;</span><br><span class="line">  &#125;t[N*<span class="number">128</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p) p = ++tot;</span><br><span class="line">    t[p].sum += x*v;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">insert</span>(<span class="built_in">ls</span>(p), l, mid, x, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">insert</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">ll <span class="title">ask</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      ll ans = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) ans -= t[lrt[i]].sum;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) ans += t[rrt[i]].sum;</span><br><span class="line">      <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lrt[i] = <span class="built_in">ls</span>(lrt[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) rrt[i] = <span class="built_in">ls</span>(rrt[i]);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">ask</span>(l, mid, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ll ans = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) ans -= t[<span class="built_in">ls</span>(lrt[i])].sum;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) ans += t[<span class="built_in">ls</span>(rrt[i])].sum;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lrt[i] = <span class="built_in">rs</span>(lrt[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) rrt[i] = <span class="built_in">rs</span>(rrt[i]);</span><br><span class="line">      <span class="keyword">return</span> ans + <span class="built_in">ask</span>(mid+<span class="number">1</span>, r, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> PSegTree;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) <span class="built_in">insert</span>(rt[i], <span class="number">1</span>, up, a[x], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  lc = rc = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l<span class="number">-1</span>; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) lrt[++lc] = rt[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=r; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) rrt[++rc] = rt[i];</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="number">1</span>, up, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">upd</span>(i, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, x, y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">upd</span>(x, <span class="number">-1</span>);</span><br><span class="line">      a[x] = y;</span><br><span class="line">      <span class="built_in">upd</span>(x, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ll cur = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        ll sum = <span class="built_in">query</span>(x, y, <span class="built_in">min</span>((ll)up, cur+<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">if</span>(sum==cur) <span class="keyword">break</span>;</span><br><span class="line">        cur = sum;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, cur+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>â€œç§‘æ—æ˜ä¼¦æ¯â€å“ˆå°”æ»¨ç†å·¥å¤§å­¦ç¬¬åå±Šç¨‹åºè®¾è®¡ç«èµ›</title>
      <link href="/2020/05/31/ke-lin-ming-lun-bei-ha-er-bin-li-gong-da-xue-di-shi-jie-cheng-xu-she-ji-jing-sai/"/>
      <url>/2020/05/31/ke-lin-ming-lun-bei-ha-er-bin-li-gong-da-xue-di-shi-jie-cheng-xu-she-ji-jing-sai/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>ç»™å®šä¸€æ£µæ ‘ï¼Œå®šä¹‰ç‚¹å¯¹ï¼ˆs, tï¼‰é—´è·ç¦»ä¸º<strong>è·¯å¾„ä¸Šè¾¹æƒå’Œ+så’Œtçš„ç‚¹æƒå’Œ</strong>dpè®°å½•æ¯ä¸ªç‚¹å­æ ‘ä¸­åˆ°è¯¥ç‚¹çš„æœ€å¤§å’Œæ¬¡å¤§è·ç¦»å³å¯æ¯”èµ›çš„æ—¶å€™ç”¨æ ‘ç›´å¾„ä¸¤æ¬¡dfsçš„æ–¹æ³•waäº†ï¼Œåº”è¯¥æ˜¯æœ‰é—®é¢˜</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™å®šnä¸ªæ•°ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€æ®µåŒºé—´ï¼Œä½¿åŒºé—´-1ï¼Œé—®æœ€å°‘å‡ æ¬¡æ“ä½œå¯ä»¥ä½¿æ‰€æœ‰æ•°å˜ä¸º1åŒºé—´æ“ä½œåˆ©ç”¨å·®åˆ†å°±å¯ä»¥è½¬åŒ–æˆä¸¤æ¬¡å•ç‚¹æ“ä½œï¼Œå†è´ªå¿ƒè€ƒè™‘å°±å¾ˆç®€å•äº†</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>å°å­¦æ•°å­¦</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>æ¡ä»¶æ¦‚ç‡ï¼Œ$P(A|B) = \frac {P(AB)} {P(B)}$P(AB):è‡³å°‘mæšç¡¬å¸æ˜¯åé¢ï¼Œä¸”æ°å¥½kæšç¡¬å¸æ˜¯æ­£é¢åŒæ—¶å‘ç”Ÿï¼Œç”±äºæ­£é¢å›ºå®šï¼Œæ‰€ä»¥åé¢ä¸ºn-kï¼Œå½“$n-k&lt;m$æ—¶æ¦‚ç‡ä¸º0,å¦åˆ™ä¸º$C(n,k)/(2^n)$P(B):ä»måˆ°næšä¸¾åé¢ç¡¬å¸ä¸ªæ•°ï¼Œ$\sum_{i=m}^{n} C(n,i)/(2^n)$ä»£å…¥å…¬å¼å³å¯</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ç®€å•è´ªå¿ƒï¼Œä»å°åˆ°å¤§å»æˆ˜èƒœï¼Œå¹¶ä¸”æ¯æ¬¡ç”¨åˆšå¥½å¤§äºçš„é‚£ä¸ª</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>æ˜¾ç„¶æ˜¯ä¸ªfibonacciï¼Œæ•°æ®èŒƒå›´æœ‰ç‚¹å‘ï¼Œæˆ‘å¼€äº†ullè¿˜æ˜¯waï¼Œæ”¹æˆpyå°±è¿‡äº†ğŸ˜¡ğŸ˜¤</p><h2 id="G"><a class="header-anchor" href="#G">Â¶</a>G</h2><p>æ˜¾ç„¶æœ€å¤§æµ</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>æ¯å¢åŠ ä¸€æ¡è¾¹ï¼Œæœ€å¤šå¯ä»¥ä¸ä¹‹å‰çš„æ‰€æœ‰ç›´çº¿éƒ½äº§ç”Ÿä¸€ä¸ªäº¤ç‚¹èœœæ±æ•°æ®èŒƒå›´ï¼Œåˆè¦å¤§æ•°ï¼Œä¸è¿‡pyä¸é¦™å—</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>ç»™å®šnä¸ªæ•°ï¼Œå®šä¹‰nä¸ªæ•°ç»„ï¼Œç¬¬iä¸ªæ•°ç»„ä¸ºåˆ å»$a_i$â€‹åå½¢æˆçš„ï¼Œé—®è¿™nä¸ªæ•°ç»„å­—å…¸åºä»å¤§åˆ°å°çš„æ’åˆ—é¡ºåºè€ƒè™‘ç›¸é‚»ä¸¤ä¸ªæ•°$a_i, a_{i+1}$</p><ul><li>$a_i &lt; a_{i+1}$â€‹ iæ¯”åé¢æ‰€æœ‰çš„éƒ½è¦åŠ£</li><li>$a_i &gt; a_{i+1}$ iæ¯”åé¢æ‰€æœ‰çš„éƒ½è¦ä¼˜</li><li>$a_i = a_{i+1}$â€‹ iæ¯”i+1ä¼˜è€ƒè™‘å°†ç›¸åŒçš„ä¸€èµ·è€ƒè™‘ï¼Œç„¶åç”¨ä¸¤ä¸ªæ ˆæ¥æ¨¡æ‹Ÿå³å¯</li></ul><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>é—®ä¸€ä¸ªä¸²ä¸­æœ€é•¿çš„ä¸å‰ç¼€ç›¸åŒçš„éå‰ç¼€ä¸²çš„é•¿åº¦æ¯”èµ›çš„æ—¶å€™æ— è„‘äºŒåˆ†+kmpnext[i]è¡¨ç¤ºs[0:i]è¿™ä¸ªå‰ç¼€ä¸åç¼€ç›¸åŒçš„æœ€é•¿é•¿åº¦ï¼ˆå‰ç¼€æœ€é•¿borderï¼‰ï¼Œæ‰€ä»¥æ‰€æœ‰nextå–ä¸ªmaxå³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦é—¨å¤§å­¦â€œç½‘å®¿æ¯â€œ17å±Šç¨‹åºè®¾è®¡ç«èµ›å†³èµ›</title>
      <link href="/2020/05/31/sha-men-da-xue-wang-su-bei-17-jie-cheng-xu-she-ji-jing-sai-jue-sai/"/>
      <url>/2020/05/31/sha-men-da-xue-wang-su-bei-17-jie-cheng-xu-she-ji-jing-sai-jue-sai/</url>
      
        <content type="html"><![CDATA[<p>ABCç­¾åˆ°</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>å¯¹å°æ•°æ®å†™ä¸ªçˆ†æœåå¾ˆå®¹æ˜“å‘ç°è§„å¾‹</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>åˆ©ç”¨æ‰©å±•æ¬§æ‹‰å®šç†ï¼Œ$n*{a^n} \equiv n % p*{a^{n % (p-1)}}$ä»¤$j = n%(p-1)$, $i = n%p$, $j-i=k$æˆ‘ä»¬æšä¸¾açš„å¹‚æ¬¡jï¼ˆä»0åˆ°p-2ï¼‰ï¼Œåˆ©ç”¨é€†å…ƒç®—å‡ºiçš„å€¼æ»¡è¶³æ¡ä»¶çš„$n = t(p-1)*p + kp + i$ï¼Œtä¸ºæ•´æ•°ï¼Œç®—å‡º[1,x]èŒƒå›´å†…ç¬¦åˆæ¡ä»¶çš„tçš„ä¸ªæ•°å³å¯</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>æœ‰å‘å›¾ï¼Œæ¯æ¡è¾¹æƒå€¼ä¸ºkx+b,é—®xåœ¨[0,H]èŒƒå›´å†…æœ€çŸ­è·¯æœ€é•¿æ˜¯å¤šå°‘ï¼Œå®¹æ˜“å‘ç°ä»1åˆ°nçš„è·¯å¾„åˆå¹¶åè¿˜æ˜¯ä¸€ä¸ªkx+bï¼Œå¯¹äºæŸä¸€å¤©ï¼Œå°±ç›¸å½“äºä¼—å¤šç›´çº¿åœ¨è¯¥å¤©çš„å€¼ä¸­å–minï¼Œå¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ªä¸Šå‡¸åŒ…ï¼Œæ±‚æœ€å¤§å€¼ä¸‰åˆ†å³å¯</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>å¯¹ä¸€ä¸ªæ•°åšgcdçš„ä¸‹é™é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œæ¯æ¬¡è‡³å°‘å‡åŠï¼Œæ‰€ä»¥ç”¨çº¿æ®µæ ‘åˆç†å‰ªæå°±èƒ½è¿‡ï¼Œå¤æ‚åº¦ä¸ä¼šè¯ã€‚å‰ªææ–¹æ³•ï¼š</p><ul><li>åŒºé—´æœ€å¤§å€¼=1ï¼Œè¯´æ˜è¯¥æ®µåŒºé—´æ‰€æœ‰å€¼éƒ½æ˜¯1ï¼Œç›´æ¥return</li><li>åŒºé—´æœ€å¤§å€¼=æœ€å°å€¼=xï¼Œreturn</li></ul><p>åªåšç¬¬ä¸€ä¸ªå‰ªæï¼Œå¾ˆå®¹æ˜“è¢«æ‰€æœ‰æ•°ç›¸ç­‰ç„¶åæ¯æ¬¡æ“ä½œä¹Ÿç­‰äºè¯¥æ•°çš„æ•°æ®å¡æ‰ï¼ŒåŠ ä¸Šç¬¬äºŒä¸ªå‰ªæï¼Œå°±è¿‡äº†ï¼Œæ˜¯å¦æ­£ç¡®ä¸çŸ¥</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>åœ¨æ£®æ—ä¸­æ¯æ¬¡å¯ä»¥å–èµ°<strong>è‹¥å¹²</strong>ä¸ªæ ¹ï¼Œåˆå§‹æ˜¯ä¸€æ£µ1ä¸ºæ ¹çš„æ ‘ï¼Œä¸èƒ½æ“ä½œè€…è¾“æ¯”èµ›çš„æ—¶å€™çœ‹é”™é¢˜äº†ï¼Œæˆ‘ä»¥ä¸ºæ¯æ¬¡åªèƒ½å–ä¸€ä¸ªæ ¹é¦–å…ˆå¶å­æ˜¯å¿…èƒœæ€ï¼Œå†è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å„¿å­ï¼Œå¦‚æœéƒ½æ˜¯å¿…è´¥æ€ï¼Œé‚£ä½ å°±æ˜¯å¿…èƒœæ€ã€‚å¦‚æœå­˜åœ¨æŸä¸ªå„¿å­æ˜¯å¿…èƒœæ€ï¼Œä½ å°±æ˜¯å¿…è´¥æ€ï¼Œå› ä¸ºä½ å–èµ°è¯¥èŠ‚ç‚¹åï¼Œå¯¹æ‰‹åªè¦æŠŠæ‰€æœ‰æ˜¯å¿…èƒœæ€çš„èŠ‚ç‚¹çš„æ ¹å–èµ°ï¼Œé‚£ä½ é¢å¯¹çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯å¿…è´¥æ€çš„äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p5903 æ ‘ä¸Škçº§ç¥–å…ˆ</title>
      <link href="/2020/05/30/p5903-shu-shang-k-ji-zu-xian/"/>
      <url>/2020/05/30/p5903-shu-shang-k-ji-zu-xian/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨å€å¢æ¯æ¬¡å¯ä»¥åœ¨lognçš„æ—¶é—´å†…è§£å†³ï¼Œè€Œä½¿ç”¨é•¿é“¾å‰–åˆ†ï¼Œå¯ä»¥åœ¨O(nlogn)é¢„å¤„ç†åï¼ŒO(1)å›ç­”è¯¢é—®ï¼Œè™½ç„¶åœ¨å®è·µä¸­ç›¸å·®æ— å‡ ï¼Œä¹Ÿä¸å¤ªå¯èƒ½è¦æ±‚O(1),ä½†æ˜¯é•¿å‰–çš„è¿™ç§åšæ³•ä»¥åŠé¢„å¤„ç†çš„æ–¹æ³•è¿˜æ˜¯å¾ˆå·§å¦™çš„</p><ul><li>é¢„å¤„ç†å‡ºå€å¢æ•°ç»„ï¼Œé•¿é“¾çš„é•¿åº¦ä»¥åŠé“¾é¡¶èŠ‚ç‚¹ï¼Œå†é¢„å¤„ç†å‡ºæ¯ä¸ªæ•°å­—çš„æœ€é«˜äºŒçº§åˆ¶ä½hb[i]ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹ä¸ºé“¾é¡¶èŠ‚ç‚¹ï¼Œé¢„å¤„ç†å‡ºå…¶å‘ä¸Š(è·³fa)å’Œå‘ä¸‹(è·³son)len[u]-1ä¸ªèŠ‚ç‚¹</li><li>å¤„ç†è¯¢é—®æ—¶ï¼Œå…ˆåˆ©ç”¨å€å¢æ•°ç»„è·³åˆ°(1&lt;&lt;hb[i])çš„ç¥–å…ˆå¤„ï¼Œæ­¤æ—¶kâ€™=k-(1&lt;&lt;hb[i]) &lt; (1&lt;&lt;hb[i])</li><li>å½“å‰æ‰€åœ¨çš„é•¿é“¾çš„é•¿åº¦ä¸€å®šæ˜¯å¤§äºkâ€™çš„ï¼Œæ‰€ä»¥è€ƒè™‘è·³åˆ°é“¾é¡¶ï¼Œè€Œåæ ¹æ®å‰©ä½™çš„ké€‰æ‹©å‘ä¸Šè¿˜æ˜¯å‘ä¸‹è·³ï¼Œæ­¤æ—¶åˆ©ç”¨é¢„å¤„ç†å‡ºçš„upï¼Œdwnæ•°ç»„å³å¯å®ç°O(1)</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, hb[N], fa[N][<span class="number">22</span>], rt;</span><br><span class="line"><span class="type">int</span> len[N], dep[N], top[N], son[N];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N], up[N], dwn[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">unsigned</span> <span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  x ^= x &lt;&lt; <span class="number">13</span>;</span><br><span class="line">  x ^= x &gt;&gt; <span class="number">17</span>;</span><br><span class="line">  x ^= x &lt;&lt; <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">return</span> s = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dep[u] = dep[fa[u][<span class="number">0</span>]] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==fa[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; fa[v][i]; i++) fa[v][i+<span class="number">1</span>] = fa[fa[v][i]][i];</span><br><span class="line">    <span class="built_in">dfs1</span>(v);</span><br><span class="line">    <span class="keyword">if</span>(len[v]&gt;len[son[u]]) son[u] = v;</span><br><span class="line">  &#125;</span><br><span class="line">  len[u] = len[son[u]] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top[u] = t;</span><br><span class="line">  <span class="keyword">if</span>(u==t)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, j=u; i&lt;len[u]; i++)</span><br><span class="line">      up[u].<span class="built_in">pb</span>(j), j = fa[j][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, j=u; i&lt;len[u]; i++)</span><br><span class="line">      dwn[u].<span class="built_in">pb</span>(j), j = son[j];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(son[u]) <span class="built_in">dfs2</span>(son[u], t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    <span class="keyword">if</span>(v!=son[u])</span><br><span class="line">      <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!k) <span class="keyword">return</span> x;</span><br><span class="line">  x = fa[x][hb[k]], k -= (<span class="number">1</span>&lt;&lt;hb[k]);</span><br><span class="line">  k -= dep[x] - dep[top[x]], x = top[x];</span><br><span class="line">  <span class="keyword">return</span> k&gt;=<span class="number">0</span> ? up[x][k] : dwn[x][-k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; q &gt;&gt; s;</span><br><span class="line">  hb[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; fa[i][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span>(!fa[i][<span class="number">0</span>]) rt = i;</span><br><span class="line">    <span class="keyword">else</span> G[fa[i][<span class="number">0</span>]].<span class="built_in">pb</span>(i);</span><br><span class="line">    hb[i] = hb[i&gt;&gt;<span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs1</span>(rt); <span class="built_in">dfs2</span>(rt, rt);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  ll res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x = (<span class="built_in">get</span>(s)^ans)%n + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> k = (<span class="built_in">get</span>(s)^ans)%dep[x];</span><br><span class="line">    res ^= <span class="number">1ll</span>*i*(ans=<span class="built_in">ask</span>(x, k));</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; res &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°Vå’Œgcdæ ‘ å¸¦ä¿®ä¸»å¸­æ ‘+æ ‘å‰–trick</title>
      <link href="/2020/05/26/xiao-v-he-gcd-shu-dai-xiu-zhu-xi-shu-shu-pou-trick/"/>
      <url>/2020/05/26/xiao-v-he-gcd-shu-dai-xiu-zhu-xi-shu-shu-pou-trick/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šä¸€é¢—æ— æ ¹æ ‘ï¼Œç‚¹æœ‰ç‚¹æƒ$a_i$â€‹ï¼Œè¾¹æœ‰è¾¹æƒ$\gcd(a_i, a_j)$,è¦æ±‚æ”¯æŒä¸¤ç§æ“ä½œï¼š</p><ul><li>ä¿®æ”¹ä¸€ä¸ªç‚¹çš„ç‚¹æƒï¼Œç›¸åº”è¾¹æƒä¹Ÿä¼šæ›´æ”¹</li><li>è¯¢é—®u-&gt;vè·¯å¾„ä¸Šè¾¹æƒ&lt;=kçš„æ•°é‡</li></ul><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å› ä¸ºä¿®æ”¹æŸä¸ªç‚¹çš„ç‚¹æƒï¼ŒåŒæ—¶ä¼šä¿®æ”¹å…¶æ‰€æœ‰å‡ºè¾¹ï¼Œç›´è§‚çš„æƒ³æ³•æ˜¯è€ƒè™‘bfsæ ‘ï¼Œç„¶åè½¬åŒ–ä¸ºåŒºé—´ä¿®æ”¹ï¼Œä½†æ˜¯æ¯ä¸ªå„¿å­çš„ä¿®æ”¹æ˜¯ä¸åŒçš„ï¼ŒåŒºé—´æ¯ä¸ªæ•°å¯¹xå–gcdï¼ˆåšä¸äº†ï¼‰ä¸‹é¢å°±éœ€è¦ä¸€ç§æ ‘å‰–çš„trickï¼Œæ¯æ¬¡ä¿®æ”¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªä¿®æ”¹çˆ¶äº²å’Œé‡å„¿å­çš„ä¿¡æ¯ï¼Œè€Œåœ¨è¯¢é—®çš„æ—¶å€™ï¼Œå¯¹äºä¸€æ•´æ¡é‡é“¾ï¼Œå¯ä»¥ä¿è¯ä¿¡æ¯æ˜¯æ­£ç¡®çš„ï¼Œè€Œæ¯æ¬¡è·³åˆ°é“¾é¡¶ï¼Œå†ä¿®æ”¹ä¸€ä¸‹è¯¥ç‚¹ï¼ˆè½»å„¿å­ï¼‰ä¸çˆ¶äº²çš„ä¿¡æ¯å³å¯ï¼Œè¿™æ ·å°±è½¬åŒ–ä¸ºç®€å•çš„å•ç‚¹ä¿®æ”¹äº†ã€‚è€ƒè™‘æœ¬é¢˜ï¼Œå¯ä»¥å°†è¾¹æƒä¸‹æ”¾åˆ°æ·±åº¦å¤§çš„ç‚¹ä¸Šï¼Œå¥—ç”¨ä¸Šè¿°åšæ³•å³å¯ï¼Œè€ŒåŒºé—´è¯¢é—®&lt;=kçš„æ•°é‡å°±ç”¨å¸¦ä¿®ä¸»å¸­æ ‘ç»´æŠ¤ã€‚</p><h3 id="æµç¨‹"><a class="header-anchor" href="#æµç¨‹">Â¶</a>æµç¨‹</h3><p>modify:upd: u-&gt;fa[u] son[u]-&gt;uqueryask: u-&gt;top[u] upd: top[u]-&gt;fa[top[u]]u = fa[top[u]]ask: u-&gt;v(æ˜¯é‡é“¾)æ³¨æ„æœ¬é¢˜æ˜¯æŠŠè¾¹æƒä¸‹æ”¾åˆ°äº†ç‚¹æƒï¼Œæ‰€ä»¥uè¿™ä¸ªç‚¹çš„å€¼åº”è¯¥å»æ‰ï¼Œæ‰€ä»¥è¯¢é—®çš„æ˜¯dfn[u]+1-&gt;dfn[v]</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e4</span> + <span class="number">5</span>, M = <span class="number">1e6</span> + <span class="number">5</span>, up = <span class="number">1e6</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, a[N], b[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="type">int</span> sz[N], top[N], son[N], dep[N], fa[N], dfn[N], idfn[N], tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dep[u] = dep[f] + <span class="number">1</span>; fa[u] = f;</span><br><span class="line">  sz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v!=f)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">      sz[u] += sz[v];</span><br><span class="line">      <span class="keyword">if</span>(sz[v]&gt;sz[son[u]]) son[u] = v;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top[u] = t;</span><br><span class="line">  dfn[u] = ++tot;</span><br><span class="line">  idfn[tot] = u;</span><br><span class="line">  <span class="keyword">if</span>(!son[u]) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs2</span>(son[u], t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    <span class="keyword">if</span>(v!=son[u]&amp;&amp;v!=fa[u]) <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> PSegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls(x) t[x].l</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs(x) t[x].r</span></span><br><span class="line">  <span class="type">int</span> rt[N], tot;</span><br><span class="line">  <span class="type">int</span> lrt[N], rrt[N], lc, rc;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, cnt;</span><br><span class="line">  &#125;t[M*<span class="number">32</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p) p = ++tot;</span><br><span class="line">    t[p].cnt += v;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">insert</span>(<span class="built_in">ls</span>(p), l, mid, x, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">insert</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(l&gt;k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) cnt -= t[lrt[i]].cnt;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) cnt += t[rrt[i]].cnt;</span><br><span class="line">      <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=mid)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lrt[i] = <span class="built_in">ls</span>(lrt[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) rrt[i] = <span class="built_in">ls</span>(rrt[i]);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">ask</span>(l, mid, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> lcnt = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lcnt -= t[<span class="built_in">ls</span>(lrt[i])].cnt;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) lcnt += t[<span class="built_in">ls</span>(rrt[i])].cnt;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lrt[i] = <span class="built_in">rs</span>(lrt[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) rrt[i] = <span class="built_in">rs</span>(rrt[i]);</span><br><span class="line">      <span class="keyword">return</span> lcnt + <span class="built_in">ask</span>(mid+<span class="number">1</span>, r, k);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> PSegTree;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> val, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) <span class="built_in">insert</span>(rt[i], <span class="number">1</span>, up, val, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  lc = <span class="number">0</span>, rc = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l<span class="number">-1</span>; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) lrt[++lc] = rt[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=r; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) rrt[++rc] = rt[i];</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="number">1</span>, up, k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">queryt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    <span class="type">int</span> tmp = top[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[tmp]&amp;&amp;b[tmp]!=__gcd(a[tmp], a[fa[tmp]]))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">upd</span>(dfn[tmp], b[tmp], <span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">upd</span>(dfn[tmp], b[tmp]=__gcd(a[tmp], a[fa[tmp]]), <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ans += <span class="built_in">query</span>(dfn[top[x]], dfn[x], k);</span><br><span class="line">    x = fa[top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="keyword">if</span>(x!=y) ans += <span class="built_in">query</span>(dfn[x]+<span class="number">1</span>, dfn[y], k);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(v); G[v].<span class="built_in">pb</span>(u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>); <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> u=<span class="number">2</span>; u&lt;=n; u++)</span><br><span class="line">    <span class="built_in">upd</span>(dfn[u], b[u]=__gcd(a[u], a[fa[u]]), <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u, x;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;x);</span><br><span class="line">      <span class="keyword">if</span>(fa[u])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">upd</span>(dfn[u], b[u], <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">upd</span>(dfn[u], b[u]=__gcd(x, a[fa[u]]), <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(son[u])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">upd</span>(dfn[son[u]], b[son[u]], <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">upd</span>(dfn[son[u]], b[son[u]]=__gcd(x, a[son[u]]), <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      a[u] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u, v, k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">queryt</span>(u, v, k));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°çƒä¸ç›’å­</title>
      <link href="/2020/05/25/xiao-qiu-yu-he-zi/"/>
      <url>/2020/05/25/xiao-qiu-yu-he-zi/</url>
      
        <content type="html"><![CDATA[<p>nä¸ªçƒæ”¾è¿›kä¸ªç›’å­ï¼Œæ ¹æ®çƒæ˜¯å¦ç›¸åŒã€ç›’å­æ˜¯å¦ç›¸åŒã€ç›’å­æ˜¯å¦å¯ä»¥ä¸ºç©ºï¼Œå¯ä»¥æ€»ç»“å‡º8ä¸ªæ¨¡å‹ã€‚å‰ç½®èŠå£«ï¼šç»„åˆæ•°ã€æ–¯ç‰¹æ—æ•°ã€å¿«é€Ÿå¹‚ã€è´å°”æ•°ã€æ•´æ•°æ‹†åˆ†ç­‰</p><h2 id="çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼ˆä¸åŒï¼‰ï¼Œä¸èƒ½ç©ºç›’"><a class="header-anchor" href="#çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼ˆä¸åŒï¼‰ï¼Œä¸èƒ½ç©ºç›’">Â¶</a>çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼ˆä¸åŒï¼‰ï¼Œä¸èƒ½ç©ºç›’</h2><p>ç›’å­ç›¸åŒæ—¶ä¸ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ï¼Œä¸åŒæ—¶å†ä¹˜ä»¥$k!$å³å¯å¯ä»¥nké€’æ¨ï¼Œå¯ä»¥å®¹æ–¥</p><h2 id="çƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’"><a class="header-anchor" href="#çƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’">Â¶</a>çƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’</h2><p>æ¯ä¸ªçƒæœ‰kç§æ–¹æ³• $k^n$</p><h2 id="çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’"><a class="header-anchor" href="#çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’">Â¶</a>çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’</h2><p>æšä¸¾ç©ºç›’çš„æ•°é‡ï¼Œç­”æ¡ˆä¸ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ä¸€è¡Œæ±‚å’Œä¹Ÿç›¸å½“ä¸æ˜¯è´å°”æ•°</p><h2 id="çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œä¸èƒ½ç©ºç›’"><a class="header-anchor" href="#çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œä¸èƒ½ç©ºç›’">Â¶</a>çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œä¸èƒ½ç©ºç›’</h2><p>$x_1+x_2+\dots+x_n = k$çš„æ­£æ•´æ•°è§£ä¸ªæ•°C(n-1, k-1)</p><h2 id="çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’"><a class="header-anchor" href="#çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’">Â¶</a>çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’</h2><p>$x_1+x_2+\dots+x_n = k$çš„éè´Ÿæ•´æ•°è§£ä¸ªæ•°C(n+k-1, k-1)</p><h2 id="çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œä¸èƒ½ç©ºç›’"><a class="header-anchor" href="#çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œä¸èƒ½ç©ºç›’">Â¶</a>çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œä¸èƒ½ç©ºç›’</h2><p>æ•´æ•°næ‹†åˆ†æˆkä»½=ç”¨æœ€å¤§æ•°ä¸ºkæ‹†åˆ†nD(n-k, k) å°†n-kç”¨$\le k$çš„æ•°æ‹†åˆ†</p><h2 id="çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’"><a class="header-anchor" href="#çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’">Â¶</a>çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’</h2><p>D(n, k) = D(n, k-1) + D(n-k, k)</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘ç»´æŠ¤å‰ç¼€æœ€å€¼é—®é¢˜</title>
      <link href="/2020/05/23/xian-duan-shu-wei-hu-qian-zhui-zui-zhi-wen-ti/"/>
      <url>/2020/05/23/xian-duan-shu-wei-hu-qian-zhui-zui-zhi-wen-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¥¼æˆ¿é‡å»º"><a class="header-anchor" href="#æ¥¼æˆ¿é‡å»º">Â¶</a>æ¥¼æˆ¿é‡å»º</h2><p>æœ‰næ ‹æˆ¿å±‹,é—®ä»1å·æ¥¼å¾€åçœ‹,æœ€å¤šèƒ½çœ‹åˆ°å‡ æ ‹æ¥¼,è¦æ±‚æ”¯æŒå•ç‚¹ä¿®æ”¹ä¾‹:(1, 3, 2, 5, 4) ç­”æ¡ˆä¸º3:(1, 3, 5)ç­”æ¡ˆå°±æ˜¯ä»1å¼€å§‹çš„ä¸¥æ ¼å‰ç¼€æœ€å¤§å€¼çš„é•¿åº¦,è€ƒè™‘çº¿æ®µæ ‘ç»´æŠ¤,ä½†æ˜¯åœ¨pushupçš„æ—¶å€™,å¦‚æœç®€å•çš„å°†å·¦å³å­æ ‘çš„ç­”æ¡ˆç›¸åŠ ,æ˜¯ä¸å¯¹çš„,å› ä¸ºå·¦è¾¹çš„æ¥¼æˆ¿é«˜åº¦ä¼šå½±å“åˆ°å³è¾¹.ä¸å¦¨è€ƒè™‘é€’å½’çš„è¿›è¡Œpushup(ä¹Ÿæ˜¯æŸç§å¯å‘,å› ä¸ºpushupä¸€èˆ¬éƒ½æ˜¯O(1)åˆå¹¶çš„,ä½†$O(\log n)$åˆå¹¶æœªå°ä¸å¯?)çº¿æ®µæ ‘æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤mx,lenåˆ†åˆ«è¡¨ç¤ºåŒºé—´æœ€å¤§å€¼(ç”¨äºå‰ªæ),<strong>åªè€ƒè™‘</strong>è¯¥åŒºé—´æ—¶çš„ç­”æ¡ˆæ·»åŠ å‡½æ•°merge(v, p) è¡¨ç¤ºçº¿æ®µæ ‘ä¸Šç¼–å·pèŠ‚ç‚¹ç®¡è¾–çš„åŒºé—´åœ¨å·¦è¾¹æœ€å¤§å€¼ä¸ºvçš„å½±å“ä¸‹äº§ç”Ÿçš„ç­”æ¡ˆä»¥ä¸‹è€ƒè™‘å‡ ç§æƒ…å†µ:</p><ul><li>t[p]çš„æœ€å¤§å€¼æ˜¯å°äºv æ­¤æ—¶æ²¡æœ‰è´¡çŒ®, <code>return 0</code>å³å¯</li><li>pæ˜¯å¶å­èŠ‚ç‚¹<code>return t[p].mx&gt;v</code>è¿”å›è¯¥èŠ‚ç‚¹ä»£è¡¨çš„å€¼ä¸vçš„å¤§å°å…³ç³»å³å¯</li><li>è€ƒè™‘å·¦å³å„¿å­ä¸ºls, rs è‹¥<code>t[ls].mx&lt;=v</code>æ­¤æ—¶å·¦åŒºé—´æ— è´¡çŒ®,é€’å½’å³åŒºé—´å³å¯,<code>return merge(v,rs)</code>.å¦åˆ™é€’å½’å·¦åŒºé—´,é‚£ä¹ˆå³åŒºé—´çš„è´¡çŒ®æ˜¯<code>t[p].lenâˆ’t[ls].len</code>(æ³¨æ„ä¸æ˜¯t[rs].len)åœ¨pushupçš„æ—¶å€™,ç»´æŠ¤å¥½mx,å¹¶è®©<code>t[p].len = t[ls].len + merge(t[ls].mx, rs)</code>å³å¯</li></ul><h2 id="æœ€ç®€å•çš„ä¸€é“é¢˜"><a class="header-anchor" href="#æœ€ç®€å•çš„ä¸€é“é¢˜">Â¶</a>æœ€ç®€å•çš„ä¸€é“é¢˜</h2><p>è¥¿é‚®æ–°ç”Ÿèµ›çš„ä¸€é¢˜,æ²¡äººè¿‡æˆ‘çœ‹åˆ°çš„æ—¶å€™å°±å‘ç°æ˜¯è·Ÿæ¥¼æˆ¿é‡å»ºä¸€æ ·çš„trick,ç„¶è€Œ<s>è°ƒbugè°ƒäº†åŠå¤©,waäº†æ— æ•°å‘</s>ç»™å®šnä¸ªæ•°,è¯¢é—®ä»ç¬¬xä¸ªæ•°å¾€åçš„éä¸¥æ ¼å‰ç¼€æœ€å°å€¼çš„é•¿åº¦,è¦æ±‚æ”¯æŒåŒºé—´åŠ åšæ³•è·Ÿä¸Šé¢˜ç±»ä¼¼,æ³¨æ„åœ¨mergeé‡Œé¢ä¹Ÿè¦åŠ ä¸Špushdown,åœ¨æ¯æ¬¡è¦è®¿é—®ä¸€ä¸ªç‚¹çš„å·¦å³å„¿å­çš„æ—¶å€™,å°±åº”è¯¥ä¸‹æ”¾è¯¥ç‚¹çš„lazytagä¸Šä¸€é¢˜çš„è¯¢é—®éƒ½æ˜¯ä»1å¼€å§‹çš„,æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯t[1].len,ä½†æœ¬é¢˜æ˜¯ä»xå¼€å§‹çš„,æˆ‘çš„åšæ³•æ˜¯æŠŠ[x,n]åœ¨çº¿æ®µæ ‘ä¸Šçš„åŒºé—´æå–å‡ºæ¥,ç„¶åä»å·¦å¾€å³åˆå¹¶,åŒºé—´æ•°æ˜¯logæ®µ,åˆå¹¶ä¹Ÿæ˜¯logçš„,å¤æ‚åº¦æ˜¯$n(\log^2 n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> n, m, pos[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line"><span class="keyword">namespace</span> SegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls (p&lt;&lt;1)</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs (p&lt;&lt;1|1)</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, len;</span><br><span class="line">    ll mn, tag;</span><br><span class="line">  &#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setval</span><span class="params">(<span class="type">int</span> p, ll v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].mn += v;</span><br><span class="line">    t[p].tag += v;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">setval</span>(ls, t[p].tag); <span class="built_in">setval</span>(rs, t[p].tag);</span><br><span class="line">    t[p].tag = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> p)</span> <span class="comment">//é‡ç‚¹</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(t[p].mn&gt;v) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[p].mn&lt;=v;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(t[ls].mn&gt;v) <span class="keyword">return</span> <span class="built_in">merge</span>(v, rs);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">merge</span>(v, ls) + t[p].len - t[ls].len;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].mn = <span class="built_in">min</span>(t[ls].mn, t[rs].mn);</span><br><span class="line">    t[p].len = t[ls].len + <span class="built_in">merge</span>(t[ls].mn, rs);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].l = l, t[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      t[p].mn = a[l];</span><br><span class="line">      t[p].len = <span class="number">1</span>;</span><br><span class="line">      pos[l] = p;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(ls, l, mid); <span class="built_in">build</span>(rs, mid+<span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">setval</span>(p, v);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(ls, x, y, v);</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(rs, x, y, v);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">    &#123;</span><br><span class="line">      vec.<span class="built_in">pb</span>(p);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ask</span>(ls, x, y);</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) <span class="built_in">ask</span>(rs, x, y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> SegTree;</span><br><span class="line"><span class="type">char</span> op[<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">    <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l, r, k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;k);</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, l, r, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">      vec.<span class="built_in">clear</span>();</span><br><span class="line">      <span class="built_in">ask</span>(<span class="number">1</span>, x, n);</span><br><span class="line">      <span class="type">int</span> ans = t[vec[<span class="number">0</span>]].len;</span><br><span class="line">      ll mn = t[vec[<span class="number">0</span>]].mn;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;<span class="built_in">sz</span>(vec); i++)</span><br><span class="line">      &#123;</span><br><span class="line">        ans += <span class="built_in">merge</span>(mn, vec[i]);</span><br><span class="line">        mn = <span class="built_in">min</span>(mn, t[vec[i]].mn);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>copyè‡ªå°ç²‰å…”:</p><blockquote><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªå¾ˆå…³é”®çš„æ€§è´¨ï¼šå½“vå°äºå·¦å­æ ‘çš„æœ€å¤§å€¼æ—¶ï¼Œå³å­æ ‘å¯¹å½“å‰èŠ‚ç‚¹çš„è´¡çŒ®ï¼Œæ˜¯é€šè¿‡å‡æ³•è®¡ç®—çš„ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªä¿¡æ¯è¦æ»¡è¶³ä¸€å®šç¨‹åº¦ä¸Šçš„å¯å‡æ€§ä½†æ˜¯æœ‰å¾ˆå¤šä¿¡æ¯æ˜¯ä¸æ»¡è¶³å¯å‡æ€§çš„ï¼Œæ¯”å¦‚max,minã€æŒ‰ä½ä¸ã€æŒ‰ä½æˆ–ç­‰ä¸ºäº†èƒ½è®©è¿™ç§çº¿æ®µæ ‘é€‚åº”æ›´ä¸€èˆ¬çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¿®æ”¹ç»´æŠ¤çš„ä¿¡æ¯çš„æ„ä¹‰ï¼šä»ç„¶ç»´æŠ¤è¿™ä¸ªåŒºé—´ä¸­çš„æœ€å¤§å€¼ã€‚</p><p>æ­¤æ—¶å¹¶ä¸æ˜¯ç»´æŠ¤åŒºé—´çš„ç­”æ¡ˆï¼Œè€Œæ˜¯ä»…è€ƒè™‘è¯¥åŒºé—´çš„å½±å“åï¼Œå´åˆåªç»Ÿè®¡å³å­æ ‘çš„ç­”æ¡ˆä»…è€ƒè™‘è¯¥åŒºé—´çš„å½±å“åï¼Œå´åˆåªç»Ÿè®¡å³å­æ ‘çš„ç­”æ¡ˆä»…è€ƒè™‘è¯¥åŒºé—´çš„å½±å“åï¼Œå´åˆåªç»Ÿè®¡å³å­æ ‘çš„ç­”æ¡ˆã€‚ä¹Ÿå°±æ˜¯è¯´ä»¤å½“å‰èŠ‚ç‚¹å¯¹åº”çš„åŒºé—´ä¸º[l,r]ï¼ŒåŒºé—´ä¸­ç‚¹ä¸º midï¼Œåˆ™ï¼šç»´æŠ¤çš„ç­”æ¡ˆæ˜¯ï¼Œåªè€ƒè™‘[l,r]æ—¶ï¼Œåœ¨åŒºé—´[mid+1,r]ä¸­çš„ç­”æ¡ˆã€‚</p></blockquote><p>çº¿æ®µæ ‘æ¯ä¸ªèŠ‚ç‚¹ä»ç„¶ç»´æŠ¤mx[i], len[i],ä½†å¯¹äºå¶èŠ‚ç‚¹len[i]æ— æ„ä¹‰,å†è€ƒè™‘merge(v, p)å‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].mx = <span class="built_in">max</span>(t[ls].mx, t[rs].mx);</span><br><span class="line">  t[p].len = <span class="built_in">merge</span>(t[ls].mx, rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mx&lt;=v) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[p].mn&gt;v;</span><br><span class="line">  <span class="keyword">if</span>(t[ls].mx&lt;=v) <span class="keyword">return</span> <span class="built_in">merge</span>(v, rs);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">merge</span>(v, ls) + t[p].len; <span class="comment">//é¿å…äº†åŒºé—´ç»´æŠ¤ä¿¡æ¯ä¸å¯å‡çš„é—®é¢˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Boruvkaç”Ÿæˆæ ‘ç®—æ³•</title>
      <link href="/2020/05/22/boruvka-sheng-cheng-shu-suan-fa/"/>
      <url>/2020/05/22/boruvka-sheng-cheng-shu-suan-fa/</url>
      
        <content type="html"><![CDATA[<p>æ ¸å¿ƒ:æ¯æ¬¡ä»æ‰€æœ‰å½“å‰çš„è¿é€šå—å‘å…¶ä»–è¿é€šå—æ‰©å±•å‡ºæœ€å°è¾¹,ç›´è‡³å‰©ä¸‹ä¸€ä¸ªè¿é€šå—æ¯è¿›è¡Œä¸€æ¬¡æ“ä½œ,è¿é€šå—æ•°é‡å‡åŠ $O(m\log n)$ å–å†³äºè®¡ç®—æœ€å°è¾¹çš„ä»£ä»·</p><h1>codechef spanning tree</h1><p>äº¤äº’é¢˜,æ¯æ¬¡å¯ä»¥ç»™å‡ºä¸¤ä¸ªç‚¹é›†A,Bè¿›è¡Œè¯¢é—®,ä¼šè¿”å›ä¸¤ä¸ªé›†åˆé—´çš„æœ€å°è¾¹,è¦æ±‚è¯¢é—®çš„$\sum |A|&lt;=1e4, \sum |A|+|B|&lt;=2e6,n&lt;=1e3$,æœ€åè¾“å‡ºè¯¥å›¾çš„æœ€å°ç”Ÿæˆæ ‘çš„æƒå€¼å’ŒæŒ‰ç…§ä¸Šè¿°ç®—æ³•è¯¢é—®å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, fa[N], idx[N], mncost;</span><br><span class="line">pii mn[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; scc[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==fa[x]) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">return</span> fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  u = <span class="built_in">find</span>(u), v = <span class="built_in">find</span>(v);</span><br><span class="line">  <span class="keyword">if</span>(u!=v)</span><br><span class="line">  &#123;</span><br><span class="line">    fa[u] = v;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pii <span class="title">ask</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">  cout &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="built_in">sz</span>(a) &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; n-<span class="built_in">sz</span>(a) &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> x : a)</span><br><span class="line">  &#123;</span><br><span class="line">    cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    vis[x] = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span>(!vis[i]) cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">  cout &lt;&lt; endl;</span><br><span class="line">  <span class="type">int</span> u, v, w; cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">mp</span>(v, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fa[i] = i;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(fa[i]==i) idx[i] = ++cnt;</span><br><span class="line">    <span class="keyword">if</span>(cnt==<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      scc[idx[<span class="built_in">find</span>(i)]].<span class="built_in">pb</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=cnt; i++) mn[i] = &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">auto</span> cur = <span class="built_in">ask</span>(scc[i]);</span><br><span class="line">      <span class="keyword">if</span>(mn[i].fi==<span class="number">-1</span>) mn[i] = &#123;cur.se, cur.fi&#125;;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(cur.se&lt;mn[i].fi) mn[i] = &#123;cur.se, cur.fi&#125;;</span><br><span class="line">      scc[i].<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(fa[i]==i &amp;&amp; <span class="built_in">merge</span>(i, mn[idx[i]].se))</span><br><span class="line">        mncost += mn[idx[i]].fi;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; mncost &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>cf888G xormst</h1><p>ä¸€å¼ å®Œå…¨å›¾,ç‚¹æ•°2e5,æ¯ä¸ªç‚¹æœ‰ç‚¹æƒ$a_i$â€‹,è¾¹$(i,j)$çš„æƒå€¼ä¸º$a_i xor a_j$â€‹,æ±‚è¯¥å›¾çš„mstæ€è€ƒå¦‚ä½•æ±‚å‡ºå½“å‰é›†åˆä¸å…¶ä»–é›†åˆçš„æœ€å°è¾¹æƒ:å»ºå‡º01trie,æ¯æ¬¡æŠŠè¯¥é›†åˆçš„ç‚¹æƒåˆ é™¤,ç„¶åé€ä¸ªè¯¢é—®ä¸è¯¥ç‚¹æƒxoråçš„æœ€å°å€¼å–å°,æœ€åå†æ’å…¥è¿˜åŸå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;Ofast&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize (<span class="string">&quot;unroll-loops&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC target(<span class="string">&quot;sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, a[N];</span><br><span class="line"><span class="type">int</span> fa[N], idx[N], cnt, mnto[N], mnval[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; scc[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==fa[x]) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">return</span> fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  u = <span class="built_in">find</span>(u), v = <span class="built_in">find</span>(v);</span><br><span class="line">  <span class="keyword">if</span>(u!=v)</span><br><span class="line">  &#123;</span><br><span class="line">    fa[u] = v;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> tot, nxt[N*<span class="number">29</span>][<span class="number">2</span>], sz[N*<span class="number">29</span>][<span class="number">2</span>], id[N*<span class="number">29</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v, <span class="type">int</span> idx)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> now = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">29</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> k = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!nxt[now][k]) nxt[now][k] = ++tot;</span><br><span class="line">    sz[now][k] += v;</span><br><span class="line">    now = nxt[now][k];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(v==<span class="number">1</span>) id[now] = idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pii <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>, now = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">29</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> k = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(sz[now][k]) now = nxt[now][k];</span><br><span class="line">    <span class="keyword">else</span> now = nxt[now][k^<span class="number">1</span>], ans |= (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;ans, id[now]&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">double</span> startTime = (<span class="type">double</span>)<span class="built_in">clock</span>();</span><br><span class="line">  <span class="comment">//mt19937 rnd(chrono::high_resolution_clock::now().time_since_epoch().count());</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="comment">//n = 2e5;</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    fa[i] = i;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    <span class="comment">//a[i] = abs(rnd()%(1&lt;&lt;30));</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>);</span><br><span class="line">  n = <span class="built_in">unique</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>) - a - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">upd</span>(a[i], <span class="number">1</span>, i);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(fa[i]==i)</span><br><span class="line">      &#123;</span><br><span class="line">        idx[i] = ++cnt;</span><br><span class="line">        mnto[cnt] = mnval[cnt] = <span class="number">-1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">//debug(cnt);</span></span><br><span class="line">    <span class="keyword">if</span>(cnt==<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      scc[idx[<span class="built_in">find</span>(i)]].<span class="built_in">pb</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> x : scc[i]) <span class="built_in">upd</span>(a[x], <span class="number">-1</span>, x);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> x : scc[i])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">auto</span> cur = <span class="built_in">ask</span>(a[x]);</span><br><span class="line">        <span class="keyword">if</span>(mnto[i]==<span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          mnval[i] = cur.fi;</span><br><span class="line">          mnto[i] = cur.se;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cur.fi&lt;mnval[i])</span><br><span class="line">        &#123;</span><br><span class="line">          mnval[i] = cur.fi;</span><br><span class="line">          mnto[i] = cur.se;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> x : scc[i]) <span class="built_in">upd</span>(a[x], <span class="number">1</span>, x);</span><br><span class="line">      scc[i].<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(fa[i]==i &amp;&amp; <span class="built_in">merge</span>(i, mnto[idx[i]]))</span><br><span class="line">        ans += mnval[idx[i]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  cerr &lt;&lt; ((<span class="type">double</span>)<span class="built_in">clock</span>() - startTime) / CLOCKS_PER_SEC &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¯é¸½çš„æ•°åˆ—</title>
      <link href="/2020/05/19/huan-ge-de-shu-lie/"/>
      <url>/2020/05/19/huan-ge-de-shu-lie/</url>
      
        <content type="html"><![CDATA[<p>åŒºé—´åŠ å¹¿ä¹‰æ–æ³¢é‚£å¥‘æ•°åˆ—å¤§æ¦‚æœ‰ä¸‰ç§åšæ³•1.ç”¨ç‰¹å¾æ–¹ç¨‹æ±‚å‡ºé€šé¡¹,è·‘å‡ºæ ¹å·çš„äºŒæ¬¡å‰©ä½™åä»£å…¥,å˜æˆåŒºé—´åŠ ç­‰æ¯”æ•°åˆ—,çº¿æ®µæ ‘ç»´æŠ¤å³å¯2.çŸ©é˜µ3.åˆ©ç”¨æ€§è´¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">9</span>, a = <span class="number">276601605</span>, b = <span class="number">691504013</span>, c = <span class="number">308495997</span>;</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">int</span> n, m, x[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a = <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) <span class="keyword">return</span> a-mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) a+=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) <span class="keyword">return</span> a+mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="built_in">Mul</span>(ans, a);</span><br><span class="line">    a = <span class="built_in">Mul</span>(a, a);</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls (p&lt;&lt;1)</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs (p&lt;&lt;1|1)</span></span><br><span class="line">  <span class="type">int</span> inv, pw[N];</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, sum, tag;</span><br><span class="line">  &#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) pw[i] = <span class="built_in">Mul</span>(pw[i<span class="number">-1</span>], q)%mod;</span><br><span class="line">    inv = <span class="built_in">powmod</span>(q<span class="number">-1</span>, mod<span class="number">-2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setval</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(t[p].sum, <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(v, <span class="built_in">Sub</span>(pw[t[p].r-t[p].l+<span class="number">1</span>], <span class="number">1</span>)), inv));</span><br><span class="line">    <span class="built_in">add</span>(t[p].tag, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].sum = <span class="built_in">Add</span>(t[ls].sum, t[rs].sum);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">setval</span>(ls, t[p].tag); <span class="built_in">setval</span>(rs, <span class="built_in">Mul</span>(t[p].tag, pw[t[rs].l-t[ls].l]));</span><br><span class="line">    t[p].tag = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].l = l, t[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(ls, l, mid); <span class="built_in">build</span>(rs, mid+<span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">setval</span>(p, pw[l-x+<span class="number">1</span>]);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(ls, x, y);</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(rs, x, y);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> t[p].sum;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(ls, x, y));</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(rs, x, y));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;T1, T2;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, x+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) sum[i] = <span class="built_in">Add</span>(sum[i<span class="number">-1</span>], x[i]);</span><br><span class="line">  T1.<span class="built_in">init</span>(b); T2.<span class="built_in">init</span>(c);</span><br><span class="line">  T1.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n); T2.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      T1.<span class="built_in">upd</span>(<span class="number">1</span>, l, r);</span><br><span class="line">      T2.<span class="built_in">upd</span>(<span class="number">1</span>, l, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> ans = <span class="built_in">Mul</span>(<span class="built_in">Sub</span>(T1.<span class="built_in">ask</span>(<span class="number">1</span>, l, r), T2.<span class="built_in">ask</span>(<span class="number">1</span>, l, r)), a);</span><br><span class="line">      <span class="built_in">add</span>(ans, <span class="built_in">Sub</span>(sum[r], sum[l<span class="number">-1</span>]));</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>525 ç¾å›¢æ¯2020 å¹³è¡Œå››è¾¹å½¢</title>
      <link href="/2020/05/18/525-mei-tuan-bei-2020-ping-xing-si-bian-xing/"/>
      <url>/2020/05/18/525-mei-tuan-bei-2020-ping-xing-si-bian-xing/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šn*nçš„æ£‹ç›˜,è¦æ±‚æ”¾ç½®nä¸ªæ£‹å­,æ»¡è¶³:</p><ul><li>xå’Œyéƒ½æ˜¯ä¸€ä¸ª1-nçš„æ’åˆ—</li><li>ä»»æ„å››ä¸ªæ£‹å­ä¸æ„æˆå¹³è¡Œå››è¾¹å½¢å…¶ä¸­n+1æ˜¯ä¸€ä¸ªè´¨æ•°</li></ul><p>è€ƒè™‘n+1çš„åŸæ ¹g,åˆ™$g,g^2,g^3â€¦g^n%(n+1)$å„ä¸ç›¸åŒ$(1,g)â€¦(n,g^n$%$(n+1))$å³ä¸ºç­”æ¡ˆæ— è¯æ˜o.O</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%m;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%m;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">phi</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = x;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i*i&lt;=x; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x%i==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ans -= ans / i;</span><br><span class="line">      <span class="keyword">while</span>(x%i==<span class="number">0</span>) x /= i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(x&gt;<span class="number">1</span>) ans -= ans / x;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="type">int</span> c = <span class="built_in">phi</span>(n+<span class="number">1</span>), g = <span class="number">0</span>;</span><br><span class="line">  <span class="type">bool</span> ok = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(++g)</span><br><span class="line">  &#123;</span><br><span class="line">    ok = (<span class="built_in">powmod</span>(g, c, n+<span class="number">1</span>)==<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> tmpc = c;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i*i&lt;=tmpc&amp;&amp;ok; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(tmpc%i==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span>(tmpc%i==<span class="number">0</span>) tmpc /= i;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">powmod</span>(g, c/i, n+<span class="number">1</span>)==<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tmpc&gt;<span class="number">1</span>&amp;&amp;<span class="built_in">powmod</span>(g, c/tmpc, n+<span class="number">1</span>)==<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(ok) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> ans = g;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, i, ans);</span><br><span class="line">    ans = ans*g%(n+<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> t;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">  <span class="keyword">while</span>(t--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢æŒ‘æˆ˜èµ›40</title>
      <link href="/2020/05/16/niu-ke-tiao-zhan-sai-40/"/>
      <url>/2020/05/16/niu-ke-tiao-zhan-sai-40/</url>
      
        <content type="html"><![CDATA[<h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™å®š1e6ä¸ªéšæœºç”Ÿæˆçš„æ•°,å¤šæ¬¡è¯¢é—®,ç»™å®šy,é—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ•°xæ»¡è¶³x^yåœ¨äºŒè¿›åˆ¶ä¸‹1çš„ä¸ªæ•°&lt;=3</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å› ä¸ºæœ€å¤šåªæœ‰3ä¸ªäºŒè¿›åˆ¶ä½ä¸åŒ,è€ƒè™‘å°†äºŒè¿›åˆ¶æ¯16ä½åˆ†æˆ4ç»„,æ»¡è¶³æ¡ä»¶çš„xä¸yä¸€å®šåœ¨æŸä¸€ç»„ä¸­çš„16ä½å®Œå…¨ç›¸åŒ,æ‰€ä»¥æŸ¥æ‰¾è¯¥ç»„ä¸­çš„æ•°,åˆç”±äºæ•°å­—éšæœº,æ¯æ¬¡æŸ¥æ‰¾çš„æ¬¡æ•°æœŸæœ›ä¸º$4*(2^{20} / 2^{16})$</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P5236 ã€æ¨¡æ¿ã€‘é™æ€ä»™äººæŒ</title>
      <link href="/2020/05/15/p5236-mo-ban-jing-tai-xian-ren-zhang/"/>
      <url>/2020/05/15/p5236-mo-ban-jing-tai-xian-ren-zhang/</url>
      
        <content type="html"><![CDATA[<p>æ¯æ¡è¾¹æœ€å¤šåœ¨ä¸€ä¸ªç®€å•ç¯ä¸Šçš„å›¾æ¯ä¸ªç¯éƒ½æ˜¯ä¸€ä¸ªç‚¹åŒ(æ–¹ç‚¹),å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”¨åœ†æ–¹æ ‘æ¥ç»´æŠ¤</p><p>æ±‚ä»™äººæŒå›¾ä¸Šä¸¤ç‚¹é—´çš„æœ€çŸ­è·¯æ³¨æ„ä»™äººæŒä¸Šçš„åœ†æ–¹æ ‘çš„å»ºæ³•:æ¯ä¸ªç®€å•ç¯æ–°å»ºä¸€ä¸ªæ–¹ç‚¹,ç¯ä¸Šæ¯ä¸ªç‚¹ä¸æ–¹ç‚¹è¿è¾¹,æƒå€¼ä¸ºåˆ°èµ·ç‚¹çš„æœ€çŸ­è·ç¦»,å¦‚æœuæ˜¯å‰²ç‚¹,å‘vè¿è¾¹æƒå€¼ä¸ºåŸå›¾çš„è¾¹æƒ(ä¸¤ä¸ªåœ†ç‚¹è¿è¾¹)</p><h1>åšæ³•</h1><p>å…ˆå»ºå‡ºåœ†æ–¹æ ‘è€ƒè™‘uå’Œvåœ¨æ ‘ä¸Šçš„LCA:</p><ul><li>pä¸ºåœ†ç‚¹,åˆ™ç­”æ¡ˆå°±æ˜¯æ ‘ä¸Šä¸¤ç‚¹çš„è·ç¦»</li><li>pä¸ºæ–¹ç‚¹,æ‰¾å‡ºpçš„ä¸¤ä¸ªå„¿å­a(uçš„ç¥–å…ˆ),b(vçš„ç¥–å…ˆ),aå’Œbå¤„åœ¨ä¸€ä¸ªç¯ä¸Š,ç­”æ¡ˆæ˜¯dis(a,b)+dis(a,u)+dis(b,v),æ³¨æ„dis(a,b)è¦å–min</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> dfn[N], low[N], clk, cnt, s[N], sum[N];</span><br><span class="line">vector&lt;pii&gt; G[N], T[N];</span><br><span class="line"><span class="type">int</span> n, m, q;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> LOG = <span class="number">16</span>;</span><br><span class="line"><span class="type">int</span> fa[N][<span class="number">20</span>], dep[N], dis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=LOG; i++)</span><br><span class="line">    fa[u][i] = fa[fa[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : T[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(v==fa[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    dis[v] = dis[u] + w;</span><br><span class="line">    dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">    fa[v][<span class="number">0</span>] = u;</span><br><span class="line">    <span class="built_in">dfs</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LCA</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(dep[fa[y][i]]&gt;=dep[x]) y = fa[y][i];</span><br><span class="line">  <span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(fa[x][i]!=fa[y][i]) x = fa[x][i], y = fa[y][i];</span><br><span class="line">  <span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">findcir</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ++cnt;</span><br><span class="line">  <span class="type">int</span> x = v, pre = w, pw = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(x!=fa[u][<span class="number">0</span>])</span><br><span class="line">  &#123;</span><br><span class="line">    sum[x] = pre;</span><br><span class="line">    pre += s[x];</span><br><span class="line">    x = fa[x][<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  sum[cnt] = sum[u];</span><br><span class="line">  sum[u] = <span class="number">0</span>;</span><br><span class="line">  x = v;</span><br><span class="line">  <span class="keyword">while</span>(x!=fa[u][<span class="number">0</span>])</span><br><span class="line">  &#123;</span><br><span class="line">    pw = <span class="built_in">min</span>(sum[x], sum[cnt]-sum[x]);</span><br><span class="line">    T[cnt].<span class="built_in">pb</span>(&#123;x, pw&#125;);</span><br><span class="line">    T[x].<span class="built_in">pb</span>(&#123;cnt, pw&#125;);</span><br><span class="line">    x = fa[x][<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dfn[u] = low[u] = ++clk;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(v==f) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">    &#123;</span><br><span class="line">      fa[v][<span class="number">0</span>] = u;</span><br><span class="line">      s[v] = w;</span><br><span class="line">      <span class="built_in">tarjan</span>(v, u);</span><br><span class="line">      low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">    <span class="keyword">if</span>(low[v]&gt;dfn[u])</span><br><span class="line">    &#123;</span><br><span class="line">      T[u].<span class="built_in">pb</span>(&#123;v, w&#125;);</span><br><span class="line">      T[v].<span class="built_in">pb</span>(&#123;u, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(fa[v][<span class="number">0</span>]==u||dfn[v]&lt;=dfn[u]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">findcir</span>(u, v, w);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> t = x;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(dep[fa[fa[t][i]][<span class="number">0</span>]]&gt;=dep[y]) t = fa[t][i];</span><br><span class="line">  <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line">  cnt = n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(&#123;v, w&#125;); G[v].<span class="built_in">pb</span>(&#123;u, w&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">tarjan</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  dep[<span class="number">1</span>] = <span class="number">1</span>; <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    <span class="type">int</span> z = <span class="built_in">LCA</span>(u, v);</span><br><span class="line">    <span class="keyword">if</span>(z&lt;=n) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dis[u]+dis[v]<span class="number">-2</span>*dis[z]);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x = <span class="built_in">find</span>(u, z), y = <span class="built_in">find</span>(v, z);</span><br><span class="line">      <span class="keyword">if</span>(sum[x]&gt;sum[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">      <span class="type">int</span> ans = dis[u]-dis[x]+dis[v]-dis[y]+<span class="built_in">min</span>(sum[y]-sum[x], sum[x]+sum[z]-sum[y]);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P5495 Dirichlet å‰ç¼€å’Œ</title>
      <link href="/2020/05/15/p5495-dirichlet-qian-zhui-he/"/>
      <url>/2020/05/15/p5495-dirichlet-qian-zhui-he/</url>
      
        <content type="html"><![CDATA[<p>$b_k = \sum_{i \mid k} a_i$æ±‚æ•°ç»„bè€ƒè™‘ä¸‹æ ‡iå’Œj,å¯¹å…¶è´¨å› æ•°åˆ†è§£,å½“ä¸”ä»…å½“içš„æ‰€æœ‰è´¨å› æ•°çš„å¹‚æ¬¡&lt;=jçš„,iæ‰æ˜¯jçš„å› æ•°,å¯ä»¥æœ‰è´¡çŒ®å‘ç°è¿™ä¸ªå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå…³äºè´¨å› å­åˆ†è§£åçš„æŒ‡æ•°çš„é«˜ç»´å‰ç¼€å’Œï¼Œä½¿ç”¨ç±»ä¼¼FMTçš„æ–¹æ³•å°±å¯ä»¥äº†å¤æ‚åº¦$O(n\log \log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=prime[<span class="number">0</span>]; i++)</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; <span class="number">1ll</span>*j*prime[i]&lt;=n; j++)</span><br><span class="line">    b[j*prime[i]] += b[j];</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ†æ–¹æ ‘</title>
      <link href="/2020/05/15/yuan-fang-shu/"/>
      <url>/2020/05/15/yuan-fang-shu/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚å¿µ"><a class="header-anchor" href="#æ¦‚å¿µ">Â¶</a>æ¦‚å¿µ</h2><p>ç‚¹åŒè”é€šåˆ†é‡:ä¸å­˜åœ¨å‰²ç‚¹/ä»»æ„ä¸¤ç‚¹é—´æœ‰è‡³å°‘ä¸¤æ¡ç‚¹ä¸é‡å¤è·¯å¾„ç‰¹æ®Š:ä¸¤ä¸ªç‚¹ä¸€æ¡è¾¹æ¯æ¡è¾¹å±äºä¸€ä¸ªç‚¹åŒ,æ¯ä¸ªå‰²ç‚¹å¯ä»¥å±äºå¤šä¸ªç‚¹åŒåœ†æ–¹æ ‘ä¸­åŸå›¾çš„æ¯ä¸ªç‚¹å¯¹åº”ä¸€ä¸ªåœ†ç‚¹,ä¸€ä¸ªç‚¹åŒå¯¹åº”ä¸€ä¸ªæ–¹ç‚¹å¯¹äºæ¯ä¸€ä¸ªç‚¹åŒè¿é€šåˆ†é‡ï¼Œå®ƒå¯¹åº”çš„æ–¹ç‚¹å‘è¿™ä¸ªç‚¹åŒè¿é€šåˆ†é‡ä¸­çš„æ¯ä¸ªåœ†ç‚¹è¿è¾¹æ¯ä¸ªç‚¹åŒå½¢æˆä¸€ä¸ªâ€œèŠèŠ±å›¾â€ï¼Œå¤šä¸ªâ€œèŠèŠ±å›¾â€é€šè¿‡åŸå›¾ä¸­çš„å‰²ç‚¹è¿æ¥åœ¨ä¸€èµ·(å› ä¸ºç‚¹åŒçš„åˆ†éš”ç‚¹æ˜¯å‰²ç‚¹)</p><h2 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h2><p>åœ†ç‚¹åªå’Œæ–¹ç‚¹ç›¸è¿,æ–¹ç‚¹åªå’Œåœ†ç‚¹ç›¸è¿åº¦æ•°å¤§äº1çš„åœ†ç‚¹æ˜¯åŸå›¾çš„å‰²ç‚¹åœ†æ–¹æ ‘æ˜¯æ— æ ¹æ ‘,æ— è®ºå–å“ªä¸ªç‚¹ä¸ºæ ¹å¼€å§‹dfsè§æ ‘,å½¢æ€éƒ½ä¸€æ ·</p><h2 id="å»ºæ ‘"><a class="header-anchor" href="#å»ºæ ‘">Â¶</a>å»ºæ ‘</h2><p>æ³¨æ„ä¸¤å€ç©ºé—´å»ºå®Œæ ‘æ ˆä¸­å¯èƒ½è¿˜æœ‰ç‚¹,æ³¨æ„å¤šç»„æ•°æ®æ¸…ç©º</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; G[N], T[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  low[u] = dfn[u] = ++clk;</span><br><span class="line">  stk[++top] = u;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">tarjan</span>(v, u);</span><br><span class="line">      low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">      <span class="keyword">if</span>(low[v]&gt;=dfn[u])</span><br><span class="line">      &#123;</span><br><span class="line">        ++cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">0</span>; x!=v; top--)</span><br><span class="line">        &#123;</span><br><span class="line">          x = stk[top];</span><br><span class="line">          T[cnt].<span class="built_in">pb</span>(x);</span><br><span class="line">          T[x].<span class="built_in">pb</span>(cnt);</span><br><span class="line">        &#125;</span><br><span class="line">        T[cnt].<span class="built_in">pb</span>(u);</span><br><span class="line">        T[u].<span class="built_in">pb</span>(cnt);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(v!=fa) low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4169 [Violet]å¤©ä½¿ç©å¶/SJYæ‘†æ£‹å­ kdtree</title>
      <link href="/2020/05/14/p4169-violettian-shi-wan-ou-sjy-bai-qi-zi-kdtree/"/>
      <url>/2020/05/14/p4169-violettian-shi-wan-ou-sjy-bai-qi-zi-kdtree/</url>
      
        <content type="html"><![CDATA[<p>è¦æ±‚ç»´æŠ¤äºŒç»´å¹³é¢,æ”¯æŒæ’ç‚¹,è¯¢é—®ç‚¹é›†ä¸­ä¸¤ç‚¹çš„æœ€å°æ›¼å“ˆé¡¿è·ç¦»</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>kdtreeç»´æŠ¤ä¸æ–­å¾ªç¯æŒ‰ç…§å…¶ä¸­ä¸€ç»´æ„å»ºäºŒå‰æ ‘æ¯ä¸ªç‚¹ç»´æŠ¤å­æ ‘ä¸­çš„æœ€å¤§æœ€å°åæ ‡(æœ€å¤§çŸ©å½¢),ç„¶åå¤§åŠ›å‰ªææœ¬é¢˜æœ‰æ’å…¥æ“ä½œ,æ‰€ä»¥å¯èƒ½ä¼šé€€åŒ–ä¸ºé“¾,éœ€è¦å®šæœŸé‡æ„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">2e6</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">6e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">  <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">  <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">  t *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, m, rt, ans;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> k = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">double</span> alpha = <span class="number">0.75</span>;</span><br><span class="line"><span class="type">int</span> D, pool[N], top, tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x[k];</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> point &amp;oth) <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x[D] &lt; oth.x[D];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;a[N], cur;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> mx[k], mn[k];</span><br><span class="line">  <span class="type">int</span> l, r, sz;</span><br><span class="line">  point tp;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(top) <span class="keyword">return</span> pool[top--];</span><br><span class="line">  <span class="keyword">return</span> ++tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn[i] = t[p].mx[i] = t[p].tp.x[i];</span><br><span class="line">    <span class="keyword">if</span>(l) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[l].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[l].mx[i]);</span><br><span class="line">    <span class="keyword">if</span>(r) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[r].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[r].mx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  t[p].sz = t[l].sz + t[r].sz + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> p = <span class="built_in">newnode</span>(), mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  D = d;</span><br><span class="line">  <span class="built_in">nth_element</span>(a+l, a+mid, a+r+<span class="number">1</span>);</span><br><span class="line">  t[p].tp = a[mid];</span><br><span class="line">  t[p].l = <span class="built_in">build</span>(l, mid<span class="number">-1</span>, (d+<span class="number">1</span>)%k);</span><br><span class="line">  t[p].r = <span class="built_in">build</span>(mid+<span class="number">1</span>, r, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(t[p].l) <span class="built_in">rebuild</span>(t[p].l, num);</span><br><span class="line">  a[num+t[t[p].l].sz+<span class="number">1</span>] = t[p].tp, pool[++top] = p;</span><br><span class="line">  <span class="keyword">if</span>(t[p].r) <span class="built_in">rebuild</span>(t[p].r, num+t[t[p].l].sz+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(alpha*t[p].sz&lt;t[t[p].l].sz||alpha*t[p].sz&lt;t[t[p].r].sz)</span><br><span class="line">    <span class="built_in">rebuild</span>(p, <span class="number">0</span>), p = <span class="built_in">build</span>(<span class="number">1</span>, t[p].sz, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p)</span><br><span class="line">  &#123;</span><br><span class="line">    p = <span class="built_in">newnode</span>();</span><br><span class="line">    t[p].tp = cur;</span><br><span class="line">    t[p].l = t[p].r = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cur.x[d]&gt;t[p].tp.x[d]) <span class="built_in">insert</span>(t[p].r, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">insert</span>(t[p].l, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="built_in">pushup</span>(p); <span class="built_in">test</span>(p, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getdis</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(cur.x[i]&lt;t[p].mn[i]) ans += (t[p].mn[i]-cur.x[i]);</span><br><span class="line">    <span class="keyword">if</span>(cur.x[i]&gt;t[p].mx[i]) ans += (cur.x[i]-t[p].mx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dis</span><span class="params">(point a, point b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">    ans += <span class="built_in">abs</span>(a.x[i]-b.x[i]);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ans = <span class="built_in">min</span>(ans, <span class="built_in">dis</span>(t[p].tp, cur));</span><br><span class="line">  <span class="type">int</span> dl = INF, dr = INF;</span><br><span class="line">  <span class="keyword">if</span>(t[p].l) dl = <span class="built_in">getdis</span>(t[p].l);</span><br><span class="line">  <span class="keyword">if</span>(t[p].r) dr = <span class="built_in">getdis</span>(t[p].r);</span><br><span class="line">  <span class="keyword">if</span>(dl&lt;dr)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dl&lt;ans) <span class="built_in">ask</span>(t[p].l);</span><br><span class="line">    <span class="keyword">if</span>(dr&lt;ans) <span class="built_in">ask</span>(t[p].r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dr&lt;ans) <span class="built_in">ask</span>(t[p].r);</span><br><span class="line">    <span class="keyword">if</span>(dl&lt;ans) <span class="built_in">ask</span>(t[p].l);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">read</span>(n); <span class="built_in">read</span>(m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">read</span>(a[i].x[<span class="number">0</span>]), <span class="built_in">read</span>(a[i].x[<span class="number">1</span>]);</span><br><span class="line">  rt = <span class="built_in">build</span>(<span class="number">1</span>, n, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">read</span>(op); <span class="built_in">read</span>(cur.x[<span class="number">0</span>]); <span class="built_in">read</span>(cur.x[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>) <span class="built_in">insert</span>(rt, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ans = INF;</span><br><span class="line">      <span class="built_in">ask</span>(rt);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p4211 LCA ç¦»çº¿+æ ‘å‰–</title>
      <link href="/2020/05/14/p4211-lca-chi-xian-shu-pou/"/>
      <url>/2020/05/14/p4211-lca-chi-xian-shu-pou/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€æ£µ1ä¸ºæ ¹çš„æ ‘, å¤šæ¬¡æŸ¥è¯¢$\sum_{i=l}^{r} dep[LCA(i,z)]$</p><h1>åšæ³•</h1><p>åªéœ€æŠŠl-rçš„æ¯ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„+1,ç„¶åæŸ¥è¯¢zåˆ°æ ¹çš„è·¯å¾„çš„å’Œå³å¯è€ƒè™‘ç¦»çº¿å·®åˆ†è¯¢é—®å¹¶æŒ‰å³ç«¯ç‚¹æ’åº</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">201314</span>;</span><br><span class="line"><span class="type">int</span> n, m, ans[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qry</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> r, coef, z, id;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> qry &amp;oth) &#123;</span><br><span class="line">    <span class="keyword">return</span> r &lt; oth.r;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  u += v;</span><br><span class="line">  <span class="keyword">if</span>(u&gt;=mod) u -= mod;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="type">int</span> sz[N], top[N], son[N], dep[N], fa[N], dfn[N], idfn[N], tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, sum, tag;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setval</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">add</span>(t[p].sum, v*(t[p].r-t[p].l+<span class="number">1</span>));</span><br><span class="line">  <span class="built_in">add</span>(t[p].tag, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].sum = t[p&lt;&lt;<span class="number">1</span>].sum;</span><br><span class="line">  <span class="built_in">add</span>(t[p].sum, t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setval</span>(p&lt;&lt;<span class="number">1</span>, t[p].tag); <span class="built_in">setval</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, t[p].tag);</span><br><span class="line">  t[p].tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].l = l, t[p].r = r;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setval</span>(p, v);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>, x, y, v);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y, v);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> t[p].sum;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dep[u] = dep[f] + <span class="number">1</span>; fa[u] = f;</span><br><span class="line">  sz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">    sz[u] += sz[v];</span><br><span class="line">    <span class="keyword">if</span>(sz[v]&gt;sz[son[u]]) son[u] = v;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top[u] = t;</span><br><span class="line">  dfn[u] = ++tot;</span><br><span class="line">  idfn[tot] = u;</span><br><span class="line">  <span class="keyword">if</span>(!son[u]) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs2</span>(son[u], t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    <span class="keyword">if</span>(v!=son[u]) <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">updt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, dfn[top[x]], dfn[x], v);</span><br><span class="line">    x = fa[top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="built_in">upd</span>(<span class="number">1</span>, dfn[x], dfn[y], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">askt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(<span class="number">1</span>, dfn[top[x]], dfn[x]));</span><br><span class="line">    x = fa[top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(<span class="number">1</span>, dfn[x], dfn[y]));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;u);</span><br><span class="line">    G[u+<span class="number">1</span>].<span class="built_in">pb</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>); <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, z; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;z);</span><br><span class="line">    q[++tot] = &#123;l, <span class="number">-1</span>, z+<span class="number">1</span>, i&#125;;</span><br><span class="line">    q[++tot] = &#123;r+<span class="number">1</span>, <span class="number">1</span>, z+<span class="number">1</span>, i&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(q+<span class="number">1</span>, q+tot+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">upd</span>(<span class="number">1</span>, dfn[<span class="number">1</span>], dfn[<span class="number">2</span>], <span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> pre = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=tot; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(pre&lt;=q[i].r)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">updt</span>(<span class="number">1</span>, pre, <span class="number">1</span>);</span><br><span class="line">      ++pre;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">add</span>(ans[q[i].id], q[i].coef*<span class="built_in">askt</span>(<span class="number">1</span>, q[i].z));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (ans[i]+mod)%mod);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P6514 [QkOI#R1] Quark and Strings</title>
      <link href="/2020/05/14/p6514-qkoir1-quark-and-strings/"/>
      <url>/2020/05/14/p6514-qkoir1-quark-and-strings/</url>
      
        <content type="html"><![CDATA[<p>è¦æ±‚ç»´æŠ¤nä¸ªå­—ç¬¦ä¸²,æ¯æ¬¡åœ¨åŒºé—´[l,r]åŠ ä¸€ä¸ªå­—ç¬¦,æˆ–è¯¢é—®åŒºé—´[l,r]çš„å­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>æœ¬è´¨å°±æ˜¯æ¯æ¬¡æ’å…¥ä¸€æ¡[l,r]çš„çº¿æ®µ,æˆ–è¯¢é—®å·¦ç«¯ç‚¹&lt;=l&amp;&amp;å³ç«¯ç‚¹&gt;=rçš„çº¿æ®µçš„ä¸ªæ•°,è½¬åŒ–åå°±æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç‚¹çš„æ¨¡å‹,cdqåˆ†æ²»,æ ‘å¥—æ ‘,kdtéƒ½å¯ä»¥è§£å†³</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> k = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">double</span> alpha = <span class="number">0.75</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">  <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">  <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">  t *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> D, pool[N], top, tot, rt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x[k];</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> point &amp;oth) <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x[D] &lt; oth.x[D];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;a[N], cur;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> mx[k], mn[k];</span><br><span class="line">  <span class="type">int</span> l, r, sz;</span><br><span class="line">  point tp;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(top) <span class="keyword">return</span> pool[top--];</span><br><span class="line">  <span class="keyword">return</span> ++tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn[i] = t[p].mx[i] = t[p].tp.x[i];</span><br><span class="line">    <span class="keyword">if</span>(l) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[l].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[l].mx[i]);</span><br><span class="line">    <span class="keyword">if</span>(r) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[r].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[r].mx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  t[p].sz = t[l].sz + t[r].sz + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> p = <span class="built_in">newnode</span>(), mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  D = d;</span><br><span class="line">  <span class="built_in">nth_element</span>(a+l, a+mid, a+r+<span class="number">1</span>);</span><br><span class="line">  t[p].tp = a[mid];</span><br><span class="line">  t[p].l = <span class="built_in">build</span>(l, mid<span class="number">-1</span>, d^<span class="number">1</span>);</span><br><span class="line">  t[p].r = <span class="built_in">build</span>(mid+<span class="number">1</span>, r, d^<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(t[p].l) <span class="built_in">rebuild</span>(t[p].l, num);</span><br><span class="line">  a[num+t[t[p].l].sz+<span class="number">1</span>] = t[p].tp, pool[++top] = p;</span><br><span class="line">  <span class="keyword">if</span>(t[p].r) <span class="built_in">rebuild</span>(t[p].r, num+t[t[p].l].sz+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(alpha*t[p].sz&lt;t[t[p].l].sz||alpha*t[p].sz&lt;t[t[p].r].sz)</span><br><span class="line">  <span class="built_in">rebuild</span>(p, <span class="number">0</span>), p = <span class="built_in">build</span>(<span class="number">1</span>, t[p].sz, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p)</span><br><span class="line">  &#123;</span><br><span class="line">    p = <span class="built_in">newnode</span>();</span><br><span class="line">    t[p].tp = cur;</span><br><span class="line">    t[p].l = t[p].r = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cur.x[d]&gt;t[p].tp.x[d]) <span class="built_in">insert</span>(t[p].r, d^<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">insert</span>(t[p].l, d^<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">pushup</span>(p); <span class="built_in">test</span>(p, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mx[<span class="number">0</span>]&lt;=cur.x[<span class="number">0</span>]&amp;&amp;t[p].mn[<span class="number">1</span>]&gt;=cur.x[<span class="number">1</span>]) <span class="keyword">return</span> t[p].sz;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mn[<span class="number">0</span>]&gt;cur.x[<span class="number">0</span>]||t[p].mx[<span class="number">1</span>]&lt;cur.x[<span class="number">1</span>]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tp.x[<span class="number">0</span>]&lt;=cur.x[<span class="number">0</span>]&amp;&amp;t[p].tp.x[<span class="number">1</span>]&gt;=cur.x[<span class="number">1</span>]) ++ans;</span><br><span class="line">  ans += <span class="built_in">ask</span>(t[p].l) + <span class="built_in">ask</span>(t[p].r);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n, q;</span><br><span class="line">  <span class="built_in">read</span>(n); <span class="built_in">read</span>(q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">read</span>(op); <span class="built_in">read</span>(cur.x[<span class="number">0</span>]); <span class="built_in">read</span>(cur.x[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>) <span class="built_in">insert</span>(rt, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">ask</span>(rt));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p4148 ç®€å•é¢˜ kdtree</title>
      <link href="/2020/05/14/p4148-jian-dan-ti-kdtree/"/>
      <url>/2020/05/14/p4148-jian-dan-ti-kdtree/</url>
      
        <content type="html"><![CDATA[<p>ç»´æŠ¤çŸ©å½¢,æ”¯æŒåŠ ç‚¹,è¯¢é—®çŸ©å½¢å’Œ,å¼ºåˆ¶åœ¨çº¿</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>ä¸å¼ºåˆ¶åœ¨çº¿å¯ä»¥cdq,å¼ºåˆ¶åœ¨çº¿å°±åªèƒ½kdtreeäº†æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤æœ€å¤§çŸ©å½¢,ä»¥åŠå­æ ‘å†…æ‰€æœ‰ç‚¹æƒå€¼çš„å’Œå¯¹äºè¯¢é—®,å¦‚æœå½“å‰èŠ‚ç‚¹çš„æœ€å¤§çŸ©å½¢åœ¨è¯¢é—®çŸ©å½¢å†…éƒ¨,ç›´æ¥è¿”å›sum,å¦‚æœä¸ç›¸äº¤,è¿”å›0,å¦åˆ™ç»§ç»­é€’å½’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">  <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">  <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">  t *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> k = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">double</span> alph = <span class="number">0.75</span>;</span><br><span class="line"><span class="type">int</span> rt, pool[N], top, tot, D;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x[k], w;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (point &amp;oth) &#123;</span><br><span class="line">    <span class="keyword">return</span> x[D] &lt; oth.x[D];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;a[N], cur;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, mx[k], mn[k], sum, sz;</span><br><span class="line">  point tp;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(top) <span class="keyword">return</span> pool[top--];</span><br><span class="line">  <span class="keyword">return</span> ++tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn[i] = t[p].mx[i] = t[p].tp.x[i];</span><br><span class="line">    <span class="keyword">if</span>(l) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[l].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[l].mx[i]);</span><br><span class="line">    <span class="keyword">if</span>(r) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[r].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[r].mx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  t[p].sz = t[l].sz + t[r].sz + <span class="number">1</span>;</span><br><span class="line">  t[p].sum = t[l].sum + t[r].sum + t[p].tp.w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> p = <span class="built_in">newnode</span>(), mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  D = d;</span><br><span class="line">  <span class="built_in">nth_element</span>(a+l, a+mid, a+r+<span class="number">1</span>);</span><br><span class="line">  t[p].tp = a[mid];</span><br><span class="line">  t[p].l = <span class="built_in">build</span>(l, mid<span class="number">-1</span>, (d+<span class="number">1</span>)%k);</span><br><span class="line">  t[p].r = <span class="built_in">build</span>(mid+<span class="number">1</span>, r, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(t[p].l) <span class="built_in">rebuild</span>(t[p].l, num);</span><br><span class="line">  a[num+t[t[p].l].sz+<span class="number">1</span>] = t[p].tp, pool[++top] = p;</span><br><span class="line">  <span class="keyword">if</span>(t[p].r) <span class="built_in">rebuild</span>(t[p].r, num+t[t[p].l].sz+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(alph*t[p].sz&lt;t[t[p].l].sz||alph*t[p].sz&lt;t[t[p].r].sz)</span><br><span class="line">    <span class="built_in">rebuild</span>(p, <span class="number">0</span>), p = <span class="built_in">build</span>(<span class="number">1</span>, t[p].sz, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">in</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> X1, <span class="type">int</span> Y1, <span class="type">int</span> X2, <span class="type">int</span> Y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> X1&gt;=x1&amp;&amp;Y1&gt;=y1&amp;&amp;X2&lt;=x2&amp;&amp;Y2&lt;=y2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">out</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> X1, <span class="type">int</span> Y1, <span class="type">int</span> X2, <span class="type">int</span> Y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> X2&lt;x1||X1&gt;x2||Y1&gt;y2||Y2&lt;y1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">in</span>(x1, y1, x2, y2, t[p].mn[<span class="number">0</span>], t[p].mn[<span class="number">1</span>], t[p].mx[<span class="number">0</span>], t[p].mx[<span class="number">1</span>])) <span class="keyword">return</span> t[p].sum;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">out</span>(x1, y1, x2, y2, t[p].mn[<span class="number">0</span>], t[p].mn[<span class="number">1</span>], t[p].mx[<span class="number">0</span>], t[p].mx[<span class="number">1</span>])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">in</span>(x1, y1, x2, y2, t[p].tp.x[<span class="number">0</span>], t[p].tp.x[<span class="number">1</span>], t[p].tp.x[<span class="number">0</span>], t[p].tp.x[<span class="number">1</span>])) ans += t[p].tp.w;</span><br><span class="line">  ans += <span class="built_in">ask</span>(t[p].l, x1, y1, x2, y2) + <span class="built_in">ask</span>(t[p].r, x1, y1, x2, y2);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p)</span><br><span class="line">  &#123;</span><br><span class="line">    p = <span class="built_in">newnode</span>();</span><br><span class="line">    t[p].tp = cur;</span><br><span class="line">    t[p].l = t[p].r = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cur.x[d]&gt;t[p].tp.x[d]) <span class="built_in">insert</span>(t[p].r, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">insert</span>(t[p].l, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="built_in">pushup</span>(p); <span class="built_in">test</span>(p, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">read</span>(n);</span><br><span class="line">  <span class="type">int</span> lstans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">read</span>(op);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">read</span>(cur.x[<span class="number">0</span>]), <span class="built_in">read</span>(cur.x[<span class="number">1</span>]), <span class="built_in">read</span>(cur.w);</span><br><span class="line">      cur.x[<span class="number">0</span>] ^= lstans, cur.x[<span class="number">1</span>] ^= lstans, cur.w ^= lstans;</span><br><span class="line">      <span class="built_in">insert</span>(rt, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> a, b, c, d;</span><br><span class="line">      <span class="built_in">read</span>(a), <span class="built_in">read</span>(b), <span class="built_in">read</span>(c), <span class="built_in">read</span>(d);</span><br><span class="line">      a ^= lstans, b ^= lstans, c ^= lstans, d ^= lstans;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, lstans=<span class="built_in">ask</span>(rt, a, b, c, d));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces1349</title>
      <link href="/2020/05/13/codeforces1349/"/>
      <url>/2020/05/13/codeforces1349/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šnä¸ªæ•°$a_i$â€‹,æ±‚$gcd{(lcm(a_i,a_j))}$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è€ƒè™‘gcdå’Œlcmçš„æœ¬è´¨,gcdå°±æ˜¯æ‰€æœ‰æ•°ä¸ªè´¨å› å­å¹‚æ¬¡å–min,è€Œlcmæ˜¯å–maxæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯å„è´¨å› å­å¹‚æ¬¡çš„æ¬¡å¤§å€¼(<s>ä¸ä¼šç»´æŠ¤</s>)è€ƒè™‘a[i]å¯¹ç­”æ¡ˆçš„è´¡çŒ®,å°±æ˜¯$lcm(a_i, sufgcd_{i+1})$sufgcdä¸ºåç¼€gcdæœ€åå„ä¸ªæ•°è´¡çŒ®å–gcdå³å¯</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><h3 id="é¢˜æ„-s2"><a class="header-anchor" href="#é¢˜æ„-s2">Â¶</a>é¢˜æ„</h3><p>ç»™å®šnä¸ªæ•°$a_i$â€‹,æ¯æ¬¡æ“ä½œå¯ä»¥é€‰å®šä¸€ä¸ªè¿ç»­å­æ®µ,å¹¶æŠŠæ‰€æœ‰æ•°å˜ä¸ºä¸­ä½æ•°(ç¬¬$\lfloor \frac{n+1}{2}\rfloor$å¤§çš„æ•°),é—®èƒ½å¦é€šè¿‡è‹¥å¹²æ¬¡æ“ä½œä½¿æ•´ä¸ªæ•°åˆ—æ‰€æœ‰æ•°éƒ½æ˜¯k</p><h3 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h3><p>1.å¦‚æœæ²¡æœ‰k,æ— è§£2.n=1,çœ‹æ˜¯ä¸æ˜¯k3.å¦‚æœæœ‰ä¸€æ®µè¿ç»­çš„k(&gt;=2),åˆ™ä¸€å®šæœ‰è§£,å› ä¸ºæ¯æ¬¡éƒ½å¯ä»¥è‡³å°‘å‘å·¦å³å»¶æ‹“ä¸€æ­¥.è€ƒè™‘åˆ°ä¸¤ä¸ª&gt;=kçš„æ•°å¯ä»¥æŠŠä¸€ä¸ª&lt;kçš„æ•°å˜æˆ&gt;=k.è€Œä¸€ä¸ª=kæ•°å¯ä»¥æŠŠä¸€ä¸ª&gt;kçš„æ•°å˜æˆkåªè¦<strong>å­˜åœ¨ä¸¤ä¸ª</strong>&gt;=kçš„æ•°çš„ä½ç½®å·®&lt;2åˆ™ä¸€å®šæœ‰è§£(é¦–å…ˆå˜æˆ3ä¸ª&gt;=kçš„æ•°,ç„¶åä¸æ–­å»¶æ‹“å³å¯)</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><h3 id="é¢˜æ„-s3"><a class="header-anchor" href="#é¢˜æ„-s3">Â¶</a>é¢˜æ„</h3><p>ä¸€ä¸ªé»‘ç™½æ ¼,åœ¨æ¯ä¸€ç§’,è‹¥ä¸€ä¸ªæ ¼å­ä¸ä¸Šä¸‹å·¦å³çš„æ ¼å­é¢œè‰²ä¸åŒ,å®ƒçš„é¢œè‰²ä¸æ”¹å˜,å¦åˆ™æ”¹å˜.é—®æŸä¸ªæ ¼å­tç§’åçš„é¢œè‰²</p><h3 id="åšæ³•-s3"><a class="header-anchor" href="#åšæ³•-s3">Â¶</a>åšæ³•</h3><p>å¦‚æœè¯¥æ ¼å­ä¸å››å‘¨æŸæ ¼å­é¢œè‰²ç›¸åŒ,é‚£ä¹ˆå®ƒå°±ä¸€ç›´ä¼šæ”¹å˜,å¦åˆ™å®ƒä¼šä¿æŒä¸å˜xç§’å,å†ä¸€ç›´æ”¹å˜,xä¸ºè·ç¦»è¯¥æ ¼å­æœ€è¿‘çš„ä¸€ç›´æ”¹å˜çš„æ ¼å­çš„æ›¼å“ˆé¡¿è·ç¦»,å¤šæºbfsé¢„å¤„ç†å³å¯.</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p5107 çŸ©é˜µå¿«é€Ÿå¹‚+å€å¢+å¡å¸¸</title>
      <link href="/2020/05/13/p5107-ju-zhen-kuai-su-mi-bei-zeng-qia-chang/"/>
      <url>/2020/05/13/p5107-ju-zhen-kuai-su-mi-bei-zeng-qia-chang/</url>
      
        <content type="html"><![CDATA[<p>å¸¦è¡Œå’Œåˆ—çš„çŸ©é˜µæ¨¡æ¿è®°å¾—åˆå§‹åŒ–è¡Œåˆ—,æ³¨æ„å·¦ä¹˜è¿˜æ˜¯å³ä¹˜æ³¨æ„åˆ°è¯¢é—®å¾ˆå¤š,æ‰€ä»¥å…ˆé¢„å¤„ç†å¥½å€å¢çŸ©é˜µ,(å€æ•°ä¸ä¸€å®šè¦æ˜¯2,å¦‚æœé¢„å¤„ç†å¤æ‚åº¦æ¯”è¾ƒä½,å¯ä»¥å¢å¤§å€æ•°b)å¢å¤§å€æ•°,é¢„å¤„ç†å¤æ‚åº¦æå‡,ä½†è¯¢é—®å¤æ‚åº¦é™ä½,å¯ä»¥è€ƒè™‘åˆ¶è¡¡ä¸¤è€…è¯¢é—®å¯ä»¥æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºæ’åº,å¯ä»¥å‡å°‘ä¸€äº›è¿ç®—å¯ä»¥æŠŠçŸ©é˜µä¹˜æ³•çš„forè¿›è¡Œå¾ªç¯å±•å¼€</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">55</span>, M = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">int</span> n, m, q, qry[M], idx[M], res[M];</span><br><span class="line">ll inv[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">matrix</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m;</span><br><span class="line">  ll mat[N][N];</span><br><span class="line">  <span class="built_in">matrix</span>() &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="built_in">matrix</span>(<span class="type">int</span> a, <span class="type">int</span> b) : <span class="built_in">n</span>(a), <span class="built_in">m</span>(b) &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</span><br><span class="line">        mat[i][j] = (i==j);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;b[<span class="number">32</span>];</span><br><span class="line">matrix <span class="keyword">operator</span> * (matrix a, matrix b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function">matrix <span class="title">res</span><span class="params">(a.n, b.m)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=a.n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=b.m; j++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=a.m; k++)</span><br><span class="line">        res.mat[i][j] = (res.mat[i][j]+a.mat[i][k]*b.mat[k][j]%mod)%mod;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">matrix <span class="keyword">operator</span> ^ (matrix a, ll x)</span><br><span class="line">&#123;</span><br><span class="line">  matrix res; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line">  <span class="function">matrix <span class="title">a</span><span class="params">(n, <span class="number">1</span>)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;a.mat[i][<span class="number">1</span>]);</span><br><span class="line">  b[<span class="number">0</span>].n = b[<span class="number">0</span>].m = n;</span><br><span class="line">  b[<span class="number">0</span>].<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    b[<span class="number">0</span>].mat[v][u]++;</span><br><span class="line">  &#125;</span><br><span class="line">  inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = (mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> d = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) d += b[<span class="number">0</span>].mat[i][j];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) b[<span class="number">0</span>].mat[i][j] = b[<span class="number">0</span>].mat[i][j]*inv[d]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">31</span>; i++) b[i] = b[i<span class="number">-1</span>]*b[i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, qry+i);</span><br><span class="line">  <span class="built_in">iota</span>(idx+<span class="number">1</span>, idx+q+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">sort</span>(idx+<span class="number">1</span>, idx+q+<span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">    <span class="keyword">return</span> qry[x] &lt; qry[y];</span><br><span class="line">  &#125;);</span><br><span class="line">  matrix ans = a;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> tmp = qry[idx[i]] - qry[idx[i<span class="number">-1</span>]];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">31</span>; j&gt;=<span class="number">0</span>; j--)</span><br><span class="line">      <span class="keyword">if</span>((tmp&gt;&gt;j)&amp;<span class="number">1</span>) ans = b[j]*ans;</span><br><span class="line">    ll Res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) Res ^= ans.mat[i][<span class="number">1</span>];</span><br><span class="line">    res[idx[i]] = Res%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, res[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å››ç»´ååº cdqå¥—cdq</title>
      <link href="/2020/05/13/si-wei-pian-xu-cdq-tao-cdq/"/>
      <url>/2020/05/13/si-wei-pian-xu-cdq-tao-cdq/</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a class="header-anchor" href="#é—®é¢˜">Â¶</a>é—®é¢˜</h2><p>æ±‚è§£&lt;=a&amp;&amp;&lt;=b&amp;&amp;&lt;=c&amp;&amp;&lt;=dçš„å››å…ƒç»„æ•°é‡</p><h2 id="è¿‡ç¨‹"><a class="header-anchor" href="#è¿‡ç¨‹">Â¶</a>è¿‡ç¨‹</h2><p>1.æœ‰å››å…ƒç»„ç›¸åŒéœ€è¦å…ˆåˆå¹¶(unique)2.å¯¹ç¬¬ä¸€ç»´æ’åº3.cdq1,<strong>å…ˆæŠŠå·¦åŠéƒ¨åˆ†æ ‡è®°ä¸ºLEFT,å³åŠéƒ¨åˆ†æ ‡è®°ä¸ºRIGHT</strong>,ç„¶åå¯¹ç¬¬äºŒç»´æŒ‰åºå½’å¹¶4.cdq2,å¯¹ç¬¬ä¸‰ç»´æŒ‰åºå½’å¹¶,ç¬¬å››ç»´ç”¨æ•°æ®ç»“æ„(å¦‚bit)ç»´æŠ¤,<strong>åªå¯¹å·¦è¾¹æ ‡è®°ä¸ºLEFTçš„è¿›è¡Œä¿®æ”¹,å¯¹å³è¾¹æ ‡è®°ä¸ºRIGHTçš„è¿›è¡ŒæŸ¥è¯¢</strong>æ³¨:æœ‰æ—¶ä¹Ÿå¯ä»¥ç›´æ¥sort,å¤šä¸€ä¸ªlogcdq1ä¸­çš„å½’å¹¶æ•°ç»„æœ€å¥½å’Œcdq2ä¸åŒ,å¦åˆ™åœ¨cdq2ç»“æŸåè®°å¾—è¿˜åŸä¸ºcdq1ä¸­çš„é¡ºåºæ’åºä¸€å®šè¦å½»åº•,å¦åˆ™ä¼šwa</p><h2 id="ä¾‹é¢˜"><a class="header-anchor" href="#ä¾‹é¢˜">Â¶</a>ä¾‹é¢˜</h2><p>hdu5126ç«‹æ–¹ä½“åŠ ç‚¹,ç«‹æ–¹ä½“æ•°ç‚¹æŠŠåŠ ç‚¹çœ‹ä½œä¿®æ”¹æ“ä½œ,æ•°ç‚¹åˆ©ç”¨å®¹æ–¥æ‹†æˆ8ä¸ªè¯¢é—®.ä¿®æ”¹å’ŒæŸ¥è¯¢æŒ‰ç…§æ—¶é—´æœ‰åº,æ˜¯ä¸€ä¸ªå››ç»´ååº.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">4e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> q, c[N], tot, ans[N], id[N];</span><br><span class="line"><span class="type">bool</span> isq[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=tot; i+=(i&amp;-i)) c[i] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += c[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">item</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x, y, z, t, coef;</span><br><span class="line">  <span class="type">bool</span> tag;</span><br><span class="line">&#125;p[N], tmp[N], tmp2[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(item a, item b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a.x==b.x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(a.y==b.y) <span class="keyword">return</span> a.z==b.z ? a.t &lt; b.t : a.z &lt; b.z;</span><br><span class="line">    <span class="keyword">return</span> a.y &lt; b.y;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a.x &lt; b.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CDQ2</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ2</span>(l, mid); <span class="built_in">CDQ2</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="type">int</span> i = l, j = mid+<span class="number">1</span>, k = l;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=mid&amp;&amp;j&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(tmp[i].z&lt;=tmp[j].z)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!tmp[i].tag&amp;&amp;!tmp[i].coef) <span class="built_in">upd</span>(tmp[i].t, <span class="number">1</span>);</span><br><span class="line">      tmp2[k++] = tmp[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(tmp[j].tag&amp;&amp;tmp[j].coef) ans[tmp[j].t] += <span class="built_in">ask</span>(tmp[j].t<span class="number">-1</span>)*tmp[j].coef;</span><br><span class="line">      tmp2[k++] = tmp[j++];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=mid)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!tmp[i].tag&amp;&amp;!tmp[i].coef) <span class="built_in">upd</span>(tmp[i].t, <span class="number">1</span>);</span><br><span class="line">    tmp2[k++] = tmp[i++];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(j&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(tmp[j].tag&amp;&amp;tmp[j].coef) ans[tmp[j].t] += <span class="built_in">ask</span>(tmp[j].t<span class="number">-1</span>)*tmp[j].coef;</span><br><span class="line">    tmp2[k++] = tmp[j++];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=mid; i++) <span class="keyword">if</span>(!tmp[i].tag&amp;&amp;!tmp[i].coef) <span class="built_in">upd</span>(tmp[i].t, <span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) tmp[i] = tmp2[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CDQ1</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ1</span>(l, mid); <span class="built_in">CDQ1</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=mid; i++) p[i].tag = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=mid+<span class="number">1</span>; i&lt;=r; i++) p[i].tag = <span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> i = l, j = mid+<span class="number">1</span>, k = l;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=mid&amp;&amp;j&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p[i].y&lt;=p[j].y) tmp[k++] = p[i++];</span><br><span class="line">    <span class="keyword">else</span> tmp[k++] = p[j++];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=mid) tmp[k++] = p[i++];</span><br><span class="line">  <span class="keyword">while</span>(j&lt;=r) tmp[k++] = p[j++];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) p[i] = tmp[i];</span><br><span class="line">  <span class="built_in">CDQ2</span>(l, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">  tot = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">    ans[i] = isq[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">      p[++tot] = &#123;x, y, z, i, <span class="number">0</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x1, y1, z1, x2, y2, z2;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d%d&quot;</span>, &amp;x1, &amp;y1, &amp;z1, &amp;x2, &amp;y2, &amp;z2);</span><br><span class="line">      isq[i] = <span class="number">1</span>;</span><br><span class="line">      p[++tot] = &#123;x2, y2, z2, i, <span class="number">1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x1<span class="number">-1</span>, y2, z2, i, <span class="number">-1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x2, y1<span class="number">-1</span>, z2, i, <span class="number">-1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x2, y2, z1<span class="number">-1</span>, i, <span class="number">-1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x1<span class="number">-1</span>, y1<span class="number">-1</span>, z2, i, <span class="number">1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x2, y1<span class="number">-1</span>, z1<span class="number">-1</span>, i, <span class="number">1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x1<span class="number">-1</span>, y2, z1<span class="number">-1</span>, i, <span class="number">1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x1<span class="number">-1</span>, y1<span class="number">-1</span>, z1<span class="number">-1</span>, i, <span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(p+<span class="number">1</span>, p+tot+<span class="number">1</span>, cmp);</span><br><span class="line">  <span class="built_in">CDQ1</span>(<span class="number">1</span>, tot);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">    <span class="keyword">if</span>(isq[i]) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>p5621å››ç»´LISæ ‘çŠ¶æ•°ç»„ç»´æŠ¤ç¬¬å››ç»´çš„dpå‰ç¼€max,ç¬¬å››ç»´è¦ç¦»æ•£åŒ–,åŒæ—¶ç›¸åŒçš„å››å…ƒç»„è¦åˆå¹¶<strong>æ³¨æ„</strong>æ­¤é¢˜è¦å…ˆcdqå·¦åŠéƒ¨åˆ†,ç„¶åç»Ÿè®¡å·¦å¯¹å³çš„ç­”æ¡ˆ,å†cdqå³åŠéƒ¨åˆ†.è€Œä¸Šä¸€é¢˜æ˜¯å…ˆcdqå·¦å³,æœ€åå†ç»Ÿè®¡ç­”æ¡ˆ(å…¶å®ä¹Ÿå¯ä»¥æŒ‰æœ¬é¢˜çš„æµç¨‹,ä½†æœ¬é¢˜ä¸å¯ä»¥è¿™æ ·,å› ä¸ºæœ¬è´¨æ˜¯ä¸€ä¸ªdp,å¿…é¡»ä»å·¦åˆ°å³,è€Œç»Ÿè®¡æ²¡è¿™ä¸ªè¦æ±‚).</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> id[N], lsh[N];</span><br><span class="line">ll c[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, ll v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=m; i+=(i&amp;-i)) c[i] = <span class="built_in">max</span>(c[i], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=m; i+=(i&amp;-i)) c[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans = <span class="built_in">max</span>(ans, c[i]);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">item</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> a, b, c, d, id;</span><br><span class="line">  <span class="type">bool</span> t;</span><br><span class="line">  ll mx, val;</span><br><span class="line">&#125;p[N], tmp[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp1</span><span class="params">(item x, item y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x.a==y.a)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x.b==y.b) <span class="keyword">return</span> x.c==y.c ? x.d &lt; y.d : x.c &lt; y.c;</span><br><span class="line">    <span class="keyword">return</span> x.b &lt; y.b;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x.a &lt; y.a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp2</span><span class="params">(item x, item y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x.b==y.b&amp;&amp;x.c==y.c&amp;&amp;x.d==y.d) <span class="keyword">return</span> x.a &lt; y.a;</span><br><span class="line">  <span class="keyword">if</span>(x.b==y.b) <span class="keyword">return</span> x.c==y.c ? x.d &lt; y.d : x.c &lt; y.c;</span><br><span class="line">  <span class="keyword">return</span> x.b &lt; y.b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp3</span><span class="params">(item x, item y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x.c==y.c&amp;&amp;x.d==y.d) <span class="keyword">return</span> x.a==y.a ? x.b &lt; y.b : x.a &lt; y.a;</span><br><span class="line">  <span class="keyword">return</span> x.c==y.c ? x.d &lt; y.d : x.c &lt; y.c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CDQ2</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ2</span>(l, mid);</span><br><span class="line">  <span class="built_in">sort</span>(p+l, p+mid+<span class="number">1</span>, cmp3);</span><br><span class="line">  <span class="built_in">sort</span>(p+mid+<span class="number">1</span>, p+r+<span class="number">1</span>, cmp3);</span><br><span class="line">  <span class="type">int</span> i = l, j = mid+<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(j&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=mid &amp;&amp; p[i].c&lt;=p[j].c)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!p[i].t) <span class="built_in">upd</span>(p[i].d, p[i].mx);</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p[j].t) p[j].mx = <span class="built_in">max</span>(p[j].mx, <span class="built_in">ask</span>(p[j].d)+p[j].val);</span><br><span class="line">    j++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=mid; i++) <span class="keyword">if</span>(!p[i].t) <span class="built_in">clear</span>(p[i].d);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) tmp[id[p[i].id]] = p[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) p[i] = tmp[i];</span><br><span class="line">  <span class="built_in">CDQ2</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CDQ1</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ1</span>(l, mid);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=mid; i++) p[i].t = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=mid+<span class="number">1</span>; i&lt;=r; i++) p[i].t = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">sort</span>(p+l, p+r+<span class="number">1</span>, cmp2);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) id[p[i].id] = i;</span><br><span class="line">  <span class="built_in">CDQ2</span>(l, r);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) tmp[p[i].id] = p[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) p[i] = tmp[i];</span><br><span class="line">  <span class="built_in">CDQ1</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;p[i].a, &amp;p[i].b, &amp;p[i].c, &amp;p[i].d);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;p[i].val);</span><br><span class="line">    lsh[i] = p[i].d;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(lsh+<span class="number">1</span>, lsh+n+<span class="number">1</span>);</span><br><span class="line">  m = <span class="built_in">unique</span>(lsh+<span class="number">1</span>, lsh+n+<span class="number">1</span>) - lsh - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    p[i].d = <span class="built_in">lower_bound</span>(lsh+<span class="number">1</span>, lsh+m+<span class="number">1</span>, p[i].d) - lsh;</span><br><span class="line">  <span class="type">int</span> tot = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">sort</span>(p+<span class="number">1</span>, p+n+<span class="number">1</span>, cmp1);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p[i].a!=p[i<span class="number">-1</span>].a||p[i].b!=p[i<span class="number">-1</span>].b||p[i].c!=p[i<span class="number">-1</span>].c||p[i].d!=p[i<span class="number">-1</span>].d) p[++tot] = p[i];</span><br><span class="line">    <span class="keyword">else</span> p[tot].val += <span class="built_in">max</span>(p[i].val, <span class="number">0ll</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  n = tot;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    p[i].id = i;</span><br><span class="line">    p[i].mx = p[i].val;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">CDQ1</span>(<span class="number">1</span>, n);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) ans = <span class="built_in">max</span>(ans, p[i].mx);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chef and Bitwise Product è´ªå¿ƒ+ä½è¿ç®—</title>
      <link href="/2020/05/11/chef-and-bitwise-product-tan-xin-wei-yun-suan/"/>
      <url>/2020/05/11/chef-and-bitwise-product-tan-xin-wei-yun-suan/</url>
      
        <content type="html"><![CDATA[<p>ç»™ä¸¤ä¸ªæ•°x,y($x, y &lt;= 10^{12}$),è¦æ±‚æ‰¾åˆ°ä¸€ä¸ªæ•°z,æœ€å¤§åŒ–(x&amp;z)*(y&amp;z)åŒæ—¶æœ€å°åŒ–z,ä¸”$L\leq z\leq R$,Lå’ŒRç”±é¢˜ç›®ç»™å‡º($L, R \leq 10^{12}$)</p><h1>åšæ³•</h1><p>å…ˆä¸è€ƒè™‘ä¸Šä¸‹ç•Œé™åˆ¶,é‚£ä¹ˆzå…¨å–1è‚¯å®šæœ€ä¼˜,å†åŠ å…¥ä¸Šç•Œé™åˆ¶,ç„¶è€Œå¹¶ä¸æ˜¯å–Ræœ€ä¼˜,æ¯”å¦‚x = 7, y = 12, l = 0, r = 8, æ­¤æ—¶z=7å¯ä»¥æƒ³åˆ°ä¸€ç§è´ªå¿ƒçš„åšæ³•,è®©Rçš„æŸä¸€ä½1å˜æˆ0,ç„¶åè®©Rçš„ä½ä½å…¨å˜1,ç„¶åäº¤ä¸€å‘ä¼šå‘ç°0åˆ†å…¶å®è¿™ä¸ªæ—¶å€™å·²ç»å¯ä»¥æœ€å¤§åŒ–(x&amp;z)*(y&amp;z),ä¸‹é¢è¦æœ€å°åŒ–z,å¯ä»¥å‘ç°å¦‚æœxå’Œyçš„æŸä¸€ä½åŒæ—¶ä¸º0,æ­¤æ—¶zçš„è¯¥ä½ä¸º1ä¹Ÿæ²¡ç”¨.æ‰€ä»¥åªè¦åœ¨ä¿è¯&gt;=ä¸‹ç•Œçš„æƒ…å†µä¸‹é€šè¿‡è¯¥æ¡ä»¶æœ€å°åŒ–zå³å¯.å¦å¤–å¥½åƒè¦ç‰¹åˆ¤ä¸€ä¸‹ä¸‹ç•Œä¸ºæœ€ä¼˜è§£çš„æƒ…å†µ.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">15</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll x, y, l, r;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>, &amp;x, &amp;y, &amp;l, &amp;r);</span><br><span class="line">  ll ans = (x&amp;r)*(y&amp;r), z = r;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">40</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> b = (r&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b)</span><br><span class="line">    &#123;</span><br><span class="line">      ll c = (r&gt;&gt;(i+<span class="number">1</span>)&lt;&lt;(i+<span class="number">1</span>)) + (<span class="number">1ll</span>&lt;&lt;i) - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">40</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> aa = (x&gt;&gt;i)&amp;<span class="number">1</span>, bb = (y&gt;&gt;i)&amp;<span class="number">1</span>, cc = (c&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(!aa &amp;&amp; !bb &amp;&amp; cc)</span><br><span class="line">          <span class="keyword">if</span>((c^(<span class="number">1ll</span>&lt;&lt;i))&gt;=l) c ^= (<span class="number">1ll</span>&lt;&lt;i);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(c&lt;l) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">if</span>((x&amp;c)*(y&amp;c)&gt;ans || (((x&amp;c)*(y&amp;c))==ans&amp;&amp;c&lt;z)) ans = (x&amp;c)*(y&amp;c), z = c;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!ans) z = l;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Binary Land åŒæ ˆtrick</title>
      <link href="/2020/05/11/binary-land-shuang-zhan-trick/"/>
      <url>/2020/05/11/binary-land-shuang-zhan-trick/</url>
      
        <content type="html"><![CDATA[<p>è¦æ±‚åŠ¨æ€ç»´æŠ¤ä¸€ä¸ª01çŸ©é˜µ,æ”¯æŒ:1.ä»é¡¶éƒ¨åˆ é™¤ä¸€è¡Œ2.ä»å°¾éƒ¨æ·»åŠ ä¸€è¡Œ3.è¯¢é—®å½“å‰é¡¶éƒ¨æŸåˆ—åˆ°å°¾éƒ¨æŸåˆ—çš„åˆæ³•è·¯å¾„æ•°å…¶ä¸­åˆæ³•è·¯å¾„æ•°å®šä¹‰ä¸º,æ¯æ¬¡åªèƒ½ä»[i,j]âˆ’&gt;[i,jâˆ’1]or[i,j]or[i,j+1],ä¸”è¦æ±‚ä¸¤ç‚¹åŒä¸º0æˆ–1çŸ©é˜µåˆ—æ•°=20,æ“ä½œæ•°=3e5</p><h1>åšæ³•</h1><p>æ˜¾ç„¶è·¯å¾„æ•°å¯ä»¥é€šè¿‡ç®€å•dpæ±‚å¾—,ä»å°¾éƒ¨æ·»åŠ ä¸€è¡Œä¹Ÿå¾ˆç®€å•,å¯ä»¥O(col)æ±‚å¾—,ä½†æ˜¯åˆ é™¤æ“ä½œå¾ˆéº»çƒ¦,å¿…é¡»å…¨éƒ¨é‡ç®—.æ­¤æ—¶å°±æœ‰ä¸€ä¸ªtrickäº†,å½“è¦æ±‚çš„æ˜¯åŒç«¯é˜Ÿåˆ—æ“ä½œ,ä½†æ˜¯åªæœ‰æ·»åŠ å¯ä»¥å¿«é€Ÿåš,é‚£å°±å¯ä»¥ç”¨ä¸¤ä¸ªå¯¹é¡¶æ ˆæ¥æ“ä½œ.å¼€å£å‘ä¸Šçš„ä¸ºs1,å¼€å£å‘ä¸‹çš„ä¸ºs2å°¾éƒ¨æ·»åŠ å°±è®©s2çš„æ ˆæŒ‡é’ˆ++,å¹¶ä¸”O(col)æ›´æ–°é¡¶éƒ¨åˆ é™¤å°±è®©s1çš„æ ˆæŒ‡é’ˆâ€“,æ³¨æ„å¦‚æœs1çš„æ ˆæŒ‡é’ˆä¸º0,å°±æŠŠs2çš„æ‰€æœ‰å€¼æ¬åˆ°s1,æ­¤æ—¶å°±ç›¸å½“äºç»™s1æ·»åŠ ,s2åˆ é™¤.åˆ—æ•°å¾ˆå°‘,æˆ‘ä»¬ç›´æ¥ä¿å­˜æ‰€æœ‰å¯èƒ½çš„$n^2$ä¸ªç­”æ¡ˆ,ç„¶åæ¯æ¬¡ä¿®æ”¹ä¹Ÿéƒ½æ˜¯$n^2$çš„.è¯¢é—®çš„è¯, $n^2$å¤„ç†ä¸‹å¯¹é¡¶å¤„éƒ¨åˆ†ç­”æ¡ˆçš„åˆå¹¶å³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>, M = <span class="number">25</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, sta[<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">2</span>][N][M][M];</span><br><span class="line">string p[<span class="number">2</span>][N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> idx)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = sta[idx];</span><br><span class="line">  <span class="keyword">if</span>(x==<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">        dp[idx][x][i][j] = (i==j);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      &#123;</span><br><span class="line">        dp[idx][x][i][j] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=j<span class="number">-1</span>; k&lt;=j+<span class="number">1</span>; k++)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span>(k&lt;<span class="number">1</span>||k&gt;n||p[idx][x<span class="number">-1</span>][k<span class="number">-1</span>]!=p[idx][x][j<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">          dp[idx][x][i][j] += dp[idx][x<span class="number">-1</span>][i][k];</span><br><span class="line">          <span class="keyword">if</span>(dp[idx][x][i][j]&gt;=mod) dp[idx][x][i][j] -= mod;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    string op;</span><br><span class="line">    cin &gt;&gt; op;</span><br><span class="line">    <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      cin &gt;&gt; p[<span class="number">1</span>][++sta[<span class="number">1</span>]];</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(sta[<span class="number">0</span>]==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span>(sta[<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">          p[<span class="number">0</span>][++sta[<span class="number">0</span>]] = p[<span class="number">1</span>][sta[<span class="number">1</span>]--];</span><br><span class="line">          <span class="built_in">upd</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      sta[<span class="number">0</span>]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> a, b;</span><br><span class="line">      cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">      <span class="keyword">if</span>(sta[<span class="number">0</span>]==<span class="number">0</span>) cout &lt;&lt; dp[<span class="number">1</span>][sta[<span class="number">1</span>]][a][b] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(sta[<span class="number">1</span>]==<span class="number">0</span>) cout &lt;&lt; dp[<span class="number">0</span>][sta[<span class="number">0</span>]][b][a] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">          <span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">-1</span>; j&lt;=i+<span class="number">1</span>; j++)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span>(j&lt;<span class="number">1</span>||j&gt;n||p[<span class="number">0</span>][<span class="number">1</span>][i<span class="number">-1</span>]!=p[<span class="number">1</span>][<span class="number">1</span>][j<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">            ans += <span class="number">1ll</span>*dp[<span class="number">0</span>][sta[<span class="number">0</span>]][i][a]*dp[<span class="number">1</span>][sta[<span class="number">1</span>]][j][b]%mod;</span><br><span class="line">            <span class="keyword">if</span>(ans&gt;=mod) ans -= mod;</span><br><span class="line">          &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buying a New String ACè‡ªåŠ¨æœº</title>
      <link href="/2020/05/11/buying-a-new-string-ac-zi-dong-ji/"/>
      <url>/2020/05/11/buying-a-new-string-ac-zi-dong-ji/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²A,B,å†ç»™å‡ºnä¸ªå­—ç¬¦ä¸²$s_i$â€‹,æ¯ä¸ª$s_i$â€‹æœ‰ä»·å€¼$b_i$â€‹,è®©ä½ ä»Aä¸­å–ä¸€ä¸ªå­ä¸²(å¯ç©º),å†ä»Bä¸­å–ä¸€ä¸ªå­ä¸²(å¯ç©º),æ‹¼æ¥æˆä¸²C,å®šä¹‰Cçš„ä»·å€¼ä¸º$\sum cnt_iÂ©â‹…b_i$.$cnt_i$â€‹è¡¨ç¤º$s_i$â€‹åœ¨Cä¸­ä½œä¸ºå­ä¸²å‡ºç°çš„æ¬¡æ•°.è¦æ±‚è¾“å‡ºæœ€å¤§çš„ä»·å€¼.<strong>Constraints</strong>$1â‰¤Tâ‰¤10$$1â‰¤|A|,|B|â‰¤10^3$$1â‰¤Nâ‰¤10^4$$1â‰¤|S_i|â‰¤26$ for each valid i$1â‰¤b_iâ‰¤10^5$ for each valid i$A,B,S_1,S_2,â€¦,S_N$â€‹ contain only lowercase English letters$S_1,S_2,â€¦,S_N$â€‹ are pairwise distinctthe sum of |A| over all test cases does not exceed $2â‹…10^3$the sum of |B| over all test cases does not exceed $2â‹…10^3$the sum of N over all test cases does not exceed $2â‹…10^4$</p><h1>åšæ³•</h1><p>ç®€å•çš„è´ªå¿ƒå¯ä»¥å‘ç°,è‚¯å®šæ˜¯å–Açš„æŸä¸ªå‰ç¼€å’ŒBçš„æŸä¸ªåç¼€æ‹¼æ¥.æ­¤é¢˜çš„å…³é”®$|S_i|$å¾ˆå°,å¦‚æœå¤§äº†æˆ‘ä¸çŸ¥é“è¿˜èƒ½ä¸èƒ½åšäº†.åˆ©ç”¨è¿™ç‚¹æˆ‘ä»¬å¯ä»¥å…ˆé¢„å¤„ç†å‡ºAçš„æ¯ä¸ªå‰ç¼€çš„ä»·å€¼å’ŒBçš„æ¯ä¸ªåç¼€çš„ä»·å€¼,è¿™ä¸ªç”¨acè‡ªåŠ¨æœºå¤„ç†,ç„¶åæšä¸¾å‰ç¼€iå’Œåç¼€jæ‹¼æ¥,æ­¤æ—¶Cä¸­æ²¡æœ‰ç®—çš„å½±å“å°±æ˜¯æ‹¼æ¥å¤„å‰å26ä¸ªå­—æ¯çš„ä»·å€¼,å¯ä»¥ä»åç¼€çš„èµ·ç‚¹å¼€å§‹åœ¨acè‡ªåŠ¨æœºä¸Šèµ°25æ­¥,æ¯æ¬¡æš´åŠ›è·³failç»Ÿè®¡ä¸‹ç­”æ¡ˆ,æœ€åå–ä¸ªmax.è¿™æ ·è¿˜æ˜¯ä¼št,å¤æ‚åº¦æ˜¯$O(|A|^2 * 26^2)$å¤§æ¦‚6e9,æ¯æ¬¡è·³failæ˜¯O(26)çš„,é‚£å°±å†å»ºä¸ªfailæ ‘,é¢„å¤„ç†ä¸‹æŠŠè¿™ä¸ªO(26)å»æ‰å°±è¿‡äº†.</p><pre><code><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">char</span> a[N], b[N], rb[N];</span><br><span class="line"><span class="type">char</span> s[N][<span class="number">30</span>], rs[N][<span class="number">30</span>];</span><br><span class="line"><span class="type">int</span> n, val[N];</span><br><span class="line">ll pre[N], suf[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ACA</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> nxt[N][<span class="number">26</span>], fail[N], len[N], cnt, end[N];</span><br><span class="line">  ll tmp[N][<span class="number">30</span>];</span><br><span class="line">  vector &lt;<span class="type">int</span>&gt; to[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      fail[i] = end[i] = len[i] = <span class="number">0</span>;</span><br><span class="line">      to[i].<span class="built_in">clear</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="number">26</span>; j++)</span><br><span class="line">        nxt[i][j] = tmp[i][j+<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span>(!nxt[p][k]) nxt[p][k] = ++cnt;</span><br><span class="line">      p = nxt[p][k];</span><br><span class="line">    &#125;</span><br><span class="line">    end[p] = v; len[p] = n;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++) <span class="keyword">if</span>(nxt[<span class="number">0</span>][i]) q.<span class="built_in">push</span>(nxt[<span class="number">0</span>][i]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span>(nxt[k][i])</span><br><span class="line">        &#123;</span><br><span class="line">          fail[nxt[k][i]] = nxt[fail[k]][i];</span><br><span class="line">          q.<span class="built_in">push</span>(nxt[k][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> nxt[k][i] = nxt[fail[k]][i];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">(<span class="type">char</span> *s, ll *v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      p = nxt[p][s[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=p; j; j=fail[j])</span><br><span class="line">        v[i] += end[j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=len[u]; i&gt;<span class="number">0</span>; i--) tmp[u][i] += end[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : to[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">26</span>; i&gt;<span class="number">0</span>; i--) tmp[v][i] += tmp[u][i];</span><br><span class="line">      <span class="built_in">dfs</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;ac, ac2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s%s&quot;</span>, a, b);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">strlen</span>(a), y = <span class="built_in">strlen</span>(b);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;y; i++) rb[i] = b[y-i<span class="number">-1</span>];</span><br><span class="line">  ac.<span class="built_in">clear</span>(); ac2.<span class="built_in">clear</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%d&quot;</span>, s[i], val+i);</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">strlen</span>(s[i]);</span><br><span class="line">    ac.<span class="built_in">insert</span>(s[i], val[i], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;t; j++) rs[i][j] = s[i][t-j<span class="number">-1</span>];</span><br><span class="line">    ac2.<span class="built_in">insert</span>(rs[i], val[i], t);</span><br><span class="line">  &#125;</span><br><span class="line">  ac.<span class="built_in">build</span>(); ac2.<span class="built_in">build</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;x; i++) pre[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;y; i++) suf[i] = <span class="number">0</span>;</span><br><span class="line">  ac.<span class="built_in">go</span>(a, pre, x); ac2.<span class="built_in">go</span>(rb, suf, y);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;x; i++) pre[i] += pre[i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;y; i++) suf[i] += suf[i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=ac.cnt; i++) ac.to[ac.fail[i]].<span class="built_in">pb</span>(i);</span><br><span class="line">  ac.<span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;x; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    p = ac.nxt[p][a[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;y; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      ll cur = pre[i] + suf[y-j<span class="number">-1</span>];</span><br><span class="line">      <span class="type">int</span> pp = p;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;<span class="number">25</span>&amp;&amp;j+k&lt;y; k++)</span><br><span class="line">      &#123;</span><br><span class="line">        pp = ac.nxt[pp][b[j+k]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        cur += ac.tmp[pp][k+<span class="number">2</span>];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(cur&gt;ans) ans = cur;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Not a real world problem æœ€å°å‰²+æ–¹æ¡ˆ</title>
      <link href="/2020/05/11/not-a-real-problem-zui-xiao-ge-fang-an/"/>
      <url>/2020/05/11/not-a-real-problem-zui-xiao-ge-fang-an/</url>
      
        <content type="html"><![CDATA[<p>æœ‰h*wçš„ç½‘æ ¼,æ¯ä¸ªç‚¹æœ‰æƒå€¼h[i][j], æœ‰nä¸ªç²’å­,å‘Šè¯‰ä½ æ¯ä¸ªç‚¹çš„åæ ‡(x,y),æƒå€¼çš„ç»å¯¹å€¼$\left| p[i]\right|$,å®šä¹‰ä»·å€¼ä¸º$\sum p[i]*h[x[i]][y[i]] + \sum p[i]*p[j]$(å¦‚æœiç‚¹å’Œjç‚¹ç›¸é‚»)é—®å¦‚ä½•åˆ†é…pçš„æ­£è´Ÿå·å¯ä»¥æœ€å¤§åŒ–ä»·å€¼,å¹¶è¾“å‡ºæ–¹æ¡ˆ</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>è¿™ç§åˆ†é…åˆ°ä¸¤ä¸ªé›†åˆ,ç„¶åå®šä¹‰ä¸€ä¸‹ä»·å€¼å¹¶æœ€å¤§åŒ–çš„å¯ä»¥è€ƒè™‘è½¬åŒ–ä¸ºæœ€å°å‰²,sä»£è¡¨+å·,tä»£è¡¨-å·,é‚£ä¹ˆå¯¹äºæ¯ä¸ªç²’å­i:s-&gt;i,æƒå€¼ä¸ºp[i]*h[x[i]][y[i]](è¡¨ç¤ºå¦‚æœå‰²æ‰,åˆ™pä¸ºè´Ÿå·,ä¼š<strong>æŸå¤±</strong>è¿™ä¹ˆå¤š),åŒç†i-&gt;t,æƒå€¼ä¸º-p[i]*h[x[i]][y[i]],æ³¨æ„ä¸èƒ½æœ‰è´Ÿæƒ,æ‰€ä»¥å…¨åŠ ä¸€ä¸ªåç§»é‡offset.å†è€ƒè™‘ç›¸é‚»ç‚¹,å¦‚æœç¬¦å·ç›¸åŒæœ‰ä¸€ç§æ”¶è·x,ç¬¦å·ä¸åŒæœ‰ä¸€ç§æ”¶è·y.å…¶å®åªè¦ä»iå‘jè¿è¾¹x-y,ä»jå‘iä¹Ÿè¿è¾¹x-y.å¯ä»¥é»˜è®¤ä¸¤è€…ç¬¦å·ç›¸åŒæ”¶è·x,é‚£ä¹ˆå¦‚æœå‰²æ‰iä¸jé—´çš„è¾¹,è¯´æ˜ä¸¤è€…åˆ†åˆ«å±äºså’Œt,æŸå¤±x-y.å»ºå®Œå›¾æœ€å¤§æµ,è¾“å‡ºæ–¹æ¡ˆåªè¦ä»æºç‚¹èµ°æƒå€¼&gt;0çš„è¾¹,æ‰€æœ‰ç»è¿‡çš„ç‚¹å°±æ˜¯å±äºsçš„(å³ç¬¦å·ä¸ºæ­£)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, maxn = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> h, w, n, p[maxn], a[maxn][maxn], x[maxn], y[maxn], state[maxn];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>, M = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> cnt, head[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> next, to, w;</span><br><span class="line">&#125;e[M&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  e[++cnt].next = head[u];</span><br><span class="line">  e[cnt].to = v;</span><br><span class="line">  e[cnt].w = w;</span><br><span class="line">  head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m, s, t;</span><br><span class="line">  <span class="type">int</span> dep[N], cur[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> s,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;s = s, <span class="keyword">this</span>-&gt;t = t, <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">    cnt = <span class="number">1</span>, m = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> cap)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(u,v,cap);</span><br><span class="line">    <span class="built_in">add</span>(v,u,<span class="number">0</span>);</span><br><span class="line">    m += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dep,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">memcpy</span>(cur,head,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s); dep[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].to;</span><br><span class="line">        <span class="keyword">if</span>(!dep[v]&amp;&amp;e[i].w&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">          q.<span class="built_in">push</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[t];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> flow)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u==t||!flow) <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="type">int</span> used = flow;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=cur[u];i;i=e[i].next)</span><br><span class="line">    &#123;</span><br><span class="line">      cur[u] = i;</span><br><span class="line">      <span class="type">int</span> v = e[i].to;</span><br><span class="line">      <span class="keyword">if</span>(dep[v]==dep[u]+<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> low = <span class="built_in">dfs</span>(v,<span class="built_in">min</span>(flow,e[i].w));</span><br><span class="line">        e[i].w -= low; e[i^<span class="number">1</span>].w += low;</span><br><span class="line">        flow -= low;</span><br><span class="line">        <span class="keyword">if</span>(!flow) <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> used - flow;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">go</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> maxflow = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>()) maxflow += <span class="built_in">dfs</span>(s,INF);</span><br><span class="line">    <span class="keyword">return</span> maxflow;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = e[i].next)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (e[i].w&gt;<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[e[i].to]) <span class="keyword">continue</span>;</span><br><span class="line">        state[e[i].to] = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(e[i].to);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;MF;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;h, &amp;w, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=h; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=w; j++)</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, x+i, y+i, p+i);</span><br><span class="line">  MF.<span class="built_in">init</span>(n+<span class="number">2</span>, <span class="number">0</span>, n+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> ans = n*<span class="number">100000</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    state[i] = <span class="number">0</span>;</span><br><span class="line">    MF.<span class="built_in">addedge</span>(MF.s, i, p[i]*a[x[i]][y[i]]+<span class="number">100000</span>);</span><br><span class="line">    MF.<span class="built_in">addedge</span>(i, MF.t, -p[i]*a[x[i]][y[i]]+<span class="number">100000</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">abs</span>(x[i]-x[j])+<span class="built_in">abs</span>(y[i]-y[j])&lt;=<span class="number">1</span>)</span><br><span class="line">        MF.<span class="built_in">addedge</span>(i, j, <span class="number">2</span>*p[i]*p[j]), MF.<span class="built_in">addedge</span>(j, i, <span class="number">2</span>*p[i]*p[j]), ans += p[i]*p[j];</span><br><span class="line">  &#125;</span><br><span class="line">  ans -= MF.<span class="built_in">go</span>();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  MF.<span class="built_in">dfs</span>(MF.s);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span>(state[i]) <span class="built_in">printf</span>(<span class="string">&quot;1%c&quot;</span>, <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;-1%c&quot;</span>, <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sorting Vases æ€ç»´</title>
      <link href="/2020/05/11/sorting-vases-si-wei/"/>
      <url>/2020/05/11/sorting-vases-si-wei/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªnçš„æ’åˆ—p,æ¯æ¬¡å¯ä»¥ä»»æ„äº¤æ¢ä¸¤ä¸ªä½ç½®,èŠ±è´¹ä¸º1,ç„¶ååˆç»™å®šmç»„äº¤æ¢,èŠ±è´¹ä¸º0(å¯ä»¥ä»»æ„æ¬¡ä½¿ç”¨),é—®ä½¿è¯¥æ’åˆ—pæœ‰åºçš„æœ€å°èŠ±è´¹.(n&lt;=18, m&lt;=18)</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å…ˆè€ƒè™‘m=0,æ­¤æ—¶åªè¦è®©æ¯ä¸ªæ•°ç›´æ¥å‘ç›®æ ‡ä½ç½®äº¤æ¢å³å¯,ç­”æ¡ˆä¸ºn-ç¯çš„ä¸ªæ•°å†è€ƒè™‘m,æ—¢ç„¶å¯ä»¥ä»»æ„äº¤æ¢,é‚£å°±ç›¸å½“äºè¿™äº›ä½ç½®æ˜¯ç­‰ä»·çš„,å¯ä»¥ç»´æŠ¤å‡ºæ¯ä¸ªç­‰ä»·çš„é›†åˆ,ç„¶åç›´æ¥å…¨æ’åˆ—æšä¸¾æ¯ä¸ªé›†åˆ,è®©pé€šè¿‡m=0çš„æ–¹å¼è½¬æ¢æˆè¯¥æ’åˆ—,æœ€åå–æœ€å°å€¼.è¿™æ ·äº¤çš„è¯å…¶å®åªä¼štleä¸€ä¸ªç‚¹.å¦‚æœæŸä¸ªé›†åˆçš„å¤§å°&gt;10,å…¨æ’åˆ—æšä¸¾æ˜¾ç„¶t.ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦æšä¸¾æ¯ä¸ªé›†åˆçš„æ’åˆ—,å› ä¸ºå‰å‡ ä¸ªæ•°å½’ä½å,æœ€åä¸€ä¸ªé›†åˆçš„æ•°è‡ªç„¶å°±å½’ä½äº†.æ‰€ä»¥æˆ‘ä»¬ä¸æšä¸¾æœ€å¤§çš„é›†åˆå°±å¯ä»¥äº†,è¿™æ ·æˆ‘ä»¬æšä¸¾çš„é›†åˆçš„å¤§å°æœ€å¤šåªæœ‰9,9!(362880)å®Œå…¨å¯ä»¥æ¥å—.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, p[N], pos[N], x[N], y[N];</span><br><span class="line"><span class="type">int</span> tmpp[N];</span><br><span class="line"><span class="type">int</span> f[N], ans;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; vec;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; rt[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==f[x]) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">return</span> f[x] = <span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  x = <span class="built_in">find</span>(x), y = <span class="built_in">find</span>(y);</span><br><span class="line">  <span class="keyword">if</span>(x==y) <span class="keyword">return</span>;</span><br><span class="line">  f[x] = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    tmpp[i] = p[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = i;</span><br><span class="line">    <span class="keyword">while</span>(pos[tmpp[j]]&amp;&amp;pos[tmpp[j]]!=j)</span><br><span class="line">    &#123;</span><br><span class="line">      cnt++;</span><br><span class="line">      <span class="built_in">swap</span>(tmpp[j], tmpp[pos[tmpp[j]]]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==<span class="built_in">sz</span>(vec))</span><br><span class="line">  &#123;</span><br><span class="line">    ans = <span class="built_in">min</span>(ans, <span class="built_in">cal</span>());</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">idx</span><span class="params">(sz(vec[x]))</span></span>;</span><br><span class="line">  <span class="built_in">iota</span>(<span class="built_in">all</span>(idx), <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sz</span>(vec[x]); i++)</span><br><span class="line">      pos[vec[x][i]] = vec[x][idx[i]];</span><br><span class="line">    <span class="built_in">dfs</span>(x+<span class="number">1</span>);</span><br><span class="line">  &#125;<span class="keyword">while</span>(<span class="built_in">next_permutation</span>(<span class="built_in">all</span>(idx)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  ans = n - <span class="number">1</span>;</span><br><span class="line">  vec.<span class="built_in">clear</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, p+i);</span><br><span class="line">    f[i] = i;</span><br><span class="line">    pos[i] = <span class="number">0</span>;</span><br><span class="line">    rt[i].<span class="built_in">clear</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, x+i, y+i);</span><br><span class="line">    <span class="built_in">merge</span>(x[i], y[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mx = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> r = <span class="built_in">find</span>(i);</span><br><span class="line">    rt[r].<span class="built_in">pb</span>(i);</span><br><span class="line">    mx = <span class="built_in">max</span>(mx, <span class="built_in">sz</span>(rt[r]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">bool</span> tag = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span>(f[i]==i &amp;&amp; <span class="built_in">sz</span>(rt[i])&lt;mx) vec.<span class="built_in">pb</span>(rt[i]);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(f[i]==i &amp;&amp; <span class="built_in">sz</span>(rt[i])==mx)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!tag) tag = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span> vec.<span class="built_in">pb</span>(rt[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Triple Sort æ€ç»´+æ„é€ </title>
      <link href="/2020/05/11/triple-sort-si-wei-gou-zao/"/>
      <url>/2020/05/11/triple-sort-si-wei-gou-zao/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ’åˆ—p,å®šä¹‰ä¸€ç§æ“ä½œæ–¹å¼æ˜¯,é€‰æ‹©ä¸‰ä¸ªä¸‹æ ‡a,b,c,ç„¶åè®©p[c]=p[b],p[b]=p[a],p[a]=p[c](å¾ªç¯å³ç§»ä¸€ä½),ä¸‹æ ‡a,b,cçš„å¤§å°å…³ç³»ä»»æ„,ä½†å¿…é¡»ä¸¤ä¸¤ä¸åŒ.è¦æ±‚ç”¨kæ¬¡æ“ä½œè®©pæœ‰åº,è¾“å‡ºä¸€ç§åˆæ³•è§£(ä¸è¦æ±‚æœ€å°åŒ–),æ— è§£è¾“å‡º-1$n&lt;=2e5, k&lt;=\lfloor \frac{n}{2} \rfloor$</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å…ˆè€ƒè™‘ä¸€ä¸‹n=3çš„æ—¶å€™,å¯ä»¥å‘ç°è¯¥æ“ä½œä¼šå½¢æˆä¸¤ä¸ªç­‰ä»·ç±»,{(1, 2, 3), (3, 1, 2), (2, 3, 1)}ã€ {(3, 2, 1), (1, 3, 2), (2, 1, 3)},å› æ­¤ç¬¬äºŒä¸ªé›†åˆä¸­çš„æ’åˆ—å°±ä¸å¯èƒ½æ’æˆæœ‰åº. <s>ç„¶è€Œè¿™å¥½åƒæ²¡ä»€ä¹ˆç”¨</s>.ä»kçš„å¤§å°å…¥æ‰‹,k&lt;=n/2,è¯´æ˜æ¯æ¬¡æ“ä½œè‡³å°‘è¦è®©ä¸¤ä¸ªå…ƒç´ å½’ä½,æ¯æ¬¡åªè¦æ“ä½œ(i, p[i], p[p[i]])å³å¯,ä½†æ˜¯æœ‰å¯èƒ½i==p[p[i]],å³ä¸ºä¸€ä¸ªäºŒå…ƒç¯.ä¸‹é¢è€ƒè™‘{2, 1, 4, 3}è¿™ä¸ªæ’åˆ—,å®ƒç”±ä¸¤ä¸ªäºŒå…ƒç¯ç»„æˆ,å¯ä»¥å‘ç°åªè¦æ“ä½œ(2,3,4),(1,2,3)å³å¯,å°±æ˜¯è¯´ä¸¤ä¸ªäºŒå…ƒç¯å¯ä»¥é€šè¿‡ä¸¤æ¬¡æ“ä½œæ’æˆæœ‰åº.æ‰€ä»¥æˆ‘ä»¬åªè¦å…ˆå¯¹é•¿åº¦å¤§äº2çš„ç¯è¿›è¡Œæ“ä½œ,ç„¶åæŠŠäºŒå…ƒç¯å­˜èµ·æ¥.æœ€åå¦‚æœäºŒå…ƒç¯æœ‰å¶æ•°ä¸ª,ä¸¤ä¸¤è§£å†³,å¦åˆ™æ— è§£.å¦‚æœäºŒå…ƒç¯æœ‰å¥‡æ•°ä¸ª,åˆ™é€†åºå¯¹æ•°æœ‰å¥‡æ•°ä¸ª,è€Œå¯ä»¥å‘ç°è¯¥æ“ä½œæ¯æ¬¡åªèƒ½å˜åŒ–å¶æ•°ä¸ªé€†åºå¯¹,å…¶å®å°±å¯¹åº”äº†ä¸Šé¢çš„ä¸¤ä¸ªç­‰ä»·ç±».</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, k, a[N], p[N], b[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">assert</span>(x!=y); <span class="built_in">assert</span>(y!=z); <span class="built_in">assert</span>(x!=z);</span><br><span class="line">  <span class="type">int</span> tmp = a[z];</span><br><span class="line">  a[z] = a[y];</span><br><span class="line">  p[a[y]] = z;</span><br><span class="line">  a[y] = a[x];</span><br><span class="line">  p[a[x]] = y;</span><br><span class="line">  a[x] = tmp;</span><br><span class="line">  p[tmp] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    p[a[i]] = i;</span><br><span class="line">  &#125;</span><br><span class="line">  vector &lt;array&lt;<span class="type">int</span>,3&gt;&gt; op;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    vis[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(i!=p[i])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x = p[i], y = i, z = a[i];</span><br><span class="line">      <span class="keyword">if</span>(z==x) <span class="keyword">continue</span>;</span><br><span class="line">      op.<span class="built_in">pb</span>(&#123;y, z, x&#125;);</span><br><span class="line">      <span class="built_in">upd</span>(y, z, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  vector &lt;pii&gt; loop;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(i!=p[i] &amp;&amp; p[i]==a[i] &amp;&amp; !vis[p[i]])</span><br><span class="line">    &#123;</span><br><span class="line">      loop.<span class="built_in">pb</span>(&#123;i, p[i]&#125;);</span><br><span class="line">      vis[i] = vis[p[i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">sz</span>(loop)&amp;<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sz</span>(loop); i+=<span class="number">2</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a = loop[i].fi, b = loop[i].se, c = loop[i+<span class="number">1</span>].fi, d = loop[i+<span class="number">1</span>].se;</span><br><span class="line">    op.<span class="built_in">pb</span>(&#123;b, c, d&#125;);</span><br><span class="line">    <span class="built_in">upd</span>(b, c, d);</span><br><span class="line">    op.<span class="built_in">pb</span>(&#123;a, b, c&#125;);</span><br><span class="line">    <span class="built_in">upd</span>(a, b, c);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">sz</span>(op)&gt;k || !<span class="built_in">is_sorted</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>)) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">sz</span>(op) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : op) <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d\n&quot;</span>, it[<span class="number">0</span>], it[<span class="number">1</span>], it[<span class="number">2</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢ç®—æ³•å‘¨å‘¨ç»ƒ5</title>
      <link href="/2020/05/06/niu-ke-suan-fa-zhou-zhou-lian-5/"/>
      <url>/2020/05/06/niu-ke-suan-fa-zhou-zhou-lian-5/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ä¸é”™,æ‰€ä»¥åšäº†ä¸‹.</p><h1>A å¤šå½©çš„æ ‘</h1><p>ç»™å®šä¸€æ£µæ ‘,æ¯ä¸ªç‚¹æœ‰ä¸€ç§é¢œè‰²,é—®æ°å¥½åŒ…å«iç§é¢œè‰²çš„è·¯å¾„çš„æ•°é‡(iä»1-k) $k&lt;=10$çœ‹è§è·¯å¾„ä¿¡æ¯ç»Ÿè®¡,æƒ³åˆ°ç‚¹åˆ†æ²»,kå¾ˆå°,çŠ¶å‹å³å¯.æˆ‘ä»¬ç”¨<code>num[1&lt;&lt;10]</code>çš„æ¡¶è®°å½•è¿™ç§çŠ¶æ€çš„è·¯å¾„çš„æ•°é‡ç„¶åè€ƒè™‘æ€ä¹ˆåˆå¹¶ä¸¤æ¡è·¯å¾„:<code>num[i|j] = cnt[i] * cnt[j]</code>æœ´ç´ æš´åŠ›æ˜¯$O(n*4^k)$çš„,5ç§’åº”è¯¥è¿‡ä¸äº†å¾ˆå®¹æ˜“å‘ç°è¿™æ˜¯ä¸ªæˆ–è¿ç®—å·ç§¯,FWTä¼˜åŒ–ä¸€ä¸‹å³å¯.ä½†æ˜¯è¦æ³¨æ„å½“i==jçš„æ—¶å€™<code>num[i|j] = cnt[i] * (cnt[i]-1)/2 + cnt[i]</code>(é€‰ä¸¤ä¸ªåˆå¹¶,ä»¥åŠå’Œç©ºè·¯å¾„åˆå¹¶(å‡ä¸åˆæ³•è·¯å¾„æ—¶ä¸åŒ…å«)),ç„¶åæ³¨æ„åˆ°FWTä¸­ç®—çš„æ˜¯<code>cnt[i] * cnt[i] + 2*cnt[i]</code>,æ‰€ä»¥è¿˜è¦å‡æ‰ä¸€ä¸ªcnt[i].ç”±äºæ˜¯ç‚¹æƒæ‰€ä»¥è¦æ³¨æ„äº›ç»†èŠ‚é—®é¢˜,ç‰¹åˆ«æ˜¯å‡æ‰ä¸åˆæ³•è·¯å¾„çš„æ—¶å€™,ç„¶åè¿™é¢˜å°±åšå®Œäº†å…¶å®å¯ä»¥ç›´æ¥çŠ¶å‹åŒ…å«çš„é¢œè‰²æ•°,ç„¶åæ‰¾åˆ°åªåŒ…å«è¿™æ ·é¢œè‰²çš„è¿é€šå—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, two = (mod+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> n, k, a[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line">ll pw[<span class="number">15</span>];</span><br><span class="line"><span class="type">int</span> rt, sz[N], dp[N], mxsz;</span><br><span class="line">ll mask[<span class="number">1</span>&lt;&lt;<span class="number">10</span>], num[<span class="number">1</span>&lt;&lt;<span class="number">10</span>], tmp[<span class="number">1</span>&lt;&lt;<span class="number">10</span>];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FWT</span><span class="params">(ll *a, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> d=<span class="number">1</span>;d&lt;n;d&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> m=d&lt;&lt;<span class="number">1</span>,i=<span class="number">0</span>;i&lt;n;i+=m)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;d;j++)</span><br><span class="line">      &#123;</span><br><span class="line">        ll x = a[i+j], y = a[i+j+d];</span><br><span class="line">        a[i+j+d] = (x+y)%mod;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IFWT</span><span class="params">(ll *a, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> d=<span class="number">1</span>;d&lt;n;d&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> m=d&lt;&lt;<span class="number">1</span>,i=<span class="number">0</span>;i&lt;n;i+=m)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;d;j++)</span><br><span class="line">      &#123;</span><br><span class="line">        ll x = a[i+j], y = a[i+j+d];</span><br><span class="line">        a[i+j+d] = (y-x+mod)%mod;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dp[u] = <span class="number">0</span>, sz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[v]||v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">findroot</span>(v, u);</span><br><span class="line">    dp[u] = <span class="built_in">max</span>(dp[u],sz[v]);</span><br><span class="line">    sz[u] += sz[v];</span><br><span class="line">  &#125;</span><br><span class="line">  dp[u] = <span class="built_in">max</span>(dp[u],mxsz-sz[u]);</span><br><span class="line">  <span class="keyword">if</span>(dp[u]&lt;dp[rt]) rt = u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getdis</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  d |= (<span class="number">1</span>&lt;&lt;a[u]);</span><br><span class="line">  mask[d]++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[v]||v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">getdis</span>(v, u, d);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calcu</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(mask, <span class="number">0</span>, <span class="built_in">sizeof</span>(mask));</span><br><span class="line">  <span class="keyword">if</span>(!d) mask[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">getdis</span>(u, <span class="number">0</span>, d);</span><br><span class="line">  <span class="comment">// for(int i=0; i&lt;(1&lt;&lt;k); i++)</span></span><br><span class="line">  <span class="comment">// for(int j=0; j&lt;(1&lt;&lt;k); j++)</span></span><br><span class="line">  <span class="comment">// if(!d) (num[i|j] += mask[i]*mask[j]%mod)%=mod;</span></span><br><span class="line">  <span class="comment">// else (num[i|j] -= mask[i]*mask[j]%mod)%=mod;</span></span><br><span class="line">  <span class="comment">// for(int i=0; i&lt;(1&lt;&lt;k); i++)</span></span><br><span class="line">  <span class="comment">// num[i] -= mask[i]%=mod;</span></span><br><span class="line">  <span class="built_in">memcpy</span>(tmp, mask, <span class="built_in">sizeof</span>(mask));</span><br><span class="line">  <span class="built_in">FWT</span>(tmp, <span class="number">1</span>&lt;&lt;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;(<span class="number">1</span>&lt;&lt;k); i++) tmp[i] = tmp[i]*tmp[i]%mod;</span><br><span class="line">  <span class="built_in">IFWT</span>(tmp, <span class="number">1</span>&lt;&lt;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;(<span class="number">1</span>&lt;&lt;k); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!d) (num[i] += tmp[i] - mask[i]) %= mod;</span><br><span class="line">    <span class="keyword">else</span> (num[i] -= tmp[i] + mask[i]) %= mod;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  vis[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">calcu</span>(u, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">calcu</span>(v, <span class="number">1</span>&lt;&lt;a[u]);</span><br><span class="line">    mxsz = sz[v], rt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">findroot</span>(v, u);</span><br><span class="line">    <span class="built_in">solve</span>(rt);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++) pw[i] = pw[i<span class="number">-1</span>]*<span class="number">131</span>%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    a[i]--;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(v); G[v].<span class="built_in">pb</span>(u);</span><br><span class="line">  &#125;</span><br><span class="line">  dp[<span class="number">0</span>] = mxsz = n;</span><br><span class="line">  <span class="built_in">findroot</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">solve</span>(rt);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;(<span class="number">1</span>&lt;&lt;k); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = __builtin_popcount(i);</span><br><span class="line">    (ans += pw[j]*num[i]%mod) %= mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(ans&lt;<span class="number">0</span>) ans += mod;</span><br><span class="line">  ans = ans*two%mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>B æ±‚å¹‚</h1><p>ç»™å®šn(n&lt;=1e6),é—®æ»¡è¶³a^b = c^dçš„å››å…ƒæœ‰åºç»„ä¸ªæ•°,å…¶ä¸­a,b,c,dåœ¨1-nä¹‹é—´æœ‰ä¸€ä¸ªç»“è®ºæ˜¯å„ä¸ªéå®Œå…¨å¹³æ–¹æ•°çš„æ‰€æœ‰å¹‚æ¬¡ç»„æˆçš„é›†åˆæ˜¯æ²¡æœ‰äº¤é›†çš„,è€ƒè™‘æŒ‰æ­¤åˆ’åˆ†,æ˜¾ç„¶ä¸åŒé›†åˆé—´æ²¡æœ‰è´¡çŒ®.è€ƒè™‘ä¸€ä¸ªé›†åˆä¸­çš„ä¸¤ä¸ªå…ƒç´ a^bå’Œa^c,ä»¤d=max(b,c)/__gcd(b,c),åˆ™æœ‰n/dç»„å…ƒç´ (ab,xâˆ—d,ac,y),1&lt;=x&lt;=n/d.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  ll ans = <span class="number">1ll</span>*n*n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[i]) <span class="keyword">continue</span>;</span><br><span class="line">    vector&lt;pii&gt; tmp;</span><br><span class="line">    <span class="keyword">for</span>(ll j=i, k=<span class="number">1</span>; j&lt;=n; j*=i, k++)</span><br><span class="line">    &#123;</span><br><span class="line">      vis[j] = <span class="number">1</span>;</span><br><span class="line">      tmp.<span class="built_in">pb</span>(&#123;j, k&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    ll cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sz</span>(tmp); i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="built_in">sz</span>(tmp); j++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> x = tmp[i].se/__gcd(tmp[i].se, tmp[j].se), y = tmp[j].se/__gcd(tmp[i].se, tmp[j].se);</span><br><span class="line">        cur += n/<span class="built_in">max</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span>(cur&gt;=mod) cur -= mod;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (ans + cur)%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(ans&lt;<span class="number">0</span>) ans += mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>C åºåˆ—æœ€å°åŒ–</h1><p>ç»™å®šä¸€ä¸ª1-nçš„æ’åˆ—,æ¯æ¬¡å¯ä»¥é€‰æ‹©kä¸ªè¿ç»­çš„æ•°å°†å…¶å˜æˆæœ€å°çš„é‚£ä¸ªæ•°,é—®æœ€å°‘ç»è¿‡å‡ æ¬¡æ“ä½œä½¿åºåˆ—æœ€å°.æœ€åè‚¯å®šéƒ½å˜æˆäº†1,ç¬¬ä¸€æ¬¡æ“ä½œè‚¯å®šåŒ…å«äº†1è¿™ä¸ªä½ç½®,æ‰€ä»¥æšä¸¾ç¬¬ä¸€æ¬¡æ“ä½œçš„å·¦å³ç«¯ç‚¹,åˆ™åé¢çš„æ“ä½œä¸€å®šæ˜¯å·¦å³å»¶ä¼¸.</p><h1>D å°é›¨ååœ°é“</h1><p>mæ¡åœ°é“çº¿è·¯,nä¸ªè½¦ç«™,ç¬¬iæ¡åœ°é“çº¿è·¯èŠ±è´¹a[i],ç»è¿‡c[i]ä¸ªè½¦ç«™,æ¯ç«™èŠ±è´¹b[i]å…ƒ,é—®ä»sç«™åˆ°tç«™çš„æœ€å°èŠ±è´¹.å¦‚æœæœ‰å¤šæ¡åœ°é“ç»è¿‡åŒä¸€ä¸ªè½¦ç«™,å¯ä»¥æ¢ä¹˜.å¯¹äºæŸä¸ªè½¦ç«™,å¦‚æœå­˜åœ¨äºå¤šä¸ªåœ°é“çº¿è·¯ä¸­,å…¶å®æ˜¯ä¸åŒçš„çŠ¶æ€,æ‰€ä»¥å¯¹äºæ¯ä¸ªåœ°é“çº¿è·¯ä¸­çš„è½¦ç«™æˆ‘ä»¬éƒ½ç”¨ä¸€ä¸ªæ–°ç‚¹æ¥è¡¨ç¤º.è¿™æ ·å°±å¯ä»¥è¿›è¡Œå»ºå›¾è·‘æœ€çŸ­è·¯äº†.å¯¹äºæŸæ¡çº¿è·¯ä¸­çš„è½¦ç«™,ä¾æ¬¡è¿<strong>åŒå‘è¾¹</strong>,æƒå€¼ä¸ºb[i] (è¡¨ç¤ºç»§ç»­ä¹˜å) ,å†å‘ç»è¿‡è¯¥è½¦ç«™çš„å…¶ä»–çº¿è·¯ä¸­çš„è¯¥è½¦ç«™æ‰€ä»£è¡¨çš„ç‚¹è¿<strong>å•å‘è¾¹</strong>,æƒå€¼ä¸ºa[i] (è¡¨ç¤ºæ¢ä¹˜).ç”±äºså’Œtä»£è¡¨çš„ç‚¹æœ‰å¤šä¸ª,æ‰€ä»¥åŠ ä¸Šè¶…æºå’Œè¶…æ±‡.è¶…æºå‘æ¯ä¸ªåœ°é“çº¿è·¯ä¸­çš„sè¿<strong>å•å‘è¾¹</strong>,æƒå€¼ä¸ºa[i], æ¯ä¸ªåœ°é“çº¿è·¯ä¸­çš„tå‘è¶…æ±‡è¿<strong>å•å‘è¾¹</strong>,æƒå€¼ä¸º0.æ³¨æ„s=tçš„æ—¶å€™,éœ€è¦ç‰¹åˆ¤,å› ä¸ºä»¥ä¸Šå»ºå›¾æ–¹æ³•,å¦‚æœæ²¡æœ‰åœ°é“çº¿è·¯é€šè¿‡s,åˆ™è¶…æºå’Œsä¸è¿é€š,å¦‚æœä»è¶…æºè·‘dij,ä¼šè¾“å‡º-1.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e3</span> + <span class="number">5</span>, M = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, s, t, a[N], b[N], c[N], idx[<span class="number">505</span>][N], tot;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p[N], q[N];</span><br><span class="line">vector&lt;pii&gt; G[M];</span><br><span class="line">ll dis[M];</span><br><span class="line"><span class="type">bool</span> vis[M];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,(tot+<span class="number">1</span>)*<span class="built_in">sizeof</span>(ll));</span><br><span class="line">  <span class="built_in">memset</span>(vis,<span class="number">0</span>,(tot+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">  dis[s] = <span class="number">0</span>;</span><br><span class="line">  priority_queue &lt;pli,vector&lt;pli&gt;,greater&lt;pli&gt;&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>,s));</span><br><span class="line">  <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">top</span>().se; q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">      <span class="keyword">if</span>(dis[v]&gt;dis[u]+w)</span><br><span class="line">      &#123;</span><br><span class="line">        dis[v] = dis[u] + w;</span><br><span class="line">        q.<span class="built_in">push</span>(<span class="built_in">mp</span>(dis[v],v));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;s, &amp;t);</span><br><span class="line">  <span class="keyword">if</span>(s==t)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  tot = m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, a+i, b+i, c+i);</span><br><span class="line">    q[i].<span class="built_in">resize</span>(c[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> &amp;x : q[i])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">      p[x].<span class="built_in">pb</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> pre = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x : q[i])</span><br><span class="line">    &#123;</span><br><span class="line">      ++tot;</span><br><span class="line">      idx[i][x] = tot;</span><br><span class="line">      G[pre].<span class="built_in">emplace_back</span>(tot, b[i]);</span><br><span class="line">      G[tot].<span class="built_in">emplace_back</span>(pre, b[i]);</span><br><span class="line">      pre = tot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ++tot;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x : q[i])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(x==t) G[idx[i][x]].<span class="built_in">emplace_back</span>(tot, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span>(x==s) G[<span class="number">0</span>].<span class="built_in">emplace_back</span>(idx[i][x], a[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k : p[x])</span><br><span class="line">        G[idx[i][x]].<span class="built_in">emplace_back</span>(idx[k][x], a[k]);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="built_in">Dijkstra</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span>(dis[tot]==LINF) dis[tot] = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, dis[tot]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>E ç®€å•çæé¢˜</h1><p>æœ‰100ä¸ªæ•°,æ¯ä¸ªæ•°$x_i$â€‹æœ‰$l_i\sim r_i$â€‹çš„èŒƒå›´(&lt;=100),é—®$\sum x_i^2$â€‹çš„ç§ç±»æ•°ä¸€çœ¼bitsetçš„ä¼˜åŒ–,ä½†ä»”ç»†ç®—äº†ä¸‹1e6*100*100/32,ä¼¼ä¹ä¸å¤ªè¡Œ,æƒ³äº†ä¸€ä¼šåˆ«çš„æ–¹æ³•æ²¡æƒ³å‡º,çœ‹äº†çœ¼åˆ«äººçš„ä»£ç ,ç„¶åå‘ç°å°±æ˜¯bitsetğŸ˜,<s>åªèƒ½è¯´æ˜ç‰›å®¢æœºå­ç‰›é€¼</s></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">bitset &lt;N&gt; f;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//100 * 100 * 1e6 / 32</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    bitset &lt;N&gt; nextf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=l; j&lt;=r; j++) nextf |= f&lt;&lt;(j*j);</span><br><span class="line">    f = nextf;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, f.<span class="built_in">count</span>());</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hdu5876 è¾¹æƒä¸º1çš„æ— å‘å›¾çš„è¡¥å›¾æœ€çŸ­è·¯</title>
      <link href="/2020/05/03/hdu5876-bian-quan-wei-1-de-wu-xiang-tu-de-bu-tu-zui-duan-lu/"/>
      <url>/2020/05/03/hdu5876-bian-quan-wei-1-de-wu-xiang-tu-de-bu-tu-zui-duan-lu/</url>
      
        <content type="html"><![CDATA[<h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å› ä¸ºè¾¹æƒæ˜¯1,æ‰€ä»¥è€ƒè™‘bfs.ç”¨set s1å­˜å‚¨å½“å‰è¿˜æœªè®¿é—®è¿‡çš„ç‚¹,å¯¹äºé˜Ÿé¦–u,æšä¸¾å…¶å‡ºç‚¹v,è‹¥våœ¨s1ä¸­,åˆ™å°†å…¶ä»s1 erase,å¹¶insertå…¥s2,åˆ™æ­¤æ—¶åœ¨s1ä¸­çš„æ‰€æœ‰ç‚¹éƒ½å’Œuåœ¨è¡¥å›¾ä¸­ç›´æ¥ç›¸è¿,æ‰€ä»¥å°†å®ƒä»¬å…¥é˜Ÿå³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, s, dis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) G[i].<span class="built_in">clear</span>(); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) dis[i] = <span class="number">-1</span>;</span><br><span class="line">  dis[s] = <span class="number">0</span>;</span><br><span class="line">  set &lt;<span class="type">int</span>&gt; s1, s2;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span>(i!=s) s1.<span class="built_in">insert</span>(i);</span><br><span class="line">  queue &lt;<span class="type">int</span>&gt; q; q.<span class="built_in">push</span>(s);</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">sz</span>(q))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">auto</span> it = s1.<span class="built_in">find</span>(v);</span><br><span class="line">      <span class="keyword">if</span>(it!=s1.<span class="built_in">end</span>())</span><br><span class="line">      &#123;</span><br><span class="line">        s2.<span class="built_in">insert</span>(v);</span><br><span class="line">        s1.<span class="built_in">erase</span>(it);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : s1) dis[it] = dis[u] + <span class="number">1</span>, q.<span class="built_in">push</span>(it);</span><br><span class="line">    <span class="built_in">swap</span>(s1, s2); s2.<span class="built_in">clear</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(v); G[v].<span class="built_in">pb</span>(u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;s);</span><br><span class="line">  <span class="built_in">bfs</span>(s);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span>(i!=s)</span><br><span class="line">    &#123;</span><br><span class="line">      j++;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, dis[i], <span class="string">&quot; \n&quot;</span>[j==n<span class="number">-1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codeforces1348 E dp</title>
      <link href="/2020/05/02/codeforces1348-e-dp/"/>
      <url>/2020/05/02/codeforces1348-e-dp/</url>
      
        <content type="html"><![CDATA[<p>æœ‰nç»„ç‰©å“,æ¯ç»„ç‰©å“æœ‰ä¸¤ç§,ä¸€ç§aä¸ª,ä¸€ç§bä¸ª.å®šä¹‰åˆæˆæ–¹å¼ä¸º<strong>åŒç§</strong>kä¸ª,æˆ–è€…<strong>åŒç»„</strong>kä¸ª.é—®æœ€å¤šåˆæˆå¤šå°‘æ¬¡</p><h1>åšæ³•</h1><p>å¯¹äºæ¯ä¸€ç»„,æœ€å¤šåªæœ‰s(s&lt;k)ä¸ªç¬¬ä¸€ç§ä¸k-sä¸ªç¬¬äºŒç§è¿›è¡ŒåŒç»„ç»„åˆ,å…¶ä½™éƒ½ç”¨åœ¨åŒç§çš„åˆæˆæ–¹å¼ä¸Š.è€ƒè™‘ dp[i][j]: å‰iç»„ç‰©å“ç¬¬ä¸€ç§æœ‰jä¸ªå¤šä½™çš„æƒ…å†µä¸‹,æœ€å¤šåˆæˆçš„æ¬¡æ•°.å¯¹äºè¯¥çŠ¶æ€,ç›¸åº”çš„ç¬¬äºŒç§å°±æœ‰$\sum_i(a_i+b_i) - k*dp_{ij} - j = B$è€ƒè™‘è½¬ç§»: æšä¸¾dp[i-1][j], å†æšä¸¾å½“å‰ç»„çš„åŒç»„ç»„åˆçŠ¶æ€sä¸ªç¬¬ä¸€ç§,k-sä¸ªç¬¬äºŒç§, åˆ™:max{$dp[i][(j+a_i-s)$%$k]$, $dp[iâˆ’1][j] + (j+a_i-s)/k + (B+b_i-(k-s))/k$}</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">505</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">12</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line">ll dp[N][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">cmax</span><span class="params">(ll &amp;x, ll y)</span> </span>&#123; <span class="keyword">if</span>(x&lt;y) x = y; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  ll pre = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;k; j++)</span><br><span class="line">      dp[i][j] = <span class="number">-1</span>;</span><br><span class="line">  dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;k; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(dp[i<span class="number">-1</span>][j]==<span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="built_in">cmax</span>(dp[i][(j+a)%k], dp[i<span class="number">-1</span>][j] + (j+a)/k + (pre-dp[i<span class="number">-1</span>][j]*k-j+b)/k);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> s=<span class="number">0</span>; s&lt;=k; s++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span>(s&gt;a || k-s&gt;b) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">cmax</span>(dp[i][(j+a-s)%k], dp[i<span class="number">-1</span>][j] + (j+a-s)/k + (pre-dp[i<span class="number">-1</span>][j]*k-j+b-(k-s))/k + <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    pre += a + b;</span><br><span class="line">  &#125;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++) <span class="built_in">cmax</span>(ans, dp[n][i]);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JOI2019 Final ç‹¬ç‰¹çš„åŸå¸‚ æ€ç»´+é•¿å‰–</title>
      <link href="/2020/04/30/joi2019-final-du-te-de-cheng-shi-si-wei-chang-pou/"/>
      <url>/2020/04/30/joi2019-final-du-te-de-cheng-shi-si-wei-chang-pou/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€æ£µæ ‘,å®šä¹‰åŸå¸‚yä¸ºxçš„ç‹¬ç‰¹åŸå¸‚,å½“ä¸”ä»…å½“å¯¹äºä»»æ„çš„z,$dis(x, y) \neq dis(x, z)$,æ¯ä¸ªç‚¹æœ‰ä¸ªå€¼,é—®å¯¹äºæ¯ä¸ªåŸå¸‚çš„æ‰€æœ‰ç‹¬ç‰¹åŸå¸‚çš„å€¼çš„ç§ç±»æ•°.</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>xçš„æ‰€æœ‰ç‹¬ç‰¹çš„åŸå¸‚ä¸€å®šä½äºè·ç¦»xæœ€è¿œçš„ç‚¹åˆ°xçš„é“¾ä¸Š(ç›´å¾„çš„æŸä¸ªç«¯ç‚¹).æ‰€ä»¥è€ƒè™‘ä»¥ç›´å¾„çš„ä¸¤ä¸ªç«¯ç‚¹å„æ±‚è§£ä¸€æ¬¡(å–max)åœ¨dfsçš„è¿‡ç¨‹ä¸­ç”¨æ ˆå­˜å‚¨å¯¹äºå½“å‰ç‚¹uåˆæ³•çš„ç­”æ¡ˆ.åœ¨uç‚¹æ—¶,æ ˆä¸­æ‰€æœ‰ä¸uè·ç¦»&lt;=uçš„<strong>æ¬¡é•¿é“¾</strong>çš„ç­”æ¡ˆéƒ½ä¸åˆæ³•,ç›´æ¥å¼¹å‡º,å†å°†uå…¥æ ˆ,åˆ©ç”¨é•¿é“¾å‰–åˆ†,å…ˆè§£å†³é‡å„¿å­.é•¿é“¾è§£å†³å,æ ˆä¸­æ‰€æœ‰ä¸uè·ç¦»&lt;=è¯¥é•¿é“¾çš„ç‚¹å¼¹å‡º.ç„¶åä¾æ¬¡è§£å†³uçš„å„ä¸ªè½»å„¿å­å³å¯(æ³¨æ„å¦‚æœuä¸åœ¨æ ˆä¸­,è¦åŠ å…¥u).uå­æ ‘è§£å†³å,å¦‚æœuåœ¨æ ˆä¸­,å¼¹å‡º.æ¯æ¬¡å…¥æ ˆå’Œå‡ºæ ˆç”¨ä¸€ä¸ªæ¡¶æ¥ç»Ÿè®¡ç­”æ¡ˆå³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, c[N], cnt[N], cur;</span><br><span class="line"><span class="type">int</span> s, t, mxlen, son[N], son2[N], len[N], dep[N];</span><br><span class="line"><span class="type">int</span> sta[N], top, ans[N];</span><br><span class="line"><span class="type">int</span> head[N], tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> to, next;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  e[++tot].next = head[u];</span><br><span class="line">  e[tot].to = v;</span><br><span class="line">  head[u] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> dis)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dis&gt;mxlen)</span><br><span class="line">  &#123;</span><br><span class="line">    mxlen = dis;</span><br><span class="line">    t = u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = e[i].to;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u, dis+<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">find</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  s = t;</span><br><span class="line">  mxlen = t = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(s, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dep[u] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">  son[u] = son2[u] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = e[i].to;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">    <span class="keyword">if</span>(len[v]&gt;len[son[u]]) son2[u] = son[u], son[u] = v;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(len[v]&gt;len[son2[u]]) son2[u] = v;</span><br><span class="line">  &#125;</span><br><span class="line">  len[u] = len[son[u]] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cnt[c[u]]++;</span><br><span class="line">  <span class="keyword">if</span>(cnt[c[u]]==<span class="number">1</span>) cur++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cnt[c[u]]--;</span><br><span class="line">  <span class="keyword">if</span>(!cnt[c[u]]) cur--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs3</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(top &amp;&amp; dep[u]-dep[sta[top]]&lt;=len[son2[u]]) <span class="built_in">del</span>(sta[top--]);</span><br><span class="line">  <span class="built_in">add</span>(sta[++top]=u);</span><br><span class="line">  <span class="keyword">if</span>(son[u]) <span class="built_in">dfs3</span>(son[u], u);</span><br><span class="line">  <span class="keyword">while</span>(top &amp;&amp; dep[u]-dep[sta[top]]&lt;=len[son[u]]) <span class="built_in">del</span>(sta[top--]);</span><br><span class="line">  ans[u] = <span class="built_in">max</span>(ans[u], cur);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = e[i].to;</span><br><span class="line">    <span class="keyword">if</span>(v==fa || v==son[u]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(sta[top]!=u) <span class="built_in">add</span>(sta[++top]=u);</span><br><span class="line">    <span class="built_in">dfs3</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(sta[top]==u) <span class="built_in">del</span>(sta[top--]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    <span class="built_in">addedge</span>(u, v); <span class="built_in">addedge</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, c+i);</span><br><span class="line">  <span class="built_in">find</span>();</span><br><span class="line">  <span class="built_in">dfs2</span>(s, <span class="number">0</span>); <span class="built_in">dfs3</span>(s, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">dfs2</span>(t, <span class="number">0</span>); <span class="built_in">dfs3</span>(t, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codeforces1307F</title>
      <link href="/2020/04/29/codeforces1307f/"/>
      <url>/2020/04/29/codeforces1307f/</url>
      
        <content type="html"><![CDATA[<p>æ— å‘å›¾ä¸Šæœ‰rä¸ªå…³é”®ç‚¹,ä¸€ä¸ªäººæ¯æ¬¡åªèƒ½è¿ç»­èµ°kæ­¥,å¤šæ¬¡è¯¢é—®uå’Œvä¸¤ç‚¹èƒ½å¦åˆ°è¾¾.</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å¦‚æœä¸¤ç‚¹é—´è·ç¦»$\leq k$,å°±ç”¨å¹¶æŸ¥é›†åˆå¹¶,æ‰€ä»¥è€ƒè™‘å¯¹rä¸ªå…³é”®ç‚¹è¿›è¡Œå¤šæºbfs,ä½†æ˜¯æ³¨æ„åˆ°è¿™æ ·ä¼šä½¿å¾—ä»»æ„ä¸¤ä¸ªè·ç¦»$\leq 2\times k$çš„ç‚¹éƒ½å¯è¾¾,è€ƒè™‘<strong>æ‹†ç‚¹</strong>,å°†æ¯æ¡è¾¹æ‹†æˆu-&gt;n+i-&gt;v,ç„¶åå¤šæºbfs kæ­¥å³å¯.å¯¹äºæ¯ä¸ªè¯¢é—®,å¦‚æœuå’Œvè·ç¦»$\leq 2\times k$,æ˜¾ç„¶å¯ä»¥,å¦åˆ™ä¸¤ä¸ªç‚¹å„è‡ªå‘å¯¹æ–¹èµ°kæ­¥(u-&gt;lca-&gt;v),æ­¤æ—¶ä¸¤ä¸ªç‚¹è‚¯å®šä¸ä¼šç›¸é‡(å› ä¸ºè·ç¦»$&gt;2\times k$),æœ€åçœ‹ä¸¤ä¸ªç‚¹æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­å³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">4e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> LOG = <span class="number">19</span>;</span><br><span class="line"><span class="type">int</span> n, k, r, sp[N], step[N], f[N];</span><br><span class="line">vector &lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="type">int</span> fa[N][<span class="number">22</span>], dep[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=LOG; i++)</span><br><span class="line">    fa[u][i] = fa[fa[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==fa[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">    fa[v][<span class="number">0</span>] = u;</span><br><span class="line">    <span class="built_in">dfs</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LCA</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(dep[fa[y][i]]&gt;=dep[x]) y = fa[y][i];</span><br><span class="line">  <span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(fa[x][i]!=fa[y][i]) x = fa[x][i], y = fa[y][i];</span><br><span class="line">  <span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>((d&gt;&gt;i)&amp;<span class="number">1</span>) x = fa[x][i];</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==f[x]) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">return</span> f[x] = <span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  x = <span class="built_in">find</span>(x), y = <span class="built_in">find</span>(y);</span><br><span class="line">  <span class="keyword">if</span>(x!=y) f[x] = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">2</span>*n; i++) f[i] = i, step[i] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=r; i++) q.<span class="built_in">push</span>(sp[i]), step[sp[i]] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">sz</span>(q))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(step[u]&gt;=k) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">merge</span>(u, v);</span><br><span class="line">      <span class="keyword">if</span>(step[v]==<span class="number">-1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        step[v] = step[u] + <span class="number">1</span>;</span><br><span class="line">        q.<span class="built_in">push</span>(v);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">walk</span><span class="params">(<span class="type">int</span> &amp;u, <span class="type">int</span> v, <span class="type">int</span> w, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dep[u]-dep[w]&gt;=k) u = <span class="built_in">up</span>(u, k);</span><br><span class="line">  <span class="keyword">else</span> u = <span class="built_in">up</span>(v, dep[v]-k+dep[u]<span class="number">-2</span>*dep[w]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">ok</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> w = <span class="built_in">LCA</span>(u, v);</span><br><span class="line">  <span class="keyword">if</span>(dep[u]+dep[v]<span class="number">-2</span>*dep[w]&lt;=<span class="number">2</span>*k) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">walk</span>(u, v, w, k); <span class="built_in">walk</span>(v, u, w, k);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">find</span>(u)==<span class="built_in">find</span>(v)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;k, &amp;r);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(n+i); G[v].<span class="built_in">pb</span>(n+i);</span><br><span class="line">    G[n+i].<span class="built_in">pb</span>(u); G[n+i].<span class="built_in">pb</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=r; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;sp[i]);</span><br><span class="line">  dep[<span class="number">1</span>] = <span class="number">1</span>; <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">bfs</span>();</span><br><span class="line">  <span class="type">int</span> q; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">ok</span>(u, v)) <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>uoj207 LCTç»´æŠ¤å­æ ‘ä¿¡æ¯+éšæœºåŒ–</title>
      <link href="/2020/04/29/uoj207-lct-wei-hu-zi-shu-xin-xi-sui-ji-hua/"/>
      <url>/2020/04/29/uoj207-lct-wei-hu-zi-shu-xin-xi-sui-ji-hua/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€æ£µæ ‘,è¦æ±‚æ”¯æŒåŠ è¾¹åˆ è¾¹,å¹¶ç»´æŠ¤ä¸€ä¸ªç‚¹å¯¹é›†åˆ,æ”¯æŒåŠ å…¥å’Œåˆ é™¤ç‚¹å¯¹,å¹¶è¯¢é—®ä¸€æ¡è¾¹æ˜¯å¦åœ¨æ‰€æœ‰é›†åˆä¸­çš„ç‚¹å¯¹é—´çš„è·¯å¾„ä¸Š.</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>è€ƒè™‘è¯¢é—®è·¯å¾„xå’Œy:å½“xä¸ºæ ¹ä¸”é›†åˆä¸­æ¯ä¸ªç‚¹å¯¹çš„å…¶ä¸­ä¸€ä¸ªéƒ½åœ¨yå­æ ‘å†…æ—¶åˆæ³•.ç»™å­æ ‘å†…æ¯ä¸ªç‚¹å¯¹éšæœºä¸€ä¸ªæƒå€¼,ç„¶åç»´æŠ¤å­æ ‘çš„å¼‚æˆ–å’Œä¿¡æ¯,å½“yå­æ ‘å†…çš„å¼‚æˆ–å’Œç­‰äºæ•´ä¸ªé›†åˆçš„å¼‚æˆ–å’Œæ—¶åˆæ³•.ç”±äºåŠ¨æ€åŠ è¾¹å’Œåˆ è¾¹æ‰€ä»¥ç”¨lctç»´æŠ¤,å¯¹äºå­æ ‘ä¿¡æ¯,åªè¦é¢å¤–ç»´æŠ¤ä¸€ä¸‹æ¯ä¸ªç‚¹è™šå„¿å­çš„å¼‚æˆ–å’Œä¿¡æ¯å³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> id, n, m, tot, w[N];</span><br><span class="line">pii p[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LCT</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ch[N][<span class="number">2</span>], fa[N], rev[N];</span><br><span class="line">  <span class="type">int</span> sum[N], sum2[N], val[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    ch[x][<span class="number">0</span>] = ch[x][<span class="number">1</span>] = fa[x] = rev[x] = <span class="number">0</span>;</span><br><span class="line">    sum[x] = sum2[x] = val[x] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getch</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">noroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">0</span>]==x || ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x) sum[x] = sum[ch[x][<span class="number">0</span>]] ^ sum[ch[x][<span class="number">1</span>]] ^ sum2[x] ^ val[x];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">    rev[x] ^= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(rev[x])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(ch[x][<span class="number">0</span>]) <span class="built_in">reverse</span>(ch[x][<span class="number">0</span>]);</span><br><span class="line">      <span class="keyword">if</span>(ch[x][<span class="number">1</span>]) <span class="built_in">reverse</span>(ch[x][<span class="number">1</span>]);</span><br><span class="line">      rev[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">noroot</span>(x)) <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">    <span class="built_in">pushdown</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x], z = fa[y], chx = <span class="built_in">getch</span>(x), chy = <span class="built_in">getch</span>(y);</span><br><span class="line">    fa[x] = z;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">noroot</span>(y)) ch[z][chy] = x;</span><br><span class="line">    ch[y][chx] = ch[x][chx^<span class="number">1</span>];</span><br><span class="line">    fa[ch[x][chx^<span class="number">1</span>]] = y;</span><br><span class="line">    ch[x][chx^<span class="number">1</span>] = y;</span><br><span class="line">    fa[y] = x;</span><br><span class="line">    <span class="built_in">pushup</span>(y);</span><br><span class="line">    <span class="built_in">pushup</span>(x);</span><br><span class="line">    <span class="built_in">pushup</span>(z);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">pushall</span>(x);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> f=fa[x]; f=fa[x], <span class="built_in">noroot</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">noroot</span>(f)) <span class="built_in">rotate</span>(<span class="built_in">getch</span>(x) == <span class="built_in">getch</span>(f) ? f : x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> y=<span class="number">0</span>; x; x=fa[y=x])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">splay</span>(x);</span><br><span class="line">      sum2[x] ^= sum[ch[x][<span class="number">1</span>]] ^ sum[y];</span><br><span class="line">      ch[x][<span class="number">1</span>] = y;</span><br><span class="line">      <span class="built_in">pushup</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x); <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="built_in">reverse</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x); <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="keyword">while</span>(ch[x][<span class="number">0</span>]) <span class="built_in">pushdown</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">makeroot</span>(x);</span><br><span class="line">    <span class="built_in">access</span>(y); <span class="built_in">splay</span>(y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">makeroot</span>(x);</span><br><span class="line">    <span class="built_in">makeroot</span>(y);</span><br><span class="line">    fa[x] = y;</span><br><span class="line">    sum2[y] ^= sum[x];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">split</span>(x,y);</span><br><span class="line">    fa[x] = ch[y][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(y);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"><span class="type">int</span> all;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">srand</span>(<span class="number">114514</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;id, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    T.<span class="built_in">link</span>(u, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;x);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> y, u, v;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;y, &amp;u, &amp;v);</span><br><span class="line">      T.<span class="built_in">cut</span>(x, y); T.<span class="built_in">link</span>(u, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> y;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;y);</span><br><span class="line">      p[++tot] = &#123;x, y&#125;;</span><br><span class="line">      w[tot] = <span class="built_in">rand</span>();</span><br><span class="line">      T.<span class="built_in">makeroot</span>(x); T.val[x] ^= w[tot];</span><br><span class="line">      T.<span class="built_in">makeroot</span>(y); T.val[y] ^= w[tot];</span><br><span class="line">      all ^= w[tot];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      T.<span class="built_in">makeroot</span>(p[x].fi); T.val[p[x].fi] ^= w[x];</span><br><span class="line">      T.<span class="built_in">makeroot</span>(p[x].se); T.val[p[x].se] ^= w[x];</span><br><span class="line">      all ^= w[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> y;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;y);</span><br><span class="line">      T.<span class="built_in">split</span>(x, y);</span><br><span class="line">      <span class="keyword">if</span>(T.sum[x]==all) <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
