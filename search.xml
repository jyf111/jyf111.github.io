<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>tabbyç»ˆç«¯æ¨¡æ‹Ÿå™¨</title>
      <link href="/2023/08/26/tabby%E7%BB%88%E7%AB%AF%E6%A8%A1%E6%8B%9F%E5%99%A8/"/>
      <url>/2023/08/26/tabby%E7%BB%88%E7%AB%AF%E6%A8%A1%E6%8B%9F%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>ç”¨äºå¹³æ›¿Xshellå’ŒXftpã€‚</p><h2 id="é…ç½®"><a class="header-anchor" href="#é…ç½®">Â¶</a>é…ç½®</h2><p>å¤–è§‚/å­—ä½“ï¼šæ”¯æŒNerd Font</p><p>ç»ˆç«¯/å³é”®ç‚¹å‡»ï¼šç²˜è´´</p><p>ç»ˆç«¯/æŒ‰ä¸‹æŒ‰é”®æ¥ç‚¹å‡»é“¾æ¥ï¼š<code>Ctrl</code>ï¼ˆé˜²æ­¢è¯¯ç‚¹é“¾æ¥ï¼‰</p><p>ç»ˆç«¯/é€‰ä¸­æ—¶å¤åˆ¶ï¼šå…³é—­</p><p>é…è‰²æ–¹æ¡ˆï¼šNord</p><p>å¿«æ·é”®ï¼š</p><ol><li><code>Ctrl-Shift-O</code>: å…³é—­å½“å‰èšç„¦çš„çª—æ ¼ (Cl<ins>o</ins>se)</li></ol><p>æ’ä»¶ï¼š</p><ol><li><code>community-color-schemes</code></li><li><code>docker</code></li><li><code>search-in-browser</code>ï¼šé€‰ä¸­æ–‡å­—ï¼Œ<strong>é•¿æŒ‰</strong>å³é”®åé€‰æ‹©åœ¨æµè§ˆå™¨ä¸­æœç´¢</li><li><code>trzsz</code>ï¼šä¸²è¡Œé€šä¿¡ç¯å¢ƒä¸‹çš„æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œæœ‰è¿›åº¦æ¡å¹¶æ”¯æŒç›®å½•ä¼ è¾“ï¼ˆlrzszåŠ å¼ºç‰ˆï¼‰</li></ol><p>çª—å£/ä¸é€æ˜åº¦ï¼šè‡ªè¡Œè°ƒæ•´</p><h2 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">Â¶</a>ä½¿ç”¨</h2><ol><li>å¤åˆ¶ï¼š<code>Ctrl+Shift+C</code></li><li>ç²˜è´´ï¼š<code>Ctrl+Shift+V</code>/å³é”®</li><li>èœå•ï¼šé•¿æŒ‰å³é”®</li><li><code>Ctrl+Shift+S</code>ï¼šå‘å³æ‹†åˆ†çª—å£ (<ins>S</ins>plit)</li><li><code>Ctrl+Shift+D</code>ï¼šå‘ä¸‹æ‹†åˆ†çª—å£ (<ins>D</ins>own)</li><li><code>trzsz</code>(<code>trz/tsz</code>)ï¼šä¸»è¦æ˜¯ç”¨äºè§£å†³æ–‡ä»¶å¤¹ä»¥åŠæ‰¹é‡æ–‡ä»¶ä¸‹è½½çš„<ul><li><code>trz dir/</code>ï¼šä¸Šä¼ æ–‡ä»¶åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹ï¼ˆ<ins>R</ins>eceiveï¼Œå³æ¥æ”¶åˆ°å½“å‰æœåŠ¡å™¨ï¼‰</li><li><code>tsz file1 file2</code>ï¼šä¸‹è½½ï¼ˆå¤šä¸ªï¼‰æ–‡ä»¶ï¼ˆ<ins>S</ins>endï¼Œå³ä»å½“å‰æœåŠ¡å™¨å‘é€ï¼‰</li><li><code>trz -d</code>å’Œ<code>tsz -r</code>ï¼šå…è®¸æ–‡ä»¶å¤¹ä¼ è¾“</li><li><code>-b</code>ï¼šäºŒè¿›åˆ¶ä¼ è¾“ï¼Œå¯¹å‹ç¼©åŒ…ã€å›¾ç‰‡ç­‰æ›´å¿«</li><li><code>-e</code>ï¼šè½¬ç§»æ§åˆ¶å­—ç¬¦</li><li><code>-y</code>ï¼šè¦†ç›–åŒåæ–‡ä»¶/æ–‡ä»¶å¤¹ï¼Œå¹¶æ”¯æŒæ–­ç‚¹ç»­ä¼ </li><li>è®¾ç½®<code>Enable drag files and directories</code>åå…è®¸ç›´æ¥æ‹–åŠ¨æ–‡ä»¶/æ–‡ä»¶å¤¹è¿›è¡Œä¸Šä¼ </li></ul></li></ol><h2 id="æ•ˆæœ"><a class="header-anchor" href="#æ•ˆæœ">Â¶</a>æ•ˆæœ</h2><p>trzszï¼š<br><img src="/post-images/trzsz.png" alt="trzä¸Šä¼ æ–‡ä»¶"></p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vim æ€»ç»“</title>
      <link href="/2023/08/25/vim%E6%80%BB%E7%BB%93/"/>
      <url>/2023/08/25/vim%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>leetcode æ¨¡æ¿æ€»ç»“</title>
      <link href="/2023/08/25/leetcode%E6%A8%A1%E6%9D%BF%E6%80%BB%E7%BB%93/"/>
      <url>/2023/08/25/leetcode%E6%A8%A1%E6%9D%BF%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>markdown æ€»ç»“</title>
      <link href="/2023/08/25/markdown%E6%80%BB%E7%BB%93/"/>
      <url>/2023/08/25/markdown%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºæœ¬è¯­æ³•"><a class="header-anchor" href="#åŸºæœ¬è¯­æ³•">Â¶</a>åŸºæœ¬è¯­æ³•</h2><h3 id="n-çº§æ ‡é¢˜"><a class="header-anchor" href="#n-çº§æ ‡é¢˜">Â¶</a>n çº§æ ‡é¢˜</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># ä¸€çº§æ ‡é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="section">## äºŒçº§æ ‡é¢˜</span></span><br></pre></td></tr></table></figure><h3 id="ç²—ä½“"><a class="header-anchor" href="#ç²—ä½“">Â¶</a>ç²—ä½“</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="strong">**ç²—ä½“æ–‡æœ¬**</span></span><br></pre></td></tr></table></figure><p><strong>ç²—ä½“æ–‡æœ¬</strong></p><h3 id="æ–œä½“"><a class="header-anchor" href="#æ–œä½“">Â¶</a>æ–œä½“</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">*æ–œä½“æ–‡æœ¬*</span></span><br></pre></td></tr></table></figure><p><em>æ–œä½“æ–‡æœ¬</em></p><h3 id="å¼•ç”¨"><a class="header-anchor" href="#å¼•ç”¨">Â¶</a>å¼•ç”¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; å¼•ç”¨</span></span><br><span class="line"><span class="quote">&gt; æ–‡æœ¬</span></span><br></pre></td></tr></table></figure><blockquote><p>å¼•ç”¨<br>æ–‡æœ¬</p></blockquote><ul><li>å»ºè®®æ¯ä¸€è¡Œå¼•ç”¨éƒ½ä½¿ç”¨ç¬¦å·<code>&gt;</code>ã€‚</li></ul><h3 id="æ— åºåˆ—è¡¨"><a class="header-anchor" href="#æ— åºåˆ—è¡¨">Â¶</a>æ— åºåˆ—è¡¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> æ— åºæ–‡æœ¬</span><br><span class="line"><span class="bullet">-</span> æ— åºæ–‡æœ¬</span><br></pre></td></tr></table></figure><ul><li>æ— åºæ–‡æœ¬</li><li>æ— åºæ–‡æœ¬</li></ul><h3 id="æœ‰åºåˆ—è¡¨"><a class="header-anchor" href="#æœ‰åºåˆ—è¡¨">Â¶</a>æœ‰åºåˆ—è¡¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> æœ‰åºæ–‡æœ¬</span><br><span class="line"><span class="bullet">2.</span> æœ‰åºæ–‡æœ¬</span><br></pre></td></tr></table></figure><ol><li>æœ‰åºæ–‡æœ¬</li><li>æœ‰åºæ–‡æœ¬</li></ol><ul><li>å¦‚æœåˆ—è¡¨é¡¹æœ‰æ¢è¡Œï¼Œåˆ™å»ºè®®ç»™æ— åºåˆ—è¡¨ä½¿ç”¨ 3 ä¸ªç©ºæ ¼ï¼Œç»™æœ‰åºåˆ—è¡¨ä½¿ç”¨ 2 ä¸ªç©ºæ ¼ã€‚</li><li>å¦‚æœä¸€ä¸ªåˆ—è¡¨ä¸­çš„æ¯ä¸ªåˆ—è¡¨é¡¹éƒ½åªæœ‰ 1 è¡Œï¼Œå»ºè®®åˆ—è¡¨é¡¹ä¹‹é—´ä¸è¦æœ‰ç©ºè¡Œã€‚</li><li>å¦‚æœåˆ—è¡¨é¡¹ä¸­æœ‰æ¢è¡Œï¼Œå»ºè®®åœ¨åˆ—è¡¨é¡¹ä¹‹é—´ç©º 1 è¡Œï¼Œè¿™æ ·ä¼šæ¯”è¾ƒå®¹æ˜“åŒºåˆ†å¤šè¡Œåˆ—è¡¨é¡¹çš„å¼€å§‹å’Œç»“æŸã€‚</li></ul><h3 id="è¡Œå†…ä»£ç "><a class="header-anchor" href="#è¡Œå†…ä»£ç ">Â¶</a>è¡Œå†…ä»£ç </h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">`code`</span></span><br></pre></td></tr></table></figure><p><code>code</code></p><h3 id="åˆ†å‰²çº¿"><a class="header-anchor" href="#åˆ†å‰²çº¿">Â¶</a>åˆ†å‰²çº¿</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">---</span><br></pre></td></tr></table></figure><hr><h3 id="æ–‡å­—é“¾æ¥"><a class="header-anchor" href="#æ–‡å­—é“¾æ¥">Â¶</a>æ–‡å­—é“¾æ¥</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">ç¤ºä¾‹ç½‘ç«™</span>](<span class="link">www.example.com</span>)</span><br></pre></td></tr></table></figure><p><a href="www.example.com">ç¤ºä¾‹ç½‘ç«™</a></p><h3 id="å›¾ç‰‡"><a class="header-anchor" href="#å›¾ç‰‡">Â¶</a>å›¾ç‰‡</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">å›¾ç‰‡</span>](<span class="link">/post-images/markdown-cheat.png</span>)</span><br></pre></td></tr></table></figure><p><img src="/post-images/markdown-cheat.png" alt="å›¾ç‰‡"></p><h3 id="ç½‘å€é“¾æ¥"><a class="header-anchor" href="#ç½‘å€é“¾æ¥">Â¶</a>ç½‘å€é“¾æ¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;www.example.com&gt;</span><br></pre></td></tr></table></figure><p>&lt;<a href="http://www.example.com">www.example.com</a>&gt;</p><h2 id="æ‰©å±•è¯­æ³•"><a class="header-anchor" href="#æ‰©å±•è¯­æ³•">Â¶</a>æ‰©å±•è¯­æ³•</h2><p>åªä»‹ç» Github åå¥½çš„ Markdownï¼ˆGFMï¼‰ï¼Œå°½é‡ä¿æŒå…¼å®¹æ€§ã€‚</p><h3 id="è‡ªåŠ¨é“¾æ¥"><a class="header-anchor" href="#è‡ªåŠ¨é“¾æ¥">Â¶</a>è‡ªåŠ¨é“¾æ¥</h3><p><a href="http://www.example.com">www.example.com</a></p><p>ç¦ç”¨è‡ªåŠ¨é“¾æ¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`www.example.com`</span><br></pre></td></tr></table></figure><p><code>www.example.com</code></p><h3 id="è¡¨æ ¼"><a class="header-anchor" href="#è¡¨æ ¼">Â¶</a>è¡¨æ ¼</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">| Header | Header | Header |</span><br><span class="line">| :---   | :---:  | ---:   |</span><br><span class="line">| Left   | Middle | Right  |</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">Header</th><th style="text-align:center">Header</th><th style="text-align:right">Header</th></tr></thead><tbody><tr><td style="text-align:left">Left</td><td style="text-align:center">Middle</td><td style="text-align:right">Right</td></tr></tbody></table><ul><li>è¡¨å¤´ä¸å…¶ä»–è¡Œä½¿ç”¨<code>-</code>æ¥åˆ†éš”ã€‚</li></ul><h3 id="ä»£ç å—"><a class="header-anchor" href="#ä»£ç å—">Â¶</a>ä»£ç å—</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">```cpp</span></span><br><span class="line"><span class="code">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="code">int main() &#123;</span></span><br><span class="line"><span class="code">  std::cout &lt;&lt; &quot;Hello Markdown\n&quot;;</span></span><br><span class="line"><span class="code">  return 0;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code">\```</span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::cout &lt;&lt; <span class="string">&quot;Hello Markdown\n&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>å¾ˆå¤š Shell å‘½ä»¤éƒ½è¦ç²˜è´´åˆ°ç»ˆç«¯ä¸­å»æ‰§è¡Œï¼Œå› æ­¤æœ€å¥½é¿å…åœ¨ Shell å‘½ä»¤ä¸­ä½¿ç”¨ä»»ä½•æ¢è¡Œæ“ä½œï¼›å¯ä»¥åœ¨è¡Œå°¾ä½¿ç”¨ä¸€ä¸ª<code>\</code>ï¼Œè¿™æ ·æ—¢èƒ½é¿å…å‘½ä»¤æ¢è¡Œï¼Œåˆèƒ½æé«˜æºç çš„å¯è¯»æ€§ã€‚</p></li><li><p>å»ºè®®ä¸è¦åœ¨æ²¡æœ‰è¾“å‡ºå†…å®¹çš„ Shell å‘½ä»¤å‰åŠ <code>$</code>ã€‚åœ¨å‘½ä»¤æ²¡æœ‰è¾“å‡ºå†…å®¹çš„æƒ…å†µä¸‹ï¼Œ<code>$</code>æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œå› ä¸ºå†…å®¹å…¨æ˜¯å‘½ä»¤ï¼Œæˆ‘ä»¬ä¸ä¼šæŠŠå‘½ä»¤å’Œè¾“å‡ºçš„å†…å®¹æ··æ·†ã€‚</p></li><li><p>å»ºè®®åœ¨æœ‰è¾“å‡ºå†…å®¹çš„ Shell å‘½ä»¤å‰åŠ ä¸Š<code>$</code>ï¼Œè¿™æ ·ä¼šæ¯”è¾ƒå®¹æ˜“åŒºåˆ†å‘½ä»¤å’Œè¾“å‡ºçš„å†…å®¹ã€‚</p></li></ul><h3 id="åˆ é™¤çº¿"><a class="header-anchor" href="#åˆ é™¤çº¿">Â¶</a>åˆ é™¤çº¿</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~~åˆ é™¤æ–‡æœ¬~~</span><br></pre></td></tr></table></figure><p><s>åˆ é™¤æ–‡æœ¬</s></p><h3 id="ä»»åŠ¡åˆ—è¡¨"><a class="header-anchor" href="#ä»»åŠ¡åˆ—è¡¨">Â¶</a>ä»»åŠ¡åˆ—è¡¨</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- [x] å·²å®Œæˆ</span><br><span class="line">- [ ] TODO</span><br></pre></td></tr></table></figure><ul><li><input type="checkbox" id="checkbox0" checked="true"><label for="checkbox0">å·²å®Œæˆ</label></li><li><input type="checkbox" id="checkbox1"><label for="checkbox1">TODO</label></li></ul><hr><p>è¡¨æƒ…ç¬¦å·ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:cry: :joy: :smile: :warning: :memo: :bulb:</span><br></pre></td></tr></table></figure><p>ğŸ˜¢<br>ğŸ˜‚<br>ğŸ˜„<br>âš ï¸<br>ğŸ“<br>ğŸ’¡</p><p>å‚é˜… <a href="https://gist.github.com/rxaviers/7360908">è¡¨æƒ…çŸ­ä»£ç åˆ—è¡¨</a></p><h2 id="Tricks"><a class="header-anchor" href="#Tricks">Â¶</a>Tricks</h2><p>ä¸»è¦æ˜¯åˆ©ç”¨ HTML å®ç°ä¸€äº›é¢å¤–çš„åŠŸèƒ½ã€‚</p><h3 id="ä¸‹åˆ’çº¿"><a class="header-anchor" href="#ä¸‹åˆ’çº¿">Â¶</a>ä¸‹åˆ’çº¿</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ins</span>&gt;</span>ä¸‹åˆ’çº¿æ–‡æœ¬<span class="tag">&lt;/<span class="name">ins</span>&gt;</span></span><br></pre></td></tr></table></figure><p><ins>ä¸‹åˆ’çº¿æ–‡æœ¬</ins></p><h3 id="ç¼©è¿›"><a class="header-anchor" href="#ç¼©è¿›">Â¶</a>ç¼©è¿›</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>ç¼©è¿›æ–‡æœ¬</span><br></pre></td></tr></table></figure><p>Â Â Â Â ç¼©è¿›æ–‡æœ¬</p><h3 id="å±…ä¸­"><a class="header-anchor" href="#å±…ä¸­">Â¶</a>å±…ä¸­</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;center\&gt;å±…ä¸­æ–‡æœ¬\&lt;/center\&gt; # æ ‡å‡†å·²å¼ƒç”¨</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center&quot;</span>&gt;</span>å±…ä¸­æ–‡æœ¬<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&lt;center&gt;å±…ä¸­æ–‡æœ¬&lt;/center&gt;</p><h3 id="é¢œè‰²"><a class="header-anchor" href="#é¢œè‰²">Â¶</a>é¢œè‰²</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span>çº¢è‰²æ–‡æœ¬<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br></pre></td></tr></table></figure><p><font color="red">çº¢è‰²æ–‡æœ¬</font></p><hr><h3 id="å›¾ç‰‡å¤§å°"><a class="header-anchor" href="#å›¾ç‰‡å¤§å°">Â¶</a>å›¾ç‰‡å¤§å°</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;image.png&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;image.png&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:33%;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç›®å½•"><a class="header-anchor" href="#ç›®å½•">Â¶</a>ç›®å½•</h3><p>[TOC]</p><h3 id="å†…å®¹æŠ˜å "><a class="header-anchor" href="#å†…å®¹æŠ˜å ">Â¶</a>å†…å®¹æŠ˜å </h3><p>éœ€è¦å®‰è£…<code>markdown-it-collapsible</code>æ’ä»¶</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+++ <span class="strong">**ç‚¹å‡»æŸ¥çœ‹**</span></span><br><span class="line">éšè—å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line"><span class="code">```python</span></span><br><span class="line"><span class="code">def expand():</span></span><br><span class="line"><span class="code">  return &quot;exapndable&quot;</span></span><br><span class="line"><span class="code">\```</span></span><br><span class="line"></span><br><span class="line">+++</span><br></pre></td></tr></table></figure><details><summary><span class="details-marker">&nbsp;</span><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><p>éšè—å†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">expand</span>():</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;expandable&quot;</span></span><br></pre></td></tr></table></figure></details><h3 id="æ•°å­¦å…¬å¼"><a class="header-anchor" href="#æ•°å­¦å…¬å¼">Â¶</a>æ•°å­¦å…¬å¼</h3><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$</span>a = b + c * d - e<span class="built_in">_</span>0 * f<span class="built_in">$</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span><span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span> u&#125;&#123;<span class="keyword">\partial</span> t&#125;</span><br><span class="line">= h<span class="built_in">^</span>2 <span class="keyword">\left</span>( <span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span><span class="built_in">^</span>2 u&#125;&#123;<span class="keyword">\partial</span> x<span class="built_in">^</span>2&#125; +</span><br><span class="line"><span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span><span class="built_in">^</span>2 u&#125;&#123;<span class="keyword">\partial</span> y<span class="built_in">^</span>2&#125; +</span><br><span class="line"><span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span><span class="built_in">^</span>2 u&#125;&#123;<span class="keyword">\partial</span> z<span class="built_in">^</span>2&#125;<span class="keyword">\right</span>)<span class="built_in">$</span><span class="built_in">$</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span></span><br><span class="line"><span class="keyword">\left</span>[</span><br><span class="line">    <span class="keyword">\begin</span>&#123;array&#125;&#123;cc|c&#125;</span><br><span class="line">      1<span class="built_in">&amp;</span>2<span class="built_in">&amp;</span>3<span class="keyword">\newline</span></span><br><span class="line">      4<span class="built_in">&amp;</span>5<span class="built_in">&amp;</span>6</span><br><span class="line">    <span class="keyword">\end</span>&#123;array&#125;</span><br><span class="line"><span class="keyword">\right</span>]</span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;eqnarray&#125;</span><br><span class="line"><span class="keyword">\nabla</span><span class="keyword">\cdot</span><span class="keyword">\vec</span>&#123;E&#125; <span class="built_in">&amp;</span>=<span class="built_in">&amp;</span> <span class="keyword">\frac</span>&#123;<span class="keyword">\rho</span>&#125;&#123;<span class="keyword">\epsilon</span><span class="built_in">_</span>0&#125; <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\nabla</span><span class="keyword">\cdot</span><span class="keyword">\vec</span>&#123;B&#125; <span class="built_in">&amp;</span>=<span class="built_in">&amp;</span> 0 <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\nabla</span><span class="keyword">\times</span><span class="keyword">\vec</span>&#123;E&#125; <span class="built_in">&amp;</span>=<span class="built_in">&amp;</span> -<span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span> B&#125;&#123;<span class="keyword">\partial</span> t&#125; <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\nabla</span><span class="keyword">\times</span><span class="keyword">\vec</span>&#123;B&#125; <span class="built_in">&amp;</span>=<span class="built_in">&amp;</span> <span class="keyword">\mu</span><span class="built_in">_</span>0<span class="keyword">\left</span>(<span class="keyword">\vec</span>&#123;J&#125;+<span class="keyword">\epsilon</span><span class="built_in">_</span>0<span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span> E&#125;&#123;<span class="keyword">\partial</span> t&#125; <span class="keyword">\right</span>)</span><br><span class="line"><span class="keyword">\end</span>&#123;eqnarray&#125;</span><br><span class="line"><span class="built_in">$</span><span class="built_in">$</span></span><br></pre></td></tr></table></figure><p>$a = b + c * d - e_0 * f$</p><p>$$\frac{\partial u}{\partial t}<br>= h^2 \left( \frac{\partial^2 u}{\partial x^2} +<br>\frac{\partial^2 u}{\partial y^2} +<br>\frac{\partial^2 u}{\partial z^2}\right)$$</p><p>$$<br>\left[<br>\begin{array}{cc|c}<br>1&amp;2&amp;3\newline<br>4&amp;5&amp;6<br>\end{array}<br>\right]<br>$$</p><p>$$<br>\begin{eqnarray}<br>\nabla\cdot\vec{E} &amp;=&amp; \frac{\rho}{\epsilon_0} \<br>\nabla\cdot\vec{B} &amp;=&amp; 0 \<br>\nabla\times\vec{E} &amp;=&amp; -\frac{\partial B}{\partial t} \<br>\nabla\times\vec{B} &amp;=&amp; \mu_0\left(\vec{J}+\epsilon_0\frac{\partial E}{\partial t} \right)<br>\end{eqnarray}<br>$$</p><h2 id="æ’ç‰ˆ-Tips"><a class="header-anchor" href="#æ’ç‰ˆ-Tips">Â¶</a>æ’ç‰ˆ Tips</h2><ol><li>å®‰è£…<code>markdownlint</code>æ’ä»¶ã€‚</li><li>ä½¿ç”¨<code>Trailing Spaces</code>æ’ä»¶ã€‚</li><li>å»ºè®®ä¸­æ–‡å’Œè‹±æ–‡ä¹‹é—´åŠ ç©ºæ ¼ï¼Œä¸­æ–‡/è‹±æ–‡å’Œæ•°å­—ä¹‹é—´ä¹Ÿè¦åŠ ç©ºæ ¼ã€‚ï¼ˆè¯•äº†å‡ ä¸ª<code>hexo</code>æ’ä»¶éƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œè¿™æ¡çœ‹æƒ…å†µéµå®ˆå§ï¼‰</li><li>è‹±æ–‡æ ‡ç‚¹ç¬¦å·ï¼ˆå¦‚ï¼Œ.ï¼›ï¼šï¼Ÿï¼‰ä¸åé¢çš„å­—ç¬¦ä¹‹é—´éœ€è¦åŠ ç©ºæ ¼ï¼Œä¸å‰é¢çš„å­—ç¬¦ä¹‹é—´ä¸éœ€è¦åŠ ç©ºæ ¼ã€‚</li><li>ä¸­æ–‡æ ‡ç‚¹ç¬¦å·å’Œæ•°å­—ã€ä¸­æ–‡ã€è‹±æ–‡ä¹‹é—´ä¸éœ€è¦æ·»åŠ ç©ºæ ¼ã€‚</li><li>ä¸­æ–‡æ’ç‰ˆä½¿ç”¨å…¨è§’æ ‡ç‚¹ç¬¦å·ï¼Œè‹±æ–‡æ’ç‰ˆä½¿ç”¨åŠè§’æ ‡ç‚¹ç¬¦å·ã€‚</li><li>ä¸“æœ‰åè¯æ³¨æ„å¤§å°å†™é—®é¢˜ã€‚</li><li>æ‹¬å·çš„ç”¨æ³•ï¼šåœ¨æ‹¬å·å†…åªæœ‰è‹±æ–‡æ—¶ç”¨è‹±æ–‡æ‹¬å·ï¼Œå¹¶åœ¨æ‹¬å·å‰ååŠ ä¸€ä¸ªåŠè§’ç©ºæ ¼ï¼›åœ¨æ‹¬å·å†…æœ‰ä¸­æ–‡æ—¶ç”¨ä¸­æ–‡æ‹¬å·ã€‚</li><li>è‹±æ–‡æ²¡æœ‰é¡¿å·ï¼Œå› æ­¤åœ¨è‹±æ–‡å’Œé˜¿æ‹‰ä¼¯æ•°å­—å¹¶åˆ—æ—¶ç”¨é€—å·ï¼Œå¦åˆ™ç”¨é¡¿å·ã€‚</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç«èµ›å›¾</title>
      <link href="/2022/06/20/jing-sai-tu/"/>
      <url>/2022/06/20/jing-sai-tu/</url>
      
        <content type="html"><![CDATA[<p>è‹¥ç«èµ›å›¾å­˜åœ¨ç¯ï¼Œåˆ™ä¸€å®šå­˜åœ¨ä¸‰å…ƒç¯ã€‚</p><p>å¤§å°ä¸º$n$($n&gt;1$)çš„å¼ºè¿é€šå—ï¼Œå¤§å°ä¸º$[3,n]$çš„ç®€å•ç¯å‡å­˜åœ¨ã€‚</p><p>ä»»æ„ç«èµ›å›¾éƒ½æœ‰å“ˆå¯†é¡¿è·¯å¾„ï¼ˆç»è¿‡æ¯ä¸ªç‚¹ä¸€æ¬¡çš„è·¯å¾„ï¼Œä¸è¦æ±‚å›åˆ°å‡ºå‘ç‚¹ï¼‰ã€‚</p><p><strong>å¢é‡æ„é€ </strong>ï¼šå¯¹äºç¬¬$i$ä¸ªç‚¹ï¼Œè¦ä¹ˆæ”¾åœ¨ç¬¬ä¸€ä¸ªï¼Œè¦ä¹ˆä»åå¾€å‰æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³$j\rightarrow i$çš„ï¼Œç„¶åæ’åœ¨$j$çš„åé¢ã€‚</p><p>ç«èµ›å›¾å­˜åœ¨å“ˆå¯†é¡¿å›è·¯çš„å……è¦æ¡ä»¶æ˜¯å¼ºè”é€šã€‚</p><p>å…ˆæ„é€ å“ˆå¯†é¡¿è·¯å¾„ï¼Œç„¶åæ„é€ å“ˆå¯†é¡¿å›è·¯ã€‚</p><p>ç»´æŠ¤é“¾$v_1,\dots,v_k,\dots,v_i$â€‹ï¼Œå…¶ä¸­$v_k\rightarrow<br>v_1$â€‹ï¼Œç„¶åè€ƒè™‘æ‰©å±•åˆ°èŠ‚ç‚¹$i+1$æ¥æ‰©å¤§ç¯ï¼š</p><ol><li>$v_{i+1}\rightarrow v_1$â€‹ï¼Œç›´æ¥æ‰©å¤§</li><li>æ‰¾åˆ°æœ€å°çš„$j$ï¼Œæ»¡è¶³$v_{i+1}\rightarrow v_{j} (j\le k)$ï¼Œç„¶åä¿®æ”¹è·¯å¾„ä¸º$v_{i+1},v_j,\dots,v_k,v_1,\dots,v_{j-1},v_{k+1},\dots,v_i$</li><li>ç›´æ¥è€ƒè™‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">gao</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; path)</span> </span>&#123;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; npath;</span><br><span class="line">  <span class="comment">// å“ˆå¯†é¡¿è·¯</span></span><br><span class="line">  npath.<span class="built_in">push_back</span>(path.<span class="built_in">front</span>());</span><br><span class="line">  <span class="type">int</span> sz = path.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;sz; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (G[path[i]][npath.<span class="built_in">front</span>()]) npath.<span class="built_in">insert</span>(npath.<span class="built_in">begin</span>(), path[i]);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> j=(<span class="type">int</span>)npath.<span class="built_in">size</span>()<span class="number">-1</span>; j&gt;=<span class="number">0</span>; j--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (G[npath[j]][path[i]]) &#123;</span><br><span class="line">          npath.<span class="built_in">insert</span>(npath.<span class="built_in">begin</span>()+j+<span class="number">1</span>, path[i]);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// å“ˆå¯†é¡¿å›è·¯</span></span><br><span class="line">  <span class="type">int</span> k = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt;sz; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (G[npath[i]][npath[<span class="number">0</span>]]) k = i;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>; j&lt;=k; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (G[npath[i]][npath[j]]) &#123;</span><br><span class="line">          vector&lt;<span class="type">int</span>&gt; tmp;</span><br><span class="line">          tmp.<span class="built_in">push_back</span>(npath[i]);</span><br><span class="line">          tmp.<span class="built_in">insert</span>(tmp.<span class="built_in">end</span>(), npath.<span class="built_in">begin</span>()+j, npath.<span class="built_in">begin</span>()+k+<span class="number">1</span>);</span><br><span class="line">          tmp.<span class="built_in">insert</span>(tmp.<span class="built_in">end</span>(), npath.<span class="built_in">begin</span>(), npath.<span class="built_in">begin</span>()+j);</span><br><span class="line">          tmp.<span class="built_in">insert</span>(tmp.<span class="built_in">end</span>(), npath.<span class="built_in">begin</span>()+k+<span class="number">1</span>, npath.<span class="built_in">begin</span>()+i);</span><br><span class="line">          tmp.<span class="built_in">insert</span>(tmp.<span class="built_in">end</span>(), npath.<span class="built_in">begin</span>()+i+<span class="number">1</span>, npath.<span class="built_in">end</span>());</span><br><span class="line">          <span class="built_in">swap</span>(tmp, npath);</span><br><span class="line">          k = i;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">swap</span>(path, npath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼ºè¿é€šç¼©ç‚¹åå‘ˆé“¾çŠ¶ï¼Œæ‹“æ‰‘åºå°çš„ç‚¹å‘æ‰€æœ‰æ‹“æ‰‘åºå¤§çš„ç‚¹è¿è¾¹ï¼ˆå› æ­¤å¯ä»¥ç›´æ¥æ ¹æ®å¼ºè¿é€šåˆ†é‡åˆ¤æ–­ä»»æ„ä¸¤ç‚¹é—´çš„å¯è¾¾æ€§ï¼‰ã€‚</p><p><strong>Diracå®šç†</strong>ï¼š$n$é˜¶($n\ge3$)<strong>æ— å‘</strong>ç®€å•å›¾ï¼Œä»»æ„ä¸ç›¸é‚»çš„ä¸¤ä¸ªé¡¶ç‚¹$v_i,v_j$â€‹ï¼Œå‡æœ‰$d(v_i)+d(v_j)\ge<br>n$ï¼Œåˆ™å­˜åœ¨å“ˆå¯†é¡¿å›è·¯ã€‚</p><p>å…ˆä¸æ–­ä»é¦–å°¾æ‰©å±•ï¼Œå¾—åˆ°æå¤§çš„è·¯å¾„$s,v_1,\dots,v_k,t$ï¼Œè‹¥$s$å’Œ$t$æœ‰è¾¹åˆ™å¾—åˆ°å›è·¯ï¼Œå¦åˆ™ä¸€å®šå­˜åœ¨$s\rightarrow<br>v_{i+1},t\rightarrow<br>v_i$â€‹ï¼ˆé¸½å·¢åŸç†ï¼‰ï¼Œæ„é€ å¾—åˆ°å›è·¯$s,v_{i+1},\dots,t,v_i,\dots,s$ã€‚å¦‚æœè¯¥å›è·¯é•¿åº¦å°äº$n$ï¼Œå‰©ä½™ç‚¹ä¸€å®šä¸å›è·¯ä¸­çš„æŸä¸ªç‚¹æœ‰è¾¹ç›¸è¿ï¼Œä»è¯¥å¤„å°†ç¯æ–­å¼€ï¼Œç„¶åé‡å¤æ‰©å±•å³å¯ã€‚</p><p>$n$é˜¶($n\ge2$)<strong>æ— å‘</strong>ç®€å•å›¾ï¼Œä»»æ„ä¸ç›¸é‚»çš„ä¸¤ä¸ªé¡¶ç‚¹$v_i,v_j$â€‹ï¼Œå‡æœ‰$d(v_i)+d(v_j)\ge<br>n-1$ï¼Œåˆ™å­˜åœ¨å“ˆå¯†é¡¿é€šè·¯ã€‚</p><p>$n$é˜¶($n\ge3$)<strong>æ— å‘</strong>ç®€å•å›¾ï¼Œä»»æ„é¡¶ç‚¹$v_i$â€‹ï¼Œå‡æœ‰$d(v_i)\ge<br>\frac{n}{2}$â€‹ï¼Œåˆ™å­˜åœ¨å“ˆå¯†é¡¿å›è·¯ã€‚</p><p><strong>å…°é“å®šç†</strong>ï¼šå°†ç«èµ›å›¾çš„å‡ºåº¦ä»å°åˆ°å¤§æ’åºå¾—åˆ°æ¯”åˆ†åºåˆ—$s$ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶åˆ™åˆæ³•ï¼š</p><p>$\forall 1\leq k \leq n,\sum \limits_{i=1}^k s_i \geq<br>\binom{k}{2}$ï¼Œä¸”$k=n$æ—¶å¿…é¡»å–ç­‰å·ã€‚</p><p>å…ˆæ„é€ åºåˆ—$a=(0,1,\dots,n-1)$ï¼Œæ­¤æ—¶$a$çš„å‰ç¼€å°äº$s$ï¼Œåç¼€å¤§äº$s$ï¼ˆå› ä¸º$a$å’Œ$s$çš„æ€»å’Œç›¸åŒï¼‰ï¼Œç„¶åæ‰¾åˆ°ç¬¬ä¸€ä¸ª$a_l&lt;<br>s_l$â€‹ï¼Œä»¥åŠæœ€åä¸€ä¸ª$a_u=a_l$â€‹ï¼ˆä¸ºäº†ä¿è¯ä¿®æ”¹å$a$ä»ç„¶æœ‰åºï¼‰ï¼Œå†æ‰¾åˆ°ç¬¬ä¸€ä¸ª$a_v&gt;<br>s_v$â€‹ï¼Œåˆ™$a_u&lt;s_u\le s_v&lt;a_v$â€‹ï¼Œå³$a_v\ge<br>a_u+2$ï¼Œè‹¥$v\rightarrow u$ï¼Œæˆ–$v\rightarrow p,p\rightarrow<br>u$ï¼Œå°±å°†ç›¸åº”è¾¹è¿›è¡Œç¿»è½¬ï¼Œè¿™æ ·ä¸æ–­è°ƒæ•´ï¼Œæœ€ç»ˆ$a=s$ã€‚</p><p>å¼ºè¿å›¾ç«èµ›å›¾è®¡æ•°ï¼š$g_i=f_i-\sum_{j=1}^{i-1}\binom{i}{j}g_jf_{i-j}$â€‹ï¼Œå³æšä¸¾æ‹“æ‰‘åºæœ€å°çš„å¼ºè¿é€šåˆ†é‡çš„å¤§å°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>oneTBB å¹¶è¡Œç¼–ç¨‹æ¡†æ¶</title>
      <link href="/2022/05/21/onetbb-bing-xing-bian-cheng-kuang-jia/"/>
      <url>/2022/05/21/onetbb-bing-xing-bian-cheng-kuang-jia/</url>
      
        <content type="html"><![CDATA[<h3 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">Â¶</a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/oneapi-src/oneTBB.git</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> build</span><br><span class="line">cmake ..</span><br><span class="line">make -j 4</span><br><span class="line">make install</span><br></pre></td></tr></table></figure><p>makeè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°å¦‚ä¸‹é—®é¢˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c++: fatal error: Killed signal terminated program cc1plus</span><br><span class="line">compilation terminated.</span><br></pre></td></tr></table></figure><p>åŸå› å°±æ˜¯å†…å­˜å¤ªå°äº†ï¼Œå‡å°å¹¶è¡Œåº¦æˆ–è€…ä¸´æ—¶æ¢é¡µ ï¼ˆ<a href="https://blog.csdn.net/weixin_44796670/article/details/121234446">å‚è€ƒ</a>ï¼‰</p><h3 id="è®¡æ—¶"><a class="header-anchor" href="#è®¡æ—¶">Â¶</a>è®¡æ—¶</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tbb::tick_count::<span class="built_in">now</span>();</span><br><span class="line">tick_count t0 = tick_count::<span class="built_in">now</span>();</span><br><span class="line">tick_count t1 = tick_count::<span class="built_in">now</span>();</span><br><span class="line"><span class="built_in">printf</span>(â€œwork took %g seconds\nâ€,(t1-t0).<span class="built_in">seconds</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> start = std::chrono::steady_clock::<span class="built_in">now</span>();</span><br><span class="line"><span class="keyword">auto</span> end = std::chrono::steady_clock::<span class="built_in">now</span>();</span><br><span class="line">std::cerr &lt;&lt; std::chrono::<span class="built_in">duration</span>&lt;<span class="type">double</span>, std::milli&gt;(end - start).<span class="built_in">count</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure><p>åªè®°æ—¶ä¸€æ¬¡ï¼Œå®¹æ˜“å‡ºç°æ³¢åŠ¨</p><p>ä½¿ç”¨<code>google benchmark</code>ï¼Œå¯ä»¥è·‘å¤šæ¬¡æ±‚å¹³å‡å€¼</p><h3 id="æ§åˆ¶è¿è¡Œçš„çº¿ç¨‹æ•°"><a class="header-anchor" href="#æ§åˆ¶è¿è¡Œçš„çº¿ç¨‹æ•°">Â¶</a>æ§åˆ¶è¿è¡Œçš„çº¿ç¨‹æ•°</h3><p>Thread local storageï¼š<code>thread_local</code>è¡¨æ˜è¯¥å˜é‡çš„ä½œç”¨åŸŸæ˜¯çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä»½æ‹·è´ã€‚</p><p>å¯¹äºTBBè€Œè¨€ï¼Œä½ ä¸çŸ¥é“ä»»åŠ¡å’Œçº¿ç¨‹ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚</p><p><code>enumerable_thread_specific</code>ï¼šprovides thread local storage that acts like an<br>STL container with one element per thread. The container permits iterating<br>over the elements using the usual STL iteration idioms. Any thread can iterate<br>over all the local copies, seeing the other threads local<br>data.ï¼ˆæ¯ä¸ªçº¿ç¨‹æœ‰ä¸€ä»½æ‹·è´ï¼Œå¹¶ä¸”æ‰€æœ‰æ‹·è´è¢«ç»„ç»‡æˆä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥é¡ºåºéå†å®¹å™¨æ¥ç»“åˆæœ€ç»ˆç»“æœï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="type">ets_vector_t</span> = enumerable_thread_specific&lt;vector&lt;<span class="type">int</span>&gt;&gt;;</span><br><span class="line"><span class="function"><span class="type">ets_vector_t</span> <span class="title">partial</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="built_in">parallel_for</span>(<span class="number">0</span>, <span class="number">10</span>, [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">  <span class="type">ets_vector_t</span>::reference local = partial.<span class="built_in">local</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span>&amp; x : local) x = <span class="number">20</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sum</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span>&amp; it : partial)</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; N; ++j) sum[j] += it[j];</span><br></pre></td></tr></table></figure><p>ç”¨æ³•å°±æ˜¯åŒ…è£…ä¸€ä¸ªtbb::enumerable_thread_specificï¼Œç„¶ååœ¨å†…éƒ¨ä½¿ç”¨localå¾—åˆ°è‡ªå·±çš„é‚£ä»½æ‹·è´ï¼Œæ­¤å¤–å¯ä»¥éå†æ•´ä¸ªå®¹å™¨ï¼Œå¾—åˆ°æ¯ä¸€ä»½æ‹·è´ã€‚ï¼ˆå¦‚æœè¯¥çº¿ç¨‹ç¬¬ä¸€æ¬¡è°ƒç”¨localï¼Œå°±ä¼šåˆ›å»ºä¸€ä»½ï¼Œå¦åˆ™ä¼šä½¿ç”¨è‡ªå·±å·²ç»åˆ›å»ºçš„é‚£ä»½ï¼‰</p><p>å¯ä»¥ä½¿ç”¨<code>size()</code>å¾—åˆ°æœ‰å‡ ä¸ªæ‹·è´ï¼Œä½†æ˜¯è¯¥å®¹å™¨åªæ”¯æŒé¡ºåºéå†ï¼Œä¸èƒ½éšæœºè®¿é—®(ä¸æ”¯æŒ<code>[]</code>)ã€‚æ‰€ä»¥å¦‚æœæŒ‡å®šçº¿ç¨‹æƒ³æŸ¥çœ‹å¯¹æ–¹çš„ç§æœ‰æ‹·è´ï¼Œè¿™æ˜¯ä¸è¡Œçš„ï¼Œä½ æ—¢ä¸çŸ¥é“å®ƒçš„ä¸‹æ ‡ï¼Œä¹Ÿæ²¡åŠæ³•ç›´æ¥è®¿é—®</p><p><code>combinable</code>ï¼šprovides thread local storage for holding per-thread<br>subcomputations that will later be reduced to a single result. Each thread can<br>only see its local data or, after calling combine, the combined data.<br>ï¼ˆç”¨äºå­˜å‚¨ä¸­é—´ç»“æœï¼Œåªèƒ½çœ‹åˆ°è‡ªå·±çš„æ•°æ®ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">combinable&lt;vector&lt;<span class="type">int</span>&gt;&gt; partial&#123;[]()&#123;<span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(N); &#125;&#125;;</span><br><span class="line"><span class="built_in">parallel_for</span>(<span class="number">0</span>, <span class="number">10</span>, [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">  <span class="keyword">auto</span>&amp; local = partial.<span class="built_in">local</span>();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sum</span><span class="params">(N)</span></span>;</span><br><span class="line">partial.<span class="built_in">combine_each</span>([&amp;](<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; a) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) sum[i] += a[i];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>combinableéœ€è¦ä¼ å…¥ä¸€ä¸ªlambdaï¼Œåœ¨localä¸­ä¼šè°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–ã€‚</p><p>é€šè¿‡combine_eachå°†æ¯ä»½æ‹·è´çš„ç»“æœåˆå¹¶èµ·æ¥ã€‚</p><p>noteï¼šä¸ªäººæ„Ÿè§‰è¿™ä¸¤è€…å·®ä¸å¤šï¼Œcombine_eachå…¶å®å°±ç­‰ä»·äºé¡ºåºéå†æ‹·è´æ„æˆçš„å®¹å™¨</p><hr><p>Task</p><p><code>parallel_invoke(f1,f2...)</code>ï¼ˆéšå¼çš„task spawningå’Œbarrierï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">task_group g;</span><br><span class="line">g.<span class="built_in">run</span>(f1);</span><br><span class="line">g.<span class="built_in">run</span>(f2);</span><br><span class="line">...</span><br><span class="line">g.<span class="built_in">wait</span>();</span><br></pre></td></tr></table></figure><p><code>run_and_wait(f)</code>ï¼šwe avoid the overhead of enqueueing-schedulingdequeuing<br>steps, and second, we avoid the potential stealing that can happen while the<br>task is in the queue.</p><p><code>cancel()</code></p><p>å¦‚æœæœ‰å¤§é‡ä»»åŠ¡ï¼Œçº¿æ€§spawnä¸å¦‚é€’å½’spawnï¼ˆæ»¡äºŒå‰çš„å½¢å¼ï¼‰</p><hr><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">parallel_for</span>(<span class="number">0</span>, n, [](<span class="type">int</span> i) &#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">parallel_for</span>(<span class="built_in">blocked_range</span>&lt;<span class="type">int</span>&gt;(<span class="number">0</span>, n), [&amp;](<span class="type">const</span> <span class="keyword">auto</span>&amp; range r) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = r.<span class="built_in">begin</span>(); i != r.<span class="built_in">end</span>(); ++i) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">parallel_reduce</span>(<span class="built_in">blocked_range</span>&lt;<span class="type">int</span>&gt;(<span class="number">0</span>, n), init,  <span class="comment">// è§„çº¦</span></span><br><span class="line">  [&amp;](<span class="type">const</span> <span class="keyword">auto</span>&amp; range r, <span class="keyword">auto</span> pre) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  [&amp;](<span class="keyword">auto</span> x, <span class="keyword">auto</span> y) &#123; <span class="comment">// combine</span></span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line">);</span><br><span class="line"><span class="built_in">parallel_scan</span>(<span class="built_in">blocked_range</span>&lt;<span class="type">int</span>&gt;(<span class="number">0</span>, n), init,  <span class="comment">// å‰ç¼€è§„çº¦</span></span><br><span class="line">  [&amp;](<span class="type">const</span> <span class="keyword">auto</span>&amp; range r, <span class="keyword">auto</span> pre, <span class="type">bool</span> is_final_scan) &#123;</span><br><span class="line">    <span class="keyword">if</span> (is_final_scan) &#123;</span><br><span class="line">        <span class="comment">// write</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  [&amp;](<span class="keyword">auto</span> x, <span class="keyword">auto</span> y) &#123; <span class="comment">// combine</span></span><br><span class="line"></span><br><span class="line">  &#125;;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>å¹¶è¡Œè¿‡æ»¤ï¼šè€ƒè™‘å¯¹ä¸€ä¸ªvectoræ‰§è¡Œä¸€ä¸ªè¿‡æ»¤æ¡ä»¶ã€‚æˆ‘ç›®å‰è®¤ä¸ºæœ€å¥½çš„å†™æ³•æ˜¯å…ˆresizeè¶³å¤Ÿå¤§çš„ç©ºé—´ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªatomicè®°å½•ç»“æœvectorçš„å¤§å°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">size_t</span> local_base = res_size.<span class="built_in">fetch_add</span>(local_size);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; local_size; i++) res[local_base + i] = local_res[i];</span><br></pre></td></tr></table></figure><p>POD_vector(?)ï¼šä¸Šè¿°æƒ…å†µä¸­å¿…é¡»å…ˆresizeï¼Œä¸èƒ½reserveï¼Œè€Œresizeçš„ä¸€ä¸ªé—®é¢˜æ˜¯ä¼šå¯¹æ‰€æœ‰å…ƒç´ åšä¸€émemsetï¼Œæœ‰æ—¶å€™è¿™æ˜¯å¾ˆå¤šä½™çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¸€äº›trické¿å…è¿™ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨äºè°ƒè¯•çš„c++æ—¥å¿—åº“-spdlog</title>
      <link href="/2022/05/20/yong-yu-diao-shi-de-cri-zhi-ku-spdlog/"/>
      <url>/2022/05/20/yong-yu-diao-shi-de-cri-zhi-ku-spdlog/</url>
      
        <content type="html"><![CDATA[<h3 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">Â¶</a>ä½¿ç”¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/gabime/spdlog.git</span><br></pre></td></tr></table></figure><p>header-only æ‰€ä»¥ç›´æ¥includeå¤´æ–‡ä»¶å³å¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥installæˆé™æ€åº“</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">target_include_directories</span>(xxx</span><br><span class="line">PRIVATE</span><br><span class="line">  spdlog/<span class="keyword">include</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æ—¥å¿—çº§åˆ«ï¼šinfoã€warnã€errorã€critical</p><p>mtåç¼€è¡¨ç¤ºå¤šçº¿ç¨‹ï¼ˆmulti threadedï¼‰ï¼Œståç¼€è¡¨ç¤ºå•çº¿ç¨‹</p><blockquote><p>spdlog takes the â€œinclude what you needâ€ approach - your code should include<br>the features that actually needed.</p></blockquote><p>è¾“å‡ºä½¿ç”¨fmtåº“ï¼Œç±»ä¼¼python</p><p>ç¼–è¯‘å™¨logè¿‡æ»¤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> SPDLOG_ACTIVE_LEVEL SPDLOG_LEVEL_DEBUG</span></span><br><span class="line"></span><br><span class="line">spdlog::<span class="built_in">set_level</span>(spdlog::level::debug); <span class="comment">// or spdlog::set_level(spdlog::level::trace);</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">SPDLOG_LOGGER_TRACE</span>(file_logger , <span class="string">&quot;Some trace message that will not be evaluated.&#123;&#125; ,&#123;&#125;&quot;</span>, <span class="number">1</span>, <span class="number">3.23</span>);</span><br><span class="line"><span class="built_in">SPDLOG_LOGGER_DEBUG</span>(file_logger , <span class="string">&quot;Some Debug message that will be evaluated.. &#123;&#125; ,&#123;&#125;&quot;</span>, <span class="number">1</span>, <span class="number">3.23</span>);</span><br><span class="line"><span class="built_in">SPDLOG_DEBUG</span>(<span class="string">&quot;Some debug message to default logger that will be evaluated&quot;</span>);</span><br></pre></td></tr></table></figure><p>set level</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">spdlog::<span class="built_in">set_level</span>(spdlog::level::info); <span class="comment">// Set global log level to info</span></span><br><span class="line">spdlog::<span class="built_in">debug</span>(<span class="string">&quot;This message should not be displayed!&quot;</span>);</span><br><span class="line">spdlog::<span class="built_in">set_level</span>(spdlog::level::trace); <span class="comment">// Set specific logger&#x27;s log level</span></span><br><span class="line">spdlog::<span class="built_in">debug</span>(<span class="string">&quot;This message should be displayed..&quot;</span>);</span><br><span class="line">```cpp</span><br><span class="line"></span><br><span class="line">backtrace</span><br><span class="line"></span><br><span class="line">```cpp</span><br><span class="line"><span class="comment">// Backtrace support</span></span><br><span class="line"><span class="comment">// Loggers can store in a ring buffer all messages (including debug/trace) for later inspection.</span></span><br><span class="line"><span class="comment">// When needed, call dump_backtrace() to see what happened:</span></span><br><span class="line">spdlog::<span class="built_in">enable_backtrace</span>(<span class="number">10</span>); <span class="comment">// create ring buffer with capacity of 10 messages</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">  spdlog::<span class="built_in">debug</span>(<span class="string">&quot;Backtrace message &#123;&#125;&quot;</span>, i); <span class="comment">// not logged..</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// e.g. if some error happened:</span></span><br><span class="line">spdlog::<span class="built_in">dump_backtrace</span>(); <span class="comment">// log them now!</span></span><br></pre></td></tr></table></figure><p>shutdown</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Release all spdlog resources, and drop all loggers in the registry.</span></span><br><span class="line"><span class="comment">// This is optional (only mandatory if using windows + async log).</span></span><br><span class="line">spdlog::<span class="built_in">shutdown</span>();</span><br></pre></td></tr></table></figure><h3 id="logger"><a class="header-anchor" href="#logger">Â¶</a>logger</h3><blockquote><p>Each logger contains a vector of one or more<br><code>std::shared_ptr&lt;spdlog::sink&gt;</code>.</p><p>On each log call (if the log level is right) the logger will call the<br><code>sink(log_msg)</code> function on each of them.</p></blockquote><p>spdlogä¼šé»˜è®¤åˆ›å»ºä¸€ä¸ªå…¨å±€çš„loggerï¼ˆstdoutã€colorã€mtï¼‰ï¼Œç›´æ¥ä½¿ç”¨<code>spdlog::info(..)</code>è°ƒç”¨çš„å°±æ˜¯è¯¥logger</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">spdlog::<span class="built_in">set_default_logger</span>(some_other_logger);</span><br><span class="line">spdlog::<span class="built_in">info</span>(<span class="string">&quot;Use the new default logger&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> console = spdlog::<span class="built_in">stdout_color_mt</span>(<span class="string">&quot;some_unique_name&quot;</span>); <span class="comment">// create logger</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> file_logger = spdlog::<span class="built_in">rotating_logger_mt</span>(<span class="string">&quot;file_logger&quot;</span>, <span class="string">&quot;logs/mylogfile&quot;</span>, <span class="number">1048576</span> * <span class="number">5</span>, <span class="number">3</span>); <span class="comment">// rotate 3ä¸ªæ–‡ä»¶å¾ªç¯log</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> sink = std::<span class="built_in">make_shared</span>&lt;spdlog::sinks::stdout_sink_mt&gt;();</span><br><span class="line"><span class="keyword">auto</span> my_logger= std::<span class="built_in">make_shared</span>&lt;spdlog::logger&gt;(<span class="string">&quot;mylogger&quot;</span>, sink); <span class="comment">// manually,ä¸ä¼šregister</span></span><br><span class="line"></span><br><span class="line">std::vector&lt;spdlog::sink_ptr&gt; sinks;</span><br><span class="line">sinks.<span class="built_in">push_back</span>(std::<span class="built_in">make_shared</span>&lt;spdlog::sinks::stdout_sink_st&gt;());</span><br><span class="line">sinks.<span class="built_in">push_back</span>(std::<span class="built_in">make_shared</span>&lt;spdlog::sinks::daily_file_sink_st&gt;(<span class="string">&quot;logfile&quot;</span>, <span class="number">23</span>, <span class="number">59</span>));</span><br><span class="line"><span class="keyword">auto</span> combined_logger = std::<span class="built_in">make_shared</span>&lt;spdlog::logger&gt;(<span class="string">&quot;name&quot;</span>, <span class="built_in">begin</span>(sinks), <span class="built_in">end</span>(sinks)); <span class="comment">// one log and multiple sink</span></span><br><span class="line"><span class="comment">//register it if you need to access it globally</span></span><br><span class="line">spdlog::<span class="built_in">register_logger</span>(combined_logger);</span><br></pre></td></tr></table></figure><h3 id="sink"><a class="header-anchor" href="#sink">Â¶</a>sink</h3><p>logå’Œsinkéƒ½åˆ†åˆ«ç”±stå’Œmt</p><p>loggerçš„åŠŸèƒ½ç”±sinkå†³å®š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">loggerï¼š</span><br><span class="line">spdlog::rotating_logger_mt</span><br><span class="line">spdlog::daily_logger_mt</span><br><span class="line">spdlog::basic_logger_mt</span><br><span class="line">spdlog::stdout_logger_mt</span><br><span class="line">spdlog::stderr_logger_st</span><br><span class="line">spdlog::stdout_color_mt</span><br><span class="line">spdlog::stderr_color_st</span><br><span class="line">-----------------------</span><br><span class="line">sinkï¼š</span><br><span class="line">exampleï¼šspdlog::sinks::rotating_file_sink_mt</span><br></pre></td></tr></table></figure><h3 id="register"><a class="header-anchor" href="#register">Â¶</a>register</h3><blockquote><p>spdlog maintains a global (per process) registry of the created loggers.</p><p>The purpose is for loggers to be accessed easily from anywhere in the<br>project without passing them around.ï¼ˆé¿å…å‚æ•°ä¼ é€’ï¼‰</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spdlog::<span class="built_in">get</span>(<span class="string">&quot;logger_name&quot;</span>); <span class="comment">// å†…éƒ¨æœ‰lockï¼Œæœ€å¥½ä½¿ç”¨ä¸€ä¸ªå˜é‡ä¿å­˜</span></span><br><span class="line">spdlog::<span class="built_in">register_logger</span>(some_logger);</span><br><span class="line">spdlog::<span class="built_in">drop</span>(<span class="string">&quot;logger_name&quot;</span>);</span><br><span class="line"><span class="comment">//or remove them all</span></span><br><span class="line">spdlog::<span class="built_in">drop_all</span>()</span><br></pre></td></tr></table></figure><h3 id="format"><a class="header-anchor" href="#format">Â¶</a>format</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spdlog::<span class="built_in">set_pattern</span>(<span class="string">&quot;*** [%H:%M:%S %z] [thread %t] %v ***&quot;</span>); <span class="comment">// global to all</span></span><br><span class="line">some_logger-&gt;<span class="built_in">set_pattern</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; %H:%M:%S %z %v &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>);</span><br><span class="line">some_logger-&gt;<span class="built_in">sinks</span>()[<span class="number">0</span>]-&gt;<span class="built_in">set_pattern</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; %H:%M:%S %z %v &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>google benchmark</title>
      <link href="/2022/05/07/google-benchmark/"/>
      <url>/2022/05/07/google-benchmark/</url>
      
        <content type="html"><![CDATA[<h3 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">Â¶</a>å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/google/benchmark.git</span><br><span class="line"><span class="built_in">cd</span> benchmark</span><br><span class="line">cmake -E make_directory <span class="string">&quot;build&quot;</span></span><br><span class="line">cmake -E <span class="built_in">chdir</span> <span class="string">&quot;build&quot;</span> cmake -DBENCHMARK_DOWNLOAD_DEPENDENCIES=on -DCMAKE_BUILD_TYPE=Release ../</span><br><span class="line">cmake --build <span class="string">&quot;build&quot;</span> --config Release</span><br><span class="line"></span><br><span class="line">cmake -E <span class="built_in">chdir</span> <span class="string">&quot;build&quot;</span> ctest --build-config Release</span><br><span class="line"></span><br><span class="line">sudo cmake --build <span class="string">&quot;build&quot;</span> --config Release --target install</span><br></pre></td></tr></table></figure><h3 id="cmake"><a class="header-anchor" href="#cmake">Â¶</a>cmake</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find_package</span>(benchmark REQUIRED)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(xxx</span><br><span class="line">PRIVATE</span><br><span class="line">  benchmark::benchmark</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">Â¶</a>ä½¿ç”¨</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">SomeFunction</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> std::<span class="built_in">max</span>(a, b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">BM_SomeFunction</span><span class="params">(benchmark::State&amp; state)</span> </span>&#123; <span class="comment">// a wrapper</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> _ : state) &#123;</span><br><span class="line">    <span class="built_in">SumeFunction</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">BENCHMARK</span>(BM_SomeFunction);</span><br><span class="line"></span><br><span class="line"><span class="built_in">BENCHMARK_MAIN</span>();</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰mainå‡½æ•°ï¼Œåªéœ€è¦åœ¨æœ€ååŠ ä¸Šä»¥ä¸‹ä¸¤è¡Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">::benchmark::<span class="built_in">Initialize</span>(&amp;argc, argv);</span><br><span class="line">::benchmark::<span class="built_in">RunSpecifiedBenchmarks</span>();</span><br></pre></td></tr></table></figure><p>å®˜æ–¹å¯¹æ•´å‹å˜é‡çš„æ”¯æŒæ¯”è¾ƒå¥½ï¼Œæœ‰å„ç§rangeçš„ä¼ å‚æ–¹å¼ã€‚<br>å¦‚æœéœ€è¦ä¼ å…¥å…¶ä»–å˜é‡ï¼Œéœ€è¦ä½¿ç”¨CAPTUREï¼Œä¼ å‚æ–¹å¼ç±»ä¼¼emplace_backä¹‹ç±»çš„<br>Iterationså¯ä»¥æŒ‡å®šè¿­ä»£æ¬¡æ•°<br>UnitæŒ‡å®šæ—¶é—´å•ä½ï¼ˆé»˜è®¤æ˜¯nsï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BENCHMARK_CAPTURE</span>(BM_xxx, xxx_test, arg)</span><br><span class="line">  -&gt;<span class="built_in">Iterations</span>(<span class="number">5</span>)</span><br><span class="line">  -&gt;<span class="built_in">Unit</span>(benchmark::kMillisecond);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›ºå®šåŒºé—´æœ€å€¼æŸ¥è¯¢</title>
      <link href="/2021/09/28/gu-ding-qu-jian-zui-zhi-cha-xun/"/>
      <url>/2021/09/28/gu-ding-qu-jian-zui-zhi-cha-xun/</url>
      
        <content type="html"><![CDATA[<p>å¯¹äºä¸€ç»´ï¼Œç”¨å•è°ƒé˜Ÿåˆ—å°±å¯ä»¥è§£å†³ã€‚<br>äºŒç»´çš„è¯ï¼Œå…ˆå¯¹æ¯ä¸€åˆ—åšä¸€éï¼Œç„¶åå‹ç¼©æˆä¸€ç»´<br>æ›´é«˜ç»´åŒç†ã€‚ã€‚ã€‚</p><p>è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹å‰kä¼˜æœ€å€¼çš„è®°å½•<br>ä¾‹å¦‚ç°åœ¨è¦æ±‚å›ºå®šåŒºé—´çš„æœ€å°å€¼å’Œæ¬¡å°å€¼ã€‚æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªå•å¢é˜Ÿåˆ—ã€‚æ¯å½“ç§»åŠ¨ræŒ‡é’ˆï¼Œå…ˆç»´æŠ¤ç¬¬ä¸€ä¸ªé˜Ÿåˆ—çš„å•è°ƒæ€§ï¼Œå¼¹å‡ºçš„å…ƒç´ å¡åˆ°ç¬¬äºŒä¸ªé˜Ÿåˆ—ä¸­ã€‚é‚£ä¹ˆæ¬¡å¤§å€¼å°±æ˜¯ç¬¬ä¸€ä¸ªæ ˆä¸­çš„æ¬¡å¤§å€¼æˆ–è€…ç¬¬äºŒä¸ªæ ˆä¸­çš„æœ€å¤§å€¼ã€‚</p><p>å¦å¤–å¯ä»¥é‡‡ç”¨åŒæ ˆæ¨¡æ‹Ÿé˜Ÿåˆ—çš„æ–¹å¼ï¼Œæ ˆä¸­å­˜çš„æ˜¯pair(å½“å‰å…ƒç´ å¤§å°ï¼Œæ ˆåº•åˆ°å½“å‰å…ƒç´ çš„æœ€å°å€¼)ã€‚åŒç†å¯¹äºkå°å€¼åªè¦ä¿®æ”¹secondä¸ºkç»´çš„tupleå³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æåˆæ ‘ï¼ˆpermutation treeï¼‰</title>
      <link href="/2021/09/13/xi-he-shu-permutation-tree/"/>
      <url>/2021/09/13/xi-he-shu-permutation-tree/</url>
      
        <content type="html"><![CDATA[<p>ä»…é™äºè§£å†³<strong>æ’åˆ—</strong>ä¸­ä¸è¿ç»­æ®µç›¸å…³çš„é—®é¢˜ï¼Œå±€é™æ€§æ¯”è¾ƒå¤§ï¼Œè™½ç„¶å¹³å‡¡åºåˆ—ä¹Ÿèƒ½åšï¼Œä½†æ˜¯ä¼šå¤æ‚å¾ˆå¤š<br>ä¸€äº›å®šä¹‰ï¼š<br>æ®µï¼šè¯¥åŒºé—´æ’åºåå€¼åŸŸè¿ç»­<br>æœ¬åŸæ®µï¼šä¸å…¶å®ƒè¿ç»­æ®µåªæœ‰åŒ…å«å’Œç›¸ç¦»çš„å…³ç³»ï¼Œæ²¡æœ‰ç›¸äº¤å…³ç³»<br>å„¿å­æ’åˆ—ï¼šå„ä¸ªå„¿å­ç¦»æ•£åŒ–åçš„ç¼–å·å½¢æˆçš„æ’åˆ—<br>åˆç‚¹ï¼šå„¿å­æ’åˆ—ä¸ºé¡ºåºæˆ–é€†åºï¼ˆå¶å­ä¹Ÿè®¤ä¸ºæ˜¯åˆç‚¹ï¼‰<br>æç‚¹ï¼šä¸æ˜¯åˆç‚¹çš„èŠ‚ç‚¹</p><ul><li>åˆç‚¹çš„å„¿å­åºåˆ—çš„ä»»æ„å­åŒºé—´éƒ½æ˜¯ä¸€ä¸ªè¿ç»­æ®µ</li><li>æç‚¹çš„å„¿å­åºåˆ—çš„ä»»æ„é•¿åº¦å¤§äº1çš„å­åŒºé—´éƒ½ä¸æ˜¯è¿ç»­æ®µï¼ˆå¦åˆ™è¯¥åŒºé—´å°±æ˜¯ä¸€ä¸ªæœ¬åŸæ®µï¼‰</li></ul><p>æåˆæ ‘å°±æ˜¯ç”±è‹¥å¹²æœ¬åŸæ®µæ„æˆï¼Œä¸”æ¯ä¸ªæœ¬åŸæ®µæ˜¯åˆç‚¹å’Œæç‚¹ä¸­çš„ä¸€ç§ã€‚<br>å¢é‡æ„é€ $O(n\log n)$ï¼Œç»´æŠ¤å‰$i$ä¸ªç»“ç‚¹çš„æ ˆï¼Œç„¶åè€ƒè™‘å½“å‰ç»“ç‚¹$P_i$â€‹</p><ol><li>æ ˆé¡¶ä¸ºåˆç‚¹ä¸”å¯ä»¥æˆä¸ºå®ƒçš„å„¿å­</li><li>æ ˆçš„æŸä¸ªåç¼€å¯ä»¥ç”Ÿæˆä¸€ä¸ªåˆç‚¹ä½œä¸ºçˆ¶äº²</li><li>æ ˆçš„æŸä¸ªåç¼€å¯ä»¥ç”Ÿæˆä¸€ä¸ªæç‚¹ä½œä¸ºçˆ¶äº²</li></ol><p>æœ€ä¸»è¦çš„ä¸€ä¸ªè¾…åŠ©å·¥å…·æ˜¯å¿«é€ŸæŸ¥è¯¢$[j,i]$è¿™ä¸ªåŒºé—´æ˜¯å¦æ˜¯è¿ç»­æ®µï¼Œç”±äºæ˜¯æ’åˆ—ï¼Œæ‰€ä»¥åªéœ€è¦æ£€æŸ¥$Q_j=\max\limits_{i\le<br>k\le j}P_k-\min\limits_{i\le k\le j}P_k-(i-j)=<br>0$ï¼Œåˆæ³¨æ„åˆ°$Q_j\ge 0$ï¼Œå› æ­¤ç”¨å•è°ƒæ ˆå’Œçº¿æ®µæ ‘ç»´æŠ¤$Q$ï¼Œå€¼ä¸º0çš„ç‚¹å°±å¯ä»¥ä½œä¸ºè¿ç»­æ®µçš„å·¦ç«¯ç‚¹ã€‚</p><p>ä»£ç è§£é‡Šï¼š<br>èŠ‚ç‚¹æ•°è¦å¼€ä¸¤å€<br>$id_i$â€‹ï¼šè¡¨ç¤ºæ’åˆ—ä¸­ç¬¬$i$ä¸ªæ•°åœ¨æåˆæ ‘ä¸­çš„ç¼–å·<br>$L_i,R_i$â€‹ï¼šç¼–å·ä¸º$i$çš„ç‚¹åœ¨æ’åˆ—ä¸­å¯¹åº”çš„ä¸‹æ ‡èŒƒå›´<br>$SR_i$â€‹ï¼šç¼–å·ä¸º$i$çš„ç‚¹å½“å‰æœ€é å³ï¼ˆæœ€ååŠ å…¥ï¼‰çš„å„¿å­çš„$L$<br>$type_i$â€‹ï¼šç¼–å·ä¸º$i$çš„ç‚¹çš„ç±»å‹ï¼Œ1è¡¨ç¤ºåˆç‚¹ï¼Œ0è¡¨ç¤ºæç‚¹<br>$rt$ï¼šæåˆæ ‘çš„æ ¹èŠ‚ç‚¹<br>$cnt$ï¼šæåˆæ ‘çš„èŠ‚ç‚¹æ•°<br>$askmn$ï¼šå•ç‚¹æŸ¥è¯¢ä¸€ä¸ªç‚¹çš„$Q$ï¼Œç”¨äºæ£€æŸ¥æ˜¯å¦ä¸ºè¿ç»­æ®µ<br>$askpos$ï¼šæ‰¾åˆ°æœ€é å·¦çš„å¯ä»¥ä¸å½“å‰å³ç«¯ç‚¹æ„æˆè¿ç»­æ®µä¸‹æ ‡<br>å¯¹äºå½“å‰ç‚¹$i$ï¼Œå…ˆç»´æŠ¤å¥½$Q$åºåˆ—</p><ol><li>å¦‚æœèƒ½ä¸æ ˆé¡¶æœ€å³çš„å„¿å­å½¢æˆè¿ç»­æ®µå°±ä½œä¸ºå®ƒçš„å„¿å­ï¼ˆæ­¤æ—¶æ ˆé¡¶å¿…ç„¶æ˜¯åˆç‚¹ï¼Œå› ä¸ºæç‚¹ä¸å¯èƒ½æœ‰å­åŒºé—´æ˜¯è¿ç»­æ®µï¼‰</li><li>å¦‚æœèƒ½ä¸æ ˆé¡¶æ„æˆè¿ç»­æ®µï¼Œåˆ™ç”Ÿæˆä¸€ä¸ªåˆç‚¹</li><li>å¦åˆ™å¦‚æœæŸä¸ªåç¼€æ˜¯è¿ç»­æ®µï¼Œå°±ç”Ÿæˆä¸€ä¸ªæç‚¹</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Ptree &#123;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = N&lt;&lt;<span class="number">1</span>, LOG = <span class="number">17</span>;</span><br><span class="line"><span class="type">int</span> id[M], L[M], R[M], SR[M], type[M], rt, cnt;</span><br><span class="line"><span class="type">int</span> stk[M], stk1[M], stk2[M], tp, tp1, tp2;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[M];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; G[x].<span class="built_in">push_back</span>(y); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">    <span class="keyword">while</span>(tp1 &amp;&amp; a[i]&lt;=a[stk1[tp1]]) &#123;</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, stk1[tp1<span class="number">-1</span>]+<span class="number">1</span>, stk1[tp1], a[stk1[tp1]]);</span><br><span class="line">      --tp1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, stk1[tp1]+<span class="number">1</span>, i, -a[i]);</span><br><span class="line">    stk1[++tp1] = i;</span><br><span class="line">    <span class="keyword">while</span>(tp2 &amp;&amp; a[i]&gt;=a[stk2[tp2]]) &#123;</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, stk2[tp2<span class="number">-1</span>]+<span class="number">1</span>, stk2[tp2], -a[stk2[tp2]]);</span><br><span class="line">      --tp2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, stk2[tp2]+<span class="number">1</span>, i, a[i]);</span><br><span class="line">    stk2[++tp2] = i;</span><br><span class="line">    id[i] = ++cnt;</span><br><span class="line">    L[cnt] = R[cnt] = i;</span><br><span class="line">    <span class="type">int</span> pos = <span class="built_in">askpos</span>(<span class="number">1</span>), now = cnt;</span><br><span class="line">    <span class="keyword">while</span>(tp &amp;&amp; L[stk[tp]]&gt;=pos) &#123;</span><br><span class="line">      <span class="keyword">if</span>(type[stk[tp]] &amp;&amp; <span class="built_in">askmn</span>(<span class="number">1</span>, SR[stk[tp]])==<span class="number">0</span>) &#123;</span><br><span class="line">        R[stk[tp]] = i, SR[stk[tp]] = L[now], <span class="built_in">add</span>(stk[tp], now), now = stk[tp--];</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">askmn</span>(<span class="number">1</span>, L[stk[tp]])==<span class="number">0</span>) &#123;</span><br><span class="line">        type[++cnt] = <span class="number">1</span>;</span><br><span class="line">        L[cnt] = L[stk[tp]], R[cnt] = i, SR[cnt] = L[now];</span><br><span class="line">        <span class="built_in">add</span>(cnt, stk[tp--]), <span class="built_in">add</span>(cnt, now);</span><br><span class="line">        now = cnt;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">add</span>(++cnt, now);</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">          <span class="built_in">add</span>(cnt, stk[tp--]);</span><br><span class="line">        &#125; <span class="keyword">while</span>(tp &amp;&amp; <span class="built_in">askmn</span>(<span class="number">1</span>, L[stk[tp]])!=<span class="number">0</span>);</span><br><span class="line">        L[cnt] = L[stk[tp]], R[cnt] = i, <span class="built_in">add</span>(cnt, stk[tp--]);</span><br><span class="line">        now = cnt;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stk[++tp] = now;</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, <span class="number">1</span>, i, <span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  rt = stk[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">//namespace Ptree</span></span><br></pre></td></tr></table></figure><ul><li><p>Codeforces 526F â€“ Pudding Monsters<br>æŸ¥è¯¢ä¸€ä¸ªæ’åˆ—çš„è¿ç»­æ®µä¸ªæ•°ï¼Œæ˜¾ç„¶åªéœ€è¦å®ŒæˆQåºåˆ—çš„ç»´æŠ¤å³å¯</p></li><li><p>CERC 17 Problem I â€“ Instrinsic Interval<br>ç»™å‡ºä¸€ä¸ªæ’åˆ—ï¼Œæ¯æ¬¡æŸ¥è¯¢ç»™å‡º$l,r$ï¼Œé—®ä½ æœ€çŸ­çš„åŒ…å«è¯¥åŒºé—´çš„è¿ç»­æ®µçš„å·¦å³ç«¯ç‚¹<br>æˆ‘ä»¬å…ˆæ±‚å‡ºLCAï¼Œå¦‚æœæ˜¯æç‚¹ï¼Œè¯´æ˜ç­”æ¡ˆåªèƒ½æ˜¯LCAçš„å·¦å³ç«¯ç‚¹ï¼›å¦åˆ™å¯ä»¥åœ¨å„¿å­åºåˆ—ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„åŒ…å«$l,r$çš„å­åŒºé—´ï¼Œå®è´¨ä¸Šåˆ©ç”¨å€å¢è·³åˆ°LCAçš„å„¿å­å³å¯</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hdu 6356 åå‘STè¡¨/çº¿æ®µæ ‘å‰ªæ</title>
      <link href="/2021/09/07/hdu-6536-fan-xiang-st-biao-xian-duan-shu-jian-zhi/"/>
      <url>/2021/09/07/hdu-6536-fan-xiang-st-biao-xian-duan-shu-jian-zhi/</url>
      
        <content type="html"><![CDATA[<p>ç»™å‡ºmæ¬¡åŒºé—´å–maxçš„æ“ä½œ<code>(l,r,v)</code>ï¼Œé—®ä½ æœ€åæ•°ç»„çš„çŠ¶æ€(åˆå§‹å‡ä¸º0)ï¼Œæ“ä½œé€šè¿‡éšæœºçš„æ–¹å¼ç»™å‡ºã€‚</p><p>åŒºé—´å–maxï¼Œå¯ä»¥ç”¨sgbtæ¥åšï¼Œä¸è¿‡æ³¨æ„åˆ°æœ¬é¢˜æ“ä½œéšæœº(æ—¢ç„¶æ˜¯éšæœºç»™å‡ºçš„ï¼Œå¿…ç„¶æœ‰å®ƒçš„ç”¨æ„)ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å‰ªæçš„æ–¹å¼ï¼šç»´æŠ¤åŒºé—´æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œå½“å‰æœ€å¤§å€¼æ¯”vè¿˜å°å°±æ˜¯åŒºé—´è¦†ç›–ï¼Œæœ€å°å€¼æ¯”vè¿˜å¤§å°±ç›´æ¥reutrnã€‚</p><p>æ­¤å¤–è¿˜æœ‰ä¸€ç§åå‘STè¡¨çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¾—åˆ°é«˜å±‚STè¡¨çš„çŠ¶æ€ï¼Œç„¶åå†ä»é«˜åˆ°ä½é€’æ¨å‡ºåº•å±‚çš„çŠ¶æ€å³å¯ã€‚å½“ç„¶è¿™ç§æ–¹å¼æœ‰å¾ˆå¤§çš„é™åˆ¶ï¼Œæ„Ÿè§‰åªé€‚ç”¨äºåŒºé—´å–æœ€å€¼ï¼Œåªæœ‰æœ€åä¸€æ¬¡è¯¢é—®çš„æƒ…å†µã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> uint = <span class="type">uint32_t</span>;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">uint x, y, z, w;</span><br><span class="line"><span class="function">uint <span class="title">rng61</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  x = x^(x&lt;&lt;<span class="number">11</span>);</span><br><span class="line">  x = x^(x&gt;&gt;<span class="number">4</span>);</span><br><span class="line">  x = x^(x&lt;&lt;<span class="number">5</span>);</span><br><span class="line">  x = x^(x&gt;&gt;<span class="number">14</span>);</span><br><span class="line">  w = x^(y^z);</span><br><span class="line">  x = y;</span><br><span class="line">  y = z;</span><br><span class="line">  z = w;</span><br><span class="line">  <span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">Max</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">if</span>(x&lt;y) x = y; &#125;</span><br><span class="line"><span class="type">int</span> st[N][<span class="number">18</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%u%u%u&quot;</span>, &amp;n, &amp;m, &amp;x, &amp;y, &amp;z);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n; j++) st[i][j] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) &#123;</span><br><span class="line">    uint f0 = <span class="built_in">rng61</span>(), f1 = <span class="built_in">rng61</span>(), f2 = <span class="built_in">rng61</span>();</span><br><span class="line">    <span class="type">int</span> l = <span class="built_in">min</span>(f0%n+<span class="number">1</span>, f1%n+<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> r = <span class="built_in">max</span>(f0%n+<span class="number">1</span>, f1%n+<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> v = f2%(<span class="number">1</span>&lt;&lt;<span class="number">30</span>);</span><br><span class="line">    <span class="type">int</span> k = <span class="number">31</span> - __builtin_clz(r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">Max</span>(st[l][k], v);</span><br><span class="line">    <span class="built_in">Max</span>(st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k], v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">16</span>; j&gt;=<span class="number">0</span>; j--)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i+(<span class="number">1</span>&lt;&lt;(j+<span class="number">1</span>))<span class="number">-1</span>&lt;=n; i++) &#123;</span><br><span class="line">      <span class="built_in">Max</span>(st[i][j], st[i][j+<span class="number">1</span>]);</span><br><span class="line">      <span class="built_in">Max</span>(st[i+(<span class="number">1</span>&lt;&lt;j)][j], st[i][j+<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) ans ^= <span class="number">1ll</span>*i*st[i][<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bzoj2724 è’²å…¬è‹± åŒºé—´ä¼—æ•°+å¼ºåˆ¶åœ¨çº¿</title>
      <link href="/2021/09/03/bzoj2724-pu-gong-ying-qu-jian-zhong-shu-qiang-zhi-zai-xian/"/>
      <url>/2021/09/03/bzoj2724-pu-gong-ying-qu-jian-zhong-shu-qiang-zhi-zai-xian/</url>
      
        <content type="html"><![CDATA[<p>å¯ä»¥ç¦»çº¿çš„è¯æ€ä¹ˆåšï¼Ÿ<br>é¦–å…ˆæƒ³åˆ°çš„è‚¯å®šæ˜¯è«é˜Ÿï¼Œä¸è¿‡åˆ é™¤æ“ä½œæœ‰ç‚¹æ£˜æ‰‹ã€‚ç›®å‰åªæœ‰ä¸¤ä¸ªæƒ³æ³•ï¼š1.æ— è„‘ä¸Šå›æ»šè«é˜Ÿã€‚2.å†åŠ ä¸€ä¸ªåˆ†å—æ¥ç»´æŠ¤å‡ºç°æ¬¡æ•°ï¼Œç§»åŠ¨O(1)ï¼ŒæŸ¥è¯¢$O(\sqrt<br>n)$ã€‚ä¸è¿‡æ„Ÿè§‰éƒ½æ²¡æœ‰åœ¨çº¿ç®€å•</p><p>åˆ†å—ä¹‹åï¼Œå¦‚æœç»´æŠ¤çš„ä¿¡æ¯å¯ä»¥é€’æ¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç»´æŠ¤å‡ºä»»æ„ä¸¤ä¸ªå—ä¹‹é—´çš„ä¿¡æ¯ã€‚æœ¬é¢˜å°±æ˜¯ä»»æ„ä¸¤ä¸ªå—ä¹‹é—´çš„ä¼—æ•°ï¼Œè¿™æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œè€Œä¸”æ˜¯$O(\frac{N^2}{B})$çš„ã€‚<br>å¯ä»¥å‘ç°ç­”æ¡ˆè‚¯å®šè¦ä¹ˆæ˜¯ä¸Šé¢è¿™ä¸ªï¼Œè¦ä¹ˆæ˜¯ä¸¤ä¸ªè¾¹ç¼˜å—ä¸­å‡ºç°çš„æ•°å­—ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æšä¸¾è¾¹ç¼˜å—çš„æ•°å­—æ¥è¿›è¡Œæ›´æ–°å³å¯ã€‚ä¸€ç§æ˜¾ç„¶çš„æƒ³æ³•å°±æ˜¯å¯¹æ¯ä¸ªæ•°å­—è¿›è¡ŒäºŒåˆ†æ¥æ±‚è§£å‡ºç°æ¬¡æ•°ï¼Œè¿™æ ·æ˜¯$O(MB\log<br>N)$çš„ï¼Œéœ€è¦å¯¹Bè¿›è¡Œæƒè¡¡ã€‚å¦å¤–ä¸€ç§å¾ˆå¦™çš„æ€è·¯ï¼Œè€ƒè™‘åˆ°ä¸¤ä¸ªè¾¹ç¼˜å—å¯¹ç­”æ¡ˆçš„è´¡çŒ®æœ€å¤šæ˜¯$2B$ï¼Œé‚£æˆ‘ç›´æ¥O(1)å»checkè´¡çŒ®èƒ½ä¸èƒ½å†+1ï¼Œè¿™æ ·å°±æ˜¯$O(MB)$çš„äº†(æ³¨ï¼šMæ˜¯è¯¢é—®æ¬¡æ•°ï¼ŒNæ˜¯æ•°å­—ä¸ªæ•°ï¼ŒBæ˜¯å—å¤§å°ï¼Œæ ¹æ®å‡å€¼ä¸ç­‰å¼ä½¿ä¸¤ä¸ªå¤æ‚åº¦ç›¸ç­‰ï¼Œé€‰æ‹©æœ€ä¼˜çš„Bå³å¯ï¼Œå½“ç„¶å…·ä½“å®ç°æ—¶åªè¦å¤§è‡´ä¼°è®¡ä¸€ä¸ªå¸¸æ•°å³å¯)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">4e4</span> + <span class="number">5</span>, B = <span class="number">250</span>;</span><br><span class="line"><span class="type">int</span> n, m, a[N], v[N], tot;</span><br><span class="line"><span class="type">int</span> f[B][B], g[B][B], cnt[N];</span><br><span class="line"><span class="type">int</span> blo, num, bl[N], l[B], r[B], pos[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lsh</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> tmp[N];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) tmp[i] = a[i];</span><br><span class="line">  <span class="built_in">sort</span>(tmp+<span class="number">1</span>, tmp+n+<span class="number">1</span>);</span><br><span class="line">  tot = <span class="built_in">unique</span>(tmp+<span class="number">1</span>, tmp+n+<span class="number">1</span>) - tmp - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">    <span class="type">int</span> pre = a[i];</span><br><span class="line">    a[i] = <span class="built_in">lower_bound</span>(tmp+<span class="number">1</span>, tmp+tot+<span class="number">1</span>, a[i]) - tmp;</span><br><span class="line">    v[a[i]] = pre;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=tot; i++) cnt[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> y=x; y&lt;=num; y++) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l[y]; i&lt;=r[y]; i++) &#123;</span><br><span class="line">      <span class="type">int</span> cur = a[i];</span><br><span class="line">      cnt[cur]++;</span><br><span class="line">      <span class="keyword">if</span>(!res || cnt[cur]&gt;cnt[res] || (cnt[cur]==cnt[res] &amp;&amp; cur&lt;res)) &#123;</span><br><span class="line">        res = cur;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    f[x][y] = res;</span><br><span class="line">    g[x][y] = cnt[res];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  blo = <span class="built_in">sqrt</span>(n);</span><br><span class="line">  num = (n+blo<span class="number">-1</span>)/blo;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) bl[i] = (i<span class="number">-1</span>)/blo + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=num; i++) l[i] = (i<span class="number">-1</span>)*blo + <span class="number">1</span>, r[i] = i*blo;</span><br><span class="line">  r[num] = n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=num; i++) <span class="built_in">build</span>(i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</span><br><span class="line">    p[a[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    pos[i] = (<span class="type">int</span>)p[a[i]].<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qry</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">  <span class="type">int</span> res = <span class="number">0</span>, cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(bl[x]+<span class="number">1</span>&lt;=bl[y]<span class="number">-1</span>) res = f[bl[x]+<span class="number">1</span>][bl[y]<span class="number">-1</span>], cnt = g[bl[x]+<span class="number">1</span>][bl[y]<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=<span class="built_in">min</span>(r[bl[x]], y); i++) &#123;</span><br><span class="line">    <span class="type">int</span> nxt = (a[i]&lt;res ? cnt : cnt+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span>(pos[i]+nxt<span class="number">-1</span>&lt;(<span class="type">int</span>)p[a[i]].<span class="built_in">size</span>() &amp;&amp; p[a[i]][pos[i]+nxt<span class="number">-1</span>]&lt;=y) &#123;</span><br><span class="line">      res = a[i];</span><br><span class="line">      cnt = nxt++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(bl[x]!=bl[y]) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l[bl[y]]; i&lt;=y; i++) &#123;</span><br><span class="line">      <span class="type">int</span> nxt = (a[i]&lt;res ? cnt : cnt+<span class="number">1</span>);</span><br><span class="line">      <span class="keyword">while</span>(pos[i]-nxt+<span class="number">1</span>&gt;=<span class="number">0</span> &amp;&amp; p[a[i]][pos[i]-nxt+<span class="number">1</span>]&gt;=x) &#123;</span><br><span class="line">        res = a[i];</span><br><span class="line">        cnt = nxt++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="built_in">lsh</span>();</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="type">int</span> lstans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(m--) &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    l = (l + lstans - <span class="number">1</span>)%n + <span class="number">1</span>, r = (r + lstans - <span class="number">1</span>)%n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;r) <span class="built_in">swap</span>(l, r);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, lstans = v[<span class="built_in">qry</span>(l, r)]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°å½•ä¸€ä¸‹å„ç§è½¯ä»¶çš„é…ç½®</title>
      <link href="/2021/08/29/ji-lu-yi-xia-ge-chong-ruan-jian-de-pei-zhi/"/>
      <url>/2021/08/29/ji-lu-yi-xia-ge-chong-ruan-jian-de-pei-zhi/</url>
      
        <content type="html"><![CDATA[<p>ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œç»Ÿä¸€æ”¾åˆ°D:\environmentç›®å½•ä¸‹</p><h2 id="MinGW"><a class="header-anchor" href="#MinGW">Â¶</a>MinGW</h2><p><a href="https://www.jianshu.com/p/ee1ccb0a3062">https://www.jianshu.com/p/ee1ccb0a3062</a> ç…§è¿™ä¸ªåšå³å¯<br>gcc/g++ 8.1.0</p><h2 id="Clangä»¥åŠClangd"><a class="header-anchor" href="#Clangä»¥åŠClangd">Â¶</a>Clangä»¥åŠClangd</h2><p><a href="https://www.cnblogs.com/FrankOu/p/14215850.html">https://www.cnblogs.com/FrankOu/p/14215850.html</a></p><h2 id="sublime-text"><a class="header-anchor" href="#sublime-text">Â¶</a>sublime text</h2><p>sublimeçš„é…è‰²æˆ‘æ¯”è¾ƒå–œæ¬¢ï¼Œè€Œä¸”å¾ˆè½»é‡ï¼Œç”¨äºå†™ä¸€äº›ç®—æ³•ç«èµ›é¢˜å’Œä¸€äº›ç®€å•çš„pythonã€shellè„šæœ¬<br>å®˜ç½‘æœ‰æœ€æ–°çš„4ç‰ˆæœ¬<br>fontsizeæ”¹æˆ10.5å·¦å³æ¯”è¾ƒèˆ’æœ<br>ctrl+x åˆ é™¤å½“å‰è¡Œ<br><a href="https://blog.csdn.net/qq_39599067/article/details/81270330">https://blog.csdn.net/qq_39599067/article/details/81270330</a> ä»£ç ç‰‡æ®µé…ç½®<br><a href="https://jingyan.baidu.com/article/cb5d6105ae0c44005c2fe0f1.html">https://jingyan.baidu.com/article/cb5d6105ae0c44005c2fe0f1.html</a> æ‹¬å·é«˜äº®<br><a href="https://blog.csdn.net/qq_43816826/article/details/108406114">https://blog.csdn.net/qq_43816826/article/details/108406114</a> repl pythonå¿«æ·é”®é…ç½®<br><a href="https://segmentfault.com/a/1190000004463984">https://segmentfault.com/a/1190000004463984</a> AdvancedNewFile<br>c++17 build system<br>ä¼¼ä¹åœ¨c++17ä¸­bits/stdc++.hæœ‰ç‚¹é—®é¢˜ï¼Ÿï¼ˆå½“ç„¶linuxä¸‹æ²¡é—®é¢˜ï¼‰ï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨c++14å§ï¼Œæ‡’å¾—æŠ˜è…¾äº†</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;g++&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-Wall&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-std=c++17&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file_path&#125;/$&#123;file_base_name&#125;&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;file_regex&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^(..[^:]*):([0-9]+):?([0-9]+)?:? (.*)$&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;working_dir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;file_path&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;selector&quot;</span><span class="punctuation">:</span> <span class="string">&quot;source.c, source.c++&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;encoding&quot;</span><span class="punctuation">:</span><span class="string">&quot;cp936&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;variants&quot;</span><span class="punctuation">:</span></span><br><span class="line">  <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RunInCommand&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;cmd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;cmd&quot;</span><span class="punctuation">,</span> <span class="string">&quot;/c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;g++&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-Wall&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-std=c++17&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file_path&#125;/$&#123;file_base_name&#125;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&amp;&amp;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;start&quot;</span><span class="punctuation">,</span> <span class="string">&quot;cmd&quot;</span><span class="punctuation">,</span> <span class="string">&quot;/c&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$&#123;file_path&#125;/$&#123;file_base_name&#125; &amp; echo.&amp;pause&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>file iconæ’ä»¶ï¼šç¾åŒ–ä½œç”¨<br>trailingspaceï¼šæ£€æµ‹è¡Œæœ«å¤šä½™ç©ºæ ¼<br>sublimelinterï¼šé™æ€æ£€æŸ¥<br>sublimelinter-clang<br>clang-formatï¼šæ ¼å¼åŒ–<br>lspï¼šlanguage server port</p><h2 id="typora"><a class="header-anchor" href="#typora">Â¶</a>typora</h2><p>å†™markdown<br>ç›´æ¥ä¸‹è½½å³å¯</p><h2 id="Adobe-Acrobat"><a class="header-anchor" href="#Adobe-Acrobat">Â¶</a>Adobe Acrobat</h2><p>pdf reader</p><h2 id="Velocity"><a class="header-anchor" href="#Velocity">Â¶</a>Velocity</h2><p>ç¦»çº¿æ–‡æ¡£</p><h2 id="DeepL"><a class="header-anchor" href="#DeepL">Â¶</a>DeepL</h2><p>ç¿»è¯‘<br>ctrl+q</p><h2 id="CopyQ"><a class="header-anchor" href="#CopyQ">Â¶</a>CopyQ</h2><p>å‰ªè´´æ¿<br>ctrl+shift+qï¼šå»é™¤æ¢è¡Œç¬¦</p><h2 id="vscode"><a class="header-anchor" href="#vscode">Â¶</a>vscode</h2>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021ä¸­å›½å¤§å­¦ç”Ÿç¨‹åºè®¾è®¡ç«èµ›ï¼ˆCCPCï¼‰- ç½‘ç»œé€‰æ‹”èµ›</title>
      <link href="/2021/08/28/2021-zhong-guo-da-xue-sheng-cheng-xu-she-ji-jing-sai-ccpc-wang-luo-xuan-ba-sai/"/>
      <url>/2021/08/28/2021-zhong-guo-da-xue-sheng-cheng-xu-she-ji-jing-sai-ccpc-wang-luo-xuan-ba-sai/</url>
      
        <content type="html"><![CDATA[<p>hduçš„æœåŠ¡å™¨æœ‰ç‚¹é—®é¢˜ï¼Œä½“éªŒæ¯”è¾ƒå·®<br>æ„Ÿè§‰æ‰“çš„ä¸­è§„ä¸­çŸ©ï¼Œä¸è¿‡èƒ½æ’åˆ°å‰50è¿˜æ˜¯æ¯”è¾ƒæƒŠè®¶ï¼Œä¼°è®¡å—é¢˜ç›®é£æ ¼ä»¥åŠæœåŠ¡å™¨é—®é¢˜çš„å½±å“ã€‚ï¼ˆçœ‹æ¥å¤§éƒ¨åˆ†é˜Ÿä¼å—ç½‘ç»œçš„å½±å“æŒºå¤§çš„ï¼Œè€Œä¸”å¬è¯´æœ‰å¤šé“ç–‘ä¼¼åŸé¢˜ï¼Œè¦é‡èµ›äº†ï¼Œä¸è¿‡ä¹Ÿæ— æ‰€è°“ï¼‰</p><h2 id="1001"><a class="header-anchor" href="#1001">Â¶</a>1001</h2><p>ç®€å•çš„åˆ†ç±»è®¨è®ºï¼Œè§£ä¸ç­‰å¼å³å¯</p><h2 id="1002"><a class="header-anchor" href="#1002">Â¶</a>1002</h2><p>é˜Ÿå‹è¿‡çš„ï¼Œæš´åŠ›</p><h2 id="1006"><a class="header-anchor" href="#1006">Â¶</a>1006</h2><p>æ„é€ é¢˜ï¼Œå‘ç°$x^2+(x+3)^2-(x+1)^2-(x+2)^2=4$åï¼Œæ ¹æ®æ¨¡4çš„å€¼åˆ†åˆ«æ„é€ å³å¯</p><h2 id="1007"><a class="header-anchor" href="#1007">Â¶</a>1007</h2><p>æšä¸¾$g(x)$ï¼Œè½¬æˆäºŒæ¬¡å‡½æ•°ï¼Œå‰©ä¸‹çš„å°±æ˜¯äºŒåˆ†åŠ å–æ•´çš„çç¢é—®é¢˜</p><h2 id="1008"><a class="header-anchor" href="#1008">Â¶</a>1008</h2><p>æˆ‘å…ˆæƒ³äº†ä¸€ä¸ªçœ‹ä¸Šå»å¾ˆå¯è¡Œçš„è§£æ³•ï¼Œä¸è¿‡æœ€åç»Ÿè®¡ç­”æ¡ˆå¤æ‚åº¦ä¼šç‚¸<br>æœ€åé˜Ÿå‹ç»™å‡ºæ­£è§£ï¼Œè€ƒè™‘æ±‚è§£$v(l,r)\leq<br>x$çš„åŒºé—´ä¸ªæ•°ï¼Œä»å¤§åˆ°å°æšä¸¾gcdï¼Œç„¶åæŠ å‡ºæ‰€æœ‰gcdçš„å€æ•°ï¼Œè€ƒè™‘ç›¸é‚»ä¸¤ä¸ªæ•°å½¢æˆçš„åŒºé—´$[L,R]$ï¼Œåˆ™ä»¥$[1,L]$ä¸­çš„ç‚¹ä¸ºå·¦ç«¯ç‚¹æ—¶ï¼Œå³ç«¯ç‚¹å¿…é¡»æ»¡è¶³å°äºRï¼Œæ‰æœ‰å¯èƒ½ä½¿å¾—$v(l,r)\le<br>x$ï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªå‰ç¼€å–minï¼Œæ•´ä½“æ±‚sumçš„segment beatsäº†ã€‚ï¼ˆäº‹å®ä¸Šç”±äºç»´æŠ¤çš„åºåˆ—æ˜¯å•è°ƒçš„ï¼Œä¹Ÿå¯ä»¥äºŒåˆ†+åŒºé—´è¦†ç›–æ¥åšï¼Œ<br><s>ç„¶è€Œæˆ‘å†™Täº†</s> ï¼Œå¯èƒ½æ˜¯æˆ‘å†™æŒ‚äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯å¡äº†3logï¼Œè€Œsgbtæ›´è¶‹è¿‘äºå•ä¸ªlogï¼Œçœ‹äº†é¢˜è§£ï¼Œç›´æ¥åœ¨çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å°±è¡Œäº†ï¼Œæˆ‘åœ¨å¤–é¢å¥—ä¸ªäºŒåˆ†æ˜¯è¯¥tï¼‰</p><h2 id="1009"><a class="header-anchor" href="#1009">Â¶</a>1009</h2><p>å‰ç¼€å’Œ+map ç±»ä¼¼äºæ±‚å¤šå°‘ä¸ªå­åŒºé—´çš„å’Œä¸º0ï¼Œåªä¸è¿‡æ‰©å±•æˆäºŒç»´çš„äº†</p><h2 id="1011"><a class="header-anchor" href="#1011">Â¶</a>1011</h2><p>é˜Ÿå‹è¿‡çš„ï¼Œæ²¡å‚ä¸</p><h2 id="1012"><a class="header-anchor" href="#1012">Â¶</a>1012</h2><p>è€ƒè™‘dpæ¥æ±‚è§£ï¼Œå½“æ±‚è§£å®Œ$dp_x$â€‹ï¼Œæšä¸¾æ‰€æœ‰$p \mid<br>x$ï¼Œè®©$[dp_{x+1},dp_{x+p-1}]$ä¸$dp_x+1$å–minå³å¯ã€‚å®¹æ˜“å‘ç°åªè¦å¯¹æ¯ä¸ªxï¼Œè€ƒè™‘åœ¨è´¨æ•°é›†ä¸­<strong>æœ€å¤§</strong>çš„xçš„å› å­å³å¯ï¼Œåˆå®¹æ˜“å‘ç°è¿™ä¸ª$dp$æ˜¯å•å¢çš„ï¼Œæ‰€ä»¥ä¸æ–­ç»´æŠ¤å½“å‰è¦†ç›–åˆ°çš„æœ€å¤§å³ç«¯ç‚¹å³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨debian8ä¸Šä½¿ç”¨æ”¯æŒc++17çš„g++ç‰ˆæœ¬</title>
      <link href="/2021/06/22/zai-debian8-shang-shi-yong-zhi-chi-c17-de-gban-ben/"/>
      <url>/2021/06/22/zai-debian8-shang-shi-yong-zhi-chi-c17-de-gban-ben/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘è°ƒè¯•ç¼–è¯‘å™¨é‡åˆ°ä¸€ä¸ªæ¯”è¾ƒçŸ›ç›¾çš„äº‹æƒ…ã€‚cppæ–‡ä»¶é€šè¿‡æˆ‘çš„compilerè½¬æˆarmæ±‡ç¼–ï¼Œç„¶åé€šè¿‡qemu-<br>armçš„debianè™šæ‹Ÿæœºä¸Šçš„g++å°†armæ–‡ä»¶æ±‡ç¼–ã€é“¾æ¥åè½¬æˆå¯æ‰§è¡Œæ–‡ä»¶å°±å¯ä»¥è·‘ç»“æœäº†ã€‚<br>ç„¶è€Œæˆ‘çš„compilerç”¨äº†ä¸€äº›c++17çš„ç‰¹æ€§ï¼ˆoptionalã€stringviewï¼‰ï¼Œdebian8æœ€æ–°åªæœ‰g++4.9.2ï¼Œæ²¡æ³•æ”¯æŒc++17ã€‚æˆ‘åªèƒ½åœ¨æœ¬åœ°è½¬æˆarmæ±‡ç¼–å†ä¼ ä¸Šå»æµ‹è¯•ï¼Œæ•ˆç‡å¤ªä½ã€‚æˆ‘æƒ³æŠŠä¸¤ä¸ªè¿‡ç¨‹éƒ½æ”¾åˆ°debianä¸Šï¼Œç„¶åå†™ä¸ªè„šæœ¬ä¸€é”®æµ‹è¯•ã€‚äºæ˜¯æœ‰ä¸¤ç§é€‰æ‹©</p><ul><li>æŠŠä»£ç çš„c++17ç›¸å…³åˆ äº†ğŸ¤¡</li><li>è®©è™šæ‹Ÿæœºæ”¯æŒ-std=c++17</li></ul><p>æ˜¾ç„¶è¿˜æ˜¯è¦åŠªåŠ›è¯•ä¸€ä¸‹åè€…ã€‚<br>çœ‹äº†ä¸€ä¸‹debian9æœ‰g++6ï¼Œdebian10æœ‰g++8ã€‚æˆ‘ä¸€å¼€å§‹ä»¥ä¸ºè¦æŠŠæ•´ä¸ªç³»ç»Ÿéƒ½å‡çº§ï¼Œç»“æœå¤§åŠå¤œè·‘äº†2ä¸ªå°æ—¶è¿˜æ²¡å®Œï¼Œç­‰ä¸äº†å°±ctrl+cäº†ï¼Œç„¶åå‘ç°è™šæ‹Ÿæœºåäº†ï¼Œggã€‚<br>ç¬¬äºŒå¤©é‡ä¸‹äº†è™šæ‹Ÿæœºï¼Œé‡æ–°æ¥è¿‡ã€‚å°è¯•äº†ä¸€ä¸‹ç›´æ¥è£…debian10çš„g++åˆ°debian8ä¸Šã€‚å…·ä½“åšæ³•å°±æ˜¯åœ¨é•œåƒæºé‡ŒåŠ äº†busterï¼Œï¼ˆ8çš„åˆ«åæ˜¯jessieï¼Œ9çš„åˆ«åæ˜¯stretchï¼Œ10çš„åˆ«åæ˜¯busterï¼‰ã€‚ç„¶åapt-<br>get updateï¼Œapt-get install g++ï¼Œå®ƒä¼šè‡ªåŠ¨å¸®ä½ æŠŠå„ç§ä¾èµ–éƒ½å®‰è£…å‡çº§ã€‚<br><img src="/post-images/1624337438397.png" alt=""><br>ç„¶åå°±èƒ½æ„‰å¿«çš„è·‘äº†<br><img src="/post-images/1624337477434.png" alt=""><br><img src="/post-images/1624337482828.png" alt=""><br>æœ€åè®°å¾—apt-get autoremoveæ¸…ç†ä¸‹æ—§ç‰ˆæœ¬</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wsl</title>
      <link href="/2021/04/09/wsl/"/>
      <url>/2021/04/09/wsl/</url>
      
        <content type="html"><![CDATA[<p>wslå’Œvmwareä¹‹é—´åˆ‡æ¢éœ€è¦åœ¨powershellä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¹¶é‡å¯ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /set hypervisorlaunchtype off/auto</span><br></pre></td></tr></table></figure><p>wslä½äº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\è¿™é‡Œæ˜¯ä½ è‡ªå·±çš„userçš„åå­—\AppData\Local\Packages\CanonicalGroupLimited.Ubuntu18.04onWindows_79rhkp1fndgsc\LocalState\rootfs</span><br></pre></td></tr></table></figure><p>é€šè¿‡å¦‚ä¸‹æ–¹å¼å¯ä»¥å°†wslä»cç›˜ç§»åŠ¨åˆ°dç›˜<br><a href="https://blog.csdn.net/w851685279/article/details/108904106?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-1&amp;spm=1001.2101.3001.4242">https://blog.csdn.net/w851685279/article/details/108904106?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-1&amp;spm=1001.2101.3001.4242</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¦ç‘Ÿå¤«ç¯</title>
      <link href="/2021/03/28/yue-se-fu-huan/"/>
      <url>/2021/03/28/yue-se-fu-huan/</url>
      
        <content type="html"><![CDATA[<p>nä¸ªäººï¼ˆç¼–å·ä»0å¼€å§‹ï¼‰ï¼Œä»1å¼€å§‹ä¾æ¬¡æŠ¥æ•°ï¼ŒæŠ¥åˆ°kçš„é‚£ä¸ªäººé€€å‡ºï¼Œå¹¶ç»§ç»­å¾ªç¯æŠ¥æ•°ï¼Œé—®æœ€åå‰©ä¸‹çš„äººçš„ç¼–å·<br>è¿™ä¸ªé—®é¢˜è¿˜æ˜¯è¦ä»é€’å½’çš„è§’åº¦å»è€ƒè™‘<br>è®¾$f_{n-1}$â€‹è¡¨ç¤ºnä¸ªäººæ—¶æœ€åå‰©ä¸‹çš„é‚£ä¸ªäºº<br>é‚£ä¹ˆå¯¹äºnä¸ªäººçš„æƒ…å†µï¼Œç¬¬ä¸€ä¸ªå‡ºå±€çš„äººæ˜¯k-1ï¼Œä¹‹åå°±ç›¸å½“äºæ˜¯ä»kå¼€å§‹çš„n-1ä¸ªäººçš„çº¦ç‘Ÿå¤«ç¯é—®é¢˜<br>æ‰€ä»¥å¾ˆå®¹æ˜“å¾—åˆ°é€’æ¨å¼$f_n = (f_{n-1} + k)%n$<br>åŒæ ·çš„å¦‚æœè¦æ±‚ç¬¬mä¸ªå‡ºå±€çš„äººï¼Œä¹Ÿå¯ä»¥ç”¨ä¸Šè¿°å…¬å¼$f_{n,m}=(f_{n-1,m-1}+k)%n$<br>å¯¹äº$k \ll n$çš„æƒ…å†µï¼Œè€ƒè™‘$f_{i+x-1}=(f_{i-1}+x*k)%(i+x-1)$ï¼Œå½“$f_{i-1}+x*k\leq i+x-1$æ—¶ä¸ä¼šå–æ¨¡ï¼Œæ‰€ä»¥å¿«é€Ÿé€’æ¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">J</span><span class="params">(ll n, ll k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(k==<span class="number">1</span>) <span class="keyword">return</span> n;</span><br><span class="line">  ll ans = <span class="number">0</span>, i = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=n)</span><br><span class="line">  &#123;</span><br><span class="line">    ll cnt = (i-ans<span class="number">-2</span>)/(k<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span>(!cnt)</span><br><span class="line">    &#123;</span><br><span class="line">      ans = (ans + k)%i;</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(i+cnt&gt;n)</span><br><span class="line">      &#123;</span><br><span class="line">        ans = (ans + k*(n-i+<span class="number">1</span>))%n;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        i += cnt;</span><br><span class="line">        ans = (ans + k*cnt)%i;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–å¯¹äºk=2çš„ç‰¹æ®Šæƒ…å†µï¼Œå¯ä»¥è€ƒè™‘å½“nä¸º2çš„å¹‚æ¬¡çš„æ—¶å€™ç­”æ¡ˆå°±æ˜¯1ï¼Œæ‰€ä»¥å½“nä¸º$2^x+y$çš„å½¢å¼æ—¶ï¼Œç­”æ¡ˆä¸º$2*y+1$</p><p>æ±‚ç¬¬xä¸ªäººæ˜¯ç¬¬å‡ ä¸ªæ­»çš„ï¼ˆ0ä¸‹æ ‡ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll n, ll k, ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(n)</span><br><span class="line">  &#123;</span><br><span class="line">    x = (x+n)%n;</span><br><span class="line">    <span class="keyword">if</span>(k&gt;n) x += (k-x<span class="number">-1</span>+n<span class="number">-1</span>)/n*n;</span><br><span class="line">    <span class="keyword">if</span>((x+<span class="number">1</span>)%k==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ans += (x+<span class="number">1</span>)/k;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(k&gt;n)</span><br><span class="line">      &#123;</span><br><span class="line">        ans += x/k;</span><br><span class="line">        ll tmp = x;</span><br><span class="line">        x = x-(x/n+<span class="number">1</span>)*(x/k)+(x+n)/n*n-k;</span><br><span class="line">        n -= tmp/k;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        ans += n/k;</span><br><span class="line">        x = x-x/k;</span><br><span class="line">        x += n-n/k*k;</span><br><span class="line">        n -= n/k;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1-k bfs</title>
      <link href="/2021/03/24/1-k-bfs/"/>
      <url>/2021/03/24/1-k-bfs/</url>
      
        <content type="html"><![CDATA[<p>è€ƒè™‘ä¸€ä¸ªå•æºæœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œä½†æ˜¯å›¾çš„è¾¹æƒèŒƒå›´æ˜¯1-kï¼Œkä¸å¤§ï¼Œé‚£å°±å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•<br>æœ¬è´¨ä¸Šåœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­åŒæ—¶æœ€å¤šåªæœ‰k+1ç§ä¸åŒçš„disçš„å–å€¼ï¼Œå› æ­¤åªéœ€è¦ç”¨k+1ä¸ªé˜Ÿåˆ—æ¥ç»´æŠ¤å³å¯ï¼Œå½“å‰é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œå°±å¾ªç¯ç§»ä½æ‰¾åˆ°ä¸‹ä¸€ä¸ªéç©ºçš„é˜Ÿåˆ—å³å¯<br>å¤æ‚åº¦ä¸º$O(nk+m)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">queue&lt;<span class="type">int</span>&gt; q[K+<span class="number">1</span>];</span><br><span class="line">q[<span class="number">0</span>].<span class="built_in">push</span>(s);</span><br><span class="line">d[s] = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> idx = <span class="number">0</span>, inq = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(inq&gt;<span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">while</span>(q[idx].<span class="built_in">empty</span>()) idx = (idx+<span class="number">1</span>)%(k+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> u = q[idx].<span class="built_in">front</span>(); q[dx].<span class="built_in">pop</span>();</span><br><span class="line">  inq--;</span><br><span class="line">  <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">  vis[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u]) &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(d[v]&gt;d[u]+w) &#123;</span><br><span class="line">      d[v] = d[u] + w;</span><br><span class="line">      q[d[v]%(k+<span class="number">1</span>)].<span class="built_in">push</span>(v);</span><br><span class="line">      ++inq;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‹Ÿé˜µ</title>
      <link href="/2021/03/22/ni-zhen/"/>
      <url>/2021/03/22/ni-zhen/</url>
      
        <content type="html"><![CDATA[<p>$M(S,I)$è¡¨ç¤ºä¸€ä¸ªæ‹Ÿé˜µï¼Œå…¶ä¸­Iæ˜¯Sçš„æŸäº›å­é›†çš„é›†åˆï¼Œæ»¡è¶³è¿™äº›å­é›†åœ¨æŸç§å®šä¹‰ä¸‹æ˜¯ç‹¬ç«‹çš„<br>ä¸€ä¸ªæ‹Ÿé˜µMéœ€è¦æ»¡è¶³å¦‚ä¸‹ä¸‰ä¸ªæ€§è´¨ï¼š</p><ul><li>ç©ºé›†å±äºI</li><li>è‹¥é›†åˆAå±äºIï¼Œåˆ™Açš„ä»»æ„ä¸€ä¸ªå­é›†ä¹Ÿå±äºIï¼ˆé—ä¼ æ€§ï¼‰</li><li>è‹¥é›†åˆAå±äºIï¼Œä»»æ„ä¸€ä¸ªsizeå¤§äºAçš„å±äºIçš„é›†åˆBä¸­æ€»èƒ½æ‰¾åˆ°å…ƒç´ åŠ å…¥Aï¼Œä½¿å…¶ä»åœ¨Iä¸­ï¼ˆäº¤æ¢æ€§ï¼‰</li></ul><p>æ»¡è¶³ä»¥ä¸Šå®šä¹‰çš„æœ€å¥½çš„è§£é‡Šä¾‹å­å°±æ˜¯çº¿æ€§æ— å…³å‘é‡ç»„ã€‚<br>åŸºï¼šæœ€å¤§ç‹¬ç«‹é›†ï¼Œå³Iä¸­sizeæœ€å¤§çš„é‚£ä¸ªå­é›†<br>ç¯ï¼šæœ€å°çš„éç‹¬ç«‹é›†ï¼Œå»æ‰ä»»æ„å…ƒç´ åå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹é›†</p><p>å…¸å‹çš„æ‹Ÿé˜µï¼š</p><ul><li>uniform matroidï¼šsize$\leq k$çš„å­é›†</li><li>linear matroidï¼šçº¿æ€§æ— å…³çš„å­é›†</li><li>colorful matroidï¼šæ¯ä¸ªå…ƒç´ æœ‰ä¸€ç§é¢œè‰²ï¼Œå¦‚æœä¸€ä¸ªé›†åˆä¸­æ‰€æœ‰å…ƒç´ é¢œè‰²å„ä¸ç›¸åŒå°±ç‹¬ç«‹</li><li>graphic matroidï¼šæ¯ä¸ªå…ƒç´ æ˜¯ä¸€æ¡è¾¹ï¼Œä¸€ä¸ªé›†åˆä¸­çš„è¾¹æ²¡æœ‰ç¯å°±ç‹¬ç«‹</li><li>ä¸Šä¸€ä¸ªæ‹Ÿé˜µçš„å¯¹å¶æ‹Ÿé˜µï¼šå¯¹äºä¸€ä¸ªé›†åˆï¼Œä¿ç•™åœ¨Sä¸­ä¸”ä¸åœ¨è¯¥é›†åˆä¸­çš„æ‰€æœ‰è¾¹åï¼Œæ•´ä¸ªå›¾è¿é€šåˆ™ç‹¬ç«‹ã€‚æ³¨ï¼šå¿…é¡»æ˜¯åˆ è¾¹ï¼Œå¦‚æœæ˜¯è€ƒè™‘é›†åˆä¸­çš„è¾¹è¿é€šçš„è¯ï¼Œæ˜¾ç„¶ä¸æ»¡è¶³é—ä¼ æ€§ã€‚</li></ul><p>æ‹Ÿé˜µäº¤<br>è€ƒè™‘ç°åœ¨æœ‰ä¸¤ä¸ªæ‹Ÿé˜µï¼ˆå…¶ä¸­çš„ä¸€ä¸ªç‹¬ç«‹é›†æœ¬è´¨ä¸Šå°±ä»£è¡¨ç€æ»¡è¶³äº†æŸç§çº¦æŸçš„é›†åˆï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ±‚åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ‹Ÿé˜µçš„çº¦æŸæ¡ä»¶ä¸‹çš„æœ€å¤§ç‹¬ç«‹é›†ï¼Œè¿™æ—¶å€™å°±è¦ç”¨åˆ°æ‹Ÿé˜µäº¤äº†ã€‚<br>è¯¥ç®—æ³•çš„æµç¨‹æ˜¯ä¸æ–­ç»´æŠ¤å½“å‰çš„å…±åŒç‹¬ç«‹é›†Iï¼Œç„¶åå°è¯•åŠ å…¥ä¸€ä¸ªæ–°çš„å…ƒç´ sï¼š<br>å®šä¹‰ä¸€ç§äº¤æ¢å›¾ï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªå…ƒç´ xï¼Œyï¼Œè‹¥æ»¡è¶³$x\in I, y \notin<br>I,I-\{x\}+\{y\}\in<br>{I_1}$â€‹ï¼Œå°±ä»xå‘yè¿ä¸€æ¡æœ‰å‘è¾¹ï¼›è‹¥æ»¡è¶³$x\in I, y<br>\notin I,I-\{x\}+\{y\}\in<br>{I_2}$â€‹ï¼Œå°±ä»yå‘xè¿ä¸€æ¡æœ‰å‘è¾¹ã€‚ç®€å•è¯´æ¥å°±æ˜¯å¦‚æœæŠŠIä¸­çš„æŸä¸ªå…ƒç´ xæ›¿æ¢æˆæ²¡æœ‰é€‰çš„æŸä¸ªå…ƒç´ yåï¼Œå¦‚æœè¯¥ç‹¬ç«‹é›†ç¬¦åˆ$I_1$â€‹çš„å®šä¹‰ï¼Œå°±åŠ ä¸€æ¡$x\rightarrow<br>y$çš„è¾¹ï¼Œå¦‚æœç¬¦åˆ$I_2$â€‹çš„å®šä¹‰ï¼Œå°±åŠ ä¸€æ¡$x \leftarrow y$çš„è¾¹ã€‚<br>å¯¹äºæ‰€æœ‰ä¸åœ¨Iä¸­çš„å…ƒç´ xï¼Œè‹¥$I+\{x\}\in I_1$â€‹ï¼Œåˆ™æºç‚¹Så‘å…¶è¿è¾¹<br>å¯¹äºæ‰€æœ‰ä¸åœ¨Iä¸­çš„å…ƒç´ xï¼Œè‹¥$I+\{x\}\in I_2$â€‹ï¼Œåˆ™å…¶å‘æ±‡ç‚¹Tè¿è¾¹<br>ç„¶åä»Så‘Tè·‘ä¸€é<strong>æœ€çŸ­è·¯</strong>ï¼Œå¦‚æœæœ‰è¿™æ ·çš„è·¯å¾„å°±æŠŠè·¯å¾„ä¸Šçš„æ‰€æœ‰å…ƒç´ çš„çŠ¶æ€å–åï¼ˆå¯¹ç§°å·®ï¼‰<br>ä¸Šè¿°è¿‡ç¨‹ç§°ä¸ºä¸€æ¬¡å¢å¹¿<br>ä¸æ–­è¿›è¡Œå¢å¹¿æ“ä½œå°±å¯ä»¥å¾—åˆ°æœ€å¤§ç‹¬ç«‹é›†äº†<br>å¤æ‚åº¦ä¸º$O(r^2n(C_1+C_2))$ï¼Œå…¶ä¸­rä¸ºç§©ï¼Œ$C_1$â€‹å’Œ$C_2$â€‹åˆ†åˆ«è¡¨ç¤ºM1å’ŒM2æ£€æŸ¥å½“å‰é›†åˆæ˜¯å¦ä¸ºç‹¬ç«‹é›†çš„è°ƒç”¨æ¬¡æ•°<br>å†è€ƒè™‘å¦‚æœæ¯ä¸ªå…ƒç´ æ˜¯å¸¦æƒçš„è¯ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚æœä¸€ä¸ªå…ƒç´ å½“å‰åœ¨Iï¼Œå°±æŠŠå®ƒçš„æƒå€¼å®šä¸º$-w$ï¼Œå¦åˆ™å®šä¸º$w$ï¼Œç„¶åè·‘æœ€é•¿è·¯å°±å¯ä»¥å¾—åˆ°æœ€å¤§æƒç‹¬ç«‹é›†äº†ã€‚<br>ä¸Šè¿°ç®—æ³•çš„ä¸€ä¸ªç“¶é¢ˆå…¶å®æ˜¯åœ¨æ£€æŸ¥æ˜¯å¦ä¸ºç‹¬ç«‹é›†ä¸Šï¼Œè¿™ç‚¹ä¸€å®šè¦ä»”ç»†å®ç°ã€‚è¦æ”¯æŒåŠ å…¥ä¸€ä¸ªå…ƒç´ åˆ¤æ–­æ˜¯å¦è¿˜æ˜¯ç‹¬ç«‹é›†ï¼Œåˆ é™¤ä¸€ä¸ªå…ƒç´ å¹¶åŠ å…¥ä¸€ä¸ªå…ƒç´ åˆ¤æ–­æ˜¯å¦æ˜¯ç‹¬ç«‹é›†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">aug</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> S = n, T = n + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="keyword">if</span>(in[i])</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;n; j++) <span class="keyword">if</span>(!in[j])</span><br><span class="line">    &#123;</span><br><span class="line">      in[i] = <span class="number">0</span>, in[j] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span>(m1.<span class="built_in">check</span>(in)) G[i].<span class="built_in">push_back</span>(j);</span><br><span class="line">      <span class="keyword">if</span>(m2.<span class="built_in">check</span>(in)) G[j].<span class="built_in">push_back</span>(i);</span><br><span class="line">      in[i] = <span class="number">1</span>, in[j] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="keyword">if</span>(!in[i])</span><br><span class="line">  &#123;</span><br><span class="line">    in[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(m1.<span class="built_in">check</span>(in)) G[S].<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">if</span>(m2.<span class="built_in">check</span>(in)) G[i].<span class="built_in">push_back</span>(T);</span><br><span class="line">    in[i] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dis</span><span class="params">(n+<span class="number">2</span>, -inf)</span>, <span class="title">pre</span><span class="params">(n+<span class="number">2</span>)</span>, <span class="title">inq</span><span class="params">(n+<span class="number">2</span>)</span></span>;</span><br><span class="line">  queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(S), dis[S] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    inq[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(u&lt;n) cost = in[u] ? -w[u] : w[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(dis[v]&lt;dis[u]+cost)</span><br><span class="line">      &#123;</span><br><span class="line">        dis[v] = dis[u] + cost;</span><br><span class="line">        pre[v] = u;</span><br><span class="line">        <span class="keyword">if</span>(!inq[v]) q.<span class="built_in">push</span>(v), inq[v] = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(pre[T]==<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> x=pre[T]; x!=S; x=pre[x]) in[x] ^= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nä¸ªæ•°ï¼Œæ¯ä¸ªæ•°å¯ä»¥ä»»æ„+1,-1</title>
      <link href="/2021/03/18/n-ge-shu-mei-ge-shu-ke-yi-ren-yi-1-1/"/>
      <url>/2021/03/18/n-ge-shu-mei-ge-shu-ke-yi-ren-yi-1-1/</url>
      
        <content type="html"><![CDATA[<h2 id="å˜æˆéé™åºåˆ—çš„æœ€å°ä»£ä»·"><a class="header-anchor" href="#å˜æˆéé™åºåˆ—çš„æœ€å°ä»£ä»·">Â¶</a>å˜æˆéé™åºåˆ—çš„æœ€å°ä»£ä»·</h2><p>æ˜¾ç„¶å¯¹äºç¬¬iä¸ªæ•°å¦‚æœè¦å˜å°±å˜æˆä¹‹å‰å·²ç»å‡ºç°è¿‡çš„æ•°ï¼Œæ‰€ä»¥ç¦»æ•£åŒ–ådpå³å¯ï¼Œ$O(n^2)$<br>è€ƒè™‘å½“å‰æ•°yï¼Œä»¥åŠä¹‹å‰çš„æœ€å¤§å€¼xï¼Œå¦‚æœ$y\lt x$ï¼Œæ­¤æ—¶éœ€è¦å°†xå˜å°ï¼Œyå˜å¤§ï¼Œå®¹æ˜“å‘ç°ä¸ç®¡æ€ä¹ˆè°ƒæ•´ä»£ä»·éƒ½æ˜¯$y-x$ï¼Œè¿™è¾¹çš„ç­–ç•¥æ˜¯ç›´æ¥æŠŠyå˜æˆxã€‚<br>è€ƒè™‘yä¹‹å‰çš„æœ€å¤§å€¼zï¼Œå¦‚æœ$z\leq x$ï¼Œæ˜¾ç„¶æ²¡æœ‰é—®é¢˜ï¼Œå¦åˆ™æˆ‘ä»¬ä¹Ÿä¸ç”¨å…³å¿ƒæ”¹æˆäº†ä»€ä¹ˆï¼Œå› ä¸ºç°åœ¨æœ€å¤§å€¼å˜æˆäº†zï¼Œé‚£å°±å°½å¯èƒ½å‡å°<br>æ‰€ä»¥ç”¨ä¸€ä¸ªå¤§æ ¹å †ï¼Œå¦‚æœå½“å‰æ•°å°äºå †é¡¶ï¼Œå°±æŠŠå †é¡¶å˜æˆå½“å‰æ•°</p><h2 id="å˜æˆä¸¥æ ¼é™åºåˆ—"><a class="header-anchor" href="#å˜æˆä¸¥æ ¼é™åºåˆ—">Â¶</a>å˜æˆä¸¥æ ¼é™åºåˆ—</h2><p>å¯¹æ¯ä¸ªæ•°å‡å»ä¸‹æ ‡åï¼Œå¥—ç”¨ä¸Šé¢çš„åšæ³•ï¼Œä¸€ä¸ªå°trick</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒæ ˆæ¨¡æ‹Ÿé˜Ÿåˆ—</title>
      <link href="/2021/03/12/shuang-zhan-mo-ni-dui-lie/"/>
      <url>/2021/03/12/shuang-zhan-mo-ni-dui-lie/</url>
      
        <content type="html"><![CDATA[<h2 id="æ™®é€šé˜Ÿåˆ—"><a class="header-anchor" href="#æ™®é€šé˜Ÿåˆ—">Â¶</a>æ™®é€šé˜Ÿåˆ—</h2><p>æ”¯æŒpushå’Œpopæ“ä½œ</p><p>ä½¿ç”¨ä¸¤ä¸ªå¯¹é¡¶æ ˆstk1å’Œstk2ï¼Œpushæ“ä½œå°±ç›´æ¥åŠ åˆ°stk2çš„å°¾éƒ¨ï¼Œpopæ“ä½œå°±ä»stk1ä¸­å¼¹å‡ºï¼Œå¦‚æœstk1ä¸ºç©ºï¼Œå°±æŠŠstk2ä¸­çš„æ‰€æœ‰å…ƒç´ ä¾æ¬¡popåpushå…¥stk1</p><h2 id="åŒç«¯é˜Ÿåˆ—"><a class="header-anchor" href="#åŒç«¯é˜Ÿåˆ—">Â¶</a>åŒç«¯é˜Ÿåˆ—</h2><p>æ”¯æŒpush_frontã€push_backã€pop_frontã€pop_backæ“ä½œ</p><p>åŒæ ·ç”¨ä¸¤ä¸ªå¯¹é¡¶æ ˆæ¥å®ç°ï¼Œä½†æ˜¯å¦‚æœpop_frontå’Œpop_backæ“ä½œäº¤æ›¿è¿›è¡Œï¼Œä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•å°±ä¼šTLEã€‚è€ƒè™‘å‡æ‘Šçš„æ€æƒ³ï¼Œå¦‚æœåœ¨popæ—¶è¯¥æ ˆç©ºäº†ï¼Œå°±æŠŠå¦ä¸€ä¸ªæ ˆæ ˆåº•çš„$\frac<br>n2$â€‹ä¸ªå…ƒç´ pushè¿‡å»</p><h2 id="æ‘Šè¿˜"><a class="header-anchor" href="#æ‘Šè¿˜">Â¶</a>æ‘Šè¿˜</h2><p>è€ƒè™‘ç°åœ¨æ€»å…±æœ‰nä¸ªç‰©å“ï¼Œç„¶ååœ¨mä¸ªä½ç½®å¯èƒ½ä¼šæ¶ˆè€—ç‰©å“ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™nä¸ªç‰©å“å‡åˆ†åˆ°è¿™mä¸ªä½ç½®ï¼Œå¦‚æœæŸä¸ªä½ç½®çš„ç‰©å“è¢«æ¶ˆè€—å®Œè¯´æ˜ç‰©å“æ•°è‡³å°‘å‡å°‘äº†$\frac<br>1m$â€‹ï¼Œä¹‹åæˆ‘ä»¬ç»Ÿè®¡å½“å‰ç‰©å“çš„æ•°é‡åå†è¿›è¡Œå‡åˆ†ã€‚<br>$T(n)=T(\frac{n(m-1)}{m})+O(n)$<br>$T(n)=O(n)$</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº³ä»€å‡è¡¡</title>
      <link href="/2021/03/08/na-shi-jun-heng/"/>
      <url>/2021/03/08/na-shi-jun-heng/</url>
      
        <content type="html"><![CDATA[<p>ç”²ä¹™ä¸¤äººè¿›è¡Œä¸€ä¸ªåšå¼ˆï¼Œæœ‰Aã€Bä¸¤ç§é€‰æ‹©ï¼Œè€Œä»–ä»¬çš„ç»„åˆé€‰æ‹©ä¼šå¯¹åº”æŸç§æ”¶ç›Šï¼ˆåŒæ–¹å‡çŸ¥é“è¿™äº›ç»„åˆé€‰æ‹©çš„åæœï¼‰ï¼Œè€Œæ¯ä¸ªäººä¸çŸ¥é“å¯¹æ–¹å¦‚ä½•é€‰æ‹©ï¼Œæ‰€ä»¥æ¯ä¸ªäººä¼šé€‰æ‹©è‡ªå·±æœŸæœ›æ„ä¹‰ä¸‹æœ‰æœ€å¤§æ”¶ç›Šçš„é‚£ä¸ªï¼ˆå³å¯¹æ–¹é€‰Aæˆ–é€‰Bä¸¤ç§æƒ…å†µç»¼åˆä¹‹ä¸‹ï¼‰ã€‚<br>ç°åœ¨ç«™åœ¨ç”²çš„è§’åº¦å»è€ƒè™‘ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li>ä¹™é€‰Açš„æ—¶å€™æˆ‘é€‰Aæ¯”Bæ›´ä¼˜ï¼Œä¹™é€‰Bçš„æ—¶å€™æˆ‘é€‰Aè¿˜æ˜¯æ¯”Bæ›´ä¼˜ï¼Œé‚£ä¹ˆæ¯«æ— ç–‘é—®æˆ‘ä¼šé€‰æ‹©A</li><li>åŒç†å¯èƒ½é€‰æ‹©Bå®Œå…¨ä¼˜äºé€‰æ‹©A</li></ul><p>åŒæ ·çš„ï¼Œç«™åœ¨ä¹™çš„è§’åº¦ä¹Ÿä¼šå‡ºç°è¿™ä¸¤ç§æƒ…å†µã€‚æ­¤æ—¶å¦å¤–ä¸€è€…èƒ½å¤Ÿæƒ³åˆ°å¯¹æ–¹çš„é€‰æ‹©ï¼Œè€Œè‡ªå·±åªèƒ½åœ¨è¿™ä¸ªå‰æä¸‹é€‰æ‹©æ›´ä¼˜çš„ä¸€ç§<br>å½“ç„¶ä¹Ÿå¯èƒ½å‡ºç°ï¼ŒæŸç§æƒ…å†µä¸‹Aä¼˜ï¼ŒæŸç§æƒ…å†µä¸‹Bä¼˜ï¼Œè¿™æ—¶å€™å°±æ¶‰åŠåˆ°ä¸€ç§æ··åˆç­–ç•¥ï¼Œå‡è®¾æˆ‘æœ‰pçš„æ¦‚ç‡é€‰æ‹©Aï¼Œ(1-p)çš„æ¦‚ç‡é€‰æ‹©Bï¼Œä¸ºäº†åˆ©ç›Šæœ€å¤§åŒ–ï¼Œé‚£ä¹ˆæˆ‘è¦ä½¿å¾—å¯¹æ–¹åœ¨é€‰Aæˆ–é€‰Bçš„æ—¶å€™è‡ªå·±æœŸæœ›å¾—åˆ°çš„æ”¶ç›Šç›¸åŒï¼Œå³$pV(A,<br>A) + (1-p)V(B, A) = pV(A, B) + (1-p)V(B,<br>B)$</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨dpè§£å†³å„ä¸ªæœ¬è´¨ä¸åŒæ–¹æ¡ˆçš„å¹³æ–¹å’Œ</title>
      <link href="/2021/03/05/li-yong-dp-jie-jue-ge-ge-ben-zhi-bu-tong-fang-an-de-ping-fang-he/"/>
      <url>/2021/03/05/li-yong-dp-jie-jue-ge-ge-ben-zhi-bu-tong-fang-an-de-ping-fang-he/</url>
      
        <content type="html"><![CDATA[<p>å‰æï¼šå¦‚æœåªæ˜¯ç®€å•çš„æ±‚å’Œï¼Œå¯ä»¥åˆ©ç”¨dp[s]æ¥è§£å†³<br>é‚£ä¹ˆå†åŠ ä¸€ç»´ï¼Œdp[s1][s2]ï¼Œç„¶ååœ¨è½¬ç§»çš„æ—¶å€™å½“ä¸”ä»…å½“ä¸‹ä¸€ä¸ªçŠ¶æ€ä¸¤è€…ç›¸åŒæ‰è½¬ç§»ï¼Œè¿™æ ·å¾—åˆ°çš„ç»“æœå°±æ˜¯å¹³æ–¹å’Œï¼Œå¯ä»¥å‘ç°è¿™å®é™…ä¸Šæ˜¯åœ¨å¯¹s1å’Œs2è¿™ä¸¤ç§çŠ¶æ€ä½œåŒ¹é…ï¼Œå¦‚æœæŸç§çŠ¶æ€æœ‰xä¸ªï¼Œé‚£ä¹ˆè¿™ä¸¤è€…ä¹‹é—´å°±ä¼šåŒ¹é…$x^2$æ¬¡<br>åŒç†ï¼Œç»§ç»­åŠ ç»´ï¼Œå¯ä»¥å¾—åˆ°æ›´é«˜æ¬¡æ–¹å’Œçš„ç»“æœ</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒºé—´kæ¬¡è¦†ç›– è´¹ç”¨æµæ¨¡å‹</title>
      <link href="/2021/02/28/qu-jian-k-ci-fu-gai-fei-yong-liu-mo-xing/"/>
      <url>/2021/02/28/qu-jian-k-ci-fu-gai-fei-yong-liu-mo-xing/</url>
      
        <content type="html"><![CDATA[<p>å„å‡ºnä¸ªå¸¦æƒåŒºé—´ï¼Œè®©ä½ ä¿ç•™æœ€å¤šçš„åŒºé—´ï¼Œä½¿å¾—æ•°è½´ä¸Šçš„æ¯ä¸ªç‚¹æœ€å¤šè¢«è¦†ç›–äº†kæ¬¡</p><p>å»ºç«‹è¶…æº0ï¼Œè¶…æ±‡maxv+1<br>iå’Œi+1è¿ä¸€æ¡è´¹ç”¨ä¸º0ï¼Œæµé‡ä¸ºkçš„è¾¹<br>å¯¹äºæ¯ä¸ªåŒºé—´ï¼Œså‘t+1è¿ä¸€æ¡è´¹ç”¨ä¸º-wï¼Œæµé‡ä¸º1çš„è¾¹<br>è·‘ä¸€éæœ€å°è´¹ç”¨æµå³å¯<br>å®¹æ˜“å‘ç°è¿™ä¸ªå›¾æ˜¯ä¸ªdagï¼Œå¯ä»¥ç›´æ¥dpæ±‚å‡ºåŠ¿èƒ½håè·‘dijkstra</p><p>gym102759F<br>åŒºé—´2æ¬¡è¦†ç›–æ¿å­ï¼Œå¡äº†spfa</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">namespace</span> MCMF</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>, M = <span class="number">1e6</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;</span><br><span class="line">  <span class="type">const</span> ll linf = <span class="number">1e18</span>;</span><br><span class="line">  <span class="type">int</span> cnt, head[N];</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> next, to, w;</span><br><span class="line">    ll f;</span><br><span class="line">  &#125;e[M&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w, ll f)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    e[++cnt] = &#123;head[u], v, w, f&#125;;</span><br><span class="line">    head[u] = cnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> n, s, t;</span><br><span class="line">  <span class="type">int</span> flow;</span><br><span class="line">  <span class="type">int</span> p[N], a[N];</span><br><span class="line">  ll d[N], h[N], cost;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> _n, <span class="type">int</span> _s, <span class="type">int</span> <span class="type">_t</span>)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    n = _n, s = _s, t = <span class="type">_t</span>;</span><br><span class="line">    cnt = <span class="number">1</span>, flow = cost = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">0</span>, (n+<span class="number">1</span>)&lt;&lt;<span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> cap, ll cost)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">addedge</span>(u, v, cap, cost), <span class="built_in">addedge</span>(v, u, <span class="number">0</span>, -cost);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">getH</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) h[i] = linf;</span><br><span class="line">    h[s] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=s; i&lt;t; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=head[i]; j; j=e[j].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[j].to;</span><br><span class="line">        <span class="keyword">if</span>(e[j].w &amp;&amp; h[v]&gt;h[i]+e[j].f) h[v] = h[i] + e[j].f;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">Dijkstra</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) d[i] = linf;</span><br><span class="line">    d[s] = <span class="number">0</span>, a[s] = inf;</span><br><span class="line">    priority_queue&lt;pli, vector&lt;pli&gt;, greater&lt;pli&gt;&gt; pq;</span><br><span class="line">    pq.<span class="built_in">push</span>(&#123;<span class="number">0</span>, s&#125;);</span><br><span class="line">    <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">auto</span> cur = pq.<span class="built_in">top</span>(); pq.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="type">int</span> u = cur.se;</span><br><span class="line">      <span class="keyword">if</span>(cur.fi&gt;d[u]) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].to;</span><br><span class="line">        ll w = e[i].f + h[u] - h[v];</span><br><span class="line">        <span class="keyword">if</span>(e[i].w&amp;&amp;d[v]&gt;d[u]+w)</span><br><span class="line">        &#123;</span><br><span class="line">          p[v] = i;</span><br><span class="line">          a[v] = <span class="built_in">min</span>(a[u], e[i].w);</span><br><span class="line">          pq.<span class="built_in">push</span>(&#123;d[v]=d[u]+w, v&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(d[i]&lt;linf) h[i] += d[i];</span><br><span class="line">      <span class="keyword">else</span> h[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> d[t]!=linf;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">getH</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">Dijkstra</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      flow += a[t], cost += a[t]*h[t];</span><br><span class="line">      <span class="type">int</span> u = t;</span><br><span class="line">      <span class="keyword">while</span>(u!=s)</span><br><span class="line">      &#123;</span><br><span class="line">        e[p[u]].w -= a[t], e[p[u]^<span class="number">1</span>].w += a[t];</span><br><span class="line">        u = e[p[u]^<span class="number">1</span>].to;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  MCMF::<span class="built_in">init</span>(<span class="number">500002</span>, <span class="number">0</span>, <span class="number">500001</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> s, e; ll w; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%lld&quot;</span>, &amp;s, &amp;e, &amp;w);</span><br><span class="line">    MCMF::<span class="built_in">add</span>(s, e+<span class="number">1</span>, <span class="number">1</span>, -w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;MCMF::t; i++) MCMF::<span class="built_in">add</span>(i, i+<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  MCMF::<span class="built_in">go</span>();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, -MCMF::cost);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AtCoder Regular Contest 111</title>
      <link href="/2021/01/10/atcoder-regular-contest-111/"/>
      <url>/2021/01/10/atcoder-regular-contest-111/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>æ±‚$\lfloor \frac{10^n}{m} \rfloor$<br>$1\leq n \leq 10^{18},1\leq m \leq 10000$</p><p>æŠŠ$x % y$æ”¹å†™æˆ$\lfloor \frac{x}{y} \rfloor$<br>æ±‚å‡º$p=10^n % m$ï¼Œå†æ±‚å‡º$q=(10^n-p) % m^2$<br>é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯$\frac{10^n-p}{m} - \frac{10^n-p-q}{m}$â€‹ï¼Œå³$\frac{q}{m}$<br>å¿«é€Ÿå¹‚å³å¯</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>æœ‰nå¼ ç‰Œï¼Œæ¯å¼ æœ‰ä¸¤é¢ï¼Œå„æœ‰æ•°å­—$a_i$â€‹å’Œ$b_i$â€‹ï¼Œæ¯å¼ ç‰Œé€‰æ‹©ä¸€é¢æœä¸Šï¼Œé—®ä½ æœ€å¤šèƒ½æœ‰å‡ ç§æ•°å­—ã€‚</p><p>ç›¸å½“äºç»™$a_i$â€‹å’Œ$b_i$â€‹è¿è¾¹ï¼Œç„¶åå¯¹äºæ¯ä¸ªè¿é€šå—å¦‚æœæ˜¯æ ‘ï¼Œé‚£å°±è¦å°‘ä¸€ç§ï¼Œå¦åˆ™å…¨å¯ä»¥æœ‰<br>ç„¶åæ¯”èµ›æ—¶å€™æˆ‘å´åªæƒ³åˆ°ä¸€ä¸ªäºŒåˆ†å›¾çš„å»ºæ³•ï¼Œç”šè‡³è¿˜åœ¨çŠ¹è±«è¦ä¸è¦ç”¨HKå†²ï¼ˆå¤ªèœæƒ¹ã€‚ã€‚ï¼‰<br>æœ€åä¹Ÿæ˜¯ä¹±æè¿‡å»çš„ï¼Œå¦‚æœæŸä¸ªæ•°å­—åªæœ‰ä¸€å¼ ç‰Œæœ‰ï¼Œé‚£å°±è®©ç¿»ï¼Œè¿™æ ·æŒ‰ç…§æ‹“æ‰‘æŠŠè¿™äº›è´ªå¿ƒæ‰ä¹‹åï¼Œå‰©ä¸‹çš„æ¯ä¸ªæ•°å­—éƒ½è‡³å°‘æœ‰ä¸¤ä¸ªç‰Œæœ‰ï¼Œé‚£ä¹ˆè¿™äº›æ•°å­—éƒ½å¯ä»¥æœ‰ï¼ˆå…¶å®å’Œé¢˜è§£çš„ç»“è®ºä¸€æ ·ï¼‰</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>æ¯ä¸ªäººæœ‰æƒå€¼$a_i$â€‹ï¼Œæœ‰ç‰©å“$p_i$â€‹ï¼Œä¸”é‡$b_i$â€‹ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸¤ä¸ªäººäº¤æ¢ä»–ä»¬çš„ç‰©å“ï¼Œé—®ä½ æœ€å°‘å¤šå°‘æ¬¡ä½¿å¾—æ‰€æœ‰iæ»¡è¶³$p_i=i$ï¼Œä¸€ä¸ªé¢å¤–æ¡ä»¶æ˜¯å¦‚æœ$a_i\le b_i$â€‹åè¿™ä¸ªäººå°±ä¸èƒ½å†äº¤æ¢äº†ã€‚</p><p>å¯ä»¥ä»»æ„äº¤æ¢ï¼Œè¦æœ€å°‘æ¬¡æ•°ï¼Œæ˜¾ç„¶æ˜¯è€ƒè™‘æ¯ä¸ªç½®æ¢ç¯<br>è´ªå¿ƒçš„æƒ³è‚¯å®šæ˜¯å…ˆè®©$a_i$â€‹å°çš„äººå…ˆå½’ä½ï¼Œå°½å¯èƒ½è®©$a_i$â€‹å¤§çš„äººä½œä¸­ä»‹<br>æ‰€ä»¥æŒ‰ç…§$a$æ’åºåä¸€ä¸ªä¸ªæ¢å³å¯<br>é¢˜è§£è¯´çš„æ˜¯å¦‚æœæ¢ä¸äº†å°±ä¸€å®šæ— è§£ã€‚æˆ‘å†™çš„æ—¶å€™æ˜¯å¦‚æœä¸€æ¬¡æ¢ä¸äº†ï¼Œå°±å°è¯•è®©$a$æœ€å¤§çš„é‚£ä¸ªä½œä¸­ä»‹ï¼Œä¼¼ä¹ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Ÿ</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>ä¸€ä¸ªæ— å‘å›¾ï¼Œè®©ä½ ç»™æ‰€æœ‰è¾¹å®šå‘ï¼Œä½¿å¾—æ¯ä¸ªç‚¹å¯ä»¥è¾¾åˆ°çš„ç‚¹æ•°æ»¡è¶³ç»™å®šçš„æ•°ç»„$c$ï¼Œä¿è¯å­˜åœ¨è§£</p><p>å› ä¸ºä¸€å®šæœ‰è§£ï¼Œé‚£ä¹ˆå¯¹äºä¸€æ¡è¾¹ï¼Œå¦‚æœä¸¤ä¸ªç‚¹çš„cä¸åŒï¼Œä¸€å®šæ˜¯è®©å¤§çš„è¿å‘å°çš„ï¼Œæ‰€ä»¥åªç”¨è€ƒè™‘ç›¸ç­‰çš„ã€‚æˆ‘å½“æ—¶æƒ³çš„æ˜¯è‚¯å®šæ˜¯ç¯ï¼Œä½†æ˜¯è¿™æ ·å¾ˆéš¾æ„é€ ã€‚å…¶å®æœ¬è´¨å°±æ˜¯è®©ä½ æŠŠè¿™ä¸ªæ— å‘å›¾å®šå‘æˆä¸€ä¸ªå¼ºè¿é€šçš„å›¾ã€‚å…ˆè·‘å‡ºä¸€ä¸ªdfsæ ‘ï¼Œç„¶åå¯¹äºæ ‘è¾¹ä»dfsåºå°çš„åˆ°å¤§çš„ï¼Œå¯¹äºéæ ‘è¾¹ä»dfsåºå¤§çš„åˆ°å°çš„å³å¯ã€‚<br>æˆ‘è¾¹çš„æ•°ç»„ä¹Ÿåªå¼€äº†100ï¼Œå¯¼è‡´ä¸€ç›´waï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸æ˜¯reï¼‰ï¼Œè‡ªé—­äº†</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ç»™å®šA,B,C,Dï¼Œè®©ä½ æ±‚æœ‰å¤šå°‘ä¸ªæ­£æ•´æ•°iæ»¡è¶³$[A+Bi,A+Ci]$åŒºé—´å†…æ²¡æœ‰Dçš„å€æ•°<br>æ˜¾ç„¶åŒºé—´é•¿åº¦$\geq D$çš„æ—¶å€™ä¸€å®šæœ‰Dçš„å€æ•°<br>æ‰€æœ‰iä¸€å®šæ»¡è¶³$\leq \lfloor \frac{D-2}{C-B} \rfloor$<br>å…¶æ¬¡å°±æ˜¯$\lfloor \frac{A+Bi-1}{D} \rfloor= \lfloor \frac{A+Ci}{D}<br>\rfloor$<br>åˆç”±äºè¿™ä¸¤è€…æœ€å¤šç›¸å·®1ï¼Œæ‰€ä»¥åªè¦æ±‚å‡º$\sum \limits_{i=1}^{up} \lfloor<br>\frac{A+Ci}{D} \rfloor - \lfloor \frac{A+Bi-1}{D}<br>\rfloor$ï¼Œå°±æ˜¯åŒ…å«Dçš„å€æ•°çš„ä¸åˆæ³•åŒºé—´äº†ï¼Œç”¨upå‡æ‰å³å¯ã€‚è¿™ä¸œè¥¿å°±æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç±»æ¬§å‡ é‡Œå¾—äº†$\sum<br>\limits_{i=0}^{n} \lfloor \frac{ai+b}{c} \rfloor$ï¼Œå¥—ä¸ªæ¿å­å³å¯</p><p>æ¯”èµ›å°±å†™ABCï¼ŒDæ²¡å†™å‡ºæ¥ï¼ŒEæ²¡çœ‹ï¼Œæ„Ÿè§‰è¿™æ¬¡DEæŒºå¥—è·¯çš„ï¼Œç„¶åABCæˆ‘å†™çš„æœ‰ç‚¹æ…¢ï¼ŒBCä¹Ÿéƒ½æ˜¯çŒœçš„ç»“è®ºä¸å¤ªæ•¢å†™ï¼Œæƒ³äº†å¥½ä¹…</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018-2019 ACM-ICPC, Asia Jiaozuo Regional Contest gym102028</title>
      <link href="/2021/01/09/2018-2019-acm-icpc-asia-jiaozuo-regional-contest-gym102028/"/>
      <url>/2021/01/09/2018-2019-acm-icpc-asia-jiaozuo-regional-contest-gym102028/</url>
      
        <content type="html"><![CDATA[<p>å‰äº”é¢˜ä¸éš¾ï¼ˆé“¶ï¼‰ï¼Œç¬¬å…­é¢˜ï¼ˆB or Hï¼‰éƒ½ä¸ä¼š</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>çœŸç­¾åˆ°</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>åˆä¸­é¢˜ï¼Œæœ‰ç‚¹çƒ¦<br>æœ‰ä¸¤ç§æƒ…å†µï¼Œæ‡’å¾—å†™äº†</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>å¾ˆå®¹æ˜“æ‰“è¡¨æ‰¾åˆ°è§„å¾‹</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>å¾ˆç›´ç™½çš„bfsï¼Œéœ€è¦å¯¹ç»™å‡ºçš„å›¾è¿›è¡Œä¸€äº›è½¬åŒ–ï¼ˆæˆ‘çš„è½¬åŒ–æ–¹æ³•ä¸å¤ªå¥½ï¼Œå¯¼è‡´æœ‰ç‚¹éš¾å†™ï¼‰</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>æ¨ªè½´ä¸Šæœ‰nä¸ªç‚¹ï¼Œè®©ä½ é€‰æ‹©kä¸ªç‚¹ï¼Œæœ€å¤§åŒ–ä»–ä»¬ä¸¤ä¸¤ä¹‹é—´è·ç¦»çš„å’Œ<br>kä»1~néƒ½å›ç­”ä¸€é<br>ä¸¤ä¸ªç‚¹ä¸€å®šæ˜¯å–æœ€å·¦å’Œæœ€å³ï¼Œä¸‰ä¸ªç‚¹éšä¾¿å†å–ä¸€ä¸ªï¼Œå››ä¸ªç‚¹ä¸€å®šæ˜¯å–æœ€å·¦ä¸¤ä¸ªå’Œæœ€å³ä¸¤ä¸ªï¼Œé‚£ä¹ˆç»“è®ºå°±å¾ˆæ˜¾ç„¶äº†</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>ç»™å®šnä¸ªæ•°ï¼Œå®šä¹‰ä¸€ä¸ªå­åŒºé—´çš„å€¼ä¸ºè¯¥åŒºé—´çš„æœ€å¤§å€¼ï¼Œè®©ä½ æ±‚æ‰€æœ‰æœ¬è´¨ä¸åŒçš„å­åŒºé—´çš„å€¼çš„å’Œ<br>æ²¡æœ‰æœ¬è´¨ä¸åŒé‚£å°±å¾ˆæ¨¡æ¿äº†ï¼Œå•è°ƒæ ˆæˆ–è€…ç¬›å¡å°”æ ‘å³å¯<br>ä½†æ˜¯æœ¬è´¨ä¸åŒå°±å¾ˆæ£˜æ‰‹ï¼Œæƒ³äº†æƒ³åç¼€è‡ªåŠ¨æœºæ„Ÿè§‰åšä¸äº†ï¼Œåˆæƒ³äº†æƒ³å•è°ƒæ ˆå’Œç¬›å¡å°”æ ‘æ„Ÿè§‰ä¹Ÿä¸è¡Œï¼Œå“ˆå¸Œä¹Ÿæ²¡æ³•æã€‚<br>çœ‹åˆ°é¢˜è§£çš„åç¼€æ•°ç»„åå°±çŸ¥é“äº†ã€‚å¿˜äº†æœ¬è´¨ä¸åŒè¿˜å¯ä»¥åç¼€æ•°ç»„äº†ã€‚<br>å…ˆæƒ³ä¸€ä¸‹åç¼€æ•°ç»„æ˜¯æ€ä¹ˆæ±‚æœ¬è´¨ä¸åŒçš„ä¸²çš„ï¼Œå°±æ˜¯æ±‚å‡º$height_i$â€‹ï¼Œé‚£ä¹ˆå¯¹äºä»ä½ç½®iå¼€å§‹çš„åç¼€ï¼Œä»–ä¼šå¤šç»Ÿè®¡$height_{rk_i}$â€‹â€‹ä¸ªå‰ç¼€ï¼Œå³ä»iå¼€å§‹ï¼Œä»¥$i$ ~ $i+height_{rk_i}-1$ç»“æŸçš„è¿™äº›åŒºé—´çš„å€¼é‡å¤ç®—äº†ï¼Œå‡æ‰å³å¯<br>ä»¤$r_i = i+height_{rk_i}-1$<br>å…ˆå»ºå‡ºç¬›å¡å°”æ ‘ï¼Œå¯¹äºå½“å‰ç‚¹uï¼Œå½“å‰èŒƒå›´ä¸º[L,R],åˆ™å·¦å­æ ‘å†…æ‰€æœ‰$r_i$â€‹å¤§äºç­‰äºuçš„ï¼Œéƒ½è¦å‡æ‰$a_u$â€‹çš„è´¡çŒ®<br>å³è¦æ±‚å‡ºå·¦å­æ ‘(åŒ…æ‹¬u)å†…$\sum_{i=L}^u max(r_i-u+1,0) -<br>\sum_{i=L}^u max(r_i-R,0)$<br>å¯ä»¥ç”¨çº¿æ®µæ ‘åˆå¹¶æ¥ç»´æŠ¤</p><p>è¿™é¢˜å‘ç°äº†æˆ‘saæ¿å­çš„ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨æ±‚heightæ•°ç»„çš„æ—¶å€™è¦æ³¨æ„i+kå’Œj+kçš„èŒƒå›´ï¼Œå¦åˆ™åœ¨å¤šç»„æ•°æ®+æ•°ç»„æ˜¯intçš„æ—¶å€™ä¼šæŒ‚æ‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(i+k&lt;=n&amp;&amp;j+k&lt;=n&amp;&amp;a[i+k]==a[j+k]) k++;</span><br></pre></td></tr></table></figure><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>æœ‰ä¸¤ç§æ€ªç‰©ï¼Œè¡€é‡æ”»å‡»åŠ›åˆ†åˆ«ä¸º$HP_A,ATK_A,HP_B,ATK_B$<br>ç¬¬iå›åˆä½ ä¼šå…ˆå—åˆ°æ´»ç€çš„æ€ªç‰©çš„æ”»å‡»ï¼Œç„¶åä½ å¯ä»¥é€‰æ‹©ä¸€åªæ€ªç‰©é€ æˆiçš„ä¼¤å®³ï¼Œè®©ä½ æœ€å°åŒ–è‡ªå·±æ‰€å—çš„ä¼¤å®³çš„åŒæ—¶æœ€å°åŒ–æ”»å‡»åºåˆ—çš„å­—å…¸åºï¼ˆå°½å¯èƒ½ä¼˜å…ˆæ‰“Aï¼‰<br>å…ˆè€ƒè™‘æ€ä¹ˆæœ€å°åŒ–è‡ªå·±å—åˆ°çš„ä¼¤å®³<br>å®šä¹‰f(t)è¡¨ç¤ºæœ€å°çš„xï¼Œä½¿å¾—$\sum_{i=1}^x \geq t$<br>ä¸€å®šæ˜¯åœ¨$f(HP_A+HP_B)$å›åˆä»¥å†…ï¼Œå…ˆä¼˜å…ˆæ‰“æ­»Aï¼Œæˆ–è€…å…ˆä¼˜å…ˆæ‰“æ­»B<br>è€ƒè™‘å…ˆæ‰“æ­»Aï¼Œå¦‚æœå‰$f(HP_A)$å›åˆéƒ½ç”¨æ¥æ‰“Aï¼Œå‰©ä½™å›åˆæ‰“Bä¹Ÿèƒ½æŠŠBæ‰“æ­»é‚£è¿™å°±æ˜¯æœ€ä¼˜çš„ï¼Œå¦åˆ™å‡è®¾ç¼ºäº†xç‚¹ä¼¤å®³ï¼Œæ‰“Aå¯Œä½™äº†yç‚¹ä¼¤å®³ï¼Œå¿…ç„¶æœ‰å…³ç³»$y\geq<br>x$ï¼Œä¸ºäº†è®©Bå°½å¯èƒ½é åï¼Œåªè¦åœ¨ç¬¬yå›åˆæ”¹æˆæ‰“Bå³å¯<br>è€ƒè™‘å…ˆæ‰“æ­»Bï¼Œå…ˆåœ¨å‰$f(HP_B)$å›åˆéƒ½æ‰“Bï¼Œåé¢æ‰“Aï¼Œå¦‚æœæ‰“Bå¯Œä½™äº†xç‚¹ä¼¤å®³ï¼Œæˆ‘ä»¬è®©å‰$f(x+1)-1$ä¸ªå›åˆæ”¹æˆæ‰“Aå³å¯ï¼Œå¦‚æœAè¿˜ç¼ºäº†xçš„ä¼¤å®³ï¼Œé‚£å°±è®©å‰é¢æœ€åä¸€ä¸‹æ‰“Aå»¶è¿Ÿxå›åˆ</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ä¸€ä¸ª$n \times n$çš„æ£‹ç›˜ï¼Œæ¯ä¸€åˆ—ä¸Šéƒ½ä¸€ä¸ªæ£‹å­ï¼ˆä¸”éƒ½ä¸åŒè¡Œï¼‰ï¼Œç°åœ¨æœ‰å››ç§æ“ä½œå’Œä¸¤ç§è¯¢é—®</p><ul><li>L Kï¼šæ‰€æœ‰æ£‹å­åŒæ—¶å‘å·¦ç§»åŠ¨kæ­¥ï¼Œå¦‚æœç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨</li><li>R Kï¼šæ‰€æœ‰æ£‹å­åŒæ—¶å‘å³ç§»åŠ¨kæ­¥ï¼Œå¦‚æœç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨</li><li>U Kï¼šæ‰€æœ‰æ£‹å­åŒæ—¶å‘ä¸Šç§»åŠ¨kæ­¥ï¼Œå¦‚æœç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨</li><li>D Kï¼šæ‰€æœ‰æ£‹å­åŒæ—¶å‘ä¸‹ç§»åŠ¨kæ­¥ï¼Œå¦‚æœç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨</li><li>è¯¢é—®åˆå§‹ç¬¬iä¸ªæ£‹å­ç°åœ¨çš„ä½ç½®</li><li>è¯¢é—®æœ‰å¤šå°‘å¯¹æ£‹å­ç°åœ¨åœ¨åŒä¸€ä¸ªä½ç½®ä¸Š</li></ul><p>$n \leq 3\times 10^5$<br>è¿™ç§äºŒç»´é—®é¢˜ï¼Œä¸€ä¸ªæƒ³æ³•å°±æ˜¯è¡Œåˆ—åˆ†ç¦»åšï¼Œè¿™è¾¹æ˜¾ç„¶ä¹Ÿå¯ä»¥è¡Œåˆ—åˆ†ç¦»è½¬æˆä¸€ç»´å»æ€è€ƒ<br>å°±è€ƒè™‘æ‰€æœ‰æ£‹å­åœ¨ä¸€æ¡æ¨ªè½´ä¸Šï¼Œå¯ä»¥åŒæ—¶å·¦å³ç§»åŠ¨kæ­¥<br>å¯¹äºç¢°åˆ°è¿‡å·¦è¾¹ç•Œçš„æ£‹å­ï¼Œä»¥åå°±æ°¸è¿œåœ¨ä¸€èµ·äº†ï¼Œå³è¾¹ç•Œä¹Ÿæ˜¯è¿™æ ·<br>ç¬¬ä¸€æ­¥å·¦ç§»kï¼Œé‚£ä¹ˆ1~kçš„æ£‹å­ä¹‹åå°±ç›¸åŒäº†<br>å¦ä¸€ä¸ªå¥—è·¯æ˜¯nä¸ªæ£‹å­ä¸€èµ·åŠ¨ä¸å¥½ç»´æŠ¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å»ç»´æŠ¤è¾¹ç•Œï¼Œå·¦ç§»kï¼Œæˆ‘ä»¬è®©å·¦è¾¹ç•Œå³ç§»kå°±è¡Œäº†ï¼Œè¿™æ ·$\leq$å·¦è¾¹ç•Œçš„æ£‹å­éƒ½ç›¸å½“äºæ˜¯åœ¨å·¦è¾¹ç•Œä¸Šï¼Œè¿™æ ·ä¸€æ¥ç›¸å½“äºæ˜¯å·¦å³è¾¹ç•Œä¸æ–­åœ¨å‘ä¸­é—´é æ‹¢ï¼Œå› ä¸ºä¸æ–­ç§»åŠ¨ä¸‹å»åˆå¹¶çš„æ£‹å­å°±è¶Šæ¥è¶Šå¤šäº†ã€‚ä½†æ˜¯æˆ‘ä»¬ç»´æŠ¤çš„å¹¶ä¸æ˜¯çœŸå®çš„å·¦è¾¹ç•Œåæ ‡ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»´æŠ¤ä¸€ä¸ªå˜é‡dã€‚å·¦ç§»å°±è®©d+kï¼Œå³ç§»å°±è®©d-kï¼Œåˆ™l-kå’Œr-kå°±æ˜¯çœŸå®çš„è¾¹ç•Œäº†ï¼Œå½“ç„¶è¿˜éœ€è¦ä¿è¯çœŸå®è¾¹ç•Œåœ¨1~nèŒƒå›´å†…ï¼Œå› ä¸ºç¢°åˆ°è¾¹ç•Œå°±ä¸åŠ¨äº†<br>è¿™æ ·æ¨ªè½´çºµè½´åˆ†åˆ«ç»´æŠ¤å°±å¯ä»¥è§£å†³ç¬¬ä¸€ä¸ªè¯¢é—®äº†ï¼Œå¯¹äºç¬¬äºŒä¸ªè¯¢é—®ï¼Œæˆ‘ä»¬ç›¸å½“äºæ˜¯LRDUå››ä¸ªè¾¹ç•Œåœ¨ä¸æ–­çš„å¾€ä¸­é—´å‹ç¼©ï¼Œç”±äºåˆå§‹è¡Œåˆ—å‡ä¸åŒï¼Œè¦ä½äºåŒä¸€ä¸ªæ ¼å­ï¼Œå¿…é¡»åŒåœ¨LRè½´ä¸­çš„ä¸€ä¸ªï¼ŒUDè½´çš„ä¸€ä¸ªï¼Œç”¨å››ä¸ªå˜é‡LDï¼ŒLUï¼ŒRDï¼ŒRUåˆ†åˆ«ç»´æŠ¤ä¸€ä¸‹ï¼Œæ³¨æ„ç‰¹åˆ¤L=Rï¼ŒD=Uçš„æƒ…å†µã€‚å…·ä½“ç»´æŠ¤çš„è¯ï¼Œå› ä¸ºlrudè¿™å››ä¸ªè½´éƒ½æ˜¯å•è°ƒå˜åŒ–çš„ï¼Œé‚£ä¹ˆæ¯æ¬¡ç§»åŠ¨çš„æ—¶å€™åˆ¤æ–­ä¸€ä¸‹å½“å‰ç¢°åˆ°è¾¹ç•Œçš„ç‚¹å³å¯ï¼Œæ³¨æ„ä¸è¦é‡å¤ç»Ÿè®¡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, ul, ur, dl, dr;</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">ll C[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">check</span><span class="params">(<span class="type">int</span> id)</span></span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Bound</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, d;</span><br><span class="line">  <span class="type">int</span> p[N], id[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; l = <span class="number">1</span>, r = n, d = <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">set</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; p[x] = y, id[y] = x; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">movel</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r &amp;&amp; l+d-k&lt;<span class="number">1</span>) <span class="built_in">check</span>(id[++l]);</span><br><span class="line">    <span class="keyword">if</span>(l+d-k&gt;=<span class="number">1</span>) d -= k;</span><br><span class="line">    <span class="keyword">else</span> d = <span class="number">1</span> - l;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">mover</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r &amp;&amp; r+d+k&gt;n) <span class="built_in">check</span>(id[--r]);</span><br><span class="line">    <span class="keyword">if</span>(r+d+k&lt;=n) d += k;</span><br><span class="line">    <span class="keyword">else</span> d = n - r;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p[k]&lt;=l) <span class="keyword">return</span> l + d;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p[k]&gt;=r) <span class="keyword">return</span> r + d;</span><br><span class="line">    <span class="keyword">return</span> p[k] + d;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;lr, ud;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">check</span><span class="params">(<span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(vis[id]) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(lr.p[id]&lt;=lr.l &amp;&amp; ud.p[id]&lt;=ud.l) ul++, vis[id] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(lr.p[id]&lt;=lr.l &amp;&amp; ud.p[id]&gt;=ud.r) dl++, vis[id] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(lr.p[id]&gt;=lr.r &amp;&amp; ud.p[id]&lt;=ud.l) ur++, vis[id] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(lr.p[id]&gt;=lr.r &amp;&amp; ud.p[id]&gt;=ud.r) dr++, vis[id] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(lr.l==lr.r &amp;&amp; ud.l==ud.r) <span class="keyword">return</span> C[ul+dl+ur+dr];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(lr.l==lr.r) <span class="keyword">return</span> C[ul+ur] + C[dl+dr];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(ud.l==ud.r) <span class="keyword">return</span> C[ul+dl] + C[ur+dr];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> C[ul] + C[ur] + C[dl] + C[dr];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ul = ur = dl = dr = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">  lr.<span class="built_in">init</span>(n), ud.<span class="built_in">init</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    lr.<span class="built_in">set</span>(i, y); ud.<span class="built_in">set</span>(i, x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">check</span>(lr.id[<span class="number">1</span>]), <span class="built_in">check</span>(lr.id[n]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> op[<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">    <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, ud.<span class="built_in">get</span>(k), lr.<span class="built_in">get</span>(k));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;!&#x27;</span>) <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">ask</span>());</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;L&#x27;</span>) lr.<span class="built_in">movel</span>(k);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) lr.<span class="built_in">mover</span>(k);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;U&#x27;</span>) ud.<span class="built_in">movel</span>(k);</span><br><span class="line">      <span class="keyword">else</span> ud.<span class="built_in">mover</span>(k);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;N; i++) C[i] = <span class="number">1ll</span>*i*(i<span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 695 (Div. 2)</title>
      <link href="/2021/01/09/codeforces-round-695-div-2/"/>
      <url>/2021/01/09/codeforces-round-695-div-2/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>æœ‰nä¸ªæ•°å­—ï¼ŒåŒæ—¶ä»0å¼€å§‹ï¼ŒæŒ‰ç…§0~9çš„é¡ºåºå¾ªç¯ï¼Œæ¯ä¸€ç§’å˜åŒ–ä¸€æ¬¡ã€‚ç°åœ¨å¯ä»¥æš‚åœæŸä¸ªæ•°å­—çš„å˜åŒ–ï¼Œç„¶åè·ç¦»å®ƒxçš„æ•°å­—ä¼šåœ¨xç§’åæš‚åœå˜åŒ–ï¼Œé—®æ‰€æœ‰æ•°å­—éƒ½æš‚åœåçš„æœ€å¤§æ•°å­—æ˜¯å¤šå°‘ã€‚<br>æ˜¾ç„¶é«˜ä½è¶Šå¤§è¶Šå¥½ï¼Œå‘ç°æ“ä½œç¬¬2ä¸ªæ•°å­—åå¯ä»¥ä½¿å‰ä¸‰ä½ä¸º989ï¼Œè¿™æ ·å¿…ç„¶æ˜¯æœ€å¤§çš„</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™å®šä¸€ä¸ªæ•°ç»„aï¼Œå¦‚æœ$a_i\lt a_{i-1},a_i\lt a_{i+1}$â€‹ï¼Œæˆ–è€…$a_i\gt a_{i-1},a_i\gt a_{i+1}$â€‹ï¼Œåˆ™æ˜¯åçš„ä¸‰å…ƒç»„ï¼Œè¦æ±‚ä½ è‡³å¤šä¿®æ”¹ä¸€ä¸ªæ•°ä½¿åçš„ä¸‰å…ƒç»„ä¸ªæ•°æœ€å°‘<br>è€ƒè™‘ä¿®æ”¹ä¸€ä¸ªæ•°ï¼Œåªä¼šå½±å“åˆ°ä»¥$a_{i-1},a_i,a_{i+1}$â€‹è¿™ä¸‰ä¸ªæ•°ä¸ºä¸­å¿ƒçš„ä¸‰å…ƒç»„ï¼Œåœ¨æœ€ä¼˜çš„æƒ…å†µä¸‹ï¼Œ$a_i$â€‹çš„å–å€¼å¿…ç„¶æ˜¯$a_{i-2},a_{i-1},a_i,a_{i+1},a_{i+2},\inf,-\inf$è¿™ä¸ƒç§ä¹‹ä¸€ï¼Œæš´åŠ›æšä¸¾ä¸€ä¸‹ï¼ˆè¿™è¾¹æ²¡ç»†æƒ³ï¼Œä¸çŸ¥é“åªå–$a_{i-1}$â€‹æˆ–$a_{i+1}$â€‹è¡Œä¸è¡Œï¼‰</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>æœ‰ä¸‰ä¸ªå¤šé‡é›†ï¼Œå®šä¹‰ä¸€ç§æ“ä½œæ˜¯ï¼Œé€‰æ‹©æŸä¸ªå¤šé‡é›†ä¸­çš„æ•°xï¼Œå¦ä¸€ä¸ªå¤šé‡é›†ä¸­çš„æ•°yï¼Œç„¶ååˆ é™¤è¿™ä¸¤ä¸ªæ•°ï¼ŒæŠŠx-yæ”¾åˆ°xæ‰€åœ¨çš„å¤šé‡é›†ä¸­ï¼Œè®©ä½ æœ€å¤§åŒ–æœ€åå‰©ä¸‹çš„é‚£ä¸ªæ•°çš„å€¼<br>æˆ‘ä»¬å¯ä»¥è®©xå»å‡æ‰æ‰€æœ‰çš„yï¼Œå†è®©zå»å‡æ‰xï¼Œé‚£å°±ç›¸å½“äºåªæŸå¤±äº†ä¸€ä¸ªx<br>å…ˆæšä¸¾å‰©ä¸‹çš„é‚£ä¸ªæ•°åœ¨å“ªä¸ªå¤šé‡é›†ä¸­ï¼Œå¿…ç„¶æ˜¯è®©æœ€å°çš„é‚£ä¸ªæ•°å½“ä½œxçš„è§’è‰²ï¼Œå†è€ƒè™‘æ€ä¹ˆå»æ‰åŒä¸€é›†åˆä¸­çš„å…¶ä»–æ•°tï¼Œå¯ä»¥é€‰æ‹©å¦å¤–ä¸¤ä¸ªå¤šé‡é›†ä¸­çš„æœ€å°å€¼mnï¼Œç„¶åè®©tå’Œmnä¸­çš„è¾ƒå°è€…å……å½“xçš„è§’è‰²ï¼Œè¿™æ ·æŸå¤±å°±æ˜¯$\min(t,mn)$ã€‚<br>æ‰€ä»¥æœ€å°æŸå¤±å°±æ˜¯è¯¥å¤šé‡é›†çš„æœ€å°å€¼ï¼Œä»¥åŠè¯¥å¤šé‡é›†çš„æ¬¡å°å€¼å’Œå…¶ä½™ä¸¤ä¸ªå¤šé‡é›†çš„æœ€å°å€¼ä¸­çš„æœ€å°å€¼çš„å’Œ<br>ï¼ˆæœ‰ç‚¹ç»•ã€‚ã€‚ï¼‰</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>ä¸€ä¸ªäººåˆå§‹åœ¨1~nçš„ä»»æ„ä¸€ç‚¹ï¼Œç„¶åæ¯æ¬¡å¯ä»¥å‘å·¦æˆ–è€…å‘å³èµ°ä¸€æ­¥ï¼Œèµ°kæ­¥åå°±å½¢æˆä¸€æ¡è·¯å¾„$c_0,c_1,â€¦,c_k$â€‹ï¼Œå®šä¹‰è¯¥è·¯å¾„çš„ä»·å€¼ä¸º$\sum_{i=0}^k<br>a_{c_i}$â€‹â€‹ï¼Œæ±‚æ‰€æœ‰ä¸åŒçš„è·¯å¾„çš„ä»·å€¼å’Œï¼Œè¦æ±‚æ”¯æŒå•ç‚¹ä¿®æ”¹$a_i$â€‹<br>å…ˆæ±‚å‡º$dp_{i,j}$â€‹è¡¨ç¤ºç¬¬iæ­¥åœ¨jçš„æ–¹æ¡ˆæ•°ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªdpçš„è½¬ç§»æ­£å‘å’Œåå‘æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆåˆ°$dp_k$â€‹çš„æ—¶å€™$dp_{i,j}$â€‹çš„è´¡çŒ®å°±ç›¸å½“äº$dp_{k-i,j}$â€‹ï¼Œæ‰€ä»¥éšä¾¿ç»´æŠ¤ä¸€ä¸‹å‰ç¼€å’Œå°±å¯ä»¥$O(1)$å¸¦ä¿®äº†</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ç»™ä¸€æ£µå¸¦ç‚¹æƒçš„æ— æ ¹æ ‘ï¼Œä¸€ä¸ªç‚¹uä½œä¸ºæ ¹æ˜¯åˆæ³•çš„ï¼Œä»…å½“å¯¹äºå…¶å®ƒä»»æ„ç‚¹vï¼Œuåˆ°vçš„è·¯å¾„ä¸Šçš„ç‚¹æƒå‡ä¸åŒ<br>å¯ä»¥ç”¨æ¢æ ¹dpæ¥åš<br>å›ºå®š1ä¸ºæ ¹ï¼Œå…ˆdfsä¸€éè·‘å‡º$dp_u$â€‹ï¼Œè¡¨ç¤ºåªè€ƒè™‘uçš„å­æ ‘æ—¶ï¼Œä»¥uä¸ºæ ¹æ˜¯å¦åˆæ³•ã€‚è¿™ä¸ªå¾ˆç®€å•ï¼Œåªè¦uçš„æ‰€æœ‰å„¿å­våˆæ³•ï¼Œä¸”uçš„ç‚¹æƒåœ¨å­æ ‘ä¸­æ²¡æœ‰å‡ºç°è¿‡å³å¯ã€‚<br>å†è€ƒè™‘æ±‚å‡º$dp2_u$â€‹ï¼Œè¡¨ç¤ºè€ƒè™‘é™¤å»uçš„å­æ ‘åçš„éƒ¨åˆ†ï¼Œä»¥uä¸ºæ ¹æ˜¯å¦åˆæ³•ã€‚é¦–å…ˆuçš„ç‚¹æƒåªèƒ½åœ¨uçš„å­æ ‘å½“ä¸­å‡ºç°ï¼Œuçš„çˆ¶äº²façš„ç‚¹æƒä¹Ÿåªèƒ½åœ¨uçš„å­æ ‘ä¸­å‡ºç°ï¼Œ$dp2_{fa}$â€‹è¦åˆæ³•ã€‚æ­¤å¤–å¯¹äºfaï¼Œé™¤å»uç‚¹åå…¶ä½™å„¿å­çš„dpè¦éƒ½æ˜¯1ã€‚æ»¡è¶³ä»¥ä¸Šæ‰€æœ‰æ¡ä»¶ï¼Œ$dp2_u$â€‹å°±æ˜¯1ã€‚<br>æœ€åå½“$dp_u=1$ä¸”$dp2_u=1$æ—¶ï¼Œè¡¨æ˜uæ˜¯åˆæ³•çš„<br>å…·ä½“å®ç°éœ€è¦ç”¨mapå¯å‘å¼åˆå¹¶</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ICPC Central Russia Regional Contest (CRRC 19) gym102780</title>
      <link href="/2021/01/09/icpc-central-russia-regional-contest-crrc-19-gym102780/"/>
      <url>/2021/01/09/icpc-central-russia-regional-contest-crrc-19-gym102780/</url>
      
        <content type="html"><![CDATA[<p>é™¤äº†ä¸¤é“é¢˜æ²¡ä»€ä¹ˆäººè¿‡å¤–æ¯”è¾ƒç®€å•</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>å°å­¦æ•°å­¦</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>åˆä¸­ç‰©ç†</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>æ¨¡æ‹Ÿé¢˜ï¼Œå¸¦ä¸€ç‚¹ç‚¹æ¨ç†</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>ç»™å®ša,bï¼Œè®©ä½ æ±‚ä¸€ä¸ªxï¼Œæ»¡è¶³$a^x=x^b$<br>å…¶ä¸­$2\leq a,b \leq 10000$<br>å®¹æ˜“æƒ³åˆ°xå¯ä»¥è¡¨ç¤º$a^t$çš„å½¢å¼<br>è€ƒè™‘$t\geq 1$çš„æƒ…å†µ<br>$a^t = tb$<br>å¯ä»¥ç›´æ¥æš´åŠ›æšä¸¾tï¼Œå¹‚æ¬¡çš„å¢é€Ÿæ˜¯è¿…é€Ÿçš„<br>è€ƒè™‘$t\le 1$çš„æƒ…å†µ<br>å°æ•°æ²¡æ³•æšä¸¾äº†ï¼Œä½†æ˜¯å¯ä»¥æ‰¾åˆ°açš„å› å­dï¼Œä½¿å¾—dçš„å¹‚æ¬¡=aï¼Œè½¬è€Œç”¨dçš„å¹‚æ¬¡å»è¡¨ç¤ºxå³å¯</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸¤ä¸ªäººè½®æµæ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€ç§å­—æ¯ï¼Œç„¶ååˆ é™¤ä¸€ä¸ªæˆ–è€…äºŒä¸ªæˆ–è€…å…¨éƒ¨ï¼Œé—®è°èµ¢ã€‚<br>å¯ä»¥æŠŠæ¯ç§å­—æ¯æƒ³æˆä¸€å †çŸ³å­ï¼Œé‚£å°±æ˜¯ä¸€ä¸ªåªèƒ½å–1ä¸ªæˆ–2ä¸ªæˆ–å…¨éƒ¨çš„NIMæ¸¸æˆï¼Œè·‘ä¸€ä¸‹sgå³å¯ï¼Œå…¶å®ç›´æ¥æ‰‹æ¨ä¹Ÿè¡Œ</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>ä¸€ä¸ªæ•°nï¼Œä¸¤ä¸ªè½®æµè®©å…¶å‡1ï¼Œå‡5ï¼Œæˆ–è€…å‡13ï¼Œé—®è°èµ¢<br>è·ŸFå·®ä¸å¤šï¼Œè·‘ä¸€ä¸‹dpå³å¯</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>æœ‰ä¸€ä¸ª$n \times n$çš„ç½‘æ ¼ï¼Œç°åœ¨æœ‰ä¸€ä¸ªç‰¹æ®Šç‚¹ï¼Œç„¶åæ¯æ¬¡ä½ å¯ä»¥è¿›è¡Œä¸‰ç§è¯¢é—®</p><ul><li>è¯¢é—®æŸä¸ªç‚¹æ˜¯ä¸æ˜¯ç‰¹æ®Šç‚¹</li><li>è¯¢é—®æŸæ¡çº¿æ®µæ˜¯å¦åŒ…å«ç‰¹æ®Šç‚¹</li><li>è¯¢é—®æŸä¸ªä¸‰è§’å½¢æ˜¯å¦åŒ…å«ç‰¹æ®Šç‚¹</li></ul><p>$n \leq 10^8$ï¼Œè¯¢é—®æ¬¡æ•°ä¸è¶…è¿‡60<br>çœ‹åˆ°è¿™ä¸ªæ•°æ®èŒƒå›´å’Œè¯¢é—®æ¬¡æ•°å°±æƒ³åˆ°äºŒåˆ†ï¼Œxå’Œyå¯ä»¥åˆ†å¼€åšï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›¸å½“äºè¦é€šè¿‡ä¸€æ¬¡è¯¢é—®åˆ¤æ–­è¿™ä¸ªç‰¹æ®Šç‚¹çš„åæ ‡æ˜¯å°äºxè¿˜æ˜¯å¤§äºxã€‚è¿™è¾¹æœ‰ä¸ªæ¡ä»¶å°±æ˜¯è¯¢é—®çš„ç‚¹çš„åæ ‡å¯ä»¥è¶…è¿‡nï¼Œåœ¨$10^9$ä»¥å†…å°±è¡Œï¼Œé‚£å°±å¾ˆç®€å•äº†ï¼Œæ¯æ¬¡é—®ä¸€ä¸ªå³è¾¹çš„ç‰¹åˆ«å¤§çš„ä¸‰è§’å½¢ï¼Œä¿è¯å¯ä»¥ç›–ä½å¤§äºxçš„è¿™å—çŸ©å½¢å°±å¯ä»¥äº†</p><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>è®©ä½ ç”¨ä¸è¶…è¿‡5ä¸ªæ•°ï¼Œä½¿å¾—å®ƒä»¬çš„ç«‹æ–¹å’Œç­‰äºx<br>$x\leq 10^{100000}$<br>è€ƒè™‘$(x-1)^3 + (x+1)^3 = 2x^3 + 6x$<br>é‚£å¦‚æœxæ˜¯6çš„å€æ•°ï¼Œè®©y=x/6ï¼Œç„¶åç”¨y-1ï¼Œy+1ï¼Œ-y, -yè¿™å››ä¸ªæ•°å°±å¯ä»¥è¡¨ç¤ºå‡ºxäº†<br>å…¶ä½™æŒ‰ç…§%6è®¨è®ºä¸€ä¸‹å³å¯<br>æ¯”å¦‚x%6=2ï¼Œå°±å…ˆè¡¨ç¤ºå‡ºx-8ï¼Œå†åŠ ä¸ª$2^3$å³å¯</p><h2 id="K"><a class="header-anchor" href="#K">Â¶</a>K</h2><p>ç»™å®šnä¸ªä¸åŒçš„æ•°ï¼Œæ¯æ¬¡å¯ä»¥äº¤æ¢ç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œé—®ä½ æœ€å°‘äº¤æ¢å‡ æ¬¡ï¼Œä½¿å¾—è¿™nä¸ªæ•°å…ˆå‡åå¢<br>ä»å¤§åˆ°å°è€ƒè™‘æ¯ä¸ªæ•°ï¼Œæœ€å¤§çš„æ•°åªèƒ½æ”¾åœ¨æœ€å·¦è¾¹æˆ–è€…æœ€å³è¾¹ï¼Œç„¶åä¼¼ä¹å°±æœ‰ç§$n^2$çš„dpäº†ï¼Œä½†æ˜¯ä»”ç»†æ€è€ƒå¯ä»¥å‘ç°æœ€å¤§çš„æ•°æ”¾åœ¨å·¦è¾¹è¿˜æ˜¯å³è¾¹æ˜¯ä¸å½±å“æ¬¡å¤§çš„æ•°çš„ï¼Œæ‰€ä»¥æ¯ä¸ªæ•°è´ªå¿ƒçš„æ”¾å°±è¡Œäº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬›å¡å°”æ ‘</title>
      <link href="/2020/12/23/di-qia-er-shu/"/>
      <url>/2020/12/23/di-qia-er-shu/</url>
      
        <content type="html"><![CDATA[<p>ç±»ä¼¼treapï¼Œæƒå€¼æ»¡è¶³äºŒå‰æœç´¢æ ‘ï¼Œé”®å€¼æ»¡è¶³å †<br>ä¸€èˆ¬ç”¨åœ¨åºåˆ—ä¸Šï¼Œä»¥ä¸‹æ ‡ä¸ºæƒå€¼ï¼Œå€¼ä¸ºé”®å€¼ï¼Œåˆ©ç”¨å•è°ƒæ ˆå¯ä»¥$O(n)$å»ºæ ‘<br>å› ä¸ºä¸‹æ ‡æ˜¯å•è°ƒé€’å¢çš„ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨å•è°ƒæ ˆä¸­ç»´æŠ¤å‡ºæœ€å³é“¾ï¼Œåœ¨æ’å…¥ä¸€ä¸ªæ–°ç‚¹çš„æ—¶å€™ï¼Œä¸æ–­æ’æ‰å¤§äºè‡ªå·±å€¼çš„ç‚¹ï¼Œç„¶åè‡ªå·±æˆä¸ºæ ˆé¡¶çš„å³å„¿å­ï¼Œæ’æ‰çš„æœ€åä¸€ä¸ªç‚¹ä½œå…¶å·¦å„¿å­<br>æœ‰ä»€ä¹ˆç”¨å‘¢<br>ç¬›å¡å°”æ ‘ä¸Šä¸¤ä¸ªç‚¹çš„LCAå°±ä»£è¡¨è¿™ä¸ªåŒºé—´çš„RMQ<br>å¯¹ä¸€ä¸ªç‚¹ï¼Œå®ƒæ˜¯å…¶ä»£è¡¨çš„åŒºé—´çš„æœ€å€¼ï¼Œå·¦å­æ ‘æ˜¯å·¦åŒºé—´ï¼Œå³å­æ ‘æ˜¯å³åŒºé—´ï¼Œè¿™å°±å½¢æˆäº†è‰¯å¥½çš„é€’å½’æ€§è´¨ï¼Œå¯ä»¥æ–¹ä¾¿æ€è€ƒå’Œè§£é¢˜</p><h2 id="P4755"><a class="header-anchor" href="#P4755">Â¶</a>P4755</h2><p>å®šä¹‰ç‚¹å¯¹$(i,j)$æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“$a_i\times a_j \leq \max(a_i,â€¦,a_j)$<br>æ˜¾ç„¶å¯ä»¥å¯å‘å¼åˆ†æ²»åšï¼Œåˆ©ç”¨stè¡¨æ‰¾åˆ°æœ€å€¼çš„ä½ç½®ï¼Œç„¶åå¯å‘å¼éå†å·¦å³åŒºé—´ä¸­å°çš„é‚£ä¸€è¾¹ç„¶åæ±‚æœ€å€¼å³å¯ã€‚<br>å…¶å®è¿™ç§æ€æƒ³æ”¾åœ¨ç¬›å¡å°”æ ‘ä¸Šä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œdfséå†ï¼Œç„¶åé€šè¿‡éå†å°çš„é‚£é¢—å­æ ‘æ¥ç»Ÿè®¡ç­”æ¡ˆã€‚ç»Ÿè®¡ç­”æ¡ˆå¯ä»¥ç›´æ¥ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œç„¶åçº¿æ®µæ ‘åˆå¹¶å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="type">int</span> n, a[N], sz[N];</span><br><span class="line"><span class="type">int64_t</span> ans;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, cnt;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line"><span class="type">int</span> rt[N&lt;&lt;<span class="number">5</span>], tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].cnt = t[t[p].l].cnt + t[t[p].r].cnt; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) p = ++tot;</span><br><span class="line">  t[p].cnt++;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(t[p].l, l, mid, x);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">upd</span>(t[p].r, mid+<span class="number">1</span>, r, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(r&lt;=v) <span class="keyword">return</span> t[p].cnt;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> ans = <span class="built_in">ask</span>(t[p].l, l, mid, v);</span><br><span class="line">  <span class="keyword">if</span>(v&gt;mid) ans += <span class="built_in">ask</span>(t[p].r, mid+<span class="number">1</span>, r, v);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) <span class="keyword">return</span> x|y;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    t[x].cnt += t[y].cnt;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  t[x].l = <span class="built_in">merge</span>(t[x].l, t[y].l, l, mid);</span><br><span class="line">  t[x].r = <span class="built_in">merge</span>(t[x].r, t[y].r, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">up</span>(x);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> st[N], ch[N][<span class="number">2</span>], top;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, j; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    j = top;</span><br><span class="line">    <span class="keyword">while</span>(j&amp;&amp;a[st[j]]&lt;a[i]) j--;</span><br><span class="line">    <span class="keyword">if</span>(j) ch[st[j]][<span class="number">1</span>] = i;</span><br><span class="line">    <span class="keyword">if</span>(j&lt;top) ch[i][<span class="number">0</span>] = st[j+<span class="number">1</span>];</span><br><span class="line">    top = j;</span><br><span class="line">    st[++top] = i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p || l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(ch[p][<span class="number">0</span>], l, p<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">dfs</span>(ch[p][<span class="number">1</span>], p+<span class="number">1</span>, r);</span><br><span class="line">  sz[p] = sz[ch[p][<span class="number">0</span>]] + sz[ch[p][<span class="number">1</span>]] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]&lt;sz[ch[p][<span class="number">1</span>]]) <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=p<span class="number">-1</span>; i++) ans += <span class="built_in">ask</span>(rt[ch[p][<span class="number">1</span>]], <span class="number">1</span>, inf, a[p]/a[i]);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>; i&lt;=r; i++) ans += <span class="built_in">ask</span>(rt[ch[p][<span class="number">0</span>]], <span class="number">1</span>, inf, a[p]/a[i]);</span><br><span class="line">  rt[p] = <span class="built_in">merge</span>(rt[ch[p][<span class="number">0</span>]], rt[ch[p][<span class="number">1</span>]], <span class="number">1</span>, inf);</span><br><span class="line">  <span class="built_in">upd</span>(rt[p], <span class="number">1</span>, inf, a[p]);</span><br><span class="line">  ans += <span class="built_in">ask</span>(rt[p], <span class="number">1</span>, inf, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="built_in">build</span>();</span><br><span class="line">  <span class="built_in">dfs</span>(st[<span class="number">1</span>], <span class="number">1</span>, n);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç‰›å®¢å¤šæ ¡3-Sort-the-Strings-Revision"><a class="header-anchor" href="#ç‰›å®¢å¤šæ ¡3-Sort-the-Strings-Revision">Â¶</a>ç‰›å®¢å¤šæ ¡3 Sort the Strings Revision</h2><p>æœ‰ä¸€ä¸ªåºåˆ—ï¼Œç¬¬iä¸ªå…ƒç´ çš„å€¼ä¸º$i % 10$ï¼Œnæ¬¡æ“ä½œï¼Œæ¯æ¬¡å°†$p_i$â€‹ä½ç½®çš„å€¼æ¢æˆ$d_i$â€‹ï¼Œå…¶ä¸­$p_i$â€‹ä¸ºä¸€ä¸ªæ’åˆ—ï¼Œé—®ä½ æ“ä½œå‰åå…±$n+1$ä¸ªåºåˆ—çš„å­—å…¸åºæ’å<br>æ˜¾ç„¶è¶Šå°çš„$p_i$â€‹è¶Šå æ®ä¸»å¯¼åœ°ä½ï¼Œæ ¹æ®åºåˆ—på»ºå‡ºç¬›å¡å°”æ ‘ï¼Œç„¶åå¦‚æœ$p_i&gt;d_i$â€‹ï¼Œè¯´æ˜ä¿®æ”¹åå­—å…¸åºæ›´å°ï¼Œä¼˜å…ˆéå†å³å­æ ‘ï¼Œåä¹‹ä¼˜å…ˆéå†å·¦å­æ ‘ã€‚<br>æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚æœ$p_i=d_i$â€‹ï¼Œæ­¤æ—¶å°±ä¸çŸ¥é“å·¦å³å­æ ‘å“ªä¸ªå°äº†ï¼Œå¯ä»¥äººä¸ºçš„å…ˆè®©è¿™æ ·çš„$p_i$â€‹å–ä¸€ä¸ªæå¤§å€¼ï¼Œè¿™æ ·è¿™äº›$p_i$â€‹åªå¯èƒ½åœ¨å¶å­èŠ‚ç‚¹äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e6</span> + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>, base = <span class="number">10000019</span>;</span><br><span class="line"><span class="type">int</span> n, p[N], d[N];</span><br><span class="line"><span class="type">int</span> st[N], ch[N][<span class="number">2</span>], rk[N], top, rnk;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> *a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) ch[i][<span class="number">0</span>] = ch[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, j; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    j = top;</span><br><span class="line">    <span class="keyword">while</span>(j &amp;&amp; a[st[j]]&gt;a[i]) j--;</span><br><span class="line">    <span class="keyword">if</span>(j) ch[st[j]][<span class="number">1</span>] = i;</span><br><span class="line">    <span class="keyword">if</span>(j&lt;top) ch[i][<span class="number">0</span>] = st[j+<span class="number">1</span>];</span><br><span class="line">    top = j;</span><br><span class="line">    st[++top] = i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> rt, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r || p[rt]==mod)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) rk[i] = rnk++;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(p[rt]%<span class="number">10</span>&gt;d[rt]) <span class="built_in">dfs</span>(ch[rt][<span class="number">1</span>], rt+<span class="number">1</span>, r), <span class="built_in">dfs</span>(ch[rt][<span class="number">0</span>], l, rt);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">dfs</span>(ch[rt][<span class="number">0</span>], l, rt), <span class="built_in">dfs</span>(ch[rt][<span class="number">1</span>], rt+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> pseed, pa, pb, pmod;</span><br><span class="line">  <span class="type">int</span> dseed, da, db, dmod;</span><br><span class="line">  rnk = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;pseed, &amp;pa, &amp;pb, &amp;pmod);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;dseed, &amp;da, &amp;db, &amp;dmod);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) p[i] = i;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">swap</span>(p[pseed%(i+<span class="number">1</span>)], p[i]);</span><br><span class="line">    pseed = (<span class="number">1ll</span>*pseed*pa + pb)%pmod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    d[i] = dseed%<span class="number">10</span>;</span><br><span class="line">    dseed = (<span class="number">1ll</span>*dseed*da + db)%dmod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="keyword">if</span>(d[i]==p[i]%<span class="number">10</span>) p[i] = mod;</span><br><span class="line">  <span class="built_in">build</span>(p);</span><br><span class="line">  <span class="type">int</span> rt = st[<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">dfs</span>(rt, <span class="number">0</span>, n);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>, pw = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    ans = (ans + <span class="number">1ll</span>*rk[i]*pw%mod)%mod;</span><br><span class="line">    pw = <span class="number">1ll</span>*pw*base%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢ç»ƒä¹ èµ›74</title>
      <link href="/2020/12/22/niu-ke-lian-xi-sai-74/"/>
      <url>/2020/12/22/niu-ke-lian-xi-sai-74/</url>
      
        <content type="html"><![CDATA[<p>ABCDéƒ½å¾ˆä¸€çœ¼</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>çœ‹åˆ°é¢˜ä¹Ÿæƒ³åˆ°æ€è·¯äº†ï¼Œç„¶è€Œå†™æ³•å¤æ‚äº†ï¼ŒåŠ ä¸Šå†™é”™ä¸€ä¸ªåœ°æ–¹ï¼Œå†åŠ ä¸Šå‡ºé¢˜äººæ•°æ®èŒƒå›´ä¸ç»™ä¸‹é™ï¼Œæ­£æ•´æ•°åŒ…å«0å¯è¿˜è¡Œï¼Œå†™äº†ä¸€ä¸ªå¤šå°æ—¶<br>ç»™å®šä¸€ä¸ªè”é€šç®€å•æ— å‘å›¾ï¼Œå®šä¹‰ä¸€ç§æ“ä½œæ˜¯ï¼Œéšæœºé€‰æ‹©ä¸¤ä¸ªä¸åŒçš„ç‚¹ï¼Œå°†ä»–ä»¬ä¹‹é—´æœ€çŸ­è·¯å¾„ä¸Šçš„æ‰€æœ‰ç‚¹éƒ½å˜æˆé»‘è‰²ï¼Œé—®ä½ æ“ä½œkæ¬¡åé»‘è‰²ç‚¹çš„ä¸ªæ•°çš„æœŸæœ›<br>$n \leq 500$<br>æ€è·¯å¾ˆç®€å•ï¼Œè€ƒè™‘æ¯ä¸ªç‚¹å˜é»‘çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Œä¸€æ¬¡æ“ä½œå˜é»‘ï¼Œå°±æ˜¯æšä¸¾æœ‰å¤šå°‘å¯¹ç‚¹ï¼Œå®ƒä»¬ä¹‹é—´å­˜åœ¨ä¸€æ¡æœ€çŸ­è·¯ç»è¿‡è¯¥ç‚¹ã€‚ç„¶åè¿™é¢˜å°±æ²¡äº†<br>å…ˆè·‘ä¸€éfloydï¼Œç„¶åæšä¸¾i,j,kï¼Œå¦‚æœ$d_{ik}+d_{kj}=d_{ij}$â€‹ï¼Œè¯´æ˜iå’Œjçš„æœ€çŸ­è·¯ä¸­æœ‰k<br>æˆ‘å†™å¤æ‚äº†ï¼Œè€ƒè™‘ä»¥æ¯ä¸ªç‚¹ä¸ºæ ¹çš„æœ€çŸ­è·¯å¾„å›¾ï¼Œå›ºå®šé€‰æ ¹ï¼Œé‚£ä¹ˆè¦è®©ç¬¬iä¸ªç‚¹å˜é»‘ï¼Œå°±å¿…é¡»é€‰æ‹©ç¬¬iä¸ªç‚¹çš„åç»§å¯è¾¾ç‚¹ï¼ˆæœ€çŸ­è·¯å¾„å›¾æ˜¯ä¸ªDAGï¼Œæ‹“æ‰‘æ’åº+bitsetï¼Œå¤æ‚åº¦å…¶å®æœ‰ç‚¹ç‚¸ï¼Œä¸è¿‡é¢˜ç›®æ•°æ®wå­˜åœ¨0ï¼Œè¿™æ—¶å€™å°±ä¸æ˜¯DAGäº†ï¼Œè¿™åšæ³•å°±æŒ‚äº†ï¼‰<br>å¦å¤–æˆ‘ç«Ÿç„¶åœ¨åˆå§‹åŒ–æ—¶å†™å‡º</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G[i][j] = (i^j)*inf</span><br></pre></td></tr></table></figure><p>æ²¡å¤šæƒ³æŠŠi!=jæ”¹æˆäº†i^jï¼Œè ¢äº†</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>ä¸€ä¸ªnä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œå¯¹å…¶æŸ“è‡³å¤šmç§é¢œè‰²ï¼Œå®šä¹‰ä¸€é¢—æ ‘æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“å­˜åœ¨ä¸€æ¡é“¾ä½¿å¾—ç«¯ç‚¹æ˜¯åŒè‰²ï¼Œä¸”é™¤ç«¯ç‚¹å¤–å­˜åœ¨ä¸€ä¸ªç‚¹ä¸ç«¯ç‚¹ä¸åŒè‰²ã€‚é—®æŸ“è‰²æ–¹æ¡ˆæ•°çš„æœŸæœ›ï¼ˆæ ‘çš„å½¢æ€ä»»æ„ï¼‰<br>$n \leq 10^7, m \leq 10^7$<br>å­˜åœ¨é—®é¢˜è½¬æˆåé—®é¢˜ï¼Œæ¯æ¡é“¾éƒ½ä¸åˆæ³•ï¼Œè¦ä¹ˆæ•´æ¡é“¾åŒè‰²ï¼Œè¦ä¹ˆéƒ½ä¸åŒè‰²ï¼Œ <s>ç„¶åå°±ä¸ä¼šäº†</s><br>æŒ‰ç…§dfsåºæ¥dp<br>$dp_{ij}$â€‹è¡¨ç¤ºè€ƒè™‘åˆ°dfsåºä¸ºiçš„ç‚¹æ—¶ï¼Œå·²ç»æŸ“äº†jç§é¢œè‰²ï¼Œä¸”æ•´æ£µæ ‘ä¸åˆæ³•<br>åˆ™$dp_{ij} = dp_{i-1j} + dp_{i-1j-1}(m-j+1)$<br>è¦ä¹ˆå’Œçˆ¶äº²åŒè‰²ï¼Œè¦ä¹ˆé€‰æ‹©ä¸€ç§æ²¡å‡ºç°è¿‡çš„é¢œè‰²<br>å®¹æ˜“å‘ç°æ‰€æœ‰å½¢æ€æ ‘çš„æŸ“è‰²æ–¹æ¡ˆæ ‘æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ç­”æ¡ˆç­‰ä»·äºæ±‚ä¸€æ£µæ ‘çš„æŸ“è‰²æ–¹æ¡ˆæ•°<br>è€ƒè™‘è¿™ä¸ªå¼å­çš„ç»„åˆæ„ä¹‰ï¼Œå°±æ˜¯iä¸ªæœ‰æ ‡å·çƒï¼Œmä¸ªæœ‰æ ‡å·ç›’å­ï¼Œç„¶åæ”¾å…¥å…¶ä¸­çš„jä¸ªçš„æ–¹æ¡ˆæ•°<br>å¯ä»¥ç›´æ¥æ±‚å‡ºæ¥æ˜¯$\binom{m}{j}\binom{i-1}{j-1}$ï¼Œå³å…ˆä»mä¸ªç›’å­é‡Œé€‰jä¸ªï¼Œç„¶åè¿™jä¸ªä»»æ„æ’åˆ—ï¼Œä¹‹åå°±æ˜¯ä¸ªéš”æ¿æ³•äº†<br>æœ€åçš„ç­”æ¡ˆæ˜¯$m^n - \sum_{i=1}^m dp_{ni}$</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„æ¨¡æ¿æ•´åˆ</title>
      <link href="/2020/12/16/shu-ju-jie-gou-mo-ban-zheng-he/"/>
      <url>/2020/12/16/shu-ju-jie-gou-mo-ban-zheng-he/</url>
      
        <content type="html"><![CDATA[<h2 id="æ›¿ç½ªç¾Šæ ‘"><a class="header-anchor" href="#æ›¿ç½ªç¾Šæ ‘">Â¶</a>æ›¿ç½ªç¾Šæ ‘</h2><p>ç»´æŠ¤æƒå€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> alpha = <span class="number">0.7</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> val, sz, cnt;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + t[p].cnt; &#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bad</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; <span class="keyword">return</span> t[p].cnt &amp;&amp; t[p].sz*alpha&lt;<span class="built_in">max</span>(t[t[p].ls].sz, t[t[p].rs].sz); &#125;</span><br><span class="line"><span class="type">int</span> ord[N], top;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(t[p].ls);</span><br><span class="line">  <span class="keyword">if</span>(t[p].cnt) ord[++top] = p;</span><br><span class="line">  <span class="built_in">dfs</span>(t[p].rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, p = ord[mid];</span><br><span class="line">  t[p].ls = <span class="built_in">build</span>(l, mid<span class="number">-1</span>);</span><br><span class="line">  t[p].rs = <span class="built_in">build</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(p);</span><br><span class="line">  p = <span class="built_in">build</span>(<span class="number">1</span>, top);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  p = ++tot;</span><br><span class="line">  t[p].val = v, t[p].ls = t[p].rs = <span class="number">0</span>;</span><br><span class="line">  t[p].cnt = t[p].sz = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="built_in">newnode</span>(p, v);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==t[p].val) t[p].cnt++;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="built_in">ins</span>(t[p].ls, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">ins</span>(t[p].rs, v);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">bad</span>(p)) <span class="built_in">rebuild</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(v==t[p].val) t[p].cnt--;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="built_in">del</span>(t[p].ls, v);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">del</span>(t[p].rs, v);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">bad</span>(p)) <span class="built_in">rebuild</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Less</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v, <span class="type">bool</span> eq)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].cnt&amp;&amp;v==t[p].val) <span class="keyword">return</span> t[t[p].ls].sz + t[p].cnt*eq;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="keyword">return</span> <span class="built_in">Less</span>(t[p].ls, v, eq);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> t[t[p].ls].sz + t[p].cnt + <span class="built_in">Less</span>(t[p].rs, v, eq);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(t[t[p].ls].sz+t[p].cnt&gt;=k) <span class="keyword">return</span> t[p].val;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[p].cnt-t[t[p].ls].sz);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="fhq-treap"><a class="header-anchor" href="#fhq-treap">Â¶</a>fhq treap</h2><p>ç»´æŠ¤åŒºé—´çš„ï¼ˆæŒ‰sizeåˆ†è£‚ï¼‰ï¼Œå¸¦æœ‰upã€downä»¥åŠfaçš„ç»´æŠ¤</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnd</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>|<span class="built_in">rand</span>(); &#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> fa, key, sz;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = ++tot;</span><br><span class="line">  t[p].ls = t[p].rs = t[p].fa = <span class="number">0</span>;</span><br><span class="line">  t[p].key = <span class="built_in">rnd</span>();</span><br><span class="line">  t[p].sz = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y, <span class="type">int</span> k, <span class="type">int</span> fx=<span class="number">0</span>, <span class="type">int</span> fy=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; x = y = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz)</span><br><span class="line">  &#123;</span><br><span class="line">    y = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].ls, x, t[p].ls, k, fx, p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    x = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].rs, t[p].rs, y, k-t[t[p].ls].sz<span class="number">-1</span>, p, fy);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(x) t[x].fa = fx;</span><br><span class="line">  <span class="keyword">if</span>(y) t[y].fa = fy;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) &#123; p = x|y; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[x].key&lt;t[y].key)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">down</span>(x);</span><br><span class="line">    p = x;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].rs, t[p].rs, y);</span><br><span class="line">    t[t[p].rs].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">down</span>(y);</span><br><span class="line">    p = y;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].ls, x, t[p].ls);</span><br><span class="line">    t[t[p].ls].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">downall</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">downall</span>(t[p].fa);</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">downall</span>(p);</span><br><span class="line">  <span class="type">int</span> rk = t[t[p].ls].sz + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(t[p].fa)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(t[t[p].fa].rs==p) rk += t[t[p].fa].sz - t[p].sz;</span><br><span class="line">    p = t[p].fa;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> rk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(k==t[t[p].ls].sz+<span class="number">1</span>) <span class="keyword">return</span> t[p].c;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[t[p].ls].sz<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="splay"><a class="header-anchor" href="#splay">Â¶</a>splay</h2><p>ç»´æŠ¤åŒºé—´ï¼Œæ³¨æ„åŠæ—¶upï¼Œåªéœ€è¦åœ¨kthä¸­downå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> rt;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], fa[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> l = ch[p][<span class="number">0</span>], r = ch[p][<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> p = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  sz[p] = <span class="number">1</span>, fa[p] = f, ch[f][p&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">build</span>(l, p<span class="number">-1</span>, p); <span class="built_in">build</span>(p+<span class="number">1</span>, r, p);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">split</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, r+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="keyword">return</span> ch[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="LCT"><a class="header-anchor" href="#LCT">Â¶</a>LCT</h2><p>ç»´æŠ¤è¾¹æƒï¼šæ‹†ç‚¹<br>ç»´æŠ¤è¾¹åŒï¼šæ¯æ¬¡åŠ è¾¹ï¼Œå¦‚æœä¸¤ç«¯ç‚¹å·²ç»è¿é€šï¼Œåˆ™ç”¨å¹¶æŸ¥é›†ç¼©èµ·æ¥ï¼Œç„¶ååœ¨accessçš„æ—¶å€™ï¼Œx=fa[x]=find(fa[x])</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], fa[N], rev[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">notrt</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">0</span>]==x || ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">  rev[x] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(rev[x])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(ch[x][<span class="number">0</span>]) <span class="built_in">reverse</span>(ch[x][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span>(ch[x][<span class="number">1</span>]) <span class="built_in">reverse</span>(ch[x][<span class="number">1</span>]);</span><br><span class="line">    rev[x] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">notrt</span>(x)) <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">  <span class="built_in">down</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">notrt</span>(y)) ch[z][ch[z][<span class="number">1</span>]==y] = x;</span><br><span class="line">    ch[y][k] = ch[x][!k]; fa[ch[x][!k]] = y;</span><br><span class="line">    ch[x][!k] = y, fa[y] = x, fa[x] = z;</span><br><span class="line">    <span class="built_in">up</span>(y), <span class="built_in">up</span>(x), <span class="built_in">up</span>(z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">pushall</span>(x);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> f=fa[x]; f=fa[x], <span class="built_in">notrt</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">notrt</span>(f)) <span class="built_in">rotate</span>(<span class="built_in">rs</span>(x) == <span class="built_in">rs</span>(f) ? f : x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> y=<span class="number">0</span>; x; y=x, x=fa[x])</span><br><span class="line">    <span class="built_in">splay</span>(x), ch[x][<span class="number">1</span>] = y, <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">makert</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">access</span>(x); <span class="built_in">splay</span>(x);</span><br><span class="line">  <span class="built_in">reverse</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">findrt</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">access</span>(x); <span class="built_in">splay</span>(x);</span><br><span class="line">  <span class="keyword">while</span>(ch[x][<span class="number">0</span>]) <span class="built_in">down</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">splay</span>(x);</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">makert</span>(x);</span><br><span class="line">  <span class="built_in">access</span>(y); <span class="built_in">splay</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">makert</span>(x);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">findrt</span>(y)!=x) fa[x] = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">makert</span>(x);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">findrt</span>(y)==x&amp;&amp;fa[y]==x&amp;&amp;!ch[y][<span class="number">0</span>])</span><br><span class="line">  &#123;</span><br><span class="line">    fa[y] = ch[x][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">up</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å“ˆå¸Œè¡¨"><a class="header-anchor" href="#å“ˆå¸Œè¡¨">Â¶</a>å“ˆå¸Œè¡¨</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">2174729</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">HashTable</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span> &#123; <span class="type">int</span> next, v; ull k; &#125;e[M+<span class="number">5</span>];</span><br><span class="line">  <span class="type">int</span> head[M], st[N], tp, sz;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(ull k)</span> </span>&#123; <span class="keyword">return</span> k % M; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; sz = <span class="number">0</span>; <span class="keyword">while</span>(tp) head[st[tp--]] = <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(ull k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">f</span>(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> p = head[t]; p; p = e[p].next)</span><br><span class="line">      <span class="keyword">if</span>(e[p].k==k) <span class="keyword">return</span> e[p].v;</span><br><span class="line">    ++sz;</span><br><span class="line">    e[sz] = &#123;head[t], sz, k&#125;;</span><br><span class="line">    head[t] = sz; st[++tp] = t;</span><br><span class="line">    <span class="keyword">return</span> sz;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å“ˆå¸Œset"><a class="header-anchor" href="#å“ˆå¸Œset">Â¶</a>å“ˆå¸Œset</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">HashSet</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span> &#123; <span class="type">int</span> next; ull k; &#125;e[M+<span class="number">5</span>];</span><br><span class="line">  <span class="type">int</span> head[M], st[N], tp, sz;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(ull k)</span> </span>&#123; <span class="keyword">return</span> k % M; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; sz = <span class="number">0</span>; <span class="keyword">while</span>(tp) head[st[tp--]] = <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">get</span><span class="params">(ull k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> p = head[<span class="built_in">f</span>(k)]; p; p = e[p].next)</span><br><span class="line">      <span class="keyword">if</span>(e[p].k==k) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(ull k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">get</span>(k)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">f</span>(k);</span><br><span class="line">    e[++sz] = &#123;head[t], k&#125;;</span><br><span class="line">    head[t] = sz; st[++tp] = t;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="gp-hash"><a class="header-anchor" href="#gp-hash">Â¶</a>gp_hash</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">custom_hash</span> &#123;</span><br><span class="line">  <span class="function"><span class="type">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">uint64_t</span> x)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">uint64_t</span> FIXED_RANDOM = chrono::steady_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>();</span><br><span class="line">    <span class="keyword">return</span> x + FIXED_RANDOM;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">custom_hash</span> &#123;</span><br><span class="line">  <span class="function"><span class="type">static</span> <span class="type">uint64_t</span> <span class="title">splitmix64</span><span class="params">(<span class="type">uint64_t</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// http://xorshift.di.unimi.it/splitmix64.c</span></span><br><span class="line">    x += <span class="number">0x9e3779b97f4a7c15</span>;</span><br><span class="line">    x = (x ^ (x &gt;&gt; <span class="number">30</span>)) * <span class="number">0xbf58476d1ce4e5b9</span>;</span><br><span class="line">    x = (x ^ (x &gt;&gt; <span class="number">27</span>)) * <span class="number">0x94d049bb133111eb</span>;</span><br><span class="line">    <span class="keyword">return</span> x ^ (x &gt;&gt; <span class="number">31</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">uint64_t</span> x)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">uint64_t</span> FIXED_RANDOM = chrono::steady_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">splitmix64</span>(x + FIXED_RANDOM);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">int</span>, custom_hash&gt;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">bool</span>&gt;</span><br><span class="line">gp_hash_table&lt;ull, null_type&gt;</span><br></pre></td></tr></table></figure><h2 id="bitsetå‹ä½-64ä½å’Œ32ä½é€Ÿåº¦å·®ä¸å¤š"><a class="header-anchor" href="#bitsetå‹ä½-64ä½å’Œ32ä½é€Ÿåº¦å·®ä¸å¤š">Â¶</a>bitsetå‹ä½(64ä½å’Œ32ä½é€Ÿåº¦å·®ä¸å¤š)</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Bitset</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">using</span> uint = <span class="type">uint32_t</span>;</span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> B = <span class="number">32</span>;</span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> uint up = numeric_limits&lt;uint&gt;::<span class="built_in">max</span>();</span><br><span class="line">  vector&lt;uint&gt; b; <span class="type">int</span> sz;</span><br><span class="line">  <span class="built_in">Bitset</span>(<span class="type">int</span> _sz=<span class="number">0</span>) &#123; sz = _sz; b.<span class="built_in">resize</span>((sz+B<span class="number">-1</span>)/B, <span class="number">0</span>); &#125;</span><br><span class="line">  Bitset <span class="keyword">operator</span> | (<span class="type">const</span> Bitset &amp;oth) <span class="type">const</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="function">Bitset <span class="title">res</span><span class="params">(sz)</span></span>;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i+<span class="number">3</span>&lt;(<span class="type">int</span>)b.<span class="built_in">size</span>(); i+=<span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      res.b[i] = b[i] | oth.b[i];</span><br><span class="line">      res.b[i+<span class="number">1</span>] = b[i+<span class="number">1</span>] | oth.b[i+<span class="number">1</span>];</span><br><span class="line">      res.b[i+<span class="number">2</span>] = b[i+<span class="number">2</span>] | oth.b[i+<span class="number">2</span>];</span><br><span class="line">      res.b[i+<span class="number">3</span>] = b[i+<span class="number">3</span>] | oth.b[i+<span class="number">3</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;(<span class="type">int</span>)b.<span class="built_in">size</span>())</span><br><span class="line">      res.b[i] = b[i] | oth.b[i], i++;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">set</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; b[p/B] |= (<span class="number">1ull</span>&lt;&lt;(p%B)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">reset</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; b[p/B] &amp;= (up^(<span class="number">1ull</span>&lt;&lt;(p%B))); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span> </span>&#123; (v ? <span class="built_in">set</span>(p) : <span class="built_in">reset</span>(p)); &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">get</span><span class="params">(uint x, <span class="type">int</span> bit)</span> </span>&#123; <span class="keyword">return</span> (x&gt;&gt;bit)&amp;<span class="number">1</span>; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getf0</span><span class="params">(uint x)</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;B; i++) <span class="keyword">if</span>(!<span class="built_in">get</span>(x, i)) <span class="keyword">return</span> i; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getf1</span><span class="params">(uint x)</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;B; i++) <span class="keyword">if</span>(<span class="built_in">get</span>(x, i)) <span class="keyword">return</span> i; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getl0</span><span class="params">(uint x)</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=B<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) <span class="keyword">if</span>(!<span class="built_in">get</span>(x, i)) <span class="keyword">return</span> i; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getl1</span><span class="params">(uint x)</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=B<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) <span class="keyword">if</span>(<span class="built_in">get</span>(x, i)) <span class="keyword">return</span> i; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findr0</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = x/B, q = x%B;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=q; i&lt;B; i++) <span class="keyword">if</span>(!<span class="built_in">get</span>(b[p], i)) <span class="keyword">return</span> x+i-q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>; i&lt;(<span class="type">int</span>)b.<span class="built_in">size</span>(); i++)</span><br><span class="line">      <span class="keyword">if</span>(b[i]!=up) <span class="keyword">return</span> x+B<span class="number">-1</span>-q+(i-p<span class="number">-1</span>)*B+<span class="built_in">getf0</span>(b[i])+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> sz + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findr1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = x/B, q = x%B;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=q; i&lt;B; i++) <span class="keyword">if</span>(<span class="built_in">get</span>(b[p], i)) <span class="keyword">return</span> x+i-q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p+<span class="number">1</span>; i&lt;(<span class="type">int</span>)b.<span class="built_in">size</span>(); i++)</span><br><span class="line">      <span class="keyword">if</span>(b[i]) <span class="keyword">return</span> x+B<span class="number">-1</span>-q+(i-p<span class="number">-1</span>)*B+<span class="built_in">getf1</span>(b[i])+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> sz + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findl0</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = x/B, q = x%B;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=q; i&gt;=<span class="number">0</span>; i--) <span class="keyword">if</span>(!<span class="built_in">get</span>(b[p], i)) <span class="keyword">return</span> x+i-q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">      <span class="keyword">if</span>(b[i]!=up) <span class="keyword">return</span> x-q-(p<span class="number">-1</span>-i)*B-(B-<span class="built_in">getl0</span>(b[i]));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findl1</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = x/B, q = x%B;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=q; i&gt;=<span class="number">0</span>; i--) <span class="keyword">if</span>(<span class="built_in">get</span>(b[p], i)) <span class="keyword">return</span> x+i-q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=p<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">      <span class="keyword">if</span>(b[i]) <span class="keyword">return</span> x-q-(p<span class="number">-1</span>-i)*B-(B-<span class="built_in">getl1</span>(b[i]));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Honorable Mention å¹³è¡¡æ ‘+æ ‘çŠ¶æ•°ç»„</title>
      <link href="/2020/12/13/honorable-mention-ping-heng-shu-shu-zhuang-shu-zu/"/>
      <url>/2020/12/13/honorable-mention-ping-heng-shu-shu-zhuang-shu-zu/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ’åˆ—$p_i$â€‹ï¼Œè¡¨ç¤ºç¬¬iä¸ªäººçš„æ’åï¼Œè¦æ±‚æ”¯æŒä¸¤ç§æ“ä½œï¼š</p><ul><li>ç¬¬xä¸ªäººçš„æ’åä¸Šå‡åˆ°yï¼Œæ˜¾ç„¶åŸæ¥y$\sim$rank(x)-1çš„äººçš„æ’åå°±è¦ä¸‹é™1</li><li>é—®ç¬¬xåˆ°ç¬¬yä¸ªäººä¸­æœ‰å¤šå°‘äººçš„æ’ååœ¨å40%</li></ul><p>æˆ‘ä»¬å‘ç°ç¬¬ä¸€ä¸ªæ“ä½œéœ€è¦ä»¥æ’åä¸ºä¸‹æ ‡è¿›è¡Œç»´æŠ¤ï¼Œè€Œç¬¬äºŒä¸ªæ“ä½œåˆéœ€è¦ä»¥ç¼–å·ä¸ºä¸‹æ ‡è¿›è¡Œç»´æŠ¤ã€‚ä¼¼ä¹ä¸å¤ªå¯åšã€‚<br>ä½†æ˜¯ä»”ç»†æƒ³æƒ³ï¼Œå¯¹äºå40%ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒè°åœ¨å‰è°åœ¨åï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“å“ªäº›äººæ˜¯åœ¨å40%<br>é‚£ä¹ˆç”¨ä¸€ä¸ªæ ‘çŠ¶æ•°ç»„ï¼Œä»¥ç¼–å·ä¸ºä¸‹æ ‡ç»´æŠ¤å“ªäº›äººæ˜¯å40%<br>ç„¶åç”¨ä¸€ä¸ªå¹³è¡¡æ ‘ï¼Œä»¥æ’åä¸ºä¸‹æ ‡æ¥ç»´æŠ¤ç¬¬ä¸€ä¸ªæ“ä½œã€‚<br>å½“xçš„æ’ååŸå…ˆåœ¨å40%ï¼Œç„¶åæå‡åä¸å†å40%ï¼Œå°±éœ€è¦å¯¹æ ‘çŠ¶æ•°ç»„çš„x-1ï¼Œç„¶åå¯¹åŸæ¥æ’å40%çš„é‚£ä¸ªåœ¨æ ‘çŠ¶æ•°ç»„ä¸­+1ã€‚ç„¶ååªéœ€è¦å°†xè¿™ä¸ªèŠ‚ç‚¹åˆ æ‰ï¼Œå†æ’åˆ°æ’åä¸ºyèŠ‚ç‚¹çš„å‰é¢å°±å¯ä»¥äº†ã€‚<br>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œxçš„æ’åæ€ä¹ˆæ±‚ï¼Œæˆ‘ä»¬ä»¥æ’åä¸ºä¸‹æ ‡æ€ä¹ˆæ±‚æ’åå‘¢ã€‚<br>å®¹æ˜“å‘ç°å¯¹äºæ¯ä¸ªç¼–å·åœ¨å¹³è¡¡æ ‘ä¸­çš„èŠ‚ç‚¹æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨æ•°ç»„ä¿å­˜xæ˜¯å¹³è¡¡æ ‘ä¸­çš„å“ªä¸ªèŠ‚ç‚¹ï¼Œç„¶åæŠŠå®ƒsplayåˆ°æ ¹ï¼Œåˆ™å·¦å„¿å­çš„size+1å°±æ˜¯æ’åäº†ã€‚<br>æœ€åä¸è¦å¿˜è®°åœ¨splayä¸­å‰åå„æ’å…¥ä¸€ä¸ªå“¨å…µï¼ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, q, p[N], rp[N];</span><br><span class="line"><span class="type">int</span> c[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) c[i] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += c[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> rt;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], val[N], fa[N], id[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; <span class="keyword">if</span>(p) sz[p] = sz[ch[p][<span class="number">0</span>]] + sz[ch[p][<span class="number">1</span>]] + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bld</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> p = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  sz[p] = <span class="number">1</span>;</span><br><span class="line">  ch[p][<span class="number">0</span>] = ch[p][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(p&gt;=<span class="number">2</span>&amp;&amp;p&lt;=n+<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    val[p] = rp[p<span class="number">-1</span>];</span><br><span class="line">    id[rp[p<span class="number">-1</span>]] = p;</span><br><span class="line">  &#125;</span><br><span class="line">  fa[p] = f, ch[f][p&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">bld</span>(l, p<span class="number">-1</span>, p); <span class="built_in">bld</span>(p+<span class="number">1</span>, r, p);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnk</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">splay</span>(p);</span><br><span class="line">  <span class="keyword">return</span> sz[ch[p][<span class="number">0</span>]] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, l+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="type">int</span> z = ch[y][<span class="number">0</span>];</span><br><span class="line">  ch[y][<span class="number">0</span>] = <span class="number">0</span>; fa[z] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">  <span class="type">int</span> x2 = <span class="built_in">kth</span>(rt, r<span class="number">-1</span>), y2 = <span class="built_in">kth</span>(rt, r);</span><br><span class="line">  <span class="built_in">splay</span>(x2); <span class="built_in">splay</span>(y2, x2);</span><br><span class="line">  ch[y2][<span class="number">0</span>] = z; fa[z] = y2;</span><br><span class="line">  <span class="built_in">up</span>(y2); <span class="built_in">up</span>(fa[y2]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, p+i);</span><br><span class="line">    rp[p[i]] = i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">  <span class="type">int</span> lim = n*<span class="number">0.6</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) c[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=lim+<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">upd</span>(rp[i], <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">bld</span>(<span class="number">1</span>, n+<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  rt = (n+<span class="number">3</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(y&lt;=lim)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> rkx = <span class="built_in">rnk</span>(id[x]) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(rkx&gt;lim)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">upd</span>(x, <span class="number">-1</span>);</span><br><span class="line">          <span class="built_in">upd</span>(val[<span class="built_in">kth</span>(rt, lim+<span class="number">1</span>)], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">ins</span>(rkx+<span class="number">1</span>, y+<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">ask</span>(y)-<span class="built_in">ask</span>(x<span class="number">-1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rope å—çŠ¶é“¾è¡¨å®ç°çš„STLå®¹å™¨</title>
      <link href="/2020/12/13/rope-kuai-zhuang-lian-biao-shi-xian-de-stl-rong-qi/"/>
      <url>/2020/12/13/rope-kuai-zhuang-lian-biao-shi-xian-de-stl-rong-qi/</url>
      
        <content type="html"><![CDATA[<p>crope = ropeï¼ˆå¯ä»¥ç›´æ¥cin coutï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¾ƒå¿«é€Ÿçš„è§£å†³åŒºé—´ç§»åŠ¨ã€åŒºé—´æ’å…¥åˆ é™¤ã€åŒºé—´ç¿»è½¬é—®é¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rp.<span class="built_in">push_back</span>(x); <span class="comment">// åœ¨æœ«å°¾æ’å…¥ x</span></span><br><span class="line">rp.<span class="built_in">insert</span>(pos, x); <span class="comment">// ä»pos å¤„æ’å…¥ä¸€ä¸ªæ•°ç»„x</span></span><br><span class="line">rp.<span class="built_in">erase</span>(pos, x); <span class="comment">// ä»pos å¤„åˆ é™¤ x ä¸ªå…ƒç´ </span></span><br><span class="line">rp.<span class="built_in">length</span>(); <span class="comment">// è¿”å› rp çš„å¤§å°</span></span><br><span class="line">rp.<span class="built_in">size</span>(); <span class="comment">// åŒä¸Š</span></span><br><span class="line">rp.<span class="built_in">replace</span>(pos, x); <span class="comment">// å°† pos å¤„çš„å…ƒç´ æ›¿æ¢æˆ x</span></span><br><span class="line">rp.<span class="built_in">substr</span>(pos, x); <span class="comment">// ä» pos å¤„å¼€å§‹æå– x ä¸ªå…ƒç´ </span></span><br><span class="line">rp.<span class="built_in">copy</span>(pos, x, s); <span class="comment">// ä» pos å¤„å¼€å§‹å¤åˆ¶ x ä¸ªå…ƒç´ åˆ° s(string or char*(æœ«å°¾è¦æ‰‹åŠ¨åŠ 0)) ä¸­</span></span><br><span class="line">rp[x]; <span class="comment">// è®¿é—®ç¬¬ x ä¸ªå…ƒç´ </span></span><br><span class="line">rp.<span class="built_in">at</span>(x); <span class="comment">// åŒä¸Š</span></span><br><span class="line"><span class="keyword">operator</span>.+() <span class="comment">//æ‹¼æ¥æ“ä½œï¼Œå¾ˆå¿«é€Ÿ</span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line">rope&lt;<span class="type">int</span>&gt;s;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n,m,k,l;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)s.<span class="built_in">push_back</span>(i);</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;l,&amp;k);</span><br><span class="line">    s=s.<span class="built_in">substr</span>(l<span class="number">-1</span>,k)+s.<span class="built_in">substr</span>(<span class="number">0</span>,l<span class="number">-1</span>)+s.<span class="built_in">substr</span>(l+k<span class="number">-1</span>,n+<span class="number">1</span>-k-l);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> c:s)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,c);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line">rope&lt;<span class="type">int</span>&gt;a;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">int</span> n,m,x,y;</span><br><span class="line">  cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">    a.<span class="built_in">push_back</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">    cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">    a.<span class="built_in">insert</span>(<span class="number">0</span>,a.<span class="built_in">substr</span>(x<span class="number">-1</span>,y));</span><br><span class="line">    a.<span class="built_in">erase</span>(x+y<span class="number">-1</span>,y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span><br><span class="line">      cout&lt;&lt;a[i];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      cout&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;a[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cã€Shuffle Cards åŒºé—´ç§»ä½ splay</title>
      <link href="/2020/12/12/cshuffle-cards-qu-jian-yi-wei-splay/"/>
      <url>/2020/12/12/cshuffle-cards-qu-jian-yi-wei-splay/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ä¸ªåºåˆ—åˆå§‹ä¸º1-nçš„æ’åˆ—ï¼Œç°åœ¨æœ‰mæ¬¡æ“ä½œï¼Œå°†ä¸€ä¸ªåŒºé—´ç§»åˆ°æœ€å‰é¢ã€‚<br>é—®æ‰€æœ‰æ“ä½œç»“æŸåçš„åºåˆ—æ˜¯ä»€ä¹ˆ</p><p>çªç„¶å‘ç°æ²¡æœ‰å†™è¿‡åŒºé—´å¹³ç§»çš„é—®é¢˜ï¼Œç„¶åå»æ‰¾äº†ä¸€é“ï¼Œç„¶åå°±è°ƒäº†2å°æ—¶ï¼Œå¾ˆéš¾å—ã€‚</p><p>ç½—åˆ—ä¸€ä¸‹å‡ ä¸ªæ˜“é”™ç‚¹ï¼š<br>pushupçš„æ—¶å€™æœ€å¥½ç‰¹åˆ¤ä¸€ä¸‹p==0ï¼Œè¿™æ—¶å€™å°±ç›´æ¥returnï¼Œå¦åˆ™æ€»æ„Ÿè§‰å®¹æ˜“å‡ºé—®é¢˜<br>splayä¸€ä¸ªä¸å¥½çš„åœ°æ–¹å°±æ˜¯è¦åŠ å“¨å…µï¼Œåæ­£å·¦åå„åŠ ä¸€ä¸ªå°±å®Œäº‹äº†<br>å·æ‡’æŠŠå–åŒºé—´å†™äº†ä¸ªsplitï¼Œç„¶åå°±å¯¼è‡´äº†ä¸€ä¸ªé—®é¢˜ï¼ˆbugæ ¹æºï¼‰<br>å½“è¦æå–çš„åŒºé—´æ˜¯ä¸€ä¸ªç©ºåŒºé—´å°±ä¼šå‡ºç°å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ï¼ˆæ’å…¥å’Œåˆ é™¤çš„æ—¶å€™éœ€è¦ï¼‰ï¼Œå› ä¸ºè¿™æ—¶å€™å®ƒä¼šè¿”å›0ï¼Œæˆ‘å°±æ²¡åŠæ³•ç»´æŠ¤æˆ‘æœ¬æ¥éœ€è¦çš„è¿”å›èŠ‚ç‚¹çš„çˆ¶äº²äº†ã€‚<br>æ‰€ä»¥æœ€å¥½è¿˜æ˜¯ä¸è¦å†™splitå‡½æ•°äº†ğŸ˜­</p><p>è¯´ä¸€ä¸‹åŒºé—´å¹³ç§»æ€ä¹ˆåš<br>å…¶å®å°±æ˜¯åŒºé—´æ’å…¥é—®é¢˜ï¼Œå…ˆæŠŠä¸€ä¸ªåŒºé—´æå–å‡ºæ¥ï¼ŒæŠŠè¿™ä¸ªåŒºé—´åˆ é™¤æ‰ï¼Œç„¶åå‡è®¾è¿™ä¸ªèŠ‚ç‚¹è¦æ’å…¥åˆ°pï¼ˆè¦æ³¨æ„å‰é¢è¿™ä¸ªåŒºé—´åˆ é™¤å¸¦æ¥çš„å½±å“ï¼‰èŠ‚ç‚¹çš„åé¢ï¼Œé‚£å°±æŠŠpè½¬åˆ°æ ¹ï¼Œp+1è½¬åˆ°pçš„å„¿å­ï¼Œåˆ™æŠŠåˆšæ‰æå–çš„åŒºé—´æ’åˆ°p+1çš„å·¦å„¿å­å°±å¯ä»¥äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> rt;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], fa[N], val[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">if</span>(!x) <span class="keyword">return</span>; sz[x] = sz[ch[x][<span class="number">0</span>]] + sz[ch[x][<span class="number">1</span>]] + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> p = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  sz[p] = <span class="number">1</span>, fa[p] = f, val[p] = p;</span><br><span class="line">  ch[f][p&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">build</span>(l, p<span class="number">-1</span>, p), <span class="built_in">build</span>(p+<span class="number">1</span>, r, p);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">go</span>(ch[p][<span class="number">0</span>]);</span><br><span class="line">  <span class="keyword">if</span>(val[p]&gt;=<span class="number">2</span> &amp;&amp; val[p]&lt;=n+<span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, val[p]<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">go</span>(ch[p][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, n+<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  rt = (n+<span class="number">3</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">    ++a;</span><br><span class="line">    <span class="type">int</span> x = <span class="built_in">kth</span>(rt, <span class="number">1</span>), y = <span class="built_in">kth</span>(rt, a);</span><br><span class="line">    <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">    <span class="type">int</span> z = ch[y][<span class="number">0</span>];</span><br><span class="line">    fa[z] = <span class="number">0</span>;</span><br><span class="line">    ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">    <span class="type">int</span> tx = <span class="built_in">kth</span>(rt, b+<span class="number">1</span>), ty = <span class="built_in">kth</span>(rt, b+<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">splay</span>(tx); <span class="built_in">splay</span>(ty, tx);</span><br><span class="line">    ch[ty][<span class="number">0</span>] = z;</span><br><span class="line">    fa[z] = ty;</span><br><span class="line">    <span class="built_in">up</span>(ty); <span class="built_in">up</span>(fa[ty]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">go</span>(rt);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P2042 [NOI2005]ç»´æŠ¤æ•°åˆ—</title>
      <link href="/2020/12/11/p2042-noi2005wei-hu-shu-lie/"/>
      <url>/2020/12/11/p2042-noi2005wei-hu-shu-lie/</url>
      
        <content type="html"><![CDATA[<p>å¤§æ¯’ç˜¤é¢˜<br>åŒºé—´æ’å…¥ï¼ŒåŒºé—´åˆ é™¤ï¼ŒåŒºé—´è¦†ç›–ï¼ŒåŒºé—´ç¿»è½¬ï¼ŒåŒºé—´å’Œï¼ŒåŒºé—´æœ€å¤§å­æ®µå’Œ</p><p>åªè¯´ä¸€ä¸‹splayçš„è¯ï¼ŒåŒºé—´æ’å…¥å’Œåˆ é™¤æ€ä¹ˆåš<br>æ’å…¥ï¼šå…ˆæŠŠæ’å…¥çš„æ‰€æœ‰èŠ‚ç‚¹æŒ‰ç…§ä¸­åºéå†å»ºæˆä¸€æ£µå¹³è¡¡æ ‘ï¼Œç„¶åæŠŠlè½¬åˆ°æ ¹ï¼Œl+1è½¬åˆ°lçš„å„¿å­ï¼Œé‚£ä¹ˆç›´æ¥æŠŠè¿™é¢—å¹³è¡¡æ ‘çš„æ ¹ä½œä¸ºl+1çš„å·¦å„¿å­å³å¯<br>åˆ é™¤ï¼šåŒæ ·çš„ï¼ŒæŠŠl-1è½¬åˆ°æ ¹ï¼Œr+1è½¬åˆ°l-1çš„å„¿å­ï¼Œç„¶åç›´æ¥æŠŠrçš„å·¦å„¿å­å˜æˆ0å³å¯ã€‚è¿™é“é¢˜æ“ä½œæ¯”è¾ƒå¤šï¼Œéœ€è¦è€ƒè™‘ç©ºé—´å›æ”¶ã€‚å¾ˆç®€å•ï¼Œåªè¦æŠŠè¿™è¯¾ä¸¢æ‰çš„æ ‘éå†ä¸€ä¸‹æ¯ä¸ªèŠ‚ç‚¹çš„ç¼–å·å¡åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶åæ¯æ¬¡æ–°å¼€èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå¦‚æœæ•°ç»„ä¸­æœ‰ç¼–å·å°±ç›´æ¥å–ä¸€ä¸ªï¼Œå¦åˆ™å†æ–°å¼€èŠ‚ç‚¹ï¼Œä¸è¿‡å¤ç”¨èŠ‚ç‚¹è¦æ³¨æ„ä¿¡æ¯çš„æ¸…ç©ºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e6</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="type">int</span> n, m, a[N], id[N];</span><br><span class="line"><span class="type">int</span> buc[N], tp;</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (tp ? buc[tp--] : ++tot); &#125;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], val[N], sum[N], mx[N], lx[N], rx[N], fa[N];</span><br><span class="line"><span class="type">bool</span> same[N], rev[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> l = ch[p][<span class="number">0</span>], r = ch[p][<span class="number">1</span>];</span><br><span class="line">  sum[p] = sum[l] + sum[r] + val[p];</span><br><span class="line">  sz[p] = sz[l] + sz[r] + <span class="number">1</span>;</span><br><span class="line">  mx[p] = <span class="built_in">max</span>(&#123;mx[l], mx[r], rx[l]+lx[r]+val[p]&#125;);</span><br><span class="line">  lx[p] = <span class="built_in">max</span>(lx[l], sum[l]+val[p]+lx[r]);</span><br><span class="line">  rx[p] = <span class="built_in">max</span>(rx[r], sum[r]+val[p]+rx[l]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  val[p] = v, sum[p] = v*sz[p];</span><br><span class="line">  lx[p] = rx[p] = (sum[p]&gt;<span class="number">0</span> ? sum[p] : <span class="number">0</span>);</span><br><span class="line">  mx[p] = (sum[p]&gt;<span class="number">0</span> ? sum[p] : val[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setrev</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">swap</span>(ch[p][<span class="number">0</span>], ch[p][<span class="number">1</span>]);</span><br><span class="line">  <span class="built_in">swap</span>(lx[p], rx[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = ch[p][<span class="number">0</span>], r = ch[p][<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span>(same[p])</span><br><span class="line">  &#123;</span><br><span class="line">    same[l] = <span class="number">1</span>, <span class="built_in">setv</span>(l, val[p]);</span><br><span class="line">    same[r] = <span class="number">1</span>, <span class="built_in">setv</span>(r, val[p]);</span><br><span class="line">    same[p] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(rev[p])</span><br><span class="line">  &#123;</span><br><span class="line">    rev[l] ^= <span class="number">1</span>, <span class="built_in">setrev</span>(l);</span><br><span class="line">    rev[r] ^= <span class="number">1</span>, <span class="built_in">setrev</span>(r);</span><br><span class="line">    rev[p] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x], z = fa[y];</span><br><span class="line">    <span class="keyword">if</span>(z!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">split</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, r+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="keyword">return</span> ch[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">makesame</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setv</span>(x, v), same[x] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setrev</span>(x), rev[x] ^= <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rec</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> l = ch[x][<span class="number">0</span>], r = ch[x][<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">rec</span>(l); <span class="built_in">rec</span>(r);</span><br><span class="line">  buc[++tp] = x;</span><br><span class="line">  fa[x] = ch[x][<span class="number">0</span>] = ch[x][<span class="number">1</span>] = <span class="number">0</span>, rev[x] = same[x] = <span class="number">0</span>;</span><br><span class="line">  sz[x] = val[x] = sum[x] = mx[x] = lx[x] = rx[x] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">rec</span>(ch[y][<span class="number">0</span>]); ch[y][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bld</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, p = id[mid];</span><br><span class="line">  val[p] = a[mid];</span><br><span class="line">  <span class="keyword">if</span>(f) fa[p] = id[f], ch[id[f]][mid&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    mx[p] = sum[p] = a[l];</span><br><span class="line">    same[p] = rev[p] = <span class="number">0</span>;</span><br><span class="line">    lx[p] = rx[p] = <span class="built_in">max</span>(a[l], <span class="number">0</span>);</span><br><span class="line">    sz[p] = <span class="number">1</span>;</span><br><span class="line">    ch[p][<span class="number">0</span>] = ch[p][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">bld</span>(l, mid<span class="number">-1</span>, mid);</span><br><span class="line">  <span class="built_in">bld</span>(mid+<span class="number">1</span>, r, mid);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=r-l+<span class="number">1</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">    id[i] = <span class="built_in">newnode</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">bld</span>(<span class="number">1</span>, r-l+<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l), y = <span class="built_in">kth</span>(rt, l+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="type">int</span> z = id[(r-l+<span class="number">2</span>)&gt;&gt;<span class="number">1</span>];</span><br><span class="line">  fa[z] = y, ch[y][<span class="number">0</span>] = z;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  mx[<span class="number">0</span>] = -inf, a[<span class="number">1</span>] = -inf, a[n+<span class="number">2</span>] = inf;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i+<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n+<span class="number">2</span>; i++) id[i] = <span class="built_in">newnode</span>();</span><br><span class="line">  <span class="built_in">bld</span>(<span class="number">1</span>, n+<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  rt = (n+<span class="number">3</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> com[<span class="number">10</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, com);</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]!=<span class="string">&#x27;M&#x27;</span>||com[<span class="number">2</span>]!=<span class="string">&#x27;X&#x27;</span>) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    ++l, r = l + r - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;I&#x27;</span>) <span class="built_in">ins</span>(l, r);</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>) <span class="built_in">del</span>(l, r);</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;M&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(com[<span class="number">2</span>]==<span class="string">&#x27;X&#x27;</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, mx[<span class="built_in">split</span>(<span class="number">2</span>, sz[rt]<span class="number">-1</span>)]);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;v);</span><br><span class="line">        <span class="built_in">makesame</span>(l, r, v);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>) <span class="built_in">reverse</span>(l, r);</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;G&#x27;</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum[<span class="built_in">split</span>(l, r)]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P3215 [HNOI2011]æ‹¬å·ä¿®å¤ / [JSOI2011]æ‹¬å·åºåˆ—</title>
      <link href="/2020/12/11/p3215-hnoi2011gua-hao-xiu-fu-jsoi2011gua-hao-xu-lie/"/>
      <url>/2020/12/11/p3215-hnoi2011gua-hao-xiu-fu-jsoi2011gua-hao-xu-lie/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œè¦æ±‚æ”¯æŒä¸‹é¢çš„æ“ä½œ</p><ul><li>æ›¿æ¢æŸä¸ªåŒºé—´çš„æ‰€æœ‰æ‹¬å·ä¸ºå·¦æ‹¬å·æˆ–è€…å³æ‹¬å·</li><li>å°†ä¸€ä¸ªåŒºé—´çš„æ‹¬å·è¿›è¡Œç¿»è½¬</li><li>å°†ä¸€ä¸ªåŒºé—´çš„æ‹¬å·è¿›è¡Œåè½¬ï¼Œå·¦æ‹¬å·&lt;-&gt;å³æ‹¬å·</li><li>è¯¢é—®ä¸€ä¸ªåŒºé—´å†…è‡³å°‘æ”¹å˜å‡ ä¸ªæ‹¬å·æ‰èƒ½æˆä¸ºä¸€ä¸ªåˆæ³•çš„æ‹¬å·åºåˆ—</li></ul><p>æ¯’ç˜¤é¢˜<br>ä¸è¿‡æˆ‘è¿è¯¢é—®çš„ç­”æ¡ˆæ˜¯ä»€ä¹ˆéƒ½æƒ³é”™äº†ï¼ˆå¥½èœå•Šï¼‰<br>å…ˆæ¶ˆæ‰åˆæ³•çš„æ‹¬å·ï¼Œæœ€åè‚¯å®šæ˜¯))))((((çš„å½¢å¼ï¼Œç»´æŠ¤åŒºé—´å‰ç¼€æœ€å°å’Œåç¼€æœ€å¤§å³å¯ï¼Œç”±äºæœ‰åè½¬æ“ä½œè¿˜è¦ç»´æŠ¤åŒºé—´å‰ç¼€æœ€å¤§å’Œåç¼€æœ€å°ã€‚<br>æ„Ÿè§‰è‡ªå·±å¯¹å¹³è¡¡æ ‘ç»´æŠ¤çš„é¢˜è¿˜æ˜¯ä¸ç†Ÿï¼Œæ¯æ¬¡éƒ½ä¸€å †é”™è¯¯ã€‚<br>æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯å¿˜è®°äº†æœ¬èŠ‚ç‚¹ä¿¡æ¯ï¼Œä¸»è¦æ˜¯çº¿æ®µæ ‘çš„ä¿¡æ¯å®Œå…¨ç”±å­èŠ‚ç‚¹åˆå¹¶è€Œæ¥ï¼Œä½†æ˜¯åœ¨å¹³è¡¡æ ‘ä¸­æœ¬èŠ‚ç‚¹çš„ä¿¡æ¯æ˜¯ä¸åŒ…å«åœ¨å­èŠ‚ç‚¹ä¸­çš„ã€‚æ­¤å¤–åœ¨å»ºæ ‘çš„æ—¶å€™æ¯ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯éƒ½è¦è®°å½•ä¸‹æ¥ï¼Œè€Œä¸æ˜¯åƒçº¿æ®µæ ‘ä¸€æ ·åªåœ¨å¶å­èŠ‚ç‚¹çš„æ—¶å€™è®°å½•ï¼Œç„¶åå…¶ä½™èŠ‚ç‚¹ç›´æ¥é€šè¿‡pushupå¾—åˆ°å³å¯ï¼Œåˆ‡è®°ï¼ï¼<br>ç„¶åå°±æ˜¯ä¸‹ä¼ æ ‡è®°çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯åè½¬å’Œè¦†ç›–æ“ä½œçš„å…ˆåé¡ºåºä¼šæœ‰å½±å“ï¼Œç„¶åæˆ‘ç«Ÿç„¶å°±ä¸ä¼šäº†ï¼ˆä¸æ˜¯å’ŒåŠ æ³•ä¹˜æ³•ä¸€æ ·å—ï¼Œ <s>å¥½ä¹…æ²¡å†™äº†</s> ï¼‰<br>åœ¨è¦†ç›–çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠåè½¬å’Œç¿»è½¬çš„æ ‡è®°æ¸…é›¶ã€‚<br>åœ¨åè½¬çš„æ—¶å€™ï¼Œéœ€è¦æŠŠè¦†ç›–çš„æ ‡è®°å–åã€‚<br>ç„¶åä¸‹ä¼ çš„æ—¶å€™å…ˆä¼ åè½¬ï¼Œç„¶åå†ä¼ è¦†ç›–ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™è‚¯å®šæ˜¯å…ˆæœ‰åè½¬å†æœ‰è¦†ç›–çš„ï¼Œå¦åˆ™è¦†ç›–ä¼šæŠŠåè½¬çš„æ ‡è®°æ¸…æ‰ã€‚<br>é¡ºä¾¿å›å¿†ä¸€ä¸‹åŠ æ³•å’Œä¹˜æ³•æ ‡è®°ï¼Œåœ¨ä¹˜æ³•çš„æ—¶å€™è¦æŠŠåŠ æ³•æ ‡è®°ä¹Ÿä¹˜ä¸€ä¸‹ï¼Œåœ¨ä¸‹ä¼ çš„æ—¶å€™å…ˆä¼ ä¹˜æ³•å†ä¼ åŠ æ³•ã€‚<br>è¿™ç§å¤šæ ‡è®°çš„é—®é¢˜ï¼Œæœ€å¥½å¯¹æ¯ä¸ªæ ‡è®°å†™ä¸€ä¸ªå‡½æ•°ï¼Œå¦åˆ™ä¼šå¾ˆä¹±ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, q;</span><br><span class="line"><span class="type">char</span> c[N];</span><br><span class="line"><span class="type">int</span> rt;</span><br><span class="line"><span class="type">int</span> ch[N][<span class="number">2</span>], sz[N], val[N], fa[N], lmn[N], rmn[N], lmx[N], rmx[N], sum[N];</span><br><span class="line"><span class="type">int</span> rev[N], cov[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> l = ch[p][<span class="number">0</span>], r = ch[p][<span class="number">1</span>];</span><br><span class="line">  sz[p] = sz[l] + sz[r] + <span class="number">1</span>;</span><br><span class="line">  lmn[p] = <span class="built_in">min</span>(lmn[l], sum[l]+val[p]+lmn[r]);</span><br><span class="line">  lmx[p] = <span class="built_in">max</span>(lmx[l], sum[l]+val[p]+lmx[r]);</span><br><span class="line">  rmn[p] = <span class="built_in">min</span>(rmn[r], sum[r]+val[p]+rmn[l]);</span><br><span class="line">  rmx[p] = <span class="built_in">max</span>(rmx[r], sum[r]+val[p]+rmx[l]);</span><br><span class="line">  sum[p] = sum[l] + sum[r] + val[p];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  val[p] = v, sum[p] = v*sz[p];</span><br><span class="line">  lmn[p] = rmn[p] = <span class="built_in">min</span>(<span class="number">0</span>, sum[p]);</span><br><span class="line">  lmx[p] = rmx[p] = <span class="built_in">max</span>(<span class="number">0</span>, sum[p]);</span><br><span class="line">  cov[p] = v;</span><br><span class="line">  inv[p] = <span class="number">0</span>;</span><br><span class="line">  rev[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setrev</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">swap</span>(ch[p][<span class="number">0</span>], ch[p][<span class="number">1</span>]);</span><br><span class="line">  <span class="built_in">swap</span>(lmn[p], rmn[p]);</span><br><span class="line">  <span class="built_in">swap</span>(lmx[p], rmx[p]);</span><br><span class="line">  rev[p] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setinv</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">swap</span>(lmn[p], lmx[p]);</span><br><span class="line">  <span class="built_in">swap</span>(rmn[p], rmx[p]);</span><br><span class="line">  lmn[p] *= <span class="number">-1</span>;</span><br><span class="line">  lmx[p] *= <span class="number">-1</span>;</span><br><span class="line">  rmn[p] *= <span class="number">-1</span>;</span><br><span class="line">  rmx[p] *= <span class="number">-1</span>;</span><br><span class="line">  sum[p] *= <span class="number">-1</span>;</span><br><span class="line">  val[p] *= <span class="number">-1</span>;</span><br><span class="line">  inv[p] ^= <span class="number">1</span>;</span><br><span class="line">  cov[p] *= <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(inv[p])</span><br><span class="line">  &#123;</span><br><span class="line">    inv[p] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">setinv</span>(ch[p][<span class="number">0</span>]); <span class="built_in">setinv</span>(ch[p][<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cov[p])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setv</span>(ch[p][<span class="number">0</span>], cov[p]); <span class="built_in">setv</span>(ch[p][<span class="number">1</span>], cov[p]);</span><br><span class="line">    cov[p] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(rev[p])</span><br><span class="line">  &#123;</span><br><span class="line">    rev[p] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">setrev</span>(ch[p][<span class="number">0</span>]); <span class="built_in">setrev</span>(ch[p][<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> p = (l+r)&gt;&gt;<span class="number">1</span>, v = (c[p<span class="number">-1</span>]==<span class="string">&#x27;(&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>);</span><br><span class="line">  sz[p] = <span class="number">1</span>, sum[p] = val[p] = v;</span><br><span class="line">  fa[p] = f, ch[f][p&gt;f] = p;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    lmx[p] = rmx[p] = <span class="built_in">max</span>(<span class="number">0</span>, v);</span><br><span class="line">    lmn[p] = rmn[p] = <span class="built_in">min</span>(<span class="number">0</span>, v);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">build</span>(l, p<span class="number">-1</span>, p); <span class="built_in">build</span>(p+<span class="number">1</span>, r, p);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">split</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, r+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="keyword">return</span> ch[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">replace</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setv</span>(x, v);</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setrev</span>(x);</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">invert</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setinv</span>(x);</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, c+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, n+<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  rt = (n+<span class="number">3</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> com[<span class="number">10</span>], cc[<span class="number">2</span>];</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%d%d&quot;</span>, com, &amp;l, &amp;r);</span><br><span class="line">    ++l, ++r;</span><br><span class="line">    <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, cc);</span><br><span class="line">      <span class="built_in">replace</span>(l, r, (cc[<span class="number">0</span>]==<span class="string">&#x27;(&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;Q&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x = <span class="built_in">split</span>(l, r);</span><br><span class="line">      <span class="type">int</span> pmn = lmn[x], smx = rmx[x];</span><br><span class="line">      <span class="type">int</span> y = fa[x];</span><br><span class="line">      <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">      <span class="built_in">assert</span>(pmn&lt;=<span class="number">0</span>); <span class="built_in">assert</span>(smx&gt;=<span class="number">0</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ((-pmn+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>)+((smx+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;S&#x27;</span>) <span class="built_in">reverse</span>(l, r);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(com[<span class="number">0</span>]==<span class="string">&#x27;I&#x27;</span>) <span class="built_in">invert</span>(l, r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³è¡¡æ ‘ä¹‹splay</title>
      <link href="/2020/12/11/ping-heng-shu-zhi-splay/"/>
      <url>/2020/12/11/ping-heng-shu-zhi-splay/</url>
      
        <content type="html"><![CDATA[<p>ä¼¸å±•æ ‘çš„æ ¸å¿ƒæ“ä½œå°±æ˜¯splayäº†ï¼Œå°†æ¯æ¬¡è®¿é—®çš„ç‚¹splayåˆ°æ ¹èŠ‚ç‚¹ï¼ˆç±»ä¼¼è¾“å…¥æ³•ï¼Œé¢‘ç¹æ‰“çš„è¯ä¼šæ¯”è¾ƒé å‰ï¼‰ã€‚è€Œæ­£ç¡®çš„splayæ“ä½œå¯ä»¥ä¿è¯åœ¨å°†xæ—‹è½¬åˆ°æ ¹èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œæ²¿é€”çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹çš„æ·±åº¦éƒ½ä¼šè‡³å°‘å‡å°‘ä¸€åŠï¼Œè¿™ç§è‡ªæˆ‘è°ƒæ•´çš„ç‰¹æ€§ä¿è¯äº†splayæ ‘åœ¨å„ç§æ“ä½œä¸‹å‡æ‘Š$O(\log n)$<br>rotateéœ€è¦åˆ†3ç§æƒ…å†µï¼Œsplayéœ€è¦åˆ†6ç§æƒ…å†µæ¯”è¾ƒéº»çƒ¦ï¼Œä¸å†èµ˜è¿°ï¼ˆ <s>å…¶å®æ˜¯ä¸ä¼š</s> ï¼‰ï¼Œåªç»™å‡ºä»£ç å®ç°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> y = fa[x], z = fa[y], k = <span class="built_in">rs</span>(x), w = ch[x][k^<span class="number">1</span>];</span><br><span class="line">  ch[y][k] = w; fa[w] = y;</span><br><span class="line">  ch[z][<span class="built_in">rs</span>(y)] = x; fa[x] = z;</span><br><span class="line">  ch[x][k^<span class="number">1</span>] = y; fa[y] = x;</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> g=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(fa[x]!=g)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[y]!=g) (<span class="built_in">rs</span>(x)==<span class="built_in">rs</span>(y) ? <span class="built_in">rotate</span>(y) : <span class="built_in">rotate</span>(x));</span><br><span class="line">    <span class="built_in">rotate</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!g) rt = x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>splay(x,g)è¡¨ç¤ºå°†xæ—‹è½¬åˆ°gçš„å„¿å­å¤„ï¼Œå½“g=0æ—¶å³å°†xæ—‹è½¬åˆ°æ ¹ã€‚ç”¨splayæ¥ç»´æŠ¤æƒå€¼å¤§å°æˆ‘è§‰å¾—å¾ˆéº»çƒ¦ï¼Œç é‡å’Œå¸¸æ•°éƒ½æ¯”è¾ƒå¤§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç”¨pbdsæˆ–è€…fhq<br>treapæ›¿ä»£å³å¯ã€‚ä½†æ˜¯ç”¨splayæ¥ç»´æŠ¤åŒºé—´è¿˜æ˜¯éœ€è¦åªè¦çš„ã€‚åšæ³•ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚æœè¦ç»´æŠ¤[l,r]ï¼Œå…ˆæŠŠl-1æ—‹è½¬åˆ°æ ¹ï¼Œå†æŠŠr+1æ—‹è½¬åˆ°l-1çš„å„¿å­ï¼Œé‚£ä¹ˆæ­¤æ—¶r+1çš„å·¦å­æ ‘å°±æ˜¯è¦æ“ä½œçš„[l,r]éƒ¨åˆ†ï¼Œç›´æ¥å¯¹è¿™ä¸ªæ ¹èŠ‚ç‚¹æ‰“ä¸Šç›¸åº”çš„æ ‡è®°å³å¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">split</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">kth</span>(rt, l<span class="number">-1</span>), y = <span class="built_in">kth</span>(rt, r+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">splay</span>(x); <span class="built_in">splay</span>(y, x);</span><br><span class="line">  <span class="keyword">return</span> ch[y][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pushdownæ“ä½œåªéœ€è¦åœ¨kthå‡½æ•°ä¸­è¿›è¡Œå³å¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(ch[p][<span class="number">0</span>]&amp;&amp;sz[ch[p][<span class="number">0</span>]]&gt;=k) <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">0</span>], k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(sz[ch[p][<span class="number">0</span>]]+<span class="number">1</span>==k) <span class="keyword">return</span> p;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(ch[p][<span class="number">1</span>], k-sz[ch[p][<span class="number">0</span>]]<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œpushupæ“ä½œåœ¨æ¯æ¬¡è¿›è¡ŒsplitåŒºé—´æ“ä½œåéƒ½è¦æ‰§è¡Œï¼Œå‡è®¾splitè¿”å›çš„èŠ‚ç‚¹æ˜¯xï¼Œé‚£ä¹ˆå°±è¦pushup(y)ä»¥åŠpushup(fa[y])ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">replace</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">split</span>(l, r), y = fa[x];</span><br><span class="line">  <span class="built_in">setv</span>(x, v);</span><br><span class="line">  <span class="built_in">up</span>(y); <span class="built_in">up</span>(fa[y]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®splayçš„æ‰€æœ‰æ“ä½œéƒ½å¯ä»¥ç”¨fhq<br>treapæ¥æ›¿ä»£ï¼Œä¸è¿‡åœ¨åŒºé—´æ“ä½œä¸­è¦æ‰¾åˆ°åŒºé—´ä¸‹æ ‡xçš„ç‚¹è¿™ä¸€åŠŸèƒ½è¿˜æ˜¯splayæ–¹ä¾¿ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªç‚¹splayåˆ°æ ¹å°±å¯ä»¥äº†ï¼Œè€Œtreapåˆ™éœ€è¦é¢å¤–ç»´æŠ¤çˆ¶äº²ï¼Œè€Œè‡ªä¸‹è€Œä¸Šæ‰¾ã€‚<br>å½“ç„¶splayæ— å¯æ›¿ä»£çš„åœ°æ–¹å°±æ˜¯LCTäº†ï¼Œå¦‚æœç”¨treapå°±ä¼šå¤šä¸€ä¸ªlogã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P5217 è´«ç©· fhq treap</title>
      <link href="/2020/12/07/p5217-pin-qiong-fhq-treap/"/>
      <url>/2020/12/07/p5217-pin-qiong-fhq-treap/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²åºåˆ—<br>è¦æ±‚æ”¯æŒä»¥ä¸‹æ“ä½œ</p><ul><li>åœ¨xä½ç½®åæ’å…¥ä¸€ä¸ªå­—æ¯</li><li>åˆ é™¤xä½ç½®çš„å­—æ¯</li><li>ç¿»è½¬åŒºé—´[x,y]</li><li>è¾“å‡ºåˆå§‹å­—ç¬¦ä¸²åºåˆ—ç¬¬xä¸ªå­—æ¯å½“å‰ä½ç½®</li><li>è¾“å‡ºå½“å‰å­—ç¬¦ä¸²åºåˆ—ç¬¬xä¸ªå­—æ¯</li><li>è¾“å‡ºåŒºé—´[x,y]å­—æ¯ç§ç±»æ•°</li></ul><p>å‰ä¸‰ä¸ªå¾ˆç®€å•ã€‚<br>ç¬¬å››ä¸ªè¦æŸ¥èŠ‚ç‚¹å·ä¸ºxçš„å­—æ¯çš„ä½ç½®ï¼Œç”±äºæ˜¯ç»´æŠ¤åŒºé—´ï¼ŒæŒ‰sizeåˆ†è£‚ï¼Œæ‰€ä»¥è‡ªä¸Šè€Œä¸‹æ‰¾ä¸äº†ï¼Œåªèƒ½é¢å¤–ç»´æŠ¤çˆ¶äº²ï¼Œç„¶åè‡ªä¸‹è€Œä¸Šæ‰¾ã€‚ç”±äºç¬¬ä¸‰ä¸ªåŒºé—´ç¿»è½¬æ“ä½œï¼Œå¯¼è‡´å·¦å³å„¿å­å¯èƒ½ä¼šæ”¹å˜ï¼Œæ‰€ä»¥è¦å…ˆåˆ°æ ¹èŠ‚ç‚¹æŠŠæ‰€æœ‰æ‡’æ ‡è®°pushdownä¸‹æ¥ï¼Œå†è‡ªä¸‹è€Œä¸Šæ‰¾æ‰èƒ½æ­£ç¡®<br>ç¬¬äº”ä¸ªå°±æ˜¯æŸ¥ç¬¬kå¤§ï¼ˆåŒºé—´æ„ä¹‰ä¸‹ï¼‰ï¼Œç›´æ¥splitå’Œmergeæ¯”è¾ƒå¥½ï¼Œå¦‚æœæ˜¯ä»æ ¹é€’å½’ç€èµ°ï¼Œä¸è¦å¿˜è®°pushdown<br>ç¬¬å…­ä¸ªçŠ¶å‹ç»´æŠ¤ä¸€ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnd</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>|<span class="built_in">rand</span>(); &#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> mask, sz, fa, key, c;</span><br><span class="line">  <span class="type">bool</span> rev;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = ++tot;</span><br><span class="line">  t[p].ls = t[p].rs = t[p].fa = <span class="number">0</span>;</span><br><span class="line">  t[p].mask = <span class="number">1</span>&lt;&lt;c, t[p].c = c, t[p].key = <span class="built_in">rnd</span>();</span><br><span class="line">  t[p].sz = <span class="number">1</span>;</span><br><span class="line">  t[p].rev = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + <span class="number">1</span>;</span><br><span class="line">  t[p].mask = t[t[p].ls].mask | t[t[p].rs].mask | (<span class="number">1</span>&lt;&lt;t[p].c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(t[p].rev)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">swap</span>(t[p].ls, t[p].rs);</span><br><span class="line">    t[t[p].ls].rev ^= <span class="number">1</span>;</span><br><span class="line">    t[t[p].rs].rev ^= <span class="number">1</span>;</span><br><span class="line">    t[p].rev = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y, <span class="type">int</span> k, <span class="type">int</span> fx=<span class="number">0</span>, <span class="type">int</span> fy=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; x = y = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz)</span><br><span class="line">  &#123;</span><br><span class="line">    y = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].ls, x, t[p].ls, k, fx, p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    x = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].rs, t[p].rs, y, k-t[t[p].ls].sz<span class="number">-1</span>, p, fy);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(x) t[x].fa = fx;</span><br><span class="line">  <span class="keyword">if</span>(y) t[y].fa = fy;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) &#123; p = x|y; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[x].key&lt;t[y].key)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">down</span>(x);</span><br><span class="line">    p = x;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].rs, t[p].rs, y);</span><br><span class="line">    t[t[p].rs].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">down</span>(y);</span><br><span class="line">    p = y;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].ls, x, t[p].ls);</span><br><span class="line">    t[t[p].ls].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">downall</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">downall</span>(t[p].fa);</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">downall</span>(p);</span><br><span class="line">  <span class="type">int</span> rk = t[t[p].ls].sz + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(t[p].fa)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(t[t[p].fa].rs==p) rk += t[t[p].fa].sz - t[p].sz;</span><br><span class="line">    p = t[p].fa;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> rk*(p==rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(k==t[t[p].ls].sz+<span class="number">1</span>) <span class="keyword">return</span> t[p].c;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[t[p].ls].sz<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="built_in">newnode</span>(s[i]-<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    <span class="built_in">merge</span>(rt, rt, x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">char</span> opt[<span class="number">2</span>], c[<span class="number">2</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, opt);</span><br><span class="line">    <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;I&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%s&quot;</span>, &amp;k, c);</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">split</span>(rt, x, y, k);</span><br><span class="line">      z = <span class="built_in">newnode</span>(c[<span class="number">0</span>]-<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">      <span class="built_in">merge</span>(x, x, z);</span><br><span class="line">      <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">split</span>(rt, x, y, k);</span><br><span class="line">      <span class="built_in">split</span>(x, x, z, k<span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">split</span>(rt, x, y, r);</span><br><span class="line">      <span class="built_in">split</span>(x, z, x, l<span class="number">-1</span>);</span><br><span class="line">      t[x].rev ^= <span class="number">1</span>;</span><br><span class="line">      <span class="built_in">merge</span>(x, z, x);</span><br><span class="line">      <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;P&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">get</span>(k));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(opt[<span class="number">0</span>]==<span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%c\n&quot;</span>, <span class="built_in">char</span>(<span class="built_in">kth</span>(rt, k)+<span class="string">&#x27;a&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">split</span>(rt, x, y, r);</span><br><span class="line">      <span class="built_in">split</span>(x, z, x, l<span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, __builtin_popcount(t[x].mask));</span><br><span class="line">      <span class="built_in">merge</span>(x, z, x);</span><br><span class="line">      <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³è¡¡æ ‘ä¹‹FHQ Treap</title>
      <link href="/2020/12/06/ping-heng-shu-zhi-fhq-treap/"/>
      <url>/2020/12/06/ping-heng-shu-zhi-fhq-treap/</url>
      
        <content type="html"><![CDATA[<p>treapï¼Œé¡¾åæ€ä¹‰tree+heap<br>æ—¢æœ‰å¹³è¡¡æ ‘çš„æ€§è´¨ï¼šå·¦å„¿å­æƒå€¼&lt;æœ¬èŠ‚ç‚¹æƒå€¼&lt;å³å„¿å­æƒå€¼ï¼Œä¸­åºéå†æœ‰åºï¼Œä¸”æ ‘é«˜å°½å¯èƒ½å°<br>åˆæœ‰heapçš„æ€§è´¨ï¼šé”®å€¼æ»¡è¶³å°æ ¹å †ï¼Œå·¦å„¿å­çš„é”®å€¼å’Œå³å„¿å­çš„é”®å€¼éƒ½å¤§äºæœ¬èŠ‚ç‚¹çš„é”®å€¼<br>è€ŒFHQ Treapä»…ä»…é€šè¿‡ä¸¤ä¸ªå‡½æ•°å°±èƒ½å¤Ÿè¿›è¡Œç»´æŠ¤ï¼Œæ€æƒ³å¥½æ‡‚ï¼Œä»£ç ä¹Ÿå¾ˆç®€æ´ã€‚<br>æ›´é‡è¦çš„æ˜¯ç›¸æ¯”äºä¹‹å‰çš„æ›¿ç½ªç¾Šæ ‘æˆ–è€…pbdsè¿™ç§åªèƒ½ç»´æŠ¤å¤§å°å…³ç³»çš„å¹³è¡¡æ ‘è€Œè¨€ï¼Œå®ƒå¯ä»¥èƒœä»»splayæ‹¥æœ‰çš„ç»´æŠ¤åŒºé—´çš„ç‰¹è´¨ã€‚<br>é¦–å…ˆæ˜¯æ™®é€šçš„ç»´æŠ¤å¤§å°å…³ç³»ï¼š<br>splitå‡½æ•°ï¼Œå°†ä¸€æ£µæ ‘æŒ‰ç…§ç»™å®šçš„æƒå€¼våˆ’åˆ†æˆä¸¤æ£µæ ‘ï¼Œå¹¶ä¸”ä¿è¯ç¬¬ä¸€æ£µæ ‘çš„æƒå€¼å‡å°äºç­‰äºvï¼Œç¬¬äºŒæ£µæ ‘çš„æƒå€¼å‡å¤§äºvã€‚<br>æ˜¾ç„¶åªè¦é€’å½’åˆ†è£‚çš„æ ‘ï¼Œè€ƒè™‘å½“å‰èŠ‚ç‚¹çš„æƒå€¼å’Œç»™å®šçš„vçš„å…³ç³»å³å¯ã€‚<br>æ³¨æ„åˆ†è£‚çš„ä¸¤ä¸ªèŠ‚ç‚¹ä¼ å¼•ç”¨ã€‚<br>mergeå‡½æ•°ï¼Œå°†ä¸¤æ£µæ ‘åˆæˆä¸€æ£µæ ‘ï¼Œè¦æ±‚ç¬¬ä¸€æ£µæ ‘çš„æƒå€¼å‡å°äºç­‰äºç¬¬äºŒæ£µæ ‘<br>åŒæ ·æ˜¯é€’å½’è€ƒè™‘ï¼Œé‚£ä¹ˆå½“å‰ä¸¤æ£µæ ‘è°çš„æ ¹ä½œä¸ºåˆå¹¶çš„æ ‘çš„æ ¹å‘¢ï¼ŸæŒ‰ç…§æƒå€¼æ¥çœ‹éƒ½æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¸ºäº†ä¿æŒå¹³è¡¡æ€§ï¼Œå°±è¦ç»´æŠ¤é”®å€¼çš„å°æ ¹å †æ€§è´¨ï¼Œæ‰€ä»¥è®©é”®å€¼å°çš„é‚£ä¸ªèŠ‚ç‚¹ä½œä¸ºæ ¹å³å¯ã€‚<br>æ³¨æ„åˆå¹¶çš„é‚£ä¸ªèŠ‚ç‚¹è¦ä¼ å¼•ç”¨ã€‚<br>ç”±äºsplitå’Œmergeéƒ½ä¼šæ”¹å˜çˆ¶å­å…³ç³»ï¼Œæ‰€ä»¥æœ€åè¦pushupç»´æŠ¤å¥½å­æ ‘çš„ä¿¡æ¯ã€‚<br>è€Œå¯¹äºæ™®é€šå¹³è¡¡æ ‘æ‰€æ”¯æŒçš„æ’å…¥ã€åˆ é™¤ã€ç¬¬kå¤§ã€æ’åã€å‰é©±ã€åç»§ç­‰ç­‰ï¼Œåªè¦åŸºäºsplitå’Œmergeä¸¤ä¸ªå‡½æ•°å°±å¯ä»¥è½»æ¾å®ç°ï¼Œæ¯”è¾ƒç®€å•ï¼Œ <s>æ‡’å¾—å†™äº†</s><br>p6136ï¼šfhq treap 8.2sï¼Œæ›¿ç½ªç¾Š5.81sï¼Œä¸è¿‡fhq treapä»£ç çŸ­ç‚¹ã€‚å½“ç„¶ä¸¤è€…éƒ½å¾ˆå¥½ç†è§£ã€‚ä¸€èˆ¬æƒ…å†µä¸‹fhq<br>treapè¶³ä»¥åº”å¯¹æ‰€æœ‰æƒ…å†µï¼ˆé™¤äº†LCTä»¥åŠé‡åº¦å¡å¸¸é¢˜ï¼ˆç´«è†èŠ±ä¹‹æ‹ï¼Ÿå¬è¯´ï¼‰ï¼Œæ‰€ä»¥splayè¿˜æ˜¯å¾—æ‡‚ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> val, key, sz;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> tot, rt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnd</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (<span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>)|<span class="built_in">rand</span>(); &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = ++tot;</span><br><span class="line">  t[p].val = v, t[p].sz = <span class="number">1</span>;</span><br><span class="line">  t[p].ls = t[p].rs = <span class="number">0</span>;</span><br><span class="line">  t[p].key = <span class="built_in">rnd</span>();</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;a, <span class="type">int</span> &amp;b, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; a = b = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].val&lt;=v) &#123; a = p; <span class="built_in">split</span>(t[p].rs, t[a].rs, b, v); &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; b = p; <span class="built_in">split</span>(t[p].ls, a, t[b].ls, v); &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!a||!b) &#123; p = a|b; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[a].key&lt;t[b].key) &#123; p = a; <span class="built_in">merge</span>(t[p].rs, t[a].rs, b); &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; p = b; <span class="built_in">merge</span>(t[p].ls, a, t[b].ls); &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="built_in">newnode</span>(v);</span><br><span class="line">  <span class="built_in">split</span>(p, x, y, v);</span><br><span class="line">  <span class="built_in">merge</span>(x, x, z); <span class="built_in">merge</span>(p, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>, z = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">split</span>(p, x, y, v); <span class="built_in">split</span>(x, x, z, v<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">merge</span>(z, t[z].ls, t[z].rs);</span><br><span class="line">  <span class="built_in">merge</span>(x, x, z); <span class="built_in">merge</span>(p, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(k==t[t[p].ls].sz+<span class="number">1</span>) <span class="keyword">return</span> t[p].val;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[t[p].ls].sz<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Less</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v, <span class="type">bool</span> eq)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">split</span>(p, x, y, v<span class="number">-1</span>+eq);</span><br><span class="line">  <span class="type">int</span> ans = t[x].sz;</span><br><span class="line">  <span class="built_in">merge</span>(p, x, y);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">srand</span>(<span class="built_in">int</span>(<span class="built_in">time</span>(<span class="number">0</span>)));</span><br><span class="line">  <span class="type">int</span> n, m;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, x; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">    <span class="built_in">ins</span>(rt, x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> last = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;x);</span><br><span class="line">    x ^= last;</span><br><span class="line">    <span class="keyword">switch</span>(op)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>: <span class="built_in">ins</span>(rt, x); <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>: <span class="built_in">del</span>(rt, x); <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>: last = <span class="built_in">Less</span>(rt, x, <span class="number">0</span>) + <span class="number">1</span>; ans ^= last; <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>: last = <span class="built_in">kth</span>(rt, x); ans ^= last; <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>: last = <span class="built_in">kth</span>(rt, <span class="built_in">Less</span>(rt, x, <span class="number">0</span>)); ans ^= last; <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>: last = <span class="built_in">kth</span>(rt, <span class="built_in">Less</span>(rt, x, <span class="number">1</span>)+<span class="number">1</span>); ans ^= last;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯ç»´æŠ¤åŒºé—´ï¼Œä¹Ÿå¾ˆç®€å•ï¼Œæ”¹ä¸€ä¸‹splitå’Œmergeçš„å®šä¹‰å³å¯ã€‚<br>splitï¼Œç»™å®šä¸€ä¸ªæ ‘ï¼ŒæŠŠä¸€æ£µæ ‘çš„å‰kä¸ªèŠ‚ç‚¹åˆ’åˆ†ç»™ä¸€æ£µæ ‘ï¼Œå‰©ä½™èŠ‚ç‚¹åˆ’åˆ†ç»™å¦ä¸€æ£µæ ‘<br>mergeï¼Œå°†ä¸¤æ£µæ ‘åˆå¹¶æˆä¸€æ£µæ ‘ï¼Œéœ€è¦ä¿è¯ä¸€æ£µæ ‘å®Œå…¨å¤„åœ¨å¦ä¸€æ£µæ ‘çš„å‰é¢<br>å†™æ³•å’Œä¸Šé¢ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°<br>è€ƒè™‘å¯¹åŒºé—´[l,r]çš„æ“ä½œæ€ä¹ˆåšï¼š<br>å…ˆæŠŠrtçš„å‰rä¸ªèŠ‚ç‚¹splitç»™xï¼Œå…¶ä»–çš„ä¸¢ç»™y<br>å†æŠŠxçš„å‰l-1ä¸ªèŠ‚ç‚¹splitç»™z<br>æ­¤æ—¶xå°±æ˜¯[l,r]åŒºé—´å†…æ‰€æœ‰èŠ‚ç‚¹æ„æˆçš„treapçš„æ ¹äº†ï¼Œç›´æ¥åœ¨æ ¹ä¸Šæ‰“æ ‡è®°å³å¯ã€‚<br>æœ€åæŒ‰ç…§é¡ºåºzï¼Œxï¼Œyè¿›è¡Œmergeã€‚<br>è€ƒè™‘pushupå’Œpushdownåœ¨ä»€ä¹ˆæ—¶å€™è¿›è¡Œã€‚<br>pushupæ˜¯è¦ç»´æŠ¤å½“å‰å­æ ‘çš„ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦åœ¨å·¦å³å„¿å­æ”¹å˜åè°ƒç”¨ï¼Œè€Œpushdownæ˜¯ä¸ºäº†ä¸‹æ”¾èµ–åœ¨å½“å‰èŠ‚ç‚¹ä¸Šçš„æ‡’æ ‡è®°ï¼Œæ‰€ä»¥è¦åœ¨å·¦å³å„¿å­æ”¹å˜å‰è°ƒç”¨ï¼Œæƒ³æ¸…æ¥šè¿™ä¸¤ç‚¹å°±çŸ¥é“äº†ï¼Œåº”è¯¥åœ¨splitå’Œmergeè¿›å…¥å­æ ‘å‰pushdownï¼Œåœ¨å›æº¯ä¸Šæ¥ä¹‹åå†pushupã€‚<br>p3391 æ–‡è‰ºå¹³è¡¡æ ‘ï¼ŒåŒºé—´ç¿»è½¬ï¼Œæ˜¾ç„¶åªè¦æŠŠè¦æ“ä½œçš„åŒºé—´splitå‡ºæ¥ç„¶ååœ¨æ ¹ä¸Šæ‰“ä¸€ä¸ªç¿»è½¬æ ‡è®°å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rnd</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">rand</span>()&lt;&lt;<span class="number">15</span>|<span class="built_in">rand</span>(); &#125;</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> val, key, sz;</span><br><span class="line">  <span class="type">bool</span> tag;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">swap</span>(t[p].ls, t[p].rs);</span><br><span class="line">  <span class="keyword">if</span>(t[p].ls) t[t[p].ls].tag ^= <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].rs) t[t[p].rs].tag ^= <span class="number">1</span>;</span><br><span class="line">  t[p].tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = ++tot;</span><br><span class="line">  t[p].val = v;</span><br><span class="line">  t[p].sz = <span class="number">1</span>; t[p].tag = <span class="number">0</span>;</span><br><span class="line">  t[p].ls = t[p].rs = <span class="number">0</span>;</span><br><span class="line">  t[p].key = <span class="built_in">rnd</span>();</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; x = y = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) &#123; y = p; <span class="built_in">split</span>(t[p].ls, x, t[p].ls, k); &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; x = p, <span class="built_in">split</span>(t[p].rs, t[p].rs, y, k-t[t[p].ls].sz<span class="number">-1</span>); &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) &#123; p = x|y; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[x].key&lt;t[y].key)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(t[x].tag) <span class="built_in">down</span>(x);</span><br><span class="line">    p = x;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].rs, t[x].rs, y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(t[y].tag) <span class="built_in">down</span>(y);</span><br><span class="line">    p = y;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].ls, x, t[y].ls);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">newnode</span>(v);</span><br><span class="line">  <span class="built_in">merge</span>(p, p, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rev</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x, y, z;</span><br><span class="line">  <span class="built_in">split</span>(rt, x, y, r);</span><br><span class="line">  <span class="built_in">split</span>(x, z, x, l<span class="number">-1</span>);</span><br><span class="line">  t[x].tag ^= <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">merge</span>(x, z, x);</span><br><span class="line">  <span class="built_in">merge</span>(rt, x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">down</span>(p);</span><br><span class="line">  <span class="built_in">print</span>(t[p].ls);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t[p].val);</span><br><span class="line">  <span class="built_in">print</span>(t[p].rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">srand</span>(<span class="built_in">int</span>(<span class="built_in">time</span>(<span class="number">0</span>)));</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">ins</span>(rt, i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    <span class="built_in">rev</span>(l, r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">print</span>(rt);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»´æŠ¤åŒºé—´ä¿¡æ¯çš„æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„å¹³è¡¡æ ‘å’Œçº¿æ®µæ ‘æ˜¯ä¸ä¸€æ ·çš„ï¼Œçº¿æ®µæ ‘åªè¦å·¦å³å„¿å­å–ä¼˜å³å¯ï¼ˆå› ä¸ºæœ¬èŠ‚ç‚¹ç»´æŠ¤çš„åŒºé—´æ˜¯å·¦å³å„¿å­ç»´æŠ¤çš„åŒºé—´çš„å¹¶ï¼‰ï¼Œè€Œå¹³è¡¡æ ‘å·¦å³å„¿å­ç»´æŠ¤çš„ä¿¡æ¯æ˜¯ä¸åŒ…å«æœ¬èŠ‚ç‚¹çš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»´æŠ¤æœ¬èŠ‚ç‚¹çš„å€¼ï¼Œå’Œè¯¥å€¼å†å–ä¼˜ã€‚<br>åœ¨ç»´æŠ¤åŒºé—´çš„æ—¶å€™ï¼Œå°±ä¸§å¤±äº†æƒå€¼å¤§å°çš„æ¯”è¾ƒäº†ï¼Œé‚£ä¹ˆå¦‚ä½•çŸ¥é“ç¼–å·ä¸ºiçš„èŠ‚ç‚¹åœ¨åŒºé—´ä¸­çš„å“ªä¸ªä½ç½®å‘¢ï¼Ÿ<br>æ˜¾ç„¶ä»æ ¹å¼€å§‹æ˜¯ä¸çŸ¥é“è¯¥èµ°å·¦è¿˜æ˜¯å³çš„ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä»ièŠ‚ç‚¹ä¸æ–­è·³çˆ¶äº²ç›´è‡³æ ¹ï¼Œç„¶åä¸æ–­ç»´æŠ¤å°äºä½ çš„èŠ‚ç‚¹ä¸ªæ•°å°±å¯ä»¥äº†ï¼Œè€Œtreapçš„æ ‘é«˜æ˜¯$\log n$çº§åˆ«çš„ï¼Œå¤æ‚åº¦æ²¡é—®é¢˜ã€‚<br>è¦ç»´æŠ¤èŠ‚ç‚¹çš„çˆ¶äº²ï¼Œä¸€ç§ç®€å•çš„åšæ³•æ˜¯åœ¨pushupçš„æ—¶å€™ç»´æŠ¤ä¸€ä¸‹pçš„å·¦å³å„¿å­çš„çˆ¶äº²ä¸ºpï¼Œä½†è¿™æ ·å­æ˜¯æœ‰é—®é¢˜çš„ï¼Œæ ¹èŠ‚ç‚¹çš„faå€¼æ˜¯é”™è¯¯çš„ï¼Œæ²¡æ³•åŠæ—¶æ¸…é›¶ï¼Œå½“ç„¶å¦‚æœåªæœ‰ä¸€æ£µtreapï¼Œä¸”çŸ¥é“æ ¹èŠ‚ç‚¹çš„ç¼–å·ï¼Œå°±å¯ä»¥é€šè¿‡==rtæ¥åˆ¤æ–­ï¼Œå¦åˆ™å°±åº”è¯¥åœ¨splitå’Œmergeä¸­ç»´æŠ¤faï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> &amp;x, <span class="type">int</span> &amp;y, <span class="type">int</span> fx, <span class="type">int</span> fy, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) &#123; x = y = <span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz)</span><br><span class="line">  &#123;</span><br><span class="line">    y = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].ls, x, t[p].ls, fx, p, k);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    x = p;</span><br><span class="line">    <span class="built_in">split</span>(t[p].rs, t[p].rs, y, p, fy, k-t[t[p].ls].sz<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(x) t[x].fa = fx;</span><br><span class="line">  <span class="keyword">if</span>(y) t[y].fa = fy;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x||!y) &#123; p = x|y; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[x].key&lt;t[y].key)</span><br><span class="line">  &#123;</span><br><span class="line">    p = x;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].rs, t[p].rs, y);</span><br><span class="line">    t[t[p].rs].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    p = y;</span><br><span class="line">    <span class="built_in">merge</span>(t[p].ls, x, t[p].ls);</span><br><span class="line">    t[t[p].ls].fa = p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿”å›ç¼–å·ä¸ºpçš„èŠ‚ç‚¹æ‰€åœ¨treapçš„æ ¹èŠ‚ç‚¹ï¼Œä»¥åŠåœ¨åŸæ•°ç»„ä¸­çš„ä¸‹æ ‡ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">get</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> rk = t[t[p].ls].sz + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(t[p].fa)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p==t[t[p].fa].rs) rk += t[t[p].fa].sz - t[p].sz;</span><br><span class="line">    p = t[p].fa;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">make_pair</span>(p, rk);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³è¡¡æ ‘ä¹‹æ›¿ç½ªç¾Šæ ‘</title>
      <link href="/2020/12/06/ping-heng-shu-zhi-ti-zui-yang-shu/"/>
      <url>/2020/12/06/ping-heng-shu-zhi-ti-zui-yang-shu/</url>
      
        <content type="html"><![CDATA[<p>å¾ˆç®€å•çš„æ€è·¯ï¼Œåœ¨æ¯æ¬¡æ’å…¥å’Œåˆ é™¤çš„æ—¶å€™ï¼Œæ£€æŸ¥ä¸€ä¸‹å·¦å³å­æ ‘æ˜¯ä¸æ˜¯å¤±è¡¡ï¼Œå¦‚æœå¤±è¡¡å°±å°†æ•´æ£µå­æ ‘è¿›è¡Œæ‹æ‰(ä¸­åºéå†å­˜åˆ°æ•°ç»„)ï¼Œé‡æ„(æ¯æ¬¡ä»¥ä¸­å¿ƒç‚¹ä¸ºå½“å‰çš„æ ¹ï¼Œç„¶åé€’å½’å·¦å³åŒºé—´)ã€‚<br>å¤±è¡¡çš„åˆ¤å®šï¼šå½“å·¦å­æ ‘æˆ–è€…å³å­æ ‘çš„å¤§å°è¶…è¿‡äº†æ•´ä¸ªå­æ ‘å¤§å°çš„æŸä¸ªæ¯”ä¾‹alphaï¼ˆä¸€èˆ¬å®šä¹‰åœ¨0.7~0.8ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bad</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; <span class="keyword">return</span> t[p].cnt &amp;&amp; t[p].sz*alpha&lt;<span class="built_in">max</span>(t[t[p].ls].sz, t[t[p].rs].sz); &#125;</span><br></pre></td></tr></table></figure><p>å‡ ä¸ªç»†èŠ‚ï¼š</p><ul><li>åˆ é™¤çš„å®ç°é‡‡ç”¨æœ€ç®€å•çš„æƒ°æ€§åˆ é™¤ï¼Œæ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹åè®©cntâ€“å³å¯ï¼Œå³ä½¿ç­‰äº0ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºåœ¨æ‹æ‰é‡æ„çš„æ—¶å€™å¯ä»¥æŠŠç­‰äº0çš„èŠ‚ç‚¹ç›´æ¥ä¸¢å¼ƒæ‰</li><li>ç”±äºæ’å…¥åˆ é™¤çš„æ—¶å€™å¯èƒ½éœ€è¦é‡æ„ï¼Œå› æ­¤ä¸€å®šè¦è®°å¾—ä¼ å¼•ç”¨</li><li>è¿™ç§å¹³è¡¡æ ‘æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¥½å†™åŠ å¸¸æ•°å°(å‡æ‘Šmlogn)</li></ul><p>è®°ä½æ‹æ‰é‡æ„çš„æ€æƒ³åº”è¯¥å°±å¾ˆå®¹æ˜“æ‰‹å†™äº†å§</p><p>å‰é©±ã€åç»§ã€ç¬¬kå¤§ã€æ’åå…¶å®æ²¡å¿…è¦æ¯ä¸ªéƒ½å®ç°ä¸€ä¸ªå‡½æ•°ã€‚åªéœ€è¦å®ç°æ±‚ç¬¬kå¤§ï¼Œç„¶åæ±‚å°äºxçš„æ•°çš„ä¸ªæ•°ä»¥åŠå°äºç­‰äºxçš„æ•°çš„ä¸ªæ•°å³å¯ï¼Œåªä¸åä¸¤è€…åªæœ‰ç»†å¾®çš„å·®å¼‚ï¼Œå®Œå…¨å¯ä»¥åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­<br>æ´›è°·æ¨¡æ¿p3369å¼€O2 170msï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> alpha = <span class="number">0.7</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ls, rs;</span><br><span class="line">  <span class="type">int</span> val, sz, cnt;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="type">int</span> rt, tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].sz = t[t[p].ls].sz + t[t[p].rs].sz + t[p].cnt; &#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bad</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; <span class="keyword">return</span> t[p].cnt &amp;&amp; t[p].sz*alpha&lt;<span class="built_in">max</span>(t[t[p].ls].sz, t[t[p].rs].sz); &#125;</span><br><span class="line"><span class="type">int</span> ord[N], top;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(t[p].ls);</span><br><span class="line">  <span class="keyword">if</span>(t[p].cnt) ord[++top] = p;</span><br><span class="line">  <span class="built_in">dfs</span>(t[p].rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, p = ord[mid];</span><br><span class="line">  t[p].ls = <span class="built_in">build</span>(l, mid<span class="number">-1</span>);</span><br><span class="line">  t[p].rs = <span class="built_in">build</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(p);</span><br><span class="line">  p = <span class="built_in">build</span>(<span class="number">1</span>, top);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  p = ++tot;</span><br><span class="line">  t[p].val = v, t[p].ls = t[p].rs = <span class="number">0</span>;</span><br><span class="line">  t[p].cnt = t[p].sz = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="built_in">newnode</span>(p, v);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==t[p].val) t[p].cnt++;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="built_in">ins</span>(t[p].ls, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">ins</span>(t[p].rs, v);</span><br><span class="line">    <span class="built_in">up</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">bad</span>(p)) <span class="built_in">rebuild</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(v==t[p].val) t[p].cnt--;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="built_in">del</span>(t[p].ls, v);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">del</span>(t[p].rs, v);</span><br><span class="line">  <span class="built_in">up</span>(p);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">bad</span>(p)) <span class="built_in">rebuild</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Less</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v, <span class="type">bool</span> eq)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].cnt&amp;&amp;v==t[p].val) <span class="keyword">return</span> t[t[p].ls].sz + t[p].cnt*eq;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(v&lt;t[p].val) <span class="keyword">return</span> <span class="built_in">Less</span>(t[p].ls, v, eq);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> t[t[p].ls].sz + t[p].cnt + <span class="built_in">Less</span>(t[p].rs, v, eq);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kth</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(k&lt;=t[t[p].ls].sz) <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].ls, k);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(t[t[p].ls].sz+t[p].cnt&gt;=k) <span class="keyword">return</span> t[p].val;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">kth</span>(t[p].rs, k-t[p].cnt-t[t[p].ls].sz);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">while</span>(n--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> t, x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;t, &amp;x);</span><br><span class="line">    <span class="keyword">if</span>(t==<span class="number">1</span>) <span class="built_in">ins</span>(rt, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">2</span>) <span class="built_in">del</span>(rt, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">3</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">Less</span>(rt, x, <span class="number">0</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">4</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">kth</span>(rt, x));</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">5</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">kth</span>(rt, <span class="built_in">Less</span>(rt, x, <span class="number">0</span>)));</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">kth</span>(rt, <span class="built_in">Less</span>(rt, x, <span class="number">1</span>)+<span class="number">1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ECPC 2019 Kickoff</title>
      <link href="/2020/12/04/ecpc-2019-kickoff/"/>
      <url>/2020/12/04/ecpc-2019-kickoff/</url>
      
        <content type="html"><![CDATA[<p>é™¤äº†Iæ²¡äººè¿‡ï¼ˆæ²¡çœ‹ï¼‰ï¼Œéƒ½ä¸éš¾<br>ç‰¹åˆ«ç®€å•çš„ç•¥è¿‡</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™ä¸‰æ ¹æœ¨æ£é•¿åº¦a,b,cï¼Œå†ç»™ä¸€ä¸ªkï¼Œä½ å¯ä»¥é€‰æ‹©<strong>ä¸€æ ¹</strong>æœ¨æ£è®©å®ƒçš„é•¿åº¦æœ€å¤šå»¶é•¿kï¼Œé—®ä½ è¿™ä¸‰æ ¹æœ¨æ£æ„æˆçš„ä¸‰è§’å½¢çš„æœ€å¤§é¢ç§¯</p><p>è€ƒè™‘æšä¸¾å»¶é•¿çš„è¾¹ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡ºè¿™æ¡è¾¹çš„èŒƒå›´ï¼Œç„¶ååˆ©ç”¨ä½™å¼¦å®šç†æ±‚å‡ºè¿™æ¡è¾¹å¯¹è§’çš„èŒƒå›´ï¼Œæœ€å¤§åŒ–è¿™ä¸ªè§’çš„sinå€¼å³å¯</p><h2 id="K"><a class="header-anchor" href="#K">Â¶</a>K</h2><p>nç›†æ¤ç‰©ï¼Œç¬¬iç›†åˆå§‹é«˜åº¦ä¸º$h_i$â€‹ï¼Œç”Ÿæˆé€Ÿåº¦ä¸º$g_i$â€‹ï¼Œé—®ä½ æœ€çŸ­ç¬¬å‡ å¤©æ‰€æœ‰æ¤ç‰©ä¼šå½¢æˆéé™åºåˆ—</p><p>æ˜¾ç„¶è€ƒè™‘ç›¸é‚»ä¸¤ç›†ï¼ŒæŠ½è±¡æˆç›´çº¿å³å¯ï¼Œè¦ä¹ˆæ˜¯$[0,l]$,è¦ä¹ˆæ˜¯$[r,\inf]$ï¼Œç»´æŠ¤lå’Œrå³å¯</p><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>ä¸€ä¸ªåºåˆ—ï¼Œåªæœ‰â€™aâ€™,â€˜bâ€™,â€˜câ€™ï¼Œä¸”â€™bâ€™æœ€å¤šä¸€ä¸ªï¼Œç°åœ¨å¯ä»¥äº¤æ¢ä»»æ„ä¸¤ä¸ªä½ç½®ï¼Œé—®ä½ æ»¡è¶³ç›¸é‚»ä¸¤ä¸ªä½ç½®çš„å­—æ¯è¦ä¹ˆç›¸ç­‰ï¼Œè¦ä¹ˆæœ‰ä¸€ä¸ªæ˜¯â€™bâ€™</p><p>æ²¡æœ‰bçš„æ—¶å€™ï¼Œæ˜¾ç„¶åªæœ‰å…¨æ˜¯aæˆ–è€…å…¨æ˜¯cæ‰èƒ½æ»¡è¶³<br>æœ‰1ä¸ªbï¼Œåªèƒ½æ˜¯aaabccccæˆ–è€…ccccbaaaçš„å½¢å¼ï¼Œå–ä¸ªminå³å¯</p><h2 id="L"><a class="header-anchor" href="#L">Â¶</a>L</h2><p>ç»™ä¸€ä¸ªæ•°nï¼Œåˆå§‹æœ‰x=0ï¼Œæ¯æ¬¡æ“ä½œä»$[0, 2^n-1]$ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæ•°rï¼Œè®©$x=x^r$ï¼Œè®¾æœŸæœ›pæ­¥åè¯¥æ•°å˜ä¸º0ï¼Œé—®æœŸæœ›æ­¥æ•°çš„å¹³æ–¹</p><p>ç­”æ¡ˆå°±æ˜¯$\sum_{i=1}^{\infty}i^2(1-\frac{1}{2^n})^{i-1}\frac{1}{2^n}$</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p><img src="/post-images/1607088246259.png" alt=""><br>ç»™å‡ºä¸€ä¸ªåºåˆ—ï¼Œç„¶åæ‰§è¡Œä¸€æ¬¡ä¸Šè¿°å‡½æ•°åï¼Œé—®ä½ å¾—åˆ°çš„åºåˆ—<br>è¿™ä¸ªå‡½æ•°å°±æ˜¯æ¯æ¬¡ä¼˜å…ˆæ‰¾åˆ°è·Ÿä½ ä¸è¿ç®—ä¸ç­‰äº0çš„æ•°ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„æ•°ï¼Œå†æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸è¿ç®—ç­‰äº0çš„ã€‚<br>è€ƒè™‘ä¼˜åŒ–æ‰¾è¿™ä¸ªæ•°çš„è¿‡ç¨‹<br>ä¸ä¸ç­‰äº0ï¼Œé‚£è‚¯å®šæœ‰ä¸€ä½ä½ æ˜¯1ï¼Œå®ƒä¹Ÿæ˜¯1ã€‚<br>ç”¨30ä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—å­˜ç¬¬iä½ä¸º1çš„æ•°çš„ä¸‹æ ‡<br>é‚£ä¹ˆå¦‚æœå½“å‰è¿›è¡Œåˆ°uï¼Œæšä¸¾30ä½ï¼Œæ‰¾åˆ°é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªæ²¡è®¿é—®è¿‡çš„æ•°ï¼Œå–å®ƒä»¬çš„æœ€å°æ•°å°±æ˜¯ä¸‹ä¸€ä¸ªæ•°äº†ã€‚<br>æ˜¾ç„¶è®¿é—®è¿‡çš„æ•°å¯ä»¥popæ‰ã€‚å¦‚æœæ²¡æœ‰è¿™æ ·çš„æ•°äº†ï¼Œå‰©ä¸‹æ²¡è®¿é—®è¿‡çš„æ˜¾ç„¶è·Ÿä½ ä¸è¿ç®—éƒ½æ˜¯0ï¼Œç”¨ä¸ªé“¾è¡¨ç»´æŠ¤å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a[N], b[N], top;</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">queue&lt;<span class="type">int</span>&gt; q[<span class="number">32</span>];</span><br><span class="line"><span class="type">int</span> to[N], from[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(vis[u]) <span class="keyword">return</span>;</span><br><span class="line">  vis[u] = <span class="number">1</span>; b[++top] = a[u]; to[from[u]] = to[u]; from[to[u]] = from[u];</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> nxt = n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=<span class="number">30</span>; i++)</span><br><span class="line">      <span class="keyword">if</span>((a[u]&gt;&gt;i)&amp;<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span>(!q[i].<span class="built_in">empty</span>() &amp;&amp; vis[q[i].<span class="built_in">front</span>()]) q[i].<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(!q[i].<span class="built_in">empty</span>()) nxt = <span class="built_in">min</span>(nxt, q[i].<span class="built_in">front</span>());</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">if</span>(nxt==n+<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(nxt);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> nxt = to[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">while</span>(nxt&lt;=n &amp;&amp; vis[nxt]) nxt = to[nxt];</span><br><span class="line">  <span class="keyword">if</span>(nxt&lt;=n) <span class="built_in">dfs</span>(nxt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">freopen</span>(<span class="string">&quot;sorting.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    to[i] = i + <span class="number">1</span>; from[i] = i - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;=<span class="number">30</span>; j++)</span><br><span class="line">      <span class="keyword">if</span>((a[i]&gt;&gt;j)&amp;<span class="number">1</span>) q[j].<span class="built_in">push</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, b[i], <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h3><p>æœ‰ä¸€ä¸ªæ— å‘å›¾ï¼Œç„¶åç»™ä½ qä¸ªäºŒå…ƒç»„(d,c)ï¼Œè¡¨ç¤ºåœ¨ç¬¬då¤©ä¹‹å‰è®¿é—®è¿‡cï¼Œé—®ä½ ç¬¬0å¤©çš„èµ·ç‚¹å¯èƒ½æœ‰å‡ ä¸ª<br>æŒ‰ç…§då‡åºç»™å‡ºï¼Œå…¶ä¸­ç¬¬iå¤©ä½ å¯ä»¥é€‰æ‹©ä¸åŠ¨ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç§»åˆ°ç›¸é‚»çš„ä¸€ä¸ªèŠ‚ç‚¹<br>$n \leq 2000,m\leq 10^4$</p><p>æ˜¾ç„¶åœ¨æ¯ä¸ªç‚¹è·‘ä¸€ébfsæ±‚å‡ºä¸¤ä¸¤çš„æœ€çŸ­è·¯ï¼Œç›¸é‚»äºŒå…ƒç»„çš„åŸå¸‚æˆ‘ä»¬éƒ½èµ°æœ€çŸ­è·¯ï¼Œå¦‚æœåé¢å¤©æ•°ä¸å¤Ÿï¼Œåªèƒ½å¾€å‰é¢å€Ÿï¼Œå‡è®¾åé¢æœ€å¤šæ¬ äº†xå¤©ï¼Œé‚£ä¹ˆèµ·ç‚¹å’Œ$c_1$â€‹çš„è·ç¦»è¦æ»¡è¶³$\leq d_1-x$ã€‚<br>ä¸€ä¸ªé”™è¯¯æ˜¯æˆ‘æŠŠbfsçš„è·ç¦»åˆå§‹åŒ–æˆ-1ï¼Œç„¶åæŸäº›ç‚¹å’Œ$c_1$â€‹å¯èƒ½ä¸è¿é€šï¼Œæˆ‘ä¹ŸæŠŠå®ƒç®—ä½œå¯è¡Œç‚¹äº†</p><h3 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h3><p>è¿˜ä»¥ä¸ºæ˜¯é“é«˜æ·±è®¡ç®—å‡ ä½•ï¼Œç„¶è€Œæ˜¯ä¸ªæ•°ä½dp<br>æœ‰ä¸¤æ¡æ–œç‡ä¸º$s_1,s_2$â€‹,ä¸”éƒ½æ˜¯2çš„å¹‚æ¬¡çš„è¿‡åŸç‚¹çš„ç›´çº¿ï¼Œç»™å®š$x_l,x_r$â€‹<br>è®©ä½ æ±‚$\sum_{i=x_l}^{x_r} (s_1i) \otimes (s_2i)$<br>é¦–å…ˆå¯ä»¥è½¬æˆå‰ç¼€å’Œï¼ŒæŠŠä¸‹ç•Œé™å˜æˆ0ï¼Œç„¶åè®¾$2^{k_1}=s_1,2^{k_2}=s_2$<br>æŠŠå¼å­å˜æˆ$\sum_{i=0}^{n}(i&lt;&lt;k_1) \otimes<br>(i&lt;&lt;k_2)$<br>è®¾$k_1&lt;k_2$â€‹ï¼Œå»æ‰$k_1$â€‹ï¼Œ$k_2$â€‹å˜æˆ$k=k_2-k_1$â€‹ï¼Œæœ€åç­”æ¡ˆä¹˜ä¸Š$2^{k_1}$â€‹<br>åˆ™$\sum_{i=0}^{n}i \otimes (i&lt;&lt;k)$<br>æ˜¾ç„¶æŒ‰ä½è€ƒè™‘<br>å¯¹äº$[0,k-1]$ä½ï¼Œæˆ‘ä»¬åªè¦ç»Ÿè®¡$[0,n]$ä¸­é‚£ä½ç­‰äº1çš„æ•°é‡<br>å¯¹äº$[41-k,40]$ä½ï¼Œæˆ‘ä»¬ä¹Ÿåªè¦ç»Ÿè®¡$[0,n]$ä¸­é‚£ä½ç­‰äº1çš„æ•°é‡<br>å¯¹äº$[k,40]$ä½ï¼Œæˆ‘ä»¬è¦ç»Ÿè®¡$[0,n]$ä¸­xä½ä¸ç­‰äºx-kä½çš„æ•°é‡<br>å†™ä¸¤ä¸ªæ•°ä½dpå°±è¡Œäº†ã€‚ã€‚å†™å®Œä¸€ä¸ªï¼Œcvä¸€ä¸‹æ”¹æ”¹å°±è¡Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll s1, s2, xl, xr;</span><br><span class="line">ll dp[<span class="number">45</span>][<span class="number">2</span>], dp2[<span class="number">45</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> a[<span class="number">45</span>], top;</span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> lim, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  ll &amp;x = dp[p][lim];</span><br><span class="line">  <span class="keyword">if</span>(~x) <span class="keyword">return</span> x;</span><br><span class="line">  x = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> up = lim ? a[p] : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(p==t)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(up==<span class="number">1</span>) x = <span class="built_in">dfs</span>(p<span class="number">-1</span>, lim, t);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=up; i++)</span><br><span class="line">      x = (x + <span class="built_in">dfs</span>(p<span class="number">-1</span>, lim&amp;&amp;i==up, t))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">dfs2</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> lim, <span class="type">int</span> tv, <span class="type">int</span> t, <span class="type">int</span> t2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  ll &amp;x = dp2[p][lim][tv];</span><br><span class="line">  <span class="keyword">if</span>(~x) <span class="keyword">return</span> x;</span><br><span class="line">  x = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> up = lim ? a[p] : <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=up; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p==t) x = (x + <span class="built_in">dfs2</span>(p<span class="number">-1</span>, lim&amp;&amp;i==up, i, t, t2))%mod;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p==t2 &amp;&amp; tv!=i) x = (x + <span class="built_in">dfs2</span>(p<span class="number">-1</span>, lim&amp;&amp;i==up, tv, t, t2))%mod;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p!=t2) x = (x + <span class="built_in">dfs2</span>(p<span class="number">-1</span>, lim&amp;&amp;i==up, tv, t, t2))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">work</span><span class="params">(<span class="type">int</span> k, ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">    ll n = x;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    &#123;</span><br><span class="line">      a[top++] = n&amp;<span class="number">1</span>;</span><br><span class="line">      n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top&lt;=<span class="number">40</span>) a[top++] = <span class="number">0</span>;</span><br><span class="line">    ans = (ans + (<span class="number">1ll</span>&lt;&lt;i)%mod*<span class="built_in">dfs</span>(top<span class="number">-1</span>, <span class="number">1</span>, i))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">41</span>-k; i&lt;=<span class="number">40</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">    ll n = x;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    &#123;</span><br><span class="line">      a[top++] = n&amp;<span class="number">1</span>;</span><br><span class="line">      n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top&lt;=<span class="number">40</span>) a[top++] = <span class="number">0</span>;</span><br><span class="line">    ans = (ans + (<span class="number">1ll</span>&lt;&lt;(i+k))%mod*<span class="built_in">dfs</span>(top<span class="number">-1</span>, <span class="number">1</span>, i))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=k; i&lt;=<span class="number">40</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp2, <span class="number">-1</span>, <span class="built_in">sizeof</span>(dp2));</span><br><span class="line">    top = <span class="number">0</span>;</span><br><span class="line">    ll n = x;</span><br><span class="line">    <span class="keyword">while</span>(n)</span><br><span class="line">    &#123;</span><br><span class="line">      a[top++] = n&amp;<span class="number">1</span>;</span><br><span class="line">      n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top&lt;=<span class="number">40</span>) a[top++] = <span class="number">0</span>;</span><br><span class="line">    ans = (ans + (<span class="number">1ll</span>&lt;&lt;i)%mod*<span class="built_in">dfs2</span>(top<span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, i, i-k))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> k1 = <span class="number">0</span>, k2 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>, &amp;s1, &amp;s2, &amp;xl, &amp;xr);</span><br><span class="line">  <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;k1)&lt;s1) ++k1;</span><br><span class="line">  <span class="keyword">while</span>((<span class="number">1</span>&lt;&lt;k2)&lt;s2) ++k2;</span><br><span class="line">  <span class="keyword">if</span>(k1&gt;k2) <span class="built_in">swap</span>(k1, k2);</span><br><span class="line">  <span class="type">int</span> k = k2 - k1;</span><br><span class="line">  <span class="keyword">if</span>(!k) &#123; <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">  ll ans = (<span class="built_in">work</span>(k, xr) - <span class="built_in">work</span>(k, xl<span class="number">-1</span>) + mod)%mod;</span><br><span class="line">  ans = (<span class="number">1ll</span>&lt;&lt;k1)%mod*ans%mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">freopen</span>(<span class="string">&quot;geometry.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h3><p>æœ‰ä¸€ä¸ªæ— å‘å›¾ï¼Œç„¶åç»™ä½ ä¸€ä¸ªæŸä¸ªç‚¹såˆ°å…¶ä»–ç‚¹æœ€çŸ­è·¯çš„æ•°ç»„dï¼Œä¸”è¦æ±‚æœ€çŸ­è·¯è‡³å°‘è¦ç»è¿‡ä¸€æ¡è¾¹<br>è¿™ä¸ªé™åˆ¶æ˜¯ä¸ºäº†é˜²æ­¢$d_s=0$ï¼Œè®©ä½ æ‰¾åˆ°æœ€å°çš„æ»¡è¶³æ¡ä»¶çš„s</p><p>æ²¡æœ‰æƒ³åˆ°å¾ˆå¥½çš„åšæ³•ï¼Œç»™å‡ºä¸€ç§å¥‡æ€ªçš„åšæ³•<br>è€ƒè™‘ä»¥sä¸ºæºç‚¹çš„è·ç¦»æ•°ç»„æ„æˆçš„æœ€çŸ­è·¯å›¾<br>å¦‚æœè¿™ä¸ªè·ç¦»æ•°ç»„æ˜¯åˆæ³•çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæœ€çŸ­è·¯å›¾è¦æ»¡è¶³æ˜¯ä¸€ä¸ªè¿é€šçš„DAGï¼Œä¸”åªæœ‰sçš„å…¥åº¦ç­‰äº0<br>æˆ‘ä»¬å¯¹æ¯ä¸ªç‚¹iï¼Œè®©$d_i=0$ï¼Œç„¶åå»ºå‡ºæœ€çŸ­è·¯å›¾åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦æ»¡è¶³ä»¥ä¸Šæ¡ä»¶å°±çŸ¥é“ièƒ½ä¸èƒ½æ˜¯æºç‚¹äº†<br>ä¸‹é¢è€ƒè™‘åŠ é€Ÿä»¥ä¸Šåšæ³•<br>æˆ‘ä»¬å…ˆæŠŠåŸæ•°ç»„çš„æœ€çŸ­è·¯å›¾å»ºå‡ºæ¥ï¼Œå¯¹äºæ¯ä¸ªiï¼ŒæŠŠå’Œå®ƒæœ‰å…³çš„è¾¹å»æ‰ï¼Œç„¶åè®©$d_i=0$ï¼Œå†æšä¸¾å’Œå®ƒç›¸è¿çš„è¾¹å»ºå‡ºæ–°è¾¹å³å¯ã€‚<br>é‚£ä¹ˆå¯¹äºåŸæ•°ç»„å»ºå‡ºçš„æœ€çŸ­è·¯å›¾ä¸­çš„æŸæ¡è¾¹$(i,j)$(i&lt;j)æ¥è¯´ï¼Œå®ƒå­˜åœ¨äº[1,iâˆ’1],[i+1,jâˆ’1]ï¼Œ[j+1,n][1,i-1],[i+1,j-1]ï¼Œ[j+1,n][1,iâˆ’1],[i+1,jâˆ’1]ï¼Œ[j+1,n]è¿™ä¸‰ä¸ªåŒºé—´<br>æ‰€ä»¥çº¿æ®µæ ‘åˆ†æ²»å³å¯ï¼Œåœ¨å¶å­çš„æ—¶å€™å†å»ºå‡ºæ–°è¾¹ã€‚æ³¨æ„ç»´æŠ¤è¿é€šå—æ•°é‡ä»¥åŠå…¥åº¦ä¸º0çš„ç‚¹æ•°<br>è¿˜éœ€è¦æ³¨æ„è¦æ»¡è¶³içš„æ‰€æœ‰è¾¹çš„æƒå€¼çš„æœ€å°å€¼è¦æ˜¯$d_i$â€‹çš„ä¸€åŠ</p><p>çº¿æ®µæ ‘åˆ†æ²»åœ¨å¶å­ä¸è¦å¿˜è®°rollback<br><code>if(l==r)</code>ä¸è¦return</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">ll s[N];</span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; G[N];</span><br><span class="line"><span class="type">int</span> fa[N], sz[N], undo[N*<span class="number">3</span>], top, scc, ans, deg[N], zcnt;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(x!=fa[x]) x = fa[x];</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  x = <span class="built_in">find</span>(x), y = <span class="built_in">find</span>(y);</span><br><span class="line">  <span class="keyword">if</span>(x==y) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">if</span>(sz[x]&gt;sz[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">  undo[++top] = x;</span><br><span class="line">  --scc;</span><br><span class="line">  fa[x] = y;</span><br><span class="line">  sz[y] += sz[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rollback</span><span class="params">(<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(top&gt;t)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x = undo[top];</span><br><span class="line">    sz[fa[x]] -= sz[x];</span><br><span class="line">    fa[x] = x;</span><br><span class="line">    ++scc;</span><br><span class="line">    --top;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; op[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> px, <span class="type">int</span> py)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">  &#123;</span><br><span class="line">    op[p].<span class="built_in">emplace_back</span>(px, py);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ins</span>(p&lt;&lt;<span class="number">1</span>, l, mid, x, y, px, py);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">ins</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r, x, y, px, py);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(~ans) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> dfn = top;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : op[p])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">merge</span>(it.fi, it.se);</span><br><span class="line">    <span class="keyword">if</span>(!deg[it.se]) --zcnt;</span><br><span class="line">    ++deg[it.se];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> tmp = top, mn = inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[l])</span><br><span class="line">    &#123;</span><br><span class="line">      mn = <span class="built_in">min</span>(mn, it.se);</span><br><span class="line">      <span class="keyword">if</span>(it.se==s[it.fi])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">merge</span>(l, it.fi);</span><br><span class="line">        <span class="keyword">if</span>(!deg[it.fi]) --zcnt;</span><br><span class="line">        ++deg[it.fi];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(scc==<span class="number">1</span> &amp;&amp; zcnt==<span class="number">1</span> &amp;&amp; mn*<span class="number">2</span>==s[l]) ans = l;</span><br><span class="line">    <span class="built_in">rollback</span>(tmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[l])</span><br><span class="line">      <span class="keyword">if</span>(it.se==s[it.fi])</span><br><span class="line">        <span class="keyword">if</span>(!(--deg[it.fi])) ++zcnt;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">go</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">go</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">rollback</span>(dfn);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : op[p])</span><br><span class="line">    <span class="keyword">if</span>(!(--deg[it.se])) ++zcnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">freopen</span>(<span class="string">&quot;hide.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, s+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">    G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fa[i] = i, sz[i] = <span class="number">1</span>;</span><br><span class="line">  scc = n, ans = <span class="number">-1</span>, zcnt = n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[i])</span><br><span class="line">      <span class="keyword">if</span>(s[i]+it.se==s[it.fi])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> x = i, y = it.fi;</span><br><span class="line">        <span class="keyword">if</span>(x&gt;y) <span class="built_in">swap</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span>(x&gt;<span class="number">1</span>) <span class="built_in">ins</span>(<span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>, x<span class="number">-1</span>, i, it.fi);</span><br><span class="line">        <span class="keyword">if</span>(y&lt;n) <span class="built_in">ins</span>(<span class="number">1</span>, <span class="number">1</span>, n, y+<span class="number">1</span>, n, i, it.fi);</span><br><span class="line">        <span class="keyword">if</span>(x+<span class="number">1</span>&lt;y) <span class="built_in">ins</span>(<span class="number">1</span>, <span class="number">1</span>, n, x+<span class="number">1</span>, y<span class="number">-1</span>, i, it.fi);</span><br><span class="line">      &#125;</span><br><span class="line">  <span class="built_in">go</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒæ¬¡å‰©ä½™</title>
      <link href="/2020/12/03/er-ci-sheng-yu/"/>
      <url>/2020/12/03/er-ci-sheng-yu/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šnå’Œå¥‡ç´ æ•°pï¼Œæ±‚xæ»¡è¶³$x^2 \equiv n ($mod$\ p)$</p><p>é¦–å…ˆè€ƒè™‘æœ‰æ²¡æœ‰è§£ï¼Œæœ‰è§£çš„nç§°ä¸ºäºŒæ¬¡å‰©ä½™ï¼Œæ— è§£çš„nç§°ä¸ºéäºŒæ¬¡å‰©ä½™<br>æ ¹æ®è´¹é©¬å°å®šç†ï¼Œå½“pä¸ºè´¨æ•°æ—¶ï¼Œæ»¡è¶³$n^p \equiv n ($mod$\ p)$<br>ç”±äºpæ˜¯å¥‡è´¨æ•°ï¼Œåˆ™$n^{2\frac{p-1}{2}} \equiv 1 ($mod$\ p)$<br>å³$n^{\frac{p-1}{2}}$â€‹ä¸º1åœ¨æ¨¡pæ„ä¹‰ä¸‹å¼€æ ¹çš„ç»“æœï¼Œåªæœ‰1å’Œ-1ä¸¤ç§å¯èƒ½<br>æœ‰æ¬§æ‹‰å‡†åˆ™ï¼Œå½“$n^{\frac{p-1}{2}} \equiv 1$æ—¶ï¼Œnæ˜¯äºŒæ¬¡å‰©ä½™ï¼Œå¦åˆ™æ˜¯éäºŒæ¬¡å‰©ä½™ã€‚<br>å½“næ˜¯äºŒæ¬¡å‰©ä½™æ—¶ï¼Œæ˜“å¾—$x^{2\frac{p-1}{2}} \equiv x^{p-1} \equiv 1$æˆç«‹ï¼Œå¿…è¦æ€§å¾—åˆ°ã€‚<br>å……åˆ†æ€§ä»¥åŠéäºŒæ¬¡å‰©ä½™çš„è¯æ˜é¸½äº†ã€‚</p><p>å†è€ƒè™‘æœ‰è§£æ—¶æœ‰å‡ ä¸ªè§£ï¼Œè®¾ä¸¤ä¸ªä¸åŒçš„è§£$x_1,x_2$â€‹ï¼Œåˆ™æ»¡è¶³$x_1^2 \equiv<br>x_2^2$â€‹ï¼Œå³$x_1^2-x_2^2 \equiv (x_1+x_2)(x_1-x_2)\equiv 0$ï¼Œç”±äº$x_1 \neq x_2$â€‹ï¼Œåªæœ‰å¯èƒ½$x_1$å’Œ$x_2$äº’ä¸ºç›¸åæ•°ï¼Œç”±äº$p$æ˜¯å¥‡æ•°ï¼Œ$x_1$å’Œ$x_2$çš„å¥‡å¶æ€§ä¸€å®šä¸åŒï¼Œå› æ­¤å€¼ä¸€å®šä¸åŒã€‚æ‰€ä»¥é™¤0å¤–æ¯ä¸ªäºŒæ¬¡å‰©ä½™éƒ½å¯¹åº”ä¸¤ä¸ªè§£ï¼Œä¸”è¿™ä¸¤ä¸ªè§£äº’ä¸ºç›¸åæ•°ã€‚åŒæ ·çš„ï¼Œä¸¤ä¸ªç›¸åæ•°å¯¹åº”äº†ä¸€ä¸ªäºŒæ¬¡å‰©ä½™ï¼Œå› æ­¤åœ¨$[1,p-1]$ä¸­æ€»å…±æœ‰$\frac{p-1}{2}$â€‹ä¸ªäºŒæ¬¡å‰©ä½™</p><p>æœ€åè€ƒè™‘æœ‰è§£æ—¶æ€ä¹ˆæ±‚ã€‚å…ˆæ‰¾åˆ°ä¸€ä¸ªaï¼Œæ»¡è¶³$a^2-n$æ˜¯éäºŒæ¬¡å‰©ä½™ï¼Œéšæœºæ‰¾å³å¯ï¼Œä¸€æ¬¡æœ‰$\frac{1}{2}$â€‹çš„æ¦‚ç‡æ‰¾åˆ°<br>ä»¤$i^2 \equiv a^2-n$<br>æœ‰$(a+i)^{p+1} \equiv n$</p><ul><li>$i^p \equiv i(a^2-n)^{\frac{p-1}{2}} \equiv -i$</li><li>$(a+b)^p \equiv a^p+b^p$ è€ƒè™‘äºŒé¡¹å¼å®šç†<br>$(a+i)^{p+1} \equiv (a^p+i^p)(a+i) \equiv (a-i)(a+i) \equiv n$<br>é‚£ä¹ˆ$(a+i)^{\frac{p+1}{2}}$â€‹å°±æ˜¯ä¸€ä¸ªè§£<br>ç”±äº$a^2-n$æ˜¯éäºŒæ¬¡å‰©ä½™ï¼Œå› æ­¤$i$å®é™…ä¸å­˜åœ¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç±»ä¼¼å¤æ•°ä¸€æ ·å®šä¹‰ï¼Œç„¶åå®šä¹‰ä¹˜æ³•å³å¯è®¡ç®—å¿«é€Ÿå¹‚äº†ï¼Œå®šä¹‰å½¢å¦‚$a+bi$ï¼Œåˆ™$a+i$å°±æ˜¯$a+1i$<br>$(a+bi)(c+di) \equiv (ac+bdi^2+adi+bci)$ï¼ŒæŠŠ$i^2$ç”¨$a^2-n$ä»£æ›¿å³å¯</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">ll w, n, p;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Complex</span></span><br><span class="line">&#123;</span><br><span class="line">  ll x, y;</span><br><span class="line">  <span class="built_in">Complex</span>(<span class="type">int</span> _x,<span class="type">int</span> _y) : <span class="built_in">x</span>(_x), <span class="built_in">y</span>(_y) &#123;&#125;</span><br><span class="line">  Complex <span class="keyword">operator</span> * (<span class="type">const</span> Complex &amp;b) <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Complex</span>(((x*b.x%p+y*b.y%p*w%p)%p+p)%p,((x*b.y%p+y*b.x%p)%p+p)%p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">ll <span class="title">powcp</span><span class="params">(Complex a,ll b,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="function">Complex <span class="title">ans</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = ans*a;</span><br><span class="line">    a = a*a;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll n,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  n %= p;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">2</span>) <span class="keyword">return</span> n;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">powmod</span>(n,(p<span class="number">-1</span>)/<span class="number">2</span>,p)==p<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">//æ— è§£</span></span><br><span class="line">  ll a;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    a = <span class="built_in">rand</span>()%p;</span><br><span class="line">    w = ((a*a%p-n)%p+p)%p;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">powmod</span>(w,(p<span class="number">-1</span>)/<span class="number">2</span>,p)==p<span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">Complex <span class="title">x</span><span class="params">(a,<span class="number">1</span>)</span></span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">powcp</span>(x,(p+<span class="number">1</span>)/<span class="number">2</span>,p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">srand</span>(<span class="built_in">int</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>)));</span><br><span class="line">ll ans1 = <span class="built_in">solve</span>(n,p), ans2;</span><br><span class="line"><span class="keyword">if</span>(ans1==<span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">&quot;Hola!\n&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  ans2 = p - ans1;</span><br><span class="line">  <span class="keyword">if</span>(ans1&gt;ans2) <span class="built_in">swap</span>(ans1,ans2);</span><br><span class="line">  <span class="keyword">if</span>(ans1==ans2) <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans1);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>,ans1,ans2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°åšæ³•ç”±äºè¦æ‰‹å†™ä¸€ä¸ªå¤æ•°ç±»ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”å¸¸æ•°ä¹Ÿå¤§ï¼Œè¿˜æœ‰ä¸€ç§<code>ToneLLi_Shanks</code>ç®—æ³•<br>åŸç†é¸½äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">TS</span><span class="params">(ll n, ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(p==<span class="number">2</span>) <span class="keyword">return</span> (n&amp;<span class="number">1</span>) ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">Pow</span>(n, p&gt;&gt;<span class="number">1</span>, p)!=<span class="number">1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span>(p&amp;<span class="number">2</span>) <span class="keyword">return</span> <span class="built_in">Pow</span>(n, (p+<span class="number">1</span>)&gt;&gt;<span class="number">2</span>, p);</span><br><span class="line">  <span class="type">int</span> s = __builtin_ctzll(p^<span class="number">1</span>);</span><br><span class="line">  ll q = p&gt;&gt;s, z = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">for</span>(; <span class="built_in">Pow</span>(z, p&gt;&gt;<span class="number">1</span>, p)==<span class="number">1</span>; z++);</span><br><span class="line">  ll c = <span class="built_in">Pow</span>(z, q, p);</span><br><span class="line">  ll r = <span class="built_in">Pow</span>(n, (q+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>, p);</span><br><span class="line">  ll t = <span class="built_in">Pow</span>(n, q, p), tmp;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> m=s, i; t!=<span class="number">1</span>; )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>, tmp=t; tmp!=<span class="number">1</span>; i++) tmp = tmp*tmp%p;</span><br><span class="line">    <span class="keyword">for</span>(; i&lt;--m; ) c = c*c%p;</span><br><span class="line">    r = r*c%p;</span><br><span class="line">    c = c*c%p;</span><br><span class="line">    t = t*c%p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;p);</span><br><span class="line">  ll ans = <span class="built_in">TS</span>(n, p);</span><br><span class="line">  <span class="keyword">if</span>(ans==<span class="number">-1</span>) <span class="built_in">puts</span>(<span class="string">&quot;Hola!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(!ans) <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    ll ans2 = p - ans;</span><br><span class="line">    <span class="keyword">if</span>(ans&gt;ans2) <span class="built_in">swap</span>(ans, ans2);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld %lld\n&quot;</span>, ans, ans2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¡¥å……ï¼š<br>å¯¹äºä¸‰æ¬¡å‰©ä½™<br>è‹¥$p % 3 = 2$ï¼Œåˆ™æ¯ä¸ªæ•°éƒ½æ˜¯ä¸‰æ¬¡å‰©ä½™ï¼Œå¹¶ä¸”æœ‰å”¯ä¸€è§£$n^{\frac{2p-1}{3}}$â€‹<br>è‹¥$p % 3 = 1$ï¼Œåˆ™æœ‰$\frac{p-1}{3}$â€‹ä¸ªæ•°æ˜¯ä¸‰æ¬¡å‰©ä½™ï¼Œä¸”æ¯ä¸ªæ•°æœ‰ä¸‰ä¸ªè§£</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ç§¦çš‡å²› J Jewel Splitting</title>
      <link href="/2020/12/03/2020-qin-huang-dao-j-jewel-splitting/"/>
      <url>/2020/12/03/2020-qin-huang-dao-j-jewel-splitting/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ä¸€ä¸ªé•¿åº¦ä¸ºnçš„å­—ç¬¦ä¸²ï¼Œè®©ä½ æ’æˆé•¿ä¸ºdï¼Œå®½ä¸º$\lfloor \frac{n}{d}<br>\rfloor$çš„çŸ©å½¢ï¼Œå³å°†è¿ç»­çš„é•¿åº¦dçš„å­ä¸²ä½œä¸ºä¸€è¡Œï¼Œå¤šä½™çš„n%dä¸ªä¸¢å¼ƒï¼Œé—®æœ‰å¤šå°‘ç§ä¸åŒçš„çŸ©å½¢ï¼Œmod 998244353<br>$n \leq 3 \times 10^5$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>æ˜¾ç„¶ä¸åŒçš„däº’ä¸å½±å“ï¼Œå¯ä»¥åˆ†å¼€åš<br>å½“$d \mid n$ï¼Œå°±æ˜¯ä¸€ä¸ªå¯é‡é›†æ’åˆ—ï¼Œç”¨mapæ¥ç»´æŠ¤æ¯ç§hashå€¼å‡ºç°çš„ä¸ªæ•°<br>å½“$d \nmid n$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šä¸¢å¼ƒ$[1,n%d],[d+1,d+n%d]â€¦$ï¼Œå®¹æ˜“å‘ç°ç›¸é‚»ä¸¤ç§åªæœ‰ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸åŒçš„ï¼Œå› æ­¤åŠ¨æ€ç»´æŠ¤å³å¯ã€‚æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œä¸¢å¼ƒä¸åŒçš„åŒºé—´ï¼Œå‰©ä½™çš„ä¸²çš„ç±»å‹æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œå³è¿™ä¸ªçŠ¶æ€çš„mapæ˜¯ä¸€æ ·çš„ï¼Œè¿™æ—¶å€™ä¸èƒ½é‡å¤ç®—ï¼Œå› æ­¤è¿˜è¦å¯¹æ¯ä¸ªæ—¶åˆ»çš„mapçŠ¶æ€è¿›è¡Œhashã€‚<br>æ€è·¯ä¸éš¾ï¼Œä½†æ˜¯å¡å¸¸ã€‚ä¸åŒhashä¼šwaï¼ŒåŒhashåˆtleğŸ¤¡</p><p>å­—ç¬¦ä¸²çš„rolling<br>hashçš„æœ¬è´¨å…¶å®å°±æ˜¯å°†è¿™ä¸ªå­—ç¬¦ä¸²ç”¨baseè¿›åˆ¶çš„æ•°æ¥è¡¨ç¤ºï¼Œç„¶åå¯ä»¥O(1)çš„æ±‚æ¯ä¸ªå­åŒºé—´çš„hashå€¼ï¼ˆæˆ‘å¥½åƒåˆ°ç°åœ¨æ‰æ˜ç™½å­—ç¬¦ä¸²hashå°±æ˜¯ç”¨baseè¿›åˆ¶æ•°æ¥è¡¨ç¤ºã€‚ã€‚ã€‚ï¼‰<br>è€ƒè™‘mapçš„çŠ¶æ€æ€ä¹ˆæ±‚ï¼Œå°±ç›¸å¯¹äºæœ‰å¾ˆå¤špairsï¼Œï¼ˆhashï¼Œcntï¼‰ã€‚<br>æˆ‘çš„åšæ³•æ˜¯æŠŠhashå€¼ä¸¢åˆ°mapé‡Œç„¶åæ˜ å°„æˆå°çš„ç¼–å·ï¼Œç„¶åcntå°±å¯ä»¥ç”¨æ•°ç»„æ¥å­˜äº†ï¼Œç„¶åmapçš„çŠ¶æ€å°±ç›¸å½“äºç¬¬id[hash]ä½çš„å€¼ä¸ºcntï¼Œç”¨cnt*pw[id[hash]]æ¥è¡¨ç¤ºå³å¯ã€‚<br>å¦‚æœåªè¦æ•´ä¸ªä¸²çš„hashå€¼ï¼Œå„ä¸ªä½çš„å€¼ç”¨å¼‚æˆ–ä¹Ÿæ˜¯å¯ä»¥ï¼Œè¿™æ ·å¯ä»¥å¿«ç‚¹ã€‚<br>ç„¶åå°±æ˜¯åŒhashçš„å€¼ï¼Œç”¨pairçš„è¯è‚¯å®šä¼šæ…¢ï¼Œè¿™é‡Œç”¨intå­˜ï¼Œç„¶åé«˜ä½ä½åˆå¹¶æˆä¸€ä¸ªullå³å¯ã€‚</p><p>é€šè¿‡è¿™é¢˜æµ‹äº†ä¸€ä¸‹å„ç§mapå’Œset<br>unordered_setå¾ˆæ²¡ç”¨ï¼Œsetå’Œmapæ¯”è¾ƒç¨³å®šï¼Œunordered_mapæœ‰æ—¶å¿«æœ‰æ—¶æ…¢ï¼ŒåŠ äº†æ‰‹å†™hashä¹Ÿæ…¢ï¼Œå¾ˆä¸ç¨³å®šã€‚<br>æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹è¿˜æ˜¯ç”¨setå’Œmapå°±è¡Œäº†ï¼Œç¨³å®šlogï¼Œunorderedå®¹æ˜“å¡æˆn<br>å¦‚æœè¦å®ç°æ— åºçš„setï¼Œä¸æ¨èunordered_setã€‚<br>å¦‚æœå¯ä»¥ç¦»çº¿ï¼Œé‚£å°±vector<br>æ­¤å¤–pbdsçš„gp_hash_tableå¾ˆå¿«ï¼Œè¢«å¡mapå¯ä»¥ç”¨è¿™ä¸ªä»£æ›¿unordered_map</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">int</span>&gt; id;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">bool</span>&gt; vis;</span><br><span class="line">gp_hash_table&lt;ull, null_type&gt; vis;</span><br></pre></td></tr></table></figure><p>æ— åºsetä¹Ÿå¯ä»¥ç”¨ä¸‹é¢ä¸¤ä¸ªï¼Œæµ‹å‡ºæ¥boolå¿«ä¸€ç‚¹ï¼Œnull_typeå†…å­˜å°ç‚¹<br>gp_hash_tableå°è£…çš„å‡½æ•°ä¸å¤šï¼Œåªæœ‰ä¸‹æ ‡ã€insert<br>è¦å®ç°countï¼Œè¦é find==end<br>æ‰€ä»¥æœ€å¥½å¼€å±€éƒ¨ï¼Œä¸è¦å¼€å…¨å±€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapï¼š2700ms</span><br><span class="line">gp_hash_tableï¼š1700ms</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ull = <span class="type">uint64_t</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, mod2 = <span class="number">1e9</span> + <span class="number">9</span>, base = <span class="number">19260817</span>;</span><br><span class="line"><span class="type">int</span> kase;</span><br><span class="line"><span class="type">int</span> n, fac[N&lt;&lt;<span class="number">1</span>], ifac[N&lt;&lt;<span class="number">1</span>], cnt[N&lt;&lt;<span class="number">1</span>], ans, tot;</span><br><span class="line"><span class="type">int</span> HSH, HSH2;</span><br><span class="line"><span class="comment">//map&lt;ull, int&gt; id;</span></span><br><span class="line">gp_hash_table&lt;ull, <span class="type">int</span>&gt; id;</span><br><span class="line">gp_hash_table&lt;ull, <span class="type">bool</span>&gt; vis;</span><br><span class="line"><span class="comment">//map&lt;int, bool&gt; vis;</span></span><br><span class="line"><span class="comment">//set&lt;int&gt; st;</span></span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="type">int</span> pw[N&lt;&lt;<span class="number">1</span>], pw2[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> hsh[N], hsh2[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> &amp;x, <span class="type">int</span> y)</span> </span>&#123; x += y; <span class="keyword">if</span>(x&gt;=mod) x -= mod; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Pow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  pw[<span class="number">0</span>] = pw2[<span class="number">0</span>] = fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">2</span>*n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    pw[i] = <span class="number">1ll</span>*pw[i<span class="number">-1</span>]*base%mod;</span><br><span class="line">    pw2[i] = <span class="number">1ll</span>*pw2[i<span class="number">-1</span>]*base%mod2;</span><br><span class="line">    fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  ifac[n] = <span class="built_in">Pow</span>(fac[n], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    hsh[i] = (<span class="number">1ll</span>*hsh[i<span class="number">-1</span>]*base%mod + s[i])%mod;</span><br><span class="line">    hsh2[i] = (<span class="number">1ll</span>*hsh2[i<span class="number">-1</span>]*base%mod2 + s[i])%mod2;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; x -= y; <span class="keyword">if</span>(x&lt;<span class="number">0</span>) x += mod; <span class="keyword">return</span> x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub2</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; x -= y; <span class="keyword">if</span>(x&lt;<span class="number">0</span>) x += mod2; <span class="keyword">return</span> x; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">Sub</span>(hsh[r], <span class="number">1ll</span>*hsh[l<span class="number">-1</span>]*pw[r-l+<span class="number">1</span>]%mod); &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get2</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">Sub2</span>(hsh2[r], <span class="number">1ll</span>*hsh2[l<span class="number">-1</span>]*pw2[r-l+<span class="number">1</span>]%mod2); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ull hv = (ull)<span class="built_in">get</span>(l, r)&lt;&lt;<span class="number">32</span>|<span class="built_in">get2</span>(l, r), p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">auto</span> it = id.<span class="built_in">find</span>(hv);</span><br><span class="line">  <span class="keyword">if</span>(it==id.<span class="built_in">end</span>()) p = id[hv] = ++tot;</span><br><span class="line">  <span class="keyword">else</span> p = it-&gt;second;</span><br><span class="line">  HSH ^= <span class="number">1ll</span>*pw[p]*cnt[p]%mod;</span><br><span class="line">  HSH2 ^= <span class="number">1ll</span>*pw2[p]*cnt[p]%mod2;</span><br><span class="line">  ans = <span class="number">1ll</span>*ans*fac[cnt[p]]%mod*ifac[cnt[p] + v]%mod;</span><br><span class="line">  cnt[p] += v;</span><br><span class="line">  HSH ^= <span class="number">1ll</span>*pw[p]*cnt[p]%mod;</span><br><span class="line">  HSH2 ^= <span class="number">1ll</span>*pw2[p]*cnt[p]%mod2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(gp_hash_table&lt;ull, <span class="type">int</span>&gt; &amp;table)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  gp_hash_table&lt;ull, <span class="type">int</span>&gt; tmp;</span><br><span class="line">  table.<span class="built_in">swap</span>(tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(gp_hash_table&lt;ull, <span class="type">bool</span>&gt; &amp;table)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  gp_hash_table&lt;ull, <span class="type">bool</span>&gt; tmp;</span><br><span class="line">  table.<span class="built_in">swap</span>(tmp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">work</span><span class="params">(<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=tot; i++) cnt[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="comment">//st.clear();</span></span><br><span class="line">  <span class="built_in">clear</span>(id); <span class="built_in">clear</span>(vis);</span><br><span class="line">  tot = HSH = HSH2 = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">  ans = fac[n/d];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n%d+<span class="number">1</span>; i&lt;=n; i+=d) <span class="built_in">upd</span>(i, i+d<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="comment">//vector&lt;pair&lt;ull, int&gt;&gt; lsh;</span></span><br><span class="line">  <span class="comment">//lsh.push_back(&#123;(ull)HSH&lt;&lt;32|HSH2, ans&#125;);</span></span><br><span class="line">  <span class="built_in">Add</span>(sum, ans); vis.<span class="built_in">insert</span>(&#123;(ull)HSH&lt;&lt;<span class="number">32</span>|HSH2, <span class="number">1</span>&#125;);</span><br><span class="line">  <span class="keyword">if</span>(n%d)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> m = n/d*d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;m; i+=d)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">upd</span>(i, i+d<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">      <span class="built_in">upd</span>(i+n%d, i+n%d+d<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">      <span class="comment">//lsh.push_back(&#123;(ull)HSH&lt;&lt;32|HSH2, ans&#125;);</span></span><br><span class="line">      <span class="keyword">if</span>(vis.<span class="built_in">find</span>((ull)HSH&lt;&lt;<span class="number">32</span>|HSH2)==vis.<span class="built_in">end</span>()) <span class="built_in">Add</span>(sum, ans), vis.<span class="built_in">insert</span>(&#123;(ull)HSH&lt;&lt;<span class="number">32</span>|HSH2, <span class="number">1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  sort(begin(lsh), end(lsh));</span></span><br><span class="line"><span class="comment">  for(int i=0; i&lt;(int)lsh.size(); )</span></span><br><span class="line"><span class="comment">  &#123;</span></span><br><span class="line"><span class="comment">    int j = i + 1;</span></span><br><span class="line"><span class="comment">    while(j&lt;(int)lsh.size() &amp;&amp; lsh[j]==lsh[i])</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">      //assert(lsh[j].second==lsh[i].second);</span></span><br><span class="line"><span class="comment">      ++j;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    Add(sum, lsh[i].second);</span></span><br><span class="line"><span class="comment">    i = j;</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s+<span class="number">1</span>);</span><br><span class="line">  <span class="comment">//for(int i=1; i&lt;=300000; i++) s[i] = char(&#x27;a&#x27;+i%26);</span></span><br><span class="line">  <span class="comment">//s[300001] = 0;</span></span><br><span class="line">  n = <span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> d=<span class="number">1</span>; d&lt;=n; d++) <span class="built_in">Add</span>(res, <span class="built_in">work</span>(d));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: %d\n&quot;</span>, ++kase, res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">pre</span>(N<span class="number">-5</span>);</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codechef Counting Spaghetti æ•°å­¦</title>
      <link href="/2020/11/25/codechef-counting-spaghetti-shu-xue/"/>
      <url>/2020/11/25/codechef-counting-spaghetti-shu-xue/</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨æœ‰$L, L+1,â€¦R-1,R$è¿™R-L+1ä¸ªæ•°å­—ï¼Œé—®ä½ èƒ½å¤Ÿç»„æˆå¤šå°‘ç§ä¸åŒçš„æ•°å­—å’Œ<br>$L \leq 10^9, R \leq 10^9$</p><p>è€ƒè™‘ç”¨xä¸ªæ•°å­—æ¥ç»„åˆ<br>1ä¸ªæ•°å­—ï¼š$[L, R]$å†…çš„æ‰€æœ‰æ•°å­—</p><p>2ä¸ªæ•°å­—ï¼š$[L+L+1, R+R-1]$å†…çš„æ‰€æœ‰æ•°å­—</p><p>3ä¸ªæ•°å­—ï¼š$[L+L+1+L+2, R+R-1-R-2]$å†…çš„æ‰€æœ‰æ•°å­—</p><p>åˆ™å¯¹äºxä¸ªæ•°å­—æœ‰ï¼š$l_x = \frac{x(2L+x-1)}{2}$, $r_x = \frac{x(2R-x+1)}{2}$</p><p>å› æ­¤åªè¦æ±‚ç”¨1$\sim$R-L+1ä¸ªæ•°å­—æ„æˆçš„å„ä¸ªåŒºé—´çš„å¹¶é›†çš„é•¿åº¦å³å¯<br>è€ƒè™‘$l_x&gt;r_{x-1}$<br>åˆ™è¦æ»¡è¶³$x^2 + (L-R-2)x + R + 1 &gt; 0$<br>å½“$(R-L+2)^2 - 4R - 4&lt;0$æ—¶ï¼Œæ‰€æœ‰åŒºé—´éƒ½ä¸ç›¸äº¤ï¼Œåˆå‘ç°æ­¤æ—¶R-L+1åœ¨$O(\sqrt Râ€‹$)çº§åˆ«ï¼Œæ‰€ä»¥æš´åŠ›æ±‚å‡ºå„ä¸ªåŒºé—´çš„é•¿åº¦ç›¸åŠ å³å¯<br>å¦åˆ™ï¼Œæ±‚å‡ºä¸¤ä¸ªæ ¹x1ï¼Œx2ï¼Œåˆ™åœ¨$[x1,x2]$è¿™ä¸€æ®µåŒºé—´éƒ½æ˜¯ç›¸äº¤çš„ï¼ŒåŒºé—´å¹¶çš„å·¦ç«¯ç‚¹ä¸ºx1çš„å·¦ç«¯ç‚¹ï¼Œå³ç«¯ç‚¹x2çš„å³ç«¯ç‚¹ã€‚<br>è€ƒè™‘$\frac{R-L+2 \pm \sqrt{(R-L+2)^2-4R-4}}{2}$<br>è®¾R-L+2ä¸ºaï¼Œ4R-4ä¸ºbï¼Œä¸”æ»¡è¶³$a \geq \sqrt b$<br>$a-\sqrt{a^2-b} = a-\sqrt{(a+\sqrt b)(a - \sqrt b)} \leq a - \sqrt{(a-\sqrt b)^2} = \sqrt b$<br>æ‰€ä»¥1$\sim$x1çš„é•¿åº¦åœ¨$O(\sqrt b)$çº§åˆ«ï¼Œè€Œx2$\sim$açš„é•¿åº¦ä¸º<br>$a-\frac{R-L+2 + \sqrt{(R-L+2)^2-4R-4}}{2} = \frac{R-L+2 - \sqrt{(R-L+2)^2-4R-4}}{2}$â€‹ï¼Œä¹Ÿåœ¨$O(\sqrt b)$çº§åˆ«ï¼Œæ‰€ä»¥åªéœ€è¦å¯¹ä¸¤ç«¯ä¸ç›¸äº¤çš„éƒ¨åˆ†æš´åŠ›å³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ICPC æ±Ÿè¥¿çœå¤§å­¦ç”Ÿç¨‹åºè®¾è®¡ç«èµ›</title>
      <link href="/2020/11/20/2020icpc-jiang-xi-sheng-da-xue-sheng-cheng-xu-she-ji-jing-sai/"/>
      <url>/2020/11/20/2020icpc-jiang-xi-sheng-da-xue-sheng-cheng-xu-she-ji-jing-sai/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®éƒ½ä¸éš¾ï¼ŒDé¢˜é¢˜é¢å‡ºé”…</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>å®šä¹‰$F_j$â€‹ä¸ºjå„ä½æ•°å­—ä¹‹å’Œ<br>æ±‚$\sum_{i=1}^n\sum_{j=1}^i [gcd(i,j)==1]F(j)$<br>è«æ¯”ä¹Œæ–¯åæ¼”ï¼ŒçŸ¥é“$\mu * I = \epsilon$ï¼Œåˆ™<br>$\sum \limits_{d \mid gcd(i,j)} 1 = [gcd(i,j)==1]$<br>$d\mid gcd(i,j)$ç­‰ä»·äº$d\mid i,d\mid j$<br>è½¬æ¢æˆæšä¸¾dï¼Œç„¶åå°±å¯ä»¥$O(n\log n)$æšä¸¾å€æ•°ç®—äº†</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç­¾åˆ°</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>æœ‰nä¸ªåŒºé—´ï¼Œè¦æ±‚é€‰æ‹©æŸäº›åŒºé—´ï¼Œå®šä¹‰é€‰æ‹©å‡ºçš„åŒºé—´çš„ä»·å€¼ä¸ºmin(é€‰æ‹©çš„åŒºé—´ä¸ªæ•°ï¼ŒåŒºé—´äº¤é›†çš„é•¿åº¦)ï¼Œè¦æ±‚æœ€å¤§åŒ–è¯¥ä»·å€¼<br>$n \leq 3\times 10^5$<br>æ˜¾ç„¶å¯ä»¥äºŒåˆ†ï¼Œ$O(n\log n)$çš„checkä¹Ÿå¾ˆç®€å•ï¼Œä½†æ˜¯ä¼šè¢«å¡t<br>è€ƒè™‘å¦‚ä½•$O(n)$çš„check<br>çœ‹ä»·å€¼èƒ½ä¸èƒ½è¾¾åˆ°vï¼Œå°±ç­‰ä»·äºé€‰æ‹©vä¸ªåŒºé—´ï¼Œä¸”è¿™äº›åŒºé—´çš„äº¤é›†çš„é•¿åº¦$\geq v$<br>å°†æ‰€æœ‰åŒºé—´æŒ‰ç…§å·¦ç«¯ç‚¹å…ˆæ’åº<br>æšä¸¾äº¤é›†çš„åŒºé—´çš„å·¦ç«¯ç‚¹lï¼Œåˆ™å³ç«¯ç‚¹ä¸ºl+v-1ï¼Œåªè¦å·¦ç«¯ç‚¹å°äºç­‰äºlçš„åŒºé—´ä¸­å­˜åœ¨è‡³å°‘vä¸ªå³ç«¯ç‚¹$\geq l+v-1$å³å¯ï¼Œå°ºå–æ³•</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>æœ‰nä¸ªæ•°å­—ï¼Œæ€»é•¿åº¦ä¸è¶…è¿‡$10^6$ï¼Œè®©ä½ æ±‚è¿™äº›æ•°å­—çš„æ‰€æœ‰æœ¬è´¨ä¸åŒå­ä¸²çš„ä»·å€¼ï¼ˆæ•°å­—å¤§å°ï¼‰å’Œ<br>æˆ‘æè¿°æˆæœ¬è´¨ä¸åŒå­ä¸²ä¹‹åï¼Œåº”è¯¥å¾ˆå®¹æ˜“æƒ³åˆ°exsam<br><s>å‡ ä¸ªæœˆæ²¡å†™æ¦‚å¿µéƒ½å¿˜å®Œ</s><br>åªéœ€è¦å»ºå‡ºexsamçš„dagå›¾ï¼Œç„¶åæŒ‰ç…§æ‹“æ‰‘åºdpå³å¯ï¼Œåªéœ€è¦çŸ¥é“ä»¥æ¯ä¸ªendposé›†åˆï¼ˆå³å›¾ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹ï¼‰ç»“å°¾çš„æ‰€æœ‰å­ä¸²çš„å’Œï¼Œå¦‚uæœ‰ä¸ªiçš„å‡ºè¾¹è¿å‘vï¼Œåˆ™å°±æœ‰$dp[u]\times 10+i\times |u|$çš„è´¡çŒ®ï¼Œ$|u|$å°±è¡¨ç¤ºuè¿™ä¸ªendposé›†åˆçš„å¤§å°ï¼Œå°±æ˜¯len[u] - len[fa[u]]<br>äº¤ä¸Šå»waäº†ï¼Œæƒ³åˆ°ä¸€ä¸ªå‰å¯¼0çš„å‘ç‚¹ï¼Œæ¯”å¦‚302ä¸­ï¼Œ02å’Œ2åº”è¯¥ç®—åŒä¸€ä¸ªï¼Ÿè¿™æ ·åº”è¯¥ä¹Ÿèƒ½åšï¼Œåªè¦æŠŠåŸç‚¹çš„0å‡ºè¾¹çš„çŠ¶æ€èƒ½åˆ°è¾¾çš„ç‚¹çš„endposé›†åˆå¤§å°-1å°±è¡Œã€‚<br>å…¶å®å¹¶ä¸æ˜¯<br>é¢˜é¢æ¨¡998244353ï¼Œæ•°æ®æ˜¯æ¨¡1000000007ï¼Œç¦»è°±</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ä¸€ä¸ªé•¿åº¦ä¸ºnçš„åºåˆ—cï¼Œæ±‚æœ‰å¤šå°‘ä¸ªå­åºåˆ—æ»¡è¶³æ¯ç§æ•°å­—å‡ºç°å¶æ•°æ¬¡<br>$n\leq 10^6,c_i\leq 20$<br>å­åºåˆ—è€ƒè™‘å‰ç¼€å’Œï¼Œå¯¹20ç§æ•°å­—çŠ¶å‹å³å¯</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>è®©ä½ æ„é€ ä¸€ä¸ªæœ€å¤§çš„æ•°ï¼Œæ»¡è¶³å®ƒçš„æ¯ä¸ªå‰ç¼€éƒ½èƒ½è¢«è¿™ä¸ªå‰ç¼€çš„é•¿åº¦æ•´é™¤ï¼Œæ„é€ çš„æ•°å­—è¦æ±‚ç”¨ç«æŸ´æ£’è¡¨ç¤ºï¼Œä¸”è¦æ±‚æ°å¥½ä½¿ç”¨næ ¹<br>$n \leq 10^{100}$<br>ç¨å¾®æƒ³æƒ³å°±èƒ½æ„Ÿè§‰åˆ°ç¬¦åˆçš„æ•°ä½æ•°ä¸ä¼šå¾ˆå¤§ï¼Œäº‹å®ä¸Šé•¿åº¦è¶…è¿‡3å°±ä¸€å®šä¸è¡Œäº†ï¼Œæ‰€ä»¥æš´åŠ›dfså°±å®Œäº‹äº†</p><h2 id="G"><a class="header-anchor" href="#G">Â¶</a>G</h2><p>ä¸€ä¸ªé›†åˆåŒ…å«1-n nä¸ªæ•°ï¼Œè¦æ±‚ä½ ä¾æ¬¡é€‰æ‹©mä¸ªæ•°çš„é›†åˆï¼Œè¦æ±‚é›†åˆé—´æ²¡æœ‰äº¤é›†ï¼Œé›†åˆå¯ä»¥ç©ºï¼Œæ±‚æ“ä½œçš„æ–¹æ¡ˆæ•°<br>è½¬åŒ–ä¸€ä¸‹ï¼Œå¯ä»¥è€ƒè™‘ç¬¬iä¸ªæ•°å½’å±å“ªä¸ªé›†åˆï¼Œæ˜¾ç„¶æœ‰m+1ç§é€‰æ‹©ï¼Œæ²¡è¢«é€‰æˆ–è€…é€‰åˆ°ç¬¬jä¸ªé›†åˆã€‚<br>æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯$(m+1)^n$<br>pythonçš„powè‡ªå¸¦å¿«é€Ÿå¹‚</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>ä¸€ä¸ªåºåˆ—ï¼Œè¦æ±‚æ”¯æŒä¿®æ”¹ä¸€ä¸ªæ•°ï¼Œè¯¢é—®ä»¥æŸä¸ªæ•°ä¸ºæœ€å°å€¼çš„åŒºé—´ä¸ªæ•°ã€‚<br>ä¿è¯åºåˆ—ä¸­æ²¡æœ‰é‡å¤æ•°å­—<br>æ˜¾ç„¶åªè¦æ‰¾åˆ°å·¦å³ä¸¤è¾¹ç¬¬ä¸€ä¸ªå°äºä½ çš„æ•°å³å¯<br>è®°å½•åŒºé—´æœ€å°å€¼ï¼Œçº¿æ®µæ ‘ä¸Šè´ªå¿ƒç€èµ°å³å¯</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>è§„å¾‹é¢˜</p><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>äºŒç»´SG</p><h2 id="K"><a class="header-anchor" href="#K">Â¶</a>K</h2><p>å¯ä»¥ä»èµ·ç‚¹å‡ºå‘å¸¦xä¸ªç‰©å“ï¼Œèµ°ç¬¬yæ­¥è·¯çš„æ¶ˆè´¹æ˜¯$x^y$ï¼Œå¤šæ¬¡è¯¢é—®ä»såˆ°tï¼Œä½ æ‹¥æœ‰må…ƒé’±ï¼Œåˆ™åœ¨èµ·ç‚¹æœ€å¤šå¸¦å¤šå°‘ä¸ªç‰©å“ã€‚<br>ç‚¹æ•°æ˜¯100<br>å…ˆè·‘ä¸ªfloydï¼Œåˆ™såˆ°tçš„èŠ±è´¹å°±æ˜¯ä¸€ä¸ªç­‰æ¯”æ•°åˆ—ï¼ŒäºŒåˆ†ä¸€ä¸‹å…¬æ¯”å³å¯ï¼Œæ³¨æ„å…¬æ¯”ä¸º1çš„æƒ…å†µ</p><h2 id="L"><a class="header-anchor" href="#L">Â¶</a>L</h2><p>nçš‡åï¼Œä½†æ˜¯å¯ä»¥åœ¨ä¸€æ¡æ–œçº¿<br>çŠ¶å‹dp</p><h2 id="M"><a class="header-anchor" href="#M">Â¶</a>M</h2><p>è¾“å‡ºstring s+string t</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ccpc ç»µé˜³</title>
      <link href="/2020/11/02/2020ccpc-mian-yang/"/>
      <url>/2020/11/02/2020ccpc-mian-yang/</url>
      
        <content type="html"><![CDATA[<h2 id="Dï¼š-Defuse-the-Bombs"><a class="header-anchor" href="#Dï¼š-Defuse-the-Bombs">Â¶</a>Dï¼š Defuse the Bombs</h2><p>æœ‰nä¸ªè®¡æ•°å™¨ï¼Œåˆå€¼ä¸º$a_i$â€‹ï¼Œæ¯ç§’é’Ÿå¯ä»¥å°†ä¸€ä¸ªè®¡æ•°å™¨çš„å€¼+1ï¼Œç„¶åæ‰€æœ‰çš„è®¡æ•°å™¨çš„å€¼-1ã€‚é—®æœ€å¤šå‡ ç§’åæ‰€æœ‰è®¡æ•°å™¨çš„æœ€å°å€¼$\lt 0$<br>$n\leq 10^5, 0 \leq a_i \leq 10^9$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è½¬åŒ–ä¸€ä¸‹é—®é¢˜ï¼šæ¯ç§’é’Ÿå¯ä»¥è®©ä¸€ä¸ªè®¡æ•°å™¨å€¼+1ï¼Œç¬¬iç§’é’Ÿè¦æ±‚æ‰€æœ‰è®¡æ•°å™¨çš„å€¼$\geq i$ï¼Œé—®ç¬¬å‡ ç§’åä¸æ»¡è¶³ã€‚<br>å‡å¦‚ç¬¬xç§’é’Ÿæ»¡è¶³æ¡ä»¶ï¼Œåˆ™è¦æ»¡è¶³$sum_p+x \geq x*p$ï¼Œå…¶ä¸­$a_p$â€‹ä¸ºå°äºxçš„æœ€å¤§çš„pã€‚<br>å…ˆæšä¸¾$a_i$â€‹ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³çš„ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯$\frac{sum_i}{i-1}+1$ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a[N];</span><br><span class="line">ll sum[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; a[i];</span><br><span class="line">  <span class="built_in">sort</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) sum[i] = sum[i<span class="number">-1</span>] + a[i];</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  ll p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">1ll</span>*i*a[i]-sum[i]&gt;a[i]) <span class="keyword">break</span>;</span><br><span class="line">    p = i;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; sum[p]/(p<span class="number">-1</span>)+<span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> kase=<span class="number">1</span>; kase&lt;=_; kase++) <span class="built_in">solve</span>(kase);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="K-Knowledge-is-Power"><a class="header-anchor" href="#K-Knowledge-is-Power">Â¶</a>K Knowledge is Power</h2><p>ç»™å®šæ•°xï¼Œè¦æ±‚å°†å…¶åˆ†è§£æˆè‹¥å¹²å¤§äº1çš„æ•°ï¼Œè¦æ±‚æ»¡è¶³ä¸¤ä¸¤äº’è´¨ä¸”å’Œä¸ºxã€‚æœ€å°åŒ–è¿™äº›æ•°çš„æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®å€¼ã€‚<br>$5 \leq x \leq 10^9$</p><h3 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h3><p>xä¸ºå¥‡æ•°ï¼Œæ˜¾ç„¶$2\frac{x-1}{2}, \frac{x+1}{2}$â€‹æœ€ä¼˜ï¼Œä¸º1<br>è€ƒè™‘xä¸ºå¶æ•°ï¼š<br>x=6æ— è§£<br>x=8ï¼Œåˆ†æˆ3å’Œ5å³å¯ï¼ˆæˆ‘ä¸€å¼€å§‹è¯¯åˆ¤æˆæ— è§£ï¼‰<br>é€šè¿‡æ‰“è¡¨å¾—åˆ°ç­”æ¡ˆåªå¯èƒ½æ˜¯2ï¼Œ3ï¼Œ4<br>xæ˜¯3çš„å€æ•°ï¼Œæ˜¾ç„¶å¯ä»¥åˆ†æˆy, y+1, y+2çš„å½¢å¼ï¼Œåˆç”±äºyä¸€å®šæ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥åˆæ³•ï¼Œç­”æ¡ˆä¸º2<br>$x%3==1$ï¼Œå¦‚æœèƒ½åˆ†æˆäº’è´¨çš„y, y+1, y+3åˆ™ä¸º3ï¼Œå¦åˆ™ä¸º4<br>$x%3==2$ï¼Œå¦‚æœèƒ½åˆ†æˆäº’è´¨çš„y, y+2, y+3åˆ™ä¸º3ï¼Œå¦åˆ™ä¸º4</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x; cin &gt;&gt; x;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  <span class="keyword">if</span>(x==<span class="number">6</span>) cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(x&amp;<span class="number">1</span>) cout &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x%<span class="number">3</span>==<span class="number">0</span>) cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(__gcd(x/<span class="number">2</span><span class="number">-1</span>, x/<span class="number">2</span>+<span class="number">1</span>)==<span class="number">1</span>) cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">bool</span> ok = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span>(x%<span class="number">3</span>==<span class="number">2</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> a = (x<span class="number">-5</span>)/<span class="number">3</span>, b = a+<span class="number">2</span>, c = a+<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>(__gcd(a, b)==<span class="number">1</span> &amp;&amp; __gcd(a, c)==<span class="number">1</span> &amp;&amp; __gcd(b, c)==<span class="number">1</span>) ok = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(x%<span class="number">3</span>==<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> a = (x<span class="number">-4</span>)/<span class="number">3</span>, b = a+<span class="number">1</span>, c = a+<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span>( __gcd(a, b)==<span class="number">1</span> &amp;&amp; __gcd(a, c)==<span class="number">1</span> &amp;&amp; __gcd(b, c)==<span class="number">1</span>) ok = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(ok) cout &lt;&lt; <span class="number">3</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> cout &lt;&lt; <span class="number">4</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=_; k++) <span class="built_in">solve</span>(k);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="J-Joy-of-Handcraft"><a class="header-anchor" href="#J-Joy-of-Handcraft">Â¶</a>J Joy of Handcraft</h2><p>æœ‰nä¸ªç¯æ³¡ï¼Œåˆ†åˆ«æœ‰å‘¨æœŸ$t_i$â€‹ï¼Œæ¯ä¸¤ä¸ªå‘¨æœŸä¸­ï¼Œå‰ä¸€ä¸ªå‘¨æœŸäº®ï¼Œåä¸€ä¸ªå‘¨æœŸæš—ï¼Œæœ‰äº®åº¦$x_i$â€‹ã€‚<br>é—®1-mæ¯ä¸ªæ—¶é—´å†…çš„æœ€å¤§äº®åº¦<br>$n \leq 10^5, m \leq 10^5, t_i \leq 10^5, x_i \leq 10^5$</p><h3 id="åšæ³•-s3"><a class="header-anchor" href="#åšæ³•-s3">Â¶</a>åšæ³•</h3><p>å‘¨æœŸç›¸åŒçš„åªè¦å–äº®åº¦æœ€å¤§çš„é‚£ä¸ªï¼Œç„¶åæš´åŠ›æšä¸¾æ¯ç§å‘¨æœŸçš„ç¯æ³¡äº®çš„æ—¶é—´ï¼Œå¤æ‚åº¦æ˜¯$O(n\log n)$ï¼Œ<br>æ³¨æ„åˆ°å°†äº®åº¦æ’åºåï¼Œå°±æ˜¯ä¸ªåŒºé—´è¦†ç›–é—®é¢˜äº†ï¼Œçº¿æ®µæ ‘å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> cov[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cov[p&lt;&lt;<span class="number">1</span>] = cov[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = cov[p];</span><br><span class="line">  cov[p] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cover</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">  &#123;</span><br><span class="line">    cov[p] = v;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cov[p]) <span class="built_in">push</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">cover</span>(p&lt;&lt;<span class="number">1</span>, l, mid, x, y, v);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">cover</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r, x, y, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) &#123; cout &lt;&lt; cov[p] &lt;&lt; <span class="string">&quot; \n&quot;</span>[l==m]; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="keyword">if</span>(cov[p]) <span class="built_in">push</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">print</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">print</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">4</span>*m; i++) cov[i] = <span class="number">0</span>;</span><br><span class="line">  vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; <span class="built_in">lamb</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;it : lamb) cin &gt;&gt; it.first &gt;&gt; it.second;</span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(lamb), <span class="built_in">end</span>(lamb));</span><br><span class="line">  vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; tmp;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;(<span class="type">int</span>)lamb.<span class="built_in">size</span>(); )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = i + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(j&lt;(<span class="type">int</span>)lamb.<span class="built_in">size</span>() &amp;&amp; lamb[j].first==lamb[i].first) ++j;</span><br><span class="line">    tmp.<span class="built_in">push_back</span>(&#123;lamb[j<span class="number">-1</span>].second, lamb[j<span class="number">-1</span>].first&#125;);</span><br><span class="line">    i = j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(tmp), <span class="built_in">end</span>(tmp));</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : tmp)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=m; k+=<span class="number">2</span>*it.second) <span class="built_in">cover</span>(<span class="number">1</span>, <span class="number">1</span>, m, k, <span class="built_in">min</span>(m, k+it.second<span class="number">-1</span>), it.first);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  <span class="built_in">print</span>(<span class="number">1</span>, <span class="number">1</span>, m);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=_; k++) <span class="built_in">solve</span>(k);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="L-Lottery"><a class="header-anchor" href="#L-Lottery">Â¶</a>L Lottery</h2><p>æœ‰nç§çŸ³å¤´ï¼Œç¬¬iç§çŸ³å¤´ä½“ç§¯ä¸º$2^{a_i}$â€‹ï¼Œæ•°é‡ä¸º$x_i$â€‹ï¼Œé—®èƒ½æ‹¼æˆçš„ä½“ç§¯æ•°é‡ã€‚<br>$n \leq 10^5, a_i, x_i \leq 10^9$</p><h3 id="åšæ³•-s4"><a class="header-anchor" href="#åšæ³•-s4">Â¶</a>åšæ³•</h3><p>æŒ‰ç…§ä½“ç§¯ä»å°åˆ°å¤§è€ƒè™‘<br>è®¾å½“å‰æšä¸¾åˆ°ç¬¬iå—çŸ³å¤´ï¼Œå‰$i-1$å—çŸ³å¤´(å‰mxçš„ä½“ç§¯ä¸­)ä¸èƒ½æ‹¼æˆçš„ä½“ç§¯ä¸ºansï¼Œå‰$2^{a_{i-1}}$â€‹çš„ä½“ç§¯ä¸­æœ‰deltaä¸ªä¸èƒ½è¢«æ‹¼æˆï¼Œä¹‹å‰æ‰€æœ‰çŸ³å¤´èƒ½æ‹¼æˆçš„æœ€å¤§ä½“ç§¯ä¸º$mx$ã€‚<br>$mx\geq 2^{a_i}$â€‹ï¼š<br>é‚£ä¹ˆå¯¹äº$2^{a_{i-1}}$â€‹åˆ°$2^{a_i}$â€‹ä¹‹é—´ï¼Œæ¯$2^{a_{i-1}}$â€‹ä¸ªå°±æœ‰deltaä¸ªä½“ç§¯ä¸èƒ½è¢«æ‹¼æˆã€‚<br>å› æ­¤$\leq 2^{a_i}$â€‹çš„ä½“ç§¯ä¸­ä¸èƒ½æ‹¼æˆçš„ä½“ç§¯çš„æ•°é‡å°±æ˜¯$2^{a_i-a_{i-1}}\times delta$ï¼Œå‰iå—çŸ³å¤´ä¸èƒ½æ‹¼æˆçš„ä½“ç§¯å°±è¦å¢åŠ $delta\times x_i$â€‹ä¸ª<br>$mx\lt 2^{a_i}$â€‹ï¼š<br>é‚£ä¹ˆ$mx+1$åˆ°$2^{a_i}-1$ä¹‹é—´çš„ä½“ç§¯å°±æ— æ³•æ‹¼æˆ<br>å‰$2^{a_{i}}$â€‹çš„ä½“ç§¯ä¸­æœ‰$ans+2^{a_i}-mx-1$ä¸èƒ½è¢«æ‹¼æˆ<br>å‰iå—çŸ³å¤´ä¸èƒ½æ‹¼æˆçš„ä½“ç§¯å¢åŠ $delta\times x_i$â€‹ä¸ª</p><p>ç”±äºæœ‰å–æ¨¡æ“ä½œï¼Œä¸èƒ½ç›´æ¥åˆ¤æ–­$mx$å’Œ$2^{a_i}$â€‹çš„å¤§å°å…³ç³»ï¼Œç”¨ä¸€ä¸ªmapæ¥å­˜å‚¨mxçš„äºŒè¿›åˆ¶è¡¨ç¤ºå³å¯ï¼Œåªè¦mxçš„äºŒè¿›åˆ¶ä¸­æœ€é«˜ä½high$\geq a_i$â€‹ï¼Œå°±è¯´æ˜$mx \geq 2^{a_i}$â€‹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Pow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; p[i].fi &gt;&gt; p[i].se;</span><br><span class="line">  map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; bit;</span><br><span class="line">  <span class="built_in">sort</span>(p+<span class="number">1</span>, p+n+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> mx = <span class="number">0</span>, delta = <span class="number">0</span>, ans = <span class="number">0</span>, high = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="built_in">Pow</span>(<span class="number">2</span>, p[i].fi);</span><br><span class="line">    <span class="keyword">if</span>(high&gt;=p[i].fi)</span><br><span class="line">    &#123;</span><br><span class="line">      delta = <span class="number">1ll</span>*delta*<span class="built_in">Pow</span>(<span class="number">2</span>, p[i].fi-p[i<span class="number">-1</span>].fi)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      delta = ((cur-mx<span class="number">-1</span>+ans)%mod+mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (ans + <span class="number">1ll</span>*delta*p[i].se)%mod;</span><br><span class="line">    mx = (mx + <span class="number">1ll</span>*cur*p[i].se)%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="number">30</span>; j++)</span><br><span class="line">      <span class="keyword">if</span>((p[i].se&gt;&gt;j)&amp;<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> x = p[i].fi + j;</span><br><span class="line">        bit[x]++;</span><br><span class="line">        <span class="keyword">while</span>(bit[x]==<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          bit[x] = <span class="number">0</span>;</span><br><span class="line">          ++x;</span><br><span class="line">          bit[x]++;</span><br><span class="line">        &#125;</span><br><span class="line">        high = <span class="built_in">max</span>(high, x);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  cout &lt;&lt; ((mx - ans + <span class="number">1</span>)%mod+mod)%mod &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=_; k++) <span class="built_in">solve</span>(k);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="G-Game-of-Cards"><a class="header-anchor" href="#G-Game-of-Cards">Â¶</a>G Game of Cards</h2><p>æœ‰$c_0$â€‹ä¸ª0å·ç‰Œï¼Œ$c_1$â€‹ä¸ª1å·ç‰Œï¼Œ$c_2$â€‹ä¸ª2å·ç‰Œï¼Œ$c_3$â€‹ä¸ª3å·ç‰Œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰å–ä¸¤å¼ å’Œä¸è¶…è¿‡3çš„ç‰Œï¼Œç„¶åå°†è¿™ä¸¤å¼ ç‰Œæ¢æˆä¸€å¼ å®ƒä»¬çš„å’Œçš„å·çš„ç‰Œï¼Œä¸èƒ½æ“ä½œè€…è¾“ã€‚<br>$0\leq c_0,c_1,c_2, c_3\leq 10^9$</p><h3 id="åšæ³•-s5"><a class="header-anchor" href="#åšæ³•-s5">Â¶</a>åšæ³•</h3><p>ç®€å•åˆ†æä¸€ä¸‹ï¼š<br>3å·ç‰Œåªèƒ½å’Œ0å·ç‰Œç»„åˆï¼Œä¸”åªä¼šå¢åŠ ä¸ä¼šå‡å°‘ï¼Œå½±å“åˆ°å±€é¢çš„å°±æ˜¯3å·ç‰Œæœ‰è¿˜æ˜¯æ²¡æœ‰ã€‚<br>å¦‚æœæ“ä½œ0å·ç‰Œï¼Œæ¯æ¬¡å¿…ç„¶ä¼šå‡å°‘1ï¼Œæ‰€ä»¥0å·ç‰Œå½±å“å±€é¢çš„æ˜¯å®ƒçš„å¥‡å¶æ€§ã€‚<br>ç„¶ååªéœ€è¦å¯¹1å’Œ2çš„æ•°ç›®ä»¥åŠ3å·ç‰Œæ˜¯0è¿˜æ˜¯1ï¼Œ0å·ç‰Œæ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°æ‰“ä¸ªsgè¡¨å³å¯ã€‚<br>å‘ç°åªæœ‰0å·ç‰Œæ—¶ï¼Œéœ€è¦ç‰¹åˆ¤ã€‚<br>æ­¤å¤–3å·ç‰Œæ²¡æœ‰å½±å“ã€‚<br>0å·ç‰Œæœ‰å¶æ•°ä¸ªæ—¶ï¼Œ2å·ç‰Œä¸º0å’Œé0æ—¶ï¼Œ1å·ç‰Œæ¨¡3å„æœ‰ä¸€ä¸ªè§„å¾‹<br>0å·ç‰Œæœ‰å¥‡æ•°ä¸ªæ—¶ï¼Œ2å·ç‰Œä¸º0å’Œ1å’Œ&gt;1æ—¶ï¼Œ1å·ç‰Œæ¨¡3å„æœ‰ä¸€è§„å¾‹<br>if elseä¸€ä¸‹å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">win</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;Rabbit\n&quot;</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">lose</span><span class="params">()</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;Horse\n&quot;</span>; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> a, b, c, d;</span><br><span class="line">  cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; kase &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">  <span class="type">bool</span> ok = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(a%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!c)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">2</span>) ok = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">0</span>) ok = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!c)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">2</span>) ok = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(c==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">0</span>) ok = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(b%<span class="number">3</span>==<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">else</span> ok = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!b&amp;&amp;!c&amp;&amp;!d)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(a&lt;=<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(a&amp;<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> ok = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  ok ? <span class="built_in">win</span>() : <span class="built_in">lose</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=_; k++) <span class="built_in">solve</span>(k);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019ccpc ç§¦çš‡å²›A. Angle Beats</title>
      <link href="/2020/10/09/2019ccpc-qin-huang-dao-a-angle-beats/"/>
      <url>/2020/10/09/2019ccpc-qin-huang-dao-a-angle-beats/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šnä¸ªç‚¹ï¼Œæœ‰qæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å‡ºä¸€å®šç‚¹ï¼Œé—®ä»åŸæ¥çš„nä¸ªç‚¹ä¸­é€‰å‡ºä¸¤ä¸ªå’Œå½“å‰ç‚¹æ„æˆç›´è§’ä¸‰è§’å½¢çš„æ–¹æ¡ˆæ•°<br>$n\leq2000,q\leq2000$<br>æ€è·¯å¾ˆæ˜¾ç„¶ï¼Œç¬¬ä¸€ç§æ˜¯è¯¢é—®ç‚¹ä½œä¸ºç›´è§’é¡¶ç‚¹ï¼Œç¬¬äºŒç§æ˜¯è¯¢é—®ç‚¹ä¸æ˜¯ç›´è§’é¡¶ç‚¹ï¼Œåˆ†åˆ«ç»Ÿè®¡å³å¯<br>å¯¹äºç¬¬ä¸€ç§ï¼Œåªè¦è®°å½•æ‰€æœ‰ç‚¹å’Œè¯¢é—®ç‚¹çš„æ–œç‡ï¼Œç¬¬äºŒç§åªè¦é¢„å¤„ç†å‡ºåˆå§‹çš„æ¯ä¸ªç‚¹å’Œå…¶å®ƒç‚¹çš„æ–œç‡<br>å¦‚æœç”¨atan2ï¼Œç²¾åº¦ä¼šç‚¸ï¼Œè¿™é‡Œç”¨åˆ†æ•°çš„å½¢å¼æ¥è¡¨ç¤ºï¼Œå¦‚æœæ–œç‡ä¸º$\dfrac{y}{x}$â€‹,é‚£å°±è¦æŸ¥æ‰¾$\dfrac{-x}{y}$çš„ä¸ªæ•°ï¼Œæå‰å°†æ–œç‡é¢„å¤„ç†å¥½å¹¶æ’åºï¼Œç„¶åæŸ¥è¯¢åªè¦upper_bound - lower_boundå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="type">double</span>;</span><br><span class="line"><span class="type">const</span> db eps = <span class="number">1e-15</span>, pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Frac</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> a, b;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> !b ? a : <span class="built_in">gcd</span>(b, a%b); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (x&gt;<span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>); &#125;</span><br><span class="line">  <span class="built_in">Frac</span>() : <span class="built_in">a</span>(<span class="number">0</span>), <span class="built_in">b</span>(<span class="number">1</span>) &#123;&#125;</span><br><span class="line">  <span class="built_in">Frac</span>(<span class="type">int</span> x) : <span class="built_in">a</span>(x), <span class="built_in">b</span>(<span class="number">1</span>) &#123;&#125;</span><br><span class="line">  <span class="built_in">Frac</span>(<span class="type">int</span> x, <span class="type">int</span> y) &#123; a = x, b = y; <span class="built_in">norm</span>(); &#125;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Frac f) <span class="type">const</span> &#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*f.b &lt; <span class="number">1ll</span>*b*f.a; &#125;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> == (Frac f) &#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*f.b == <span class="number">1ll</span>*b*f.a; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">norm</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> g = <span class="built_in">gcd</span>(<span class="built_in">abs</span>(a), <span class="built_in">abs</span>(b));</span><br><span class="line">    a = a/g*<span class="built_in">sgn</span>(b);</span><br><span class="line">    <span class="keyword">if</span>(!a) b = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!b) a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> b = <span class="built_in">abs</span>(b/g);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> (x&lt;-eps ? <span class="number">-1</span> : x&gt;eps); &#125;</span><br><span class="line"><span class="type">int</span> n, q;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">P</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x, y;</span><br><span class="line">&#125;p[N];</span><br><span class="line">Frac seq[N][N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">1</span>; x&lt;=n; x++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(i&lt;x) seq[x][i] = <span class="built_in">Frac</span>(p[i].y-p[x].y, p[i].x-p[x].x);</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(i&gt;x) seq[x][i<span class="number">-1</span>] = <span class="built_in">Frac</span>(p[i].y-p[x].y, p[i].x-p[x].x);</span><br><span class="line">    <span class="built_in">sort</span>(seq[x]+<span class="number">1</span>, seq[x]+n);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; p[i].x &gt;&gt; p[i].y;</span><br><span class="line">  <span class="built_in">pre</span>();</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; p[<span class="number">0</span>].x &gt;&gt; p[<span class="number">0</span>].y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) seq[<span class="number">0</span>][i] = <span class="built_in">Frac</span>(p[i].y-p[<span class="number">0</span>].y, p[i].x-p[<span class="number">0</span>].x);</span><br><span class="line">    <span class="built_in">sort</span>(seq[<span class="number">0</span>]+<span class="number">1</span>, seq[<span class="number">0</span>]+n+<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, ans2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="function">Frac <span class="title">k</span><span class="params">(-p[<span class="number">0</span>].x+p[i].x, p[<span class="number">0</span>].y-p[i].y)</span></span>;</span><br><span class="line">      ans += <span class="built_in">upper_bound</span>(seq[i]+<span class="number">1</span>, seq[i]+n, k) - <span class="built_in">lower_bound</span>(seq[i]+<span class="number">1</span>, seq[i]+n, k);</span><br><span class="line">      ans2 += <span class="built_in">upper_bound</span>(seq[<span class="number">0</span>]+<span class="number">1</span>, seq[<span class="number">0</span>]+n+<span class="number">1</span>, k) - <span class="built_in">lower_bound</span>(seq[<span class="number">0</span>]+<span class="number">1</span>, seq[<span class="number">0</span>]+n+<span class="number">1</span>, k);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans + ans2/<span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="keyword">while</span>(cin &gt;&gt; n &gt;&gt; q) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cf487E tourists æ ‘å‰–+çº¿æ®µæ ‘ç»´æŠ¤åœ†æ–¹æ ‘</title>
      <link href="/2020/10/09/cf487e-tourists-shu-pou-xian-duan-shu-wei-hu-yuan-fang-shu/"/>
      <url>/2020/10/09/cf487e-tourists-shu-pou-xian-duan-shu-wei-hu-yuan-fang-shu/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šæ— å‘å›¾ï¼Œæ¯ä¸ªç‚¹æœ‰ç‚¹æƒï¼Œå¤šæ¬¡è¯¢é—®ä¸¤ç‚¹é—´æ‰€æœ‰ç®€å•è·¯å¾„ä¸Šçš„ç‚¹æƒçš„æœ€å°å€¼ï¼Œå¹¶è¦æ±‚æ”¯æŒä¿®æ”¹ç‚¹æƒ</p><p>è€ƒè™‘å»ºå‡ºåœ†æ–¹æ ‘ï¼Œå°†æ–¹ç‚¹çš„ç‚¹æƒç½®ä¸ºæ‰€æœ‰ç›¸é‚»åœ†ç‚¹çš„ç‚¹æƒçš„æœ€å°å€¼ï¼Œé‚£ç­”æ¡ˆå°±æ˜¯ä¸¤ä¸ªç‚¹åœ¨åœ†æ–¹æ ‘ä¸Šçš„è·¯å¾„ä¸Šçš„ç‚¹æƒæœ€å°å€¼ã€‚ä½†æ˜¯å¦‚æœä¸€ä¸ªåœ†ç‚¹å’Œå¤šä¸ªæ–¹ç‚¹ç›¸é‚»ï¼Œåœ¨ä¿®æ”¹çš„æ—¶å€™å¤æ‚åº¦å°±ç‚¸äº†ã€‚<br>æ­¤æ—¶çš„trickæ˜¯è®©1ä¸ºæ ¹ï¼Œæ–¹ç‚¹ç»´æŠ¤æ‰€æœ‰å„¿å­çš„åœ†ç‚¹çš„æƒå€¼æœ€å°å€¼ï¼Œè¿™æ ·åœ¨ä¿®æ”¹æ—¶åœ†ç‚¹åªéœ€è¦å•ç‚¹ä¿®æ”¹å…¶çˆ¶äº²å³å¯ï¼Œè€Œåœ¨æŸ¥è¯¢æ—¶ï¼Œå¦‚æœlcaæ˜¯ä¸€ä¸ªæ–¹ç‚¹ï¼Œå†ç»Ÿè®¡ä¸€ä¸‹æ–¹ç‚¹çš„çˆ¶äº²è¿™ä¸ªåœ†ç‚¹çš„ç­”æ¡ˆå³å¯ã€‚<br>æ ‘å‰–ï¼Œçº¿æ®µæ ‘æ”¯æŒå•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢æœ€å°å€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m, q;</span><br><span class="line"><span class="type">int</span> low[N], dfn[N], stk[N], clk, top, cnt;</span><br><span class="line"><span class="type">int</span> val[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N], T[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  low[u] = dfn[u] = ++clk;</span><br><span class="line">  stk[++top] = u;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">tarjan</span>(v, u);</span><br><span class="line">      low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">      <span class="keyword">if</span>(low[v]&gt;=dfn[u])</span><br><span class="line">      &#123;</span><br><span class="line">        ++cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">0</span>; x!=v; top--)</span><br><span class="line">        &#123;</span><br><span class="line">          x = stk[top];</span><br><span class="line">          T[cnt].<span class="built_in">push_back</span>(x);</span><br><span class="line">          T[x].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">        &#125;</span><br><span class="line">        T[cnt].<span class="built_in">push_back</span>(u);</span><br><span class="line">        T[u].<span class="built_in">push_back</span>(cnt);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(v!=fa) low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = N&lt;&lt;<span class="number">1</span>;</span><br><span class="line">multiset&lt;<span class="type">int</span>&gt; mst[M];</span><br><span class="line"><span class="keyword">namespace</span> HLD</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> sz[M], top[M], son[M], dep[M], fa[M], dfn[M], idfn[M], tot;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    dep[u] = dep[f] + <span class="number">1</span>; fa[u] = f;</span><br><span class="line">    sz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(u&lt;=n) mst[u].<span class="built_in">insert</span>(val[u]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : T[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(v!=f)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span>(u&gt;n) mst[u].<span class="built_in">insert</span>(val[v]);</span><br><span class="line">        <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">        sz[u] += sz[v];</span><br><span class="line">        <span class="keyword">if</span>(sz[v]&gt;sz[son[u]]) son[u] = v;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    top[u] = t;</span><br><span class="line">    dfn[u] = ++tot;</span><br><span class="line">    idfn[tot] = u;</span><br><span class="line">    <span class="keyword">if</span>(!son[u]) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(son[u], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : T[u])</span><br><span class="line">      <span class="keyword">if</span>(v!=son[u]&amp;&amp;v!=fa[u]) <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> HLD::fa;</span><br><span class="line"><span class="keyword">using</span> HLD::idfn;</span><br><span class="line"><span class="keyword">using</span> HLD::dep;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, mn;</span><br><span class="line">&#125;t[M&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pull</span><span class="params">(<span class="type">int</span> p)</span> </span>&#123; t[p].mn = <span class="built_in">min</span>(t[p&lt;&lt;<span class="number">1</span>].mn, t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].mn); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].l = l, t[p].r = r;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn = *mst[idfn[l]].<span class="built_in">begin</span>();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">pull</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn = y;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>, x, y);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y);</span><br><span class="line">  <span class="built_in">pull</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> t[p].mn;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, ans = inf;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">askt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = inf;</span><br><span class="line">  <span class="keyword">while</span>(HLD::top[x]!=HLD::top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[HLD::top[x]]&lt;dep[HLD::top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(<span class="number">1</span>, HLD::dfn[HLD::top[x]], HLD::dfn[x]));</span><br><span class="line">    x = fa[HLD::top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(<span class="number">1</span>, HLD::dfn[x], HLD::dfn[y]));</span><br><span class="line">  <span class="keyword">if</span>(x&gt;n) ans = <span class="built_in">min</span>(ans, val[fa[x]]);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; val[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">    G[u].<span class="built_in">push_back</span>(v); G[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">  &#125;</span><br><span class="line">  cnt = n; <span class="built_in">tarjan</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  HLD::<span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>), HLD::<span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>*n);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">char</span> op; <span class="type">int</span> x, y;</span><br><span class="line">    cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(fa[x])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> pre = *mst[fa[x]].<span class="built_in">begin</span>();</span><br><span class="line">        mst[fa[x]].<span class="built_in">erase</span>(mst[fa[x]].<span class="built_in">find</span>(val[x]));</span><br><span class="line">        mst[fa[x]].<span class="built_in">insert</span>(y);</span><br><span class="line">        <span class="type">int</span> cur = *mst[fa[x]].<span class="built_in">begin</span>();</span><br><span class="line">        <span class="keyword">if</span>(pre!=cur) <span class="built_in">upd</span>(<span class="number">1</span>, HLD::dfn[fa[x]], cur);</span><br><span class="line">      &#125;</span><br><span class="line">      val[x] = y;</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, HLD::dfn[x], y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="built_in">askt</span>(x, y) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Capture Stars åœ†çš„åæ¼”</title>
      <link href="/2020/10/08/capture-stars-yuan-de-fan-yan/"/>
      <url>/2020/10/08/capture-stars-yuan-de-fan-yan/</url>
      
        <content type="html"><![CDATA[<p><a href="https://ac.nowcoder.com/acm/contest/7830/D">https://ac.nowcoder.com/acm/contest/7830/D</a><br>æœ‰ä¸€ä¸ªå¤§åœ†å’Œä¸€ä¸ªå°åœ†ï¼Œä¸¤è€…å†…åˆ‡äºåŸç‚¹ï¼Œç„¶åå†å¤§åœ†å†…å°åœ†å¤–æœ‰è‹¥å¹²ä¸ªç‚¹ï¼Œç°åœ¨è®©ä½ æ‰¾ä¸€ä¸ªåœ†ä½¿å…¶å’Œå°åœ†å¤–åˆ‡ï¼Œå¤§åœ†å†…åˆ‡ï¼Œå¹¶ä¸”æœ€å¤§åŒ–è¯¥åœ†è¦†ç›–çš„ç‚¹æ•°<br>è¿™ç§å¤šä¸ªåœ†æœ‰ç›¸åˆ‡å…³ç³»çš„é¢˜ï¼Œè€ƒè™‘åœ†çš„åæ¼”<br>åæ¼”ï¼šä¸€ä¸ªåæ¼”ç‚¹Oï¼Œä¸€ä¸ªåæ¼”åŠå¾„Rï¼Œåœ¨Oçš„åŒä¾§æœ‰ä¸¤ä¸ªç‚¹På’ŒPâ€™ï¼Œè‹¥æ»¡è¶³|OP||OPâ€™|=R*Rï¼Œåˆ™På’ŒPâ€™äº’ä¸ºåæ¼”ç‚¹<br>ä¸ç»è¿‡åæ¼”ç‚¹çš„åœ†çš„åæ¼”ä»ç„¶æ˜¯ä¸€ä¸ªåœ†<br>ç»è¿‡åæ¼”ç‚¹çš„åœ†çš„åæ¼”æ˜¯ä¸€æ¡ç›´çº¿<br>ç‚¹åæ¼”è¿˜æ˜¯ç‚¹</p><p>å†è€ƒè™‘æœ¬é¢˜ï¼Œä»¥å°åœ†å’Œå¤§åœ†çš„å†…åˆ‡ç‚¹å³åŸç‚¹ä¸ºåæ¼”ç‚¹ï¼Œåæ¼”åŠå¾„ä»»æ„ï¼Œè¿™æ ·å°±å˜æˆäº†ä¸¤æ¡ç›´çº¿ï¼Œè€Œè¦æ‰¾çš„åœ†åœ¨åæ¼”åå°±æ˜¯ç›¸åˆ‡äºè¿™ä¸¤æ¡ç›´çº¿çš„åœ†ï¼Œç‚¹åæ¼”åä»ä¸ºç‚¹<br>å¯¹äºæ¯ä¸ªç‚¹ï¼Œä»…å½“åœ†å¿ƒçš„çºµåæ ‡å¤„äºä¸€ä¸ªåŒºé—´å†…æ‰èƒ½è¦†ç›–ï¼Œå…¨éƒ¨æ±‚å‡ºåå·®åˆ†å‰ç¼€å’Œå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="type">double</span>;</span><br><span class="line"><span class="keyword">using</span> pdi = pair&lt;db, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> db eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> (x&lt;-eps ? <span class="number">-1</span> : x&gt;eps); &#125;</span><br><span class="line"><span class="function">db <span class="title">sqr</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> x*x; &#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">db R, r, invr;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">P</span></span><br><span class="line">&#123;</span><br><span class="line">  db x, y;</span><br><span class="line">  <span class="built_in">P</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">P</span>(db _x, db _y) : <span class="built_in">x</span>(_x), <span class="built_in">y</span>(_y) &#123;&#125;</span><br><span class="line">  P <span class="keyword">operator</span> * (<span class="type">const</span> db k) &#123; <span class="keyword">return</span> <span class="built_in">P</span>(k*x, k*y); &#125;</span><br><span class="line">&#125;p[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; R &gt;&gt; r;</span><br><span class="line">  invr = <span class="number">2</span>*R;</span><br><span class="line">  db xl = <span class="number">0.5</span>*<span class="built_in">sqr</span>(invr)/R, xr = <span class="number">0.5</span>*<span class="built_in">sqr</span>(invr)/r;</span><br><span class="line">  db O = (xl+xr)/<span class="number">2</span>, Or = (xr-xl)/<span class="number">2</span>;</span><br><span class="line">  vector&lt;pdi&gt; seg;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; p[i].x &gt;&gt; p[i].y;</span><br><span class="line">    db d = <span class="built_in">sqrt</span>(<span class="built_in">sqr</span>(p[i].x) + <span class="built_in">sqr</span>(p[i].y));</span><br><span class="line">    db dd = <span class="built_in">sqr</span>(invr)/d;</span><br><span class="line">    p[i] = p[i]*(dd/d);</span><br><span class="line">    db t = <span class="built_in">fabs</span>(O-p[i].x);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sgn</span>(Or-t)&lt;<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    db delta = <span class="built_in">sqrt</span>(<span class="built_in">sqr</span>(Or)-<span class="built_in">sqr</span>(t));</span><br><span class="line">    seg.<span class="built_in">push_back</span>(&#123;p[i].y-delta, <span class="number">1</span>&#125;);</span><br><span class="line">    seg.<span class="built_in">push_back</span>(&#123;p[i].y+delta+eps, <span class="number">-1</span>&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(seg), <span class="built_in">end</span>(seg));</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>, cur = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : seg)</span><br><span class="line">  &#123;</span><br><span class="line">    cur += it.second;</span><br><span class="line">    <span class="keyword">if</span>(cur&gt;ans) ans = cur;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Naomi with Graph æœ€å°å‰²</title>
      <link href="/2020/10/08/naomi-with-graph-zui-xiao-ge/"/>
      <url>/2020/10/08/naomi-with-graph-zui-xiao-ge/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€å¼ nä¸ªç‚¹mæ¡è¾¹çš„æ— å‘å›¾ï¼Œæ¯ä¸ªç‚¹æœ‰æƒå€¼$a_i$â€‹ï¼Œç°åœ¨å¯ä»¥ä»»æ„åŠ è¾¹ï¼Œè¦æ±‚æœ€å°åŒ–$\sum_{i=1}^n(a_i-<br>dist_i)^2$ï¼Œå…¶ä¸­$dist_i$â€‹è¡¨ç¤º1åˆ°iç‚¹çš„æœ€çŸ­è·¯<br>$n \leq 40,m \leq 1600$</p><p>ä»»æ„åŠ è¾¹å¹¶ä¸ä»£è¡¨æ¯ä¸ªç‚¹çš„çš„$dist_i$â€‹éƒ½å¯ä»¥ä»»æ„ï¼Œä»ç„¶è¦æ»¡è¶³ä¸€ä¸‹æ¡ä»¶<br>$dist_1 = 0$<br>$dist_i \not = 0, i \not= 1$<br>$|dist_i-dist_j| \leq 1,(i,j) \in E$</p><p>è€ƒè™‘å¯¹æ¯ä¸ªç‚¹æ‹†æˆn-1ä¸ªç‚¹ï¼ŒSå’Œç¬¬ä¸€ä¸ªç‚¹ç›¸è¿ï¼Œç¬¬iä¸ªç‚¹å’Œç¬¬i+1ä¸ªç‚¹ç›¸è¿ï¼Œç¬¬n-1ä¸ªç‚¹å’ŒTç›¸è¿ï¼Œè¾¹æƒå³ä¸º$(a_i-j)^2$ï¼Œç”±äº$dist_1=0$ï¼Œæ‰€ä»¥ç›´æ¥è®©1æ‹†å‡ºçš„ç¬¬ä¸€ä¸ªç‚¹å’ŒSä¸è¿è¾¹ï¼Œæœ€åå†åŠ ä¸Š$a_i^2$â€‹çš„è´¡çŒ®ã€‚å†è€ƒè™‘ç¬¬ä¸‰ä¸ªé™åˆ¶ï¼Œå¦‚æœiå’Œjæœ‰è¾¹ï¼Œå°±è®©iæ‹†å‡ºçš„ç¬¬xä¸ªç‚¹å‘jæ‹†å‡ºçš„ç¬¬x-1ä¸ªç‚¹è¿è¾¹ï¼ŒjåŒç†ã€‚è¿™æ ·å¦‚æœå‰²æ‰iç‚¹æ‹†å‡ºçš„xå’Œx+1ä¹‹é—´çš„è¾¹ï¼Œå°±è¡¨ç¤º$dist_i=x$ï¼Œå¹¶ä¸”æ­¤æ—¶å¯¹äºå’Œiæœ‰è¾¹çš„jï¼Œå¿…é¡»å‰²æ‰x-1å’Œxæˆ–è€…xå’Œx+1æˆ–è€…x+1å’Œx+2è¿™ä¸‰æ¡è¾¹ä¹‹ä¸€ã€‚æ‰€ä»¥è¿™æ ·å»ºå›¾å†è·‘æœ€å°å‰²å³å¯ã€‚<br><img src="/post-images/1602154040898.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å°åœ†è¦†ç›–è‡³å°‘xä¸ªç‚¹</title>
      <link href="/2020/10/06/zui-xiao-yuan-fu-gai-zhi-shao-x-ge-dian/"/>
      <url>/2020/10/06/zui-xiao-yuan-fu-gai-zhi-shao-x-ge-dian/</url>
      
        <content type="html"><![CDATA[<p>å…ˆè€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œå¹³é¢ä¸Šæœ‰nä¸ªç‚¹ï¼Œé—®ç”¨ä¸€ä¸ªå•ä½åœ†æœ€å¤šèƒ½è¦†ç›–å‡ ä¸ªç‚¹<br>å¯ä»¥è½¬åŒ–æˆå°†æ‰€æœ‰ç‚¹å˜æˆä»¥è¯¥ç‚¹ä¸ºåœ†å¿ƒçš„å•ä½åœ†ï¼Œè¢«åœ†è¦†ç›–æœ€å¤šæ¬¡çš„ç‚¹å°±æ˜¯ç­”æ¡ˆ<br>è€ƒè™‘æšä¸¾ä¸€ä¸ªåœ†ï¼Œå…¶ä½™åœ†å’Œè¯¥åœ†å¦‚æœæœ‰äº¤ï¼Œå°±æ˜¯è¯¥åœ†ä¸Šçš„ä¸€æ®µåœ†å¼§ï¼Œæ±‚å‡ºæè§’åå°±å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªåŒºé—´è¦†ç›–æœ€å¤šæ¬¡çš„é—®é¢˜ï¼Œå·®åˆ†+å‰ç¼€å’Œå³å¯ã€‚<br>è¯¥é¢˜å¯ä»¥äºŒåˆ†æœ€å°åœ†çš„åŠå¾„ï¼Œç„¶åç”¨ä»¥ä¸Šæ–¹æ³•æ¥checkå³å¯<br><a href="https://www.zhihu.com/question/266750532/answer/312982493">https://www.zhihu.com/question/266750532/answer/312982493</a></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="type">double</span>;</span><br><span class="line"><span class="keyword">using</span> pdi = pair&lt;db, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> db eps = <span class="number">1e-8</span>, pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> (x&lt;-eps ? <span class="number">-1</span> : x&gt;eps); &#125;</span><br><span class="line"><span class="function">db <span class="title">sqr</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> x*x; &#125;</span><br><span class="line"><span class="type">int</span> n, s;</span><br><span class="line">db R;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">P</span></span><br><span class="line">&#123;</span><br><span class="line">  db x, y;</span><br><span class="line">  <span class="built_in">P</span>() &#123;&#125;</span><br><span class="line">  <span class="function">db <span class="title">dis</span><span class="params">(P p)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(<span class="built_in">sqr</span>(x-p.x) + <span class="built_in">sqr</span>(y-p.y)); &#125;</span><br><span class="line">&#125;p[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">norm</span><span class="params">(db&amp; theta)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">sgn</span>(theta)&lt;<span class="number">0</span>) theta += <span class="number">2</span>*pi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(db r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    vector&lt;pdi&gt; pre;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      db d = p[i].<span class="built_in">dis</span>(p[j]);</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">sgn</span>(d)==<span class="number">0</span>) &#123; ++cnt; <span class="keyword">continue</span>; &#125;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">sgn</span>(d<span class="number">-2</span>*r)&gt;=<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">      db p1 = <span class="built_in">atan2</span>(p[j].y-p[i].y, p[j].x-p[i].x);</span><br><span class="line">      db p2 = <span class="built_in">acos</span>(<span class="number">0.5</span>*d/r);</span><br><span class="line">      db l = p1 - p2, r = p1 + p2;</span><br><span class="line">      <span class="built_in">norm</span>(l), <span class="built_in">norm</span>(r);</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">sgn</span>(r-l)&gt;=<span class="number">0</span>) pre.<span class="built_in">push_back</span>(&#123;l, <span class="number">1</span>&#125;), pre.<span class="built_in">push_back</span>(&#123;r+eps, <span class="number">-1</span>&#125;);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        pre.<span class="built_in">push_back</span>(&#123;<span class="number">0</span>, <span class="number">1</span>&#125;), pre.<span class="built_in">push_back</span>(&#123;r+eps, <span class="number">-1</span>&#125;);</span><br><span class="line">        pre.<span class="built_in">push_back</span>(&#123;l, <span class="number">1</span>&#125;), pre.<span class="built_in">push_back</span>(&#123;<span class="number">2</span>*pi+eps, <span class="number">-1</span>&#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mx = cnt, cur = cnt;</span><br><span class="line">    <span class="built_in">sort</span>(<span class="built_in">begin</span>(pre), <span class="built_in">end</span>(pre));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;(<span class="type">int</span>)pre.<span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">      cur += pre[i].se;</span><br><span class="line">      <span class="keyword">if</span>(cur&gt;mx) mx = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(mx&gt;=s) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  db l = <span class="number">0.0</span>, r = <span class="number">0.0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      r = <span class="built_in">max</span>(r, p[i].<span class="built_in">dis</span>(p[j]));</span><br><span class="line">  db ans = <span class="number">0.0</span>;</span><br><span class="line">  <span class="keyword">while</span>(r-l&gt;eps)</span><br><span class="line">  &#123;</span><br><span class="line">    db mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">check</span>(mid)) r = mid, ans = mid;</span><br><span class="line">    <span class="keyword">else</span> l = mid;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans + R;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; s;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; p[i].x &gt;&gt; p[i].y;</span><br><span class="line">  cin &gt;&gt; R;</span><br><span class="line">  <span class="keyword">if</span>(s&gt;n) cout &lt;&lt; <span class="string">&quot;The cake is a lie.\n&quot;</span>;</span><br><span class="line">  <span class="keyword">else</span> cout &lt;&lt; <span class="built_in">work</span>() &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>), cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cout &lt;&lt; fixed &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">4</span>);</span><br><span class="line">  <span class="type">int</span> _; cin &gt;&gt; _;</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ç‰›å®¢å›½åº†é›†è®­æ´¾å¯¹day1</title>
      <link href="/2020/10/01/2020-niu-ke-guo-qing-ji-xun-pai-dui-day1/"/>
      <url>/2020/10/01/2020-niu-ke-guo-qing-ji-xun-pai-dui-day1/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®éƒ½ä¸éš¾ï¼Œè²Œä¼¼æ˜¯å»å¹´æ¬§æ´²åŒºåŸŸèµ›é¢˜</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„å­—ç¬¦ä¸²ï¼Œé—®ä½ æœ€å°‘åœ¨ <strong>åé¢</strong> æ·»åŠ å¤šå°‘ä¸ªå­—ç¬¦ï¼Œä½¿å…¶å˜æˆå›æ–‡ä¸²<br>$n \leq 4 \times10^5$<br>æ³¨æ„æ˜¯åªèƒ½åŠ åœ¨åé¢ï¼Œæ‰€ä»¥é©¬æ‹‰è½¦ä¸€ä¸‹å°±è¡Œï¼Œæ‰¾ä¸€ä¸ªæœ€é•¿çš„å›æ–‡åç¼€ï¼Œç„¶åè¡¥é½å‰ç¼€å³å¯<br>ï¼ˆå¦‚æœæ˜¯ä»»æ„æ·»åŠ ï¼Œé‚£ç­”æ¡ˆå°±æ˜¯æ­£ä¸²å’Œåä¸²çš„LCSï¼Œåªèƒ½$n^2$</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„aï¼Œå®šä¹‰$g(i, j) =<br>gcd(a_i,\dots,a_j),m(i,j) =<br>max(a_i,\dots,a_j)$ï¼Œæ±‚$\sum_{i=1}^n\sum_{j=i}^n<br>g(i,j)m(i,j)$<br>$n \leq 2\times10^5$<br>å¾ˆå¥—è·¯çš„é¢˜ï¼Œgcdå¯ä»¥åˆ†æˆä¸åŒçš„logæ®µ<br>æšä¸¾å³ç«¯ç‚¹ï¼Œåˆ©ç”¨å•è°ƒæ ˆå’Œçº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤åç¼€æœ€å€¼ï¼Œç„¶åäºŒåˆ†gcdä¸åŒçš„æ®µçš„å·¦ç«¯ç‚¹å³å¯<br>ä¸€ç§æ›´å¥½çš„å†™æ³•æ˜¯åˆ©ç”¨è·¯å¾„å‹ç¼©ï¼Œå¯ä»¥å»æ‰ä¸€ä¸ªlog<br>ä»¤$g_i$â€‹è¡¨ç¤ºiåˆ°å½“å‰å³ç«¯ç‚¹çš„gcdçš„å€¼ï¼Œ$nxt_i$â€‹è¡¨ç¤ºiå·¦è¾¹ç¬¬ä¸€ä¸ªgä¸$g_i$â€‹ä¸åŒçš„ç‚¹ï¼Œä¸æ–­è·³$nxt_i$â€‹ï¼Œå½“iå’Œ$nxt_i$â€‹çš„gcdç›¸åŒæ—¶ï¼Œå°±åˆå¹¶$nxt_i<br>= nxt_{nxt_i}$</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ç»™å®šä¸€æ£µæ ‘ï¼Œæ¯æ¬¡å¯ä»¥ä¿®æ”¹ä¸€ä¸ªç‚¹çš„çˆ¶äº²ï¼Œé—®æœ€å°‘å‡ æ¬¡æ“ä½œå˜æˆä¸€æ¡é“¾<br>ç­”æ¡ˆå°±æ˜¯æ‰€æœ‰å¤§äº2çš„ç‚¹çš„åº¦æ•°-2çš„å’Œ<br>å› ä¸ºåº¦æ•°$\leq 2$å¯ä»¥ä¸ç®¡ï¼Œ$&gt;2$ï¼Œå°±å¿…é¡»æŠŠå…¶å®ƒçš„ç‚¹æŒªèµ°</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>ç»™å®šnä¸ªç‚¹ï¼Œ1æ¡ç›´çº¿ï¼Œå‚æ•°r<br>è®©ä½ åœ¨è¿™æ¡ç›´çº¿ä¸Šé€‰æ‹©ä¸€ä¸ªç‚¹ä½œä¸ºåœ†å¿ƒï¼Œä½œä¸€ä¸ªåŠå¾„ä¸ºrçš„åœ†ï¼Œè¦†ç›–æœ€å¤šçš„ç‚¹ï¼Œæ±‚ç‚¹æ•°<br>$n \leq 3 \times 10^5$<br>è€ƒè™‘æ¯ä¸ªç‚¹èƒ½è¢«è¦†ç›–çš„éƒ½æ˜¯ç›´çº¿ä¸Šçš„ä¸€ä¸ªåŒºé—´ï¼Œæ±‚å‡ºåŒºé—´åï¼Œå°±ç›¸å½“äºç”¨ä¸€ä¸ªé•¿åº¦ä¸º$2r$çš„åŒºé—´è¦†ç›–æœ€å¤šçš„åŒºé—´ï¼Œå› ä¸ºåŒºé—´çš„é•¿åº¦éƒ½æ˜¯å°äº$2r$çš„ï¼Œæ‰€ä»¥ç¦»æ•£åŒ–ä¹‹åå·®åˆ†å‰ç¼€å’Œå–maxå³å¯<br>å¦ä¸€ç§åšæ³•æ˜¯å…ˆæŒ‰åŒºé—´çš„å·¦ç«¯ç‚¹å‡åºæ’åºï¼Œæšä¸¾ç¬¬iä¸ªåŒºé—´ä½œä¸ºæœ€åä¸€ä¸ªè¢«è¦†ç›–çš„åŒºé—´ï¼Œè´ªå¿ƒçš„è€ƒè™‘è‚¯å®šå°†åœ†å¿ƒæ”¾åœ¨è¯¥åŒºé—´çš„å·¦ç«¯ç‚¹ä¸Šï¼ˆå³å°½å¯èƒ½çš„é å·¦ï¼‰ï¼Œæ­¤æ—¶è¦†ç›–çš„ç‚¹çš„ä¸ªæ•°å°±æ˜¯å‰é¢æ‰€æœ‰å³ç«¯ç‚¹$\geq$è¯¥å·¦ç«¯ç‚¹çš„åŒºé—´ä¸ªæ•°ï¼Œpbdså³å¯</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>æ±‚$\sum\limits_{i=n}^m \sum\limits_{d\mid i} 1$<br>$n\leq m \leq 10^{12}$<br>è½¬æˆæšä¸¾å› æ•°dçš„è´¡çŒ®å°±æ˜¯ä¸€ä¸ªæ•´é™¤åˆ†å—äº†</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>æœ‰nä¸ªæ•°ï¼Œè®©ä½ æ‰¾kä¸ªä½¿å¾—å®ƒä»¬ç›¸ä¸çš„ç»“æœæœ€å¤§<br>ä»é«˜ä½å¾€ä½ä½è´ªå¿ƒå³å¯ï¼Œè¯¥ä½æœ‰è¶…è¿‡kä¸ª1å°±å–</p><h2 id="G"><a class="header-anchor" href="#G">Â¶</a>G</h2><p>ç»™å‡ºqä¸ªå­—ç¬¦ä¸²$s_i$â€‹ï¼Œè¯¢é—®é•¿åº¦nçš„å­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘ä¸²ä¸åŒ…å«è¿™qä¸ªå­—ç¬¦ä¸²<br>$\sum\limits_{i=1}^q |s_i| \leq 100$ï¼Œ$n\leq10^9$<br>åˆ°æœ€åæ‰æƒ³åˆ°acè‡ªåŠ¨æœºï¼Œä¸€å¼€å§‹ä¸€ç›´åœ¨æƒ³å®¹æ–¥<br>å¯¹è¿™qä¸ªä¸²å»ºå‡ºtrieå›¾ï¼Œç„¶åæ ‡è®°å‡ºä¸åˆæ³•çš„ä½ï¼ˆæ¯ä¸ªä¸²çš„æœ«ç«¯ï¼Œä»¥åŠæ¯ä¸ªä¸²å¯è¯†åˆ«çš„åç¼€ï¼‰<br>æ¥ä¸‹æ¥å°±è½¬æˆå›¾ä¸Šnæ­¥è·¯å¾„é—®é¢˜ï¼Œå¯¹é‚»æ¥çŸ©é˜µä½œå¿«é€Ÿå¹‚å³å¯</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>ç»™å‡ºä¸¤ä¸ªå­—ç¬¦ä¸²så’Œtï¼ŒåªåŒ…å«å­—ç¬¦AGCTï¼Œä¿è¯tå¯ç”±säº¤æ¢å­—ç¬¦å¾—åˆ°ï¼Œé—®æœ€å°‘çš„äº¤æ¢æ¬¡æ•°<br>è€ƒè™‘ç½®æ¢ï¼Œå¯¹äºä¸€ä¸ªé•¿åº¦ä¸ºxçš„å¾ªç¯ï¼Œéœ€è¦x-1æ¬¡äº¤æ¢ï¼Œæ‰€ä»¥åªè¦è´ªå¿ƒçš„æœ€å¤§åŒ–å¾ªç¯ä¸ªæ•°å³å¯ï¼Œå³æœ€å°åŒ–æ¯ä¸ªå¾ªç¯çš„é•¿åº¦ã€‚ç”±äºåªæœ‰è¿™å››ç§å­—ç¬¦ï¼Œæ‰€ä»¥åªæœ‰å¯èƒ½æ˜¯1234å…ƒç¯ï¼Œä»å°åˆ°å¤§æå°±è¡Œ</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>ç»™å‡ºä¸€å¼ æ— å‘å›¾ï¼Œå¤šæ¬¡è¯¢é—®åªè€ƒè™‘ç»™å®šçš„ä¸€ä¸ªå¤§å°ä¸ºsçš„ç‚¹é›†æ—¶è¿é€šå—çš„ä¸ªæ•°<br>è¯¢é—®çš„ç‚¹é›†å¤§å°å’Œä¸è¶…è¿‡$10^5$<br>ä¹Ÿå¾ˆå¥—è·¯ï¼Œè€ƒè™‘åº¦æ•°å°çš„ç‚¹ï¼Œç›´æ¥æš´åŠ›æšä¸¾æ‰€æœ‰å‡ºè¾¹ï¼Œå¦‚æœåœ¨å½“å‰ç‚¹é›†ä¸­å°±ç”¨å¹¶æŸ¥é›†åˆå¹¶<br>å†è€ƒè™‘åº¦æ•°å¤§çš„ç‚¹ï¼Œå¯¹äºåº¦æ•°å¤§çš„ç‚¹å’Œåº¦æ•°å°çš„ç‚¹çš„è¾¹ï¼Œæˆ‘ä»¬åœ¨åº¦æ•°å°çš„ç‚¹ä¸­å·²ç»æšä¸¾äº†ï¼Œæ‰€ä»¥åªè€ƒè™‘åº¦æ•°å¤§çš„ç‚¹å’Œåº¦æ•°å¤§çš„ç‚¹ä¹‹é—´çš„è¾¹ï¼Œè®¾ç½®é˜ˆå€¼$n\sqrt n$â€‹ï¼Œæ˜¾ç„¶è¿™æ ·çš„ç‚¹ä¸ªæ•°ä¸è¶…è¿‡$2\sqrt n$â€‹ï¼Œç›´æ¥é¢„å¤„ç†å‡ºè¿™äº›ç‚¹ä¹‹é—´æœ‰æ²¡æœ‰è¾¹ï¼ˆç”¨ä¸€ä¸ªäºŒç»´çŸ©é˜µå­˜å‚¨ï¼‰ï¼Œå†å¯¹äºç‚¹é›†å†…æ‰€æœ‰åº¦æ•°å¤§çš„ç‚¹å•ç‹¬åšä¸€æ¬¡äºŒç»´forå¾ªç¯åˆå¹¶å³å¯</p><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>ç»™å‡ºä¸€ä¸ªæ•°ç»„ï¼Œç„¶åè¯¢é—®æ˜¯å¦å­˜åœ¨ç›¸åº”çš„å¤§å°å…³ç³»çš„ä¸‰å…ƒç»„$(x_1, x_2, x_3)$<br>æ€»å…±æœ‰13ç§ï¼Œåˆ†åˆ«åšå³å¯</p><ul><li>ä¸‰ä¸ªç›¸ç­‰111ï¼Œçœ‹æœ‰æ²¡æœ‰ä¸€ä¸ªæ•°å‡ºç°3æ¬¡ä»¥ä¸Šï¼Œmapè®°å½•</li><li>$x_1=x_2$â€‹ï¼Œæšä¸¾$x_2$â€‹ï¼Œå¦‚æœå‰é¢æœ‰ç›¸ç­‰çš„$x_1$â€‹ï¼Œå°±çœ‹åé¢æœ‰æ²¡æœ‰å¤§äºå’Œå°äº$x_2$â€‹çš„ï¼Œ112ï¼Œ221</li><li>$x_2 = x_3$â€‹ï¼Œä¸Šä¸€ç§å€’ç€åšï¼Œ122ï¼Œ211</li><li>$x_1=x_3$â€‹ï¼Œå¯¹æ¯ç§æ•°ï¼Œå–æœ€å·¦å‡ºç°å’Œæœ€å³å‡ºç°çš„ï¼Œç„¶ååªè¦çœ‹ä¸¤è€…é—´çš„æœ€å¤§å€¼å’Œæœ€å°å€¼å’Œè¿™ä¸ªæ•°çš„å…³ç³»ï¼Œ121ï¼Œ212</li><li>$x_1&lt;x_2&lt;x_3$â€‹ï¼Œæšä¸¾ä¸­é—´æ•°ï¼Œ123</li><li>$x_1&gt;x_2&gt;x_3$â€‹ï¼ŒåŒç†ï¼Œ321</li><li>$x_1&lt;x_2&gt;x_3$â€‹ï¼Œæšä¸¾ä¸­é—´æ•°ï¼Œç„¶åçœ‹å·¦å³ä¸¤ä¾§å°äº$x_2$â€‹çš„æœ€å¤§çš„å’Œæœ€å°çš„æ•°çš„å¤§å°å…³ç³»ï¼Œ132ï¼Œ231</li><li>$x_1&gt;x_2&lt;x_3$â€‹ï¼ŒåŒç†ï¼Œ213ï¼Œ312</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ACL Beginner Contest F - Heights and Pairs</title>
      <link href="/2020/09/29/acl-beginner-contest-f-heights-and-pairs/"/>
      <url>/2020/09/29/acl-beginner-contest-f-heights-and-pairs/</url>
      
        <content type="html"><![CDATA[<p>æœ‰2nä¸ªäººï¼Œèº«é«˜åˆ†åˆ«ä¸º$h_i$â€‹ï¼Œæ±‚å°†ä»–ä»¬ä¸¤ä¸¤é…å¯¹ï¼Œä¸”æ¯å¯¹äººèº«é«˜å‡ä¸åŒçš„æ–¹æ¡ˆæ•°(mod 998244353)<br>$n\leq 5\times 10^4,h_i \leq 10^5$</p><p>è®¾æ°å¥½æœ‰iå¯¹äººèº«é«˜ä¸åŒçš„æ–¹æ¡ˆæ•°ä¸º$g_i$â€‹ï¼Œè‡³å°‘æœ‰iå¯¹äººèº«é«˜ä¸åŒçš„æ–¹æ¡ˆæ•°ä¸º$f_i$<br>æ°å¥½ä¸å¥½æ±‚ï¼Œå…ˆæ±‚è‡³å°‘<br>$f_i = \sum \limits_{j=i}^n \binom{j}{i}g_j$<br>åˆ©ç”¨äºŒé¡¹å¼åæ¼”<br>$g_i = \sum \limits_{j=i}^n(-1)^{j-i}\binom{j}{i}f_j$<br>ç­”æ¡ˆå³ä¸º$g_0$â€‹<br>å•ç‹¬è€ƒè™‘æ¯ç§èº«é«˜ï¼Œè‹¥èº«é«˜ä¸ºhçš„æœ‰xä¸ªäººï¼Œåˆ™å°†ä»–ä»¬é…æˆèº«é«˜ç›¸åŒçš„iç»„äººçš„æ–¹æ¡ˆæ•°æ˜¯$\dfrac{\sum\limits_{j=1}^i \binom{x-2*j+2}{2}}{i!}$<br>è¿™æ ·å¯¹æ¯ç§èº«é«˜å°±å¯ä»¥å†™å‡ºä¸€ä¸ªOGFï¼Œå…¨éƒ¨ä¹˜èµ·æ¥å$x^i$çš„ç³»æ•°å°±æ˜¯iç»„äººé…å¯¹çš„æ–¹æ¡ˆæ•°ï¼Œå†è€ƒè™‘å‰©ä½™çš„$2n-2i$ä¸ªäººï¼Œä»»æ„é…å¯¹çš„æ–¹æ¡ˆæ•°ä¸º$\dfrac{(2n-2i)!}{(n-i)!2^{(n-i)}}$â€‹ï¼Œä¸¤é¡¹ç›¸ä¹˜å°±æ˜¯$f_i$â€‹ï¼Œå†ç”¨ä¸Šè¿°å¼å­å³å¯å¾—åˆ°$g_0$â€‹<br>å…¶ä¸­nä¸ªOGFç›¸ä¹˜åˆ©ç”¨åˆ†æ²»NTTå³å¯</p><p>åœ¨reverseä¸€ä¸ªç©ºæ•°ç»„æ—¶ä¼šreï¼Œè¦æ³¨æ„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, h[N], cnt[N], d[N], sd[N];</span><br><span class="line"><span class="type">int</span> *f[N], buf[N&lt;&lt;<span class="number">5</span>], *<span class="built_in">np</span>(buf);</span><br><span class="line"><span class="type">int</span> fac[N], ifac[N], g[N];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myassert</span><span class="params">(<span class="type">bool</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x) <span class="keyword">while</span>(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> poly</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = <span class="number">1ll</span>*(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">    up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">    <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n)</span> </span>&#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">    <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">          t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">    <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">conv</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> l)</span> </span>&#123; <span class="built_in">DFT</span>(a, l); <span class="built_in">DFT</span>(b, l); <span class="built_in">dot</span>(a, b, l, a); <span class="built_in">IDFT</span>(a, l); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> *b, <span class="type">int</span> m, <span class="type">int</span> *c)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> l, ta[N], tb[N];</span><br><span class="line">    <span class="keyword">if</span>(n+m==<span class="number">0</span>) <span class="comment">//æ­¤æ—¶l=1ï¼ŒIDFTä¼šreï¼ï¼</span></span><br><span class="line">    &#123;</span><br><span class="line">      c[<span class="number">0</span>] = <span class="number">1ll</span>*a[<span class="number">0</span>]*b[<span class="number">0</span>]%mod;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    l = <span class="built_in">getlen</span>(n+m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) ta[i] = a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=m; i++) tb[i] = b[i];</span><br><span class="line">    <span class="built_in">conv</span>(ta, tb, l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n+m; i++) c[i] = ta[i];</span><br><span class="line">    <span class="built_in">clear</span>(ta, l), <span class="built_in">clear</span>(tb, l);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  ifac[n] = <span class="built_in">fpw</span>(fac[n], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a&lt;b||b&lt;<span class="number">0</span>||a&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*fac[a]*ifac[b]%mod*ifac[a-b]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  f[p] = np, np += sd[r] - sd[l<span class="number">-1</span>] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=d[l]; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      f[p][i] = cur;</span><br><span class="line">      cur = <span class="number">1ll</span>*cur*<span class="built_in">comb</span>(cnt[l]<span class="number">-2</span>*i, <span class="number">2</span>)%mod*inv[i+<span class="number">1</span>]%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">solve</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">solve</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  poly::<span class="built_in">mul</span>(f[p&lt;&lt;<span class="number">1</span>], sd[mid]-sd[l<span class="number">-1</span>], f[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>], sd[r]-sd[mid], f[p]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="type">int</span> mx = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">init</span>(<span class="number">2</span>*n);</span><br><span class="line">  poly::<span class="built_in">init</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">2</span>*n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; h[i];</span><br><span class="line">    cnt[h[i]]++;</span><br><span class="line">    mx = <span class="built_in">max</span>(mx, h[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=mx; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    d[i] = cnt[i]/<span class="number">2</span>;</span><br><span class="line">    sd[i] = sd[i<span class="number">-1</span>] + d[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">solve</span>(<span class="number">1</span>, <span class="number">1</span>, mx);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=sd[mx]; i++) g[i] = <span class="number">1ll</span>*f[<span class="number">1</span>][i]*fac[<span class="number">2</span>*n<span class="number">-2</span>*i]%mod*ifac[n-i]%mod*<span class="built_in">fpw</span>(<span class="built_in">fpw</span>(<span class="number">2</span>, n-i), mod<span class="number">-2</span>)%mod;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=sd[mx]; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(i&amp;<span class="number">1</span>) ans = (ans - g[i] + mod)%mod;</span><br><span class="line">    <span class="keyword">else</span> ans = (ans + g[i])%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>poj2821 å¾ªç¯å·ç§¯ bluesteinç®—æ³•</title>
      <link href="/2020/09/25/poj2821-xun-huan-juan-ji-bluestein-suan-fa/"/>
      <url>/2020/09/25/poj2821-xun-huan-juan-ji-bluestein-suan-fa/</url>
      
        <content type="html"><![CDATA[<p>å·²çŸ¥å¤šé¡¹å¼A*B=C,å…¶ä¸­*ä¸ºå¾ªç¯å·ç§¯ï¼Œç»™å‡ºBå’ŒCæ±‚A<br>å¯¹Bå’ŒCè¿›è¡Œä»»æ„é•¿åº¦çš„DFTï¼ˆbluesteinï¼Œç‹­ä¹‰çš„CZTï¼‰ï¼Œç„¶åç‚¹å€¼ç›¸é™¤å†å˜æ¢å›å»å³å¯<br>$ij = \binom{i+j}{2} - \binom{i}{2} - \binom{j}{2}$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = (<span class="number">1</span>&lt;&lt;<span class="number">19</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cp</span></span><br><span class="line">&#123;</span><br><span class="line">  db x, y;</span><br><span class="line">  <span class="built_in">cp</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">cp</span>(db _x, db _y): <span class="built_in">x</span>(_x), <span class="built_in">y</span>(_y) &#123;&#125;</span><br><span class="line">  cp <span class="keyword">operator</span> + (cp &amp;oth) &#123; <span class="keyword">return</span> <span class="built_in">cp</span>(x+oth.x, y+oth.y); &#125;</span><br><span class="line">  cp <span class="keyword">operator</span> - (cp &amp;oth) &#123; <span class="keyword">return</span> <span class="built_in">cp</span>(x-oth.x, y-oth.y); &#125;</span><br><span class="line">  cp <span class="keyword">operator</span> * (cp &amp;oth) &#123; <span class="keyword">return</span> <span class="built_in">cp</span>(x*oth.x-y*oth.y, x*oth.y+y*oth.x); &#125;</span><br><span class="line">  cp <span class="keyword">operator</span> / (cp &amp;oth) &#123; <span class="keyword">return</span> <span class="built_in">cp</span>((x*oth.x+y*oth.y)/(oth.x*oth.x+oth.y*oth.y), (y*oth.x-x*oth.y)/(oth.x*oth.x+oth.y*oth.y)); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> up, rev[N];</span><br><span class="line">cp w[N], pw[N];</span><br><span class="line"><span class="type">const</span> db pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;up; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;i; j++)</span><br><span class="line">      w[i+j] = <span class="built_in">cp</span>(<span class="built_in">cos</span>(pi*j/i), <span class="built_in">sin</span>(pi*j/i));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(cp *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> cp t;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) <span class="keyword">if</span>(i&lt;rev[i]) <span class="built_in">swap</span>(a[i], a[rev[i]]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">        t = a[i|j|k]*w[i|k], a[i|j|k] = a[j|k]-t, a[j|k] = a[j|k]+t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(cp *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i].x /= l, a[i].y /= l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">cp a[N], b[N], c[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*x*(x<span class="number">-1</span>)/<span class="number">2</span>%n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bluestein</span><span class="params">(cp *a, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> cp x[N], y[N];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) x[i].x = x[i].y = y[i].x = y[i].y = <span class="number">0.0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) x[i] = pw[n-<span class="built_in">comb</span>(i)]*a[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>*n<span class="number">-1</span>; i++) y[i] = pw[<span class="built_in">comb</span>(i)];</span><br><span class="line">  <span class="built_in">reverse</span>(x, x+n);</span><br><span class="line">  <span class="built_in">DFT</span>(x, up); <span class="built_in">DFT</span>(y, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) x[i] = x[i]*y[i];</span><br><span class="line">  <span class="built_in">IDFT</span>(x, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>; i&lt;=<span class="number">2</span>*n<span class="number">-2</span>; i++) a[i-n+<span class="number">1</span>] = x[i]*pw[n-<span class="built_in">comb</span>(i-n+<span class="number">1</span>)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Ibluestein</span><span class="params">(cp *a, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+n); <span class="built_in">bluestein</span>(a, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) a[i].x /= n, a[i].y /= n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">div</span><span class="params">(cp *a, cp * b, cp * c, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">bluestein</span>(a, n);</span><br><span class="line">  <span class="built_in">bluestein</span>(b, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) c[i] = a[i]/b[i];</span><br><span class="line">  <span class="built_in">Ibluestein</span>(c, n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;b[i].x);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;c[i].x);</span><br><span class="line">  <span class="built_in">init</span>(<span class="number">3</span>*n<span class="number">-3</span>);</span><br><span class="line">  pw[<span class="number">0</span>] = <span class="built_in">cp</span>(<span class="number">1</span>, <span class="number">0</span>); pw[<span class="number">1</span>] = <span class="built_in">cp</span>(<span class="built_in">cos</span>(<span class="number">2</span>*pi/n), <span class="built_in">sin</span>(<span class="number">2</span>*pi/n));</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) pw[i] = pw[i<span class="number">-1</span>]*pw[<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">div</span>(c, b, a, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.4f\n&quot;</span>, a[i].x);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢ å¯¼ä¸€å¯¼ è±å¸ƒå°¼èŒ¨æ±‚å¯¼å…¬å¼</title>
      <link href="/2020/09/24/niu-ke-dao-yi-dao-lai-bu-ni-ci-qiu-dao-gong-shi/"/>
      <url>/2020/09/24/niu-ke-dao-yi-dao-lai-bu-ni-ci-qiu-dao-gong-shi/</url>
      
        <content type="html"><![CDATA[<p>æ±‚$\sum\limits_{i=1}^k a_i<br>\frac{sinx}{x^i}^{(n)}$<br>è¾“å‡º$\frac{sinx}{x^i}$ å’Œ$\frac{cosx}{x^i}$â€‹å‰çš„ç³»æ•°<br>$n, k \leq 10^5$</p><p>$(uv)^{(n)} = \sum\limits_{k=0}^n \binom{n}{k}<br>u^{(k)}v^{(n-k)}$<br>$\sum\limits_{j=0}^k \binom{k}{j} sinx^{(k-j)}<br>\sum\limits_{i=1}^k(a_ix^{-i})^{(j)}$<br>å‘ç°æ˜¯ä¸€ä¸ªå¤šé¡¹å¼ä¹˜æ³•çš„å½¢å¼ï¼Œç»§ç»­åŒ–ç®€<br>$\sum\limits_{j=0}^k \binom{k}{j}<br>sinx^{(k-j)}<br>\sum\limits_{i=1}^ka_i(-i)^{\underline{j}}x^{-i-j}$<br>$\sum\limits_{j=0}^k<br>\binom{k}{j} sinx^{(k-j)}x^{-j}(-1)^j<br>\sum\limits_{i=1}^ka_i\frac{(i+j-1)!}{(i-1)!}x^{-i}$<br>æŠŠ$(i+j-1)!$æå‡ºæ¥ï¼Œå…¶ä½™çš„å°±æ˜¯ä¸¤ä¸ªå¤šé¡¹å¼ï¼ŒNTTç›¸ä¹˜åï¼Œæœ€åå†ä¹˜ä¸Š$(i+j-1)!$çš„è´¡çŒ®å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, k, fac[N], ifac[N], a[N], b[N], bb[N], c[N];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> poly</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">    <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n)</span> </span>&#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">    <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">          t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">    <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(n&lt;m||n&lt;<span class="number">0</span>||m&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*fac[n]*ifac[m]%mod*ifac[n-m]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">  poly::<span class="built_in">init</span>(n+k);</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n+k; i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  ifac[n+k] = <span class="built_in">fpw</span>(fac[n+k], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n+k<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; a[i];</span><br><span class="line">    a[i] = <span class="number">1ll</span>*a[i]*ifac[i<span class="number">-1</span>]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  poly::<span class="built_in">DFT</span>(a, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    b[i] = <span class="built_in">comb</span>(n, i);</span><br><span class="line">    <span class="keyword">if</span>((n-i)%<span class="number">4</span>&gt;<span class="number">1</span>) b[i] = mod - b[i];</span><br><span class="line">    <span class="keyword">if</span>(i&amp;<span class="number">1</span>) b[i] = mod - b[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i+=<span class="number">2</span>) bb[i] = b[i];</span><br><span class="line">  poly::<span class="built_in">DFT</span>(bb, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) c[i] = <span class="number">1ll</span>*a[i]*bb[i]%mod;</span><br><span class="line">  poly::<span class="built_in">IDFT</span>(c, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n+k; i++) cout &lt;&lt; <span class="number">1ll</span>*c[i]*fac[i<span class="number">-1</span>]%mod &lt;&lt; <span class="string">&quot; \n&quot;</span>[i==n+k];</span><br><span class="line"></span><br><span class="line">  poly::<span class="built_in">clear</span>(bb, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i+=<span class="number">2</span>) bb[i] = b[i];</span><br><span class="line">  poly::<span class="built_in">DFT</span>(bb, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) c[i] = <span class="number">1ll</span>*a[i]*bb[i]%mod;</span><br><span class="line">  poly::<span class="built_in">IDFT</span>(c, up);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n+k; i++) cout &lt;&lt; <span class="number">1ll</span>*c[i]*fac[i<span class="number">-1</span>]%mod &lt;&lt; <span class="string">&quot; \n&quot;</span>[i==n+k];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P5394 ã€æ¨¡æ¿ã€‘ä¸‹é™å¹‚å¤šé¡¹å¼ä¹˜æ³•</title>
      <link href="/2020/09/24/p5394-mo-ban-xia-jiang-mi-duo-xiang-shi-cheng-fa/"/>
      <url>/2020/09/24/p5394-mo-ban-xia-jiang-mi-duo-xiang-shi-cheng-fa/</url>
      
        <content type="html"><![CDATA[<p>ä¸‹é™å¹‚å¤šé¡¹å¼ï¼šFalling Factorial Polynomial(FFP)<br>å½¢å¼$f(x) = \sum \limits_{i=0}^{n}<br>a_ix^{\underline{i}}$<br>æ™®é€šå¤šé¡¹å¼ä¸ä¸‹é™å¹‚å¤šé¡¹å¼æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼ˆä»é«˜å¹‚æ¬¡å‘ä½å¹‚æ¬¡é…ç³»æ•°å³å¯ï¼‰<br>ç°åœ¨ç»™å‡ºä¸¤ä¸ªä¸‹é™å¹‚å¤šé¡¹å¼fï¼Œgï¼Œè¦æ±‚å‡ºè¿™ä¸¤ä¸ªå¤šé¡¹å¼ä¹˜æ³•çš„ç»“æœï¼ˆè¾“å‡ºæ™®é€šå¤šé¡¹å¼çš„ç³»æ•°ï¼‰<br>$n \leq 10^5$<br>åœ¨FFTä¸‹ï¼Œæ™®é€šå¤šé¡¹å¼åœ¨å•ä½æ ¹å¤„çš„ç‚¹å€¼å¯ä»¥å¿«é€Ÿè®¡ç®—<br>è€Œä¸‹é™å¹‚å¤šé¡¹å¼åœ¨$0 \dots n$å¤„çš„ç‚¹å€¼å¯ä»¥å¿«é€Ÿè®¡ç®—<br>è€ƒè™‘f(x)çš„EGFï¼š$\sum<br>\limits_{i=0}^{\infty} \frac{f(i)}{i!}x^i = \sum \limits_{i=0}^{\infty}<br>\frac{\sum \limits_{j=0}^{n} a_ji^{\underline{j}}}{i!}x^i = \sum<br>\limits_{j=0}^n a_j \sum\limits_{i=0}^\infty \frac{1}{(i-j)!}x^i =<br>\sum\limits_{j=0}^n a_jx^j \sum\limits_{i=0}^\infty \frac{x^i}{i!} =<br>e^x\sum\limits_{i=0}^n<br>a_ix^i$<br>æ‰€ä»¥æˆ‘ä»¬åªè¦æŠŠä¸‹é™å¹‚å¤šé¡¹å¼å½“æˆæ™®é€šå¤šé¡¹å¼ï¼Œç„¶åå·ä¸Šä¸€ä¸ª$e^x$å°±å¯ä»¥å¿«é€Ÿè®¡ç®—å‡ºf(x)åœ¨$0\dots n$å¤„çš„å–å€¼ï¼ˆå®è´¨æ˜¯$\frac{f(x)}{x!}$â€‹ï¼‰<br>é‚£ä¹ˆå°†få’Œgåˆ†åˆ«å·ä¸Š$e^x$ç„¶åå¯¹åº”ç‚¹å€¼ç›¸ä¹˜ï¼Œå†åå˜æ¢å›å»ï¼ˆä¹˜ä¸Š$e^{-x} =<br>\sum\limits_{i=0}^\infty \frac{(-x)^i}{i!}$â€‹ï¼‰å³å¯<br>å¤æ‚åº¦$O(n\log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">8e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N], fac[N], ifac[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> poly</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">    <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n)</span> </span>&#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">    <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">          t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">    <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">conv</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> l)</span> </span>&#123; <span class="built_in">DFT</span>(a, l); <span class="built_in">DFT</span>(b, l); <span class="built_in">dot</span>(a, b, l, a); <span class="built_in">IDFT</span>(a, l); &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, m, a[N], b[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ffp</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> tmp[N];</span><br><span class="line">  poly::<span class="built_in">clear</span>(tmp, up);</span><br><span class="line">  <span class="keyword">if</span>(op) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) tmp[i] = ifac[i];</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) <span class="keyword">if</span>(i&amp;<span class="number">1</span>) tmp[i] = mod - ifac[i]; <span class="keyword">else</span> tmp[i] = ifac[i];</span><br><span class="line">  poly::<span class="built_in">conv</span>(a, tmp, up);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="type">int</span> deg = n + m;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=deg; i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  ifac[deg] = <span class="built_in">fpw</span>(fac[deg], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=deg<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">  poly::<span class="built_in">init</span>(deg&lt;&lt;<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) cin &gt;&gt; a[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=m; i++) cin &gt;&gt; b[i];</span><br><span class="line">  <span class="built_in">ffp</span>(a, deg, <span class="number">1</span>); <span class="built_in">ffp</span>(b, deg, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) a[i] = <span class="number">1ll</span>*a[i]*b[i]%mod*fac[i]%mod;</span><br><span class="line">  <span class="built_in">ffp</span>(a, deg, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=deg; i++) cout &lt;&lt; a[i] &lt;&lt; <span class="string">&quot; \n&quot;</span>[i==deg];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ç©æ„é™¤äº†åšè¿™ç§<s>æ²¡å•¥ç”¨</s>çš„æ¨¡æ¿é¢˜è¿˜èƒ½å¹²å•¥å‘¢</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢æŒ‘æˆ˜èµ›41 Dä¹°ç³–æœ æŠ˜åŠ å¤šç‚¹æ±‚å€¼</title>
      <link href="/2020/09/23/niu-ke-tiao-zhan-sai-41-d-mai-tang-guo-zhe-ban-duo-dian-qiu-zhi/"/>
      <url>/2020/09/23/niu-ke-tiao-zhan-sai-41-d-mai-tang-guo-zhe-ban-duo-dian-qiu-zhi/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šnä¸ªæ•°ï¼Œæ±‚æ‰€æœ‰éç©ºå­é›†çš„å’Œçš„ä¹˜ç§¯mod 998244353<br>$n \leq 32$</p><p>è€ƒè™‘æŠ˜åŠLï¼ŒRï¼Œå¾ˆå®¹æ˜“çŠ¶å‹æ±‚å‡ºä¸¤éƒ¨åˆ†å†…éƒ¨å„è‡ªçš„è´¡çŒ®ï¼Œä¸¤éƒ¨åˆ†å…±åŒçš„è´¡çŒ®å¯ä»¥ç”¨$\prod\limits_{i=1}^{(1&lt;&lt;L)-1} \prod \limits_{j=1}^{(1&lt;&lt;R)-1} (c_i + d_j)$<br>ä»¤$f(x) = \prod \limits_{j=1}^{(1&lt;&lt;R)-1}(x+d_j)$ï¼Œæ˜¾ç„¶å¯ä»¥ç”¨åˆ†æ²»NTTæ±‚å¾—è¯¥å¤šé¡¹å¼ï¼Œç„¶ååªè¦å¯¹æ¯ä¸ª$c_i$â€‹æ±‚å€¼åä¹˜ç§¯å³å¯ï¼Œå¤šç‚¹æ±‚å€¼æ¿å­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = (<span class="number">1</span>&lt;&lt;<span class="number">17</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> poly</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = <span class="number">1ll</span>*(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">    up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">    <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n)</span> </span>&#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, n&lt;&lt;<span class="number">2</span>); &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">    <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">          t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">    <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">conv</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> l)</span> </span>&#123; <span class="built_in">DFT</span>(a, l); <span class="built_in">DFT</span>(b, l); <span class="built_in">dot</span>(a, b, l, a); <span class="built_in">IDFT</span>(a, l); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">Inv</span><span class="params">(<span class="type">const</span> <span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> c[N], l;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">0</span>) &#123; b[<span class="number">0</span>] = <span class="built_in">fpw</span>(a[<span class="number">0</span>], mod<span class="number">-2</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="built_in">Inv</span>(a, b, n&gt;&gt;<span class="number">1</span>); l = <span class="built_in">getlen</span>(n&lt;&lt;<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) c[i] = a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n+<span class="number">1</span>; i&lt;l; i++) c[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">DFT</span>(c, l); <span class="built_in">DFT</span>(b, l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) b[i] = (<span class="number">2ll</span><span class="number">-1ll</span>*c[i]*b[i]%mod+mod)%mod*b[i]%mod;</span><br><span class="line">    <span class="built_in">IDFT</span>(b, l);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n+<span class="number">1</span>; i&lt;l; i++) b[i] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> *f[N], *g[N], buf[N&lt;&lt;<span class="number">5</span>], *<span class="built_in">np</span>(buf);</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> *b, <span class="type">int</span> m, <span class="type">int</span> *c, <span class="type">int</span> deg, <span class="type">int</span> st)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> A[N], B[N], l;</span><br><span class="line">    l = <span class="built_in">getlen</span>(deg), <span class="built_in">copy</span>(a, a+n+<span class="number">1</span>, A), <span class="built_in">copy</span>(b, b+m+<span class="number">1</span>, B);</span><br><span class="line">    <span class="built_in">conv</span>(A, B, l); <span class="built_in">copy</span>(A+st, A+deg+<span class="number">1</span>, c);</span><br><span class="line">    <span class="built_in">clear</span>(A, l), <span class="built_in">clear</span>(B, l);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">eval_init</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> *a)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    g[p] = np, np += r-l+<span class="number">2</span>, f[p] = np, np += r-l+<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123; g[p][<span class="number">0</span>] = (mod-a[l])%mod, g[p][<span class="number">1</span>] = <span class="number">1</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="type">int</span> lc = p&lt;&lt;<span class="number">1</span>, rc = lc|<span class="number">1</span>, mid = (l+r)&gt;&gt;<span class="number">1</span>, up1 = mid-l+<span class="number">1</span>, up2 = r-mid;</span><br><span class="line">    <span class="built_in">eval_init</span>(lc, l, mid, a); <span class="built_in">eval_init</span>(rc, mid+<span class="number">1</span>, r, a);</span><br><span class="line">    <span class="built_in">mul</span>(g[lc], up1, g[rc], up2, g[p], up1+up2, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">eval_work</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> *a)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) &#123; a[l] = f[p][<span class="number">0</span>]; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="type">int</span> lc = p&lt;&lt;<span class="number">1</span>, rc = lc|<span class="number">1</span>, mid = (l+r)&gt;&gt;<span class="number">1</span>, up1 = mid-l+<span class="number">1</span>, up2 = r-mid;</span><br><span class="line">    <span class="built_in">mul</span>(f[p], r-l, g[rc], up2, f[lc], r-l, up2);</span><br><span class="line">    <span class="built_in">eval_work</span>(lc, l, mid, a);</span><br><span class="line">    <span class="built_in">mul</span>(f[p], r-l, g[lc], up1, f[rc], r-l, up1);</span><br><span class="line">    <span class="built_in">eval_work</span>(rc, mid+<span class="number">1</span>, r, a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">eval</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> *b, <span class="type">int</span> m, <span class="type">int</span> *c)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> invg[N], q[N];</span><br><span class="line">    <span class="built_in">eval_init</span>(<span class="number">1</span>, <span class="number">1</span>, m, b);</span><br><span class="line">    <span class="built_in">reverse</span>(g[<span class="number">1</span>], g[<span class="number">1</span>]+m+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">Inv</span>(g[<span class="number">1</span>], invg, m);</span><br><span class="line">    <span class="built_in">reverse</span>(invg, invg+m+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">mul</span>(a, n, invg, m, q, n+m, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">copy</span>(q+n+<span class="number">1</span>, q+n+m+<span class="number">1</span>, f[<span class="number">1</span>]);</span><br><span class="line">    <span class="built_in">eval_work</span>(<span class="number">1</span>, <span class="number">1</span>, m, c);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) c[i] = (<span class="number">1ll</span>*c[i]*b[i]%mod+a[<span class="number">0</span>])%mod;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, a[<span class="number">35</span>];</span><br><span class="line"><span class="type">int</span> c[N], d[N], v[N];</span><br><span class="line"><span class="type">int</span> *f[N], pool[N&lt;&lt;<span class="number">5</span>], *<span class="built_in">ptr</span>(pool);</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  f[p] = ptr, ptr += r-l+<span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r) &#123; f[p][<span class="number">0</span>] = d[l], f[p][<span class="number">1</span>] = <span class="number">1</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">  <span class="type">int</span> lc = p&lt;&lt;<span class="number">1</span>, rc = lc|<span class="number">1</span>, mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">solve</span>(lc, l, mid); <span class="built_in">solve</span>(rc, mid+<span class="number">1</span>, r);</span><br><span class="line">  poly::<span class="built_in">mul</span>(f[lc], mid-l+<span class="number">1</span>, f[rc], r-mid, f[p], r-l+<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>); cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) cin &gt;&gt; a[i];</span><br><span class="line">  <span class="type">int</span> L = n/<span class="number">2</span>, R = n - L, ans = <span class="number">1</span>;</span><br><span class="line">  poly::<span class="built_in">init</span>((<span class="number">1</span>&lt;&lt;(R+<span class="number">1</span>))<span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;(<span class="number">1</span>&lt;&lt;L); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;L; j++)</span><br><span class="line">        <span class="keyword">if</span>((i&gt;&gt;j)&amp;<span class="number">1</span>) cur += a[j];</span><br><span class="line">    ans = <span class="number">1ll</span>*ans*cur%mod;</span><br><span class="line">    c[i] = cur;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;(<span class="number">1</span>&lt;&lt;R); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;R; j++)</span><br><span class="line">        <span class="keyword">if</span>((i&gt;&gt;j)&amp;<span class="number">1</span>) cur += a[L+j];</span><br><span class="line">    ans = <span class="number">1ll</span>*ans*cur%mod;</span><br><span class="line">    d[i] = cur;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">solve</span>(<span class="number">1</span>, <span class="number">1</span>, (<span class="number">1</span>&lt;&lt;R)<span class="number">-1</span>);</span><br><span class="line">  poly::<span class="built_in">eval</span>(f[<span class="number">1</span>], (<span class="number">1</span>&lt;&lt;R)<span class="number">-1</span>, c, (<span class="number">1</span>&lt;&lt;R)<span class="number">-1</span>, v);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;(<span class="number">1</span>&lt;&lt;L); i++) ans = <span class="number">1ll</span>*ans*v[i]%mod;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‹„åˆ©å…‹é›·å·ç§¯ç›¸å…³</title>
      <link href="/2020/09/18/di-li-ke-lei-juan-ji-xiang-guan/"/>
      <url>/2020/09/18/di-li-ke-lei-juan-ji-xiang-guan/</url>
      
        <content type="html"><![CDATA[<p>ç‹„åˆ©å…‹é›·å·ç§¯å³ä¹˜æ³•å·ç§¯<br>$f_n = \sum \limits_{d\mid n} g_dh_{\frac{n}{d}}$<br>ä¸¤ä¸ªç§¯æ€§å‡½æ•°çš„ç‹„åˆ©å…‹é›·å·ç§¯ä»ç„¶ç§¯æ€§</p><h2 id="Dirichlet-k-th-root"><a class="header-anchor" href="#Dirichlet-k-th-root">Â¶</a>Dirichlet k-th root</h2><p>ç»™å®šfï¼Œä»¤$g^k = f$ï¼Œæ±‚g<br>æ­¤å¤„ä¹˜æ³•ä¸ºç‹„åˆ©å…‹é›·å·ç§¯<br>æœ‰ç»“è®º$f^{mod} = \epsilon$ï¼Œå› è€Œ$f^{mod+1} = f$ï¼Œå°è¯•æ‰¾ä¸€ä¸ªxï¼Œä½¿å¾—$x * k = p * mod+1$ï¼Œè¿™æ ·$f^x$å³ä¸ºç­”æ¡ˆã€‚$x=inv(k)$å³å¯<br>ç”±äºç‹„åˆ©å…‹é›·å·ç§¯å…·æœ‰ç»“åˆå¾‹ï¼Œå¥—ä¸€ä¸ªå¿«é€Ÿå¹‚</p><h2 id="P4714-ã€Œæ•°å­¦ã€çº¦æ•°ä¸ªæ•°å’Œ"><a class="header-anchor" href="#P4714-ã€Œæ•°å­¦ã€çº¦æ•°ä¸ªæ•°å’Œ">Â¶</a>P4714 ã€Œæ•°å­¦ã€çº¦æ•°ä¸ªæ•°å’Œ</h2><p>æ±‚$f_n = \sum \limits_{i_1\mid n}\sum \limits_{i_2\mid<br>i_1} \dots \sum \limits_{i_k\mid i_{k-1}} 1$</p><p>$n \leq 10^{18},k \leq 10^{18}$</p><p>ä¸Šé¢è¿™ä¸ªæ±‚å’Œå½¢å¼å¯ä»¥è½¬åŒ–æˆç‹„åˆ©å…‹é›·å·ç§¯çš„å½¢å¼<br>ä»¤$g_i = 1$ï¼Œåˆ™$f = \epsilon^k * g$<br>ç„¶è€Œè¿™é‡Œæ•°å­—å¤ªå¤§ï¼Œåšä¸äº†<br>è¿™æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œæ‰€ä»¥å¯¹nè´¨å› æ•°åˆ†è§£åè€ƒè™‘å•ä¸ªç´ å› å­çš„å¹‚æ¬¡çš„å€¼ï¼ˆè¿™é‡Œè¦pollard-rhoï¼‰<br>å¯¹äº$f_{p^x}$â€‹ï¼Œæˆ‘ä»¬ç›¸å½“äºæšä¸¾äº†æ‰€æœ‰æ»¡è¶³$x_1+x_2+\dots + x_k \leq<br>x$ï¼Œå…¶ä¸­$x_i \geq 0$çš„xçš„ç»„åˆï¼Œæ ¹æ®æ’æ¿æ³•å…¶å€¼ä¸º$\binom{x+k}{k}$ï¼Œç”±äºå¹‚æ¬¡ä¸ä¼šå¾ˆå¤§ï¼Œå¯ä»¥è½¬åŒ–æˆ$\binom{x+k}{x}$ï¼Œæš´åŠ›è®¡ç®—å³å¯</p><h2 id="hdu5628-Clarke-and-math"><a class="header-anchor" href="#hdu5628-Clarke-and-math">Â¶</a>hdu5628 Clarke and math</h2><p>æ±‚$f_n = \sum \limits_{i_1\mid n}\sum \limits_{i_2\mid<br>i_1} \dots \sum \limits_{i_k\mid i_{k-1}}<br>g_{i_k}$</p><p>$n \leq 10^5, k\leq 10^5$</p><p>è¿™é¢˜å°±æ˜¯æŠŠä¸Šé¢˜çš„1æ¢æˆäº†$kg_{i_k}$â€‹â€‹<br>æ˜¾ç„¶çš„åšæ³•å°±æ˜¯ç‹„åˆ©å…‹é›·å·ç§¯åŠ å¿«é€Ÿå¹‚<br>è¿™è¾¹è€ƒè™‘ä»¿ç…§ä¸Šä¸€é¢˜çš„åšæ³•ï¼Œä»¤$h_i$â€‹è¡¨ç¤º$g_j$â€‹è½¬ç§»ç»™$jf_{ij}$â€‹çš„è´¡çŒ®ï¼Œå¦‚æœèƒ½ç®—å‡º$h_i$â€‹ï¼Œé‚£ä¹ˆ$O(n\log n)$æšä¸¾å€æ•°å³å¯è§£å†³<br>è¿™åŒæ ·æ˜¯ä¸ªç§¯æ€§å‡½æ•°ï¼Œè€ƒè™‘$h_{p^x}$â€‹ï¼Œç›¸å½“äºæšä¸¾äº†æ‰€æœ‰æ»¡è¶³$x_1+x_2+\dots + x_k = x$ï¼Œå…¶ä¸­$x_i \geq 0$çš„xçš„ç»„åˆï¼Œæ ¹æ®æ’æ¿æ³•å€¼ä¸º$\binom{x+k-1}{x}$<br>è¿™é‡Œnå¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨ç´ æ•°ç­›$O(n)$æ±‚å¾—è¯¥ç§¯æ€§å‡½æ•°h<br>æ‰€ä»¥æ€»å¤æ‚åº¦æ˜¯$O(n\log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>, up = <span class="number">2e5</span>;</span><br><span class="line"><span class="type">int</span> fac[N], ifac[N], f[N], g[N], h[N];</span><br><span class="line"><span class="type">int</span> n, k, pr[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fac[i] = <span class="number">1ll</span>*i*fac[i<span class="number">-1</span>]%mod;</span><br><span class="line">  ifac[n] = <span class="built_in">fpw</span>(fac[n], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) ifac[i] = <span class="number">1ll</span>*(i+<span class="number">1</span>)*ifac[i+<span class="number">1</span>]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a&lt;<span class="number">0</span>||b&lt;<span class="number">0</span>||a&lt;b) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*fac[a]*ifac[b]%mod*ifac[a-b]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  h[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!vis[i]) h[i] = k, pr[++pr[<span class="number">0</span>]] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=pr[<span class="number">0</span>]&amp;&amp;<span class="number">1ll</span>*pr[j]*i&lt;=n; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      vis[pr[j]*i] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span>(i%pr[j]==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> tmp = i/pr[j], cnt = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span>(tmp%pr[j]==<span class="number">0</span>) ++cnt, tmp /= pr[j];</span><br><span class="line">        h[pr[j]*i] = <span class="number">1ll</span>*h[tmp]*<span class="built_in">comb</span>(cnt+k<span class="number">-1</span>, cnt)%mod;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> h[pr[j]*i] = <span class="number">1ll</span>*h[i]*h[pr[j]]%mod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, f+i), g[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">get</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; i*j&lt;=n; j++)</span><br><span class="line">      g[i*j] = (g[i*j] + <span class="number">1ll</span>*f[i]*h[j])%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, g[i], <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">init</span>(up);</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ABC178</title>
      <link href="/2020/09/17/abc178/"/>
      <url>/2020/09/17/abc178/</url>
      
        <content type="html"><![CDATA[<p>æ¯”è¾ƒæ°´çš„ä¸€åœº</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>ï¼è¿ç®—ç¬¦</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>å››ç§è¾¹ç•Œå–ä¸ªmax</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ç®€å•å®¹æ–¥</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>é—®ä½ æœ‰å¤šå°‘ä¸ªåºåˆ—æ»¡è¶³æ‰€æœ‰å…ƒç´ éƒ½$\geq 3$å¹¶ä¸”å’Œç­‰äºs<br>$s\leq 2000$<br>è€ƒè™‘æšä¸¾è¿™ä¸ªåºåˆ—çš„é•¿åº¦ä¸ºn<br>é‚£ä¹ˆå°±è¦æ»¡è¶³$x_1+\dots +x_n = s - 2n$ï¼Œå…¶ä¸­$x_i$â€‹ä¸ºæ­£æ•´æ•°ï¼Œæ¯ä¸ªæ•°$\geq 3$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»™æ¯ä¸ªæ•°å‡æ‰2å°±è½¬åŒ–ä¸ºæ­£æ•´æ•°çš„è¦æ±‚ï¼Œä¸‹é¢å°±æ˜¯ä¸€ä¸ªç»å…¸çš„ç»„åˆæ•°æ’æ¿é—®é¢˜ï¼Œç­”æ¡ˆæ˜¯$\binom{s-2n-1}{n-1}$</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ç»™å®šnä¸ªç‚¹çš„åæ ‡ï¼Œæ±‚ä¸¤ç‚¹é—´çš„æœ€å¤§æ›¼å“ˆé¡¿è·ç¦»<br>å¾ˆå¥—è·¯çš„é¢˜ï¼Œä¿å­˜(+x,+y),(+x,-y),(-x,+y),(-x,-y)å››ç§æƒ…å†µçš„æœ€å€¼ï¼Œæšä¸¾å–maxå³å¯ï¼Œå®¹æ˜“å‘ç°è™½ç„¶æšä¸¾ä¸­æœ‰ä¸åˆæ³•çš„æƒ…å†µï¼Œä½†ä¸€å®šä¸æ˜¯æœ€ä¼˜è§£ï¼ˆå› ä¸ºè¿™æ—¶å€™æˆ‘ä»¬æŠŠç»å¯¹å€¼å–è´Ÿäº†ï¼‰</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸ºné€’å¢åºåˆ—aå’Œbï¼Œè¦æ±‚é‡æ’bï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰iï¼Œæ»¡è¶³$a_i \neq b_i$â€‹<br>$n \leq 2\times 10^5$<br>å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªç½‘ç»œæµé—®é¢˜ï¼Œå¯¹äºæ¯ä¸ª$b_i$â€‹ï¼Œä½ å¯ä»¥æ”¾çš„ä½ç½®å°±æ˜¯aä¸­æ‰€æœ‰$a_j \neq b_i$â€‹çš„jï¼Œè¿è¾¹è·‘æœ€å¤§æµå³å¯ï¼Œç„¶è€Œæ˜¾ç„¶ä¼šçˆ†<br>è¿™ç§ç‰¹æ®Šçš„ç½‘ç»œæµï¼Œè€ƒè™‘è´ªå¿ƒçš„è§£æ³•<br>ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼Œå¯¹äºæ¯ä¸ª$a_i$â€‹ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸ç­‰äº$a_i$â€‹çš„ä¸”å¯æ”¾ç½®ä½ç½®æœ€å°‘çš„é‚£ä¸ª$b_j$â€‹ï¼Œå³åœ¨aä¸­å’Œå®ƒç›¸ç­‰çš„å…ƒç´ æœ€å¤šã€‚è¿™æ ·è´ªå¿ƒå³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EDU95</title>
      <link href="/2020/09/15/edu95/"/>
      <url>/2020/09/15/edu95/</url>
      
        <content type="html"><![CDATA[<h2 id="D-Trash-Problem"><a class="header-anchor" href="#D-Trash-Problem">Â¶</a>D. Trash Problem</h2><p>æœ‰nå †ç‰©å“æ’æˆä¸€æ¡çº¿ï¼Œå¯ä»¥å°†åŒä¸€ä½ç½®çš„<strong>æ‰€æœ‰</strong><br>ç‰©å“åŒæ—¶ç§»åŠ¨åˆ°ç›¸é‚»çš„ä½ç½®ï¼Œqæ¬¡æ“ä½œï¼Œæ¯æ¬¡å¯ä»¥æ·»åŠ ä¸€å †ç‰©å“æˆ–è€…åˆ é™¤ä¸€å †ç‰©å“ï¼Œå¹¶è¯¢é—®å°†æ‰€æœ‰ç‰©å“ç§»åŠ¨æˆå°äºç­‰äº2å †çš„æœ€å°ä»£ä»·<br>$n \leq 10^5,q \leq 10^5$<br>ç¬¬ä¸€ååº”åº”è¯¥æ˜¯ä¸­ä½æ•°ï¼Œä½†è¦å‘ç°æ¯æ¬¡å¿…é¡»åŒæ—¶ç§»åŠ¨åŒä¸€ä½ç½®çš„æ‰€æœ‰ç‰©å“ï¼Œé‚£ä¹ˆå¦‚æœç§»æˆä¸€å †ï¼Œç­”æ¡ˆå°±æ˜¯æœ€å¤§åæ ‡$x_n$â€‹-æœ€å°åæ ‡$x_1$â€‹ï¼Œè€ƒè™‘ç§»æˆä¸¤å †ï¼Œåªè¦æšä¸¾ä¸€ä¸ªåˆ†å‰²ç‚¹iï¼Œç„¶åå‰é¢çš„ä»£ä»·æ˜¯$x_i-x_1$â€‹ï¼Œåé¢çš„ä»£ä»·æ˜¯$x_n-x_{i+1}$â€‹ï¼Œæ‰€ä»¥æœ€å°ä»£ä»·å°±æ˜¯æœ€å¤§åæ ‡-æœ€å°åæ ‡-<br>ç›¸é‚»åæ ‡çš„æœ€å¤§å·®å€¼ã€‚åˆ©ç”¨multisetåŠ¨æ€ç»´æŠ¤å³å¯<br>tips:å¯ä»¥ç”¨rbeginæ¥æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ¯”--endæ–¹ä¾¿ç‚¹</p><h2 id="E-Expected-Damage"><a class="header-anchor" href="#E-Expected-Damage">Â¶</a>E. Expected Damage</h2><p>æœ‰nä¸ªæ€ªç‰©ï¼Œç¬¬iä¸ªæ€ªç‰©çš„ä¼¤å®³ä¸º$d_i$â€‹ï¼Œç°åœ¨æœ‰ä¸€ä¸ªç›¾ç‰Œï¼Œæœ‰å±æ€§aå’Œbï¼Œå½“$a\gt 0$æ—¶ï¼Œå¯ä»¥å…ç–«$\lt b$çš„ä¼¤å®³ï¼Œè€Œ$\geq b$çš„ä¼¤å®³ä¼šä½¿$a-1$ï¼ˆä¸ä¼šå—åˆ°ä¼¤å®³ï¼‰ï¼Œè€Œå½“$a=0$æ—¶ï¼Œä¼šå—åˆ°æ‰€æœ‰çš„ä¼¤å®³ã€‚<br>ç°åœ¨æœ‰mç§ç›¾ç‰Œï¼Œå¯¹äºæ¯ç§éœ€è¦å›ç­”åœ¨n!ç§æ‰“æ€ªæ–¹å¼ä¸‹ï¼Œå—åˆ°çš„ä¼¤å®³çš„æœŸæœ›<br>$n \leq 2\times 10^5,m \leq 2\times 10^5$<br>è€ƒè™‘æ¯ç§æ€ªç‰©çš„è´¡çŒ®ï¼Œå®¹æ˜“å‘ç°å¯ä»¥åˆ†æˆä¼¤å®³$&lt;b$å’Œ$\geq b$ä¸¤ç±»è®¡ç®—<br>æœ€å¥½çš„åšæ³•æ˜¯ä»æ•´ä½“ä¸Šè€ƒè™‘<br>å®šä¹‰geä¸ºä¼¤å®³$\geq b$çš„æ€ªç‰©æ•°é‡ï¼Œleä¸º$&lt;b$çš„æ€ªç‰©æ•°é‡ï¼Œå°†dæ’åºålowerboundå³å¯<br>å¯¹äºä¼¤å®³$\geq b$çš„geä¸ªæ€ªç‰©ï¼Œæ’åœ¨å‰aä¸ªæ˜¯æ²¡æœ‰ä¼¤å®³çš„ï¼Œå› ä¸ºä¼šè¢«ç›¾ç‰ŒæŒ¡æ‰ï¼Œæ‰€ä»¥æœ‰è´¡çŒ®çš„æ¦‚ç‡å°±æ˜¯$\frac{ge-a}{ge}$ï¼Œå†ä¹˜ä¸Šè¿™äº›æ€ªç‰©çš„ä¼¤å®³å’Œå³å¯<br>å¯¹äºä¼¤å®³$\lt b$çš„leä¸ªæ€ªç‰©ï¼Œå¿…é¡»ä¿è¯å‰é¢æœ‰è‡³å°‘aä¸ªä¼¤å®³$\geq b$çš„æ€ªç‰©ï¼Œå¯ä»¥å›ºå®šä½geä¸ªæ€ªç‰©çš„ä½ç½®ï¼Œé‚£ä¹ˆç°åœ¨æœ‰ge+1ä¸ªç©ºä½ï¼Œå‰aä¸ªæ˜¯æ²¡æœ‰è´¡çŒ®çš„ï¼Œæ‰€ä»¥æœ‰è´¡çŒ®çš„æ¦‚ç‡å°±æ˜¯$\frac{ge+1-a}{ge+1}$â€‹ï¼Œå†ä¹˜ä¸Šä¸€ä¸ªå‰ç¼€å’Œå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>, mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">int</span> n, m, d[N], sum[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = <span class="number">1ll</span>*(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; d[i];</span><br><span class="line">  <span class="built_in">sort</span>(d+<span class="number">1</span>, d+n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) sum[i] = (sum[i<span class="number">-1</span>] + d[i])%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="type">int</span> le = <span class="built_in">lower_bound</span>(d+<span class="number">1</span>, d+n+<span class="number">1</span>, b) - d - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ge = n - le;</span><br><span class="line">    <span class="type">int</span> x = (ge &lt; a ? <span class="number">0</span> : <span class="number">1ll</span>*(ge-a)*inv[ge]%mod*(sum[n]-sum[le])%mod);</span><br><span class="line">    <span class="type">int</span> y = (ge &lt; a ? <span class="number">0</span> : <span class="number">1ll</span>*(ge+<span class="number">1</span>-a)*inv[ge+<span class="number">1</span>]%mod*sum[le]%mod);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ((x+y)%mod+mod)%mod);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="G-Three-Occurrences"><a class="header-anchor" href="#G-Three-Occurrences">Â¶</a>G. Three Occurrences</h2><p>ç»™å‡ºä¸€ä¸ªæ•°ç»„aï¼Œå®šä¹‰ä¸€ä¸ªåŒºé—´æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“æ¯ä¸ªæ•°æ°å¥½å‡ºç°0æ¬¡æˆ–è€…3æ¬¡ï¼Œè¯¢é—®å¥½åŒºé—´çš„ä¸ªæ•°<br>$n\leq 5\times 10^5, 1\leq a_i \leq n$<br>è€ƒè™‘å›ºå®šå·¦ç«¯ç‚¹ä¸ºiï¼Œé‚£ä¹ˆ$a_i$â€‹å‡ºç°0æ¬¡å’Œ3æ¬¡å°±æ˜¯ä¸¤ä¸ªè¿ç»­çš„åŒºé—´ï¼Œæˆ‘ä»¬å¯¹$1-n$çš„æ¯ä¸ªæ•°ç»´æŠ¤å®ƒçš„åˆæ³•åŒºé—´ï¼Œå¦‚æœæ˜¯åˆæ³•çš„å°±è®©è¿™æ®µåŒºé—´çš„æ¯ä¸ªæ•°éƒ½ç­‰äº1ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€é¢—çº¿æ®µæ ‘æ¥ç»´æŠ¤ã€‚ä»åå¾€å‰æšä¸¾å·¦ç«¯ç‚¹ï¼Œå¯¹äº$a_i$â€‹ï¼Œæˆ‘ä»¬å…ˆåˆ é™¤å®ƒä¹‹å‰çš„åˆæ³•åŒºé—´(ä¸¤æ®µåŒºé—´-1)ï¼Œç„¶åå†åŠ ä¸Šå®ƒå½“å‰çš„åˆæ³•åŒºé—´(ä¸¤ç«¯åŒºé—´+1)ï¼Œåªéœ€è¦æŸ¥è¯¢å·¦ç«¯ç‚¹-<br>nä¸­å¤§å°ç­‰äºnçš„å€¼çš„ä¸ªæ•°å³å¯(æ˜¾ç„¶æœ€å¤§å€¼$\leq n$ï¼Œæ‰€ä»¥ç»´æŠ¤æœ€å¤§å€¼ä»¥åŠæœ€å¤§å€¼ä¸ªæ•°å³å¯)<br>$O(n\log n)$<br>è¿™é¢˜è¿˜æœ‰ä¸€ç§æ›´åŠ æ™®é€‚çš„å“ˆå¸Œåšæ³•ï¼Œè€Œä¸”å¤æ‚åº¦æ˜¯$O(n)$çš„ï¼Œå…ˆå’•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, mx, cnt, tag;</span><br><span class="line">  <span class="built_in">seg</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">seg</span>(<span class="type">int</span> _l, <span class="type">int</span> _r) : <span class="built_in">l</span>(_l), <span class="built_in">r</span>(_r), <span class="built_in">mx</span>(<span class="number">0</span>), <span class="built_in">cnt</span>(<span class="number">0</span>), <span class="built_in">tag</span>(<span class="number">0</span>) &#123;&#125;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pull</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].mx = <span class="built_in">max</span>(t[p&lt;&lt;<span class="number">1</span>].mx, t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].mx);</span><br><span class="line">  t[p].cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mx==t[p&lt;&lt;<span class="number">1</span>].mx) t[p].cnt += t[p&lt;&lt;<span class="number">1</span>].cnt;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mx==t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].mx) t[p].cnt += t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].mx += v;</span><br><span class="line">  t[p].tag += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setv</span>(p&lt;&lt;<span class="number">1</span>, t[p].tag); <span class="built_in">setv</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, t[p].tag);</span><br><span class="line">  t[p].tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p] = <span class="built_in">seg</span>(l, r);</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mx = n, t[p].cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">pull</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setv</span>(p, v);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">push</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>, x, y, v);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y, v);</span><br><span class="line">  <span class="built_in">pull</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">chk</span><span class="params">(pii &amp;a, pii b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a.fi==b.fi) a.se += b.se;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(a.fi&lt;b.fi) a = b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pii <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> &#123;t[p].mx, t[p].cnt&#125;;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">push</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>; pii ans = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">chk</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">chk</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; a[i];</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="type">int64_t</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) p[i].<span class="built_in">push_back</span>(n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n; i&gt;=<span class="number">1</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> sz = p[a[i]].<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span>(sz&gt;=<span class="number">4</span>) <span class="built_in">upd</span>(<span class="number">1</span>, p[a[i]][sz<span class="number">-3</span>], p[a[i]][sz<span class="number">-4</span>]<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="type">int</span> suf = p[a[i]][sz<span class="number">-1</span>];</span><br><span class="line">    p[a[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    ++sz;</span><br><span class="line">    <span class="keyword">if</span>(sz&gt;=<span class="number">4</span>) <span class="built_in">upd</span>(<span class="number">1</span>, p[a[i]][sz<span class="number">-3</span>], p[a[i]][sz<span class="number">-4</span>]<span class="number">-1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, i, suf<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">auto</span> cur = <span class="built_in">ask</span>(<span class="number">1</span>, i, n);</span><br><span class="line">    <span class="keyword">if</span>(cur.fi==n) ans += cur.se;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P6800 ã€æ¨¡æ¿ã€‘Chirp-Z Transform</title>
      <link href="/2020/09/13/p6800-mo-ban-chirp-z-transform/"/>
      <url>/2020/09/13/p6800-mo-ban-chirp-z-transform/</url>
      
        <content type="html"><![CDATA[<p>ç»™å‡ºä¸€ä¸ªné¡¹å¤šé¡¹å¼Pï¼Œè¦æ±‚å‡ºåœ¨$c^0,c^1,â€¦,c^{m-1}$å¤„å¤šé¡¹å¼çš„å€¼<br>$n\leq 10^6,m\leq 10^6$</p><h4 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h4><p>ç›´æ¥å¤šç‚¹æ±‚å€¼ä¼št<br>$\sum \limits_{i=0}^{n-1}a_ic^{mi}P(cm)$<br>è€ƒè™‘æŠŠ$mi$æ¢ä¸€ä¸‹<br>$mi = \binom{m+i}{2} - \binom{m}{2} -<br>\binom{i}{2}$<br>$P(c^m) = c^{-\binom{m}{2}}\sum\limits_{i=0}^{n-1}(a_ic^{-\binom{i}{2}})(c^{\binom{m+i}{2}})$<br>å‡æ³•å·ç§¯ï¼ŒæŠŠå‰ä¸€ä¸ªç¿»è½¬åNTTå³å¯<br>æ³¨æ„æŒ‡æ•°ä¸Šçš„å–æ¨¡è¦ç”¨æ‰©å±•æ¬§æ‹‰å®šç†<br>å¦‚æœæŠŠcæ¢æˆ$\omega_n^1$â€‹å³$complex(cos(2\pi/n),sin(2\pi/n))$ï¼Œå°±æ˜¯bluesteinç®—æ³•äº†ï¼Œå¯ä»¥è§£å†³ä»»æ„é•¿åº¦çš„å·ç§¯ï¼Œå°±æ˜¯å¸¸æ•°å¾ˆå¤§ï¼Œå› ä¸ºä¸€æ¬¡DFTå°±ç›¸å½“äºä¸€æ¬¡å¤šé¡¹å¼ä¹˜æ³•ï¼Œå³ä¸‰æ¬¡DFT<br>å°ä¼˜åŒ–ï¼šç”±äºæˆ‘ä»¬åªéœ€è¦å¾—åˆ°nåˆ°n+mé¡¹çš„å€¼ï¼Œæ‰€ä»¥næ¬¡å¤šé¡¹å¼å’Œn+mæ¬¡å¤šé¡¹å¼æˆ‘ä»¬åªéœ€è¦æ±‚åˆ°n+må³å¯ï¼Œè€Œä¸ç”¨æ±‚åˆ°2*n+m</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">6e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> n, c, m, a[N], b[N];</span><br><span class="line"><span class="type">int</span> up, w[N], rev[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  up = <span class="number">1</span>; <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">  <span class="type">int</span> wn = <span class="built_in">fpw</span>(G, mod&gt;&gt;l); w[up&gt;&gt;<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)+<span class="number">1</span>; i&lt;up; i++) w[i] = <span class="number">1ll</span>*w[i<span class="number">-1</span>]*wn%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=(up&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>; i&gt;=<span class="number">1</span>; i--) w[i] = w[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getlen</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1</span>&lt;&lt;(<span class="number">32</span>-__builtin_clz(n)); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> n, <span class="type">int</span> x, <span class="type">int</span> *b)</span> </span>&#123; <span class="keyword">while</span>(n--) *b++ = <span class="number">1ll</span>**a++*x%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">dot</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> *b, <span class="type">int</span> n, <span class="type">int</span> *c)</span> </span>&#123; <span class="keyword">while</span>(n--) *c++ = <span class="number">1ll</span>**a++**b++%mod; &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> tmp[N];</span><br><span class="line">  <span class="type">int</span> u = __builtin_ctz(up/l), t;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) tmp[i] = a[rev[i]&gt;&gt;u];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i^l; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>, d=i&lt;&lt;<span class="number">1</span>; j^l; j+=d)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;i; k++)</span><br><span class="line">        t = tmp[i|j|k]*w[i|k]%mod, tmp[i|j|k] = tmp[j|k]+mod-t, tmp[j|k] += t;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;l; i++) a[i] = tmp[i]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IDFT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">reverse</span>(a+<span class="number">1</span>, a+l); <span class="built_in">DFT</span>(a, l);</span><br><span class="line">  <span class="built_in">mul</span>(a, l, mod-mod/l, a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;c, &amp;m);</span><br><span class="line">  --n, --m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    a[i] = <span class="number">1ll</span>*a[i]*<span class="built_in">fpw</span>(c, (mod<span class="number">-1</span>)<span class="number">-1ll</span>*i*(i<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>))%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n+m; i++) b[i] = <span class="built_in">fpw</span>(c, <span class="number">1ll</span>*i*(i<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>));</span><br><span class="line">  <span class="built_in">init</span>(<span class="number">2</span>*n+m);</span><br><span class="line">  <span class="built_in">reverse</span>(a, a+n+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> l = <span class="built_in">getlen</span>(<span class="number">2</span>*n+m);</span><br><span class="line">  <span class="built_in">DFT</span>(a, l); <span class="built_in">DFT</span>(b, l); <span class="built_in">dot</span>(a, b, l, a); <span class="built_in">IDFT</span>(a, l);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n; i&lt;=n+m; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, <span class="number">1ll</span>*a[i]*<span class="built_in">fpw</span>(c, (mod<span class="number">-1</span>)<span class="number">-1ll</span>*(i-n)*(i-n<span class="number">-1</span>)/<span class="number">2</span>%(mod<span class="number">-1</span>))%mod, <span class="string">&quot; \n&quot;</span>[i==n+m]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gã€Pikachu é—®é¢˜è½¬åŒ–+æ¢æ ¹dp</title>
      <link href="/2020/09/03/gpikachu-wen-ti-zhuan-hua-huan-gen-dp/"/>
      <url>/2020/09/03/gpikachu-wen-ti-zhuan-hua-huan-gen-dp/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€æ£µnä¸ªç‚¹çš„æ ‘ï¼Œå®šä¹‰ä¸€å¼ å®Œå…¨å›¾ï¼Œ$w(u, v) = dis(u, v)$ï¼Œé—®ä½ å„å¯¹èŠ‚ç‚¹é—´çš„æœ€å¤§æµçš„å’Œ<br>$n \leq 10^5$<br>æœ€å¤§æµä¸å¥½æƒ³ï¼Œè½¬åŒ–æˆæœ€å°å‰²ï¼Œé‚£ä¹ˆsåˆ°tçš„æœ€å°å‰²å°±æ˜¯å°†å®Œå…¨å›¾åˆ†æˆä¸¤ä¸ªä¸è¿é€šçš„å®Œå…¨å›¾ï¼Œå…¶ä¸­ä¸€ä¸ªåŒ…å«sï¼Œå¦ä¸€ä¸ªåŒ…å«tï¼Œç„¶åè¦æœ€å¤§åŒ–è¿™ä¸¤ä¸ªå®Œå…¨å›¾å†…éƒ¨çš„è¾¹æƒå’Œã€‚å®¹æ˜“å‘ç°å½“å…¶ä¸­ä¸€ä¸ªç‚¹ä¸ºå­¤ç«‹ç‚¹ï¼Œå¦ä¸€ä¸ªä¸ºn-1ä¸ªç‚¹çš„å®Œå…¨å›¾æ˜¯æœ€ä¼˜ï¼Œç›¸å½“äºå‰²å»å­¤ç«‹ç‚¹ä¸å…¶ä»–n-1ä¸ªç‚¹é—´çš„æ‰€æœ‰è¾¹ã€‚æ‰€ä»¥sä¸té—´çš„æœ€å¤§æµç­‰äºmin(sä¸å…¶ä»–æ‰€æœ‰ç‚¹åœ¨æ ‘ä¸Šçš„è·ç¦»å’Œï¼Œtä¸å…¶ä»–æ‰€æœ‰ç‚¹åœ¨æ ‘ä¸Šçš„è·ç¦»å’Œ)ã€‚<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¢æ ¹dpæ±‚å‡ºæ¯ä¸ªèŠ‚ç‚¹ä¸å…¶ä»–æ‰€æœ‰ç‚¹åœ¨æ ‘ä¸Šçš„è·ç¦»å’Œï¼Œç„¶åä»å¤§åˆ°å°æ’åºåï¼Œæ¯ä¸ªçš„è´¡çŒ®å°±æ˜¯(rank-1)æ¬¡ï¼Œç²—ç•¥ä¼°ç®—å¯ä»¥å‘ç°ç­”æ¡ˆéœ€è¦ç”¨__int128å­˜å‚¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, sz[N];</span><br><span class="line">vector&lt;pii&gt; G[N];</span><br><span class="line">ll dp[N][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  sz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">    sz[u] += sz[v];</span><br><span class="line">    dp[u][<span class="number">0</span>] += dp[v][<span class="number">0</span>] + w*sz[v];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    dp[v][<span class="number">1</span>] = dp[u][<span class="number">0</span>] - dp[v][<span class="number">0</span>] - w*sz[v] + w*(sz[u] - sz[v]) + dp[u][<span class="number">1</span>] + w*(n - sz[u]);</span><br><span class="line">    <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(__int128 x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">int</span> buf[<span class="number">70</span>], tp;</span><br><span class="line">  tp = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(!x) buf[tp = <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    buf[++tp] = x%<span class="number">10</span>;</span><br><span class="line">    x /= <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=tp; i&gt;=<span class="number">1</span>; i--) <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, buf[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> kase)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) G[i].<span class="built_in">clear</span>(), dp[i][<span class="number">0</span>] = dp[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">    G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>); <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="function">vector&lt;ll&gt; <span class="title">alldis</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) alldis[i<span class="number">-1</span>] = dp[i][<span class="number">0</span>] + dp[i][<span class="number">1</span>];</span><br><span class="line">  <span class="built_in">sort</span>(<span class="built_in">begin</span>(alldis), <span class="built_in">end</span>(alldis)); <span class="built_in">reverse</span>(<span class="built_in">begin</span>(alldis), <span class="built_in">end</span>(alldis));</span><br><span class="line">  __int128 ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++) ans += (__int128)i*alldis[i];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Case #%d: &quot;</span>, kase); <span class="built_in">print</span>(ans); <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> kase=<span class="number">1</span>; kase&lt;=_; ++kase) <span class="built_in">solve</span>(kase);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kinetic Tournament</title>
      <link href="/2020/09/03/kinetic-tournament/"/>
      <url>/2020/09/03/kinetic-tournament/</url>
      
        <content type="html"><![CDATA[<p>åˆæ˜¯ä¸€ä¸ªå‡¸å£³é—®é¢˜<br>ç°åœ¨æœ‰næ¡ç›´çº¿ï¼Œç¬¬iæ¡çš„æ–œç‡ä¸º$k_i$â€‹ï¼Œæˆªè·ä¸º$b_i$â€‹ï¼Œå½“å‰xåæ ‡çš„å€¼ä¸º$x_i$â€‹ï¼Œè¦æ±‚æ”¯æŒä»¥ä¸‹æ“ä½œ<br>1.ä¿®æ”¹ç¬¬iæ¡ç›´çº¿çš„æ–œç‡ã€æˆªè·<br>2.è®©$[l, r]$èŒƒå›´å†…æ‰€æœ‰ç›´çº¿çš„xåæ ‡çš„å€¼å¢åŠ delta<br>3.è¯¢é—®$[l, r]$èŒƒå›´å†…æ‰€æœ‰ç›´çº¿çš„yåæ ‡çš„æœ€å¤§å€¼<br><a href="https://codeforces.com/blog/entry/82094">https://codeforces.com/blog/entry/82094</a><br>ç¬¬äºŒä¸ªæ“ä½œå¿…é¡»æ˜¯å¢åŠ ï¼Œä¸èƒ½å‡å°‘<br>å…¶å®å°±æ˜¯ç”¨æ™®é€šçš„çº¿æ®µæ ‘æ¥åšï¼Œå¦‚æœä¸å¸¦ä¿®æ”¹ï¼Œå°±æ˜¯ä¸€æ£µèƒœè€…æ ‘(tournament)ï¼Œè‡ªåº•å‘ä¸Šè¿›è¡Œpushupæ“ä½œï¼Œpç»“ç‚¹å­˜å‚¨çš„æ˜¯å­æ ‘å†…æ‰€æœ‰ç›´çº¿ä¸­yåæ ‡æœ€å¤§çš„é‚£æ¡ï¼Œç¬¬ä¸€ä¸ªæ“ä½œå’Œç¬¬ä¸‰ä¸ªæ“ä½œå°±æ˜¯æ™®é€šçš„çº¿æ®µæ ‘äº†ã€‚<br>å¯¹äºç¬¬äºŒä¸ªæ“ä½œï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªç»“ç‚¹é¢å¤–ç»´æŠ¤ä¸€ä¸ªå«waitçš„å˜é‡ï¼Œè¡¨ç¤º<strong>å¦‚æœå­æ ‘å†…èƒœè€…å‘ç”Ÿå˜åŒ–ï¼Œæœ€å°‘è¦è®©æ•´ä¸ªå­æ ‘çš„xåæ ‡å¢åŠ wait</strong>ï¼Œè¿™ä¸ªä¸œè¥¿å¯ä»¥pushupæ¥ç»´æŠ¤ï¼Œè€ŒåŒºé—´å¢åŠ deltaï¼Œç”¨ä¸€ä¸ªlazytagå³å¯ã€‚ä½†æ˜¯å½“ä¸”ä»…å½“å½“å‰åŒºé—´çš„waitå€¼å¤§äºè¿™ä¸ªå¢é‡deltaæ—¶æˆ‘ä»¬æ‰ç›´æ¥æ•´ä¸ªå­æ ‘ä¿®æ”¹ï¼Œå¦åˆ™ç”±äºèƒœè€…ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­é€’å½’ä¸‹å»ï¼ˆç±»ä¼¼äºsegment beatsï¼Œä¹Ÿæ˜¯ç”¨æ‘Šè¿˜åˆ†æ(<s>ä¸ä¼š</s>)ï¼‰ï¼Œå¤æ‚åº¦å¤§æ¦‚æ˜¯$\lt O(n\log^3n) \ or \approx O(n\log^2n)$<br>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¿™ç©æ„æœ‰å•¥ç”¨<br>ç¬¬ä¸€ä¸ªæ“ä½œå¯ä»¥å½“æˆæ’å…¥å’Œåˆ é™¤ç›´çº¿ï¼Œç¬¬äºŒä¸ªæ“ä½œç›¸å½“äºä¿®æ”¹è¯¢é—®çš„å€¼ï¼Œå¦‚æœè¯¢é—®éå¢æˆ‘ä»¬å¯ä»¥ç¦»çº¿ä¸‹æ¥ï¼Œç¬¬ä¸‰ä¸ªæ“ä½œå°±æ˜¯åŒºé—´å‡¸å£³è¯¢é—®ï¼Œè€Œä¸”æ–œç‡æ˜¯å¦å•è°ƒæ— å…³ç´§è¦ã€‚<br>å¦‚æœç”¨ä¸€èˆ¬çš„CHTï¼Œè¦å®ç°åŒºé—´æŸ¥è¯¢ï¼Œè¿˜è¦åœ¨å¤–é¢å¥—ä¸€ä¸ªfenwicktreeæˆ–è€…æ˜¯segtreeï¼Œå¤æ‚åº¦ä¸Šå¹¶æ²¡æœ‰ä¼˜åŠ¿ï¼Œæ­¤å¤–è¿™ä¸ªä¸œè¥¿è¿˜èƒ½æ”¯æŒåˆ é™¤æ“ä½œï¼Œä¼¼ä¹æœ‰ç‚¹ç”¨ã€‚<br>è€ƒè™‘ä¸€ä¸ªæ ‘ä¸Šçš„æ–œç‡ä¼˜åŒ–ï¼Œæ–œç‡å•è°ƒæˆ‘ä»¬å¯ä»¥ç”¨å¯å›é€€çš„é˜Ÿåˆ—æ¥ç»´æŠ¤å‡¸å£³ï¼Œä½†æ˜¯æœ‰äº†è¿™ä¸ªæˆ‘ä»¬ç›´æ¥æ— è„‘æ ‘å‰–ï¼Œç®¡ä»–æ–œç‡å•ä¸å•è°ƒã€‚<br>ä»¥ä¸Šçº¯å±çŒœæƒ³ï¼Œæœªç»å®è·µã€‚ã€‚</p><h2 id="cf1178-G-The-Awesomest-Vertex"><a class="header-anchor" href="#cf1178-G-The-Awesomest-Vertex">Â¶</a>cf1178 G. The Awesomest Vertex</h2><p>è¿™ä¸ªé—®é¢˜ç›¸å½“äºä¸Šé¢çš„æ”¯æŒ2å’Œ3æ“ä½œçš„ç‰ˆæœ¬ï¼ŒåŒæ—¶æ˜¯å­æ ‘é—®é¢˜ï¼ˆdfsåºå³å¯ï¼‰<br>è¿™è¾¹è¦ç»´æŠ¤çš„æ˜¯$|b_ix + a_ib_i|$çš„æœ€å¤§å€¼ï¼Œç”±äºå¸¦ç»å¯¹å€¼ï¼Œè¦åŒæ—¶ç»´æŠ¤æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼Œæˆ‘ä»¬è€ƒè™‘ç»´æŠ¤$-b_ix - a_ib_i$â€‹çš„æœ€å¤§å€¼å³å¯ã€‚ä¼¼ä¹è¦å»ºä¸¤æ£µçº¿æ®µæ ‘ï¼Œä¸è¿‡è¿™è¾¹ç”¨ä¸€ä¸ªæŠ€å·§ã€‚æˆ‘ä»¬å¼€ä¸€ä¸ª2*nçš„çº¿æ®µæ ‘ï¼ŒæŠŠè¿™ä¸¤æ£µæ ‘åˆèµ·æ¥ï¼Œä¸€é¢—æ”¾åœ¨$2i-1$çš„ä½ç½®ï¼Œä¸€é¢—æ”¾åœ¨$2i$çš„ä½ç½®ï¼Œç„¶åå°±å¯ä»¥å½“æˆä¸€æ£µæ¥æ“ä½œäº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll inf = LLONG_MAX;</span><br><span class="line"><span class="type">int</span> n, q, a[N], b[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="type">int</span> in[N], out[N], num[N], id;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  in[u] = ++id;</span><br><span class="line">  num[id] = u;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    a[v] += a[u]; b[v] += b[u];</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  out[u] = id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line">  ll k, b, x;</span><br><span class="line">  <span class="function">ll <span class="title">eval</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> k*x + b; &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(<span class="type">const</span> Line&amp; oth)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    ll x1 = <span class="built_in">eval</span>(), x2 = oth.<span class="built_in">eval</span>();</span><br><span class="line">    <span class="keyword">if</span>(x1!=x2) <span class="keyword">return</span> x1 &gt; x2;</span><br><span class="line">    <span class="keyword">return</span> k &gt; oth.k;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">ll <span class="title">isect</span><span class="params">(<span class="type">const</span> Line&amp; oth)</span> </span>&#123; <span class="keyword">return</span> (<span class="built_in">eval</span>()-oth.<span class="built_in">eval</span>())/(oth.k-k) + <span class="number">1</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r;</span><br><span class="line">  Line L;</span><br><span class="line">  ll wait, tag;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setv</span><span class="params">(<span class="type">int</span> p, ll add)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].L.x += add;</span><br><span class="line">  t[p].tag += add;</span><br><span class="line">  t[p].wait -= add;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">auto</span> l1 = t[p&lt;&lt;<span class="number">1</span>].L, l2 = t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].L;</span><br><span class="line">  <span class="keyword">if</span>(!l1.<span class="built_in">cmp</span>(l2)) <span class="built_in">swap</span>(l1, l2);</span><br><span class="line">  t[p].L = l1;</span><br><span class="line">  t[p].wait = <span class="built_in">min</span>(t[p&lt;&lt;<span class="number">1</span>].wait, t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].wait);</span><br><span class="line">  <span class="keyword">if</span>(l1.k&lt;l2.k) t[p].wait = <span class="built_in">min</span>(t[p].wait, l1.<span class="built_in">isect</span>(l2));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setv</span>(p&lt;&lt;<span class="number">1</span>, t[p].tag), <span class="built_in">setv</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, t[p].tag);</span><br><span class="line">  t[p].tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].l = l, t[p].r = r, t[p].wait = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x = num[(l+<span class="number">1</span>)/<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">if</span>(l&amp;<span class="number">1</span>) t[p].L = &#123;b[x], <span class="number">1ll</span>*a[x]*b[x], <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">else</span> t[p].L = &#123;-b[x], <span class="number">-1ll</span>*a[x]*b[x], <span class="number">0</span>&#125;;</span><br><span class="line">    t[p].wait = inf;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y, ll add)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y &amp;&amp; t[p].wait&gt;add)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setv</span>(p, add);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>, x, y, add);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y, add);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qry</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> t[p].L.<span class="built_in">eval</span>();</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>; ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) ans = <span class="built_in">max</span>(ans, <span class="built_in">qry</span>(p&lt;&lt;<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) ans = <span class="built_in">max</span>(ans, <span class="built_in">qry</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> fa; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;fa);</span><br><span class="line">    G[fa].<span class="built_in">push_back</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, b+i);</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>*n);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;v);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ll x; <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;x);</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, in[v]*<span class="number">2</span><span class="number">-1</span>, out[v]*<span class="number">2</span>, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">qry</span>(<span class="number">1</span>, in[v]*<span class="number">2</span><span class="number">-1</span>, out[v]*<span class="number">2</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cache friendly</title>
      <link href="/2020/09/02/cache-friendly/"/>
      <url>/2020/09/02/cache-friendly/</url>
      
        <content type="html"><![CDATA[<p>å°½é‡å‡å°‘cache miss<br>ä¿è¯æ—¶ç©ºå±€éƒ¨æ€§ï¼Œå°½é‡è¿ç»­åœ°è®¿å­˜ï¼Œä½¿ç”¨å±€éƒ¨å˜é‡<br>ä½¿ç”¨æŒ‡é’ˆè®¿é—®å¯ä»¥åŠ å¿«é€Ÿåº¦ï¼ˆä»…é™äºå¡å¸¸ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *st = a + <span class="number">1</span>, *ed = a + n + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(st!=ed) <span class="built_in">work</span>(*(st++));</span><br></pre></td></tr></table></figure><ul><li>å¯¹æ ‘è¿›è¡Œæ ‘é“¾å‰–åˆ†åï¼Œå­æ ‘æ˜¯ä¸€ä¸ªè¿ç»­çš„åŒºé—´ï¼Œæ ‘ä¸Šçš„è·¯å¾„ä¹Ÿå¯ä»¥è¢«åˆ’åˆ†æˆlogæ®µè¿ç»­åŒºé—´ã€‚<br>ç„¶ååˆ©ç”¨æ•°æ®ç»“æ„å¯¹è¿™äº›è¿ç»­åŒºé—´è¿›è¡Œæ“ä½œå³å¯ã€‚<br>ä½†æ˜¯æœ‰äº›æ—¶å€™æ•°æ®ç»“æ„è¿™å—ä¸å¥½å†™ï¼Œæˆ–è€…å¸¸æ•°å¾ˆå¤§ï¼Œæ¯”å¦‚è¯´éœ€è¦$O(n\sqrt n \log<br>n)$æ¥ç»´æŠ¤$10^5$ä¸ªèŠ‚ç‚¹çš„æ“ä½œï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¹æ‰€æœ‰è¿ç»­æ®µforå¾ªç¯æš´åŠ›$O(n^2)$ç»´æŠ¤ï¼Œç„¶åæ³¨æ„è®¿é—®çš„è¿ç»­æ€§ï¼Œè¿™æ ·cacheçš„missç‡æ˜¯logçº§åˆ«çš„ï¼Œé€šè¿‡pragmaç­‰é¢„ç¼–è¯‘å‘½ä»¤åŠ é€Ÿä¼šæœ‰ä¸é”™çš„æ•ˆæœ</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;Ofast,no-stack-protector&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC target(<span class="string">&quot;sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,tune=native&quot;</span>)</span></span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•å¯ä»¥ç”¨äºæ ‘ä¸Šdpï¼Œå¦‚æœæ˜¯å­æ ‘dpçš„è¯ç›´æ¥åˆ©ç”¨dfsåºå³å¯<br>å¦‚æœæ˜¯åˆ°æ ¹çš„æ ‘é“¾ä¸Šdpï¼Œé‚£å°±å…ˆæ ‘å‰–ï¼Œç„¶åå¯¹æ¯ä¸ªç‚¹æŠŠåˆ°æ ¹çš„è·¯å¾„åŒ–æˆlogä¸ªè¿ç»­æ®µï¼Œç„¶åæš´åŠ›<br>æˆ‘ä»¬ç”¨ä¸€ä¸ªå±€éƒ¨å˜é‡å­˜å‚¨éœ€è¦æ›´æ–°çš„dp[u]ï¼Œç„¶åç”¨æ¥æ›´æ–°çš„dp[v]å°±æ˜¯è¿ç»­è®¿å­˜çš„ï¼Œå¯ä»¥è¾¾åˆ°ä¸€å®šçš„åŠ é€Ÿæ•ˆæœï¼Œç”¨æŒ‡é’ˆå¯ä»¥ç•¥å¾®åŠ é€Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">updt</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll cur = LLONG_MAX, a = dep[u], b = p[u];</span><br><span class="line">  <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    ll *p=tmpdep+dfn[top[x]]<span class="number">-1</span>, *q = dp+dfn[top[x]]<span class="number">-1</span>, *ped = tmpdep + dfn[x];</span><br><span class="line">    <span class="keyword">while</span>(p!=ped) <span class="built_in">chk</span>(cur, *(++q)+(a-*(++p)*b));</span><br><span class="line">    x = fa[<span class="number">0</span>][top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  ll *p=tmpdep+dfn[x]<span class="number">-1</span>, *ped = tmpdep+dfn[y], *q = dp+dfn[x] - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(p!=ped) <span class="built_in">chk</span>(cur, *(++q)+(a-*(++p)*b));</span><br><span class="line">  dp[dfn[u]] = cur + q[u];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡æµ‹è¯•$10^5$æ¬¡çš„æ•°æ®çº§åˆ«2.5sèƒ½å‡ºç»“æœï¼Œè¿™åœ¨ä¸€äº›æ—¶é™æ¯”è¾ƒå®½æ¾ï¼Œæ­£è§£å¤æ‚åº¦è¦å¤šä¸ªlogæˆ–è€…æ ¹å·çš„æƒ…å†µä¸‹å¯èƒ½å¯ä»¥éª—è¿‡å»ï¼Œè€Œ$2\times 10^5$å°±æ˜¯10så·¦å³æ‰èƒ½å‡ºç»“æœäº†ã€‚</p><ul><li>ç‚¹åˆ†æ²»çš„æ—¶å€™æˆ‘ä»¬è¦å¤„ç†è·¨è¶Šé‡å¿ƒçš„å„éƒ¨åˆ†çš„è´¡çŒ®ï¼Œè¿™éœ€è¦åŒæŒ‡é’ˆæˆ–è€…ä¸€äº›æ•°æ®ç»“æ„æ¥ç»´æŠ¤ï¼ŒåŒæ ·çš„æˆ‘ä»¬æŠŠå®ƒä»¬æ˜ å°„åˆ°è¿ç»­çš„æ•°ç»„æ®µä¸Šï¼Œåœ¨è¿›è¡Œæš´åŠ›ä¹Ÿä¼šæœ‰ä¸€å®šåŠ é€Ÿ</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4072 [SDOI2016]å¾é€” æ¨å¼å­ æ–œç‡ä¼˜åŒ–dp</title>
      <link href="/2020/09/02/p4072-sdoi2016zheng-tu-tui-shi-zi-xie-lu-you-hua-dp/"/>
      <url>/2020/09/02/p4072-sdoi2016zheng-tu-tui-shi-zi-xie-lu-you-hua-dp/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šnæ®µè·¯çš„é•¿åº¦ï¼Œæ¯å¤©å¯ä»¥èµ°è¿ç»­çš„å‡ æ®µè·¯ï¼Œè¦æ±‚ä½ èµ°må¤©ï¼Œå¹¶æœ€å°åŒ–æ¯å¤©èµ°çš„è·¯ç¨‹é•¿åº¦çš„æ–¹å·®$\times m^2$çš„å¤§å°<br>$n \leq 3000,m \leq 3000$</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>æ–¹å·®ï¼š$\frac{1}{m}\sum (x_i - \bar{x})^2m$ = $\frac{1}{m}(\sum x_i^2 + \sum \bar{x}^2 - 2\sum x_i\bar{x}) = \sum x_i$<br>$\frac{1}{m}(\sum (x_i - \bar{x})^2) = m(\sum x_i^2 - \bar{x}\sum x_i)$ = $m\sum x_i^2 - (\sum x_i)^2$<br>å®¹æ˜“å‘ç°åä¸€é¡¹æ˜¯å®šå€¼ï¼Œæ‰€ä»¥åªéœ€è¦æœ€å°åŒ–$\sum x_i^2$â€‹å³å¯<br>$dp_{i,j}$â€‹è¡¨ç¤ºå‰iæ®µè·¯èµ°äº†jå¤©çš„æœ€å°æ–¹å·®<br>$dp_{i,j} = \min \limits_{k&lt;i} \{dp_{k,j-1} + (sum_i-sum_k)^2\}$<br>æ¯æ¬¡è¯¢é—®$sum_i$â€‹å¤„yçš„æœ€å°å€¼ï¼Œç„¶åæ’å…¥ä¸€æ¡æ–œç‡ä¸º$-2sum_i$â€‹ï¼Œæˆªè·ä¸º$sum_i^2 + dp_{i,j-1}$â€‹çš„ç›´çº¿ã€‚æ–œç‡å•è°ƒé€’å‡ï¼Œè¯¢é—®å•è°ƒé€’å¢ï¼ŒåŒç«¯é˜Ÿåˆ—ç»´æŠ¤ä¸‹å‡¸å£³å³å¯<br>é€šè¿‡æ–œç‡ä¼˜åŒ–å°±å¯ä»¥$n^2$é€šè¿‡æœ¬é¢˜</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="type">long</span> <span class="type">double</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, d[N];</span><br><span class="line">ll sum[N], dp[N][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line">  ll k, b;</span><br><span class="line">  <span class="function">ll <span class="title">eval</span><span class="params">(ll x)</span> </span>&#123; <span class="keyword">return</span> k*x + b; &#125;</span><br><span class="line">  <span class="function">db <span class="title">insect</span><span class="params">(Line oth)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">db</span>(b-oth.b)/(oth.k-k); &#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="type">int</span> ql, qr;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, d+i), sum[i] = sum[i<span class="number">-1</span>] + d[i], dp[i][<span class="number">0</span>] = sum[i]*sum[i];</span><br><span class="line">  <span class="type">int</span> p = <span class="number">1</span>;</span><br><span class="line">  ll ans = dp[n][<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> c=<span class="number">2</span>; c&lt;=m; c++, p^=<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    q[ql=qr=<span class="number">1</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span>(ql&lt;qr &amp;&amp; q[ql].<span class="built_in">insect</span>(q[ql+<span class="number">1</span>])&lt;=sum[i]) ++ql;</span><br><span class="line">      dp[i][p] = q[ql].<span class="built_in">eval</span>(sum[i]) + sum[i]*sum[i];</span><br><span class="line">      Line cur = &#123;<span class="number">-2</span>*sum[i], sum[i]*sum[i]+dp[i][p^<span class="number">1</span>]&#125;;</span><br><span class="line">      <span class="keyword">while</span>(ql&lt;qr &amp;&amp; cur.<span class="built_in">insect</span>(q[qr])&lt;=cur.<span class="built_in">insect</span>(q[qr<span class="number">-1</span>])) --qr;</span><br><span class="line">      q[++qr] = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = <span class="built_in">min</span>(ans, dp[n][p]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, m*ans-sum[n]*sum[n]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4655 [CEOI2017]Building Bridges æ–œç‡ä¼˜åŒ–</title>
      <link href="/2020/09/02/p4655-ceoi2017building-bridges-xie-lu-you-hua/"/>
      <url>/2020/09/02/p4655-ceoi2017building-bridges-xie-lu-you-hua/</url>
      
        <content type="html"><![CDATA[<p>æœ‰næ ¹æŸ±å­ï¼Œç¬¬iæ ¹æŸ±å­çš„é«˜åº¦ä¸º$h_i$â€‹ï¼Œè¢«æ‹†é™¤çš„ä»£ä»·ä¸º$w_i$â€‹ï¼Œåœ¨jå’Œiä¸¤æ ¹æŸ±å­é—´æ¶æ¡¥çš„è´¹ç”¨ä¸º$(h_i-h_j)^2 + \sum \limits_{k=j+1}^{i-1} w_k$â€‹ï¼Œé—®è¿æ¥1å’Œnçš„æœ€å°ä»£ä»·</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>$dp_i = \min \limits_{j&lt;i} \{dp_j + (h_i-h_j)^2 + s_{i-1} - s_j\}$ æ­¤å¤„sä¸ºwçš„å‰ç¼€å’Œ<br>æ˜¾ç„¶å¯ä»¥åŒ–ä¸ºæ–œç‡ä¼˜åŒ–çš„å½¢å¼<br>æ¯æ¬¡è¯¢é—®$h_i$â€‹å¤„yçš„æœ€å°å€¼ï¼Œç„¶åæ’å…¥ä¸€æ¡æ–œç‡ä¸º$-2h_i$â€‹ï¼Œæˆªè·ä¸º$h_i^2-s_i+dp_i$â€‹çš„ç›´çº¿ã€‚<br>ç”±äºè¿™é‡Œçš„$h_i$â€‹ä¸å…·å¤‡å•è°ƒæ€§ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨é˜Ÿåˆ—æ¥ç»´æŠ¤ã€‚å¯ä»¥ç”¨å¹³è¡¡æ ‘ã€æè¶…æ ‘æˆ–è€…cdqåˆ†æ²»è§£å†³</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, h[N];</span><br><span class="line">ll w[N], dp[N];</span><br><span class="line"><span class="type">bool</span> Cmp;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">mutable</span> ll k, b, p;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Line&amp; oth) <span class="type">const</span> &#123; <span class="keyword">return</span> Cmp ? p &lt; oth.p : k &lt; oth.k; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ConvecHull</span> : multiset&lt;Line&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> ll inf = LLONG_MAX;</span><br><span class="line">  <span class="function">ll <span class="title">div</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) <span class="keyword">return</span> a&gt;<span class="number">0</span> ? inf : -inf;</span><br><span class="line">    <span class="keyword">return</span> a / b - ((a ^ b) &lt; <span class="number">0</span> &amp;&amp; a % b);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">isect</span><span class="params">(iterator x, iterator y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (y == <span class="built_in">end</span>()) &#123; x-&gt;p = inf; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (x-&gt;k == y-&gt;k) x-&gt;p = x-&gt;b &gt; y-&gt;b ? inf : -inf;</span><br><span class="line">    <span class="keyword">else</span> x-&gt;p = <span class="built_in">div</span>((y-&gt;b - x-&gt;b), (x-&gt;k - y-&gt;k));</span><br><span class="line">    <span class="keyword">return</span> x-&gt;p &gt;= y-&gt;p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(ll k, ll b)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> z = <span class="built_in">insert</span>(&#123;k, b, <span class="number">0</span>&#125;), y = z++, x = y;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isect</span>(y, z)) z = <span class="built_in">erase</span>(z);</span><br><span class="line">    <span class="keyword">if</span> (x != <span class="built_in">begin</span>() &amp;&amp; <span class="built_in">isect</span>(--x, y)) <span class="built_in">isect</span>(x, y = <span class="built_in">erase</span>(y));</span><br><span class="line">    <span class="keyword">while</span> ((y = x) != <span class="built_in">begin</span>() &amp;&amp; (--x)-&gt;p &gt;= y-&gt;p) <span class="built_in">isect</span>(x, <span class="built_in">erase</span>(y));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">ll <span class="title">qry</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    Cmp = <span class="number">1</span>; <span class="keyword">auto</span> l = *<span class="built_in">lower_bound</span>(&#123;<span class="number">0</span>, <span class="number">0</span>, x&#125;); Cmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> l.k * x + l.b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;ch;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, h+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, w+i), w[i] += w[i<span class="number">-1</span>];</span><br><span class="line">  ch.<span class="built_in">add</span>(<span class="number">2</span>*h[<span class="number">1</span>], <span class="number">-1ll</span>*h[<span class="number">1</span>]*h[<span class="number">1</span>]+w[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    dp[i] = -ch.<span class="built_in">qry</span>(h[i]) + w[i<span class="number">-1</span>] + <span class="number">1ll</span>*h[i]*h[i];</span><br><span class="line">    ch.<span class="built_in">add</span>(<span class="number">2</span>*h[i], <span class="number">-1ll</span>*h[i]*h[i]+w[i]-dp[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, dp[n]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codeforces1396C</title>
      <link href="/2020/08/31/codeforces1396c/"/>
      <url>/2020/08/31/codeforces1396c/</url>
      
        <content type="html"><![CDATA[<p>æœ‰nä¸ªå…³å¡ï¼Œæ¯å…³æœ‰$a_i$â€‹ä¸ªå°æ€ª(1hp)å’Œ1ä¸ªboss(2hp)ï¼Œåœ¨ç¬¬iå…³å¯ä»¥è½¬ç§»åˆ°i-1å’Œi+1å…³ï¼Œéœ€è¦èŠ±è´¹dï¼Œæœ‰ä¸‰ç§æ­¦å™¨</p><ul><li>èŠ±è´¹r1ï¼Œè®©ä¸€åªæ€ªç‰©-1hp</li><li>èŠ±è´¹r2ï¼Œè®©æ‰€æœ‰æ€ªç‰©-1hp</li><li>èŠ±è´¹r3ï¼Œç§’æ€ä¸€åªæ€ªç‰©</li></ul><p>å…¶ä¸­ç¬¬ä¸€å’Œç¬¬ä¸‰ç§æ­¦å™¨å¿…é¡»åœ¨æ²¡æœ‰å°æ€ªçš„æƒ…å†µä¸‹æ‰èƒ½æ”»å‡»bossï¼Œå¹¶ä¸”å¦‚æœæ²¡æœ‰ç§’æ‰bossï¼ˆè¿˜å‰©1æ»´è¡€ï¼‰ï¼Œåˆ™ä¼šè¢«å¼ºåˆ¶è½¬ç§»åˆ°ç›¸é‚»çš„å…³å¡ï¼ˆèŠ±è´¹dï¼‰ï¼Œé—®ä½ æ€æ­»æ‰€æœ‰æ€ªç‰©çš„æœ€å°èŠ±è´¹<br>$n \leq 10^6,1\leq r1 \leq r2 \leq r3 \leq 10^9$</p><h3 id="è§£æ³•"><a class="header-anchor" href="#è§£æ³•">Â¶</a>è§£æ³•</h3><p>åœ¨æŸä¸€å…³ä¸­æˆ‘ä»¬è¦ä¹ˆç”¨r3ç›´æ¥ç§’æ‰bossé¿å…å¼ºåˆ¶è½¬ç§»(å…ˆç”¨r1æ¸…å°æ€ª)ï¼Œè¦ä¹ˆå°±å…ˆè®©bosså°‘ä¸€æ»´è¡€(ç”¨r1æ¸…å°æ€ªå†ç‚¹ä¸€ä¸‹bossæˆ–è€…ä¸€ä¸‹r2)è½¬ç§»èµ°ï¼Œä¹‹åå†å›æ¥ç”¨ä¸€ä¸‹r1ç‚¹æ­»bossã€‚<br>æ‰€ä»¥æ¯å…³å…¶å®åªæœ‰ä¸¤ç§é€‰æ‹©ï¼Œä¸€æ˜¯ç”¨r1æ€æ‰å°æ€ªåç”¨r3ç§’æ‰boss(cost1=a[i]*r1+r3)ï¼ŒäºŒæ˜¯ç”¨r2æˆ–è€…(a[i]*r1+r1)è®©bosså‰©1hpç„¶åå¼ºåˆ¶è½¬ç§»èµ°å›æ¥åå†èŠ±r1æ€æ­»boss(cost2=min(a[i]*r1+r1,r2))ï¼Œç„¶åå°±å¯ä»¥dpäº†<br>$dp_{i,0}$â€‹è¡¨ç¤ºç¬¬iå…³å·²ç»è§£å†³çš„æœ€å°è´¹ç”¨ï¼Œ$dp_{i,1}$â€‹è¡¨ç¤ºç¬¬iå…³çš„bossè¿˜å‰©1hpç„¶åè¿˜æ²¡å¼ºåˆ¶è·³è½¬çš„æœ€å°è´¹ç”¨<br>$dp_{0,0}=min(dp_{i-1,0}+d+min(cost1,2*d+cost2+r1),dp_{i-1,1}+3*d+r1+min(cost1,cost2+r1))$<br>å¦‚æœä¸Šä¸€å…³å·²ç»æ¶ˆç­($dp_{i-1,0}$â€‹)ï¼Œè¿™ä¸€å…³è¦ä¹ˆå°±cost1ï¼Œè¦ä¹ˆå°±cost2ç„¶åæ¥å›è·³ä¸¤ä¸ªdï¼Œå†ä¸€ä¸ªr1è¡¥æ­»<br>å¦‚æœä¸Šä¸€å…³è¿˜æœ‰1hpï¼Œé‚£ä¹ˆè¿™å…³æ¶ˆç­åå†å›å»è¡¥æ­»ä¸Šä¸€å…³å†å›æ¥<br>$dp_{i,1} = dp_{i-1,0}+d+cost2$<br>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µå°±æ˜¯åœ¨å€’æ•°ç¬¬äºŒå…³å¼ºåˆ¶è½¬ç§»åˆ°æœ€åä¸€å…³ï¼Œç„¶åæ¶ˆç­æœ€åä¸€å…³å†è½¬ç§»åˆ°å€’æ•°ç¬¬äºŒå…³è¡¥æ­»ä¹‹åç»“æŸã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, a[N];</span><br><span class="line">ll r1, r2, r3, d, dp[N][<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%lld%lld%lld%lld&quot;</span>, &amp;n, &amp;r1, &amp;r2, &amp;r3, &amp;d);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">  dp[<span class="number">0</span>][<span class="number">0</span>] = -d;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    ll c1 = <span class="built_in">min</span>(a[i]*r1+r1, r2), c2 = a[i]*r1 + r3;</span><br><span class="line">    dp[i][<span class="number">0</span>] = <span class="built_in">min</span>(dp[i<span class="number">-1</span>][<span class="number">0</span>]+d+<span class="built_in">min</span>(c2, <span class="number">2</span>*d+c1+r1), dp[i<span class="number">-1</span>][<span class="number">1</span>]+<span class="number">3</span>*d+r1+<span class="built_in">min</span>(r1+c1, c2));</span><br><span class="line">    dp[i][<span class="number">1</span>] = dp[i<span class="number">-1</span>][<span class="number">0</span>]+d+c1;</span><br><span class="line">  &#125;</span><br><span class="line">  ll ans = <span class="built_in">min</span>(dp[n][<span class="number">0</span>], dp[n<span class="number">-2</span>][<span class="number">0</span>]+d+a[n]*r1+r3+r1+<span class="number">2</span>*d+<span class="built_in">min</span>(a[n<span class="number">-1</span>]*r1+r1, r2));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‡¸åŒ…</title>
      <link href="/2020/08/30/convex-hull-trick/"/>
      <url>/2020/08/30/convex-hull-trick/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¡ç®—å‡ ä½•ä¸­çš„å‡¸åŒ…"><a class="header-anchor" href="#è®¡ç®—å‡ ä½•ä¸­çš„å‡¸åŒ…">Â¶</a>è®¡ç®—å‡ ä½•ä¸­çš„å‡¸åŒ…</h2><p>ç»™å®šnä¸ªç‚¹æ±‚å‡¸åŒ…<br>åˆ©ç”¨andrewç®—æ³•ï¼ˆæ¯”grahamå¥½å†™ä¸€ç‚¹è€Œä¸”å¸¸æ•°å°ï¼‰<br>å°†æ‰€æœ‰ç‚¹æŒ‰ç…§xä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œyä¸ºç¬¬äºŒå…³é”®å­—æ’åº<br>ç„¶åä»å‰å¾€åç”¨æ ˆç»´æŠ¤å‡ºä¸‹å‡¸å£³ï¼Œå†ä»åå¾€å‰ç”¨æ ˆç»´æŠ¤å‡ºä¸Šå‡¸å£³å³å¯<br>è€ƒè™‘å½“å‰æ ˆä¸­çš„æœ€åä¸¤ä¸ªç‚¹pï¼Œqï¼Œç°åœ¨åŠ å…¥ä¸€ä¸ªç‚¹oï¼Œé‚£ä¹ˆåªè¦çœ‹q-på’Œo-pè¿™ä¸¤æ¡ç›´çº¿çš„å·¦å³å…³ç³»å³å¯ï¼Œç”¨å‰ç§¯åˆ¤æ–­<br>å¤šè¾¹å½¢ç”¨vectorå­˜å‚¨ï¼Œå‡¸åŒ…åˆ†ä¸ºä¸¥æ ¼å‡¸åŒ…å’Œéä¸¥æ ¼å‡¸åŒ…ï¼ˆä¸€èˆ¬éƒ½æ˜¯å»ºæˆä¸¥æ ¼çš„ï¼‰ï¼ŒåŒºåˆ«å°±æ˜¯å¦‚æœå‰ç§¯ç­‰äº0çš„æ—¶å€™ä¸å†popï¼Œé‚£ä¹ˆå°±æ˜¯éä¸¥æ ¼çš„ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¤šç‚¹å…±çº¿çš„æƒ…å†µ<br>å¦å¤–è¦æ³¨æ„å¤šè¾¹å½¢ç‚¹æ•°å°‘äº3çš„æƒ…å†µ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Polygon <span class="title">ConvexHull</span><span class="params">(Polygon&amp; s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n = s.<span class="built_in">size</span>(), sz = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">sort</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>());</span><br><span class="line">  <span class="function">Polygon <span class="title">res</span><span class="params">(<span class="number">2</span>*n)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(sz&gt;<span class="number">0</span> &amp;&amp; <span class="built_in">crossop</span>(res[sz<span class="number">-1</span>], res[sz], s[i])&lt;=<span class="number">0</span>) --sz;</span><br><span class="line">    res[++sz] = s[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> pre = sz;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-2</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(sz&gt;pre &amp;&amp; <span class="built_in">crossop</span>(res[sz<span class="number">-1</span>], res[sz], s[i])&lt;=<span class="number">0</span>) --sz;</span><br><span class="line">    res[++sz] = s[i];</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="built_in">resize</span>(sz);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤šè¾¹å½¢é¢ç§¯(ç›¸é‚»ç‚¹å‰ç§¯æ±‚å’Œï¼Œé€†æ—¶é’ˆä¸ºæ­£ï¼Œé¡ºæ—¶é’ˆä¸ºè´Ÿ)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">getarea</span><span class="params">(Polygon&amp; s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  db ans = <span class="number">0</span>; <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) ans += (s[i]^s[(i+<span class="number">1</span>)%n]);</span><br><span class="line">  <span class="keyword">return</span> ans/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡¸åŒ…å‘¨é•¿(ç›¸é‚»ç‚¹è·ç¦»æ±‚å’Œå³å¯)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">getcir</span><span class="params">(Polygon&amp; s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">db ans = <span class="number">0</span>; <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) ans += s[i].<span class="built_in">dis</span>(s[(i+<span class="number">1</span>)%n]);</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡¸åŒ…ç›´å¾„(æ—‹è½¬å¡å£³ï¼Œå¯¹äºæ¯æ¡è¾¹(i,i+1)ï¼Œæ‰¾åˆ°è·ç¦»è¿™æ¡è¾¹æœ€è¿œçš„ç‚¹jï¼Œå®¹æ˜“å‘ç°å…·æœ‰å•è°ƒæ€§ï¼Œå¯ä»¥ç”¨åŒæŒ‡é’ˆå®ç°)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">db <span class="title">ConvexDiameter</span><span class="params">(Polygon&amp; s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">if</span>(n==<span class="number">2</span>) <span class="keyword">return</span> s[<span class="number">0</span>].<span class="built_in">dis</span>(s[<span class="number">1</span>]);</span><br><span class="line">  <span class="type">int</span> j = <span class="number">2</span>; db ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cross</span>(s[i], s[i+<span class="number">1</span>], s[j])&lt;<span class="built_in">cross</span>(s[i], s[i+<span class="number">1</span>], s[(j+<span class="number">1</span>)%n])) j = (j+<span class="number">1</span>)%n;</span><br><span class="line">    ans = <span class="built_in">max</span>(ans, <span class="built_in">max</span>(s[i].<span class="built_in">dis</span>(s[j]), s[i+<span class="number">1</span>].<span class="built_in">dis</span>(s[j])));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡¸åŒ…çš„é—µå¯å¤«æ–¯åŸºå’Œè¿˜æ˜¯å‡¸åŒ…(å®šä¹‰å°±æ˜¯ä¸€ä¸ªå‡¸åŒ…ä¸­çš„ç‚¹æŒ‰ç…§åŸç‚¹å’Œå¦ä¸€ä¸ªå‡¸åŒ…ä¸­çš„ç‚¹å½¢æˆçš„å‘é‡ç§»åŠ¨åå½¢æˆçš„å›¾å½¢)<br>é—µå¯å¤«æ–¯åŸºå’Œåçš„å‡¸åŒ…çš„è¾¹æ˜¯ç”±åŸæ¥çš„ä¸¤ä¸ªå‡¸åŒ…ä¸Šçš„è¾¹æ„æˆçš„ï¼Œæ‰€ä»¥å½’å¹¶æ’åºä¸€ä¸‹å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Polygon <span class="title">Minkowski</span><span class="params">(Polygon&amp; a, Polygon&amp; b)</span> <span class="comment">//å¯èƒ½æœ‰ä¸‰ç‚¹å…±çº¿ï¼Œå¯ä»¥å†æ±‚ä¸€æ¬¡å‡¸åŒ…</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Polygon c;</span><br><span class="line">  <span class="type">int</span> n = a.<span class="built_in">size</span>(), m = b.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, j=<span class="number">0</span>; i&lt;n||j&lt;m; )</span><br><span class="line">  &#123;</span><br><span class="line">    c.<span class="built_in">push_back</span>(a[i%n]+b[j%m]);</span><br><span class="line">    <span class="keyword">if</span>(i&gt;=n) ++j;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(j&gt;=m) ++i;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">sgn</span>((a[(i+<span class="number">1</span>)%n]-a[i])^(b[(j+<span class="number">1</span>)%m]-b[j]))&gt;=<span class="number">0</span>) ++i;</span><br><span class="line">    <span class="keyword">else</span> ++j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’ä¸­çš„å‡¸åŒ…"><a class="header-anchor" href="#åŠ¨æ€è§„åˆ’ä¸­çš„å‡¸åŒ…">Â¶</a>åŠ¨æ€è§„åˆ’ä¸­çš„å‡¸åŒ…</h2><p>ä¸€èˆ¬ç”¨äºæ–œç‡ä¼˜åŒ–ï¼Œè€ƒè™‘ä¸€ä¸ªdpè½¬ç§»å¼$f_i = \max \limits_{k&lt;i} \{ f_k + a_ib_k\}$<br>å¯ä»¥æŠŠåé¢çš„ä¸œè¥¿çœ‹æˆ$b_ka_i + f_k$â€‹ï¼Œå³$kx+b$çš„ç›´çº¿å½¢å¼ï¼Œç„¶åæˆ‘ä»¬å°±æ˜¯è¦å¯¹æ¯ä¸ª$a_i$â€‹æ‰¾åˆ°ä¹‹å‰æ‰€æœ‰ç›´çº¿ä¸­åœ¨è¯¥ç‚¹å¤„çš„æœ€å¤§å€¼(åˆ«äººçš„æ–œç‡ä¼˜åŒ–å¯èƒ½æ˜¯æŒ‰ç…§æ–œç‡çš„ï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿™æ ·å­æ›´ç›´è§‚ä¸€ç‚¹ï¼Œä¹Ÿä¸éœ€è¦ç§»é¡¹ï¼Œå¦‚æœäº†è§£æè¶…æ ‘ï¼Œå¾ˆå®¹æ˜“å‘ç°è¿™å®Œå…¨å¯ä»¥ç”¨æè¶…æ ‘æ¥åš)<br>å½“ç„¶ç”¨æè¶…æ ‘æ¥åšä¼¼ä¹æœ‰ç‚¹å¤§æå°ç”¨ï¼Œå®¹æ˜“å‘ç°ç­”æ¡ˆä¸€å®šæ˜¯åœ¨æ‰€æœ‰ç›´çº¿å½¢æˆçš„ä¸Šå‡¸å£³ä¸Šï¼Œè€Œä¸”æ¯æ¡ç›´çº¿ä¼šæœ‰ä¸€ä¸ªè´¡çŒ®èŒƒå›´</p><ul><li><p>å¦‚æœæ’å…¥çš„ç›´çº¿æ–œç‡å•è°ƒ($b_k$â€‹)ï¼Œä¸”è¯¢é—®ç‚¹ä¹Ÿå•è°ƒ($a_i$â€‹)<br>è¿™æ—¶å€™æˆ‘ä»¬åªéœ€è¦ç”¨åŒç«¯é˜Ÿåˆ—æ¥ç»´æŠ¤ä¸Šå‡¸å£³å³å¯ï¼Œåœ¨é˜Ÿå°¾ä¸æ–­æ’å…¥ç›´çº¿å¹¶ä¸”ç»´æŠ¤å‡¸å£³ï¼Œåœ¨é˜Ÿé¦–åŠæ—¶æ’æ‰å·²ç»ç»“æŸè´¡çŒ®äº†çš„ç‚¹ï¼Œå¯¹äºå½“å‰è¯¢é—®çš„æœ€ä¼˜ç‚¹å°±æ˜¯é˜Ÿé¦–</p></li><li><p>å¦‚æœæ’å…¥çš„ç›´çº¿æ–œç‡å•è°ƒ($b_k$â€‹)ï¼Œä½†è¯¢é—®ç‚¹ä¸å•è°ƒ($a_i$â€‹)<br>æ–œç‡å•è°ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ä»ç„¶å¯ä»¥çº¿æ€§åœ°ç»´æŠ¤ä¸Šå‡¸å£³ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½pop_frontæ¥ç»´æŠ¤æœ€ä¼˜ç‚¹ï¼Œå› ä¸ºæœ€ä¼˜ç‚¹æ²¡æœ‰å•è°ƒæ€§äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å‡¸å£³ä¸ŠäºŒåˆ†ï¼Œæ‰¾åˆ°æœ€ä¼˜å†³ç­–ç‚¹</p></li><li><p>å¦‚æœæ’å…¥çš„ç›´çº¿æ–œç‡ä¸å•è°ƒ($b_k$â€‹)ï¼Œä¸”è¯¢é—®ç‚¹ä¹Ÿä¸å•è°ƒ($a_i$â€‹)<br>ä¸€ç§æ–¹æ³•å°±æ˜¯æè¶…æ ‘äº†ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨å¹³è¡¡æ ‘æ¥ç»´æŠ¤ï¼Œä»¥ä¸‹ç»™å‡ºä¸€ä»½setå®ç°çš„ä»£ç ï¼ˆå¾ˆå¥½ç”¨ï¼Œå¦‚æœæ’å…¥çš„æ˜¯ç›´çº¿å°±ç”¨è¿™ä¸ªï¼Œå¦‚æœæ˜¯çº¿æ®µçš„è¯å°±åªèƒ½æè¶…æ ‘äº†ï¼‰<br>kå’Œbåˆ†åˆ«æ˜¯æ–œç‡å’Œæˆªè·ï¼Œpç±»ä¼¼äºæœ€ä¼˜å†³ç­–ç‚¹ï¼ˆä¸ç”¨ç®¡ï¼‰<br>divå‡½æ•°æ˜¯ä¸€ä¸ªä¸‹å–æ•´å‡½æ•°ï¼Œè´Ÿæ•°çš„æ—¶å€™çš„å–æ•´å’Œæ­£æ•°ä¼šæœ‰åŒºåˆ«<br>isectæ˜¯æ±‚ä¸¤æ¡ç›´çº¿çš„äº¤ç‚¹ï¼Œç„¶åè¿›è¡Œåˆ¤æ–­ï¼ˆç±»ä¼¼äºæè¶…æ ‘ä¸­çš„åˆ¤æ–­ï¼‰<br>ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦add(k,b)æ¥æ·»åŠ ä¸€æ¡ç›´çº¿ï¼Œqry(x)æ¥è¯¢é—®åœ¨xç‚¹å¤„çš„æœ€å¤§å€¼<br>å½“ç„¶å¦‚æœè¦æ±‚æœ€å°å€¼ï¼Œåªéœ€è¦add(-k,-b)ï¼Œç„¶å-qry(x)å°±æ˜¯ç­”æ¡ˆäº†</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> Cmp;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Line</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">mutable</span> ll k, b, p;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Line&amp; oth) <span class="type">const</span> &#123; <span class="keyword">return</span> Cmp ? p &lt; oth.p : k &lt; oth.k; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ConvecHull</span> : multiset&lt;Line&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">static</span> <span class="type">const</span> ll inf = LLONG_MAX;</span><br><span class="line">  <span class="function">ll <span class="title">div</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) <span class="keyword">return</span> a&gt;<span class="number">0</span> ? inf : -inf;</span><br><span class="line">    <span class="keyword">return</span> a / b - ((a ^ b) &lt; <span class="number">0</span> &amp;&amp; a % b);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">isect</span><span class="params">(iterator x, iterator y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (y == <span class="built_in">end</span>()) &#123; x-&gt;p = inf; <span class="keyword">return</span> <span class="literal">false</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (x-&gt;k == y-&gt;k) x-&gt;p = x-&gt;b &gt; y-&gt;b ? inf : -inf;</span><br><span class="line">    <span class="keyword">else</span> x-&gt;p = <span class="built_in">div</span>((y-&gt;b - x-&gt;b), (x-&gt;k - y-&gt;k));</span><br><span class="line">    <span class="keyword">return</span> x-&gt;p &gt;= y-&gt;p;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(ll k, ll b)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> z = <span class="built_in">insert</span>(&#123;k, b, <span class="number">0</span>&#125;), y = z++, x = y;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isect</span>(y, z)) z = <span class="built_in">erase</span>(z);</span><br><span class="line">    <span class="keyword">if</span> (x != <span class="built_in">begin</span>() &amp;&amp; <span class="built_in">isect</span>(--x, y)) <span class="built_in">isect</span>(x, y = <span class="built_in">erase</span>(y));</span><br><span class="line">    <span class="keyword">while</span> ((y = x) != <span class="built_in">begin</span>() &amp;&amp; (--x)-&gt;p &gt;= y-&gt;p) <span class="built_in">isect</span>(x, <span class="built_in">erase</span>(y));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">ll <span class="title">qry</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    Cmp = <span class="number">1</span>; <span class="keyword">auto</span> l = *<span class="built_in">lower_bound</span>(&#123;<span class="number">0</span>, <span class="number">0</span>, x&#125;); Cmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> l.k * x + l.b;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¦‚ä½•åˆ é™¤ä¸€æ¡ç›´çº¿"><a class="header-anchor" href="#å¦‚ä½•åˆ é™¤ä¸€æ¡ç›´çº¿">Â¶</a>å¦‚ä½•åˆ é™¤ä¸€æ¡ç›´çº¿</h3><p>åˆ é™¤æ“ä½œä¸å¥½åšï¼ˆç±»ä¼¼å¹¶æŸ¥é›†ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç¦»çº¿åæŠŠæ¯æ¡ç›´çº¿çš„å­˜æ´»æ—¶é—´å¡åˆ°çº¿æ®µæ ‘ä¸Šçš„logä¸ªèŠ‚ç‚¹ä¸Šï¼ˆå³çº¿æ®µæ ‘åˆ†æ²»ï¼‰ï¼Œå¯¹æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªå‡¸å£³ï¼Œç„¶åå¯¹äºä¸€ä¸ªè¯¢é—®å°±æ˜¯çº¿æ®µæ ‘ä¸ŠåŒ…å«è¯¥ç‚¹çš„èŠ‚ç‚¹çš„å‡¸å£³ä¸Šçš„æœ€å¤§å€¼çš„æœ€å¤§å€¼<br>ç»™å‡ºæ‰€æœ‰ç›´çº¿å†å»ºå‡¸å£³ï¼Œå¯ä»¥åˆ©ç”¨andrewæ¥å®ç°ï¼ˆæ’åºåï¼Œä»å‰å¾€åç”¨æ ˆç»´æŠ¤ï¼‰ï¼Œè¯¢é—®æœ€å€¼ä¸€æ¬¡äºŒåˆ†å³å¯ï¼ˆæ²¡å¿…è¦ä¸‰åˆ†ï¼‰</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gym101482G è·ç¦»è½¬åŒ– ä¸‰åˆ† æ€ç»´</title>
      <link href="/2020/08/29/gym101482g-ju-chi-zhuan-hua-san-fen-si-wei/"/>
      <url>/2020/08/29/gym101482g-ju-chi-zhuan-hua-san-fen-si-wei/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šäºŒç»´å¹³é¢ä¸Šnä¸ªç‚¹çš„åæ ‡ï¼Œè®©ä½ æ‰¾ä¸€ä¸ªç‚¹ï¼Œæœ€å°åŒ–æ‰€æœ‰ç‚¹åˆ°è¿™ä¸ªç‚¹çš„æ›¼å“ˆé¡¿è·ç¦»ä¹‹å’Œï¼Œå¹¶ä¸”è¦æ±‚æ¯ä¸ªç‚¹åˆ°è¯¥ç‚¹çš„æ›¼å“ˆé¡¿è·ç¦»ä¸èƒ½è¶…è¿‡d<br>$n \leq 100000,d \leq 2\times 10^9$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å¦‚æœæ²¡æœ‰dçš„é™åˆ¶ï¼Œç­”æ¡ˆå°±æ˜¯è¿™nä¸ªç‚¹xåæ ‡çš„ä¸­ä½æ•°å’Œyåæ ‡çš„ä¸­ä½æ•°ã€‚<br>åŠ ä¸Šdçš„é™åˆ¶åï¼Œå¯¹äºæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªè±å½¢çš„é™åˆ¶åŒºåŸŸï¼Œæ‰€ä»¥æœ€åçš„å¯è¡ŒåŸŸå°±æ˜¯è¿™nä¸ªç‚¹é™åˆ¶çš„è±å½¢åŒºåŸŸçš„å¹¶ï¼Œè±å½¢ä¸å¥½å¤„ç†ï¼Œæˆ‘ä»¬è½¬åŒ–æˆåˆ‡æ¯”é›ªå¤«è·ç¦»åå°±å˜æˆäº†æ­£æ–¹å½¢ï¼Œç»´æŠ¤Lï¼ŒRï¼ŒDï¼ŒUï¼Œé‚£ä¹ˆä¸¤ä¸ªæ­£æ–¹å½¢çš„å¹¶å°±æ˜¯max(L)ï¼ŒminÂ®ï¼Œmax(D)ï¼Œmin(U)ã€‚æ›¼å“ˆé¡¿è·ç¦»ä¸­xã€yä¸¤ç»´æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œæ¯ä¸€ç»´åˆæ˜¯ä¸€ä¸ªå‡¹å‡½æ•°ï¼Œæ‰€ä»¥åœ¨å¯è¡ŒåŸŸèŒƒå›´å†…ä¸‰åˆ†å¥—ä¸‰åˆ†å³å¯ã€‚<br>ç»™å®šä¸€ä¸ªç‚¹çš„åæ ‡ï¼Œè®¡ç®—nä¸ªç‚¹åˆ°è¿™ä¸ªç‚¹çš„æ›¼å“ˆé¡¿è·ç¦»å’Œå¯ä»¥é€šè¿‡äºŒåˆ†$O(\log n)$è§£å†³ã€‚<br>(x,y) -&gt; (x+y,x-y) åŸåæ ‡ç³»çš„æ›¼å“ˆé¡¿è·ç¦»-&gt;æ–°åæ ‡ç³»çš„åˆ‡æ¯”é›ªå¤«è·ç¦»<br>(x,y) -&gt; ((x+y)/2,(x-y)/2) åŸåæ ‡ç³»çš„åˆ‡æ¯”é›ªå¤«è·ç¦»-&gt;æ–°åæ ‡ç³»çš„æ›¼å“ˆé¡¿è·ç¦»<br>æˆ‘ä»¬ç»´æŠ¤çš„LRDUæ˜¯åœ¨åˆ‡æ¯”é›ªå¤«åæ ‡ç³»ä¸­ï¼Œè€Œä¸‰åˆ†çš„èŒƒå›´æ˜¯åœ¨æ›¼å“ˆé¡¿åæ ‡ä¸­çš„ï¼Œæ‰€ä»¥xçš„ä¸‰åˆ†èŒƒå›´åº”è¯¥æ˜¯[(L+D)/2,(R+U)/2]ï¼Œç¡®å®šäº†xåï¼Œ$L\leq<br>x+y \leq R,D\leq x-y \leq U$ï¼Œé‚£ä¹ˆyçš„ä¸‰åˆ†èŒƒå›´å°±æ˜¯[max(L-x,x-U),min(R-x,x-D)]äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, x[N], y[N], d;</span><br><span class="line">ll U, D, L, R, prex[N], prey[N];</span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> p = <span class="built_in">upper_bound</span>(x+<span class="number">1</span>, x+n+<span class="number">1</span>, a) - x - <span class="number">1</span>, q = <span class="built_in">upper_bound</span>(y+<span class="number">1</span>, y+n+<span class="number">1</span>, b) - y - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> a*p - prex[p] + b*q - prey[q] - (n-p)*a + (prex[n] - prex[p]) - (n-q)*b + (prey[n] - prey[q]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">cal</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll l = <span class="built_in">max</span>(x-U, L-x), r = <span class="built_in">min</span>(x-D, R-x), ans = LINF;</span><br><span class="line">  <span class="keyword">while</span>(l&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    ll mid = (<span class="number">2</span>*l+r)/<span class="number">3</span>, mmid = (<span class="number">2</span>*r+l+<span class="number">2</span>)/<span class="number">3</span>;</span><br><span class="line">    ll fmid = <span class="built_in">f</span>(x, mid), fmmid = <span class="built_in">f</span>(x, mmid);</span><br><span class="line">    <span class="keyword">if</span>(fmid&lt;=fmmid)</span><br><span class="line">    &#123;</span><br><span class="line">      ans = <span class="built_in">min</span>(ans, fmid);</span><br><span class="line">      r = mmid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ans = <span class="built_in">min</span>(ans, fmmid);</span><br><span class="line">      l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, x+i, y+i);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;d);</span><br><span class="line">    U = LINF, D = -LINF, L = -LINF, R = LINF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      ll cx = x[i] + y[i], cy = x[i] - y[i];</span><br><span class="line">      U = <span class="built_in">min</span>(U, cy+d);</span><br><span class="line">      D = <span class="built_in">max</span>(D, cy-d);</span><br><span class="line">      L = <span class="built_in">max</span>(L, cx-d);</span><br><span class="line">      R = <span class="built_in">min</span>(R, cx+d);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(D&gt;U||L&gt;R)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;impossible&quot;</span>);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(x+<span class="number">1</span>, x+n+<span class="number">1</span>); <span class="built_in">sort</span>(y+<span class="number">1</span>, y+n+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) prex[i] = prex[i<span class="number">-1</span>] + x[i], prey[i] = prey[i<span class="number">-1</span>] + y[i];</span><br><span class="line">    ll l = (L+D)/<span class="number">2</span>, r = (R+U)/<span class="number">2</span>, ans = LINF;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;=r)</span><br><span class="line">    &#123;</span><br><span class="line">      ll mid = (<span class="number">2</span>*l+r)/<span class="number">3</span>, mmid = (<span class="number">2</span>*r+l+<span class="number">2</span>)/<span class="number">3</span>;</span><br><span class="line">      ll fmid = <span class="built_in">cal</span>(mid), fmmid = <span class="built_in">cal</span>(mmid);</span><br><span class="line">      <span class="keyword">if</span>(fmid&lt;=fmmid)</span><br><span class="line">      &#123;</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, fmid);</span><br><span class="line">        r = mmid - <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, fmmid);</span><br><span class="line">        l = mid + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>min_25ç­›</title>
      <link href="/2020/08/28/min_25-shai/"/>
      <url>/2020/08/28/min_25-shai/</url>
      
        <content type="html"><![CDATA[<p>å½“f$f(i)$æ˜¯ä¸€ä¸ªç§¯æ€§å‡½æ•°ï¼Œä¸”$f(p)$æ˜¯ä¸€ä¸ªå…³äºpçš„ä½é˜¶å¤šé¡¹å¼ï¼Œ$f(p^k)$æ˜¯ä¸€ä¸ªå®¹æ˜“è®¡ç®—çš„å¼å­ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨è¯¥äºšçº¿æ€§ç­›ï¼Œå¿«é€Ÿç®—å‡º$\sum_{i=1}^n<br>f(i)$ï¼Œ$n \leq 10^{11}$</p><h3 id="ç¬¬ä¸€æ­¥"><a class="header-anchor" href="#ç¬¬ä¸€æ­¥">Â¶</a>ç¬¬ä¸€æ­¥</h3><p>åˆ©ç”¨å¦ä¸€ä¸ªå‡½æ•°$g(n,j)$ï¼Œå¿«é€Ÿè®¡ç®—å‡ºfåœ¨è´¨æ•°å¤„çš„å‰ç¼€å’Œ</p><p>$g(n, j) = \sum \limits_{i=1}^n [i \ is \ prime || minp &gt; p_j] i^k$</p><p>è¡¨ç¤º$\leq n$ä¸­çš„æ‰€æœ‰è´¨æ•°ä»¥åŠæœ€å°è´¨å› å­<strong>å¤§äº</strong>ç¬¬jå°è´¨æ•°$p_j$â€‹çš„æ‰€æœ‰æ•°çš„kæ¬¡æ–¹å’Œï¼Œå› ä¸ºf(p)æ˜¯ä¸€ä¸ªå…³äºpçš„å¤šé¡¹å¼ï¼Œè¿™æ ·æˆ‘ä»¬æŠŠè¿™ä¸ªå¤šé¡¹å¼æ‹†æˆå•é¡¹å¼ï¼Œå†å–ä¸åŒçš„kï¼Œè€Œå½“$p_j$â€‹ç­‰äºæœ€åä¸€ä¸ªå°äºç­‰äº$\sqrt nâ€‹$çš„è´¨å› å­æ—¶ï¼Œ$g(n, j)$å°±è¡¨ç¤ºå°äºç­‰äºnçš„æ‰€æœ‰è´¨æ•°çš„kæ¬¡æ–¹å’Œäº†ã€‚<br>ä¸€ä¸ªæ•°çš„æœ€å°è´¨å› å­ä¸€å®šæ˜¯$\leq \sqrt n$â€‹çš„<br>è€ƒè™‘ä»$g(n, j-1)$è½¬ç§»åˆ°$g(n, j)$æ—¶ï¼Œåªéœ€è¦å»æ‰æœ€å°è´¨å› å­$=p_j$â€‹çš„æ‰€æœ‰åˆæ•°å³å¯</p><p>$g(n, j) = g(n, j-1) -<br>p_j^k(g(\frac{n}{p_j}, j-1) - g(p_{j-1}, j-1))$</p><p>å…¶ä¸­$g(p_{j-1}, j-1)$è¡¨ç¤ºå‰$j-1$ä¸ªè´¨æ•°çš„kæ¬¡æ–¹å’Œï¼Œå¯ä»¥åœ¨çº¿æ€§ç­›çš„æ—¶å€™é¢„å¤„ç†å‡ºæ¥<br>åœ¨è½¬ç§»çš„æ—¶å€™æˆ‘ä»¬åªéœ€è¦ç”¨åˆ°$\lfloor \dfrac{n}{x} \rfloor$å¤„çš„å–å€¼ï¼Œè€Œè¿™ç§å€¼çš„ä¸ªæ•°æ˜¯$O(\sqrt n)$çº§åˆ«çš„ï¼Œå¯ä»¥åˆ©ç”¨ä¸€ä¸ªid1æ•°ç»„å’Œä¸€ä¸ªid2æ•°ç»„æ˜ å°„ä¸€ä¸‹ï¼Œå¯¹äº$\leq \sqrt n$â€‹çš„æ•°ï¼Œå­˜åœ¨id1é‡Œï¼Œå¯¹äºå…¶ä»–æ•°å­˜åœ¨id2ä¸­</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ll w[M], g1[M], g2[M];</span><br><span class="line"><span class="type">int</span> id1[M], id2[M];</span><br><span class="line"><span class="keyword">auto</span> id = [&amp;](ll x) &#123; <span class="keyword">return</span> x&lt;=B ? id1[x] : id2[n/x]; &#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(ll _n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> sz = <span class="number">0</span>;</span><br><span class="line">  n = _n, B = <span class="built_in">sqrt</span>(n) + <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">getprime</span>(B);</span><br><span class="line">  <span class="keyword">for</span>(ll l=<span class="number">1</span>, r, v; l&lt;=n; l=r+<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    v = n/l, r = n/v;</span><br><span class="line">    w[++sz] = v; g1[sz] = <span class="built_in">prex1</span>(v); g2[sz] = <span class="built_in">prex2</span>(v);</span><br><span class="line">    <span class="keyword">if</span>(v&lt;=B) id1[v] = sz; <span class="keyword">else</span> id2[r] = sz;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=pc; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=sz&amp;&amp;<span class="number">1ll</span>*pr[i]*pr[i]&lt;=w[j]; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> t = <span class="built_in">id</span>(w[j]/pr[i]);</span><br><span class="line">      g1[j] = ((g1[j] - (g1[t] - sp1[i<span class="number">-1</span>])*<span class="built_in">x1</span>(pr[i]))%mod + mod)%mod;</span><br><span class="line">      g2[j] = ((g2[j] - (g2[t] - sp2[i<span class="number">-1</span>])*<span class="built_in">x2</span>(pr[i]))%mod + mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸€æ­¥æˆ‘ä»¬å°±å¯ä»¥æ±‚fåœ¨è´¨æ•°å¤„çš„å‰ç¼€å’Œäº†ï¼Œå¦‚æœè¦å¿«é€Ÿç»Ÿè®¡è´¨æ•°ä¸ªæ•°ï¼Œç­”æ¡ˆå°±æ˜¯$g_{id(n)}$â€‹</p><h3 id="ç¬¬äºŒæ­¥"><a class="header-anchor" href="#ç¬¬äºŒæ­¥">Â¶</a>ç¬¬äºŒæ­¥</h3><p>åŒæ ·çš„ï¼Œè®¾$S(n,k)$è¡¨ç¤ºæ±‚æ‰€æœ‰è´¨å› å­å¤§äº$p_k$â€‹çš„æ•°(å¤§äº$p_k$â€‹çš„è´¨æ•°ä¹Ÿç®—)çš„å‡½æ•°fä¹‹å’Œï¼Œç­”æ¡ˆå°±æ˜¯$S(n,0)$</p><p>$S(n,x) = g(n) - sp_x + \sum\limits_{p_k^e \leq n \land k&gt;x} f(p_k^e)S(\frac{n}{p_k^e} + [e \neq 1])$</p><p>å…¶ä¸­$g(n)-sp_x$â€‹è¡¨ç¤ºå¤§äº$p_k$â€‹çš„è´¨æ•°çš„å‡½æ•°fä¹‹å’Œï¼Œè¿™åœ¨ç¬¬ä¸€æ­¥ä¸­å·²ç»é¢„å¤„ç†å‡ºæ¥ï¼Œå†æšä¸¾åˆæ•°ä¸­æœ€å°è´¨å› å­çš„å¤§å°ä»¥åŠå¹‚æ¬¡ï¼Œé€’å½’å¤„ç†å³å¯ï¼Œæ³¨æ„æˆ‘ä»¬åœ¨æ‰€æœ‰è®¡ç®—ä¸­éƒ½æ˜¯ä¸ç»Ÿè®¡1å¤„çš„ç­”æ¡ˆçš„ï¼Œæ‰€ä»¥å½“$e\gt 1$æ—¶ï¼Œè¦é¢å¤–ç®—ä¸Š$f(p_k^e)$)å¤„çš„å€¼</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">go</span><span class="params">(ll x, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(pr[k]&gt;=x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> t = <span class="built_in">id</span>(x); ll ans = (<span class="built_in">f</span>(g1[t]-sp1[k], g2[t]-sp2[k])%mod + mod)%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=k+<span class="number">1</span>; i&lt;=pc&amp;&amp;<span class="number">1ll</span>*pr[i]*pr[i]&lt;=x; i++)</span><br><span class="line">    <span class="keyword">for</span>(ll pp=pr[i], e=<span class="number">1</span>; pp&lt;=x; e++, pp=pp*pr[i])</span><br><span class="line">      ans = (ans + <span class="built_in">fp</span>(pp%mod)*(<span class="built_in">go</span>(x/pp, i)+(e!=<span class="number">1</span>)))%mod;</span><br><span class="line">  <span class="keyword">return</span> (ans+mod)%mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åçš„ç­”æ¡ˆå°±æ˜¯go(n, 0)+f(1)äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gym102501H Pseudo-Random Number Generator å¾ªç¯èŠ‚</title>
      <link href="/2020/08/27/gym102501h-pseudo-random-number-generator-xun-huan-jie/"/>
      <url>/2020/08/27/gym102501h-pseudo-random-number-generator-xun-huan-jie/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ•°åˆ—çš„é€’æ¨æ–¹å¼ï¼Œæ±‚å…¶å‰né¡¹ä¸­å¶æ•°çš„ä¸ªæ•°<br>$M=1ull&lt;&lt;40$<br>$s0=0x600DCAFE$<br>$s_{n+1} = (s_n + (s_n &gt;&gt; 20) + 12345)%M$<br>$n \lt 2^{63}$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å› ä¸ºè¦æ¨¡Mï¼Œæ‰€ä»¥çŒœæƒ³æœ‰å¾ªç¯èŠ‚<br>æ‰¾å¾ªç¯èŠ‚çš„æ–¹å¼æ˜¯ç”¨é“¾è¡¨çš„åˆ¤ç¯ç®—æ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰<br>å¿«æ…¢æŒ‡é’ˆåŒæ—¶ä½äºèµ·ç‚¹ï¼Œç„¶åå¿«æŒ‡é’ˆä¸€æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆä¸€æ¬¡èµ°ä¸€æ­¥ï¼Œè‹¥ä¸¤è€…ç›¸é‡è¯´æ˜æœ‰ç¯ï¼Œæ­¤æ—¶è®©ä¸€ä¸ªæŒ‡é’ˆä»èµ·ç‚¹å¼€å§‹ï¼Œä¸€ä¸ªæŒ‡é’ˆä»ç›¸é‡ç‚¹å¼€å§‹ï¼Œä¸€æ¬¡å„èµ°ä¸€æ­¥ï¼Œå½“ä¸¤è€…ç›¸é‡ï¼Œè¯¥ç‚¹å°±æ˜¯å…¥ç¯ç‚¹<br>ä»¥ä¸‹ä»£ç è¿”å›å…¥ç¯ç‚¹</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ull <span class="title">findloop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ull fst = <span class="number">0x600DCAFE</span>, slw = <span class="number">0x600DCAFE</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    slw = <span class="built_in">nxt</span>(slw);</span><br><span class="line">    fst = <span class="built_in">nxt</span>(<span class="built_in">nxt</span>(fst));</span><br><span class="line">    <span class="keyword">if</span>(fst==slw) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  slw = <span class="number">0x600DCAFE</span>;</span><br><span class="line">  <span class="keyword">while</span>(slw!=fst) slw = <span class="built_in">nxt</span>(slw), fst = <span class="built_in">nxt</span>(fst);</span><br><span class="line">  <span class="keyword">return</span> slw;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çŸ¥é“å…¥ç¯ç‚¹åï¼Œè®©ä¸€ä¸ªæŒ‡é’ˆåœ¨èµ·ç‚¹èµ°è‡³è¯¥ç‚¹çš„æ­¥æ•°å°±æ˜¯å¾ªç¯èŠ‚å¼€å§‹çš„ä½ç½®</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ull x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ull s = <span class="number">0x600DCAFE</span>; ll len = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(s!=x) len++, s = <span class="built_in">nxt</span>(s);</span><br><span class="line">  <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®©ä¸€ä¸ªæŒ‡é’ˆä»å…¥ç¯ç‚¹ä¸‹ä¸€ä¸ªå¼€å§‹å†èµ°è‡³å…¥ç¯ç‚¹çš„æ­¥æ•°+1å°±æ˜¯å¾ªç¯èŠ‚çš„é•¿åº¦ï¼ˆç¯é•¿ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">g</span><span class="params">(ull x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ull s = <span class="built_in">nxt</span>(x); ll len = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(s!=x) len++, s = <span class="built_in">nxt</span>(s);</span><br><span class="line">  <span class="keyword">return</span> len;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœæ˜¯st = 350125310, loop = 182129209<br>è¿™æ ·è¿˜æ˜¯è¿‡ä¸äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åˆ†æ®µæ‰“è¡¨ï¼Œå°†å‰sté¡¹æ¯éš”1e6ä¸ªæ•°è®°å½•ä¸€ä¸‹å‰ç¼€ç­”æ¡ˆï¼Œå¾ªç¯èŠ‚ä¹Ÿæ¯éš”1e6ä¸ªæ•°è®°å½•ä¸€ä¸‹å‰ç¼€ç­”æ¡ˆï¼Œæ­¤å¤–è¿˜è¦è®°å½•ä¸€ä¸‹è¯¥ç‚¹å¯¹åº”å¤„çš„æ•°åˆ—çš„å–å€¼ã€‚<br>è¿™æ ·å¯¹äºæ•´å—æˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—åˆ°ç­”æ¡ˆï¼Œè€Œåé¢ä¸å®Œæ•´çš„å—å†æš´åŠ›ä¸€ä¸‹å³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p5488 å·®åˆ†ä¸å‰ç¼€å’Œ</title>
      <link href="/2020/08/25/p5488-chai-fen-yu-qian-zhui-he-2/"/>
      <url>/2020/08/25/p5488-chai-fen-yu-qian-zhui-he-2/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>å¿«é€Ÿæ±‚ä¸€ä¸ªæ•°åˆ—açš„ké˜¶å·®åˆ†æˆ–è€…ké˜¶å‰ç¼€å’Œ<br>$n \leq 10^5,k\leq 10^{2333},mod=1004535809$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å°†æ•°åˆ—açœ‹æˆOGF:$F(x) = \sum \limits_{i=0}^{\infty}a_ix^i$<br>ä½œä¸€æ¬¡å‰ç¼€å’Œç›¸å½“äºä¹˜ä»¥$\sum \limits_{i=0}^{\infty} x^i =\dfrac{1}{1-x}$<br>ä½œä¸€æ¬¡å·®åˆ†ç›¸å½“äºä¹˜ä»¥$(1-x)$<br>åˆ©ç”¨äºŒé¡¹å¼å®šç†ï¼š<br>$\dfrac{1}{(1-x)^k} =<br>(1-x)^{-k} = \sum \limits_{i=0}^{\infty} \dfrac{(-k)^{\underline{i}}}{i!}<br>(-x)^i = \sum \limits_{i=0}^{\infty} \dfrac{(k+i-1)^{\underline{i}}}{i!}<br>x^i$<br>çº¿æ€§é€’æ¨å‡ºå‰né¡¹çš„ç³»æ•°ï¼Œç„¶åå’Œaä½œä¸€æ¬¡å·ç§¯å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, mod = <span class="number">1004535809</span>, gen = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> n, k, t, a[N], b[N], inv[N];</span><br><span class="line"><span class="type">int</span> up, l, rev[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">read</span><span class="params">(<span class="type">int</span> &amp;k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) c = <span class="built_in">getchar</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) k = (<span class="number">1ll</span>*k*<span class="number">10</span> + c - <span class="number">48</span>)%mod, c = <span class="built_in">getchar</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  up = <span class="number">1</span>, l = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(up&lt;=n) up &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>)|((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">NTT</span><span class="params">(<span class="type">int</span> *a, <span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) <span class="keyword">if</span>(i&lt;rev[i]) <span class="built_in">swap</span>(a[i], a[rev[i]]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;up; i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> gn = <span class="built_in">powmod</span>(gen, (mod<span class="number">-1</span>)/(i&lt;&lt;<span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">-1</span>) gn = <span class="built_in">powmod</span>(gn, mod<span class="number">-2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;up; j+=(i&lt;&lt;<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>,g=<span class="number">1</span>; k&lt;i; k++,g=<span class="number">1ll</span>*g*gn%mod)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x = a[j+k], y = <span class="number">1ll</span>*g*a[j+k+i]%mod;</span><br><span class="line">      a[j+k] = (x+y)%mod, a[j+k+i] = (x-y+mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(op==<span class="number">-1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> invup = <span class="built_in">powmod</span>(up, mod<span class="number">-2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) a[i] = <span class="number">1ll</span>*a[i]*invup%mod;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = <span class="number">1ll</span>*(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">  <span class="built_in">read</span>(k);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">  b[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(t) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) b[i] = (<span class="number">-1ll</span>*b[i<span class="number">-1</span>]*(k-i+<span class="number">1</span>)%mod*inv[i]%mod+mod)%mod;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) b[i] = <span class="number">1ll</span>*b[i<span class="number">-1</span>]*(k+i<span class="number">-1</span>)%mod*inv[i]%mod;</span><br><span class="line">  <span class="built_in">init</span>(<span class="number">2</span>*n<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">NTT</span>(a, <span class="number">1</span>); <span class="built_in">NTT</span>(b, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;up; i++) a[i] = <span class="number">1ll</span>*a[i]*b[i]%mod;</span><br><span class="line">  <span class="built_in">NTT</span>(a, <span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, a[i], <span class="string">&quot; \n&quot;</span>[i==n<span class="number">-1</span>]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨æ°çŸ©é˜µ(æ¨è¡¨ï¼‰</title>
      <link href="/2020/08/25/yang-shi-ju-zhen-yang-biao/"/>
      <url>/2020/08/25/yang-shi-ju-zhen-yang-biao/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¨å›¾"><a class="header-anchor" href="#æ¨å›¾">Â¶</a>æ¨å›¾</h2><p>å¯¹äºnçš„ä¸€ä¸ªåˆ’åˆ†$\lambda=(\lambda_1 \geq \lambda_2 \ldots) \vdash n$ï¼Œæ¨å›¾ç¬¬$i$è¡Œæœ‰$\lambda_i$â€‹ä¸ªæ–¹å—</p><h2 id="æ ‡å‡†æ¨è¡¨"><a class="header-anchor" href="#æ ‡å‡†æ¨è¡¨">Â¶</a>æ ‡å‡†æ¨è¡¨</h2><p>å°†1-nè¿™nä¸ªæ•°å¡«å…¥ä¸€ä¸ªæ¨å›¾$\lambda$çš„æ¯ä¸€ä¸ªæ–¹å—ä¸­ï¼Œä½¿å¾—ä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³æ•°å­—éƒ½é€’å¢</p><h2 id="è¿‘ä¼¼æ¨è¡¨"><a class="header-anchor" href="#è¿‘ä¼¼æ¨è¡¨">Â¶</a>è¿‘ä¼¼æ¨è¡¨</h2><p>å°†nä¸ªä¸åŒçš„æ•°å­—å¡«å…¥æ¨å›¾ä¸­<br>å­˜åœ¨ä¸€ç§æ’å…¥ç®—æ³•RSKï¼Œä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œæ¯æ¬¡æ›¿æ¢å½“å‰è¡Œç¬¬ä¸€ä¸ªå¤§äºè‡ªå·±çš„æ•°ï¼ˆå¦‚æœæœ‰ç›¸åŒæ•°å­—å°±æ›¿æ¢ç¬¬ä¸€ä¸ªå¤§äºç­‰äºè‡ªå·±çš„æ•°ï¼‰ï¼Œå¹¶å°†æ›¿æ¢çš„æ•°å»æ’å…¥ä¸‹ä¸€è¡Œï¼Œè‹¥æ‰¾ä¸åˆ°è¿™æ ·ä¸€ä¸ªæ•°ï¼Œåˆ™å°†è¯¥æ•°æ’å…¥åˆ°è¯¥è¡Œæœ«å°¾å¹¶ç»“æŸ</p><h2 id="é’©å­å®šç†"><a class="header-anchor" href="#é’©å­å®šç†">Â¶</a>é’©å­å®šç†</h2><p>$h_{i,j}$â€‹å®šä¹‰ä¸º(i,j)è¿™ä¸ªæ ¼å­ä¸‹é¢çš„æ ¼å­æ•°+å³è¾¹çš„æ ¼å­æ•°+1<br>å¯¹äº$\lambda \vdash n$ï¼Œæœ‰$f^\lambda = \dfrac{n!}{\prod h_{i,j}}$è¡¨ç¤º$\lambda$å¯¹åº”çš„æ¨å›¾çš„å¡«æ³•</p><h2 id="Robinsonâ€“Schensted-correspondence"><a class="header-anchor" href="#Robinsonâ€“Schensted-correspondence">Â¶</a>Robinsonâ€“Schensted correspondence</h2><p>ä¸€ä¸ª1åˆ°nä¸ªæ•°çš„æ’åˆ—å’Œä¸€å¯¹ç›¸åŒå½¢çŠ¶çš„æ ‡å‡†æ¨è¡¨ä¸€ä¸€å¯¹åº”<br>$\sum \limits_{\lambda \vdash n} (f^\lambda)^2$</p><h2 id="nä¸ªå…ƒç´ çš„æ¨æ°çŸ©é˜µçš„ä¸ªæ•°"><a class="header-anchor" href="#nä¸ªå…ƒç´ çš„æ¨æ°çŸ©é˜µçš„ä¸ªæ•°">Â¶</a>nä¸ªå…ƒç´ çš„æ¨æ°çŸ©é˜µçš„ä¸ªæ•°</h2><p>$f_n = f_{n-1} + (n-1)f_{n-2}$â€‹</p><h2 id="æ¨è¡¨ä¸LIS"><a class="header-anchor" href="#æ¨è¡¨ä¸LIS">Â¶</a>æ¨è¡¨ä¸LIS</h2><p>å°†ä¸€ä¸ªæ’åˆ—æŒ‰åºç”¨RSKç®—æ³•æ’å…¥åˆ°æ¨è¡¨ä¸­ï¼Œåˆ™æ¨è¡¨ç¬¬ä¸€è¡Œçš„é•¿åº¦ç­‰äºå…¶LISé•¿åº¦ï¼ˆæ„å»ºçš„æ¨è¡¨ä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³é€’å¢ï¼‰<br>å°†æ¨è¡¨çš„æ¯”è¾ƒæ–¹å¼å–å($\lt$å˜$\geq$,$gt$å˜$\leq$)ï¼Œæ‰€å¾—æ¨è¡¨çš„å½¢çŠ¶ä¸ºåŸæ¨è¡¨çš„è½¬ç½®(ä»…å½¢çŠ¶è€Œè¨€)<br>æ¨è¡¨ç¬¬ä¸€åˆ—çš„é•¿åº¦ç­‰äºæœ€é•¿ä¸ä¸Šå‡å­åºåˆ—é•¿åº¦(è€ƒè™‘è½¬ç½®)<br>æ¨è¡¨å‰kåˆ—çš„é•¿åº¦å’Œç­‰äºLIS$\leq k$çš„k-LISçš„é•¿åº¦(åˆ©ç”¨Dilworthå®šç†ï¼Œç­‰ä»·äºåˆ’åˆ†å‡ºkä¸ªä¸ç›¸äº¤çš„æœ€é•¿ä¸ä¸Šå‡å­åºåˆ—)</p><h2 id="P3774-CTSC2017-æœ€é•¿ä¸Šå‡å­åºåˆ—"><a class="header-anchor" href="#P3774-CTSC2017-æœ€é•¿ä¸Šå‡å­åºåˆ—">Â¶</a>P3774 [CTSC2017]æœ€é•¿ä¸Šå‡å­åºåˆ—</h2><p>ç»™å®šä¸€ä¸ªé•¿ä¸ºnçš„åºåˆ—aï¼Œqæ¬¡è¯¢é—®açš„æŸä¸ªå‰ç¼€çš„æœ€é•¿k-LISçš„é•¿åº¦<br>$n\leq 50000, q \leq 200000$<br>å¯¹äºæ¯ä¸ªè¯¢é—®çš„ç­”æ¡ˆå°±æ˜¯å°†açš„è¿™ä¸ªå‰ç¼€ä¾æ¬¡æ’å…¥æ¨è¡¨åï¼Œå‰kåˆ—é•¿åº¦çš„å’Œ<br>è€ƒè™‘ç¦»çº¿è¯¢é—®ååŠ¨æ€ç»´æŠ¤å‰kåˆ—é•¿åº¦å’Œ<br>æ¯æ¬¡æ’å…¥çš„å¤æ‚åº¦æ˜¯$O(n\log n)$çš„<br>æˆ‘ä»¬å¯ä»¥åªç»´æŠ¤æ¨è¡¨çš„å‰$\sqrt n$â€‹è¡Œï¼Œç„¶ååè½¬æ¯”è¾ƒæ–¹å¼ï¼Œå†ç»´æŠ¤è¿™ä¸ªæ¨è¡¨çš„è½¬ç½®çš„å‰$\sqrt n$â€‹è¡Œ(ç­‰ä»·äºç»´æŠ¤äº†åŸæ¨è¡¨çš„å‰$\sqrt n$â€‹åˆ—ï¼Œå½“è¿™ä¸€åˆ—çš„é•¿åº¦è¶…è¿‡$\sqrt n$â€‹æ—¶ï¼Œè¡¨æ˜è¿™ä¸ªå…ƒç´ åœ¨åŸæ¨è¡¨ä¸­æ²¡æœ‰ç»´æŠ¤åˆ°ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œç»´æŠ¤å³å¯)ï¼Œæ˜¾ç„¶æ¯ä¸ªå…ƒç´ çš„è¡Œæˆ–åˆ—çš„ä¸‹æ ‡è‡³å°‘æœ‰ä¸€ä¸ª$\leq \sqrt n$â€‹ï¼Œæ‰€ä»¥è¿™æ ·æ˜¯æ­£ç¡®çš„<br>å¤æ‚åº¦ä¸º$O(n\sqrt n \log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, M = <span class="number">255</span>;</span><br><span class="line"><span class="type">int</span> n, qq, blo, a[N], c[N], ans[<span class="number">4</span>*N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; YT[M], YT2[M];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qry</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> m, k, idx;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> qry&amp; oth) &#123; <span class="keyword">return</span> m &lt; oth.m; &#125;</span><br><span class="line">&#125;q[<span class="number">4</span>*N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) c[i] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += c[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, x=v; i&lt;blo; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(YT[i].<span class="built_in">empty</span>() || YT[i].<span class="built_in">back</span>()&lt;x)</span><br><span class="line">    &#123;</span><br><span class="line">      YT[i].<span class="built_in">push_back</span>(x);</span><br><span class="line">      <span class="built_in">upd</span>(YT[i].<span class="built_in">size</span>(), <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">swap</span>(YT[i][<span class="built_in">lower_bound</span>(YT[i].<span class="built_in">begin</span>(), YT[i].<span class="built_in">end</span>(), x)-YT[i].<span class="built_in">begin</span>()], x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add2</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, x=v; i&lt;blo; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(YT2[i].<span class="built_in">empty</span>() || YT2[i].<span class="built_in">back</span>()&gt;=x)</span><br><span class="line">    &#123;</span><br><span class="line">      YT2[i].<span class="built_in">push_back</span>(x);</span><br><span class="line">      <span class="keyword">if</span>((<span class="type">int</span>)YT2[i].<span class="built_in">size</span>()&gt;=blo) <span class="built_in">upd</span>(i, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">swap</span>(YT2[i][<span class="built_in">upper_bound</span>(YT2[i].<span class="built_in">begin</span>(), YT2[i].<span class="built_in">end</span>(), x, <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;())-YT2[i].<span class="built_in">begin</span>()], x);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;qq);</span><br><span class="line">  blo = <span class="built_in">sqrt</span>(n) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=qq; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;q[i].m, &amp;q[i].k), q[i].idx = i;</span><br><span class="line">  <span class="built_in">sort</span>(q+<span class="number">1</span>, q+qq+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> pre = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=qq; )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = i;</span><br><span class="line">    <span class="keyword">while</span>(pre&lt;=q[i].m) <span class="built_in">add</span>(a[pre]), <span class="built_in">add2</span>(a[pre]), pre++;</span><br><span class="line">    <span class="keyword">while</span>(j&lt;=qq &amp;&amp; q[j].m==q[i].m)</span><br><span class="line">    &#123;</span><br><span class="line">      ans[q[j].idx] = <span class="built_in">ask</span>(q[j].k);</span><br><span class="line">      j++;</span><br><span class="line">    &#125;</span><br><span class="line">    i = j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=qq; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="P4484-BJWC2018-æœ€é•¿ä¸Šå‡å­åºåˆ—"><a class="header-anchor" href="#P4484-BJWC2018-æœ€é•¿ä¸Šå‡å­åºåˆ—">Â¶</a>P4484 [BJWC2018]æœ€é•¿ä¸Šå‡å­åºåˆ—</h2><p>æ±‚é•¿åº¦ä¸ºnçš„éšæœºæ’åˆ—çš„LISçš„é•¿åº¦çš„æœŸæœ›<br>$n \leq 28$<br><s>æš´åŠ›è·‘å‰å‡ ä¸ªç„¶åoeis</s><br>æˆ‘ä»¬åªéœ€è¦æšä¸¾nçš„æ‰€æœ‰æ•´æ•°åˆ’åˆ†$\lambda$ï¼Œç„¶ååˆ©ç”¨é’©å­å…¬å¼è®¡ç®—å‡ºç›¸åº”çš„$f^\lambda$ï¼Œé‚£ä¹ˆæ‰€æœ‰æ’åˆ—çš„LISé•¿åº¦çš„å’Œæ˜¯$\sum<br>\limits_{\lambda \vdash n} (f^\lambda)^2 \lambda_1$â€‹ï¼Œå†é™¤ä»¥æ’åˆ—æ•°$n!$å³å¯<br>nçš„æ•´æ•°åˆ’åˆ†ä¸ªæ•°$p(n) \approx \frac{1}{4n\sqrt 3}exp(\pi<br>\sqrt{\frac{2n}{3}})$<br>å¤æ‚åº¦$O(p(n))$ï¼Œå¤§æ¦‚èƒ½è·‘$\leq 63$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, N = <span class="number">30</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">ll inv[N], ans;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%mod;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!x)</span><br><span class="line">  &#123;</span><br><span class="line">    ll cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) cur = cur*i%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;y; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=a[i]; j++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> R = a[i] - j, D = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=i; k&lt;y; k++)</span><br><span class="line">          <span class="keyword">if</span>(a[k]&gt;=j) D++;</span><br><span class="line">        cur = cur*inv[R+D]%mod;</span><br><span class="line">      &#125;</span><br><span class="line">    ans = (ans + cur*cur%mod*a[<span class="number">1</span>]%mod)%mod;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=x; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(y!=<span class="number">1</span> &amp;&amp; i&gt;a[y<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    a[y] = i;</span><br><span class="line">    <span class="built_in">dfs</span>(x-i, y+<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) inv[i] = <span class="built_in">powmod</span>(i, mod<span class="number">-2</span>);</span><br><span class="line">  <span class="built_in">dfs</span>(n, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) ans = ans*inv[i]%mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ±‚ä¸ç›¸äº¤çš„LIS"><a class="header-anchor" href="#æ±‚ä¸ç›¸äº¤çš„LIS">Â¶</a>æ±‚ä¸ç›¸äº¤çš„LIS</h2><p>è€ƒè™‘$dp_{i,j}$â€‹è¡¨ç¤ºç¬¬ä¸€ä¸ªLISçš„æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼ä¸ºiï¼Œç¬¬äºŒä¸ªLISçš„æœ€åä¸€ä¸ªå…ƒç´ çš„å€¼ä¸ºjï¼Œæœ´ç´ è½¬ç§»çš„å¤æ‚åº¦æ˜¯$O(n^3)$ï¼Œåˆ©ç”¨æ ‘çŠ¶æ•°ç»„å¯ä»¥ä¼˜åŒ–åˆ°$O(n^2\log n)$<br>æ­¤å¤–ä¹Ÿå¯ä»¥ç”¨è´¹ç”¨æµ<br>å¦‚æœè¯¢é—®çš„æ˜¯ä¸ç›¸äº¤LISçš„é•¿åº¦ï¼Œåªè¦ç»´æŠ¤å‡ºæ¨è¡¨çš„å‰ä¸¤è¡Œå³å¯ï¼Œç„¶åç­”æ¡ˆå°±æ˜¯å‰ä¸¤è¡Œçš„é•¿åº¦å’Œ<br>$O(2n\log n)$ï¼Œå¯¹äºkä¸ç›¸äº¤LISï¼Œå¯ä»¥åšåˆ°$O(kn\log n)$<br>hdu5406</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; p[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">YT</span></span><br><span class="line">&#123;</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; t[<span class="number">3</span>];</span><br><span class="line">  <span class="built_in">YT</span>() &#123; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">2</span>; i++) t[i].<span class="built_in">clear</span>(); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, x=v; i&lt;=<span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(t[i].<span class="built_in">empty</span>() || t[i].<span class="built_in">back</span>()&lt;=x)</span><br><span class="line">      &#123;</span><br><span class="line">        t[i].<span class="built_in">push_back</span>(x);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">swap</span>(t[i][<span class="built_in">upper_bound</span>(t[i].<span class="built_in">begin</span>(), t[i].<span class="built_in">end</span>(), x)-t[i].<span class="built_in">begin</span>()], x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;p[i].first, &amp;p[i].second);</span><br><span class="line">  <span class="built_in">sort</span>(p+<span class="number">1</span>, p+n+<span class="number">1</span>, [](pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; x, pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; y) &#123;</span><br><span class="line">    <span class="keyword">if</span>(x.first==y.first) <span class="keyword">return</span> x.second &lt; y.second;</span><br><span class="line">    <span class="keyword">return</span> x.first &gt; y.first;</span><br><span class="line">  &#125;);</span><br><span class="line">  YT T;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) T.<span class="built_in">add</span>(p[i].second);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">int</span>(T.t[<span class="number">1</span>].<span class="built_in">size</span>() + T.t[<span class="number">2</span>].<span class="built_in">size</span>()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾ªç¯çŸ©é˜µ</title>
      <link href="/2020/08/25/xun-huan-ju-zhen/"/>
      <url>/2020/08/25/xun-huan-ju-zhen/</url>
      
        <content type="html"><![CDATA[<p>çŸ©é˜µçš„ç¬¬iè¡Œæ˜¯å…¶ä¸Šä¸€è¡Œå¾ªç¯å³ç§»çš„ç»“æœ</p><h2 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h2><p>å¾ªç¯çŸ©é˜µçš„çº¿æ€§è¿ç®—åŠä¹˜ç§¯ä»æ˜¯å¾ªç¯çŸ©é˜µ<br>å¾ªç¯çŸ©é˜µçš„é€†çŸ©é˜µä»¥åŠè½¬ç½®çŸ©é˜µä»æ˜¯å¾ªç¯çŸ©é˜µ<br>å¾ªç¯çŸ©é˜µä¹˜æ³•æ»¡è¶³äº¤æ¢å¾‹</p><h2 id="ä¼˜åŠ¿"><a class="header-anchor" href="#ä¼˜åŠ¿">Â¶</a>ä¼˜åŠ¿</h2><p>ç”±äºä¸¤ä¸ªå¾ªç¯çŸ©é˜µçš„ä¹˜æ³•çš„ç»“æœä»ç„¶æ˜¯ä¸€ä¸ªå¾ªç¯çŸ©é˜µï¼Œæ‰€ä»¥å¯ä»¥$O(n^2)$æ±‚å¾—ç»“æœçš„ç¬¬ä¸€è¡Œï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°å…¶ä»–å„è¡Œçš„ç»“æœï¼Œå°†çŸ©é˜µä¹˜æ³•çš„å¤æ‚åº¦ä¸‹é™äº†ä¸€çº§<br>è‹¥ä¸‹æ ‡ä»0å¼€å§‹ï¼š$c[1][(i+j)$ % $n] += a[1][i] * b[1][j]$<br>è‹¥ä¸‹æ ‡ä»1å¼€å§‹ï¼š$c[1][(i+j-2)$ % $(n+1)] += a[1][i] * b[1][j]$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">cirmat</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> mat[N];</span><br><span class="line">    <span class="built_in">cirmat</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">cirmat</span>(<span class="type">int</span> _) : <span class="built_in">n</span>(_) &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="built_in">cirmat</span>() &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span> </span>&#123; mat[<span class="number">0</span>] = <span class="number">1</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">cirmat <span class="keyword">operator</span> * (cirmat a, cirmat b)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      (res.mat[(i+j<span class="number">-2</span>)%n+<span class="number">1</span>] += <span class="number">1ll</span>*a.mat[i]*b.mat[j]%mod) %= mod;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">cirmat <span class="keyword">operator</span> ^ (cirmat a, ll x)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="bzoj2510-å¼±é¢˜"><a class="header-anchor" href="#bzoj2510-å¼±é¢˜">Â¶</a>bzoj2510 å¼±é¢˜</h2><p>æœ‰mä¸ªå¸¦æ ‡å·çƒï¼Œæ ‡å·èŒƒå›´ä¸º1-nï¼Œæ¯æ¬¡æ“ä½œç­‰æ¦‚ç‡é€‰æ‹©ä¸€ä¸ªçƒï¼Œä½¿å¾—è¯¥çƒçš„æ ‡å·åŠ 1ï¼ˆå¦‚æœæ˜¯nï¼Œå°±å˜æˆ1ï¼‰<br>é—®kæ¬¡æ“ä½œåï¼Œå„ä¸ªæ ‡å·çƒçš„ä¸ªæ•°çš„æœŸæœ›<br>$n \leq 1000,m \leq 10^9,k \leq INT\_MAX$<br>è½¬ç§»çŸ©é˜µæ˜¯ä¸€ä¸ªå¾ªç¯çŸ©é˜µ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, k;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cirmat</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">double</span> mat[N];</span><br><span class="line">  <span class="built_in">cirmat</span>() &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span> </span>&#123; mat[<span class="number">0</span>] = <span class="number">1.0</span>; &#125;</span><br><span class="line">&#125;a, b;</span><br><span class="line">cirmat <span class="keyword">operator</span> * (cirmat a, cirmat b)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;n; j++)</span><br><span class="line">      res.mat[(i+j)%n] += a.mat[i]*b.mat[j];</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">cirmat <span class="keyword">operator</span> ^ (cirmat a, <span class="type">int</span> x)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;a.mat[i]);</span><br><span class="line">  b.mat[<span class="number">0</span>] = <span class="number">1.0</span> - <span class="number">1.0</span>/m, b.mat[<span class="number">1</span>] = <span class="number">1.0</span>/m;</span><br><span class="line">  b = b ^ k;</span><br><span class="line">  a = a * b;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.3f\n&quot;</span>, a.mat[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç‰›å®¢14532-æ²¡æœ‰åå­—"><a class="header-anchor" href="#ç‰›å®¢14532-æ²¡æœ‰åå­—">Â¶</a>ç‰›å®¢14532 æ²¡æœ‰åå­—</h2><p>è½¬ç§»æ˜¯ä¸€ä¸ªå¾ªç¯çŸ©é˜µ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">205</span>;</span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line">ll m;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cirmat</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> mat[N];</span><br><span class="line">  <span class="built_in">cirmat</span>() &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span> </span>&#123; mat[<span class="number">1</span>] = <span class="number">1</span>; &#125;</span><br><span class="line">&#125;a, b;</span><br><span class="line">cirmat <span class="keyword">operator</span> * (cirmat a, cirmat b)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      (res.mat[(i+j<span class="number">-2</span>)%n+<span class="number">1</span>] += <span class="number">1ll</span>*a.mat[i]*b.mat[j]%mod) %= mod;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">cirmat <span class="keyword">operator</span> ^ (cirmat a, ll x)</span><br><span class="line">&#123;</span><br><span class="line">  cirmat res; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%lld%d&quot;</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a.mat[i]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> dis = <span class="built_in">min</span>(i<span class="number">-1</span>, n+<span class="number">1</span>-i);</span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">1</span> || dis&gt;=k) b.mat[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> b.mat[i] = k - dis;</span><br><span class="line">  &#125;</span><br><span class="line">  b = b ^ m;</span><br><span class="line">  a = a * b;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, a.mat[i], <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> _; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">while</span>(_--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œåˆ©ç”¨FFTè¿˜å¯ä»¥å°†å¾ªç¯çŸ©é˜µä¹˜æ³•ä¼˜åŒ–åˆ°$O(n\log n)$ï¼Œè¿˜ä¸ä¼šï¼Œå…ˆå’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å°å‰²ç›¸å…³</title>
      <link href="/2020/08/16/zui-xiao-ge-xiang-guan/"/>
      <url>/2020/08/16/zui-xiao-ge-xiang-guan/</url>
      
        <content type="html"><![CDATA[<h2 id="æœ€å°å‰²çš„æ–¹æ¡ˆ"><a class="header-anchor" href="#æœ€å°å‰²çš„æ–¹æ¡ˆ">Â¶</a>æœ€å°å‰²çš„æ–¹æ¡ˆ</h2><p>è·‘ä¸€éæœ€å¤§æµï¼Œè®°å½•ä»så‡ºå‘èƒ½åˆ°è¾¾çš„ç‚¹é›†Sï¼Œä¸èƒ½åˆ°è¾¾çš„ç‚¹é›†ä¸ºTï¼Œåˆ™è·¨è¶ŠSå’ŒTçš„æ»¡æµè¾¹ï¼ˆæ®‹ç•™ç½‘ç»œä¸­å®¹é‡=0ï¼‰æ˜¯æœ€å°å‰²ä¸­çš„è¾¹</p><h2 id="å¯è¡Œè¾¹ä¸å¿…é¡»è¾¹"><a class="header-anchor" href="#å¯è¡Œè¾¹ä¸å¿…é¡»è¾¹">Â¶</a>å¯è¡Œè¾¹ä¸å¿…é¡»è¾¹</h2><p>å¯è¡Œè¾¹ï¼šå±äºæ‰€æœ‰å¯èƒ½çš„æœ€å°å‰²é›†çš„å¹¶é›†ä¸­çš„è¾¹<br>å¿…é¡»è¾¹ï¼šå±äºæ‰€æœ‰å¯èƒ½çš„æœ€å°å‰²é›†çš„äº¤é›†ä¸­çš„è¾¹<br>è·‘ä¸€éæœ€å¤§æµï¼Œç„¶åå¯¹æ®‹ä½™ç½‘ç»œï¼ˆå®¹é‡å¤§äº0çš„è¾¹ï¼‰è·‘ä¸€étarjan<br>å¦‚æœè¯¥è¾¹è¿˜æœ‰å®¹é‡ï¼Œä¸å±äºæœ€å°å‰²é›†ï¼Œæ‰€ä»¥æ—¢ä¸æ˜¯å¯è¡Œè¾¹ä¹Ÿä¸æ˜¯å¿…é¡»è¾¹<br>å¦‚æœæŸæ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹åˆ†å±äºä¸¤ä¸ªsccï¼Œåˆ™ä¸ºå¯è¡Œè¾¹<br>å¦‚æœæŸæ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹ä¸€ä¸ªä¸SåŒåœ¨ä¸€ä¸ªsccï¼Œä¸€ä¸ªä¸TåŒåœ¨ä¸€ä¸ªsccï¼Œåˆ™ä¸ºå¿…é¡»è¾¹</p><h2 id="æ±‚è¾¹æ•°æœ€å°‘çš„æœ€å°å‰²"><a class="header-anchor" href="#æ±‚è¾¹æ•°æœ€å°‘çš„æœ€å°å‰²">Â¶</a>æ±‚è¾¹æ•°æœ€å°‘çš„æœ€å°å‰²</h2><p>è®¾åŸå›¾æ€»è¾¹æ•°=M<br>è®©åŸå›¾çš„æ¯ä¸€æ¡è¾¹çš„æƒå€¼wå˜æˆ$(M+1)w+1$<br>å†è·‘æœ€å¤§æµå³å¯</p><h2 id="æ¯æ¡è¾¹æœ‰ä¸¤ä¸ªæƒå€¼ï¼Œåœ¨æœ€å°åŒ–ç¬¬ä¸€ä¸ªæƒå€¼çš„å‰²åï¼Œæ‰¾ä¸€ä¸ªç¬¬äºŒä¸ªæƒå€¼å­—å…¸åºæœ€å°çš„å‰²"><a class="header-anchor" href="#æ¯æ¡è¾¹æœ‰ä¸¤ä¸ªæƒå€¼ï¼Œåœ¨æœ€å°åŒ–ç¬¬ä¸€ä¸ªæƒå€¼çš„å‰²åï¼Œæ‰¾ä¸€ä¸ªç¬¬äºŒä¸ªæƒå€¼å­—å…¸åºæœ€å°çš„å‰²">Â¶</a>æ¯æ¡è¾¹æœ‰ä¸¤ä¸ªæƒå€¼ï¼Œåœ¨æœ€å°åŒ–ç¬¬ä¸€ä¸ªæƒå€¼çš„å‰²åï¼Œæ‰¾ä¸€ä¸ªç¬¬äºŒä¸ªæƒå€¼å­—å…¸åºæœ€å°çš„å‰²</h2><p>å…ˆéšä¾¿æ±‚ä¸€ä¸ªæœ€å°å‰²ï¼Œå°†è¿™äº›è¾¹æŒ‰ç…§ç¬¬äºŒä¸ªæƒå€¼æ’åºï¼Œåˆ¤æ–­è¯¥è¾¹æ˜¯å¦æ˜¯å¯è¡Œè¾¹ï¼Œå¦‚æœæ˜¯å°±é€‰æ‹©ï¼Œå‰²æ‰ä¸€æ¡è¾¹éœ€è¦åˆ©ç”¨é€€æµæ“ä½œï¼Œå…·ä½“åšæ³•æ˜¯å¯¹äºè¾¹(u,v)ï¼Œè®©uå‘Sè·‘ä¸€éæœ€å¤§æµï¼Œå†è®©Tå‘vè·‘ä¸€éæœ€å¤§æµï¼Œæœ€åè®©(u,v)è¿™æ¡è¾¹åŠå…¶åè¾¹çš„æ®‹ä½™æµé‡ç½®0ï¼Œå³w=0</p><h2 id="æœ€å°å‰²æ ‘"><a class="header-anchor" href="#æœ€å°å‰²æ ‘">Â¶</a>æœ€å°å‰²æ ‘</h2><p>æ±‚ä»»æ„ä¸¤ç‚¹é—´çš„æœ€å°å‰²<br>æœ¬è´¨åªæœ‰$O(n)$ç§ï¼Œå»ºå‡ºæœ€å°å‰²æ ‘åï¼Œuï¼Œvä¸¤ç‚¹çš„æœ€å°å‰²ç­‰äºè·¯å¾„ä¸Šçš„æœ€å°è¾¹æƒ<br>å»ºæ ‘æ–¹æ³•ï¼šè·‘næ¬¡æœ€å¤§æµ<br>æ¯æ¬¡éšæœºå–ä¸¤ä¸ªç‚¹ï¼Œæ±‚å®ƒä»¬çš„æœ€å°å‰²ï¼Œå°†å›¾åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåœ¨è¿™ä¸¤ä¸ªé›†åˆé—´è¿ä¸€æ¡è¾¹æƒä¸ºæœ€å°å‰²çš„è¾¹ï¼Œç„¶ååˆ†æ²»å¤„ç†ä¸¤ä¸ªé›†åˆã€‚è¿™æ ·æœ€åä¼šå¾—åˆ°ä¸€æ£µæ ‘ã€‚åˆ™ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æœ€å°å‰²å¤§å°ä¸ºå…¶æ ‘ä¸Šå”¯ä¸€è·¯å¾„çš„æœ€å°å€¼ã€‚<br>æ¯æ¬¡ç½‘ç»œæµçš„æµé‡è¦å¤åŸï¼Œæ‰€ä»¥ç”¨å˜é‡fwè®°å½•æ¯æ¡è¾¹å·²ç»æµè¿‡çš„æµé‡ï¼Œå˜é‡wè®°å½•å®¹é‡ä¿æŒä¸å˜ï¼Œå½“fw=wæ—¶è¯´æ˜è¯¥è¾¹æ»¡æµï¼Œå¤åŸåªéœ€è¦æ¸…é›¶fwå³å¯<br>æ±‚è·¯å¾„æœ€å°å€¼æ²¡å¿…è¦å€å¢ï¼Œå› ä¸ºç‚¹æ•°ä¸ä¼šå¾ˆå¤§ï¼Œç›´æ¥å»ºå‡ºæ ‘ï¼Œä»¥æ¯ä¸ªç‚¹ä¸ºæ ¹bfsä¸€æ¬¡å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">505</span>, M = <span class="number">2e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> cnt, head[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> next, to, w, fw;</span><br><span class="line">&#125;e[M&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  e[++cnt] = &#123;head[u], v, w, <span class="number">0</span>&#125;;</span><br><span class="line">  head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m, s, t;</span><br><span class="line">  <span class="type">int</span> dep[N], cur[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">    cnt = <span class="number">1</span>, m = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> cap)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(u, v, cap);</span><br><span class="line">    <span class="built_in">add</span>(v, u, cap);</span><br><span class="line">    m += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dep,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">memcpy</span>(cur,head,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s); dep[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].to;</span><br><span class="line">        <span class="keyword">if</span>(!dep[v]&amp;&amp;e[i].fw&lt;e[i].w)</span><br><span class="line">        &#123;</span><br><span class="line">          dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">          q.<span class="built_in">push</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[t];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> flow)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u==t||!flow) <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="type">int</span> used = flow;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=cur[u];i;i=e[i].next)</span><br><span class="line">    &#123;</span><br><span class="line">      cur[u] = i;</span><br><span class="line">      <span class="type">int</span> v = e[i].to;</span><br><span class="line">      <span class="keyword">if</span>(dep[v]==dep[u]+<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> low = <span class="built_in">dfs</span>(v,<span class="built_in">min</span>(flow,e[i].w-e[i].fw));</span><br><span class="line">        e[i].fw += low; e[i^<span class="number">1</span>].fw -= low;</span><br><span class="line">        flow -= low;</span><br><span class="line">        <span class="keyword">if</span>(!flow) <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> used - flow;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">go</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> maxflow = <span class="number">0</span>; s = x, t = y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=cnt; i++) e[i].fw = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>()) maxflow += <span class="built_in">dfs</span>(s,INF);</span><br><span class="line">    <span class="keyword">return</span> maxflow;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;MF;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">GHT</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> pt[N], col[N], tmpt[N], cnt, cut[N][N];</span><br><span class="line">  vector&lt;pii&gt; G[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    col[u] = cnt;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">      <span class="keyword">if</span>(e[i].fw&lt;e[i].w &amp;&amp; col[e[i].to]!=cnt)</span><br><span class="line">        <span class="built_in">dfs</span>(e[i].to);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> x = pt[l], y = pt[l+<span class="number">1</span>];</span><br><span class="line">    <span class="type">int</span> cutw = MF.<span class="built_in">go</span>(x, y);</span><br><span class="line">    ++cnt; <span class="built_in">dfs</span>(x); <span class="type">int</span> p = l, q = r;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++)</span><br><span class="line">      <span class="keyword">if</span>(col[pt[i]]==cnt) tmpt[p++] = pt[i];</span><br><span class="line">      <span class="keyword">else</span> tmpt[q--] = pt[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) pt[i] = tmpt[i];</span><br><span class="line">    G[x].<span class="built_in">pb</span>(&#123;y, cutw&#125;); G[y].<span class="built_in">pb</span>(&#123;x, cutw&#125;);</span><br><span class="line">    <span class="built_in">build</span>(l, p<span class="number">-1</span>); <span class="built_in">build</span>(q+<span class="number">1</span>, r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> *dis)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) dis[i] = <span class="number">-1</span>;</span><br><span class="line">    dis[s] = INF;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q; q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">sz</span>(q))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">        <span class="keyword">if</span>(~dis[v]) <span class="keyword">continue</span>;</span><br><span class="line">        dis[v] = <span class="built_in">min</span>(dis[u], w);</span><br><span class="line">        q.<span class="built_in">push</span>(v);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  MF.<span class="built_in">init</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">    MF.<span class="built_in">addedge</span>(u, v, w);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">iota</span>(T.pt+<span class="number">1</span>, T.pt+n+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  T.<span class="built_in">build</span>(<span class="number">1</span>, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) T.<span class="built_in">bfs</span>(i, T.cut[i]);</span><br><span class="line">  <span class="type">int</span> q; cin &gt;&gt; q;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">    cout &lt;&lt; T.cut[u][v] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•´æ•°æ‹†åˆ†</title>
      <link href="/2020/08/15/zheng-shu-chai-fen/"/>
      <url>/2020/08/15/zheng-shu-chai-fen/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸èƒ½ç›¸ç­‰"><a class="header-anchor" href="#ä¸èƒ½ç›¸ç­‰">Â¶</a>ä¸èƒ½ç›¸ç­‰</h2><p>å°†æ­£æ•´æ•°nåˆ’åˆ†æˆä¸èƒ½ç›¸ç­‰çš„è‹¥å¹²ä¸ªæ­£æ•´æ•°çš„å’Œçš„æ–¹æ¡ˆæ•°<br>ç”±äºä¸èƒ½ç›¸ç­‰ï¼Œæ‰€ä»¥åˆ’åˆ†æˆçš„æ•°å­—ä¸ªæ•°ä¸è¶…è¿‡$\sqrt n$â€‹<br>è®¾$f_{i,j}$â€‹è¡¨ç¤ºå°†iåˆ’åˆ†æˆjä¸ªä¸åŒæ•°å­—çš„å’Œçš„æ–¹æ¡ˆæ•°<br>$f_{i,j} = f_{i-j,j} + f_{i-j,j-1}$â€‹<br>$O(n\sqrt n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, B = <span class="number">350</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, f[N][B];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123; <span class="keyword">return</span> (x+y&gt;=mod) ? x+y-mod : x+y; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=i &amp;&amp; j&lt;B; j++)</span><br><span class="line">      f[i][j] = <span class="built_in">add</span>(f[i-j][j], f[i-j][j<span class="number">-1</span>]);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;B; j++) ans = <span class="built_in">add</span>(ans, f[n][j]);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="èƒ½ç›¸ç­‰"><a class="header-anchor" href="#èƒ½ç›¸ç­‰">Â¶</a>èƒ½ç›¸ç­‰</h2><p>å°†æ­£æ•´æ•°nåˆ’åˆ†æˆè‹¥å¹²æ­£æ•´æ•°çš„å’Œçš„æ–¹æ¡ˆæ•°<br>è®¾å®šé˜ˆå€¼$B=\sqrt n$<br>å¯¹äº&lt;Bçš„éƒ¨åˆ†ï¼Œç›´æ¥åšå®Œå…¨èƒŒåŒ…<br>å¯¹äº&gt;=Bçš„éƒ¨åˆ†ï¼Œé€‰æ‹©çš„æ•°å­—ä¸ªæ•°ä¸è¶…è¿‡B<br>è®¾$f_{i,j}$â€‹è¡¨ç¤ºå°†iåˆ’åˆ†æˆjä¸ªä¸åŒæ•°å­—çš„å’Œçš„æ–¹æ¡ˆæ•°<br>$f_{i,j} = f_{i-B,j-1} + f_{i-j,j}$<br>$O(n\sqrt n)O$ ä½†åªèƒ½è§£å†³å•æ¬¡è¯¢é—®</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, B = <span class="number">350</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, f0[N], f1[N], f[N][B];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> (a+b&gt;=mod) ? a+b-mod : a+b; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  f0[<span class="number">0</span>] = f1[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;B &amp;&amp; j&lt;=n; j++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=j; i&lt;=n; i++)</span><br><span class="line">      f0[i] = <span class="built_in">Add</span>(f0[i], f0[i-j]);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=B; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=B; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      f[i][j] = <span class="built_in">Add</span>(f[i-B][j<span class="number">-1</span>], f[i-j][j]);</span><br><span class="line">      f1[i] = <span class="built_in">Add</span>(f1[i], f[i][j]);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) <span class="built_in">add</span>(ans, <span class="built_in">Mul</span>(f0[i], f1[n-i]));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº”è¾¹å½¢æ•°$\frac{n(3n-1)}{2}$<br>æ¬§æ‹‰å‡½æ•°<br>$\phi(n) = \prod \limits_{i=1}^{\infty}<br>(1-x^i) = \prod<br>\limits_{i=-\infty}^{\infty}(-1)^ix^{\frac{i(3i-1)}{2}}$â€‹<br>å³å±•å¼€ååªç•™ä¸‹å¹‚æ¬¡ä¸ºå¹¿ä¹‰äº”è¾¹å½¢æ•°çš„é¡¹<br>è€ƒè™‘æ•´æ•°æ‹†åˆ†çš„ç”Ÿæˆå‡½æ•°<br>$F(x) = \sum<br>\limits_{i=1}^{\infty} P(i)x^i =\prod \limits_{i=1}^{\infty}(1+x^i+x^{2i}â€¦)<br>= \prod<br>\limits_{i=1}^{\infty}\frac{1}{1-x^i}$â€‹<br>å³$F(x)\phi(x)=1$<br>å¯ä»¥å¾—åˆ°$P(n)-P(n-1)-P(n-2)+P(n-5)+P(n-7)-â€¦=0$<br>å®¹æ˜“å‘ç°P(n)å¯ç”±$n-\dfrac{i(3*i-1)}{2}$â€‹ä»¥åŠ$n-\dfrac{i(3*i+1)}{2}$â€‹æ›´æ–°å¾—åˆ°<br>ç”±äºäº”è¾¹å½¢æ•°æ˜¯$n^2$çº§åˆ«å¢é•¿çš„ï¼Œæ‰€ä»¥å¯ä»¥$O(n\sqrt n)$é€’æ¨å¾—åˆ°$P(1)\dots P(n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, B = <span class="number">350</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, i, j, f[B], g[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(f[<span class="number">1</span>]=<span class="number">1</span>,f[<span class="number">2</span>]=<span class="number">2</span>,f[<span class="number">3</span>]=<span class="number">5</span>,f[<span class="number">4</span>]=<span class="number">7</span>,i=<span class="number">5</span>; f[i<span class="number">-1</span>]&lt;n; i++) f[i] = <span class="number">3</span> + <span class="number">2</span>*f[i<span class="number">-2</span>] - f[i<span class="number">-4</span>];</span><br><span class="line">  <span class="keyword">for</span>(g[<span class="number">0</span>]=i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">1</span>; f[j]&lt;=i; j++)</span><br><span class="line">      <span class="keyword">if</span>((j+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>&amp;<span class="number">1</span>) g[i] = (g[i] + g[i-f[j]])%mod;</span><br><span class="line">      <span class="keyword">else</span> g[i] = (g[i]-g[i-f[j]]+mod)%mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (g[n]&lt;<span class="number">0</span>) ? g[n]+mod : g[n]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²ˆé˜³çš„Ié¢˜æ˜¯è¯¢é—®nä¸ªç‚¹æ·±åº¦ä¸è¶…è¿‡2çš„æ ‘çš„ä¸ªæ•°ï¼Œæ˜¾ç„¶æ˜¯ä¸ªn-1çš„æ•´æ•°æ‹†åˆ†ï¼Œç„¶è€Œ$n \leq 5\times10^5$</p><ol><li><p>$O(n\sqrt n)$<br>å–æ¨¡ä¼˜åŒ–ï¼Œgæ•°ç»„å¼€æˆlonglongï¼Œè¿™æ ·å¯¹äº$g_i$â€‹åªè¦åœ¨æœ€åå–ä¸€æ¬¡æ¨¡å³å¯ï¼Œå› ä¸ºæœ€å¤šæ ¹å·æ¬¡åŠ æ³•æ‰€ä»¥ä¸ä¼šçˆ†longlong<br>cachemissä¼˜åŒ–ï¼Œ$g_i$â€‹ç”¨å˜é‡xä»£æ›¿ï¼Œè¿™æ ·å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘cacheçš„miss<br>å¾ªç¯ä¼˜åŒ–ï¼Œå¤§åŠ›å¾ªç¯å±•å¼€<br>ç„¶åå°±èƒ½è¿‡äº†</p></li><li><p>$O(n\log n)$<br>æ›´å¿«ä¹Ÿæ›´ç®€å•ï¼Œåªéœ€è¦å¯¹$\phi$æ±‚ä¸ªé€†å³å¯</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹³é¢å›¾</title>
      <link href="/2020/08/13/ping-mian-tu/"/>
      <url>/2020/08/13/ping-mian-tu/</url>
      
        <content type="html"><![CDATA[<h2 id="å®šä¹‰"><a class="header-anchor" href="#å®šä¹‰">Â¶</a>å®šä¹‰</h2><p>ç”»åœ¨å¹³é¢ä¸Šï¼Œä»»æ„ä¸¤æ¡è¾¹é™¤é¡¶ç‚¹å¤–æ— äº¤ç‚¹<br>åŒ…å›´ä¸€ä¸ªé¢çš„è¾¹çš„æ¡æ•°ç§°ä¸ºè¯¥é¢çš„æ¬¡æ•°</p><h2 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h2><p>æ¬§æ‹‰å…¬å¼ï¼š<br>n - m + r = 2<br>ç‚¹æ•°-è¾¹æ•°+é¢æ•°=2<br>ç‚¹æ•°$n \geq 3$çš„å¹³é¢å›¾çš„è¾¹æ•°$m \leq 3n-6$ (è¾¹æ•°æ˜¯çº¿æ€§çš„)</p><h2 id="å¯¹å¶å›¾"><a class="header-anchor" href="#å¯¹å¶å›¾">Â¶</a>å¯¹å¶å›¾</h2><p>æ¯ä¸ªé¢ä¸ºä¸€ä¸ªé¡¶ç‚¹ï¼Œå¯¹äºå¹³é¢å›¾ä¸Šçš„æ¯æ¡è¾¹ï¼ˆä¸€å®šåªä¸ä¸¤ä¸ªé¢ç›¸è¿ï¼‰ï¼Œç”¨è¾¹è¿æ¥è¿™ä¸¤ä¸ªé¢å¯¹åº”çš„é¡¶ç‚¹<br>å¹³é¢å›¾æœ€å°å‰²=å¯¹å¶å›¾æœ€çŸ­è·¯<br>ï¼ˆå¯¹å¶å›¾çš„è¾¹æƒç›¸å½“äºå‰²æ‰å¹³é¢å›¾ä¸€æ¡è¾¹çš„ä»£ä»·ï¼Œæ‰€ä»¥ç»´æŠ¤å¯¹å¶å›¾çš„è¿é€šæ€§ï¼Œç­‰ä»·äºç»´æŠ¤å¹³é¢å›¾çš„éè¿é€šæ€§ï¼‰<br>Gçš„é¢æ•°ç­‰äºGçš„ç‚¹æ•°ï¼Œ Gä¸Gçš„è¾¹æ•°ç›¸åŒ(æ¯ä¸ªé¢ä¸ºä¸€ä¸ªç‚¹ï¼Œæ¯æ¡è¾¹ä¹Ÿå¯¹åº”äº†ä¸€æ¡è¾¹)</p><h2 id="P4001-ICPC-Beijing-2006-ç‹¼æŠ“å…”å­"><a class="header-anchor" href="#P4001-ICPC-Beijing-2006-ç‹¼æŠ“å…”å­">Â¶</a>P4001 [ICPC-Beijing 2006]ç‹¼æŠ“å…”å­</h2><p>æ±‚ç½‘æ ¼å›¾çš„æœ€å°å‰²<br>ç½‘æ ¼å›¾æ˜¾ç„¶æ˜¯å¹³é¢å›¾ï¼Œè½¬æˆå¯¹å¶å›¾åè·‘æœ€çŸ­è·¯å³å¯<br><s>ç„¶åå¯¹å¶å›¾éš¾å»ºè¿˜æ¯”ç½‘ç»œæµæ…¢</s></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> ll LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T;</span><br><span class="line">vector&lt;pii&gt; G[<span class="number">2</span>*N*N];</span><br><span class="line">ll dis[<span class="number">2</span>*N*N];</span><br><span class="line"><span class="type">bool</span> vis[<span class="number">2</span>*N*N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, (T+<span class="number">1</span>)*<span class="built_in">sizeof</span>(ll));</span><br><span class="line">  <span class="built_in">memset</span>(vis, <span class="number">0</span>, (T+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">  dis[s] = <span class="number">0</span>;</span><br><span class="line">  priority_queue&lt;pli,vector&lt;pli&gt;,greater&lt;pli&gt;&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>, s));</span><br><span class="line">  <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">top</span>().se; q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">      <span class="keyword">if</span>(dis[v]&gt;dis[u]+w)</span><br><span class="line">      &#123;</span><br><span class="line">        dis[v] = dis[u] + w;</span><br><span class="line">        q.<span class="built_in">push</span>(<span class="built_in">mp</span>(dis[v], v));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  S = <span class="number">0</span>, T = (<span class="number">2</span>*n<span class="number">-2</span>)*(m<span class="number">-1</span>) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">auto</span> id = [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">0</span>||y==m) <span class="keyword">return</span> S;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">2</span>*n<span class="number">-1</span>||y==<span class="number">0</span>) <span class="keyword">return</span> T;</span><br><span class="line">    <span class="keyword">return</span> (x<span class="number">-1</span>)*(m<span class="number">-1</span>) + y;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = <span class="built_in">id</span>(<span class="number">2</span>*i<span class="number">-2</span>, j), v = <span class="built_in">id</span>(<span class="number">2</span>*i<span class="number">-1</span>, j), w; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">      G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = <span class="built_in">id</span>(<span class="number">2</span>*i<span class="number">-1</span>, j<span class="number">-1</span>), v = <span class="built_in">id</span>(<span class="number">2</span>*i, j), w; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">      G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = <span class="built_in">id</span>(<span class="number">2</span>*i<span class="number">-1</span>, j), v = <span class="built_in">id</span>(<span class="number">2</span>*i, j), w; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">      G[u].<span class="built_in">emplace_back</span>(v, w); G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="built_in">Dijkstra</span>(S);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, dis[T]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç‰›å®¢å¤šæ ¡2-Interval"><a class="header-anchor" href="#ç‰›å®¢å¤šæ ¡2-Interval">Â¶</a>ç‰›å®¢å¤šæ ¡2 Interval</h2><p>åˆå§‹æœ‰ä¸€ä¸ªåŒºé—´$[1,n]$<br>å¯¹äºä¸€ä¸ªåŒºé—´$[l,r]$(l&lt;r)ï¼Œå¯ä»¥å˜æ¢æˆ$[l+1,r]$,$[l,r-1]$,$[lâˆ’1,r]$,$[l,r+1]$<br>ç°åœ¨ç»™å®šmç§æ–¹å¼ï¼Œå¯ä»¥èŠ±è´¹ä¸€å®šçš„ä»£ä»·é™åˆ¶æŸç§å˜æ¢ï¼Œé—®æœ€å°‘èŠ±è´¹å¤šå°‘ä»£ä»·ä½¿å¾—åŒºé—´$[1,n]$æ— æ³•å˜æ¢æˆé•¿åº¦ä¸º1çš„åŒºé—´<br>$n \leq 500$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è€ƒè™‘ç½‘ç»œæµæœ€å°å‰²å»ºå›¾ï¼Œå¯¹æ¯ä¸ªåŒºé—´å»ºä¸€ä¸ªç‚¹ï¼Œæ¯ç§å˜æ¢è¿è¾¹æµé‡ä¸ºINFï¼Œå¦‚æœæŸç§å˜æ¢è¢«é™åˆ¶ï¼Œåˆ™è¿è¾¹æµé‡ä¸ºcostï¼Œè¡¨ç¤ºå‰²æ‰è¿™æ¡è¾¹çš„ä»£ä»·ã€‚<br>ç‚¹æ•°æ˜¯$n^2$,è¾¹æ•°ä¹Ÿæ˜¯$n^2$çš„<br>å‘ç°è¿™æ˜¯ä¸€ä¸ªå¹³é¢å›¾ï¼Œæ‰€ä»¥è½¬æˆå¯¹å¶å›¾è·‘æœ€çŸ­è·¯å°±å¯ä»¥äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pil = pair&lt;<span class="type">int</span>,ll&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">505</span>;</span><br><span class="line"><span class="keyword">constexpr</span> ll LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, S, T, idx[N][N], tot;</span><br><span class="line">ll dis[N*N];</span><br><span class="line"><span class="type">bool</span> vis[N*N];</span><br><span class="line">vector&lt;pil&gt; G[N*N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, ll w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  G[u].<span class="built_in">emplace_back</span>(v, w);</span><br><span class="line">  G[v].<span class="built_in">emplace_back</span>(u, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, (tot+<span class="number">1</span>)*<span class="built_in">sizeof</span>(ll));</span><br><span class="line">  <span class="built_in">memset</span>(vis, <span class="number">0</span>, (tot+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">  dis[s] = <span class="number">0</span>;</span><br><span class="line">  priority_queue&lt;pli,vector&lt;pli&gt;,greater&lt;pli&gt;&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>, s));</span><br><span class="line">  <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">top</span>().se; q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> v = it.fi; ll w = it.se;</span><br><span class="line">      <span class="keyword">if</span>(dis[v]&gt;dis[u]+w)</span><br><span class="line">      &#123;</span><br><span class="line">        dis[v] = dis[u] + w;</span><br><span class="line">        q.<span class="built_in">push</span>(<span class="built_in">mp</span>(dis[v], v));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i; j&lt;n; j++)</span><br><span class="line">      idx[i][j] = ++tot;</span><br><span class="line">  S = <span class="number">0</span>; T = ++tot;</span><br><span class="line">  <span class="keyword">auto</span> id = [&amp;](<span class="type">int</span> x, <span class="type">int</span> y)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">0</span>) <span class="keyword">return</span> S;</span><br><span class="line">    <span class="keyword">if</span>(y==n) <span class="keyword">return</span> T;</span><br><span class="line">    <span class="keyword">return</span> idx[x][y];</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i; j&lt;n; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">addedge</span>(<span class="built_in">id</span>(i<span class="number">-1</span>, j), <span class="built_in">id</span>(i, j), LINF);</span><br><span class="line">      <span class="built_in">addedge</span>(<span class="built_in">id</span>(i, j), <span class="built_in">id</span>(i, j+<span class="number">1</span>), LINF);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">addedge</span>(<span class="built_in">id</span>(i, i), <span class="built_in">id</span>(i<span class="number">-1</span>, i<span class="number">-1</span>), LINF);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, c;</span><br><span class="line">    <span class="type">char</span> dir;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; r &gt;&gt; dir &gt;&gt; c;</span><br><span class="line">    <span class="keyword">if</span>(dir==<span class="string">&#x27;L&#x27;</span>) <span class="built_in">addedge</span>(<span class="built_in">id</span>(l, r<span class="number">-1</span>), <span class="built_in">id</span>(l, r), c);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">addedge</span>(<span class="built_in">id</span>(l<span class="number">-1</span>, r<span class="number">-1</span>), <span class="built_in">id</span>(l, r<span class="number">-1</span>), c);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">Dijkstra</span>(S);</span><br><span class="line">  cout &lt;&lt; (dis[T]&gt;=LINF ? <span class="number">-1</span> : dis[T]) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ€§è§„åˆ’ å•çº¯å‹ç®—æ³•</title>
      <link href="/2020/08/11/xian-xing-gui-hua-dan-chun-xing-suan-fa/"/>
      <url>/2020/08/11/xian-xing-gui-hua-dan-chun-xing-suan-fa/</url>
      
        <content type="html"><![CDATA[<p>nä¸ªå˜é‡$x_1,â€¦,x_n$â€‹ï¼Œmä¸ªçº¿æ€§çº¦æŸï¼Œå½¢å¦‚$\sum \limits_{i=1}^n<br>a_{ij}x_i \leq b_j$â€‹,è¦æ±‚ç¡®å®šè¿™nä¸ªå˜é‡çš„å€¼ï¼Œ$\max z =<br>\sum\limits_{i=1}^n c_ix_i$<br>å•çº¯å‹å¯ä»¥è¢«å¡åˆ°æŒ‡æ•°çº§ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹é€Ÿåº¦è¾ƒå¿«ï¼Œç›¸æ¯”äºMCMFï¼Œä»£ç æ›´çŸ­ï¼Œè€Œä¸”æ›´ç›´è§‚<br>ä»¥ä¸‹ç”¨çŸ©é˜µå½¢å¼è¡¨è¾¾ï¼ˆè§„å®šå°å†™ä¸ºåˆ—å‘é‡ï¼Œå¤§å†™ä¸ºçŸ©é˜µï¼‰</p><h3 id="æ ‡å‡†å½¢å¼"><a class="header-anchor" href="#æ ‡å‡†å½¢å¼">Â¶</a>æ ‡å‡†å½¢å¼</h3><p>æœ€å¤§åŒ–$c^Tx$ï¼Œæ»¡è¶³çº¦æŸ$Ax\leq b,x_i \geq 0$</p><h3 id="æ¾å¼›å½¢å¼"><a class="header-anchor" href="#æ¾å¼›å½¢å¼">Â¶</a>æ¾å¼›å½¢å¼</h3><p>æœ€å¤§åŒ–$c^Tx$ï¼Œæ»¡è¶³çº¦æŸ$Ax=b,x_i \geq 0$<br>åªè¦å¯¹æ¯ä¸ªæ ‡å‡†å½¢å¼çš„çº¦æŸæ¡ä»¶å¢åŠ ä¸€ä¸ªå˜é‡$x_{n+i} \geq 0$å³å¯</p><h3 id="å¯¹å¶é—®é¢˜"><a class="header-anchor" href="#å¯¹å¶é—®é¢˜">Â¶</a>å¯¹å¶é—®é¢˜</h3><p>æœ€å°åŒ–$b^Tx$ï¼Œæ»¡è¶³çº¦æŸ$A^Tx \leq c,x_i \geq 0$<br>ç›®æ ‡å‡½æ•°çš„ç³»æ•°cä¸çº¦æŸæ¡ä»¶å³è¾¹çš„ç³»æ•°bäº¤æ¢ï¼Œå¹¶å°†çº¦æŸç³»æ•°çŸ©é˜µè½¬ç½®ï¼Œæœ€å¤§åŒ–ä¸æœ€å°åŒ–äº’æ¢ï¼Œæ”¹å˜ä¸ç­‰å¼å·</p><p>$a_{00}=-z,a_{0i}=c_i,a_{i0}=b_i$<br>mè¡Œnåˆ—ï¼Œè¡¨ç¤ºnä¸ªå˜é‡ï¼Œmä¸ªçº¦æŸï¼Œå•çº¯å‹ä½¿ç”¨çš„æ˜¯æ¾å¼›å½¢å¼ï¼Œåªä¸è¿‡æ²¡æœ‰æ˜¾ç¤ºè¡¨ç¤ºå‡ºæ¥<br>å½“çº¦æŸç³»æ•°$a_{ij}$â€‹ä¸º0ï¼Œ1ï¼Œ-1ï¼ˆå…¨å¹ºæ¨¡çŸ©é˜µï¼‰æ—¶ç”¨ä»¥ä¸‹ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> a[N][M], q[M];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cal</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  a[l][e] = <span class="number">1</span>; <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;=n; j++) <span class="keyword">if</span>(a[l][j]) q[++p] = j;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, t=<span class="number">0</span>; i&lt;=m; i++)</span><br><span class="line">    <span class="keyword">if</span>(i!=l &amp;&amp; (t=a[i][e]))</span><br><span class="line">    &#123;</span><br><span class="line">      a[i][e] = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=p; j++) a[i][q[j]] -= t*a[l][q[j]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, e = <span class="number">0</span>, mn = INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      <span class="keyword">if</span>(a[<span class="number">0</span>][j]&gt;<span class="number">0</span>) &#123; e = j; <span class="keyword">break</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span>(!e) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">      <span class="keyword">if</span>(a[i][e]&gt;<span class="number">0</span> &amp;&amp; a[i][<span class="number">0</span>]&lt;mn) mn = a[i][<span class="number">0</span>], l = i;</span><br><span class="line">    <span class="built_in">assert</span>(l);</span><br><span class="line">    <span class="built_in">cal</span>(l, e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> -a[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŸé—®é¢˜æˆ–è€…å¯¹å¶é—®é¢˜ä¸­è‡³å°‘æœ‰ä¸€ä¸ªé›¶è§£æ˜¯å¯è¡Œè§£ï¼Œæ‰€ä»¥ä¸éœ€è¦initï¼Œå¦åˆ™éœ€è¦å…ˆé€šè¿‡initæ‰¾åˆ°ä¸€ç»„åˆå§‹è§£ï¼Œå†è¿›è¡Œsimplexä¼˜åŒ–</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-8</span>, INF = <span class="number">1e15</span>;</span><br><span class="line"><span class="type">int</span> n, m, type, id[M*<span class="number">2</span>], q[M];</span><br><span class="line"><span class="type">double</span> a[N][M], ans[M];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pivot</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">swap</span>(id[l+n], id[e]);</span><br><span class="line">  <span class="type">double</span> t = a[l][e]; a[l][e] = <span class="number">1.0</span>; <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;=n; j++) a[l][j] /= t;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;=n; j++) <span class="keyword">if</span>(<span class="built_in">fabs</span>(a[l][j])&gt;eps) q[++p] = j;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=m; i++)</span><br><span class="line">    <span class="keyword">if</span>(i!=l &amp;&amp; <span class="built_in">fabs</span>(a[i][e])&gt;eps)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">double</span> t = a[i][e]; a[i][e] = <span class="number">0.0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=p; j++) a[i][q[j]] -= t*a[l][q[j]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, e = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">      <span class="keyword">if</span>(a[i][<span class="number">0</span>]&lt;-eps &amp;&amp; (!l || (<span class="built_in">rand</span>()&amp;<span class="number">1</span>))) l = i;</span><br><span class="line">    <span class="keyword">if</span>(!l) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      <span class="keyword">if</span>(a[l][j]&lt;-eps &amp;&amp; (!e || (<span class="built_in">rand</span>()&amp;<span class="number">1</span>))) e = j;</span><br><span class="line">    <span class="keyword">if</span>(!e) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Infeasible&quot;</span>), <span class="literal">false</span>; <span class="comment">//æ— è§£</span></span><br><span class="line">    <span class="built_in">pivot</span>(l, e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">simplex</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, e = <span class="number">0</span>; <span class="type">double</span> w = eps;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++) <span class="comment">//é€‰æ‹©æœ€å¤§çš„é‚£ä¸ªï¼ˆæ›´å¿«æ‰¾åˆ°æœ€ä¼˜è§£ï¼‰ï¼Œæˆ–è€…é€‰æ‹©ç¬¬ä¸€ä¸ªå¤§äº0çš„ï¼ˆå¯ä»¥é˜²æ­¢æ­»å¾ªç¯ï¼‰</span></span><br><span class="line">      <span class="keyword">if</span>(a[<span class="number">0</span>][j]&gt;w) w = a[<span class="number">0</span>][j], e = j;</span><br><span class="line">    <span class="keyword">if</span>(!e) <span class="keyword">break</span>;</span><br><span class="line">    w = INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">      <span class="keyword">if</span>(a[i][e]&gt;eps &amp;&amp; a[i][<span class="number">0</span>]/a[i][e]&lt;w)</span><br><span class="line">        w = a[i][<span class="number">0</span>]/a[i][e], l = i;</span><br><span class="line">    <span class="keyword">if</span>(!l) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Unbounded&quot;</span>), <span class="literal">false</span>;<span class="comment">//è§£æ— ç•Œ</span></span><br><span class="line">    <span class="built_in">pivot</span>(l, e);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">iota</span>(id+<span class="number">1</span>, id+n+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">init</span>() &amp;&amp; <span class="built_in">simplex</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.8f\n&quot;</span>, -a[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) ans[id[n+i]] = a[i][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span>(type) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%.8f &quot;</span>, ans[i]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çº¿æ€§è§„åˆ’è½¬è´¹ç”¨æµï¼š<br>åˆ—å‡ºæ ‡å‡†å½¢å¼ï¼Œæ·»åŠ æ¾å¼›å˜é‡è½¬åŒ–ä¸ºæ¾å¼›å‹<br>æ¯ä¸ªå¼å­ä¸å‰ä¸€ä¸ªå¼å­ç›¸å‡ï¼Œå¦‚æœæ¯ä¸ªå˜é‡åªå‡ºç°ä¸¤æ¬¡ï¼Œä¸”ç³»æ•°ä¸€æ­£ä¸€è´Ÿï¼Œå°±å¯ä»¥è½¬åŒ–ä¸ºè´¹ç”¨æµ<br>å¯¹äºæ¯ä¸ªç­‰å¼æ–°å»ºä¸€ä¸ªç‚¹ï¼Œå¦‚æœç­‰å¼ä¸­å³è¾¹å¸¸æ•°bä¸ºæ­£æ•°ï¼Œä»æºç‚¹så‘è¯¥ç‚¹è¿è¾¹ï¼ˆb,0ï¼‰ï¼Œå¦åˆ™è¯¥ç‚¹å‘æ±‡ç‚¹è¿è¾¹ï¼ˆ-b,0ï¼‰ã€‚å¯¹æ¯ä¸ªå˜é‡ï¼ˆåŒ…æ‹¬æ·»åŠ çš„ç”¨æ¥æ¾å¼›çš„å˜é‡ï¼‰ä»å®ƒç³»æ•°ä¸ºæ­£çš„ç­‰å¼ä»£è¡¨çš„ç‚¹å‘å®ƒç³»æ•°ä¸ºè´Ÿçš„ç­‰å¼ä»£è¡¨çš„ç‚¹è¿è¾¹ï¼ˆINFï¼Œcï¼‰ï¼Œcä¸ºç›®æ ‡å‡½æ•°ä¸­çš„ç³»æ•°</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†æ•£å±‚å ç®—æ³•(Fractional Cascading)</title>
      <link href="/2020/08/07/fen-san-ceng-die-suan-fa-fractional-cascading/"/>
      <url>/2020/08/07/fen-san-ceng-die-suan-fa-fractional-cascading/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®škä¸ªé•¿åº¦ä¸ºnæœ‰åºæ•°ç»„Lï¼Œè¦æ±‚<strong>åœ¨çº¿</strong>qæ¬¡å›ç­”æ¯ä¸ªæ•°ç»„ä¸­$\geq x$çš„æœ€å°çš„æ•°<br>$k\leq 100,n\leq 10^4, q\leq 3\times 10^5$<br>ç¦»çº¿çš„è¯å¯ä»¥æ•´ä½“äºŒåˆ†<br>åœ¨çº¿ç”¨è¯¥ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º$O(k+\log n)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º$O(n)$<br>ç”¨ä¸€ä¸ª$k\times n$çš„äºŒç»´æ•°ç»„Mï¼ŒM[i]çš„æ¯ä¸€ä½è®°å½•ä¸‰ä¸ªä¿¡æ¯ï¼Œï½›é”®å€¼ï¼Œåœ¨L[i]ä¸­åç»§çš„ä½ç½®ï¼Œåœ¨M[i+1]ä¸­åç»§çš„ä½ç½®ï½<br>è€ƒè™‘ä»åå¾€å‰æ„é€ ï¼ŒM[k]=L[k]<br>ç”±äºæ˜¯æœ‰åºçš„ï¼Œåˆ©ç”¨å½’å¹¶$O(n)$åˆå¹¶L[i]å’ŒM[i+1]ï¼Œæ³¨æ„å¯¹äºM[i+1]åªåˆå¹¶å¶æ•°ä½ç½®ï¼ˆèŠ‚çœç©ºé—´ï¼‰<br>å¯¹äºæŸ¥è¯¢ï¼Œå…ˆåˆ©ç”¨ä¸€æ¬¡äºŒåˆ†åœ¨M[1]ä¸­æ‰¾åˆ°åç»§çš„ä½ç½®ï¼Œæ­¤æ—¶è¯¥ä½çš„ç¬¬äºŒä¸ªä¿¡æ¯å°±è¡¨ç¤ºäº†åœ¨L[1]æ•°ç»„ä¸­çš„ç­”æ¡ˆï¼Œè€Œè¯¥ä½çš„ç¬¬ä¸‰ä¸ªä¿¡æ¯è¡¨ç¤ºäº†åœ¨M[2]ä¸­åç»§çš„ä½ç½®ï¼Œæ³¨æ„ç”±äºæ˜¯é—´éš”æ’å…¥ï¼Œæ‰€ä»¥éœ€è¦å’Œè¯¥ä½ç½®çš„å‰ä¸€ä¸ªä½ç½®å–ä¼˜ã€‚è¿™æ ·åªéœ€è¦ä¸€æ¬¡äºŒåˆ†ï¼Œç„¶åå„æ•°ç»„é—´åˆ©ç”¨ä¿å­˜çš„ä¿¡æ¯ï¼ˆæŒ‡é’ˆï¼‰å¯ä»¥$O(1)$è½¬ç§»</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n, k, q, d;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;k, &amp;q, &amp;d);</span><br><span class="line">  vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">L</span>(k, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n));</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;n; j++)</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;L[i][j]);</span><br><span class="line">  vector&lt;vector&lt;pair&lt;<span class="type">int</span>,pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt;&gt; <span class="built_in">M</span>(k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    M[k<span class="number">-1</span>].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(L[k<span class="number">-1</span>][i], <span class="built_in">mp</span>(i, <span class="number">0</span>)));</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=k<span class="number">-2</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>, b = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(a&lt;n &amp;&amp; b&lt;<span class="built_in">sz</span>(M[i+<span class="number">1</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(L[i][a]&lt;=M[i+<span class="number">1</span>][b].first) M[i].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(L[i][a], <span class="built_in">mp</span>(a, b))), a++;</span><br><span class="line">      <span class="keyword">else</span> M[i].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(M[i+<span class="number">1</span>][b].first, <span class="built_in">mp</span>(a, b))), b += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(a&lt;n) M[i].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(L[i][a], <span class="built_in">mp</span>(a, b))), a++;</span><br><span class="line">    <span class="keyword">while</span>(b&lt;<span class="built_in">sz</span>(M[i+<span class="number">1</span>])) M[i].<span class="built_in">push_back</span>(<span class="built_in">mp</span>(M[i+<span class="number">1</span>][b].first, <span class="built_in">mp</span>(a, b))), b += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> lstans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> _=<span class="number">1</span>; _&lt;=q; _++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">    x ^= lstans;</span><br><span class="line">    <span class="type">int</span> p = <span class="built_in">lower_bound</span>(M[<span class="number">0</span>].<span class="built_in">begin</span>(), M[<span class="number">0</span>].<span class="built_in">end</span>(), <span class="built_in">mp</span>(x, <span class="built_in">mp</span>(<span class="number">0</span>, <span class="number">0</span>))) - M[<span class="number">0</span>].<span class="built_in">begin</span>();</span><br><span class="line">    <span class="type">int</span> curans = <span class="number">0</span>, idx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(idx&lt;k &amp;&amp; p&lt;<span class="built_in">sz</span>(M[idx]))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(M[idx][p].second.first&lt;n) curans ^= L[idx][M[idx][p].second.first];</span><br><span class="line">      <span class="keyword">if</span>(idx&lt;k<span class="number">-1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> nxtp = M[idx][p].second.second;</span><br><span class="line">        <span class="keyword">if</span>(nxtp<span class="number">-1</span>&lt;<span class="built_in">sz</span>(M[idx+<span class="number">1</span>]) &amp;&amp; M[idx+<span class="number">1</span>][nxtp<span class="number">-1</span>].first&gt;=x) --nxtp;</span><br><span class="line">        p = nxtp;</span><br><span class="line">      &#125;</span><br><span class="line">      ++idx;</span><br><span class="line">    &#125;</span><br><span class="line">    lstans = curans;</span><br><span class="line">    <span class="keyword">if</span>(_%d==<span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, curans);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kosarajuæ±‚å¼ºè¿é€šåˆ†é‡</title>
      <link href="/2020/08/07/kosaraju-qiu-qiang-lian-tong-fen-liang/"/>
      <url>/2020/08/07/kosaraju-qiu-qiang-lian-tong-fen-liang/</url>
      
        <content type="html"><![CDATA[<p>åå›¾çš„å¼ºè¿é€šåˆ†é‡å’ŒåŸå›¾ç›¸åŒ<br>æŒ‰ç…§åå›¾çš„é€†ååºæ–¹å‘éå†åŸå›¾å³å¯<br>é€†ååºæ–¹å‘ï¼šå…ˆéå†ä¸è¯¥ç‚¹ç›¸è¿çš„èŠ‚ç‚¹ï¼Œæœ€åå°†è¯¥ç‚¹å…¥æ ˆï¼Œæ ˆçš„ååºä¸ºé€†ååº<br>åˆ©ç”¨bitsetå¯ä»¥ä¼˜åŒ–åˆ°$O(n^2/32)$ï¼Œé€‚åˆç¨ å¯†å›¾</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Kosaraju</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ord[N], tp, num[N], scc;</span><br><span class="line">  bitset&lt;N&gt; tag, G[N], rG[N], t;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) G[i].<span class="built_in">reset</span>(), rG[i].<span class="built_in">reset</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    tag[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t=rG[u]&amp;tag).<span class="built_in">any</span>())</span><br><span class="line">      <span class="built_in">dfs</span>(t._Find_first());</span><br><span class="line">    ord[++tp] = u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    num[u] = scc;</span><br><span class="line">    tag[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t=G[u]&amp;tag).<span class="built_in">any</span>())</span><br><span class="line">      <span class="built_in">dfs2</span>(t._Find_first());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">gao</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    tp = scc = <span class="number">0</span>;</span><br><span class="line">    tag.<span class="built_in">set</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span>(tag[i]) <span class="built_in">dfs</span>(i);</span><br><span class="line">    tag.<span class="built_in">set</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n; i&gt;=<span class="number">1</span>; i--)</span><br><span class="line">      <span class="keyword">if</span>(tag[ord[i]])</span><br><span class="line">      &#123;</span><br><span class="line">        ++scc;</span><br><span class="line">        <span class="built_in">dfs2</span>(ord[i]);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—…è¡Œ æœ‰å‘å›¾ä¸¤ç‚¹å¯è¾¾æ€§</title>
      <link href="/2020/08/06/lu-xing-you-xiang-tu-liang-dian-ke-da-xing/"/>
      <url>/2020/08/06/lu-xing-you-xiang-tu-liang-dian-ke-da-xing/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å‡ºä¸€å¼ éšæœºç”Ÿæˆçš„æœ‰å‘å›¾ï¼Œå¤šæ¬¡è¯¢é—®xç‚¹èƒ½å¦åˆ°è¾¾yç‚¹<br>$n \leq 10^5,m \leq n + 5000,q \leq 3\times 10^5$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è·‘ä¸€étarjanç¼©ç‚¹æˆDAG<br>è®¾ç½®æ ¹å·ä¸ªæ ‡è®°ç‚¹ï¼Œç„¶åæš´åŠ›è·‘å‡ºè¿™äº›æ ‡è®°ç‚¹èƒ½å¤Ÿåˆ°è¾¾çš„ç‚¹ï¼Œç”¨bitsetè®°å½•<br>å¯¹äºæ¯ä¸ªè¯¢é—®ä»xæš´åŠ›dfsï¼Œé‡åˆ°æ ‡è®°ç‚¹åˆ™è¿”å›<br>æ ‡è®°ç‚¹é€‰æ‹©åº¦æ•°æœ€å¤§çš„æ ¹å·ä¸ª<br>å¤æ‚åº¦ï¼šO(èƒ½è¿‡)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, M = <span class="number">405</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N], DAG[N];</span><br><span class="line">vector&lt;pii&gt; edges;</span><br><span class="line"><span class="type">int</span> n, m, _;</span><br><span class="line"><span class="type">int</span> dfn[N], num[N], low[N], id, tot, sta[N], top, deg[N], idx[N];</span><br><span class="line"><span class="type">bool</span> in[N];</span><br><span class="line"><span class="type">int</span> vis[N], spe[N];</span><br><span class="line">bitset&lt;N&gt; bit[M];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  in[u] = <span class="number">1</span>;</span><br><span class="line">  low[u] = dfn[u] = ++id;</span><br><span class="line">  sta[++top] = u;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">tarjan</span>(v);</span><br><span class="line">      low[u] = <span class="built_in">min</span>(low[u],low[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(in[v]) low[u] = <span class="built_in">min</span>(low[u],dfn[v]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(low[u]==dfn[u])</span><br><span class="line">  &#123;</span><br><span class="line">    tot++;</span><br><span class="line">    <span class="keyword">while</span>(top)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> tmp = sta[top--];</span><br><span class="line">      in[tmp] = <span class="number">0</span>;</span><br><span class="line">      num[tmp] = tot;</span><br><span class="line">      <span class="keyword">if</span>(tmp==u) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(spe[u]) &#123; bit[t] |= bit[spe[u]]; <span class="keyword">return</span>; &#125;</span><br><span class="line">  vis[u] = t;</span><br><span class="line">  bit[t].<span class="built_in">set</span>(u);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : DAG[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[v]==t) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, t);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prework</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span>(!dfn[i]) <span class="built_in">tarjan</span>(i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : edges)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = num[it.fi], v = num[it.se];</span><br><span class="line">    <span class="keyword">if</span>(u!=v) DAG[u].<span class="built_in">pb</span>(v), deg[u]++, deg[v]++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> lim = (<span class="type">int</span>)<span class="built_in">sqrt</span>(tot) + <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">iota</span>(idx+<span class="number">1</span>, idx+tot+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">sort</span>(idx+<span class="number">1</span>, idx+tot+<span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">    <span class="keyword">return</span> deg[x] &gt; deg[y];</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lim; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">dfs</span>(idx[i], i);</span><br><span class="line">    spe[idx[i]] = i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t, <span class="type">int</span> tt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(s==t) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(spe[s]) <span class="keyword">return</span> bit[spe[s]].<span class="built_in">test</span>(t);</span><br><span class="line">  vis[s] = tt;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> ss : DAG[s])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[ss]==tt) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">dfs2</span>(ss, t, tt)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> u, v;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">  ++u, ++v;</span><br><span class="line">  <span class="keyword">if</span>(num[u]==num[v]) <span class="built_in">puts</span>(<span class="string">&quot;Good&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">puts</span>((<span class="built_in">dfs2</span>(num[u], num[v], t) ? <span class="string">&quot;Good&quot;</span> : <span class="string">&quot;Bad&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    ++u, ++v;</span><br><span class="line">    G[u].<span class="built_in">pb</span>(v);</span><br><span class="line">    edges.<span class="built_in">emplace_back</span>(u, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">prework</span>();</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;_);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=_; i++) <span class="built_in">solve</span>(<span class="number">400</span>+i);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‹¬å·åºåˆ—é—®é¢˜</title>
      <link href="/2020/07/30/gua-hao-xu-lie-wen-ti/"/>
      <url>/2020/07/30/gua-hao-xu-lie-wen-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰ç½®ç»“è®º"><a class="header-anchor" href="#å‰ç½®ç»“è®º">Â¶</a>å‰ç½®ç»“è®º</h2><p>å®šä¹‰å·¦æ‹¬å·â€™(â€˜ä¸º+1ï¼Œå³æ‹¬å·â€™)'ä¸º-1ï¼Œä½œå‰ç¼€å’Œå¾—åˆ°ä¸€ä¸ªåºåˆ—p<br>å½“ä¸”ä»…å½“$p_n = 0 \wedge \forall i \ p_i &gt;=0$æ—¶ï¼Œè¯¥æ‹¬å·åºåˆ—åˆæ³•</p><p>å–$mn = \min_{i=1}^n p_i$â€‹ï¼Œåˆ™è¯¥æ‹¬å·åºåˆ—çš„æœ€é•¿åˆæ³•æ‹¬å·å­åºåˆ—çš„é•¿åº¦ä¸º$n - p_n + 2mn$<br>è€ƒè™‘ä½ç½®posï¼Œå…¶ä¸­$p_{pos}=mn$ï¼Œåˆ™åœ¨$1â€¦pos$ä¸­ï¼Œæœ‰-mnä¸ªå³æ‹¬å·å¤±é…ï¼Œåœ¨$pos+1â€¦n$ä¸­æœ‰$p_n-mn$ä¸ªå·¦æ‹¬å·å¤±é…</p><p>ä¸€ä¸ªé•¿åº¦ä¸ºnï¼Œå³æ‹¬å·ä¸ªæ•°ä¸ºmï¼Œå¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼ä¸ºtçš„æ‹¬å·åºåˆ—çš„ä¸ªæ•°æœ‰$\binom{n}{n-m-t} - \binom{n}{n-m-t+1}$<br>å…ˆè€ƒè™‘å¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼ä¸å°äºtçš„æ–¹æ¡ˆæ•°ï¼š<br>åˆ©ç”¨è®¡ç®—å¡ç‰¹å…°æ•°çš„æ–¹æ³•ï¼Œæ‰€æœ‰å‡å»ä¸åˆæ³•ã€‚å…¶ä¸­æ‰€æœ‰å³$\binom{n}{m}$ã€‚ä¸åˆæ³•çš„å³åºåˆ—pçš„æœ€å°å€¼æ˜¯&lt;=t-1çš„ï¼Œè€ƒè™‘ä½ç½®posï¼Œå…¶ä¸­$p_{pos}=t-1$ï¼Œåˆ™åœ¨$1â€¦pos$ä¸­å·¦æ‹¬å·æ¯”å³æ‹¬å·å°‘$âˆ’(tâˆ’1)$ä¸ªï¼Œ$pos+1â€¦n$ä¸­å·¦æ‹¬å·æ¯”å³æ‹¬å·å¤š$nâˆ’2mâˆ’(tâˆ’1)$ï¼Œå°†$1â€¦pos$çš„å·¦å³æ‹¬å·ç¿»è½¬ï¼Œåˆ™$1â€¦n$ä¸­å·¦æ‹¬å·æ¯”å³æ‹¬å·å¤š$nâˆ’2mâˆ’2(tâˆ’1)$ä¸ªï¼Œå®¹æ˜“å‘ç°ä¸åˆæ³•çš„æ‹¬å·åºåˆ—ä¸å·¦æ‹¬å·æ¯”å³æ‹¬å·å¤š$nâˆ’2mâˆ’2(tâˆ’1)$ä¸ªçš„æ‹¬å·åºåˆ—ä¸€ä¸€å¯¹åº”ï¼Œæ‰€ä»¥ä¸åˆæ³•å³ä¸º$\binom{n}{n-m-t+1}$<br>é‚£ä¹ˆå¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼ä¸å°äºt+1çš„æ–¹æ¡ˆæ•°ä¸º$\binom{n}{m} - \binom{n}{n-m-t}$<br>åˆ™å¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼ä¸ºtçš„æ–¹æ¡ˆæ•°ä¸º$\binom{n}{n-m-t} - \binom{n}{n-m-t+1}$</p><p>ä¸€ä¸ªæ‹¬å·åºåˆ—å¾ªç¯ç§»ä½ååˆæ³•çš„æ–¹æ¡ˆæ•°ï¼š</p><ul><li>è‹¥å·¦æ‹¬å·æ•°ä¸ç­‰äºå³æ‹¬å·æ•°ï¼Œæ˜¾ç„¶æ— è§£</li><li>ans = pä¸­æœ€å°å€¼å‡ºç°çš„æ¬¡æ•°ï¼Œè‹¥$p_{pos} = mn$ï¼Œåˆ™å°†$1â€¦pos$ç§»åˆ°åé¢ï¼Œ$pos+1â€¦n$ç§»åˆ°å‰é¢åˆ™åˆæ³•</li></ul><h2 id="æ´›è°·p6689-åºåˆ—"><a class="header-anchor" href="#æ´›è°·p6689-åºåˆ—">Â¶</a>æ´›è°·p6689 åºåˆ—</h2><h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ä¸€ä¸ªé•¿åº¦ä¸ºnï¼Œåˆå§‹å…¨ä¸ºâ€™(â€˜çš„æ‹¬å·åºåˆ—ï¼Œç»™å®šå‚æ•°kï¼Œæ¯æ¬¡éšæœºåœ¨[1,n]é€‰æ‹©ä¸€ä¸ªä½ç½®ç„¶åç¿»è½¬è¯¥ä½ç½®çš„æ‹¬å·ï¼Œå½“ç¿»è½¬äº†ä¸€ä¸ªâ€™('ï¼Œå°±è®©k-1ï¼Œé‡å¤ç›´è‡³k=0ã€‚è¯¢é—®æœ€åç”Ÿæˆçš„æ‹¬å·åºåˆ—çš„æœ€é•¿åˆæ³•å­åºåˆ—çš„æœŸæœ›é•¿åº¦<br>$n, k&lt;=5\times 10^3$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>çŸ¥é“ä¸€ä¸ªæ‹¬å·åºåˆ—çš„å·¦å³æ‹¬å·çš„ä¸ªæ•°ä»¥åŠå…¶å¯¹åº”çš„åºåˆ—pçš„æœ€å°å€¼å°±å¯ä»¥å¾—åˆ°è¯¥æ‹¬å·åºåˆ—çš„æœ€é•¿åˆæ³•å­åºåˆ—çš„é•¿åº¦ã€‚<br>å…ˆæ±‚å‡ºé•¿åº¦ä¸ºnçš„æ‹¬å·åºåˆ—ä¸­æœ‰mä¸ªå³æ‹¬å·çš„æ¦‚ç‡ï¼Œå†æšä¸¾åºåˆ—pçš„æœ€å°å€¼å³å¯è§£å†³ï¼Œè¿™æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„é—®é¢˜ã€‚<br>é¦–å…ˆæ¦‚ç‡dpï¼š$f_{ij}$è¡¨ç¤ºå½“å‰å‚æ•°ä¸ºiï¼Œå·²ç»æœ‰jä¸ªå³æ‹¬å·çš„æ¦‚ç‡<br>$f_{ij} = \dfrac{n-j+1}{n}\sum_{k=j-1}^{n} f_{ik}<br>\prod_{l=j}^{k}\dfrac{l}{n}$<br>$f_{ij}$â€‹å¯ä»¥ç”±$j-1â€¦n$ä¸ªå³æ‹¬å·çš„æƒ…å†µè½¬ç§»è¿‡æ¥ï¼Œç›¸å½“äºå…ˆè¿ç»­å°†xä¸ªå³æ‹¬å·å˜æˆå·¦æ‹¬å·ï¼Œç„¶åå†å°†1ä¸ªå·¦æ‹¬å·å˜æˆå³æ‹¬å·<br>$\dfrac{f_{0m}}{\binom{n}{m}}$â€‹â€‹å°±ç­‰äºç”Ÿæˆä¸€ä¸ªæœ‰mä¸ªå³æ‹¬å·çš„æ‹¬å·åºåˆ—çš„æ¦‚ç‡<br>æœ€åæšä¸¾è¿™ä¸ªæ‹¬å·åºåˆ—çš„æœ€å°å€¼ï¼Œç„¶åä¾æ®ä¸Šé¢çš„å…¬å¼è®¡ç®—å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">998244353</span>, N = <span class="number">5e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a = <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) <span class="keyword">return</span> a-mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) a+=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) <span class="keyword">return</span> a+mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="type">int</span> n, k, f[N][N], fac[N], inv[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) <span class="built_in">mul</span>(ans, a);</span><br><span class="line">    <span class="built_in">mul</span>(a, a);</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) fac[i] = <span class="number">1ll</span>*fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">  inv[n] = <span class="built_in">powmod</span>(fac[n], mod<span class="number">-2</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--) inv[i] = <span class="number">1ll</span>*inv[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">comb</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a&lt;b||b&lt;<span class="number">0</span>||a&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1ll</span>*fac[a]*inv[b]%mod*inv[a-b]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  <span class="type">int</span> invn = <span class="built_in">powmod</span>(n, mod<span class="number">-2</span>);</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">init</span>(n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> sum = f[i<span class="number">-1</span>][n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=n; j&gt;=<span class="number">1</span>; j--)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">mul</span>(sum, <span class="built_in">Mul</span>(j, invn));</span><br><span class="line">      <span class="built_in">add</span>(sum, f[i<span class="number">-1</span>][j<span class="number">-1</span>]);</span><br><span class="line">      f[i][j] = <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(invn, (n-j+<span class="number">1</span>)), sum);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">mul</span>(f[k][i], <span class="built_in">powmod</span>(<span class="built_in">comb</span>(n, i), mod<span class="number">-2</span>));</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">auto</span> cal = [](<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)-&gt;<span class="type">int</span> <span class="comment">//é•¿åº¦ä¸ºxçš„æ‹¬å·åºåˆ—ï¼Œæœ‰yä¸ªå³æ‹¬å·ï¼Œå¯¹åº”åºåˆ—pçš„æœ€å°å€¼ä¸ºzçš„æ–¹æ¡ˆæ•°</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Sub</span>(<span class="built_in">comb</span>(x, x-y-z), <span class="built_in">comb</span>(x, x-y-z+<span class="number">1</span>));</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="comment">//æšä¸¾å³æ‹¬å·ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">2</span>; j&lt;=n&amp;&amp;<span class="built_in">min</span>(i, n-i)&gt;=j/<span class="number">2</span>; j+=<span class="number">2</span>) <span class="comment">//æšä¸¾æœ€é•¿åˆæ³•å­åºåˆ—çš„é•¿åº¦ä¸ºjï¼Œåˆ™æ­¤æ—¶påºåˆ—çš„mn=(j-2i)/2</span></span><br><span class="line">      <span class="built_in">add</span>(ans, <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(j, f[k][i]), <span class="built_in">cal</span>(n, i, (j<span class="number">-2</span>*i)/<span class="number">2</span>)));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D2-The-World-Is-Just-a-Programming-Task-Hard-Version"><a class="header-anchor" href="#D2-The-World-Is-Just-a-Programming-Task-Hard-Version">Â¶</a>D2. The World Is Just a Programming Task (Hard Version)</h2><h3 id="é¢˜æ„-s2"><a class="header-anchor" href="#é¢˜æ„-s2">Â¶</a>é¢˜æ„</h3><p>ç»™å®šä¸€ä¸ªæ‹¬å·åºåˆ—ï¼Œè¦æ±‚äº¤æ¢å…¶ä¸­ä¸¤ä¸ªä½ç½®çš„æ‹¬å·ï¼Œä½¿å¾—è¯¥æ‹¬å·åºåˆ—å¾ªç¯ç§»ä½ååˆæ³•çš„æ–¹æ¡ˆæ•°æœ€å¤š<br>$n&lt;=3\times 10^5$</p><h4 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h4><p>ç”±ä¸Šé¢ç»“è®ºå¯å¾—ï¼Œå°±æ˜¯è¦æœ€å¤§åŒ–è¯¥æ‹¬å·åºåˆ—å¯¹åº”çš„påºåˆ—çš„æœ€å°å€¼çš„ä¸ªæ•°<br>æ˜¾ç„¶äº¤æ¢ä¸¤ä¸ªç›¸åŒçš„æ‹¬å·æ˜¯æ²¡æœ‰æ„ä¹‰çš„<br>å½“äº¤æ¢ä¸€ä¸ªå·¦æ‹¬å·å’Œä¸€ä¸ªå³æ‹¬å·æ—¶ï¼Œç›¸å½“äºå¯¹è¿™æ®µåŒºé—´çš„påºåˆ—-2<br>å½“äº¤æ¢ä¸€ä¸ªå³æ‹¬å·å’Œä¸€ä¸ªå·¦æ‹¬å·æ—¶ï¼Œç›¸å½“äºå¯¹è¿™æ®µåŒºé—´çš„påºåˆ—+2<br>æ˜¾ç„¶åŒºé—´+2åªä¼šä½¿æœ€å°å€¼ä¸ªæ•°å‡å°‘<br>ä¸‹é¢è€ƒè™‘åŒºé—´-2ï¼š<br>å¦‚æœæ“ä½œçš„åŒºé—´ä¸­åŒ…å«äº†åŸæ¥æœ€å°å€¼çš„æŸä¸ªä½ç½®ï¼Œæ˜¾ç„¶ç­”æ¡ˆä¸ä¼šæ›´ä¼˜<br>æ‰€ä»¥è®¾$pos_1,â€¦,pos_x$â€‹ä¸ºpåºåˆ—æœ€å°å€¼æ‰€å¤„çš„ä½ç½®ï¼Œé‚£ä¹ˆæ“ä½œçš„åŒºé—´åªå¯èƒ½æ˜¯$(pos1,pos2)â€¦$ï¼Œä¹Ÿå¯èƒ½æ˜¯$(pos_x,pos_1)$ï¼Œå‡†ç¡®æ¥è¯´æ˜¯å¯¹$[pos_1,pos_x]+2$ï¼Œç›¸å½“äºæ˜¯å¯¹$(posx,n]$ï¼Œ$[1,pos_1)-2(posxâ€‹,n]$ï¼Œ$[1,pos1â€‹)âˆ’2$<br>æœ€ä¼˜çš„æƒ…å†µåªæœ‰ä¸¤ç§ï¼š</p><ul><li>è®©æœ€å°å€¼å˜æˆmn-1ï¼Œåªè¦ç»Ÿè®¡å‡ºä»¥ä¸ŠåŒºé—´ä¸­ç­‰äºmn+1çš„æœ€å¤šä¸ªæ•°å³å¯ï¼ˆæ˜¾ç„¶æ“ä½œåŒºé—´è¶Šå¤§è¶Šå¥½ï¼Œå³$[pos_i, pos_{i+1}]$ï¼‰</li><li>è®©æœ€å°å€¼ä»ä¸ºmnï¼Œéœ€è¦ç»Ÿè®¡å‡ºä»¥ä¸ŠåŒºé—´ä¸­è¿ç»­çš„ä¸”<strong>ä¸åŒ…å«mn+1</strong>çš„ç„¶åmn+2å€¼æœ€å¤šçš„ä¸ªæ•°ï¼Œè¿˜è¦å†åŠ ä¸ŠåŸæœ¬ç­‰äºmnçš„ä¸ªæ•°ï¼ˆåœ¨ä»¥ä¸Šæ¯ä¸ªæ“ä½œåŒºé—´ä¸­ä½œå°ºå–æ³•å³å¯ï¼Œé‡è§mn+1å°±è®©è®¡æ•°å™¨æ¸…ç©ºï¼Œå¦åˆ™ä¸æ–­å¾€å³ç§»åŠ¨ï¼‰<br>ä»¥ä¸Šä¸¤è€…å–ä¼˜å³å¯</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, p[N];</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; (s+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) p[i] = (p[i<span class="number">-1</span>] + (s[i]==<span class="string">&#x27;(&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>));</span><br><span class="line">  <span class="keyword">if</span>(p[n]) &#123; cout &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">  <span class="type">int</span> mn = *<span class="built_in">min_element</span>(p+<span class="number">1</span>, p+n+<span class="number">1</span>);</span><br><span class="line">  vector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span>(p[i]==mn) vec.<span class="built_in">pb</span>(i);</span><br><span class="line">  <span class="type">int</span> ans = <span class="built_in">sz</span>(vec);</span><br><span class="line">  pii pos = &#123;<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sz</span>(vec)<span class="number">-1</span>; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = vec[i] + <span class="number">1</span>, k = vec[i+<span class="number">1</span>] - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(j&gt;k) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="type">int</span> one = <span class="number">0</span>, two = <span class="number">0</span>, tmp = <span class="number">0</span>, st = <span class="number">0</span>;</span><br><span class="line">    pii pp = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> _=j; _&lt;=k; _++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(p[_]==mn+<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        ++one;</span><br><span class="line">        tmp = st = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(p[_]==mn+<span class="number">2</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        ++tmp;</span><br><span class="line">        <span class="keyword">if</span>(!st) st = _;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(tmp&gt;two)</span><br><span class="line">      &#123;</span><br><span class="line">        two = tmp;</span><br><span class="line">        pp = &#123;st, _%n+<span class="number">1</span>&#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(one&gt;ans) ans = one, pos = &#123;j, k%n+<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span>(two+<span class="built_in">sz</span>(vec)&gt;ans) ans = two+<span class="built_in">sz</span>(vec), pos = pp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> one = <span class="number">0</span>, two = <span class="number">0</span>, tmp = <span class="number">0</span>, st = <span class="number">0</span>;</span><br><span class="line">  pii pp = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> _=vec.<span class="built_in">back</span>()%n+<span class="number">1</span>; _!=vec.<span class="built_in">front</span>(); _=_%n+<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p[_]==mn+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ++one;</span><br><span class="line">      tmp = st = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p[_]==mn+<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ++tmp;</span><br><span class="line">      <span class="keyword">if</span>(!st) st = _;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tmp&gt;two)</span><br><span class="line">    &#123;</span><br><span class="line">      two = tmp;</span><br><span class="line">      pp = &#123;st, _%n+<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(one&gt;ans) ans = one, pos = &#123;vec.<span class="built_in">back</span>()%n+<span class="number">1</span>, vec.<span class="built_in">front</span>()&#125;;</span><br><span class="line">  <span class="keyword">if</span>(two+<span class="built_in">sz</span>(vec)&gt;ans) ans = two+<span class="built_in">sz</span>(vec), pos = pp;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  cout &lt;&lt; pos.fi &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; pos.se &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ´›è°·7æœˆæœˆèµ›</title>
      <link href="/2020/07/27/luo-gu-7-yue-yue-sai/"/>
      <url>/2020/07/27/luo-gu-7-yue-yue-sai/</url>
      
        <content type="html"><![CDATA[<h2 id="P6685-å¯æŒä¹…åŒ–åŠ¨æ€ä»™äººæŒçš„ç›´å¾„é—®é¢˜"><a class="header-anchor" href="#P6685-å¯æŒä¹…åŒ–åŠ¨æ€ä»™äººæŒçš„ç›´å¾„é—®é¢˜">Â¶</a>P6685 å¯æŒä¹…åŒ–åŠ¨æ€ä»™äººæŒçš„ç›´å¾„é—®é¢˜</h2><h3 id="é¢˜ç›®"><a class="header-anchor" href="#é¢˜ç›®">Â¶</a>é¢˜ç›®</h3><p>ç»™å®šn, mï¼Œæ±‚æ»¡è¶³$x^m \leq n$çš„æ­£æ•´æ•°xä¸ªæ•°ï¼Œ$n\leq 10^9, m\leq 10^9$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><ul><li>m=1, ans = n</li><li>m&gt;=2æ—¶æ˜¾ç„¶ç­”æ¡ˆå¾ˆå°ï¼Œ <s>æ‰€ä»¥éšä¾¿æ€ä¹ˆæå°±è¡Œ</s> ï¼Œå¦‚æœäºŒåˆ†çš„è¯æ³¨æ„ä¸‹ç•Œä»2å¼€å§‹(å› ä¸ºè¿™ä¸ªtäº†å¥½å‡ å‘ğŸ‘€)</li></ul><h2 id="P6686-æ··å‡åœŸæ•°å­¦"><a class="header-anchor" href="#P6686-æ··å‡åœŸæ•°å­¦">Â¶</a>P6686 æ··å‡åœŸæ•°å­¦</h2><h3 id="é¢˜ç›®-s2"><a class="header-anchor" href="#é¢˜ç›®-s2">Â¶</a>é¢˜ç›®</h3><p>ç»™å®šnæ ¹æœ¨æ£çš„é•¿åº¦$a_i$â€‹ï¼Œæ±‚é€‰æ‹©ä¸‰æ ¹æ„æˆç­‰è…°ä¸‰è§’å½¢çš„æ–¹æ¡ˆæ•°(æ— åºå¯¹)</p><h3 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h3><p>æ˜¾ç„¶æ’åºåæšä¸¾è…°é•¿xç„¶åäºŒåˆ†$\lt 2x$çš„æ•°çš„ä¸ªæ•°å³å¯</p><h2 id="P6687-è®ºå¦‚ä½•ç©è½¬-Excel-è¡¨æ ¼"><a class="header-anchor" href="#P6687-è®ºå¦‚ä½•ç©è½¬-Excel-è¡¨æ ¼">Â¶</a>P6687 è®ºå¦‚ä½•ç©è½¬ Excel è¡¨æ ¼</h2><h3 id="é¢˜ç›®-s3"><a class="header-anchor" href="#é¢˜ç›®-s3">Â¶</a>é¢˜ç›®</h3><p>$2 \times n$çš„ç½‘æ ¼ï¼Œä¸é‡å¤çš„å¡«å…¥$1 \sim 2n$ï¼Œç°åœ¨æœ‰ä¸€ç§æ“ä½œï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©$2 \times 2$çš„æ­£æ–¹å½¢åŒºåŸŸç„¶åæ—‹è½¬$180^\circ$ï¼Œé—®ä»ç»™å®šç½‘æ ¼åˆ°ç›®æ ‡ç½‘æ ¼çš„æœ€å°‘æ“ä½œæ¬¡æ•°ï¼Œæˆ–è¾“å‡ºæ— è§£<br>$n&lt;=10^6$</p><p>$$\begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix} \quad$$</p><p>$$\begin{bmatrix} 4 &amp; 3 \\ 2 &amp; 1 \end{bmatrix} \quad$$</p><h3 id="åšæ³•-s3"><a class="header-anchor" href="#åšæ³•-s3">Â¶</a>åšæ³•</h3><p>å®¹æ˜“å‘ç°å¯¹åŒä¸€ä¸ªæ­£æ–¹å½¢åŒºåŸŸæ“ä½œä¸¤æ¬¡ç­‰äºä¸æ“ä½œï¼Œæ“ä½œä¸€æ¬¡ç›¸å½“äºäº¤æ¢ç›¸é‚»ä¸¤åˆ—ï¼Œå¹¶ä¸”ä¸¤è¡Œå…ƒç´ äº¤æ¢ã€‚<br>æ‰€ä»¥ä¸ç®¡æ€ä¹ˆæ“ä½œæ¯åˆ—çš„ä¸¤ä¸ªå…ƒç´ æ˜¯å›ºå®šçš„ï¼Œæœ€å¤šä¸Šä¸‹ä½ç½®äº¤æ¢ä¸€ä¸‹ã€‚<br>è€ƒè™‘å½“å‰ç½‘æ ¼ä¸­ç¬¬iåˆ—çš„ä¸¤ä¸ªå…ƒç´ åœ¨ç›®æ ‡ç½‘æ ¼ä¸­ç¬¬jåˆ—(å¦‚æœä¸¤ä¸ªå…ƒç´ åœ¨ä¸åŒåˆ—ï¼Œæ˜¾ç„¶æ— è§£)ï¼Œå¦‚æœj-iä¸ºå¥‡æ•°åˆ™ä½ç½®åº”è¯¥é¢ å€’ï¼Œå¶æ•°åˆ™ä½ç½®åº”è¯¥ç›¸åŒã€‚è¿™æ ·æ‰«ä¸€éå°±å¯ä»¥åˆ¤å®šæœ‰æ²¡æœ‰è§£ã€‚<br>å¯ä»¥å‘ç°æœ€åå°±æ˜¯è¦è®©ç¬¬iåˆ—è½¬ç§»åˆ°ç¬¬$p_i$â€‹åˆ—ï¼Œè€ƒè™‘ä¸€ä¸ªæ’åˆ—ï¼Œæ¯æ¬¡åªèƒ½äº¤æ¢ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ï¼Œé—®ä½¿å…¶æœ‰åºæœ€å°‘éœ€è¦çš„æ“ä½œæ¬¡æ•°ã€‚ç­”æ¡ˆä¸ºé€†åºå¯¹ä¸ªæ•°ã€‚<br>è®¾fä¸ºä¸€ä¸ªç½®æ¢ï¼Œ$f(p) = 1,2,3,â€¦,n$ï¼Œåˆ™ç­”æ¡ˆä¸º$f^{-1}$çš„é€†åºå¯¹æ•°ï¼Œæ ‘çŠ¶æ•°ç»„å³å¯</p><h2 id="P6688-å¯é‡é›†"><a class="header-anchor" href="#P6688-å¯é‡é›†">Â¶</a>P6688 å¯é‡é›†</h2><h3 id="é¢˜ç›®-s4"><a class="header-anchor" href="#é¢˜ç›®-s4">Â¶</a>é¢˜ç›®</h3><p>ç»™å®šæ•°ç»„$a_i$â€‹ï¼Œæ”¯æŒå•ç‚¹ä¿®æ”¹ï¼Œå¹¶å¤šæ¬¡è¯¢é—®åŒºé—´[l1:r1]ä¸åŒºé—´[l2:r2]æ˜¯å¦æœ¬è´¨ç›¸åŒã€‚å…¶ä¸­æœ¬è´¨ç›¸åŒåªå¯¹è¿™ä¸¤ä¸ªåŒºé—´æ’åºåï¼Œå¯¹åº”å…ƒç´ çš„å·®å€¼å‡ä¸ºæ•´æ•°kã€‚$n&lt;=10^6$</p><h3 id="åšæ³•-s4"><a class="header-anchor" href="#åšæ³•-s4">Â¶</a>åšæ³•</h3><p>å…ˆè¯´ä¸€ä¸‹P3792 ç”±ä¹ƒä¸å¤§æ¯ç¥åŸå‹å’Œå¶åƒå´‡æ‹œ<br>è¿™é¢˜ï¼Œæ”¯æŒå•ç‚¹ä¿®æ”¹ï¼Œå¹¶å¤šæ¬¡è¯¢é—®åŒºé—´[l:r]åœ¨é‡æ’åæ˜¯å¦æ˜¯å€¼åŸŸè¿ç»­çš„ã€‚è¿™ä¸¤é“é¢˜çš„ç‰¹ç‚¹éƒ½æ˜¯ä¸€çœ¼ä¸å¯åšï¼Œè€Œè§£æ³•æ˜¯æ•°æ®ç»“æ„+å“ˆå¸Œï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯ä¸€å®šæ­£ç¡®ã€‚ç»´æŠ¤å‡ºåŒºé—´æœ€å°å€¼ï¼ŒåŒºé—´æœ€å¤§å€¼ï¼ŒåŒºé—´å’Œï¼ŒåŒºé—´å¹³æ–¹å’Œï¼Œç„¶ååˆ¤æ–­å³å¯<br>ä»è¿™é¢˜çš„æ€è·¯å®¹æ˜“æƒ³åˆ°é€šè¿‡ç»´æŠ¤åŒºé—´å’Œå¾ˆå®¹æ˜“å¾—åˆ°è¿™ä¸ªå·®å€¼kï¼Œç„¶åå†ç»´æŠ¤å¹³æ–¹å’Œï¼Ÿå¾ˆä¸å¹¸è¢«å‡ºé¢˜äººå¡æˆäº†0ptsã€‚ä¸‰æ¬¡æ–¹ï¼Ÿæ²¡å•¥ç”¨ã€‚ã€‚<br>è€ƒè™‘è®¾ç½®ä¸€ä¸ªæ•°magicï¼Œç„¶åç»´æŠ¤$\sum magic^{a_i}$â€‹ï¼Œç„¶ååªè¦çœ‹$\sum_{i=l1}^{r1}magic^{a_i} * magic^k==\sum_{i=l2}^{r2}magic^{a_i}$<br>ç”±äºå¾ˆå¤§è¦å–æ¨¡ï¼Œmagicå’Œmodéšä¾¿è®¾å°±èƒ½è¿‡ã€‚ã€‚å½“ç„¶åº”è¯¥èƒ½å¡<br>ä¸Šé¢çš„æ–¹æ³•æ˜¯æŠŠåŠ æ³•åˆ©ç”¨å¹‚æ¬¡è½¬æˆä¹˜æ³•ï¼Œå¦ä¸€ç§åšæ³•æ˜¯åˆ©ç”¨sinã€‚<br>$sin(x+y) = sinxcosy + cosxsiny$<br>$cos(x+y) = cosxcosy âˆ’ sinxsiny$<br>ç»´æŠ¤ä¸€ä¸‹$\sum sinx$å’Œ$\sum cosx$ï¼ŒåŒæ ·å…ˆåˆ©ç”¨åŒºé—´å’Œæå‡ºkï¼Œç„¶åç”¨ä¸Šé¢çš„å…¬å¼åˆ¤æ–­å³å¯ï¼Œæ³¨æ„doubleæ¯”è¾ƒç”¨eps<br>å…·ä½“æ€ä¹ˆç»´æŠ¤å¯ä»¥çœ‹p6327ï¼ŒåŒºé—´ä¿®æ”¹+åŒºé—´sinå’Œã€‚æœ¬é¢˜æ˜¯å•ç‚¹ä¿®æ”¹+åŒºé—´sinå’Œ<br>ç”±äºnæ˜¯$10^6$çº§åˆ«ï¼Œè€Œä¸”æ˜¯å•ç‚¹ä¿®+åŒºé—´æŸ¥ï¼Œæ‰€ä»¥æ ‘çŠ¶æ•°ç»„å³å¯<br>å½“ç„¶ä»¥ä¸Šåªæ˜¯éƒ¨åˆ†å¯ä»¥é€šè¿‡çš„è§£æ³•ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ‹“å±•ä¸€ä¸‹æ€è·¯ï¼ˆè½¬æˆå¹‚æ¬¡ï¼Œè½¬æˆsinï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> magic = <span class="number">1919810</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a = <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) <span class="keyword">return</span> a-mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) a+=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) <span class="keyword">return</span> a+mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="keyword">namespace</span> IO</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line">  <span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++); &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">    <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">    t *= f;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">out</span><span class="params">(T p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> sta[<span class="number">70</span>], tp;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>) &#123; <span class="built_in">putchar</span>(<span class="string">&#x27;0&#x27;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;<span class="number">0</span>) &#123; p = -p; <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>); &#125;</span><br><span class="line">    <span class="keyword">while</span>(p) sta[++tp] = p%<span class="number">10</span>, p/=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">while</span>(tp) <span class="built_in">putchar</span>(sta[tp--]+<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO;</span><br><span class="line"><span class="type">int</span> n, q, a[N], pw[N];</span><br><span class="line"><span class="type">int</span> c[N];</span><br><span class="line">ll sum[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) <span class="built_in">add</span>(c[i], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) <span class="built_in">sub</span>(c[i], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) <span class="built_in">add</span>(ans, c[i]);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v, <span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) sum[i] += v*op;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask2</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += sum[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">powmod</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(b&lt;N) <span class="keyword">return</span> pw[b];</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = ans*a%mod;</span><br><span class="line">    a = a*a%mod;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">read</span>(n), <span class="built_in">read</span>(q);</span><br><span class="line">  pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;N; i++) pw[i] = <span class="built_in">Mul</span>(pw[i<span class="number">-1</span>], magic);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">ins</span>(i, pw[a[i]]);</span><br><span class="line">    <span class="built_in">upd</span>(i, a[i], <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op; <span class="built_in">read</span>(op);</span><br><span class="line">    <span class="keyword">if</span>(!op)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x, y;</span><br><span class="line">      <span class="built_in">read</span>(x), <span class="built_in">read</span>(y);</span><br><span class="line">      <span class="built_in">del</span>(x, pw[a[x]]);</span><br><span class="line">      <span class="built_in">upd</span>(x, a[x], <span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">ins</span>(x, pw[a[x]=y]);</span><br><span class="line">      <span class="built_in">upd</span>(x, a[x], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l1, r1, l2, r2;</span><br><span class="line">      <span class="built_in">read</span>(l1), <span class="built_in">read</span>(r1), <span class="built_in">read</span>(l2), <span class="built_in">read</span>(r2);</span><br><span class="line">      <span class="type">int</span> x = <span class="built_in">Sub</span>(<span class="built_in">ask</span>(r1), <span class="built_in">ask</span>(l1<span class="number">-1</span>)), y = <span class="built_in">Sub</span>(<span class="built_in">ask</span>(r2), <span class="built_in">ask</span>(l2<span class="number">-1</span>));</span><br><span class="line">      ll s1 = <span class="built_in">ask2</span>(r1) - <span class="built_in">ask2</span>(l1<span class="number">-1</span>), s2 = <span class="built_in">ask2</span>(r2) - <span class="built_in">ask2</span>(l2<span class="number">-1</span>);</span><br><span class="line">      <span class="keyword">if</span>((s2-s1)%(r1-l1+<span class="number">1</span>)) cout &lt;&lt; <span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        ll k = (s2-s1)/(r1-l1+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(k&lt;<span class="number">0</span>) k = -k, <span class="built_in">swap</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span>(x*<span class="built_in">powmod</span>(magic, k)%mod==y) cout &lt;&lt; <span class="string">&quot;YES\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">namespace</span> IO</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line">  <span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++); &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">    <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">    t *= f;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt; <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">out</span><span class="params">(T p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> sta[<span class="number">70</span>], tp;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>) &#123; <span class="built_in">putchar</span>(<span class="string">&#x27;0&#x27;</span>); <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;<span class="number">0</span>) &#123; p = -p; <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>); &#125;</span><br><span class="line">    <span class="keyword">while</span>(p) sta[++tp] = p%<span class="number">10</span>, p/=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">while</span>(tp) <span class="built_in">putchar</span>(sta[tp--]+<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO;</span><br><span class="line"><span class="type">int</span> n, q, a[N];</span><br><span class="line">ll sum[N];</span><br><span class="line"><span class="type">double</span> snx[N], csx[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">sgn</span><span class="params">(<span class="type">double</span> x)</span> </span>&#123; <span class="keyword">return</span> (x&lt;-eps ? <span class="number">-1</span> : x&gt;eps); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v, <span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">double</span> snv = <span class="built_in">sin</span>(v), csv = <span class="built_in">cos</span>(v);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i))</span><br><span class="line">  &#123;</span><br><span class="line">    sum[i] += v*op;</span><br><span class="line">    snx[i] += snv*op;</span><br><span class="line">    csx[i] += csv*op;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += sum[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="keyword">operator</span> - (pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; a, pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; b) &#123; <span class="keyword">return</span> <span class="built_in">mp</span>(a.fi-b.fi, a.se-b.se); &#125;</span><br><span class="line"><span class="function">pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="title">ask2</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">double</span> sn = <span class="number">0.0</span>, cs = <span class="number">0.0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) sn += snx[i], cs += csx[i];</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">mp</span>(sn, cs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">read</span>(n); <span class="built_in">read</span>(q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">upd</span>(i, a[i], <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">read</span>(op);</span><br><span class="line">    <span class="keyword">if</span>(op)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l1, r1, l2, r2;</span><br><span class="line">      <span class="built_in">read</span>(l1); <span class="built_in">read</span>(r1); <span class="built_in">read</span>(l2); <span class="built_in">read</span>(r2);</span><br><span class="line">      ll x = <span class="built_in">ask</span>(r1) - <span class="built_in">ask</span>(l1<span class="number">-1</span>);</span><br><span class="line">      ll y = <span class="built_in">ask</span>(r2) - <span class="built_in">ask</span>(l2<span class="number">-1</span>);</span><br><span class="line">      <span class="keyword">if</span>((y-x)%(r1-l1+<span class="number">1</span>)) <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        ll k = (y-x)/(r1-l1+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">auto</span> p = <span class="built_in">ask2</span>(r1) - <span class="built_in">ask2</span>(l1<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">auto</span> q = <span class="built_in">ask2</span>(r2) - <span class="built_in">ask2</span>(l2<span class="number">-1</span>);</span><br><span class="line">        <span class="type">double</span> snk = <span class="built_in">sin</span>(k), csk = <span class="built_in">cos</span>(k);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">sgn</span>(q.fi-p.fi*csk-p.se*snk) || <span class="built_in">sgn</span>(q.se-p.se*csk+p.fi*snk)) <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x, y;</span><br><span class="line">      <span class="built_in">read</span>(x); <span class="built_in">read</span>(y);</span><br><span class="line">      <span class="built_in">upd</span>(x, a[x], <span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">upd</span>(x, a[x]=y, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shift-and/or å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•</title>
      <link href="/2020/07/22/shift-andor-zi-fu-chuan-pi-pei-suan-fa/"/>
      <url>/2020/07/22/shift-andor-zi-fu-chuan-pi-pei-suan-fa/</url>
      
        <content type="html"><![CDATA[<h2 id="shift-and"><a class="header-anchor" href="#shift-and">Â¶</a>shift-and</h2><p>åœ¨ä¸²sä¸­æŸ¥æ‰¾ä¸²t<br>è§„å®šä¸²sçš„é•¿åº¦ä¸ºnï¼Œä¸²tçš„é•¿åº¦ä¸ºmï¼Œå­—ç¬¦ä¸²ä¸‹æ ‡ä»0å¼€å§‹<br>bitset<m> B[26];<br>é¢„å¤„ç†å­—ç¬¦é›†ä¸­æ¯ä¸ªå­—æ¯åœ¨ä¸²tä¸­çš„å‡ºç°çš„ä½ç½®ï¼Œå„ç”¨ä¸€ä¸ªbitsetè¡¨ç¤ºã€‚B[s[i]-â€˜aâ€™]è¡¨ç¤ºçš„æ˜¯sä¸²ä¸­iä½ç½®ä¸tä¸²ä¸­å“ªäº›ä½ç½®å¯ä»¥åŒ¹é…<br>bitset<m> D;<br>åœ¨sä¸­æšä¸¾ä½ç½®iï¼ŒD[j]=1ä»…å½“ä¸²tçš„å‰ç¼€t[0â€¦j]æ˜¯ä¸²sçš„åç¼€s[i-jâ€¦i]<br>å½“D[m-1]=1æ—¶è¡¨ç¤ºä¸€æ¬¡åŒ¹é…<br>å½“æšä¸¾ä½ç½®i+1ï¼Œå°±è¦æ›´æ–°D<br>D = (D&lt;&lt;1|1)&amp;B[s[i+1]-â€˜aâ€™];<br>å¤æ‚åº¦$O(\frac{nm}{32})$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">shift_and</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n = <span class="built_in">strlen</span>(s), m = <span class="built_in">strlen</span>(t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    B[s[i]-<span class="string">&#x27;A&#x27;</span>].<span class="built_in">set</span>(i);</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    D &lt;&lt;= <span class="number">1</span>; D.<span class="built_in">set</span>(<span class="number">0</span>);</span><br><span class="line">    D &amp;= B[t[i]-<span class="string">&#x27;A&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(D[n<span class="number">-1</span>]) cnt++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="shift-or"><a class="header-anchor" href="#shift-or">Â¶</a>shift-or</h2><p>ä¸shiftandçš„Bå’ŒDå«ä¹‰éƒ½ç›¸åï¼ŒB=0è¡¨ç¤ºå­˜åœ¨ï¼ŒD=0è¡¨ç¤ºåŒ¹é…ï¼Œæ‰€ä»¥åˆå§‹æ—¶Bå’ŒDå…¨ä¸º1ï¼Œæ¯æ¬¡è½¬ç§»D = (D&lt;&lt;1|B[s[i]-â€˜aâ€™])</p><p>åœ¨æ™®é€šçš„å­—ç¬¦ä¸²åŒ¹é…ä¸­è¿™ä¸¤è€…çš„ä½œç”¨æ˜¾ç„¶æ²¡æœ‰kmpå¼ºï¼Œå¤æ‚åº¦åŠ£åŠ¿<br>ä½†æ˜¯åœ¨å¯é€‰å­—ç¬¦åŒ¹é…ä¸­å¾ˆæœ‰ç”¨<br>è§„å®šæ¯ä¸ªä½ç½®å¯ä»¥ä¸å¤šä¸ªå­—ç¬¦ç›¸åŒ¹é…ï¼Œæ­¤æ—¶åªè¦è®©è¿™äº›å­—ç¬¦çš„Bçš„é‚£ä¸ªä½ç½®éƒ½ç½®1å³å¯</p><ul><li>hdu 5972 è¾“å‡ºçš„æ—¶å€™ä»¤s[n+1]=0,ç„¶åputs(s[i-n+1])ï¼Œå†è¿˜åŸs[n+1]ã€‚å¦‚æœå…ˆè®°å½•åŒ¹é…ä½ç½®æœ€ååŒé‡forä¼šT</li><li>hdu 5716</li><li>ç‰›å®¢å¤šæ ¡2Gé¢˜<br>ç»™å®šé•¿åº¦ä¸ºnçš„æ•°ç»„aå’Œé•¿åº¦ä¸ºmçš„æ•°ç»„bï¼Œè¯¢é—®æ•°ç»„aä¸­æ¯ä¸€ä½éƒ½ä¸¥æ ¼å¤§äºæ•°ç»„bçš„å­æ®µä¸ªæ•°<br>å¯ä»¥æŠŠè¿™ä¸ªé—®é¢˜å½“æˆä¸€ä¸ªå¯é€‰å­—ç¬¦åŒ¹é…é—®é¢˜ï¼Œå¯¹äºæ¯ä¸ªa[i]å¯ä»¥ä¸æ‰€æœ‰&lt;=a[i]çš„b[j]ç›¸åŒ¹é…ã€‚<br>è€ƒè™‘é¢„å¤„ç†å‡ºbitset<M> B[N]ï¼Œè¡¨ç¤ºaçš„æ¯ä¸€ä½å¯ä»¥ä¸bçš„å“ªäº›ä½ç›¸åŒ¹é…ï¼Œç„¶åè·‘ä¸€éshift-andå³å¯ã€‚<br>è¿™æ ·ä¼šMLEï¼Œéšç€açš„å¢å¤§ï¼Œèƒ½å¤ŸåŒ¹é…çš„ä½ç½®ä¸æ–­å¢åŠ ï¼Œæ‰€ä»¥æœ¬è´¨ä¸åŒçš„bitsetåªæœ‰mä¸ªï¼Œå¼€æˆbitset<M> B[M]å³å¯ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1.5e5</span> + <span class="number">5</span>, M = <span class="number">4e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, idx[N];</span><br><span class="line">pii a[N], b[M];</span><br><span class="line">bitset&lt;M&gt; B[M], D;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i].fi), a[i].se = i;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i].fi), b[i].se = i;</span><br><span class="line">  <span class="built_in">sort</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>); <span class="built_in">sort</span>(b+<span class="number">1</span>, b+m+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">    B[i] = B[i<span class="number">-1</span>], B[i].<span class="built_in">set</span>(b[i].se);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>, j=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(j&lt;=m &amp;&amp; a[i].fi&gt;=b[j].fi) ++j;</span><br><span class="line">    idx[a[i].se] = j<span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    D &lt;&lt;= <span class="number">1</span>; D.<span class="built_in">set</span>(<span class="number">1</span>);</span><br><span class="line">    D &amp;= B[idx[i]];</span><br><span class="line">    <span class="keyword">if</span>(D[m]) ++ans;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ƒè™‘é¢„å¤„ç†bitset<N> B[i]è¡¨ç¤ºbæ•°ç»„ä¸­ç¬¬iä½å¯ä»¥ä¸aæ•°ç»„ä¸­å“ªäº›ä½ç›¸åŒ¹é…ã€‚ç„¶åç”¨ä¸€ä¸ªå…¨1çš„bitset<N><br>Dï¼Œå½“D[i]=1æ—¶è¡¨ç¤ºaæ•°ç»„ä¸­ä»¥iä¸‹æ ‡èµ·å§‹çš„é•¿åº¦ä¸ºmçš„å­æ®µå¯ä»¥ä¸bæ•°ç»„ç›¸åŒ¹é…ã€‚åªè¦æšä¸¾bæ•°ç»„ä¸­çš„æ‰€æœ‰ä½ç½®è®©D &amp;= (B[i]&gt;&gt;(i-1))å³å¯ï¼Œå¦‚æœB[i][j]=0ï¼Œé‚£ä¹ˆD[j-i+1]èµ·å§‹çš„å­æ®µå°±ä¸å¯èƒ½ä¸bæ•°ç»„ç›¸åŒ¹é…ï¼Œå› ä¸ºa[j]!=b[i]ã€‚<br>ä»¥ä¸Šæ–¹æ³•ä¹Ÿå¯ä»¥ç”¨äºå­—ç¬¦ä¸²åŒ¹é…ã€‚<br>åœ¨ç‰›å®¢å¤šæ ¡è¿™é¢˜ä¸­ï¼Œåˆ©ç”¨è¯¥æ–¹æ³•å¯ä»¥ä»…å¼€ä¸€ä¸ªbitset<N> Bï¼Œå› ä¸ºåœ¨è¿™é‡Œbæ•°ç»„ä¸‹æ ‡çš„æšä¸¾é¡ºåºæ˜¯ä»»æ„çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹bæ’åºåå†æšä¸¾ï¼Œç„¶ååˆ©ç”¨å°ºå–å®ç°Bçš„æ»šåŠ¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1.5e5</span> + <span class="number">5</span>, M = <span class="number">4e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, idx[N];</span><br><span class="line">pii a[N], b[M];</span><br><span class="line">bitset&lt;N&gt; B, D;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i].fi), a[i].se = i;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;b[i].fi), b[i].se = i;</span><br><span class="line">  <span class="built_in">sort</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>); <span class="built_in">sort</span>(b+<span class="number">1</span>, b+m+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n-m+<span class="number">1</span>; i++) D.<span class="built_in">set</span>(i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=m, j=n; i; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(j &amp;&amp; a[j].fi&gt;=b[i].fi) B.<span class="built_in">set</span>(a[j--].se);</span><br><span class="line">    D &amp;= (B&gt;&gt;(b[i].se<span class="number">-1</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="type">int</span>)D.<span class="built_in">count</span>());</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç¼€è‡ªåŠ¨æœºå’Œå¹¿ä¹‰åç¼€è‡ªåŠ¨æœºçš„ä¸€äº›ç–‘é—®</title>
      <link href="/2020/07/17/hou-zhui-zi-dong-ji-he-guang-yi-hou-zhui-zi-dong-ji-de-yi-xie-yi-wen/"/>
      <url>/2020/07/17/hou-zhui-zi-dong-ji-he-guang-yi-hou-zhui-zi-dong-ji-de-yi-xie-yi-wen/</url>
      
        <content type="html"><![CDATA[<p>æ„Ÿè§‰samï¼Œç‰¹åˆ«æ˜¯parentæ ‘ä¸Šçš„å¤æ‚åº¦å¾ˆç„å­¦ï¼Ÿï¼</p><ul><li><p>æš´åŠ›è·³parentæ ‘çš„å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ<br>ç¬¬ä¸€ç§æƒ…å†µæ˜¯å»ºå¹¿ä¹‰samï¼Œç„¶åæ¯ä¸ªä¸²æš´åŠ›è·³parentæ ‡è®°ï¼Œå¤æ‚åº¦ä¼¼ä¹æ˜¯$n\sqrt n$â€‹ï¼ˆç»´æŠ¤å¤šä¸²çš„æ ¹å·trickï¼‰<br>ç¬¬äºŒç§æ˜¯samä¸Šç›´æ¥æ— è„‘æš´åŠ›è·³åˆ°æŸä¸ªé•¿åº¦èŒƒå›´å†…ï¼Œä¸€èˆ¬æƒ…å†µæ˜¯è¦å†™å€å¢çš„ï¼Œä½†æ˜¯æˆ‘åœ¨2019å¾å·Lã€p4094ä¸Šç›´æ¥æš´åŠ›è·³ä¹Ÿéƒ½è¿‡äº†ï¼Œè€Œä¸”æ¯”å€å¢å¿«ï¼ˆå¸¸æ•°å°ï¼‰ã€‚ã€‚å¦‚æœæ˜¯aaaaaâ€¦çš„è¯parentæ ‘æ˜¯é“¾ï¼Œåº”è¯¥èƒ½å¡ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦å†™å€å¢å§</p></li><li><p>trieä¸Šå»ºå¹¿ä¹‰sam<br>æ­£è§£æ˜¯bfsçš„åšæ³•ï¼Œä½†æ˜¯éœ€è¦æ˜¾ç¤ºçš„å»ºå‡ºtrieï¼Œå¦‚æœä¸å»ºä¼šé”™ï¼Œæˆ‘è®¤ä¸ºæ˜¯é‡è¾¹çš„å½±å“ï¼ˆä¸ç¡®å®šï¼‰ã€‚<br>å¦‚æœç›´æ¥dfsï¼Œå¤æ‚åº¦ä¼šå–å†³äºtrieä¸Š$\sum dep(leaf)$ï¼ˆ15å›½å®¶è®ºæ–‡ï¼‰ï¼Œæ„Ÿè§‰å¯ä»¥å¡æˆ$n^2$ï¼Œç„¶è€Œæˆ‘åœ¨2019å¾å·Lã€2019wfGä¸Šç›´æ¥dfså»ºå°±è¿‡äº†ï¼Œç”±äºä¸ç”¨å»ºtrieï¼Œæ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æŒºä¼˜ç§€ï¼Œç›®å‰è¿˜ä¸çŸ¥é“æ˜¯æ•°æ®é—®é¢˜è¿˜æ˜¯ä»€ä¹ˆã€‚p3346ç”±äºå¶å­åªæœ‰20ä¸ªï¼Œæ‰€ä»¥dfsè‚¯å®šæ˜¯å¯¹çš„ã€‚</p></li><li><p>å¹¿ä¹‰samèƒ½ä¸èƒ½åŸºæ•°æ’åº<br>çªç„¶æ„è¯†åˆ°å¹¿ä¹‰samåŸºæ•°æ’åºåçš„ç»“æœä¸æ‹“æ‰‘åºå¯èƒ½æœ‰å‡ºå…¥ï¼Œä¸è¿‡æˆ‘å¥½å‡ é“exsamç”¨åŸºæ•°æ’åºå¾—åˆ°çš„æ‹“æ‰‘åºå»åšä¹Ÿè¿‡äº†ã€‚ã€‚å¾ˆè¿·<br>è¿˜æ˜¯è€è€å®å®æŠŠparentæ ‘å»ºå‡ºæ¥å§ã€‚</p></li><li><p>æ³¨æ„ï¼šçº¿æ®µæ ‘åˆå¹¶æ±‚endposé›†åˆçš„æ—¶å€™ï¼Œä¸€å®šè¦æ–°å¼€ç‚¹ï¼Œå¦åˆ™å¯èƒ½ä¼šå½±å“å­æ ‘çš„ä¿¡æ¯ã€‚</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kmpå­¦ä¹ ç¬”è®°</title>
      <link href="/2020/07/14/kmp-xue-xi-bi-ji/"/>
      <url>/2020/07/14/kmp-xue-xi-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="åº”ç”¨"><a class="header-anchor" href="#åº”ç”¨">Â¶</a>åº”ç”¨</h2><p>ç»™å®šä¸»ä¸²tå’Œæ¨¡å¼ä¸²sï¼Œæ±‚å‡ºsåœ¨tä¸­çš„æ‰€æœ‰åŒ¹é…ä½ç½®<br>æ±‚å‡ºä¸€ä¸ªä¸²çš„æ‰€æœ‰å‰ç¼€çš„æœ€å¤§border(nextæ•°ç»„)</p><h2 id="å®šä¹‰"><a class="header-anchor" href="#å®šä¹‰">Â¶</a>å®šä¹‰</h2><p>å‰ç¼€pre(s, l)ï¼šsé•¿åº¦ä¸ºlçš„å‰ç¼€(s[1â€¦l])<br>åç¼€suf(s, l)ï¼šsé•¿åº¦ä¸ºlçš„åç¼€(s[|s|-l+1â€¦|s|])<br>å‘¨æœŸperiodï¼šs[i]=s[i+p]ï¼Œ$\forall i \in<br>1â€¦|s|-ps[i]=s[i+p]$ï¼Œåˆ™pæ˜¯sçš„å‘¨æœŸ<br>border: pre(s, l) = suf(s, l)ï¼Œåˆ™pre(s, l)æ˜¯sçš„border</p><h2 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h2><p>è‹¥sæœ‰é•¿ä¸ºxçš„borderï¼Œåˆ™|s|-xä¸ºsçš„ä¸€ä¸ªå‘¨æœŸã€‚è¯æ˜å¯ä»¥åˆ†æˆborderç›¸äº¤å’Œä¸ç›¸äº¤ä¸¤ç§æƒ…å†µ<br>æœ€å°å‘¨æœŸ=ä¸²é•¿-æœ€å¤§border<br>borderå…·æœ‰ä¼ é€’æ€§ï¼Œä¸²sçš„æ‰€æœ‰borderå¯ä»¥ç”¨<code>nxt[|s|]ï¼Œnxt[nxt[|s|]]...</code>è¡¨ç¤º<br><strong>Weak Periodicity Lemma</strong><br>på’Œqæ˜¯sçš„å‘¨æœŸï¼Œp+q&lt;=|s|ï¼Œåˆ™gcd(p, q)ä¹Ÿæ˜¯sçš„å‘¨æœŸ<br><strong>Periodicity Lemma</strong><br>på’Œqæ˜¯sçš„å‘¨æœŸï¼Œp+q-gcd(p, q)&lt;=|s|ï¼Œåˆ™gcd(p, q)ä¹Ÿæ˜¯sçš„å‘¨æœŸ<br>(ç‰›å®¢å¤šæ ¡1çš„ç­¾åˆ°æ˜¯ç»™å‡ºä¸¤ä¸ªæ— é™ä¸²å„è‡ªçš„å‘¨æœŸï¼Œè¦æ±‚æ¯”è¾ƒè¿™ä¸¤ä¸ªä¸²çš„å­—å…¸åºå¤§å°ï¼Œåªéœ€è¦æ¯”è¾ƒå‰p+q-gcd(p,q)æˆ–è€…å‰p+qä¸ªå­—ç¬¦ï¼Œå¦‚æœéƒ½ç›¸åŒï¼Œè¯´æ˜på’Œqéƒ½æ˜¯å„è‡ªçš„å‘¨æœŸï¼Œä¸¤ä¸ªä¸²ç›¸ç­‰)</p><h2 id="æ±‚æ³•"><a class="header-anchor" href="#æ±‚æ³•">Â¶</a>æ±‚æ³•</h2><p>nxtæ•°ç»„çš„æ±‚æ³•å¯ä»¥å½“ä½œæ˜¯sä¸²è‡ªå·±å’Œè‡ªå·±åŒ¹é…çš„è¿‡ç¨‹ã€‚<br>è§„å®š<code>nxt[0]=âˆ’1</code>ï¼Œsä¸²ä»0å¼€å§‹ï¼Œnxt[i]è¡¨ç¤ºs[0â€¦i-1]çš„æœ€å¤§border<br>è€ƒè™‘å½“å‰å·²ç»æ±‚å‡ºäº†nxt[0â€¦i]ï¼Œä¸”nxt[i]=jï¼Œè¯´æ˜<code>s[i-j...i-1]=s[0...j-1]</code></p><ul><li><code>s[i]==s[j]</code>ï¼Œ<code>nxt[++i] = ++j</code></li><li><code>ss[i]!=s[j]</code>ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ä¸æ–­å¾€å‰è·³nxtï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªborderçš„åä¸€ä¸ªå­—ç¬¦ç­‰äºs[j]ï¼Œç„¶åè½¬ä¸ºç¬¬ä¸€ç§æƒ…å†µ</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">kmp_pre</span><span class="params">(<span class="type">char</span> s[], <span class="type">int</span> n, <span class="type">int</span> nxt[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>, j = nxt[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;n)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(j!=<span class="number">-1</span>&amp;&amp;s[i]!=s[j]) j = nxt[j];</span><br><span class="line">    nxt[++i] = ++j;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²åŒ¹é…çš„è¿‡ç¨‹å’Œæ±‚nextæ•°ç»„çš„è¿‡ç¨‹ç±»ä¼¼ï¼ˆæ¨¡å¼ä¸²éƒ½æ˜¯sï¼Œåªä¸è¿‡ä¸»ä¸²å˜äº†ï¼‰ã€‚<br>è§„å®šsä¸²ä¸ºæ¨¡å¼ä¸²ï¼Œtä¸ºä¸»ä¸²ï¼Œä¸‹æ ‡å‡ä»0å¼€å§‹ã€‚<br>å…ˆæ±‚å‡ºsä¸²çš„nextæ•°ç»„<br>è€ƒè™‘å½“å‰tä¸²åŒ¹é…åˆ°i-1ï¼Œsä¸²åŒ¹é…åˆ°j-1ï¼Œè¯´æ˜<code>t[i-j...i-1]=s[0...j-1]</code></p><ul><li><code>t[i]=s[j]</code>ï¼Œ++iï¼Œ++jã€‚å¦‚æœj&gt;|s|ï¼Œè¯´æ˜æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…ï¼Œè®°å½•ä¸‹ä½ç½®ï¼Œè®©j=nxt[j]</li><li><code>t[i]!=s[j]</code>ï¼Œjä¸æ–­è·³nxtç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªborderçš„åä¸€ä¸ªå­—ç¬¦ç­‰äºt[i]ä¸ºæ­¢ï¼Œç„¶åè½¬åŒ–ä¸ºç¬¬ä¸€ç§æƒ…å†µ</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">kmp_work</span><span class="params">(<span class="type">char</span> s[], <span class="type">int</span> n, <span class="type">char</span> t[], <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">kmp_pre</span>(s, n, nxt);</span><br><span class="line">  <span class="keyword">while</span>(i&lt;m)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(j!=<span class="number">-1</span>&amp;&amp;t[i]!=s[j]) j = nxt[j];</span><br><span class="line">    i++; j++;</span><br><span class="line">    <span class="keyword">if</span>(j&gt;=n)</span><br><span class="line">    &#123;</span><br><span class="line">      ans++;</span><br><span class="line">      match[i-n] = <span class="number">1</span>;</span><br><span class="line">      j = nxt[j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜"><a class="header-anchor" href="#ä¹ é¢˜">Â¶</a>ä¹ é¢˜</h2><ul><li><p>p3375<br>æ±‚å‡ºæ‰€æœ‰åŒ¹é…ä½ç½®+nxtæ•°ç»„</p></li><li><p>p5829<br>å¼•å…¥ä¸€ç§å¤±é…æ ‘ï¼ˆå’Œacè‡ªåŠ¨æœºçš„failæ ‘ç±»ä¼¼ï¼‰ï¼šæŒ‰ç…§nextæ•°ç»„è¿›è¡Œå»ºæ ‘ï¼Œnext[i]ä½œä¸ºiçš„çˆ¶äº²ã€‚<br>æ˜¾ç„¶æ¯ä¸ªç‚¹æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ã€‚<br>å®¹æ˜“å‘ç°æ¯ä¸ªç‚¹çš„æ‰€æœ‰ç¥–å…ˆå°±æ˜¯å®ƒçš„æ‰€æœ‰borderï¼Œè·³nxtçš„è¿‡ç¨‹ç›¸å½“äºä¸æ–­å¾€çˆ¶äº²èµ°<br>æœ¬é¢˜å¤šæ¬¡è¯¢é—®ä¸€ä¸ªä¸²sçš„æŸä¸¤ä¸ªå‰ç¼€çš„æœ€å¤§å…¬å…±borderã€‚å»ºå‡ºå¤±é…æ ‘åå¾ˆç›´è§‚çš„å¯ä»¥å‘ç°ç­”æ¡ˆå°±æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„LCAä»£è¡¨çš„å‰ç¼€</p></li><li><p>p3435<br>æ±‚æ¯ä¸ªå‰ç¼€çš„æœ€å¤§å‘¨æœŸã€‚<br>æ±‚æœ€å¤§å‘¨æœŸç›¸å½“äºæ±‚æœ€å°borderã€‚æ”¾åœ¨å¤±é…æ ‘ä¸Šå°±ç›¸å½“äºæ‰¾åˆ°æ¯ä¸ªç‚¹ç¥–å…ˆä¸­ç¦»æ ¹æœ€è¿‘çš„é‚£ä¸ªã€‚æ ‘ä¸Šdpä¸€ä¸‹å³å¯ã€‚ä¹Ÿå¯ä»¥è·¯å¾„å‹ç¼©ã€‚</p></li><li><p>poj2185<br>ä¸€ä¸ªn*må­—ç¬¦çŸ©é˜µï¼Œæ±‚ä¸€ä¸ªæœ€å°çš„å­çŸ©é˜µï¼Œä½¿å…¶é‡å¤å¤šæ¬¡åæ‰€å¾—çŸ©é˜µåŒ…å«åŸçŸ©é˜µã€‚<br>è¡Œåˆ—åˆ†å¼€åšä¸€ékmpï¼Œæ±‚å‡ºå„è‡ªçš„æœ€å¤§borderã€‚<br>æŒ‰è¡Œåšçš„æ—¶å€™ï¼Œæ¯ä¸€è¡Œçš„å­—ç¬¦å½“ä½œä¸€ä¸ªå­—ç¬¦ï¼ˆhashä¸€ä¸‹ï¼Œç›´æ¥æš´åŠ›ä¹Ÿè¡Œï¼‰</p></li><li><p>p2375<br>å¯¹sçš„æ‰€æœ‰å‰ç¼€ï¼Œæ±‚å‡ºé•¿åº¦ä¸è¶…è¿‡ä¸€åŠçš„borderæ•°é‡<br>æ”¾åˆ°å¤±é…æ ‘ä¸Šï¼Œå€å¢ä¸€ä¸‹ï¼ˆborderé•¿åº¦å•å‡ï¼‰ï¼ˆæ— è„‘+æš´åŠ›ï¼‰$O(n\log n)$<br>$O(n)$åšæ³•ï¼š<br>è€ƒè™‘åœ¨æ±‚è§£nxtæ•°ç»„çš„æ—¶å€™ï¼Œå†å¢åŠ ä¸€ä¸ªkæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆå’ŒjæŒ‡é’ˆä¸€æ ·ï¼Œä½†æ˜¯éœ€è¦é¢å¤–æ»¡è¶³é•¿åº¦çš„é™åˆ¶ï¼Œå¦‚æœä¸æ»¡è¶³ç»§ç»­è·³nxtã€‚iç‚¹çš„ç­”æ¡ˆå°±æ˜¯kç‚¹çš„ç­”æ¡ˆçš„nxtå‰ç¼€å’Œï¼ˆåŒæ—¶dpé€’æ¨å³å¯ï¼‰</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; s;</span><br><span class="line">  <span class="type">int</span> n = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>, j = nxt[<span class="number">0</span>] = <span class="number">-1</span>, k = <span class="number">-1</span>;</span><br><span class="line">  ll ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;n)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(~j &amp;&amp; s[i]!=s[j]) j = nxt[j];</span><br><span class="line">    <span class="keyword">while</span>(~k &amp;&amp; s[i]!=s[k]) k = nxt[k];</span><br><span class="line">    nxt[++i] = ++j;</span><br><span class="line">    ++k;</span><br><span class="line">    dp[i] = dp[nxt[i]] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">2</span>*k&gt;i) k = nxt[k];</span><br><span class="line">    ans = ans*(dp[k]+<span class="number">1</span>)%mod; <span class="comment">//æ±‚çš„æ˜¯æ¯ä¸ªç‚¹ç­”æ¡ˆ+1çš„è¿ä¹˜ç§¯</span></span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>p3426<br>å¯¹äºå­—ç¬¦ä¸²sï¼Œæ±‚ä¸€ä¸ªæœ€çŸ­çš„å­—ç¬¦ä¸²tï¼Œå…¶<strong>å¯é‡å </strong>åœ°é‡å¤æ•°æ¬¡åç­‰äºs<br>æ˜¾ç„¶tæ˜¯sçš„ä¸€ä¸ªborder<br>å¦‚æœå½“å‰ç­‰ä»·äºs[1â€¦i]ï¼Œç›¸å½“äºtæ˜¯pre(s, i)çš„ä¸€ä¸ªborderã€‚æ‰€ä»¥è¿™ä¸ªtæ˜¯sçš„æŸäº›å‰ç¼€çš„borderï¼Œè€Œä¸”è¿™äº›å‰ç¼€çš„ä½ç½®çš„å·®å€¼è¦&lt;=è¿™ä¸ªä¸²tçš„é•¿åº¦ã€‚<br>åœ¨å¤±é…æ ‘ä¸Šè€ƒè™‘ï¼Œç­”æ¡ˆæ˜¯0åˆ°nè¿™æ¡é“¾ä¸Šçš„æŸä¸ªç‚¹x(sçš„æŸä¸ªborder)ï¼Œå¹¶ä¸”è¯¥ç‚¹å­æ ‘å†…æ‰€æœ‰ç‚¹çš„ä½ç½®çš„æœ€å¤§å·®å€¼&lt;=x(xæ˜¯å…¶å­æ ‘å†…çš„æ‰€æœ‰ç‚¹çš„æŸä¸ªborder)ï¼Œå¦‚æœæœ€å¤§å·®å€¼&gt;xï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‰ç¼€é—´å°±ä¸èƒ½é€šè¿‡xæ‹¼æ¥è€Œæˆã€‚<br>å¤±é…æ ‘ä¸Šä»0èµ°åˆ°nï¼Œä¸æ–­åˆ å»éå­æ ‘å†…çš„ç‚¹ï¼Œç”¨setæˆ–åŒå‘é“¾è¡¨ç»´æŠ¤maxgapå³å¯<br>è€ƒè™‘dp[i]ï¼šs[1â€¦i]çš„ç­”æ¡ˆ<br>dp[i]è¦ä¹ˆç­‰äºiï¼Œè¦ä¹ˆç­‰äºdp[nxt[i]]<br>ç­‰äºdp[nxt[i]]çš„æ¡ä»¶æ˜¯nxt[i]â€¦i-1é—´$\exists j \ dp[j] = dp[nxt[i]] \land i-j&lt;=dp[nxt[i]]$</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">&#123;</span><br><span class="line">  dp[i] = i;</span><br><span class="line">  <span class="keyword">if</span>(p[dp[nxt[i]]] &amp;&amp; i-p[dp[nxt[i]]]&lt;=dp[nxt[i]])</span><br><span class="line">    dp[i] = dp[nxt[i]];</span><br><span class="line">  p[dp[i]] = i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>p3193<br>ç»™å®šä¸€ä¸ªé•¿ä¸ºmçš„å­—ç¬¦ä¸²tï¼Œé—®èƒ½æ„é€ å‡ºå¤šå°‘ä¸ªé•¿ä¸ºnçš„å­—ç¬¦ä¸²sï¼Œä½¿å¾—tä¸æ˜¯sçš„å­ä¸²ã€‚<br>$m&lt;=20, n&lt;=10^9$<br>f[i][j]ï¼šsä¸²æ„é€ åˆ°iï¼Œtä¸²åŒ¹é…åˆ°jçš„æ–¹æ¡ˆæ•°<br>å…ˆé¢„å¤„ç†å‡ºtä¸²å½“å‰åŒ¹é…åˆ°iï¼ŒåŠ ä¸€ä¸ªå­—ç¬¦ååŒ¹é…åˆ°jçš„æ–¹æ¡ˆæ•°g[i][j]ï¼Œè¿™ä¸ªç”¨kmpå³å¯<br>è½¬ç§»ï¼š$f[i][j] = \sum_{k=0}^{m-1} f[i-1][k] * g[k][j]$<br>æ˜¾ç„¶å¯ä»¥çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–</li></ul><p>$\begin{bmatrix}<br>f[i][0] &amp; \cdots &amp; f[i][m-1] \end{bmatrix} = \begin{bmatrix} f[i-1][0] &amp;<br>\cdots &amp; f[i-1][m-1] \end{bmatrix} \begin{bmatrix} g[0][0] &amp; \cdots &amp;<br>g[0][m-1] \\ \vdots &amp; \ddots &amp; \vdots \\ g[m-1][0] &amp; \cdots &amp; g[m-1][m-1]<br>\\ \end{bmatrix}$</p><p>å…¶ä¸­f[0][0]=1<br>æœ€åç­”æ¡ˆå³ä¸º$g^n$çš„ç¬¬ä¸€è¡Œçš„å’Œ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">25</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, m, mod;</span><br><span class="line"><span class="type">int</span> g[N][N], nxt[N];</span><br><span class="line"><span class="type">char</span> s[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">matrix</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m;</span><br><span class="line">  <span class="type">int</span> mat[N][N];</span><br><span class="line">  <span class="built_in">matrix</span>() &#123;&#125;</span><br><span class="line">  <span class="built_in">matrix</span>(<span class="type">int</span> a, <span class="type">int</span> b) : <span class="built_in">n</span>(a), <span class="built_in">m</span>(b) &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</span><br><span class="line">        mat[i][j] = (i==j);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">matrix <span class="keyword">operator</span> * (matrix a, matrix b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function">matrix <span class="title">res</span><span class="params">(a.n, b.m)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=a.n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=b.m; j++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=a.m; k++)</span><br><span class="line">        res.mat[i][j] = (res.mat[i][j]+a.mat[i][k]*b.mat[k][j])%mod;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">matrix <span class="keyword">operator</span> ^ (matrix a, ll x)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function">matrix <span class="title">res</span><span class="params">(a.n, a.m)</span></span>; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_nxt</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>, j = nxt[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;m)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(~j &amp;&amp; s[i]!=s[j]) j = nxt[j];</span><br><span class="line">    nxt[++i] = ++j;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init_g</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">-1</span>; i&lt;m<span class="number">-1</span>; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;<span class="number">10</span>; k++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> j = i + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">while</span>(~j &amp;&amp; s[j]-<span class="string">&#x27;0&#x27;</span>!=k) j = nxt[j];</span><br><span class="line">      g[i+<span class="number">1</span>][j+<span class="number">1</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m &gt;&gt; mod;</span><br><span class="line">  cin &gt;&gt; s;</span><br><span class="line">  <span class="built_in">get_nxt</span>();</span><br><span class="line">  <span class="built_in">init_g</span>();</span><br><span class="line">  <span class="function">matrix <span class="title">f</span><span class="params">(m, m)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</span><br><span class="line">      f.mat[i][j] = g[i<span class="number">-1</span>][j<span class="number">-1</span>];</span><br><span class="line">  f = f ^ n;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) ans = (ans + f.mat[<span class="number">1</span>][i])%mod;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>D-Array æ„é€ </title>
      <link href="/2020/06/18/d-array-gou-zao/"/>
      <url>/2020/06/18/d-array-gou-zao/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šä¸¤ä¸ªæ•°xå’Œyï¼Œè¦æ±‚ç”¨æœ€å°‘çš„nä¸ªæ•°ï¼Œä½¿å¾—ä»–ä»¬çš„å¼‚æˆ–å’Œ=xï¼Œæ±‚å’Œ=y</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è¿™é“é¢˜åœ¨cfä¸Šæœ‰ç±»ä¼¼çš„</p><ul><li>x=y=0 è¾“å‡º0</li><li>x=y!=0 è¾“å‡º1</li><li>x&gt;y è¾“å‡º-1</li><li>(y-x)&amp;1 è¾“å‡º-1</li><li>å¦‚æœå¯ä»¥ç”¨(y+x)/2 å’Œ(y-x)/2ï¼Œå°±è¾“å‡º2</li><li>å¦åˆ™è¾“å‡º3 x, (y-x)/2, (y-x)/2</li></ul><p>é¡ºä¾¿è®°ä¸€ä¸‹pythonå¤šç»„è¾“å…¥(ç«Ÿç„¶è·‘äº†6så¤šã€‚ã€‚)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        x, y = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">        <span class="keyword">if</span> x==y:</span><br><span class="line">            <span class="built_in">print</span>(<span class="number">0</span>) <span class="keyword">if</span>(x==<span class="number">0</span>) <span class="keyword">else</span> <span class="built_in">print</span>(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> x&gt;y:</span><br><span class="line">            <span class="built_in">print</span>(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> (y-x)&amp;<span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> ((y+x)//<span class="number">2</span>) ^ ((y-x)//<span class="number">2</span>) == x:</span><br><span class="line">            <span class="built_in">print</span>(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢ç»ƒä¹ èµ›65</title>
      <link href="/2020/06/18/niu-ke-lian-xi-sai-65/"/>
      <url>/2020/06/18/niu-ke-lian-xi-sai-65/</url>
      
        <content type="html"><![CDATA[<h2 id="C-äºŒç»´åŠ¨ç‚¹"><a class="header-anchor" href="#C-äºŒç»´åŠ¨ç‚¹">Â¶</a>C äºŒç»´åŠ¨ç‚¹</h2><h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>å¹³é¢ä¸Šæœ‰nä¸ªç‚¹ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸å½“å‰ä¸é‡åˆçš„ç‚¹ï¼Œç„¶åç§»åŠ¨åˆ°ä¸¤è€…<strong>ç›´çº¿</strong>ä¸Šçš„ä»»æ„ä¸€ç‚¹ï¼Œå¤šæ¬¡è¯¢é—®ä»åŸç‚¹åˆ°(x, y)æœ€å°‘çš„ç§»åŠ¨æ¬¡æ•°</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å¤§åŠ›åˆ†ç±»è®¨è®ºï¼š</p><ul><li>(0, 0ï¼‰æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œå¦‚æœå‡ºç°éœ€è¦å»æ‰</li><li>å¦‚æœå¹³é¢ä¸Šæ‰€æœ‰ç‚¹åˆ°åŸç‚¹çš„è¿çº¿æ˜¯ç›¸åŒçš„ï¼Œä¸”è¯¢é—®ç‚¹ä¸åœ¨è¯¥è¿çº¿ä¸Šï¼Œè¾“å‡º-1</li><li>å¦‚æœè¯¢é—®ç‚¹ä¸åŸç‚¹è¿æˆçš„ç›´çº¿ä¸Šå­˜åœ¨å¹³é¢ä¸Šçš„nä¸ªç‚¹ä¸­çš„è‡³å°‘ä¸€ä¸ªï¼Œè¾“å‡º1ï¼Œå¯ä»¥åˆ©ç”¨pairæ¥å­˜æ–œç‡ï¼Œæ³¨æ„å½’çº¦åŒ–å¤„ç†</li><li>å¦‚æœç‚¹æ•°&gt;=3ï¼Œè¾“å‡º2ï¼Œåªè¦æœ‰ä¸¤æ¡ç›´çº¿ç›¸äº¤ï¼Œå°±å¯ä»¥å…ˆç§»åˆ°äº¤ç‚¹ï¼Œå†ç§»è¿‡å»</li><li>å½“åªæœ‰2ä¸ªç‚¹æ—¶ï¼Œè€ƒè™‘ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼ˆæ ·ä¾‹å·²ç»æç¤ºï¼‰ï¼ŒåŸç‚¹+è¿™2ä¸ªç‚¹+è¯¢é—®ç‚¹æ„æˆå¹³è¡Œå››è¾¹å½¢ï¼Œæ­¤æ—¶éœ€è¦3æ¬¡ï¼Œå…ˆéšä¾¿ç§»åˆ°æŸä¸ªç‚¹å¤„ï¼Œå†æŒ‰ä¸Šä¸€æ¡çš„åšæ³•</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, x[N], y[N];</span><br><span class="line">map&lt;pii, <span class="type">int</span>&gt; cnt;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!b) <span class="keyword">return</span> a;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">gcd</span>(b, a%b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sgn</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (x&gt;<span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>); &#125;</span><br><span class="line"><span class="function">pii <span class="title">cal</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = c - a, y = d - b;</span><br><span class="line">  <span class="built_in">assert</span>(x || y);</span><br><span class="line">  <span class="keyword">if</span>(!x) <span class="keyword">return</span> <span class="built_in">mp</span>(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span>(!y) <span class="keyword">return</span> <span class="built_in">mp</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="type">int</span> f = <span class="built_in">sgn</span>(x)*<span class="built_in">sgn</span>(y);</span><br><span class="line">  <span class="type">int</span> t = <span class="built_in">gcd</span>(<span class="built_in">abs</span>(x), <span class="built_in">abs</span>(y));</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">mp</span>(f*x/t, y/t);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">  <span class="type">int</span> m = n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; x[i] &gt;&gt; y[i];</span><br><span class="line">    <span class="keyword">if</span>(!x[i]&amp;&amp;!y[i])</span><br><span class="line">    &#123;</span><br><span class="line">      m--;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt[<span class="built_in">cal</span>(<span class="number">0</span>, <span class="number">0</span>, x[i], y[i])]++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="keyword">if</span>(!a&amp;&amp;!b) cout &lt;&lt; <span class="number">0</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(cnt.<span class="built_in">count</span>(<span class="built_in">cal</span>(<span class="number">0</span>, <span class="number">0</span>, a, b))) cout &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">sz</span>(cnt)&lt;=<span class="number">1</span>) cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(m&gt;=<span class="number">3</span>) cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(m==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">cal</span>(<span class="number">0</span>, <span class="number">0</span>, x[<span class="number">1</span>], y[<span class="number">1</span>])==<span class="built_in">cal</span>(x[<span class="number">2</span>], y[<span class="number">2</span>], a, b) &amp;&amp; <span class="built_in">cal</span>(<span class="number">0</span>, <span class="number">0</span>, x[<span class="number">2</span>], y[<span class="number">2</span>])==<span class="built_in">cal</span>(x[<span class="number">1</span>], y[<span class="number">1</span>], a, b)) cout &lt;&lt; <span class="number">3</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D-æœ€å°å…¬å€æ•°"><a class="header-anchor" href="#D-æœ€å°å…¬å€æ•°">Â¶</a>D æœ€å°å…¬å€æ•°</h2><h3 id="é¢˜æ„-s2"><a class="header-anchor" href="#é¢˜æ„-s2">Â¶</a>é¢˜æ„</h3><p>ç»™å‡ºä¸€ä¸ªæ•°nï¼Œè¦æ±‚æ‹†åˆ†æˆkä¸ªæ•°ï¼Œå®šä¹‰æ‹†åˆ†åçš„ä»·å€¼ä¸ºè¯¥åºåˆ—çš„æ‰€æœ‰å­åºåˆ—çš„lcmçš„<strong>ç§ç±»æ•°</strong> ï¼Œæ³¨æ„ç©ºåºåˆ—çš„lcm=1</p><h3 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h3><p>å› ä¸ºç­”æ¡ˆè¦å–æ¨¡ï¼Œæ‰€ä»¥æ„Ÿè§‰æ²¡æ³•æ¯”è¾ƒå¤§å°ï¼Œæ‰€ä»¥åœ¨åšé¢˜çš„æ—¶å€™ä»¥ä¸ºæ˜¯ä¸ªæ„é€ ã€‚ã€‚ã€‚ç„¶åå…¶å®å°±æ˜¯dp<br>è€ƒè™‘æ•°$p_1*p_2$â€‹ï¼Œæ˜¾ç„¶æ²¡æœ‰æ‹†æˆ$p_1, p_2$â€‹ä¸¤ä¸ªæ•°ä¼˜ï¼Œå› ä¸ºå®ƒä»¬çš„è´¡çŒ®æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åè€…æ›´å°ã€‚<br>æ‰€ä»¥æœ€åä¸€å®šæ˜¯æ‹†æˆè‹¥å¹²ä¸ªç´ æ•°çš„å¹‚æ¬¡ã€‚<br>è€ƒè™‘è¿›è¡ŒèƒŒåŒ…dpï¼Œå› ä¸ºå„ä¸ªç´ æ•°çš„è´¡çŒ®å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸€å®šæ˜¯ä»å°å¾€å¤§é€‰ï¼Œå‰100å¤šä¸ªç´ æ•°çš„å’Œå°±è¶…è¿‡$10^5$äº†ï¼Œå¦‚æœå½“å‰è¿™ä¸ªç´ æ•°é€‰äº†kä¸ªï¼Œå³é€‰æ‹©äº†$p_1,<br>p_2 â€¦ p_k$â€‹ï¼Œå‡è®¾ä¹‹å‰æœ‰xä¸ªä¸åŒçš„ç§ç±»ï¼Œé‚£ç°åœ¨å°±æœ‰(k+1)*xä¸ªä¸åŒçš„ç§ç±»ã€‚<br>ä¸‹é¢çš„é—®é¢˜æ˜¯ç”±äºè¦å–æ¨¡ï¼Œæ²¡æ³•æ¯”è¾ƒæœ€åçš„å¤§å°äº†ï¼ˆæ¯’ç˜¤ï¼‰ï¼Œä¸€ç§æ–¹æ³•æ˜¯ç”¨doubleæ¥å­˜ä»·å€¼ï¼Œå¹¶è®°å½•è½¬ç§»è·¯å¾„ï¼Œæœ€ååœ¨å›æº¯çš„æ—¶å€™ç”¨longlongï¼Œå¹¶ä¸”å–æ¨¡ï¼Œå¦ä¸€ç§æ˜¯ç”¨<code>Pair&lt;double, long long&gt;</code>ï¼Œå‰è€…åˆ©ç”¨logå‡½æ•°å°†ä¹˜æ³•è½¬ä¸ºåŠ æ³•ï¼Œåè€…å­˜ç­”æ¡ˆï¼Œå³å–æ¨¡åçš„å€¼ï¼Œç”±äºpairå·²ç»å°è£…å¥½äº†ï¼Œæ‰€ä»¥ç›´æ¥å–maxå³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, prime[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">pair&lt;<span class="type">double</span>,ll&gt; dp[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getprime</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=x; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!vis[i]) prime[++prime[<span class="number">0</span>]] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=prime[<span class="number">0</span>]&amp;&amp;<span class="number">1ll</span>*prime[j]*i&lt;=x; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      vis[prime[j]*i] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="built_in">getprime</span>(n);</span><br><span class="line">  <span class="type">int</span> cur = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(tot&lt;=prime[<span class="number">0</span>]&amp;&amp;cur+prime[tot]&lt;=n) cur += prime[tot++];</span><br><span class="line">  dp[<span class="number">0</span>].se = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;tot; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=n; j&gt;=prime[i]; j--)</span><br><span class="line">    &#123;</span><br><span class="line">      ll t = prime[i], s = t;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; s&lt;=j; s += (t*=prime[i]), k++)</span><br><span class="line">        dp[j] = <span class="built_in">max</span>(dp[j], <span class="built_in">mp</span>(dp[j-s].fi+<span class="built_in">log2</span>(k+<span class="number">1</span>), dp[j-s].se*(k+<span class="number">1</span>)%mod));</span><br><span class="line">    &#125;</span><br><span class="line">  pair&lt;<span class="type">double</span>, ll&gt; ans = &#123;<span class="number">0.0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++) ans = <span class="built_in">max</span>(ans, dp[i]);</span><br><span class="line">  cout &lt;&lt; ans.se &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="E-æ¸¸èµ°é…å¯¹"><a class="header-anchor" href="#E-æ¸¸èµ°é…å¯¹">Â¶</a>E æ¸¸èµ°é…å¯¹</h2><h3 id="é¢˜æ„-s3"><a class="header-anchor" href="#é¢˜æ„-s3">Â¶</a>é¢˜æ„</h3><p>æ— å‘å›¾ä¸Šï¼Œæœ‰qä¸ªè“ç‚¹ï¼Œqä¸ªçº¢ç‚¹ï¼Œè¦æ±‚å°†è“ç‚¹å’Œçº¢ç‚¹è¿›è¡Œé…å¯¹ï¼Œæ¯æ¬¡é…å¯¹äº§ç”Ÿçš„è´¹ç”¨æ˜¯ä»–ä»¬è·¯å¾„ä¸Šç»è¿‡çš„æ‰€æœ‰ç‚¹æƒçš„å’Œï¼Œæ­¤å¤–ä¸€ä¸ªç‚¹å¦‚æœè¢«ç»è¿‡äº†kæ¬¡ï¼Œé‚£ä¹ˆå®ƒçš„ç‚¹æƒæ˜¯$a_i + (k-1)*b_i$â€‹ï¼Œé—®æœ€å°çš„é…å¯¹è´¹ç”¨</p><h3 id="åšæ³•-s3"><a class="header-anchor" href="#åšæ³•-s3">Â¶</a>åšæ³•</h3><p>æ•°æ®é‡è¾ƒå°ï¼ŒMCMFã€‚<br>ç”±äºæ˜¯ç‚¹æƒï¼Œæˆ‘ä»¬æ‹†æˆå…¥ç‚¹å’Œå‡ºç‚¹ï¼Œç‚¹æƒæ”¾åœ¨å…¥ç‚¹åˆ°å‡ºç‚¹çš„è¾¹ä¸Šï¼Œå¹¶ä¸”æ‹†é™¤qæ¡è¾¹ï¼Œæ¯æ¡è¾¹æµé‡ä¸º1ï¼Œè´¹ç”¨ä¸ºç¬¬iæ¬¡ç»è¿‡äº§ç”Ÿçš„è´¹ç”¨ï¼Œå†å°†æºç‚¹ä¸qä¸ªè“ç‚¹çš„å…¥ç‚¹ç›¸è¿ï¼Œqä¸ªçº¢ç‚¹çš„å‡ºç‚¹ä¸æ±‡ç›¸è¿ï¼ŒåŸå›¾çš„mæ¡è¾¹ï¼Œåˆ™å°†uçš„å‡ºç‚¹å’Œvçš„å…¥ç‚¹ç›¸è¿ï¼Œvçš„å‡ºç‚¹å’Œuçš„å…¥ç‚¹ç›¸è¿ï¼Œç„¶åè·‘æœ€å°è´¹ç”¨æœ€å¤§æµ<br>ç®—æ˜¯ç½‘ç»œæµåŸºç¡€é¢˜äº†</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>, M = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> n, q, m, x[N], y[N];</span><br><span class="line"><span class="type">int</span> cnt, head[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> next, to, w, f;</span><br><span class="line">&#125;e[M&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w,<span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  e[++cnt] = &#123;head[u],v,w,f&#125;;</span><br><span class="line">  head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MCMF</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m, s, t;</span><br><span class="line">  <span class="type">int</span> flow, cost;</span><br><span class="line">  <span class="type">bool</span> inq[N];</span><br><span class="line">  <span class="type">int</span> d[N], p[N], a[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> s,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;n = n, <span class="keyword">this</span>-&gt;s = s, <span class="keyword">this</span>-&gt;t = t;</span><br><span class="line">    cnt = <span class="number">1</span>, m = <span class="number">0</span>, flow = cost = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> cap,<span class="type">int</span> cost)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(u,v,cap,cost);</span><br><span class="line">    <span class="built_in">add</span>(v,u,<span class="number">0</span>,-cost);</span><br><span class="line">    m += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(d,<span class="number">0x3f</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">memset</span>(inq,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    d[s] = <span class="number">0</span>, a[s] = INF;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      inq[u] = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">if</span>(u==t) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].to;</span><br><span class="line">        <span class="keyword">if</span>(e[i].w&amp;&amp;d[v]&gt;d[u]+e[i].f)</span><br><span class="line">        &#123;</span><br><span class="line">          d[v] = d[u] + e[i].f;</span><br><span class="line">          p[v] = i;</span><br><span class="line">          a[v] = <span class="built_in">min</span>(a[u],e[i].w);</span><br><span class="line">          <span class="keyword">if</span>(!inq[v])</span><br><span class="line">          &#123;</span><br><span class="line">            q.<span class="built_in">push</span>(v);</span><br><span class="line">            inq[v] = <span class="number">1</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d[t] != INF;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">spfa</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      flow += a[t];</span><br><span class="line">      cost += a[t] * d[t];</span><br><span class="line">      <span class="type">int</span> u = t;</span><br><span class="line">      <span class="keyword">while</span>(u!=s)</span><br><span class="line">      &#123;</span><br><span class="line">        e[p[u]].w -= a[t];</span><br><span class="line">        e[p[u]^<span class="number">1</span>].w += a[t];</span><br><span class="line">        u = e[p[u]^<span class="number">1</span>].to;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;MM;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class="line">  MM.<span class="built_in">init</span>(<span class="number">2</span>*n+<span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>*n+<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=q; j++)</span><br><span class="line">      MM.<span class="built_in">addedge</span>(i, n+i, <span class="number">1</span>, (j<span class="number">-1</span>)*b+a);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> c, d;</span><br><span class="line">    cin &gt;&gt; c &gt;&gt; d;</span><br><span class="line">    MM.<span class="built_in">addedge</span>(c+n, d, q, <span class="number">0</span>);</span><br><span class="line">    MM.<span class="built_in">addedge</span>(d+n, c, q, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++) cin &gt;&gt; x[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++) cin &gt;&gt; y[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    MM.<span class="built_in">addedge</span>(MM.s, x[i], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    MM.<span class="built_in">addedge</span>(y[i]+n, MM.t, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  MM.<span class="built_in">go</span>();</span><br><span class="line">  cout &lt;&lt; MM.cost &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codeforces1361</title>
      <link href="/2020/06/06/codeforces1361/"/>
      <url>/2020/06/06/codeforces1361/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>ç»™å®šä¸€å¼ æ— å‘å›¾ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªæƒå€¼ï¼Œå¦‚æœè®¿é—®uç‚¹ï¼Œäº§ç”Ÿçš„ä»·å€¼æ˜¯ä¸uç›¸è¿çš„æ‰€æœ‰ç‚¹çš„ç‚¹æƒçš„mexï¼Œç»™å®šä»·å€¼åºåˆ—ï¼Œè®©ä½ æ±‚è®¿é—®é¡ºåº</p><p>æ˜¾ç„¶åªè¦æŒ‰ç…§æƒå€¼ä»å°åˆ°å¤§è®¿é—®ï¼Œç„¶åæ¨¡æ‹Ÿä¸€éçœ‹æ˜¯å¦åˆæ³•å³å¯ã€‚<br><s>æˆ‘TMåœ¨æ’åºé‡Œç”¨äº†ç­‰äºå·ï¼Œä¸€ç›´reï¼Œäººå¿«æ²¡äº†</s> sortçš„æ¯”è¾ƒå‡½æ•°å¿…é¡»æ˜¯ååºçš„</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>æ¯ä¸ªç‰©å“çš„æƒå€¼ä¸º$p^{k_i}$â€‹ï¼Œç»™å®š$p$å’Œ$k_i$â€‹ï¼Œé—®å°†ç‰©å“åˆ†æˆä¸¤å †ï¼Œä½¿æƒå€¼å’Œçš„å·®æœ€å°ï¼Œé—®æœ€å°å€¼ã€‚</p><p>å¯ä»¥çœ‹æˆä¸€ä¸ªpè¿›åˆ¶çš„æ•°ï¼Œæ¯æ¬¡å°†å½“å‰æœ€é«˜ä½ä¸¢å…¥ç¬¬ä¸€å †ï¼Œç„¶åç”¨åé¢çš„æ•°ä¸æ–­è¡¥ç»™ç¬¬äºŒå †ï¼Œç›´åˆ°ä¸ç¬¬ä¸€å †ç›¸ç­‰ï¼Œç„¶åé‡å¤å³å¯ã€‚è®°å½•ä¸¤å †ç›¸å·®çš„pçš„å¹‚æ¬¡å³å¯ï¼Œç»†èŠ‚è¾ƒå¤š<br>æ„Ÿè§‰æœ€è¿‘å†™é¢˜çš„æ­£ç¡®ç‡æœ‰ç‚¹ä½ï¼Œæ€»æ˜¯çŠ¯äº›å¥‡å¥‡æ€ªæ€ªçš„é”™è¯¯ï¼Œå¯¼è‡´è°ƒçš„æ—¶å€™ä¹Ÿå¾ˆçƒ¦</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ç”¨nä¸ªçº¿æ®µï¼Œæ¯ä¸ªçº¿æ®µçš„ç«¯ç‚¹æœ‰æƒå€¼aå’Œbï¼Œè¦æ±‚å°†å®ƒä»¬ä¸²æˆä¸€ä¸ªç¯ï¼Œå®šä¹‰ä¸¤æ¡çº¿æ®µè¿æ¥ç‚¹å¤„çš„æƒå€¼ä¸º$highbit(a^b)$ï¼Œç¯çš„ä»·å€¼ä¸ºæ‰€æœ‰è¿æ¥ç‚¹å¤„ä»·å€¼çš„æœ€å°å€¼ï¼Œé—®ç¯çš„ä»·å€¼æœ€å¤§æ˜¯å¤šå°‘</p><p>æ˜¾ç„¶äºŒåˆ†ä»·å€¼ï¼ˆç”±äºåªæœ‰20ï¼Œç›´æ¥ä»å¤§åˆ°å°æšä¸¾å³å¯ï¼Œè€ƒè™‘å¦‚ä½•checkã€‚å¦‚æœä»·å€¼ä¸ºxï¼Œè¯´æ˜è¿æ¥ç‚¹å¤„ä¸¤ç‚¹æƒå€¼çš„ä½xä½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æŒ‰ç…§a&amp;((1&lt;&lt;k)-1) â€“ b&amp;((1&lt;&lt;k)-1)å»ºå›¾ï¼Œçœ‹æ˜¯å¦å­˜åœ¨æ¬§æ‹‰å›è·¯å³å¯<br>æˆ‘è²Œä¼¼ä¸ä¼šæ¬§æ‹‰å›è·¯æ€ä¹ˆè®°å½•ã€‚ã€‚ã€‚<br>éšä¾¿ä»ä¸€ç‚¹å‡ºå‘æ‰¾å‡ºæ¬§æ‹‰è·¯å¾„ï¼Œçœ‹å…¶é•¿åº¦æ˜¯å¦ä¸ºnï¼Œå†çœ‹<strong>é¦–å°¾è¿æ¥ç‚¹å¤„çš„æƒå€¼æ˜¯å¦æ»¡è¶³è¦æ±‚</strong><br>ï¼Œæ³¨æ„åœ¨æ‰¾è·¯å¾„å‰è¦å…ˆåˆ©ç”¨åº¦æ•°è¿›è¡Œåˆ¤æ–­ï¼Œå¦åˆ™æ‰¾çš„è·¯å¾„ä¼šå‡ºé—®é¢˜ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰<br>å¯¹äºæ¬§æ‹‰å›¾ï¼ˆå­˜åœ¨æ¬§æ‹‰å›è·¯ï¼‰ï¼Œæ‰€æœ‰ç‚¹åº¦æ•°ä¸€å®šéƒ½æ˜¯å¶æ•°ï¼Œä¸”ä¸ºè¿é€šå›¾ï¼ˆå¯ä»¥ä¸åˆ¤æ–­ï¼Œå› ä¸ºå¦‚æœæ‰¾åˆ°çš„æ¬§æ‹‰è·¯å¾„&lt;nå°±è¯´æ˜ä¸è¿é€šï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = (<span class="number">1</span>&lt;&lt;<span class="number">20</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, a[N], b[N], cur[N], in[N], out[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; path;</span><br><span class="line">vector&lt;pii&gt; G[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> pre)</span> <span class="comment">//æ‰¾æ¬§æ‹‰è·¯å¾„çš„æ¿å­</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(cur[u]&lt;<span class="built_in">sz</span>(G[u]))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = G[u][cur[u]].fi, id = G[u][cur[u]].se;</span><br><span class="line">    ++cur[u];</span><br><span class="line">    <span class="keyword">if</span>(!vis[id])</span><br><span class="line">    &#123;</span><br><span class="line">      vis[id] = vis[id^<span class="number">1</span>] = <span class="number">1</span>; <span class="comment">//æ¯æ¡è¾¹æ­£å‘å’Œåå‘é€‰å…¶1ï¼Œæ‰€ä»¥èµ°äº†ä¸€ä¸ªåï¼Œå¦ä¸€ä¸ªä¹Ÿè¦æ ‡è®°</span></span><br><span class="line">      <span class="built_in">dfs</span>(v, id);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(pre!=<span class="number">-1</span>) path.<span class="built_in">pb</span>(pre);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) cin &gt;&gt; a[i] &gt;&gt; b[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">20</span>; k&gt;=<span class="number">0</span>; k--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> c = (<span class="number">1</span>&lt;&lt;k) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=c; i++) G[i].<span class="built_in">clear</span>(), cur[i] = <span class="number">0</span>, in[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=<span class="number">2</span>*n+<span class="number">1</span>; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      G[a[i]&amp;c].<span class="built_in">emplace_back</span>(b[i]&amp;c, <span class="number">2</span>*i);</span><br><span class="line">      G[b[i]&amp;c].<span class="built_in">emplace_back</span>(a[i]&amp;c, <span class="number">2</span>*i+<span class="number">1</span>);</span><br><span class="line">      in[a[i]&amp;c]++, in[b[i]&amp;c]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> ok = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=c&amp;&amp;ok; i++)</span><br><span class="line">      <span class="keyword">if</span>(in[i]&amp;<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!ok) <span class="keyword">continue</span>;</span><br><span class="line">    path.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="built_in">dfs</span>(a[<span class="number">1</span>]&amp;c, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sz</span>(path)&lt;n) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(path[<span class="number">0</span>]%<span class="number">2</span>&amp;&amp;(a[(path[<span class="number">0</span>]<span class="number">-1</span>)/<span class="number">2</span>]&amp;c)!=(a[<span class="number">1</span>]&amp;c)) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(path[<span class="number">0</span>]%<span class="number">2</span>==<span class="number">0</span>&amp;&amp;(b[path[<span class="number">0</span>]/<span class="number">2</span>]&amp;c)!=(a[<span class="number">1</span>]&amp;c)) <span class="keyword">continue</span>;</span><br><span class="line">    cout &lt;&lt; k &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x : path)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(x&amp;<span class="number">1</span>) cout &lt;&lt; x<span class="number">-2</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; x<span class="number">-1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; x<span class="number">-1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lyndon åˆ†è§£</title>
      <link href="/2020/06/03/lyndon-fen-jie/"/>
      <url>/2020/06/03/lyndon-fen-jie/</url>
      
        <content type="html"><![CDATA[<h3 id="æ¦‚å¿µ"><a class="header-anchor" href="#æ¦‚å¿µ">Â¶</a>æ¦‚å¿µ</h3><p>Lyndonä¸²ï¼šsæ˜¯sæ‰€æœ‰åç¼€ä¸­å­—å…¸åºæœ€å°çš„ï¼ˆsæ˜¯å…¶æ‰€æœ‰å¾ªåä½ç§»ä¸­æœ€å°çš„ä¸€ä¸ªï¼‰<br>Lyndonåˆ†è§£ï¼šLyndon åˆ†è§£æ˜¯å°†å­—ç¬¦ä¸² s åˆ†è§£æˆ $s=s_1s_2 \dots s_n$â€‹,ä½¿å¾—æ¯ä¸ª$s_i$â€‹éƒ½æ˜¯Lyndonä¸²ï¼Œä¸”$s_i\geq s_{i+1}$</p><h3 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h3><p>Lyndonåˆ†è§£å”¯ä¸€ï¼Œä¸”æ¯ä¸ªå­—ç¬¦ä¸²éƒ½å­˜åœ¨Lyndonåˆ†è§£ã€‚</p><h3 id="Duval-ç®—æ³•"><a class="header-anchor" href="#Duval-ç®—æ³•">Â¶</a>Duval ç®—æ³•</h3><p>$O(n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> j = i, k = i+<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(k&lt;=n&amp;&amp;s[j]&lt;=s[k])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(s[j]&lt;s[k]) j = i;</span><br><span class="line">    <span class="keyword">else</span> j++;</span><br><span class="line">    k++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=j)</span><br><span class="line">  &#123;</span><br><span class="line">    ans ^= i+k-j<span class="number">-1</span>;  <span class="comment">// [i:i+k-j-1]æ˜¯æŸä¸ªåˆ†è§£çš„s_i</span></span><br><span class="line">    i += k-j;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€å°è¡¨ç¤ºæ³•åªè¦å¯¹s+sè¿›è¡ŒLyndonåˆ†è§£å¹¶æ‰¾åˆ°æœ€åä¸€ä¸ªåˆ†è§£çš„ä¸²çš„èµ·ç‚¹å–é•¿åº¦nå³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Stern-Brocot æ ‘ä¸ Farey åºåˆ—</title>
      <link href="/2020/06/03/stern-brocot-shu-yu-farey-xu-lie/"/>
      <url>/2020/06/03/stern-brocot-shu-yu-farey-xu-lie/</url>
      
        <content type="html"><![CDATA[<h2 id="Stern-Brocot-æ ‘"><a class="header-anchor" href="#Stern-Brocot-æ ‘">Â¶</a>Stern-Brocot æ ‘</h2><h3 id="æ„é€ "><a class="header-anchor" href="#æ„é€ ">Â¶</a>æ„é€ </h3><p>ä»ä¸¤ä¸ªæœ€ç®€å•çš„åˆ†æ•°å¼€å§‹ï¼š $\dfrac 01 \quad \dfrac 10$<br>æ¯æ¬¡åœ¨ç›¸é‚»çš„ä¸¤ä¸ªåˆ†æ•°$\dfrac {a}{b} \quad \dfrac{c}{d}$â€‹ä¸­é—´æ’å…¥ä¸€ä¸ªåˆ†æ•°$\dfrac{a+c}{b+d}$â€‹å³å¯</p><h3 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h3><ul><li><p>æ¯ä¸€å±‚çš„åºåˆ—ä¸­ï¼Œåˆ†æ•°å•è°ƒé€’å¢ï¼Œå³$\dfrac {a}{b} &lt; \dfrac{a+c}{b+d} &lt; \dfrac{c}{d}$<br>è¿™æ˜¯ä¸€æ£µå¹³è¡¡æ ‘ï¼Œä¸­åºéå†æ˜¯æœ‰åºçš„ï¼ˆå»ºæ ‘ã€æŸ¥æ‰¾ï¼‰</p></li><li><p>æ¯ä¸ªåˆ†æ•°éƒ½æ˜¯æœ€ç®€åˆ†æ•°</p></li><li><p>å¯ä»¥è¡¨ç¤ºå‡º<strong>æ‰€æœ‰</strong>çš„æœ€ç®€åˆ†æ•°ï¼Œæ¯ä¸ªåˆ†æ•°å”¯ä¸€</p></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> a = <span class="number">0</span>, <span class="type">int</span> b = <span class="number">1</span>, <span class="type">int</span> c = <span class="number">1</span>, <span class="type">int</span> d = <span class="number">0</span>, <span class="type">int</span> level = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = a + c, y = b + d;</span><br><span class="line">  <span class="comment">// ... output the current fraction x/y</span></span><br><span class="line">  <span class="comment">// at the current level in the tree</span></span><br><span class="line">  <span class="built_in">build</span>(a, b, x, y, level + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">build</span>(x, y, c, d, level + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Fareyåºåˆ—"><a class="header-anchor" href="#Fareyåºåˆ—">Â¶</a>Fareyåºåˆ—</h2><p>Fiï¼šæŠŠåˆ†æ¯å°äºç­‰äºiçš„æ‰€æœ‰æœ€ç®€çœŸåˆ†æ•°æŒ‰å¤§å°é¡ºåºæ’åˆ—å½¢æˆçš„åºåˆ—ã€‚<br>å¯ä»¥é€šè¿‡SBæ ‘çš„æ–¹æ³•ç±»ä¼¼æ„é€ <br>é•¿åº¦ï¼š<br>$L_i = L_{i-1} + \phi(i)$<br>$L_i = 1 + \sum_{j=1}^n \phi(j)$<br>åˆ†æ¯æ¯å¢å¤§1ï¼Œå¯ä»¥å¤šphi(i)ä¸ªæœ€ç®€çœŸåˆ†æ•°ï¼Œå³ä¸iäº’è´¨</p><p>æ±‚$f(x) = \dfrac{k}{x}$ ä¸ $g(x) = x^{\frac12}$â€‹çš„äº¤ç‚¹çš„æ¨ªåæ ‡çš„æœ€æ¥è¿‘çš„åˆ†æ•°ï¼Œè¦æ±‚åˆ†æ¯å°äº$10^5$<br>ç›¸å½“äºè¦æ‰¾åˆ°æœ€æ¥è¿‘$k^\frac13$â€‹çš„åˆ†æ•°<br>ä»¤åˆå§‹åˆ†æ•°ä¸ºa = x-1, b = 1, c = x, d = 1<br>ç„¶ååœ¨SBæ ‘ä¸Šä¸æ–­è¿­ä»£é è¿‘å³å¯ï¼ˆç±»ä¼¼äºŒåˆ†çš„è¿‡ç¨‹ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll x, k;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;k);</span><br><span class="line">    x = <span class="number">1</span>;</span><br><span class="line">    k = k*k;</span><br><span class="line">    <span class="keyword">while</span>(x*x*x&lt;k) x++;</span><br><span class="line">    <span class="keyword">if</span>(x*x*x==k) <span class="built_in">printf</span>(<span class="string">&quot;%lld/1\n&quot;</span>, x);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ll a = x<span class="number">-1</span>, b = <span class="number">1</span>, c = x, d = <span class="number">1</span>, p = <span class="number">0</span>, q = <span class="number">0</span>;</span><br><span class="line">      <span class="type">long</span> <span class="type">double</span> delta = <span class="built_in">min</span>(x*x*x-k, k-(x<span class="number">-1</span>)*(x<span class="number">-1</span>)*(x<span class="number">-1</span>));</span><br><span class="line">      <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        ll x = a + c, y = b + d;</span><br><span class="line">        <span class="keyword">if</span>(y&gt;<span class="number">100000</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="type">long</span> <span class="type">double</span> tmp = (<span class="type">long</span> <span class="type">double</span>)x*x*x/(y*y*y);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(tmp-k)&lt;delta)</span><br><span class="line">        &#123;</span><br><span class="line">          delta = <span class="built_in">fabs</span>(tmp-k);</span><br><span class="line">          p = x, q = y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(tmp&gt;k) c = x, d = y;</span><br><span class="line">        <span class="keyword">else</span> a = x, b = y;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%lld/%lld\n&quot;</span>, p, q);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YsOI2020 å¹¼å„¿å›­ æ€ç»´</title>
      <link href="/2020/06/02/ysoi2020you-er-yuan-si-wei/"/>
      <url>/2020/06/02/ysoi2020you-er-yuan-si-wei/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šæœ‰å‘å›¾ï¼Œnä¸ªç‚¹mæ¡è¾¹ï¼Œæ¯æ¡è¾¹æœ‰æƒå€¼iï¼Œä¸”æ°å¥½æ˜¯1-mçš„ä¸€ä¸ªæ’åˆ—ï¼Œå¤šæ¬¡è¯¢é—®ä»xç‚¹åªèµ°$[l,<br>r]$çš„è¾¹ï¼Œä¸”è¾¹æƒä¸¥æ ¼å•è°ƒä¸‹é™èƒ½å¦åˆ°è¾¾1å·ç‚¹ï¼Œå¼ºåˆ¶åœ¨çº¿</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>é™åˆ¶äº†è¾¹æƒçš„èŒƒå›´$[l, r]$ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè€ƒè™‘$[1,<br>r]$çš„æ—¶å€™æ€ä¹ˆåšï¼Œè€ƒè™‘dp[u]è¡¨ç¤ºuå·ç‚¹ä¸1è¿é€šéœ€è¦çš„æœ€å°è¾¹æƒï¼Œä»å°åˆ°å¤§æšä¸¾æ¯ä¸€æ¡è¾¹ï¼Œå¦‚æœè¯¥ç‚¹ä¸1ç›¸è¿ï¼Œåˆ™dp[u]=wï¼Œå¦åˆ™å¦‚æœdp[v]æœ‰å€¼ï¼Œåˆ™dp[u]=iï¼Œç„¶ååªè¦çœ‹dp[u]æ˜¯ä¸æ˜¯å°äºrå³å¯<br>åŠ å…¥ä¸‹ç•Œé™åˆ¶åï¼Œå°†dp[u]è½¬åŒ–ä¸ºä¸1è¿é€šæ—¶éœ€è¦ç»è¿‡çš„æœ€å°è¾¹æƒ<strong>æœ€å¤§</strong><br>æ˜¯å¤šå°‘ï¼Œå¦‚æœè¯¥ç‚¹ä¸1ç›¸è¿ï¼Œåˆ™dp[u]=iï¼Œå¦åˆ™dp[u]=max(dp[u],dp[v])ï¼Œéšç€ä»å°åˆ°å¤§æšä¸¾è¾¹æƒdpï¼Œdp[u]æ˜¯ä¸æ–­å˜å¤§çš„ï¼Œè€ƒè™‘æŒ‰ç…§æšä¸¾é¡ºåºå»ºç«‹ä¸»å¸­æ ‘ï¼Œæ¯æ¬¡å•ç‚¹æ›´æ–°uç‚¹çš„å€¼ï¼Œè¯¢é—®åªè¦æŸ¥è¯¢rt[r]ç‰ˆæœ¬çš„ä¸»å¸­æ ‘ä¸­xç‚¹çš„å€¼æ˜¯å¦&gt;=lå³å¯ã€‚<br>ç›¸å½“äºæ¯ä¸ªç‚¹å¤„æœ‰å¾ˆå¤šå•è°ƒé€’å¢çš„äºŒç»´ç‚¹ï¼ˆxåæ ‡ä¸ºè¾¹æƒï¼Œyåæ ‡ä¸ºdpï¼‰ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªç‚¹ç”¨vectorå­˜è¿™äº›ç‚¹ï¼Œé‚£ä¹ˆåªè¦çœ‹x&lt;=rçš„æœ€åä¸€ä¸ªç‚¹çš„yæ˜¯å¦&gt;=lã€‚</p><h3 id="æ€è€ƒ"><a class="header-anchor" href="#æ€è€ƒ">Â¶</a>æ€è€ƒ</h3><p>ä¸¥æ ¼å•è°ƒä¸‹é™çš„é™åˆ¶åªè¦é€šè¿‡ä»å°åˆ°å¤§çš„é¡ºåºdpå³å¯è§£å†³ï¼Œå¯¹äºæ—¢æœ‰ä¸Šç•Œåˆæœ‰ä¸‹ç•Œçš„é™åˆ¶ï¼Œè€ƒè™‘æšä¸¾ä¸Šç•Œï¼Œç„¶åæœ€å¤§åŒ–ä¸‹ç•Œå³å¯</p><p>ä¸»å¸­æ ‘å†™æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, k, w, dp[N];</span><br><span class="line">pii edges[N];</span><br><span class="line"><span class="keyword">namespace</span> PSegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls(x) t[x].l</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs(x) t[x].r</span></span><br><span class="line">  <span class="type">int</span> rt[N], tot;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, mx;</span><br><span class="line">  &#125;t[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[++tot] = t[p];</span><br><span class="line">    p = tot;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">newnode</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      t[p].mx = <span class="built_in">max</span>(t[p].mx, v);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(<span class="built_in">ls</span>(p), l, mid, x, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">upd</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x, v);</span><br><span class="line">    t[p].mx = <span class="built_in">max</span>(t[<span class="built_in">ls</span>(p)].mx, t[<span class="built_in">rs</span>(p)].mx);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[p].mx;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="built_in">ls</span>(p), l, mid, x);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> PSegTree;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k, &amp;w);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;edges[i].fi, &amp;edges[i].se);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = edges[i].fi, v = edges[i].se;</span><br><span class="line">    <span class="keyword">if</span>(v==<span class="number">1</span>) dp[u] = i;</span><br><span class="line">    <span class="keyword">else</span> dp[u] = <span class="built_in">max</span>(dp[u], dp[v]);</span><br><span class="line">    rt[i] = rt[i<span class="number">-1</span>];</span><br><span class="line">    <span class="built_in">upd</span>(rt[i], <span class="number">1</span>, m, u, dp[u]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> L = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x, l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;l, &amp;r);</span><br><span class="line">    <span class="keyword">if</span>(w) x ^= L, l ^= L, r ^= L;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1</span>||<span class="built_in">ask</span>(rt[r], <span class="number">1</span>, m, x)&gt;=l) ++L, <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF893F Subtree Minimum Query ä¸»å¸­æ ‘trick</title>
      <link href="/2020/06/02/cf893f-subtree-minimum-query-zhu-xi-shu-trick/"/>
      <url>/2020/06/02/cf893f-subtree-minimum-query-zhu-xi-shu-trick/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šä¸€æ£µæœ‰ç‚¹æƒçš„æ ‘ï¼Œæ¯æ¬¡è¯¢é—®ç‚¹uå­æ ‘ä¸­è·ç¦»u&lt;=kçš„ç‚¹çš„ç‚¹æƒçš„æœ€å°å€¼ï¼Œè¦æ±‚åœ¨çº¿å›ç­”</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è¯¢é—®å­æ ‘ï¼Œè€ƒè™‘dfsåºï¼Œå³è¯¢é—®$[in[u]ï¼šout[u]]$<br>$[dep[u]ï¼šdep[u]+k]$ä¸­çš„min{a}<br>äºŒç»´ååºï¼Œå‘ç°æ¯ä¸ªdfsåºå¯¹åº”äº†ä¸€ä¸ªç‚¹ï¼ŒæŒ‰ç…§æ·±åº¦å»ºä¸»å¸­æ ‘ï¼Œæ¯ä¸ªç‰ˆæœ¬çš„ä¸»å¸­æ ‘ç»´æŠ¤çš„æ˜¯$[1,dep[u]]$è¿™ä¸ªæ·±åº¦å‰ç¼€ä¸­dfsåºåŒºé—´çš„æœ€å°å€¼ï¼ŒæŒ‰ç…§bfsæ·±åº¦é¡ºåºæ›´æ–°ã€‚<br>è¯¢é—®çš„æ—¶å€™åªè¦ask dep[u]+kç‰ˆæœ¬çš„ä¸»å¸­æ ‘ä¸­[in[u], out[u]]åŒºé—´çš„æœ€å°å€¼å³å¯</p><p>ä¸€äº›ä¸ä¸€å®šå¯¹çš„æ€è€ƒï¼š<br>çº¿æ®µæ ‘å¯ä»¥é«˜æ•ˆç»´æŠ¤ä¸€æ®µåŒºé—´çš„ä¿¡æ¯ï¼Œè€Œä¸»å¸­æ ‘å¯ä»¥ç»´æŠ¤å„ä¸ªç‰ˆæœ¬çš„çº¿æ®µæ ‘ï¼Œæ¯ä¸ªç‰ˆæœ¬ç»´æŠ¤çš„æ˜¯å®ƒåŠå…¶ä¹‹å‰çš„æ‰€æœ‰ç‰ˆæœ¬çš„å‰ç¼€ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸»å¸­æ ‘å¯ä»¥ç»´æŠ¤äºŒç»´çš„ä¿¡æ¯ï¼Œé€šè¿‡è½¬å˜ç»´åº¦ï¼Œå·§å¦™çš„åˆ©ç”¨æŸä¸€ç»´æ¥å»ºæ ‘å¯ä»¥è§£å†³å¾ˆå¤šé—®é¢˜ã€‚è¯¥é¢˜ä¸­æœ€å°å€¼ä¸å¯å‡ï¼Œæ‰€ä»¥åªèƒ½è¯¢é—®å‰ç¼€ï¼Œè€Œä¸èƒ½è¯¢é—®rt[l]-rt[r]ï¼Œä½†æ˜¯åœ¨è¯¥dfsåºä¸­çš„ç‚¹dep[u]éƒ½æ˜¯ç¬¦åˆæ¡ä»¶çš„ï¼Œæ‰€ä»¥æ²¡æœ‰é—®é¢˜ã€‚å†è¯´å¸¦ä¿®çš„ä¸»å¸­æ ‘ï¼Œç”±äºä¸»å¸­æ ‘ç»´æŠ¤çš„æ˜¯æ¯ä¸ªç‰ˆæœ¬çš„å‰ç¼€ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨ä¿®æ”¹çš„æ—¶å€™éœ€è¦ä¿®æ”¹åé¢æ¯ä¸ªç‰ˆæœ¬çš„ä¿¡æ¯ï¼Œæ‰€ä»¥è€ƒè™‘åœ¨å¤–å±‚å¥—ä¸€ä¸ªæ ‘çŠ¶æ•°ç»„ï¼Œæ­¤æ—¶æ ‘çŠ¶æ•°ç»„ä¸­æ¯æ£µä¸»å¸­æ ‘ç»´æŠ¤çš„ä¸å†æ˜¯å‰ç¼€ä¿¡æ¯äº†ï¼Œä¸éœ€è¦ç»§æ‰¿å‰ä¸€ä¸ªç‰ˆæœ¬(rt[i]=rt[i-1])ï¼Œæ¯æ¬¡çš„æŸ¥è¯¢å’Œè¯¢é—®æ“ä½œéƒ½åªä¸logæ£µä¸»å¸­æ ‘ç›¸å…³</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, r, a[N], in[N], out[N], dfn, dep[N];</span><br><span class="line"><span class="type">int</span> m, p, q, mxdep;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="keyword">namespace</span> PSegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls(x) t[x].l</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs(x) t[x].r</span></span><br><span class="line">  <span class="type">int</span> rt[N], tot;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, mn;</span><br><span class="line">  &#125;t[N&lt;&lt;<span class="number">5</span>];</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">newnode</span><span class="params">(<span class="type">int</span> &amp;p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[++tot] = t[p];</span><br><span class="line">    p = tot;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">newnode</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      t[p].mn = <span class="built_in">min</span>(t[p].mn, v);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(<span class="built_in">ls</span>(p), l, mid, x, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">upd</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x, v);</span><br><span class="line">    t[p].mn = <span class="built_in">min</span>(t[<span class="built_in">ls</span>(p)].mn, t[<span class="built_in">rs</span>(p)].mn);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> ql, <span class="type">int</span> qr)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=ql&amp;&amp;r&lt;=qr) <span class="keyword">return</span> t[p].mn;</span><br><span class="line">    <span class="type">int</span> ans = INF, mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql&lt;=mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(<span class="built_in">ls</span>(p), l, mid, ql, qr));</span><br><span class="line">    <span class="keyword">if</span>(qr&gt;mid) ans = <span class="built_in">min</span>(ans, <span class="built_in">ask</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, ql, qr));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> PSegTree;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  in[u] = ++dfn;</span><br><span class="line">  dep[u] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">  mxdep = <span class="built_in">max</span>(mxdep, dep[u]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  out[u] = dfn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(r);</span><br><span class="line">  <span class="type">int</span> curd = <span class="number">0</span>;</span><br><span class="line">  rt[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  t[<span class="number">0</span>].mn = INF;</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">sz</span>(q))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(dep[u]&gt;curd)</span><br><span class="line">    &#123;</span><br><span class="line">      rt[dep[u]] = rt[curd];</span><br><span class="line">      curd = dep[u];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">upd</span>(rt[dep[u]], <span class="number">1</span>, n, in[u], a[u]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">      <span class="keyword">if</span>(dep[v]==dep[u]+<span class="number">1</span>) q.<span class="built_in">push</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;r);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    G[x].<span class="built_in">pb</span>(y); G[y].<span class="built_in">pb</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(r, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">bfs</span>();</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line">  <span class="type">int</span> lstans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;p, &amp;q);</span><br><span class="line">    p = (p+lstans)%n + <span class="number">1</span>;</span><br><span class="line">    q = (q+lstans)%n;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, lstans=<span class="built_in">ask</span>(rt[<span class="built_in">min</span>(mxdep, dep[p]+q)], <span class="number">1</span>, n, in[p], out[p]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P6583 å›é¦–è¿‡å» æ•°è®º+æ•´é™¤åˆ†å—</title>
      <link href="/2020/06/02/p6583-hui-shou-guo-qu-shu-lun-zheng-chu-fen-kuai/"/>
      <url>/2020/06/02/p6583-hui-shou-guo-qu-shu-lun-zheng-chu-fen-kuai/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®š$n&lt;=10^{12}$<br>è¯¢é—®$\sum_{x=1}^n \sum_{y=1}^n \left[ \dfrac{x}{y}\text{æ˜¯æœ‰é™å°æ•°}\right]$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å½“çœŸåˆ†æ•°$\dfrac {x}{y}$â€‹ä¸­åˆ†æ¯yä¸º$2^p5^q$çš„å½¢å¼æ—¶æ‰ä¸ºæœ‰é™å°æ•°<br>å³å¯ä»¥è¡¨ç¤ºæˆ$\dfrac {d*gcd(x, y)}{2^p5^qgcd(x,y)}$<br>è€ƒè™‘æšä¸¾åˆ†æ¯yï¼Œåˆ™å¯è¡Œçš„xçš„ä¸ªæ•°ä¸º$\left \lfloor \dfrac {n}{\zeta(y)} \right\rfloor$ï¼Œ$\zeta(y)$è¡¨ç¤ºå°äºç­‰äºyçš„æœ€å¤§çš„ä¸å«2å’Œ5çš„å› å­çš„æ•´æ•°ï¼Œç›¸å½“äºæ˜¯gcd(x, y)<br>è¿™æ ·æ˜¯O(n)çš„ï¼Œè€ƒè™‘æ”¹å˜æšä¸¾é¡ºåº<br>æšä¸¾$\zeta(y)$ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯$\sum_{k=1}^n [2 \nmid k][5<br>\nmid k] \left \lfloor \dfrac {n}{k} \right \rfloor g(\left \lfloor \dfrac<br>{n}{k} \right \rfloor)$<br>æ˜¾ç„¶å¯ä»¥æ•´é™¤åˆ†å—ï¼Œå…¶ä¸­g(i)ä»£è¡¨å°äºç­‰äºiçš„ä¸”èƒ½è¡¨ç¤ºæˆ$2^p5^q$çš„æ•°çš„ä¸ªæ•°ï¼ˆç›¸å½“äºæ˜¯è´¡çŒ®æ¬¡æ•°ï¼‰ã€‚<br>ç„¶åå¯ä»¥é€šè¿‡å®¹æ–¥è®¡ç®—å‡ºåŒºé—´å†…ä¸è¢«2å’Œ5æ•´é™¤çš„æ•°çš„ä¸ªæ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll n;</span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> x - x/<span class="number">2</span> - x/<span class="number">5</span> + x/<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">g</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(ll i=<span class="number">1</span>; i&lt;=x; i*=<span class="number">2</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(ll j=<span class="number">1</span>; j&lt;=x; j*=<span class="number">5</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(i*j&gt;x) <span class="keyword">break</span>;</span><br><span class="line">      ans++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;n);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(ll l=<span class="number">1</span>,r; l&lt;=n; l=r+<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    r = <span class="built_in">min</span>(n, n/(n/l));</span><br><span class="line">    ans += (<span class="built_in">f</span>(r) - <span class="built_in">f</span>(l<span class="number">-1</span>))*(n/l)*<span class="built_in">g</span>(n/l);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019ICPC å¾å·</title>
      <link href="/2020/05/31/2019icpc-xu-zhou/"/>
      <url>/2020/05/31/2019icpc-xu-zhou/</url>
      
        <content type="html"><![CDATA[<h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>æš´åŠ›æ‰“è¡¨å³å¯ï¼Œä¸è¿‡åœ¨æˆ‘ç”µè„‘ä¸Šè·‘çš„æŒºæ…¢çš„ã€‚ã€‚</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>ç´ æ•°å¯†åº¦æ˜¯ä¸æ–­å˜å°çš„</p><h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>åˆ©ç”¨è¿ç»­æ•´æ•°å¼‚æˆ–å’Œçš„trickå³å¯ï¼Œåªè¦å°èŒƒå›´æšä¸¾å·¦å³ä¸¤ç«¯ç‚¹ï¼Œä¸­é—´ä¸€å¤§æ®µå¤§æ¦‚ç‡å¯ä»¥æ˜¯0</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>æ±‚å‡º$\frac{Y!} {\prod {a_i}}$â€‹æ˜¯Xçš„å¤šå°‘æ¬¡æ–¹çš„å€æ•°<br>åˆ©ç”¨pollardrhoæ±‚è§£Xçš„æ‰€æœ‰ç´ å› å­ï¼Œç„¶åæ±‚å‡ºå„ä¸ªé˜¶ä¹˜ä¸­å„ç´ å› å­å¹‚æ¬¡çš„æ•°é‡ï¼Œä¹˜æ³•+ï¼Œé™¤æ³•-ï¼Œæœ€åæ¯ä¸ªç´ å› å­å–ä¸ªminï¼Œæ³¨æ„è´Ÿæ•°å’Œæ­£æ•°ä¸Šä¸‹å–æ•´çš„é—®é¢˜</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´è¯¢é—®è¯¥æ®µåŒºé—´æœ€å°çš„ä¸èƒ½è¢«è¡¨ç¤ºçš„æ•°<br>æ´›è°·p4587+ä¿®æ”¹<br>å…ˆè€ƒè™‘ä¸å¸¦ä¿®æ”¹çš„æƒ…å†µï¼Œå¯¹[l,r]å†…çš„æ•°ä»å°åˆ°å¤§è€ƒè™‘ï¼Œå‡è®¾å½“å‰èƒ½å¤Ÿè¡¨ç¤ºå‡º[1,cur]çš„èŒƒå›´ï¼Œå¦‚æœè¯¢é—®[1,cur+1]çš„å€¼ç­‰äºcurï¼Œè¯´æ˜å‰©ä½™çš„å€¼éƒ½æ˜¯å¤§äºç­‰äºcur+2çš„ï¼Œæ­¤æ—¶cur+1æ˜¯æ— æ³•è¢«è¡¨ç¤ºå‡ºæ¥çš„ï¼Œæ‰€ä»¥breakï¼Œå®¹æ˜“å‘ç°è¯¥æ“ä½œä¸­curçš„å¢é•¿é€Ÿåº¦æ˜¯fibnacciçº§åˆ«çš„ï¼Œåˆ©ç”¨ä¸»å¸­æ ‘å®ŒæˆäºŒç»´æ•°ç‚¹é—®é¢˜ã€‚<br>è‡³äºä¿®æ”¹ï¼Œåœ¨å¤–å±‚å¥—ä¸€ä¸ªæ ‘çŠ¶æ•°ç»„å³å¯ï¼Œå¤æ‚åº¦$O(n \log^3 n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>, up = <span class="number">2e5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, a[N];</span><br><span class="line"><span class="keyword">namespace</span> PSegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls(x) t[x].l</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs(x) t[x].r</span></span><br><span class="line">  <span class="type">int</span> rt[N], tot;</span><br><span class="line">  <span class="type">int</span> lrt[N], rrt[N], lc, rc;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    ll sum;</span><br><span class="line">  &#125;t[N*<span class="number">128</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p) p = ++tot;</span><br><span class="line">    t[p].sum += x*v;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">insert</span>(<span class="built_in">ls</span>(p), l, mid, x, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">insert</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">ll <span class="title">ask</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      ll ans = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) ans -= t[lrt[i]].sum;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) ans += t[rrt[i]].sum;</span><br><span class="line">      <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lrt[i] = <span class="built_in">ls</span>(lrt[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) rrt[i] = <span class="built_in">ls</span>(rrt[i]);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">ask</span>(l, mid, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ll ans = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) ans -= t[<span class="built_in">ls</span>(lrt[i])].sum;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) ans += t[<span class="built_in">ls</span>(rrt[i])].sum;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lrt[i] = <span class="built_in">rs</span>(lrt[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) rrt[i] = <span class="built_in">rs</span>(rrt[i]);</span><br><span class="line">      <span class="keyword">return</span> ans + <span class="built_in">ask</span>(mid+<span class="number">1</span>, r, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> PSegTree;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) <span class="built_in">insert</span>(rt[i], <span class="number">1</span>, up, a[x], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  lc = rc = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l<span class="number">-1</span>; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) lrt[++lc] = rt[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=r; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) rrt[++rc] = rt[i];</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="number">1</span>, up, x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">upd</span>(i, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, x, y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">upd</span>(x, <span class="number">-1</span>);</span><br><span class="line">      a[x] = y;</span><br><span class="line">      <span class="built_in">upd</span>(x, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ll cur = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        ll sum = <span class="built_in">query</span>(x, y, <span class="built_in">min</span>((ll)up, cur+<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">if</span>(sum==cur) <span class="keyword">break</span>;</span><br><span class="line">        cur = sum;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, cur+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>â€œç§‘æ—æ˜ä¼¦æ¯â€å“ˆå°”æ»¨ç†å·¥å¤§å­¦ç¬¬åå±Šç¨‹åºè®¾è®¡ç«èµ›</title>
      <link href="/2020/05/31/ke-lin-ming-lun-bei-ha-er-bin-li-gong-da-xue-di-shi-jie-cheng-xu-she-ji-jing-sai/"/>
      <url>/2020/05/31/ke-lin-ming-lun-bei-ha-er-bin-li-gong-da-xue-di-shi-jie-cheng-xu-she-ji-jing-sai/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><p>ç»™å®šä¸€æ£µæ ‘ï¼Œå®šä¹‰ç‚¹å¯¹ï¼ˆs, tï¼‰é—´è·ç¦»ä¸º<strong>è·¯å¾„ä¸Šè¾¹æƒå’Œ+så’Œtçš„ç‚¹æƒå’Œ</strong><br>dpè®°å½•æ¯ä¸ªç‚¹å­æ ‘ä¸­åˆ°è¯¥ç‚¹çš„æœ€å¤§å’Œæ¬¡å¤§è·ç¦»å³å¯<br>æ¯”èµ›çš„æ—¶å€™ç”¨æ ‘ç›´å¾„ä¸¤æ¬¡dfsçš„æ–¹æ³•waäº†ï¼Œåº”è¯¥æ˜¯æœ‰é—®é¢˜</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™å®šnä¸ªæ•°ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€æ®µåŒºé—´ï¼Œä½¿åŒºé—´-1ï¼Œé—®æœ€å°‘å‡ æ¬¡æ“ä½œå¯ä»¥ä½¿æ‰€æœ‰æ•°å˜ä¸º1<br>åŒºé—´æ“ä½œåˆ©ç”¨å·®åˆ†å°±å¯ä»¥è½¬åŒ–æˆä¸¤æ¬¡å•ç‚¹æ“ä½œï¼Œå†è´ªå¿ƒè€ƒè™‘å°±å¾ˆç®€å•äº†</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><p>å°å­¦æ•°å­¦</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>æ¡ä»¶æ¦‚ç‡ï¼Œ$P(A|B) = \frac {P(AB)} {P(B)}$<br>P(AB):è‡³å°‘mæšç¡¬å¸æ˜¯åé¢ï¼Œä¸”æ°å¥½kæšç¡¬å¸æ˜¯æ­£é¢åŒæ—¶å‘ç”Ÿï¼Œç”±äºæ­£é¢å›ºå®šï¼Œæ‰€ä»¥åé¢ä¸ºn-kï¼Œå½“$n-k&lt;m$æ—¶æ¦‚ç‡ä¸º0,å¦åˆ™ä¸º$C(n,k)/(2^n)$<br>P(B):ä»måˆ°næšä¸¾åé¢ç¡¬å¸ä¸ªæ•°ï¼Œ$\sum_{i=m}^{n} C(n,i)/(2^n)$<br>ä»£å…¥å…¬å¼å³å¯</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>ç®€å•è´ªå¿ƒï¼Œä»å°åˆ°å¤§å»æˆ˜èƒœï¼Œå¹¶ä¸”æ¯æ¬¡ç”¨åˆšå¥½å¤§äºçš„é‚£ä¸ª</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>æ˜¾ç„¶æ˜¯ä¸ªfibonacciï¼Œæ•°æ®èŒƒå›´æœ‰ç‚¹å‘ï¼Œæˆ‘å¼€äº†ullè¿˜æ˜¯waï¼Œæ”¹æˆpyå°±è¿‡äº†<br>ğŸ˜¡ğŸ˜¤</p><h2 id="G"><a class="header-anchor" href="#G">Â¶</a>G</h2><p>æ˜¾ç„¶æœ€å¤§æµ</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>æ¯å¢åŠ ä¸€æ¡è¾¹ï¼Œæœ€å¤šå¯ä»¥ä¸ä¹‹å‰çš„æ‰€æœ‰ç›´çº¿éƒ½äº§ç”Ÿä¸€ä¸ªäº¤ç‚¹<br>èœœæ±æ•°æ®èŒƒå›´ï¼Œåˆè¦å¤§æ•°ï¼Œä¸è¿‡pyä¸é¦™å—</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>ç»™å®šnä¸ªæ•°ï¼Œå®šä¹‰nä¸ªæ•°ç»„ï¼Œç¬¬iä¸ªæ•°ç»„ä¸ºåˆ å»$a_i$â€‹åå½¢æˆçš„ï¼Œé—®è¿™nä¸ªæ•°ç»„å­—å…¸åºä»å¤§åˆ°å°çš„æ’åˆ—é¡ºåº<br>è€ƒè™‘ç›¸é‚»ä¸¤ä¸ªæ•°$a_i, a_{i+1}$</p><ul><li>$a_i &lt; a_{i+1}$â€‹ iæ¯”åé¢æ‰€æœ‰çš„éƒ½è¦åŠ£</li><li>$a_i &gt; a_{i+1}$ iæ¯”åé¢æ‰€æœ‰çš„éƒ½è¦ä¼˜</li><li>$a_i = a_{i+1}$â€‹ iæ¯”i+1ä¼˜<br>è€ƒè™‘å°†ç›¸åŒçš„ä¸€èµ·è€ƒè™‘ï¼Œç„¶åç”¨ä¸¤ä¸ªæ ˆæ¥æ¨¡æ‹Ÿå³å¯</li></ul><h2 id="J"><a class="header-anchor" href="#J">Â¶</a>J</h2><p>é—®ä¸€ä¸ªä¸²ä¸­æœ€é•¿çš„ä¸å‰ç¼€ç›¸åŒçš„éå‰ç¼€ä¸²çš„é•¿åº¦<br>æ¯”èµ›çš„æ—¶å€™æ— è„‘äºŒåˆ†+kmp<br>next[i]è¡¨ç¤ºs[0:i]è¿™ä¸ªå‰ç¼€ä¸åç¼€ç›¸åŒçš„æœ€é•¿é•¿åº¦ï¼ˆå‰ç¼€æœ€é•¿borderï¼‰ï¼Œæ‰€ä»¥æ‰€æœ‰nextå–ä¸ªmaxå³å¯</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦é—¨å¤§å­¦â€œç½‘å®¿æ¯â€œ17å±Šç¨‹åºè®¾è®¡ç«èµ›å†³èµ›</title>
      <link href="/2020/05/31/sha-men-da-xue-wang-su-bei-17-jie-cheng-xu-she-ji-jing-sai-jue-sai/"/>
      <url>/2020/05/31/sha-men-da-xue-wang-su-bei-17-jie-cheng-xu-she-ji-jing-sai-jue-sai/</url>
      
        <content type="html"><![CDATA[<p>ABCç­¾åˆ°</p><h2 id="F"><a class="header-anchor" href="#F">Â¶</a>F</h2><p>å¯¹å°æ•°æ®å†™ä¸ªçˆ†æœåå¾ˆå®¹æ˜“å‘ç°è§„å¾‹</p><h2 id="D"><a class="header-anchor" href="#D">Â¶</a>D</h2><p>åˆ©ç”¨æ‰©å±•æ¬§æ‹‰å®šç†ï¼Œ$n*{a^n} \equiv n % p*{a^{n % (p-1)}}$<br>ä»¤$j = n%(p-1)$, $i = n%p$, $j-i=k$<br>æˆ‘ä»¬æšä¸¾açš„å¹‚æ¬¡jï¼ˆä»0åˆ°p-2ï¼‰ï¼Œåˆ©ç”¨é€†å…ƒç®—å‡ºiçš„å€¼<br>æ»¡è¶³æ¡ä»¶çš„$n = t(p-1)*p + kp + i$ï¼Œtä¸ºæ•´æ•°ï¼Œç®—å‡º[1,x]èŒƒå›´å†…ç¬¦åˆæ¡ä»¶çš„tçš„ä¸ªæ•°å³å¯</p><h2 id="E"><a class="header-anchor" href="#E">Â¶</a>E</h2><p>æœ‰å‘å›¾ï¼Œæ¯æ¡è¾¹æƒå€¼ä¸ºkx+b,é—®xåœ¨[0,H]èŒƒå›´å†…æœ€çŸ­è·¯æœ€é•¿æ˜¯å¤šå°‘ï¼Œå®¹æ˜“å‘ç°ä»1åˆ°nçš„è·¯å¾„åˆå¹¶åè¿˜æ˜¯ä¸€ä¸ªkx+bï¼Œå¯¹äºæŸä¸€å¤©ï¼Œå°±ç›¸å½“äºä¼—å¤šç›´çº¿åœ¨è¯¥å¤©çš„å€¼ä¸­å–minï¼Œå¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ªä¸Šå‡¸åŒ…ï¼Œæ±‚æœ€å¤§å€¼ä¸‰åˆ†å³å¯</p><h2 id="H"><a class="header-anchor" href="#H">Â¶</a>H</h2><p>å¯¹ä¸€ä¸ªæ•°åšgcdçš„ä¸‹é™é€Ÿåº¦æ˜¯å¾ˆå¿«çš„ï¼Œæ¯æ¬¡è‡³å°‘å‡åŠï¼Œæ‰€ä»¥ç”¨çº¿æ®µæ ‘åˆç†å‰ªæå°±èƒ½è¿‡ï¼Œå¤æ‚åº¦ä¸ä¼šè¯ã€‚<br>å‰ªææ–¹æ³•ï¼š</p><ul><li>åŒºé—´æœ€å¤§å€¼=1ï¼Œè¯´æ˜è¯¥æ®µåŒºé—´æ‰€æœ‰å€¼éƒ½æ˜¯1ï¼Œç›´æ¥return</li><li>åŒºé—´æœ€å¤§å€¼=æœ€å°å€¼=xï¼Œreturn</li></ul><p>åªåšç¬¬ä¸€ä¸ªå‰ªæï¼Œå¾ˆå®¹æ˜“è¢«æ‰€æœ‰æ•°ç›¸ç­‰ç„¶åæ¯æ¬¡æ“ä½œä¹Ÿç­‰äºè¯¥æ•°çš„æ•°æ®å¡æ‰ï¼ŒåŠ ä¸Šç¬¬äºŒä¸ªå‰ªæï¼Œå°±è¿‡äº†ï¼Œæ˜¯å¦æ­£ç¡®ä¸çŸ¥</p><h2 id="I"><a class="header-anchor" href="#I">Â¶</a>I</h2><p>åœ¨æ£®æ—ä¸­æ¯æ¬¡å¯ä»¥å–èµ°<strong>è‹¥å¹²</strong>ä¸ªæ ¹ï¼Œåˆå§‹æ˜¯ä¸€æ£µ1ä¸ºæ ¹çš„æ ‘ï¼Œä¸èƒ½æ“ä½œè€…è¾“<br>æ¯”èµ›çš„æ—¶å€™çœ‹é”™é¢˜äº†ï¼Œæˆ‘ä»¥ä¸ºæ¯æ¬¡åªèƒ½å–ä¸€ä¸ªæ ¹<br>é¦–å…ˆå¶å­æ˜¯å¿…èƒœæ€ï¼Œå†è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å„¿å­ï¼Œå¦‚æœéƒ½æ˜¯å¿…è´¥æ€ï¼Œé‚£ä½ å°±æ˜¯å¿…èƒœæ€ã€‚å¦‚æœå­˜åœ¨æŸä¸ªå„¿å­æ˜¯å¿…èƒœæ€ï¼Œä½ å°±æ˜¯å¿…è´¥æ€ï¼Œå› ä¸ºä½ å–èµ°è¯¥èŠ‚ç‚¹åï¼Œå¯¹æ‰‹åªè¦æŠŠæ‰€æœ‰æ˜¯å¿…èƒœæ€çš„èŠ‚ç‚¹çš„æ ¹å–èµ°ï¼Œé‚£ä½ é¢å¯¹çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯å¿…è´¥æ€çš„äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p5903 æ ‘ä¸Škçº§ç¥–å…ˆ</title>
      <link href="/2020/05/30/p5903-shu-shang-k-ji-zu-xian/"/>
      <url>/2020/05/30/p5903-shu-shang-k-ji-zu-xian/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨å€å¢æ¯æ¬¡å¯ä»¥åœ¨lognçš„æ—¶é—´å†…è§£å†³ï¼Œè€Œä½¿ç”¨é•¿é“¾å‰–åˆ†ï¼Œå¯ä»¥åœ¨O(nlogn)é¢„å¤„ç†åï¼ŒO(1)å›ç­”è¯¢é—®ï¼Œè™½ç„¶åœ¨å®è·µä¸­ç›¸å·®æ— å‡ ï¼Œä¹Ÿä¸å¤ªå¯èƒ½è¦æ±‚O(1),ä½†æ˜¯é•¿å‰–çš„è¿™ç§åšæ³•ä»¥åŠé¢„å¤„ç†çš„æ–¹æ³•è¿˜æ˜¯å¾ˆå·§å¦™çš„</p><ul><li>é¢„å¤„ç†å‡ºå€å¢æ•°ç»„ï¼Œé•¿é“¾çš„é•¿åº¦ä»¥åŠé“¾é¡¶èŠ‚ç‚¹ï¼Œå†é¢„å¤„ç†å‡ºæ¯ä¸ªæ•°å­—çš„æœ€é«˜äºŒçº§åˆ¶ä½hb[i]ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹ä¸ºé“¾é¡¶èŠ‚ç‚¹ï¼Œé¢„å¤„ç†å‡ºå…¶å‘ä¸Š(è·³fa)å’Œå‘ä¸‹(è·³son)len[u]-1ä¸ªèŠ‚ç‚¹</li><li>å¤„ç†è¯¢é—®æ—¶ï¼Œå…ˆåˆ©ç”¨å€å¢æ•°ç»„è·³åˆ°(1&lt;&lt;hb[i])çš„ç¥–å…ˆå¤„ï¼Œæ­¤æ—¶kâ€™=k-(1&lt;&lt;hb[i]) &lt; (1&lt;&lt;hb[i])</li><li>å½“å‰æ‰€åœ¨çš„é•¿é“¾çš„é•¿åº¦ä¸€å®šæ˜¯å¤§äºkâ€™çš„ï¼Œæ‰€ä»¥è€ƒè™‘è·³åˆ°é“¾é¡¶ï¼Œè€Œåæ ¹æ®å‰©ä½™çš„ké€‰æ‹©å‘ä¸Šè¿˜æ˜¯å‘ä¸‹è·³ï¼Œæ­¤æ—¶åˆ©ç”¨é¢„å¤„ç†å‡ºçš„upï¼Œdwnæ•°ç»„å³å¯å®ç°O(1)</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, hb[N], fa[N][<span class="number">22</span>], rt;</span><br><span class="line"><span class="type">int</span> len[N], dep[N], top[N], son[N];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> s;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N], up[N], dwn[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">unsigned</span> <span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  x ^= x &lt;&lt; <span class="number">13</span>;</span><br><span class="line">  x ^= x &gt;&gt; <span class="number">17</span>;</span><br><span class="line">  x ^= x &lt;&lt; <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">return</span> s = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dep[u] = dep[fa[u][<span class="number">0</span>]] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==fa[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; fa[v][i]; i++) fa[v][i+<span class="number">1</span>] = fa[fa[v][i]][i];</span><br><span class="line">    <span class="built_in">dfs1</span>(v);</span><br><span class="line">    <span class="keyword">if</span>(len[v]&gt;len[son[u]]) son[u] = v;</span><br><span class="line">  &#125;</span><br><span class="line">  len[u] = len[son[u]] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top[u] = t;</span><br><span class="line">  <span class="keyword">if</span>(u==t)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, j=u; i&lt;len[u]; i++)</span><br><span class="line">      up[u].<span class="built_in">pb</span>(j), j = fa[j][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>, j=u; i&lt;len[u]; i++)</span><br><span class="line">      dwn[u].<span class="built_in">pb</span>(j), j = son[j];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(son[u]) <span class="built_in">dfs2</span>(son[u], t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    <span class="keyword">if</span>(v!=son[u])</span><br><span class="line">      <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!k) <span class="keyword">return</span> x;</span><br><span class="line">  x = fa[x][hb[k]], k -= (<span class="number">1</span>&lt;&lt;hb[k]);</span><br><span class="line">  k -= dep[x] - dep[top[x]], x = top[x];</span><br><span class="line">  <span class="keyword">return</span> k&gt;=<span class="number">0</span> ? up[x][k] : dwn[x][-k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; q &gt;&gt; s;</span><br><span class="line">  hb[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    cin &gt;&gt; fa[i][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span>(!fa[i][<span class="number">0</span>]) rt = i;</span><br><span class="line">    <span class="keyword">else</span> G[fa[i][<span class="number">0</span>]].<span class="built_in">pb</span>(i);</span><br><span class="line">    hb[i] = hb[i&gt;&gt;<span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs1</span>(rt); <span class="built_in">dfs2</span>(rt, rt);</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  ll res = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> x = (<span class="built_in">get</span>(s)^ans)%n + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> k = (<span class="built_in">get</span>(s)^ans)%dep[x];</span><br><span class="line">    res ^= <span class="number">1ll</span>*i*(ans=<span class="built_in">ask</span>(x, k));</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; res &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°Vå’Œgcdæ ‘ å¸¦ä¿®ä¸»å¸­æ ‘+æ ‘å‰–trick</title>
      <link href="/2020/05/26/xiao-v-he-gcd-shu-dai-xiu-zhu-xi-shu-shu-pou-trick/"/>
      <url>/2020/05/26/xiao-v-he-gcd-shu-dai-xiu-zhu-xi-shu-shu-pou-trick/</url>
      
        <content type="html"><![CDATA[<h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šä¸€é¢—æ— æ ¹æ ‘ï¼Œç‚¹æœ‰ç‚¹æƒ$a_i$â€‹ï¼Œè¾¹æœ‰è¾¹æƒ$\gcd(a_i, a_j)$,è¦æ±‚æ”¯æŒä¸¤ç§æ“ä½œï¼š</p><ul><li>ä¿®æ”¹ä¸€ä¸ªç‚¹çš„ç‚¹æƒï¼Œç›¸åº”è¾¹æƒä¹Ÿä¼šæ›´æ”¹</li><li>è¯¢é—®u-&gt;vè·¯å¾„ä¸Šè¾¹æƒ&lt;=kçš„æ•°é‡</li></ul><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å› ä¸ºä¿®æ”¹æŸä¸ªç‚¹çš„ç‚¹æƒï¼ŒåŒæ—¶ä¼šä¿®æ”¹å…¶æ‰€æœ‰å‡ºè¾¹ï¼Œç›´è§‚çš„æƒ³æ³•æ˜¯è€ƒè™‘bfsæ ‘ï¼Œç„¶åè½¬åŒ–ä¸ºåŒºé—´ä¿®æ”¹ï¼Œä½†æ˜¯æ¯ä¸ªå„¿å­çš„ä¿®æ”¹æ˜¯ä¸åŒçš„ï¼ŒåŒºé—´æ¯ä¸ªæ•°å¯¹xå–gcdï¼ˆåšä¸äº†ï¼‰<br>ä¸‹é¢å°±éœ€è¦ä¸€ç§æ ‘å‰–çš„trickï¼Œæ¯æ¬¡ä¿®æ”¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªä¿®æ”¹çˆ¶äº²å’Œé‡å„¿å­çš„ä¿¡æ¯ï¼Œè€Œåœ¨è¯¢é—®çš„æ—¶å€™ï¼Œå¯¹äºä¸€æ•´æ¡é‡é“¾ï¼Œå¯ä»¥ä¿è¯ä¿¡æ¯æ˜¯æ­£ç¡®çš„ï¼Œè€Œæ¯æ¬¡è·³åˆ°é“¾é¡¶ï¼Œå†ä¿®æ”¹ä¸€ä¸‹è¯¥ç‚¹ï¼ˆè½»å„¿å­ï¼‰ä¸çˆ¶äº²çš„ä¿¡æ¯å³å¯ï¼Œè¿™æ ·å°±è½¬åŒ–ä¸ºç®€å•çš„å•ç‚¹ä¿®æ”¹äº†ã€‚<br>è€ƒè™‘æœ¬é¢˜ï¼Œå¯ä»¥å°†è¾¹æƒä¸‹æ”¾åˆ°æ·±åº¦å¤§çš„ç‚¹ä¸Šï¼Œå¥—ç”¨ä¸Šè¿°åšæ³•å³å¯ï¼Œè€ŒåŒºé—´è¯¢é—®&lt;=kçš„æ•°é‡å°±ç”¨å¸¦ä¿®ä¸»å¸­æ ‘ç»´æŠ¤ã€‚</p><h3 id="æµç¨‹"><a class="header-anchor" href="#æµç¨‹">Â¶</a>æµç¨‹</h3><p>modify:<br>upd: u-&gt;fa[u] son[u]-&gt;u<br>query<br>ask: u-&gt;top[u] upd: top[u]-&gt;fa[top[u]]<br>u = fa[top[u]]<br>ask: u-&gt;v(æ˜¯é‡é“¾)<br>æ³¨æ„æœ¬é¢˜æ˜¯æŠŠè¾¹æƒä¸‹æ”¾åˆ°äº†ç‚¹æƒï¼Œæ‰€ä»¥uè¿™ä¸ªç‚¹çš„å€¼åº”è¯¥å»æ‰ï¼Œæ‰€ä»¥è¯¢é—®çš„æ˜¯dfn[u]+1-&gt;dfn[v]</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e4</span> + <span class="number">5</span>, M = <span class="number">1e6</span> + <span class="number">5</span>, up = <span class="number">1e6</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, a[N], b[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="type">int</span> sz[N], top[N], son[N], dep[N], fa[N], dfn[N], idfn[N], tot;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dep[u] = dep[f] + <span class="number">1</span>; fa[u] = f;</span><br><span class="line">  sz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v!=f)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">      sz[u] += sz[v];</span><br><span class="line">      <span class="keyword">if</span>(sz[v]&gt;sz[son[u]]) son[u] = v;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top[u] = t;</span><br><span class="line">  dfn[u] = ++tot;</span><br><span class="line">  idfn[tot] = u;</span><br><span class="line">  <span class="keyword">if</span>(!son[u]) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs2</span>(son[u], t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    <span class="keyword">if</span>(v!=son[u]&amp;&amp;v!=fa[u]) <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> PSegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls(x) t[x].l</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs(x) t[x].r</span></span><br><span class="line">  <span class="type">int</span> rt[N], tot;</span><br><span class="line">  <span class="type">int</span> lrt[N], rrt[N], lc, rc;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, cnt;</span><br><span class="line">  &#125;t[M*<span class="number">32</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p) p = ++tot;</span><br><span class="line">    t[p].cnt += v;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">insert</span>(<span class="built_in">ls</span>(p), l, mid, x, v);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">insert</span>(<span class="built_in">rs</span>(p), mid+<span class="number">1</span>, r, x, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(l&gt;k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) cnt -= t[lrt[i]].cnt;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) cnt += t[rrt[i]].cnt;</span><br><span class="line">      <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=mid)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lrt[i] = <span class="built_in">ls</span>(lrt[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) rrt[i] = <span class="built_in">ls</span>(rrt[i]);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">ask</span>(l, mid, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> lcnt = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lcnt -= t[<span class="built_in">ls</span>(lrt[i])].cnt;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) lcnt += t[<span class="built_in">ls</span>(rrt[i])].cnt;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=lc; i++) lrt[i] = <span class="built_in">rs</span>(lrt[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=rc; i++) rrt[i] = <span class="built_in">rs</span>(rrt[i]);</span><br><span class="line">      <span class="keyword">return</span> lcnt + <span class="built_in">ask</span>(mid+<span class="number">1</span>, r, k);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> PSegTree;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> val, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=n; i+=(i&amp;-i)) <span class="built_in">insert</span>(rt[i], <span class="number">1</span>, up, val, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  lc = <span class="number">0</span>, rc = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l<span class="number">-1</span>; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) lrt[++lc] = rt[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=r; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) rrt[++rc] = rt[i];</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">ask</span>(<span class="number">1</span>, up, k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">queryt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    <span class="type">int</span> tmp = top[x];</span><br><span class="line">    <span class="keyword">if</span>(fa[tmp]&amp;&amp;b[tmp]!=__gcd(a[tmp], a[fa[tmp]]))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">upd</span>(dfn[tmp], b[tmp], <span class="number">-1</span>);</span><br><span class="line">      <span class="built_in">upd</span>(dfn[tmp], b[tmp]=__gcd(a[tmp], a[fa[tmp]]), <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ans += <span class="built_in">query</span>(dfn[top[x]], dfn[x], k);</span><br><span class="line">    x = fa[top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="keyword">if</span>(x!=y) ans += <span class="built_in">query</span>(dfn[x]+<span class="number">1</span>, dfn[y], k);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(v); G[v].<span class="built_in">pb</span>(u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>); <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> u=<span class="number">2</span>; u&lt;=n; u++)</span><br><span class="line">    <span class="built_in">upd</span>(dfn[u], b[u]=__gcd(a[u], a[fa[u]]), <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u, x;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;x);</span><br><span class="line">      <span class="keyword">if</span>(fa[u])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">upd</span>(dfn[u], b[u], <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">upd</span>(dfn[u], b[u]=__gcd(x, a[fa[u]]), <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(son[u])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">upd</span>(dfn[son[u]], b[son[u]], <span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">upd</span>(dfn[son[u]], b[son[u]]=__gcd(x, a[son[u]]), <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      a[u] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u, v, k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;k);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">queryt</span>(u, v, k));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°çƒä¸ç›’å­</title>
      <link href="/2020/05/25/xiao-qiu-yu-he-zi/"/>
      <url>/2020/05/25/xiao-qiu-yu-he-zi/</url>
      
        <content type="html"><![CDATA[<p>nä¸ªçƒæ”¾è¿›kä¸ªç›’å­ï¼Œæ ¹æ®çƒæ˜¯å¦ç›¸åŒã€ç›’å­æ˜¯å¦ç›¸åŒã€ç›’å­æ˜¯å¦å¯ä»¥ä¸ºç©ºï¼Œå¯ä»¥æ€»ç»“å‡º8ä¸ªæ¨¡å‹ã€‚<br>å‰ç½®èŠå£«ï¼šç»„åˆæ•°ã€æ–¯ç‰¹æ—æ•°ã€å¿«é€Ÿå¹‚ã€è´å°”æ•°ã€æ•´æ•°æ‹†åˆ†ç­‰</p><h2 id="çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼ˆä¸åŒï¼‰ï¼Œä¸èƒ½ç©ºç›’"><a class="header-anchor" href="#çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼ˆä¸åŒï¼‰ï¼Œä¸èƒ½ç©ºç›’">Â¶</a>çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼ˆä¸åŒï¼‰ï¼Œä¸èƒ½ç©ºç›’</h2><p>ç›’å­ç›¸åŒæ—¶ä¸ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ï¼Œä¸åŒæ—¶å†ä¹˜ä»¥$k!$å³å¯<br>å¯ä»¥nké€’æ¨ï¼Œå¯ä»¥å®¹æ–¥</p><h2 id="çƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’"><a class="header-anchor" href="#çƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’">Â¶</a>çƒä¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’</h2><p>æ¯ä¸ªçƒæœ‰kç§æ–¹æ³• $k^n$</p><h2 id="çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’"><a class="header-anchor" href="#çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’">Â¶</a>çƒä¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’</h2><p>æšä¸¾ç©ºç›’çš„æ•°é‡ï¼Œç­”æ¡ˆä¸ºç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ä¸€è¡Œæ±‚å’Œ<br>ä¹Ÿç›¸å½“ä¸æ˜¯è´å°”æ•°</p><h2 id="çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œä¸èƒ½ç©ºç›’"><a class="header-anchor" href="#çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œä¸èƒ½ç©ºç›’">Â¶</a>çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œä¸èƒ½ç©ºç›’</h2><p>$x_1+x_2+\dots+x_n = k$çš„æ­£æ•´æ•°è§£ä¸ªæ•°<br>C(n-1, k-1)</p><h2 id="çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’"><a class="header-anchor" href="#çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’">Â¶</a>çƒç›¸åŒï¼Œç›’å­ä¸åŒï¼Œå¯ä»¥ç©ºç›’</h2><p>$x_1+x_2+\dots+x_n = k$çš„éè´Ÿæ•´æ•°è§£ä¸ªæ•°<br>C(n+k-1, k-1)</p><h2 id="çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œä¸èƒ½ç©ºç›’"><a class="header-anchor" href="#çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œä¸èƒ½ç©ºç›’">Â¶</a>çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œä¸èƒ½ç©ºç›’</h2><p>æ•´æ•°næ‹†åˆ†æˆkä»½=ç”¨æœ€å¤§æ•°ä¸ºkæ‹†åˆ†n<br>D(n-k, k) å°†n-kç”¨$\le k$çš„æ•°æ‹†åˆ†</p><h2 id="çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’"><a class="header-anchor" href="#çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’">Â¶</a>çƒç›¸åŒï¼Œç›’å­ç›¸åŒï¼Œå¯ä»¥ç©ºç›’</h2><p>D(n, k) = D(n, k-1) + D(n-k, k)</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘ç»´æŠ¤å‰ç¼€æœ€å€¼é—®é¢˜</title>
      <link href="/2020/05/23/xian-duan-shu-wei-hu-qian-zhui-zui-zhi-wen-ti/"/>
      <url>/2020/05/23/xian-duan-shu-wei-hu-qian-zhui-zui-zhi-wen-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¥¼æˆ¿é‡å»º"><a class="header-anchor" href="#æ¥¼æˆ¿é‡å»º">Â¶</a>æ¥¼æˆ¿é‡å»º</h2><p>æœ‰næ ‹æˆ¿å±‹,é—®ä»1å·æ¥¼å¾€åçœ‹,æœ€å¤šèƒ½çœ‹åˆ°å‡ æ ‹æ¥¼,è¦æ±‚æ”¯æŒå•ç‚¹ä¿®æ”¹<br>ä¾‹:(1, 3, 2, 5, 4) ç­”æ¡ˆä¸º3:(1, 3, 5)<br>ç­”æ¡ˆå°±æ˜¯ä»1å¼€å§‹çš„ä¸¥æ ¼å‰ç¼€æœ€å¤§å€¼çš„é•¿åº¦,è€ƒè™‘çº¿æ®µæ ‘ç»´æŠ¤,ä½†æ˜¯åœ¨pushupçš„æ—¶å€™,å¦‚æœç®€å•çš„å°†å·¦å³å­æ ‘çš„ç­”æ¡ˆç›¸åŠ ,æ˜¯ä¸å¯¹çš„,å› ä¸ºå·¦è¾¹çš„æ¥¼æˆ¿é«˜åº¦ä¼šå½±å“åˆ°å³è¾¹.<br>ä¸å¦¨è€ƒè™‘é€’å½’çš„è¿›è¡Œpushup(ä¹Ÿæ˜¯æŸç§å¯å‘,å› ä¸ºpushupä¸€èˆ¬éƒ½æ˜¯O(1)åˆå¹¶çš„,ä½†$O(\log n)$åˆå¹¶æœªå°ä¸å¯?)<br>çº¿æ®µæ ‘æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤mx,lenåˆ†åˆ«è¡¨ç¤ºåŒºé—´æœ€å¤§å€¼(ç”¨äºå‰ªæ),<strong>åªè€ƒè™‘</strong>è¯¥åŒºé—´æ—¶çš„ç­”æ¡ˆ<br>æ·»åŠ å‡½æ•°merge(v, p) è¡¨ç¤ºçº¿æ®µæ ‘ä¸Šç¼–å·pèŠ‚ç‚¹ç®¡è¾–çš„åŒºé—´åœ¨å·¦è¾¹æœ€å¤§å€¼ä¸ºvçš„å½±å“ä¸‹äº§ç”Ÿçš„ç­”æ¡ˆ<br>ä»¥ä¸‹è€ƒè™‘å‡ ç§æƒ…å†µ:</p><ul><li>t[p]çš„æœ€å¤§å€¼æ˜¯å°äºv æ­¤æ—¶æ²¡æœ‰è´¡çŒ®, <code>return 0</code>å³å¯</li><li>pæ˜¯å¶å­èŠ‚ç‚¹<code>return t[p].mx&gt;v</code>è¿”å›è¯¥èŠ‚ç‚¹ä»£è¡¨çš„å€¼ä¸vçš„å¤§å°å…³ç³»å³å¯</li><li>è€ƒè™‘å·¦å³å„¿å­ä¸ºls, rs è‹¥<code>t[ls].mx&lt;=v</code>æ­¤æ—¶å·¦åŒºé—´æ— è´¡çŒ®,é€’å½’å³åŒºé—´å³å¯,<code>return merge(v,rs)</code>.å¦åˆ™é€’å½’å·¦åŒºé—´,é‚£ä¹ˆå³åŒºé—´çš„è´¡çŒ®æ˜¯<code>t[p].lenâˆ’t[ls].len</code>(æ³¨æ„ä¸æ˜¯t[rs].len)<br>åœ¨pushupçš„æ—¶å€™,ç»´æŠ¤å¥½mx,å¹¶è®©<code>t[p].len = t[ls].len + merge(t[ls].mx, rs)</code>å³å¯</li></ul><h2 id="æœ€ç®€å•çš„ä¸€é“é¢˜"><a class="header-anchor" href="#æœ€ç®€å•çš„ä¸€é“é¢˜">Â¶</a>æœ€ç®€å•çš„ä¸€é“é¢˜</h2><p>è¥¿é‚®æ–°ç”Ÿèµ›çš„ä¸€é¢˜,æ²¡äººè¿‡<br>æˆ‘çœ‹åˆ°çš„æ—¶å€™å°±å‘ç°æ˜¯è·Ÿæ¥¼æˆ¿é‡å»ºä¸€æ ·çš„trick,ç„¶è€Œ<s>è°ƒbugè°ƒäº†åŠå¤©,waäº†æ— æ•°å‘</s><br>ç»™å®šnä¸ªæ•°,è¯¢é—®ä»ç¬¬xä¸ªæ•°å¾€åçš„éä¸¥æ ¼å‰ç¼€æœ€å°å€¼çš„é•¿åº¦,è¦æ±‚æ”¯æŒåŒºé—´åŠ <br>åšæ³•è·Ÿä¸Šé¢˜ç±»ä¼¼,æ³¨æ„åœ¨mergeé‡Œé¢ä¹Ÿè¦åŠ ä¸Špushdown,åœ¨æ¯æ¬¡è¦è®¿é—®ä¸€ä¸ªç‚¹çš„å·¦å³å„¿å­çš„æ—¶å€™,å°±åº”è¯¥ä¸‹æ”¾è¯¥ç‚¹çš„lazytag<br>ä¸Šä¸€é¢˜çš„è¯¢é—®éƒ½æ˜¯ä»1å¼€å§‹çš„,æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯t[1].len,ä½†æœ¬é¢˜æ˜¯ä»xå¼€å§‹çš„,æˆ‘çš„åšæ³•æ˜¯æŠŠ[x,n]åœ¨çº¿æ®µæ ‘ä¸Šçš„åŒºé—´æå–å‡ºæ¥,ç„¶åä»å·¦å¾€å³åˆå¹¶,åŒºé—´æ•°æ˜¯logæ®µ,åˆå¹¶ä¹Ÿæ˜¯logçš„,å¤æ‚åº¦æ˜¯$n(\log^2 n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> n, m, pos[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line"><span class="keyword">namespace</span> SegTree</span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls (p&lt;&lt;1)</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs (p&lt;&lt;1|1)</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, len;</span><br><span class="line">    ll mn, tag;</span><br><span class="line">  &#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setval</span><span class="params">(<span class="type">int</span> p, ll v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].mn += v;</span><br><span class="line">    t[p].tag += v;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">setval</span>(ls, t[p].tag); <span class="built_in">setval</span>(rs, t[p].tag);</span><br><span class="line">    t[p].tag = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> p)</span> <span class="comment">//é‡ç‚¹</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(t[p].mn&gt;v) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[p].mn&lt;=v;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="keyword">if</span>(t[ls].mn&gt;v) <span class="keyword">return</span> <span class="built_in">merge</span>(v, rs);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">merge</span>(v, ls) + t[p].len - t[ls].len;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].mn = <span class="built_in">min</span>(t[ls].mn, t[rs].mn);</span><br><span class="line">    t[p].len = t[ls].len + <span class="built_in">merge</span>(t[ls].mn, rs);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].l = l, t[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">      t[p].mn = a[l];</span><br><span class="line">      t[p].len = <span class="number">1</span>;</span><br><span class="line">      pos[l] = p;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(ls, l, mid); <span class="built_in">build</span>(rs, mid+<span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">setval</span>(p, v);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(ls, x, y, v);</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(rs, x, y, v);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">    &#123;</span><br><span class="line">      vec.<span class="built_in">pb</span>(p);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">ask</span>(ls, x, y);</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) <span class="built_in">ask</span>(rs, x, y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> SegTree;</span><br><span class="line"><span class="type">char</span> op[<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, op);</span><br><span class="line">    <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> l, r, k;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;k);</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>, l, r, k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">      vec.<span class="built_in">clear</span>();</span><br><span class="line">      <span class="built_in">ask</span>(<span class="number">1</span>, x, n);</span><br><span class="line">      <span class="type">int</span> ans = t[vec[<span class="number">0</span>]].len;</span><br><span class="line">      ll mn = t[vec[<span class="number">0</span>]].mn;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;<span class="built_in">sz</span>(vec); i++)</span><br><span class="line">      &#123;</span><br><span class="line">        ans += <span class="built_in">merge</span>(mn, vec[i]);</span><br><span class="line">        mn = <span class="built_in">min</span>(mn, t[vec[i]].mn);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>copyè‡ªå°ç²‰å…”:</p><blockquote><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªå¾ˆå…³é”®çš„æ€§è´¨ï¼š<br>å½“vå°äºå·¦å­æ ‘çš„æœ€å¤§å€¼æ—¶ï¼Œå³å­æ ‘å¯¹å½“å‰èŠ‚ç‚¹çš„è´¡çŒ®ï¼Œæ˜¯é€šè¿‡å‡æ³•è®¡ç®—çš„<br>ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªä¿¡æ¯è¦æ»¡è¶³ä¸€å®šç¨‹åº¦ä¸Šçš„å¯å‡æ€§<br>ä½†æ˜¯æœ‰å¾ˆå¤šä¿¡æ¯æ˜¯ä¸æ»¡è¶³å¯å‡æ€§çš„ï¼Œæ¯”å¦‚max,minã€æŒ‰ä½ä¸ã€æŒ‰ä½æˆ–ç­‰<br>ä¸ºäº†èƒ½è®©è¿™ç§çº¿æ®µæ ‘é€‚åº”æ›´ä¸€èˆ¬çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¿®æ”¹ç»´æŠ¤çš„ä¿¡æ¯çš„æ„ä¹‰ï¼š<br>ä»ç„¶ç»´æŠ¤è¿™ä¸ªåŒºé—´ä¸­çš„æœ€å¤§å€¼ã€‚</p><p>æ­¤æ—¶å¹¶ä¸æ˜¯ç»´æŠ¤åŒºé—´çš„ç­”æ¡ˆï¼Œè€Œæ˜¯ä»…è€ƒè™‘è¯¥åŒºé—´çš„å½±å“åï¼Œå´åˆåªç»Ÿè®¡å³å­æ ‘çš„ç­”æ¡ˆä»…è€ƒè™‘è¯¥åŒºé—´çš„å½±å“åï¼Œå´åˆåªç»Ÿè®¡å³å­æ ‘çš„ç­”æ¡ˆä»…è€ƒè™‘è¯¥åŒºé—´çš„å½±å“åï¼Œå´åˆåªç»Ÿè®¡å³å­æ ‘çš„ç­”æ¡ˆã€‚<br>ä¹Ÿå°±æ˜¯è¯´ä»¤å½“å‰èŠ‚ç‚¹å¯¹åº”çš„åŒºé—´ä¸º[l,r]ï¼ŒåŒºé—´ä¸­ç‚¹ä¸º midï¼Œåˆ™ï¼š<br>ç»´æŠ¤çš„ç­”æ¡ˆæ˜¯ï¼Œåªè€ƒè™‘[l,r]æ—¶ï¼Œåœ¨åŒºé—´[mid+1,r]ä¸­çš„ç­”æ¡ˆã€‚</p></blockquote><p>çº¿æ®µæ ‘æ¯ä¸ªèŠ‚ç‚¹ä»ç„¶ç»´æŠ¤mx[i], len[i],ä½†å¯¹äºå¶èŠ‚ç‚¹len[i]æ— æ„ä¹‰,å†è€ƒè™‘merge(v, p)å‡½æ•°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].mx = <span class="built_in">max</span>(t[ls].mx, t[rs].mx);</span><br><span class="line">  t[p].len = <span class="built_in">merge</span>(t[ls].mx, rs);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> v, <span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mx&lt;=v) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[p].mn&gt;v;</span><br><span class="line">  <span class="keyword">if</span>(t[ls].mx&lt;=v) <span class="keyword">return</span> <span class="built_in">merge</span>(v, rs);</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">merge</span>(v, ls) + t[p].len; <span class="comment">//é¿å…äº†åŒºé—´ç»´æŠ¤ä¿¡æ¯ä¸å¯å‡çš„é—®é¢˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Boruvkaç”Ÿæˆæ ‘ç®—æ³•</title>
      <link href="/2020/05/22/boruvka-sheng-cheng-shu-suan-fa/"/>
      <url>/2020/05/22/boruvka-sheng-cheng-shu-suan-fa/</url>
      
        <content type="html"><![CDATA[<p>æ ¸å¿ƒ:æ¯æ¬¡ä»æ‰€æœ‰å½“å‰çš„è¿é€šå—å‘å…¶ä»–è¿é€šå—æ‰©å±•å‡ºæœ€å°è¾¹,ç›´è‡³å‰©ä¸‹ä¸€ä¸ªè¿é€šå—<br>æ¯è¿›è¡Œä¸€æ¬¡æ“ä½œ,è¿é€šå—æ•°é‡å‡åŠ $O(m\log n)$ å–å†³äºè®¡ç®—æœ€å°è¾¹çš„ä»£ä»·</p><h1>codechef spanning tree</h1><p>äº¤äº’é¢˜,æ¯æ¬¡å¯ä»¥ç»™å‡ºä¸¤ä¸ªç‚¹é›†A,Bè¿›è¡Œè¯¢é—®,ä¼šè¿”å›ä¸¤ä¸ªé›†åˆé—´çš„æœ€å°è¾¹,è¦æ±‚è¯¢é—®çš„$\sum |A|&lt;=1e4, \sum |A|+|B|&lt;=2e6,n&lt;=1e3$,æœ€åè¾“å‡ºè¯¥å›¾çš„æœ€å°ç”Ÿæˆæ ‘çš„æƒå€¼å’Œ<br>æŒ‰ç…§ä¸Šè¿°ç®—æ³•è¯¢é—®å³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, fa[N], idx[N], mncost;</span><br><span class="line">pii mn[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; scc[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==fa[x]) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">return</span> fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  u = <span class="built_in">find</span>(u), v = <span class="built_in">find</span>(v);</span><br><span class="line">  <span class="keyword">if</span>(u!=v)</span><br><span class="line">  &#123;</span><br><span class="line">    fa[u] = v;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pii <span class="title">ask</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) vis[i] = <span class="number">0</span>;</span><br><span class="line">  cout &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="built_in">sz</span>(a) &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; n-<span class="built_in">sz</span>(a) &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> x : a)</span><br><span class="line">  &#123;</span><br><span class="line">    cout &lt;&lt; x &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    vis[x] = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span>(!vis[i]) cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">  cout &lt;&lt; endl;</span><br><span class="line">  <span class="type">int</span> u, v, w; cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">mp</span>(v, w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cin &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) fa[i] = i;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(fa[i]==i) idx[i] = ++cnt;</span><br><span class="line">    <span class="keyword">if</span>(cnt==<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      scc[idx[<span class="built_in">find</span>(i)]].<span class="built_in">pb</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=cnt; i++) mn[i] = &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">auto</span> cur = <span class="built_in">ask</span>(scc[i]);</span><br><span class="line">      <span class="keyword">if</span>(mn[i].fi==<span class="number">-1</span>) mn[i] = &#123;cur.se, cur.fi&#125;;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(cur.se&lt;mn[i].fi) mn[i] = &#123;cur.se, cur.fi&#125;;</span><br><span class="line">      scc[i].<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(fa[i]==i &amp;&amp; <span class="built_in">merge</span>(i, mn[idx[i]].se))</span><br><span class="line">        mncost += mn[idx[i]].fi;</span><br><span class="line">  &#125;</span><br><span class="line">  cout &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; mncost &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>cf888G xormst</h1><p>ä¸€å¼ å®Œå…¨å›¾,ç‚¹æ•°2e5,æ¯ä¸ªç‚¹æœ‰ç‚¹æƒ$a_i$â€‹,è¾¹$(i,j)$çš„æƒå€¼ä¸º$a_i xor a_j$â€‹,æ±‚è¯¥å›¾çš„mst<br>æ€è€ƒå¦‚ä½•æ±‚å‡ºå½“å‰é›†åˆä¸å…¶ä»–é›†åˆçš„æœ€å°è¾¹æƒ:<br>å»ºå‡º01trie,æ¯æ¬¡æŠŠè¯¥é›†åˆçš„ç‚¹æƒåˆ é™¤,ç„¶åé€ä¸ªè¯¢é—®ä¸è¯¥ç‚¹æƒxoråçš„æœ€å°å€¼å–å°,æœ€åå†æ’å…¥è¿˜åŸå³å¯</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;Ofast&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize (<span class="string">&quot;unroll-loops&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC target(<span class="string">&quot;sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,tune=native&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, a[N];</span><br><span class="line"><span class="type">int</span> fa[N], idx[N], cnt, mnto[N], mnval[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; scc[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==fa[x]) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">return</span> fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  u = <span class="built_in">find</span>(u), v = <span class="built_in">find</span>(v);</span><br><span class="line">  <span class="keyword">if</span>(u!=v)</span><br><span class="line">  &#123;</span><br><span class="line">    fa[u] = v;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> tot, nxt[N*<span class="number">29</span>][<span class="number">2</span>], sz[N*<span class="number">29</span>][<span class="number">2</span>], id[N*<span class="number">29</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v, <span class="type">int</span> idx)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> now = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">29</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> k = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!nxt[now][k]) nxt[now][k] = ++tot;</span><br><span class="line">    sz[now][k] += v;</span><br><span class="line">    now = nxt[now][k];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(v==<span class="number">1</span>) id[now] = idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pii <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>, now = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">29</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> k = (x&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(sz[now][k]) now = nxt[now][k];</span><br><span class="line">    <span class="keyword">else</span> now = nxt[now][k^<span class="number">1</span>], ans |= (<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;ans, id[now]&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">double</span> startTime = (<span class="type">double</span>)<span class="built_in">clock</span>();</span><br><span class="line">  <span class="comment">//mt19937 rnd(chrono::high_resolution_clock::now().time_since_epoch().count());</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="comment">//n = 2e5;</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    fa[i] = i;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    <span class="comment">//a[i] = abs(rnd()%(1&lt;&lt;30));</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>);</span><br><span class="line">  n = <span class="built_in">unique</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>) - a - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">upd</span>(a[i], <span class="number">1</span>, i);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(fa[i]==i)</span><br><span class="line">      &#123;</span><br><span class="line">        idx[i] = ++cnt;</span><br><span class="line">        mnto[cnt] = mnval[cnt] = <span class="number">-1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">//debug(cnt);</span></span><br><span class="line">    <span class="keyword">if</span>(cnt==<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      scc[idx[<span class="built_in">find</span>(i)]].<span class="built_in">pb</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> x : scc[i]) <span class="built_in">upd</span>(a[x], <span class="number">-1</span>, x);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> x : scc[i])</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">auto</span> cur = <span class="built_in">ask</span>(a[x]);</span><br><span class="line">        <span class="keyword">if</span>(mnto[i]==<span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          mnval[i] = cur.fi;</span><br><span class="line">          mnto[i] = cur.se;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cur.fi&lt;mnval[i])</span><br><span class="line">        &#123;</span><br><span class="line">          mnval[i] = cur.fi;</span><br><span class="line">          mnto[i] = cur.se;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> x : scc[i]) <span class="built_in">upd</span>(a[x], <span class="number">1</span>, x);</span><br><span class="line">      scc[i].<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">if</span>(fa[i]==i &amp;&amp; <span class="built_in">merge</span>(i, mnto[idx[i]]))</span><br><span class="line">        ans += mnval[idx[i]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  cerr &lt;&lt; ((<span class="type">double</span>)<span class="built_in">clock</span>() - startTime) / CLOCKS_PER_SEC &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¯é¸½çš„æ•°åˆ—</title>
      <link href="/2020/05/19/huan-ge-de-shu-lie/"/>
      <url>/2020/05/19/huan-ge-de-shu-lie/</url>
      
        <content type="html"><![CDATA[<p>åŒºé—´åŠ å¹¿ä¹‰æ–æ³¢é‚£å¥‘æ•°åˆ—<br>å¤§æ¦‚æœ‰ä¸‰ç§åšæ³•<br>1.ç”¨ç‰¹å¾æ–¹ç¨‹æ±‚å‡ºé€šé¡¹,è·‘å‡ºæ ¹å·çš„äºŒæ¬¡å‰©ä½™åä»£å…¥,å˜æˆåŒºé—´åŠ ç­‰æ¯”æ•°åˆ—,çº¿æ®µæ ‘ç»´æŠ¤å³å¯<br>2.çŸ©é˜µ<br>3.åˆ©ç”¨æ€§è´¨</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">9</span>, a = <span class="number">276601605</span>, b = <span class="number">691504013</span>, c = <span class="number">308495997</span>;</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">int</span> n, m, x[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a = <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; <span class="keyword">return</span> <span class="number">1ll</span>*a*b%mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) a-=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a+=b; <span class="keyword">if</span>(a&gt;=mod) <span class="keyword">return</span> a-mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">sub</span><span class="params">(<span class="type">int</span> &amp;a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) a+=mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123; a-=b; <span class="keyword">if</span>(a&lt;<span class="number">0</span>) <span class="keyword">return</span> a+mod; <span class="keyword">return</span> a; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="built_in">Mul</span>(ans, a);</span><br><span class="line">    a = <span class="built_in">Mul</span>(a, a);</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SegTree</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> ls (p&lt;&lt;1)</span></span><br><span class="line">  <span class="meta">#<span class="keyword">define</span> rs (p&lt;&lt;1|1)</span></span><br><span class="line">  <span class="type">int</span> inv, pw[N];</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, sum, tag;</span><br><span class="line">  &#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> q)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) pw[i] = <span class="built_in">Mul</span>(pw[i<span class="number">-1</span>], q)%mod;</span><br><span class="line">    inv = <span class="built_in">powmod</span>(q<span class="number">-1</span>, mod<span class="number">-2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setval</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(t[p].sum, <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(v, <span class="built_in">Sub</span>(pw[t[p].r-t[p].l+<span class="number">1</span>], <span class="number">1</span>)), inv));</span><br><span class="line">    <span class="built_in">add</span>(t[p].tag, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].sum = <span class="built_in">Add</span>(t[ls].sum, t[rs].sum);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">setval</span>(ls, t[p].tag); <span class="built_in">setval</span>(rs, <span class="built_in">Mul</span>(t[p].tag, pw[t[rs].l-t[ls].l]));</span><br><span class="line">    t[p].tag = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    t[p].l = l, t[p].r = r;</span><br><span class="line">    <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(ls, l, mid); <span class="built_in">build</span>(rs, mid+<span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">setval</span>(p, pw[l-x+<span class="number">1</span>]);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(ls, x, y);</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(rs, x, y);</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> t[p].sum;</span><br><span class="line">    <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">    <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(ls, x, y));</span><br><span class="line">    <span class="keyword">if</span>(y&gt;mid) <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(rs, x, y));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> ls</span></span><br><span class="line">  <span class="meta">#<span class="keyword">undef</span> rs</span></span><br><span class="line">&#125;T1, T2;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, x+i);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) sum[i] = <span class="built_in">Add</span>(sum[i<span class="number">-1</span>], x[i]);</span><br><span class="line">  T1.<span class="built_in">init</span>(b); T2.<span class="built_in">init</span>(c);</span><br><span class="line">  T1.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n); T2.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;op, &amp;l, &amp;r);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      T1.<span class="built_in">upd</span>(<span class="number">1</span>, l, r);</span><br><span class="line">      T2.<span class="built_in">upd</span>(<span class="number">1</span>, l, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> ans = <span class="built_in">Mul</span>(<span class="built_in">Sub</span>(T1.<span class="built_in">ask</span>(<span class="number">1</span>, l, r), T2.<span class="built_in">ask</span>(<span class="number">1</span>, l, r)), a);</span><br><span class="line">      <span class="built_in">add</span>(ans, <span class="built_in">Sub</span>(sum[r], sum[l<span class="number">-1</span>]));</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>525 ç¾å›¢æ¯2020 å¹³è¡Œå››è¾¹å½¢</title>
      <link href="/2020/05/18/525-mei-tuan-bei-2020-ping-xing-si-bian-xing/"/>
      <url>/2020/05/18/525-mei-tuan-bei-2020-ping-xing-si-bian-xing/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šn*nçš„æ£‹ç›˜,è¦æ±‚æ”¾ç½®nä¸ªæ£‹å­,æ»¡è¶³:</p><ul><li>xå’Œyéƒ½æ˜¯ä¸€ä¸ª1-nçš„æ’åˆ—</li><li>ä»»æ„å››ä¸ªæ£‹å­ä¸æ„æˆå¹³è¡Œå››è¾¹å½¢<br>å…¶ä¸­n+1æ˜¯ä¸€ä¸ªè´¨æ•°</li></ul><p>è€ƒè™‘n+1çš„åŸæ ¹g,åˆ™$g,g^2,g^3â€¦g^n%(n+1)$å„ä¸ç›¸åŒ<br>$(1,g)â€¦(n,g^n$%$(n+1))$å³ä¸ºç­”æ¡ˆ<br>æ— è¯æ˜o.O</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">powmod</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(b)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = <span class="number">1ll</span>*ans*a%m;</span><br><span class="line">    a = <span class="number">1ll</span>*a*a%m;</span><br><span class="line">    b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">phi</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = x;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i*i&lt;=x; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x%i==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      ans -= ans / i;</span><br><span class="line">      <span class="keyword">while</span>(x%i==<span class="number">0</span>) x /= i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(x&gt;<span class="number">1</span>) ans -= ans / x;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="type">int</span> c = <span class="built_in">phi</span>(n+<span class="number">1</span>), g = <span class="number">0</span>;</span><br><span class="line">  <span class="type">bool</span> ok = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(++g)</span><br><span class="line">  &#123;</span><br><span class="line">    ok = (<span class="built_in">powmod</span>(g, c, n+<span class="number">1</span>)==<span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> tmpc = c;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i*i&lt;=tmpc&amp;&amp;ok; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(tmpc%i==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span>(tmpc%i==<span class="number">0</span>) tmpc /= i;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">powmod</span>(g, c/i, n+<span class="number">1</span>)==<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tmpc&gt;<span class="number">1</span>&amp;&amp;<span class="built_in">powmod</span>(g, c/tmpc, n+<span class="number">1</span>)==<span class="number">1</span>) ok = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(ok) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> ans = g;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, i, ans);</span><br><span class="line">    ans = ans*g%(n+<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> t;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">  <span class="keyword">while</span>(t--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢æŒ‘æˆ˜èµ›40</title>
      <link href="/2020/05/16/niu-ke-tiao-zhan-sai-40/"/>
      <url>/2020/05/16/niu-ke-tiao-zhan-sai-40/</url>
      
        <content type="html"><![CDATA[<h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><p>ç»™å®š1e6ä¸ªéšæœºç”Ÿæˆçš„æ•°,å¤šæ¬¡è¯¢é—®,ç»™å®šy,é—®æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ•°xæ»¡è¶³x^yåœ¨äºŒè¿›åˆ¶ä¸‹1çš„ä¸ªæ•°&lt;=3</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å› ä¸ºæœ€å¤šåªæœ‰3ä¸ªäºŒè¿›åˆ¶ä½ä¸åŒ,è€ƒè™‘å°†äºŒè¿›åˆ¶æ¯16ä½åˆ†æˆ4ç»„,æ»¡è¶³æ¡ä»¶çš„xä¸yä¸€å®šåœ¨æŸä¸€ç»„ä¸­çš„16ä½å®Œå…¨ç›¸åŒ,æ‰€ä»¥æŸ¥æ‰¾è¯¥ç»„ä¸­çš„æ•°,åˆç”±äºæ•°å­—éšæœº,æ¯æ¬¡æŸ¥æ‰¾çš„æ¬¡æ•°æœŸæœ›ä¸º$4*(2^{20} / 2^{16})$</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P5236 ã€æ¨¡æ¿ã€‘é™æ€ä»™äººæŒ</title>
      <link href="/2020/05/15/p5236-mo-ban-jing-tai-xian-ren-zhang/"/>
      <url>/2020/05/15/p5236-mo-ban-jing-tai-xian-ren-zhang/</url>
      
        <content type="html"><![CDATA[<p>æ¯æ¡è¾¹æœ€å¤šåœ¨ä¸€ä¸ªç®€å•ç¯ä¸Šçš„å›¾<br>æ¯ä¸ªç¯éƒ½æ˜¯ä¸€ä¸ªç‚¹åŒ(æ–¹ç‚¹),å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”¨åœ†æ–¹æ ‘æ¥ç»´æŠ¤</p><p>æ±‚ä»™äººæŒå›¾ä¸Šä¸¤ç‚¹é—´çš„æœ€çŸ­è·¯<br>æ³¨æ„ä»™äººæŒä¸Šçš„åœ†æ–¹æ ‘çš„å»ºæ³•:<br>æ¯ä¸ªç®€å•ç¯æ–°å»ºä¸€ä¸ªæ–¹ç‚¹,ç¯ä¸Šæ¯ä¸ªç‚¹ä¸æ–¹ç‚¹è¿è¾¹,æƒå€¼ä¸ºåˆ°èµ·ç‚¹çš„æœ€çŸ­è·ç¦»,å¦‚æœuæ˜¯å‰²ç‚¹,å‘vè¿è¾¹æƒå€¼ä¸ºåŸå›¾çš„è¾¹æƒ(ä¸¤ä¸ªåœ†ç‚¹è¿è¾¹)</p><h1>åšæ³•</h1><p>å…ˆå»ºå‡ºåœ†æ–¹æ ‘<br>è€ƒè™‘uå’Œvåœ¨æ ‘ä¸Šçš„LCA:</p><ul><li>pä¸ºåœ†ç‚¹,åˆ™ç­”æ¡ˆå°±æ˜¯æ ‘ä¸Šä¸¤ç‚¹çš„è·ç¦»</li><li>pä¸ºæ–¹ç‚¹,æ‰¾å‡ºpçš„ä¸¤ä¸ªå„¿å­a(uçš„ç¥–å…ˆ),b(vçš„ç¥–å…ˆ),aå’Œbå¤„åœ¨ä¸€ä¸ªç¯ä¸Š,ç­”æ¡ˆæ˜¯dis(a,b)+dis(a,u)+dis(b,v),æ³¨æ„dis(a,b)è¦å–min</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> dfn[N], low[N], clk, cnt, s[N], sum[N];</span><br><span class="line">vector&lt;pii&gt; G[N], T[N];</span><br><span class="line"><span class="type">int</span> n, m, q;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> LOG = <span class="number">16</span>;</span><br><span class="line"><span class="type">int</span> fa[N][<span class="number">20</span>], dep[N], dis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=LOG; i++)</span><br><span class="line">    fa[u][i] = fa[fa[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : T[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(v==fa[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    dis[v] = dis[u] + w;</span><br><span class="line">    dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">    fa[v][<span class="number">0</span>] = u;</span><br><span class="line">    <span class="built_in">dfs</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LCA</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(dep[fa[y][i]]&gt;=dep[x]) y = fa[y][i];</span><br><span class="line">  <span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(fa[x][i]!=fa[y][i]) x = fa[x][i], y = fa[y][i];</span><br><span class="line">  <span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">findcir</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ++cnt;</span><br><span class="line">  <span class="type">int</span> x = v, pre = w, pw = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(x!=fa[u][<span class="number">0</span>])</span><br><span class="line">  &#123;</span><br><span class="line">    sum[x] = pre;</span><br><span class="line">    pre += s[x];</span><br><span class="line">    x = fa[x][<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  sum[cnt] = sum[u];</span><br><span class="line">  sum[u] = <span class="number">0</span>;</span><br><span class="line">  x = v;</span><br><span class="line">  <span class="keyword">while</span>(x!=fa[u][<span class="number">0</span>])</span><br><span class="line">  &#123;</span><br><span class="line">    pw = <span class="built_in">min</span>(sum[x], sum[cnt]-sum[x]);</span><br><span class="line">    T[cnt].<span class="built_in">pb</span>(&#123;x, pw&#125;);</span><br><span class="line">    T[x].<span class="built_in">pb</span>(&#123;cnt, pw&#125;);</span><br><span class="line">    x = fa[x][<span class="number">0</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dfn[u] = low[u] = ++clk;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(v==f) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">    &#123;</span><br><span class="line">      fa[v][<span class="number">0</span>] = u;</span><br><span class="line">      s[v] = w;</span><br><span class="line">      <span class="built_in">tarjan</span>(v, u);</span><br><span class="line">      low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">    <span class="keyword">if</span>(low[v]&gt;dfn[u])</span><br><span class="line">    &#123;</span><br><span class="line">      T[u].<span class="built_in">pb</span>(&#123;v, w&#125;);</span><br><span class="line">      T[v].<span class="built_in">pb</span>(&#123;u, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">    <span class="keyword">if</span>(fa[v][<span class="number">0</span>]==u||dfn[v]&lt;=dfn[u]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">findcir</span>(u, v, w);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> t = x;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(dep[fa[fa[t][i]][<span class="number">0</span>]]&gt;=dep[y]) t = fa[t][i];</span><br><span class="line">  <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line">  cnt = n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(&#123;v, w&#125;); G[v].<span class="built_in">pb</span>(&#123;u, w&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">tarjan</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  dep[<span class="number">1</span>] = <span class="number">1</span>; <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    <span class="type">int</span> z = <span class="built_in">LCA</span>(u, v);</span><br><span class="line">    <span class="keyword">if</span>(z&lt;=n) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, dis[u]+dis[v]<span class="number">-2</span>*dis[z]);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x = <span class="built_in">find</span>(u, z), y = <span class="built_in">find</span>(v, z);</span><br><span class="line">      <span class="keyword">if</span>(sum[x]&gt;sum[y]) <span class="built_in">swap</span>(x, y);</span><br><span class="line">      <span class="type">int</span> ans = dis[u]-dis[x]+dis[v]-dis[y]+<span class="built_in">min</span>(sum[y]-sum[x], sum[x]+sum[z]-sum[y]);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P5495 Dirichlet å‰ç¼€å’Œ</title>
      <link href="/2020/05/15/p5495-dirichlet-qian-zhui-he/"/>
      <url>/2020/05/15/p5495-dirichlet-qian-zhui-he/</url>
      
        <content type="html"><![CDATA[<p>$b_k = \sum_{i \mid k} a_i$<br>æ±‚æ•°ç»„b<br>è€ƒè™‘ä¸‹æ ‡iå’Œj,å¯¹å…¶è´¨å› æ•°åˆ†è§£,å½“ä¸”ä»…å½“içš„æ‰€æœ‰è´¨å› æ•°çš„å¹‚æ¬¡&lt;=jçš„,iæ‰æ˜¯jçš„å› æ•°,å¯ä»¥æœ‰è´¡çŒ®<br>å‘ç°è¿™ä¸ªå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå…³äºè´¨å› å­åˆ†è§£åçš„æŒ‡æ•°çš„é«˜ç»´å‰ç¼€å’Œï¼Œä½¿ç”¨ç±»ä¼¼FMTçš„æ–¹æ³•å°±å¯ä»¥äº†<br>å¤æ‚åº¦$O(n\log \log n)$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=prime[<span class="number">0</span>]; i++)</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; <span class="number">1ll</span>*j*prime[i]&lt;=n; j++)</span><br><span class="line">    b[j*prime[i]] += b[j];</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ†æ–¹æ ‘</title>
      <link href="/2020/05/15/yuan-fang-shu/"/>
      <url>/2020/05/15/yuan-fang-shu/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚å¿µ"><a class="header-anchor" href="#æ¦‚å¿µ">Â¶</a>æ¦‚å¿µ</h2><p>ç‚¹åŒè”é€šåˆ†é‡:ä¸å­˜åœ¨å‰²ç‚¹/ä»»æ„ä¸¤ç‚¹é—´æœ‰è‡³å°‘ä¸¤æ¡ç‚¹ä¸é‡å¤è·¯å¾„<br>ç‰¹æ®Š:ä¸¤ä¸ªç‚¹ä¸€æ¡è¾¹<br>æ¯æ¡è¾¹å±äºä¸€ä¸ªç‚¹åŒ,æ¯ä¸ªå‰²ç‚¹å¯ä»¥å±äºå¤šä¸ªç‚¹åŒ<br>åœ†æ–¹æ ‘ä¸­åŸå›¾çš„æ¯ä¸ªç‚¹å¯¹åº”ä¸€ä¸ªåœ†ç‚¹,ä¸€ä¸ªç‚¹åŒå¯¹åº”ä¸€ä¸ªæ–¹ç‚¹<br>å¯¹äºæ¯ä¸€ä¸ªç‚¹åŒè¿é€šåˆ†é‡ï¼Œå®ƒå¯¹åº”çš„æ–¹ç‚¹å‘è¿™ä¸ªç‚¹åŒè¿é€šåˆ†é‡ä¸­çš„æ¯ä¸ªåœ†ç‚¹è¿è¾¹<br>æ¯ä¸ªç‚¹åŒå½¢æˆä¸€ä¸ªâ€œèŠèŠ±å›¾â€ï¼Œå¤šä¸ªâ€œèŠèŠ±å›¾â€é€šè¿‡åŸå›¾ä¸­çš„å‰²ç‚¹è¿æ¥åœ¨ä¸€èµ·(å› ä¸ºç‚¹åŒçš„åˆ†éš”ç‚¹æ˜¯å‰²ç‚¹)</p><h2 id="æ€§è´¨"><a class="header-anchor" href="#æ€§è´¨">Â¶</a>æ€§è´¨</h2><p>åœ†ç‚¹åªå’Œæ–¹ç‚¹ç›¸è¿,æ–¹ç‚¹åªå’Œåœ†ç‚¹ç›¸è¿<br>åº¦æ•°å¤§äº1çš„åœ†ç‚¹æ˜¯åŸå›¾çš„å‰²ç‚¹<br>åœ†æ–¹æ ‘æ˜¯æ— æ ¹æ ‘,æ— è®ºå–å“ªä¸ªç‚¹ä¸ºæ ¹å¼€å§‹dfsè§æ ‘,å½¢æ€éƒ½ä¸€æ ·</p><h2 id="å»ºæ ‘"><a class="header-anchor" href="#å»ºæ ‘">Â¶</a>å»ºæ ‘</h2><p>æ³¨æ„ä¸¤å€ç©ºé—´<br>å»ºå®Œæ ‘æ ˆä¸­å¯èƒ½è¿˜æœ‰ç‚¹,æ³¨æ„å¤šç»„æ•°æ®æ¸…ç©º</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; G[N], T[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  low[u] = dfn[u] = ++clk;</span><br><span class="line">  stk[++top] = u;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!dfn[v])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">tarjan</span>(v, u);</span><br><span class="line">      low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">      <span class="keyword">if</span>(low[v]&gt;=dfn[u])</span><br><span class="line">      &#123;</span><br><span class="line">        ++cnt;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">0</span>; x!=v; top--)</span><br><span class="line">        &#123;</span><br><span class="line">          x = stk[top];</span><br><span class="line">          T[cnt].<span class="built_in">pb</span>(x);</span><br><span class="line">          T[x].<span class="built_in">pb</span>(cnt);</span><br><span class="line">        &#125;</span><br><span class="line">        T[cnt].<span class="built_in">pb</span>(u);</span><br><span class="line">        T[u].<span class="built_in">pb</span>(cnt);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(v!=fa) low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4169 [Violet]å¤©ä½¿ç©å¶/SJYæ‘†æ£‹å­ kdtree</title>
      <link href="/2020/05/14/p4169-violettian-shi-wan-ou-sjy-bai-qi-zi-kdtree/"/>
      <url>/2020/05/14/p4169-violettian-shi-wan-ou-sjy-bai-qi-zi-kdtree/</url>
      
        <content type="html"><![CDATA[<p>è¦æ±‚ç»´æŠ¤äºŒç»´å¹³é¢,æ”¯æŒæ’ç‚¹,è¯¢é—®ç‚¹é›†ä¸­ä¸¤ç‚¹çš„æœ€å°æ›¼å“ˆé¡¿è·ç¦»</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>kdtreeç»´æŠ¤<br>ä¸æ–­å¾ªç¯æŒ‰ç…§å…¶ä¸­ä¸€ç»´æ„å»ºäºŒå‰æ ‘<br>æ¯ä¸ªç‚¹ç»´æŠ¤å­æ ‘ä¸­çš„æœ€å¤§æœ€å°åæ ‡(æœ€å¤§çŸ©å½¢),ç„¶åå¤§åŠ›å‰ªæ<br>æœ¬é¢˜æœ‰æ’å…¥æ“ä½œ,æ‰€ä»¥å¯èƒ½ä¼šé€€åŒ–ä¸ºé“¾,éœ€è¦å®šæœŸé‡æ„</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">2e6</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">6e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">  <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">  <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">  t *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n, m, rt, ans;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> k = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">double</span> alpha = <span class="number">0.75</span>;</span><br><span class="line"><span class="type">int</span> D, pool[N], top, tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x[k];</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> point &amp;oth) <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x[D] &lt; oth.x[D];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;a[N], cur;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> mx[k], mn[k];</span><br><span class="line">  <span class="type">int</span> l, r, sz;</span><br><span class="line">  point tp;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(top) <span class="keyword">return</span> pool[top--];</span><br><span class="line">  <span class="keyword">return</span> ++tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn[i] = t[p].mx[i] = t[p].tp.x[i];</span><br><span class="line">    <span class="keyword">if</span>(l) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[l].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[l].mx[i]);</span><br><span class="line">    <span class="keyword">if</span>(r) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[r].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[r].mx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  t[p].sz = t[l].sz + t[r].sz + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> p = <span class="built_in">newnode</span>(), mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  D = d;</span><br><span class="line">  <span class="built_in">nth_element</span>(a+l, a+mid, a+r+<span class="number">1</span>);</span><br><span class="line">  t[p].tp = a[mid];</span><br><span class="line">  t[p].l = <span class="built_in">build</span>(l, mid<span class="number">-1</span>, (d+<span class="number">1</span>)%k);</span><br><span class="line">  t[p].r = <span class="built_in">build</span>(mid+<span class="number">1</span>, r, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(t[p].l) <span class="built_in">rebuild</span>(t[p].l, num);</span><br><span class="line">  a[num+t[t[p].l].sz+<span class="number">1</span>] = t[p].tp, pool[++top] = p;</span><br><span class="line">  <span class="keyword">if</span>(t[p].r) <span class="built_in">rebuild</span>(t[p].r, num+t[t[p].l].sz+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(alpha*t[p].sz&lt;t[t[p].l].sz||alpha*t[p].sz&lt;t[t[p].r].sz)</span><br><span class="line">    <span class="built_in">rebuild</span>(p, <span class="number">0</span>), p = <span class="built_in">build</span>(<span class="number">1</span>, t[p].sz, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p)</span><br><span class="line">  &#123;</span><br><span class="line">    p = <span class="built_in">newnode</span>();</span><br><span class="line">    t[p].tp = cur;</span><br><span class="line">    t[p].l = t[p].r = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cur.x[d]&gt;t[p].tp.x[d]) <span class="built_in">insert</span>(t[p].r, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">insert</span>(t[p].l, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="built_in">pushup</span>(p); <span class="built_in">test</span>(p, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getdis</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(cur.x[i]&lt;t[p].mn[i]) ans += (t[p].mn[i]-cur.x[i]);</span><br><span class="line">    <span class="keyword">if</span>(cur.x[i]&gt;t[p].mx[i]) ans += (cur.x[i]-t[p].mx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dis</span><span class="params">(point a, point b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">    ans += <span class="built_in">abs</span>(a.x[i]-b.x[i]);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ans = <span class="built_in">min</span>(ans, <span class="built_in">dis</span>(t[p].tp, cur));</span><br><span class="line">  <span class="type">int</span> dl = INF, dr = INF;</span><br><span class="line">  <span class="keyword">if</span>(t[p].l) dl = <span class="built_in">getdis</span>(t[p].l);</span><br><span class="line">  <span class="keyword">if</span>(t[p].r) dr = <span class="built_in">getdis</span>(t[p].r);</span><br><span class="line">  <span class="keyword">if</span>(dl&lt;dr)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dl&lt;ans) <span class="built_in">ask</span>(t[p].l);</span><br><span class="line">    <span class="keyword">if</span>(dr&lt;ans) <span class="built_in">ask</span>(t[p].r);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dr&lt;ans) <span class="built_in">ask</span>(t[p].r);</span><br><span class="line">    <span class="keyword">if</span>(dl&lt;ans) <span class="built_in">ask</span>(t[p].l);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">read</span>(n); <span class="built_in">read</span>(m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">read</span>(a[i].x[<span class="number">0</span>]), <span class="built_in">read</span>(a[i].x[<span class="number">1</span>]);</span><br><span class="line">  rt = <span class="built_in">build</span>(<span class="number">1</span>, n, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">read</span>(op); <span class="built_in">read</span>(cur.x[<span class="number">0</span>]); <span class="built_in">read</span>(cur.x[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>) <span class="built_in">insert</span>(rt, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ans = INF;</span><br><span class="line">      <span class="built_in">ask</span>(rt);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p4211 LCA ç¦»çº¿+æ ‘å‰–</title>
      <link href="/2020/05/14/p4211-lca-chi-xian-shu-pou/"/>
      <url>/2020/05/14/p4211-lca-chi-xian-shu-pou/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€æ£µ1ä¸ºæ ¹çš„æ ‘, å¤šæ¬¡æŸ¥è¯¢$\sum_{i=l}^{r} dep[LCA(i,z)]$</p><h1>åšæ³•</h1><p>åªéœ€æŠŠl-rçš„æ¯ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„+1,ç„¶åæŸ¥è¯¢zåˆ°æ ¹çš„è·¯å¾„çš„å’Œå³å¯<br>è€ƒè™‘ç¦»çº¿å·®åˆ†è¯¢é—®å¹¶æŒ‰å³ç«¯ç‚¹æ’åº</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">201314</span>;</span><br><span class="line"><span class="type">int</span> n, m, ans[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">qry</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> r, coef, z, id;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> qry &amp;oth) &#123;</span><br><span class="line">    <span class="keyword">return</span> r &lt; oth.r;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> &amp;u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  u += v;</span><br><span class="line">  <span class="keyword">if</span>(u&gt;=mod) u -= mod;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="type">int</span> sz[N], top[N], son[N], dep[N], fa[N], dfn[N], idfn[N], tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">seg</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, sum, tag;</span><br><span class="line">&#125;t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setval</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">add</span>(t[p].sum, v*(t[p].r-t[p].l+<span class="number">1</span>));</span><br><span class="line">  <span class="built_in">add</span>(t[p].tag, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].sum = t[p&lt;&lt;<span class="number">1</span>].sum;</span><br><span class="line">  <span class="built_in">add</span>(t[p].sum, t[p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setval</span>(p&lt;&lt;<span class="number">1</span>, t[p].tag); <span class="built_in">setval</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, t[p].tag);</span><br><span class="line">  t[p].tag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t[p].l = l, t[p].r = r;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>, l, mid); <span class="built_in">build</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setval</span>(p, v);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>, x, y, v);</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">upd</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y, v);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;=x &amp;&amp; r&lt;=y) <span class="keyword">return</span> t[p].sum;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tag) <span class="built_in">pushdown</span>(p);</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>, ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(x&lt;=mid) <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">if</span>(y&gt;mid) <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(p&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, x, y));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dep[u] = dep[f] + <span class="number">1</span>; fa[u] = f;</span><br><span class="line">  sz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">dfs1</span>(v, u);</span><br><span class="line">    sz[u] += sz[v];</span><br><span class="line">    <span class="keyword">if</span>(sz[v]&gt;sz[son[u]]) son[u] = v;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  top[u] = t;</span><br><span class="line">  dfn[u] = ++tot;</span><br><span class="line">  idfn[tot] = u;</span><br><span class="line">  <span class="keyword">if</span>(!son[u]) <span class="keyword">return</span>;</span><br><span class="line">  <span class="built_in">dfs2</span>(son[u], t);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    <span class="keyword">if</span>(v!=son[u]) <span class="built_in">dfs2</span>(v, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">updt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    <span class="built_in">upd</span>(<span class="number">1</span>, dfn[top[x]], dfn[x], v);</span><br><span class="line">    x = fa[top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="built_in">upd</span>(<span class="number">1</span>, dfn[x], dfn[y], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">askt</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(top[x]!=top[y])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(dep[top[x]]&lt;dep[top[y]]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">    <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(<span class="number">1</span>, dfn[top[x]], dfn[x]));</span><br><span class="line">    x = fa[top[x]];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="built_in">add</span>(ans, <span class="built_in">ask</span>(<span class="number">1</span>, dfn[x], dfn[y]));</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;u);</span><br><span class="line">    G[u+<span class="number">1</span>].<span class="built_in">pb</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">dfs1</span>(<span class="number">1</span>, <span class="number">0</span>); <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">  <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r, z; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;z);</span><br><span class="line">    q[++tot] = &#123;l, <span class="number">-1</span>, z+<span class="number">1</span>, i&#125;;</span><br><span class="line">    q[++tot] = &#123;r+<span class="number">1</span>, <span class="number">1</span>, z+<span class="number">1</span>, i&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(q+<span class="number">1</span>, q+tot+<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">upd</span>(<span class="number">1</span>, dfn[<span class="number">1</span>], dfn[<span class="number">2</span>], <span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> pre = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=tot; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(pre&lt;=q[i].r)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">updt</span>(<span class="number">1</span>, pre, <span class="number">1</span>);</span><br><span class="line">      ++pre;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">add</span>(ans[q[i].id], q[i].coef*<span class="built_in">askt</span>(<span class="number">1</span>, q[i].z));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (ans[i]+mod)%mod);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P6514 [QkOI#R1] Quark and Strings</title>
      <link href="/2020/05/14/p6514-qkoir1-quark-and-strings/"/>
      <url>/2020/05/14/p6514-qkoir1-quark-and-strings/</url>
      
        <content type="html"><![CDATA[<p>è¦æ±‚ç»´æŠ¤nä¸ªå­—ç¬¦ä¸²,æ¯æ¬¡åœ¨åŒºé—´[l,r]åŠ ä¸€ä¸ªå­—ç¬¦,æˆ–è¯¢é—®åŒºé—´[l,r]çš„å­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>æœ¬è´¨å°±æ˜¯æ¯æ¬¡æ’å…¥ä¸€æ¡[l,r]çš„çº¿æ®µ,æˆ–è¯¢é—®å·¦ç«¯ç‚¹&lt;=l&amp;&amp;å³ç«¯ç‚¹&gt;=rçš„çº¿æ®µçš„ä¸ªæ•°,è½¬åŒ–åå°±æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç‚¹çš„æ¨¡å‹,cdqåˆ†æ²»,æ ‘å¥—æ ‘,kdtéƒ½å¯ä»¥è§£å†³</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> k = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">double</span> alpha = <span class="number">0.75</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">  <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">  <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">  t *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> D, pool[N], top, tot, rt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x[k];</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> point &amp;oth) <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x[D] &lt; oth.x[D];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;a[N], cur;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> mx[k], mn[k];</span><br><span class="line">  <span class="type">int</span> l, r, sz;</span><br><span class="line">  point tp;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(top) <span class="keyword">return</span> pool[top--];</span><br><span class="line">  <span class="keyword">return</span> ++tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn[i] = t[p].mx[i] = t[p].tp.x[i];</span><br><span class="line">    <span class="keyword">if</span>(l) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[l].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[l].mx[i]);</span><br><span class="line">    <span class="keyword">if</span>(r) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[r].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[r].mx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  t[p].sz = t[l].sz + t[r].sz + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> p = <span class="built_in">newnode</span>(), mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  D = d;</span><br><span class="line">  <span class="built_in">nth_element</span>(a+l, a+mid, a+r+<span class="number">1</span>);</span><br><span class="line">  t[p].tp = a[mid];</span><br><span class="line">  t[p].l = <span class="built_in">build</span>(l, mid<span class="number">-1</span>, d^<span class="number">1</span>);</span><br><span class="line">  t[p].r = <span class="built_in">build</span>(mid+<span class="number">1</span>, r, d^<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(t[p].l) <span class="built_in">rebuild</span>(t[p].l, num);</span><br><span class="line">  a[num+t[t[p].l].sz+<span class="number">1</span>] = t[p].tp, pool[++top] = p;</span><br><span class="line">  <span class="keyword">if</span>(t[p].r) <span class="built_in">rebuild</span>(t[p].r, num+t[t[p].l].sz+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(alpha*t[p].sz&lt;t[t[p].l].sz||alpha*t[p].sz&lt;t[t[p].r].sz)</span><br><span class="line">  <span class="built_in">rebuild</span>(p, <span class="number">0</span>), p = <span class="built_in">build</span>(<span class="number">1</span>, t[p].sz, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p)</span><br><span class="line">  &#123;</span><br><span class="line">    p = <span class="built_in">newnode</span>();</span><br><span class="line">    t[p].tp = cur;</span><br><span class="line">    t[p].l = t[p].r = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cur.x[d]&gt;t[p].tp.x[d]) <span class="built_in">insert</span>(t[p].r, d^<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">insert</span>(t[p].l, d^<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">pushup</span>(p); <span class="built_in">test</span>(p, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mx[<span class="number">0</span>]&lt;=cur.x[<span class="number">0</span>]&amp;&amp;t[p].mn[<span class="number">1</span>]&gt;=cur.x[<span class="number">1</span>]) <span class="keyword">return</span> t[p].sz;</span><br><span class="line">  <span class="keyword">if</span>(t[p].mn[<span class="number">0</span>]&gt;cur.x[<span class="number">0</span>]||t[p].mx[<span class="number">1</span>]&lt;cur.x[<span class="number">1</span>]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(t[p].tp.x[<span class="number">0</span>]&lt;=cur.x[<span class="number">0</span>]&amp;&amp;t[p].tp.x[<span class="number">1</span>]&gt;=cur.x[<span class="number">1</span>]) ++ans;</span><br><span class="line">  ans += <span class="built_in">ask</span>(t[p].l) + <span class="built_in">ask</span>(t[p].r);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> n, q;</span><br><span class="line">  <span class="built_in">read</span>(n); <span class="built_in">read</span>(q);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">read</span>(op); <span class="built_in">read</span>(cur.x[<span class="number">0</span>]); <span class="built_in">read</span>(cur.x[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>) <span class="built_in">insert</span>(rt, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">ask</span>(rt));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p4148 ç®€å•é¢˜ kdtree</title>
      <link href="/2020/05/14/p4148-jian-dan-ti-kdtree/"/>
      <url>/2020/05/14/p4148-jian-dan-ti-kdtree/</url>
      
        <content type="html"><![CDATA[<p>ç»´æŠ¤çŸ©å½¢,æ”¯æŒåŠ ç‚¹,è¯¢é—®çŸ©å½¢å’Œ,å¼ºåˆ¶åœ¨çº¿</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>ä¸å¼ºåˆ¶åœ¨çº¿å¯ä»¥cdq,å¼ºåˆ¶åœ¨çº¿å°±åªèƒ½kdtreeäº†<br>æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤æœ€å¤§çŸ©å½¢,ä»¥åŠå­æ ‘å†…æ‰€æœ‰ç‚¹æƒå€¼çš„å’Œ<br>å¯¹äºè¯¢é—®,å¦‚æœå½“å‰èŠ‚ç‚¹çš„æœ€å¤§çŸ©å½¢åœ¨è¯¢é—®çŸ©å½¢å†…éƒ¨,ç›´æ¥è¿”å›sum,å¦‚æœä¸ç›¸äº¤,è¿”å›0,å¦åˆ™ç»§ç»­é€’å½’</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">1</span> &lt;&lt; <span class="number">20</span>;</span><br><span class="line"><span class="type">char</span> buf[MAXSIZE], *p1, *p2;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">char</span> <span class="title">gc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (p1==p2&amp;&amp;(p2=(p1=buf)+<span class="built_in">fread</span>(buf,<span class="number">1</span>,MAXSIZE,stdin),p1==p2) ? EOF : *p1++);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(T&amp; t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  t = <span class="number">0</span>; <span class="type">int</span> f = <span class="number">1</span>;</span><br><span class="line">  <span class="type">char</span> c = <span class="built_in">gc</span>();</span><br><span class="line">  <span class="keyword">while</span>(c&gt;<span class="string">&#x27;9&#x27;</span>||c&lt;<span class="string">&#x27;0&#x27;</span>) &#123;<span class="keyword">if</span>(c==<span class="string">&#x27;-&#x27;</span>) f = -f; c = <span class="built_in">gc</span>();&#125;</span><br><span class="line">  <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) t = t*<span class="number">10</span> + c - <span class="number">48</span>, c = <span class="built_in">gc</span>();</span><br><span class="line">  t *= f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> k = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">double</span> alph = <span class="number">0.75</span>;</span><br><span class="line"><span class="type">int</span> rt, pool[N], top, tot, D;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x[k], w;</span><br><span class="line">  <span class="type">bool</span> <span class="keyword">operator</span> &lt; (point &amp;oth) &#123;</span><br><span class="line">    <span class="keyword">return</span> x[D] &lt; oth.x[D];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;a[N], cur;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> l, r, mx[k], mn[k], sum, sz;</span><br><span class="line">  point tp;</span><br><span class="line">&#125;t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(top) <span class="keyword">return</span> pool[top--];</span><br><span class="line">  <span class="keyword">return</span> ++tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> l = t[p].l, r = t[p].r;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    t[p].mn[i] = t[p].mx[i] = t[p].tp.x[i];</span><br><span class="line">    <span class="keyword">if</span>(l) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[l].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[l].mx[i]);</span><br><span class="line">    <span class="keyword">if</span>(r) t[p].mn[i] = <span class="built_in">min</span>(t[p].mn[i], t[r].mn[i]), t[p].mx[i] = <span class="built_in">max</span>(t[p].mx[i], t[r].mx[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  t[p].sz = t[l].sz + t[r].sz + <span class="number">1</span>;</span><br><span class="line">  t[p].sum = t[l].sum + t[r].sum + t[p].tp.w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> p = <span class="built_in">newnode</span>(), mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  D = d;</span><br><span class="line">  <span class="built_in">nth_element</span>(a+l, a+mid, a+r+<span class="number">1</span>);</span><br><span class="line">  t[p].tp = a[mid];</span><br><span class="line">  t[p].l = <span class="built_in">build</span>(l, mid<span class="number">-1</span>, (d+<span class="number">1</span>)%k);</span><br><span class="line">  t[p].r = <span class="built_in">build</span>(mid+<span class="number">1</span>, r, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="built_in">pushup</span>(p);</span><br><span class="line">  <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rebuild</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(t[p].l) <span class="built_in">rebuild</span>(t[p].l, num);</span><br><span class="line">  a[num+t[t[p].l].sz+<span class="number">1</span>] = t[p].tp, pool[++top] = p;</span><br><span class="line">  <span class="keyword">if</span>(t[p].r) <span class="built_in">rebuild</span>(t[p].r, num+t[t[p].l].sz+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">test</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(alph*t[p].sz&lt;t[t[p].l].sz||alph*t[p].sz&lt;t[t[p].r].sz)</span><br><span class="line">    <span class="built_in">rebuild</span>(p, <span class="number">0</span>), p = <span class="built_in">build</span>(<span class="number">1</span>, t[p].sz, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">in</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> X1, <span class="type">int</span> Y1, <span class="type">int</span> X2, <span class="type">int</span> Y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> X1&gt;=x1&amp;&amp;Y1&gt;=y1&amp;&amp;X2&lt;=x2&amp;&amp;Y2&lt;=y2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">out</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> X1, <span class="type">int</span> Y1, <span class="type">int</span> X2, <span class="type">int</span> Y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> X2&lt;x1||X1&gt;x2||Y1&gt;y2||Y2&lt;y1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">in</span>(x1, y1, x2, y2, t[p].mn[<span class="number">0</span>], t[p].mn[<span class="number">1</span>], t[p].mx[<span class="number">0</span>], t[p].mx[<span class="number">1</span>])) <span class="keyword">return</span> t[p].sum;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">out</span>(x1, y1, x2, y2, t[p].mn[<span class="number">0</span>], t[p].mn[<span class="number">1</span>], t[p].mx[<span class="number">0</span>], t[p].mx[<span class="number">1</span>])) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">in</span>(x1, y1, x2, y2, t[p].tp.x[<span class="number">0</span>], t[p].tp.x[<span class="number">1</span>], t[p].tp.x[<span class="number">0</span>], t[p].tp.x[<span class="number">1</span>])) ans += t[p].tp.w;</span><br><span class="line">  ans += <span class="built_in">ask</span>(t[p].l, x1, y1, x2, y2) + <span class="built_in">ask</span>(t[p].r, x1, y1, x2, y2);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> &amp;p, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!p)</span><br><span class="line">  &#123;</span><br><span class="line">    p = <span class="built_in">newnode</span>();</span><br><span class="line">    t[p].tp = cur;</span><br><span class="line">    t[p].l = t[p].r = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(p);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(cur.x[d]&gt;t[p].tp.x[d]) <span class="built_in">insert</span>(t[p].r, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">insert</span>(t[p].l, (d+<span class="number">1</span>)%k);</span><br><span class="line">  <span class="built_in">pushup</span>(p); <span class="built_in">test</span>(p, d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">read</span>(n);</span><br><span class="line">  <span class="type">int</span> lstans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op;</span><br><span class="line">    <span class="built_in">read</span>(op);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">read</span>(cur.x[<span class="number">0</span>]), <span class="built_in">read</span>(cur.x[<span class="number">1</span>]), <span class="built_in">read</span>(cur.w);</span><br><span class="line">      cur.x[<span class="number">0</span>] ^= lstans, cur.x[<span class="number">1</span>] ^= lstans, cur.w ^= lstans;</span><br><span class="line">      <span class="built_in">insert</span>(rt, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> a, b, c, d;</span><br><span class="line">      <span class="built_in">read</span>(a), <span class="built_in">read</span>(b), <span class="built_in">read</span>(c), <span class="built_in">read</span>(d);</span><br><span class="line">      a ^= lstans, b ^= lstans, c ^= lstans, d ^= lstans;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, lstans=<span class="built_in">ask</span>(rt, a, b, c, d));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces1349</title>
      <link href="/2020/05/13/codeforces1349/"/>
      <url>/2020/05/13/codeforces1349/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a class="header-anchor" href="#A">Â¶</a>A</h2><h3 id="é¢˜æ„"><a class="header-anchor" href="#é¢˜æ„">Â¶</a>é¢˜æ„</h3><p>ç»™å®šnä¸ªæ•°$a_i$â€‹,æ±‚$gcd{(lcm(a_i,a_j))}$</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>è€ƒè™‘gcdå’Œlcmçš„æœ¬è´¨,gcdå°±æ˜¯æ‰€æœ‰æ•°ä¸ªè´¨å› å­å¹‚æ¬¡å–min,è€Œlcmæ˜¯å–max<br>æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯å„è´¨å› å­å¹‚æ¬¡çš„æ¬¡å¤§å€¼(<s>ä¸ä¼šç»´æŠ¤</s>)<br>è€ƒè™‘a[i]å¯¹ç­”æ¡ˆçš„è´¡çŒ®,å°±æ˜¯$lcm(a_i, sufgcd_{i+1})$<br>sufgcdä¸ºåç¼€gcd<br>æœ€åå„ä¸ªæ•°è´¡çŒ®å–gcdå³å¯</p><h2 id="B"><a class="header-anchor" href="#B">Â¶</a>B</h2><h3 id="é¢˜æ„-s2"><a class="header-anchor" href="#é¢˜æ„-s2">Â¶</a>é¢˜æ„</h3><p>ç»™å®šnä¸ªæ•°$a_i$â€‹,æ¯æ¬¡æ“ä½œå¯ä»¥é€‰å®šä¸€ä¸ªè¿ç»­å­æ®µ,å¹¶æŠŠæ‰€æœ‰æ•°å˜ä¸ºä¸­ä½æ•°(ç¬¬$\lfloor \frac{n+1}{2}\rfloor$å¤§çš„æ•°),é—®èƒ½å¦é€šè¿‡è‹¥å¹²æ¬¡æ“ä½œä½¿æ•´ä¸ªæ•°åˆ—æ‰€æœ‰æ•°éƒ½æ˜¯k</p><h3 id="åšæ³•-s2"><a class="header-anchor" href="#åšæ³•-s2">Â¶</a>åšæ³•</h3><p>1.å¦‚æœæ²¡æœ‰k,æ— è§£<br>2.n=1,çœ‹æ˜¯ä¸æ˜¯k<br>3.å¦‚æœæœ‰ä¸€æ®µè¿ç»­çš„k(&gt;=2),åˆ™ä¸€å®šæœ‰è§£,å› ä¸ºæ¯æ¬¡éƒ½å¯ä»¥è‡³å°‘å‘å·¦å³å»¶æ‹“ä¸€æ­¥.<br>è€ƒè™‘åˆ°ä¸¤ä¸ª&gt;=kçš„æ•°å¯ä»¥æŠŠä¸€ä¸ª&lt;kçš„æ•°å˜æˆ&gt;=k.è€Œä¸€ä¸ª=kæ•°å¯ä»¥æŠŠä¸€ä¸ª&gt;kçš„æ•°å˜æˆk<br>åªè¦<strong>å­˜åœ¨ä¸¤ä¸ª</strong>&gt;=kçš„æ•°çš„ä½ç½®å·®&lt;2åˆ™ä¸€å®šæœ‰è§£(é¦–å…ˆå˜æˆ3ä¸ª&gt;=kçš„æ•°,ç„¶åä¸æ–­å»¶æ‹“å³å¯)</p><h2 id="C"><a class="header-anchor" href="#C">Â¶</a>C</h2><h3 id="é¢˜æ„-s3"><a class="header-anchor" href="#é¢˜æ„-s3">Â¶</a>é¢˜æ„</h3><p>ä¸€ä¸ªé»‘ç™½æ ¼,åœ¨æ¯ä¸€ç§’,è‹¥ä¸€ä¸ªæ ¼å­ä¸ä¸Šä¸‹å·¦å³çš„æ ¼å­é¢œè‰²ä¸åŒ,å®ƒçš„é¢œè‰²ä¸æ”¹å˜,å¦åˆ™æ”¹å˜.é—®æŸä¸ªæ ¼å­tç§’åçš„é¢œè‰²</p><h3 id="åšæ³•-s3"><a class="header-anchor" href="#åšæ³•-s3">Â¶</a>åšæ³•</h3><p>å¦‚æœè¯¥æ ¼å­ä¸å››å‘¨æŸæ ¼å­é¢œè‰²ç›¸åŒ,é‚£ä¹ˆå®ƒå°±ä¸€ç›´ä¼šæ”¹å˜,å¦åˆ™å®ƒä¼šä¿æŒä¸å˜xç§’å,å†ä¸€ç›´æ”¹å˜,xä¸ºè·ç¦»è¯¥æ ¼å­æœ€è¿‘çš„ä¸€ç›´æ”¹å˜çš„æ ¼å­çš„æ›¼å“ˆé¡¿è·ç¦»,å¤šæºbfsé¢„å¤„ç†å³å¯.</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>p5107 çŸ©é˜µå¿«é€Ÿå¹‚+å€å¢+å¡å¸¸</title>
      <link href="/2020/05/13/p5107-ju-zhen-kuai-su-mi-bei-zeng-qia-chang/"/>
      <url>/2020/05/13/p5107-ju-zhen-kuai-su-mi-bei-zeng-qia-chang/</url>
      
        <content type="html"><![CDATA[<p>å¸¦è¡Œå’Œåˆ—çš„çŸ©é˜µæ¨¡æ¿<br>è®°å¾—åˆå§‹åŒ–è¡Œåˆ—,æ³¨æ„å·¦ä¹˜è¿˜æ˜¯å³ä¹˜<br>æ³¨æ„åˆ°è¯¢é—®å¾ˆå¤š,æ‰€ä»¥å…ˆé¢„å¤„ç†å¥½å€å¢çŸ©é˜µ,(å€æ•°ä¸ä¸€å®šè¦æ˜¯2,å¦‚æœé¢„å¤„ç†å¤æ‚åº¦æ¯”è¾ƒä½,å¯ä»¥å¢å¤§å€æ•°b)<br>å¢å¤§å€æ•°,é¢„å¤„ç†å¤æ‚åº¦æå‡,ä½†è¯¢é—®å¤æ‚åº¦é™ä½,å¯ä»¥è€ƒè™‘åˆ¶è¡¡ä¸¤è€…<br>è¯¢é—®å¯ä»¥æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºæ’åº,å¯ä»¥å‡å°‘ä¸€äº›è¿ç®—<br>å¯ä»¥æŠŠçŸ©é˜µä¹˜æ³•çš„forè¿›è¡Œå¾ªç¯å±•å¼€</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">55</span>, M = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="type">int</span> n, m, q, qry[M], idx[M], res[M];</span><br><span class="line">ll inv[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">matrix</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m;</span><br><span class="line">  ll mat[N][N];</span><br><span class="line">  <span class="built_in">matrix</span>() &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="built_in">matrix</span>(<span class="type">int</span> a, <span class="type">int</span> b) : <span class="built_in">n</span>(a), <span class="built_in">m</span>(b) &#123; <span class="built_in">memset</span>(mat, <span class="number">0</span>, <span class="built_in">sizeof</span>(mat)); &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">one</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=m; j++)</span><br><span class="line">        mat[i][j] = (i==j);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;b[<span class="number">32</span>];</span><br><span class="line">matrix <span class="keyword">operator</span> * (matrix a, matrix b)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function">matrix <span class="title">res</span><span class="params">(a.n, b.m)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=a.n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=b.m; j++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=a.m; k++)</span><br><span class="line">        res.mat[i][j] = (res.mat[i][j]+a.mat[i][k]*b.mat[k][j]%mod)%mod;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">matrix <span class="keyword">operator</span> ^ (matrix a, ll x)</span><br><span class="line">&#123;</span><br><span class="line">  matrix res; res.<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">while</span>(x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x&amp;<span class="number">1</span>) res = res * a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;q);</span><br><span class="line">  <span class="function">matrix <span class="title">a</span><span class="params">(n, <span class="number">1</span>)</span></span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;a.mat[i][<span class="number">1</span>]);</span><br><span class="line">  b[<span class="number">0</span>].n = b[<span class="number">0</span>].m = n;</span><br><span class="line">  b[<span class="number">0</span>].<span class="built_in">one</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    b[<span class="number">0</span>].mat[v][u]++;</span><br><span class="line">  &#125;</span><br><span class="line">  inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++) inv[i] = (mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> d = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) d += b[<span class="number">0</span>].mat[i][j];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) b[<span class="number">0</span>].mat[i][j] = b[<span class="number">0</span>].mat[i][j]*inv[d]%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">31</span>; i++) b[i] = b[i<span class="number">-1</span>]*b[i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, qry+i);</span><br><span class="line">  <span class="built_in">iota</span>(idx+<span class="number">1</span>, idx+q+<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">sort</span>(idx+<span class="number">1</span>, idx+q+<span class="number">1</span>, [](<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">    <span class="keyword">return</span> qry[x] &lt; qry[y];</span><br><span class="line">  &#125;);</span><br><span class="line">  matrix ans = a;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> tmp = qry[idx[i]] - qry[idx[i<span class="number">-1</span>]];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">31</span>; j&gt;=<span class="number">0</span>; j--)</span><br><span class="line">      <span class="keyword">if</span>((tmp&gt;&gt;j)&amp;<span class="number">1</span>) ans = b[j]*ans;</span><br><span class="line">    ll Res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) Res ^= ans.mat[i][<span class="number">1</span>];</span><br><span class="line">    res[idx[i]] = Res%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, res[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å››ç»´ååº cdqå¥—cdq</title>
      <link href="/2020/05/13/si-wei-pian-xu-cdq-tao-cdq/"/>
      <url>/2020/05/13/si-wei-pian-xu-cdq-tao-cdq/</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a class="header-anchor" href="#é—®é¢˜">Â¶</a>é—®é¢˜</h2><p>æ±‚è§£&lt;=a&amp;&amp;&lt;=b&amp;&amp;&lt;=c&amp;&amp;&lt;=dçš„å››å…ƒç»„æ•°é‡</p><h2 id="è¿‡ç¨‹"><a class="header-anchor" href="#è¿‡ç¨‹">Â¶</a>è¿‡ç¨‹</h2><p>1.æœ‰å››å…ƒç»„ç›¸åŒéœ€è¦å…ˆåˆå¹¶(unique)<br>2.å¯¹ç¬¬ä¸€ç»´æ’åº<br>3.cdq1,<strong>å…ˆæŠŠå·¦åŠéƒ¨åˆ†æ ‡è®°ä¸ºLEFT,å³åŠéƒ¨åˆ†æ ‡è®°ä¸ºRIGHT</strong>,ç„¶åå¯¹ç¬¬äºŒç»´æŒ‰åºå½’å¹¶<br>4.cdq2,å¯¹ç¬¬ä¸‰ç»´æŒ‰åºå½’å¹¶,ç¬¬å››ç»´ç”¨æ•°æ®ç»“æ„(å¦‚bit)ç»´æŠ¤,<strong>åªå¯¹å·¦è¾¹æ ‡è®°ä¸ºLEFTçš„è¿›è¡Œä¿®æ”¹,å¯¹å³è¾¹æ ‡è®°ä¸ºRIGHTçš„è¿›è¡ŒæŸ¥è¯¢</strong><br>æ³¨:æœ‰æ—¶ä¹Ÿå¯ä»¥ç›´æ¥sort,å¤šä¸€ä¸ªlog<br>cdq1ä¸­çš„å½’å¹¶æ•°ç»„æœ€å¥½å’Œcdq2ä¸åŒ,å¦åˆ™åœ¨cdq2ç»“æŸåè®°å¾—è¿˜åŸä¸ºcdq1ä¸­çš„é¡ºåº<br>æ’åºä¸€å®šè¦å½»åº•,å¦åˆ™ä¼šwa</p><h2 id="ä¾‹é¢˜"><a class="header-anchor" href="#ä¾‹é¢˜">Â¶</a>ä¾‹é¢˜</h2><p>hdu5126<br>ç«‹æ–¹ä½“åŠ ç‚¹,ç«‹æ–¹ä½“æ•°ç‚¹<br>æŠŠåŠ ç‚¹çœ‹ä½œä¿®æ”¹æ“ä½œ,æ•°ç‚¹åˆ©ç”¨å®¹æ–¥æ‹†æˆ8ä¸ªè¯¢é—®.<br>ä¿®æ”¹å’ŒæŸ¥è¯¢æŒ‰ç…§æ—¶é—´æœ‰åº,æ˜¯ä¸€ä¸ªå››ç»´ååº.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">4e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> q, c[N], tot, ans[N], id[N];</span><br><span class="line"><span class="type">bool</span> isq[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=tot; i+=(i&amp;-i)) c[i] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans += c[i];</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">item</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> x, y, z, t, coef;</span><br><span class="line">  <span class="type">bool</span> tag;</span><br><span class="line">&#125;p[N], tmp[N], tmp2[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(item a, item b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(a.x==b.x)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(a.y==b.y) <span class="keyword">return</span> a.z==b.z ? a.t &lt; b.t : a.z &lt; b.z;</span><br><span class="line">    <span class="keyword">return</span> a.y &lt; b.y;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a.x &lt; b.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CDQ2</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ2</span>(l, mid); <span class="built_in">CDQ2</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="type">int</span> i = l, j = mid+<span class="number">1</span>, k = l;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=mid&amp;&amp;j&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(tmp[i].z&lt;=tmp[j].z)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!tmp[i].tag&amp;&amp;!tmp[i].coef) <span class="built_in">upd</span>(tmp[i].t, <span class="number">1</span>);</span><br><span class="line">      tmp2[k++] = tmp[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(tmp[j].tag&amp;&amp;tmp[j].coef) ans[tmp[j].t] += <span class="built_in">ask</span>(tmp[j].t<span class="number">-1</span>)*tmp[j].coef;</span><br><span class="line">      tmp2[k++] = tmp[j++];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=mid)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!tmp[i].tag&amp;&amp;!tmp[i].coef) <span class="built_in">upd</span>(tmp[i].t, <span class="number">1</span>);</span><br><span class="line">    tmp2[k++] = tmp[i++];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(j&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(tmp[j].tag&amp;&amp;tmp[j].coef) ans[tmp[j].t] += <span class="built_in">ask</span>(tmp[j].t<span class="number">-1</span>)*tmp[j].coef;</span><br><span class="line">    tmp2[k++] = tmp[j++];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=mid; i++) <span class="keyword">if</span>(!tmp[i].tag&amp;&amp;!tmp[i].coef) <span class="built_in">upd</span>(tmp[i].t, <span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) tmp[i] = tmp2[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CDQ1</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ1</span>(l, mid); <span class="built_in">CDQ1</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=mid; i++) p[i].tag = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=mid+<span class="number">1</span>; i&lt;=r; i++) p[i].tag = <span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> i = l, j = mid+<span class="number">1</span>, k = l;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=mid&amp;&amp;j&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p[i].y&lt;=p[j].y) tmp[k++] = p[i++];</span><br><span class="line">    <span class="keyword">else</span> tmp[k++] = p[j++];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(i&lt;=mid) tmp[k++] = p[i++];</span><br><span class="line">  <span class="keyword">while</span>(j&lt;=r) tmp[k++] = p[j++];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) p[i] = tmp[i];</span><br><span class="line">  <span class="built_in">CDQ2</span>(l, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">  tot = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;op);</span><br><span class="line">    ans[i] = isq[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x, y, z;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">      p[++tot] = &#123;x, y, z, i, <span class="number">0</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x1, y1, z1, x2, y2, z2;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d%d&quot;</span>, &amp;x1, &amp;y1, &amp;z1, &amp;x2, &amp;y2, &amp;z2);</span><br><span class="line">      isq[i] = <span class="number">1</span>;</span><br><span class="line">      p[++tot] = &#123;x2, y2, z2, i, <span class="number">1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x1<span class="number">-1</span>, y2, z2, i, <span class="number">-1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x2, y1<span class="number">-1</span>, z2, i, <span class="number">-1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x2, y2, z1<span class="number">-1</span>, i, <span class="number">-1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x1<span class="number">-1</span>, y1<span class="number">-1</span>, z2, i, <span class="number">1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x2, y1<span class="number">-1</span>, z1<span class="number">-1</span>, i, <span class="number">1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x1<span class="number">-1</span>, y2, z1<span class="number">-1</span>, i, <span class="number">1</span>&#125;;</span><br><span class="line">      p[++tot] = &#123;x1<span class="number">-1</span>, y1<span class="number">-1</span>, z1<span class="number">-1</span>, i, <span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(p+<span class="number">1</span>, p+tot+<span class="number">1</span>, cmp);</span><br><span class="line">  <span class="built_in">CDQ1</span>(<span class="number">1</span>, tot);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=q; i++)</span><br><span class="line">    <span class="keyword">if</span>(isq[i]) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>p5621<br>å››ç»´LIS<br>æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ç¬¬å››ç»´çš„dpå‰ç¼€max,ç¬¬å››ç»´è¦ç¦»æ•£åŒ–,åŒæ—¶ç›¸åŒçš„å››å…ƒç»„è¦åˆå¹¶<br><strong>æ³¨æ„</strong><br>æ­¤é¢˜è¦å…ˆcdqå·¦åŠéƒ¨åˆ†,ç„¶åç»Ÿè®¡å·¦å¯¹å³çš„ç­”æ¡ˆ,å†cdqå³åŠéƒ¨åˆ†.<br>è€Œä¸Šä¸€é¢˜æ˜¯å…ˆcdqå·¦å³,æœ€åå†ç»Ÿè®¡ç­”æ¡ˆ(å…¶å®ä¹Ÿå¯ä»¥æŒ‰æœ¬é¢˜çš„æµç¨‹,ä½†æœ¬é¢˜ä¸å¯ä»¥è¿™æ ·,å› ä¸ºæœ¬è´¨æ˜¯ä¸€ä¸ªdp,å¿…é¡»ä»å·¦åˆ°å³,è€Œç»Ÿè®¡æ²¡è¿™ä¸ªè¦æ±‚).</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> id[N], lsh[N];</span><br><span class="line">ll c[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, ll v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=m; i+=(i&amp;-i)) c[i] = <span class="built_in">max</span>(c[i], v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&lt;=m; i+=(i&amp;-i)) c[i] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=x; i&gt;<span class="number">0</span>; i-=(i&amp;-i)) ans = <span class="built_in">max</span>(ans, c[i]);</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">item</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> a, b, c, d, id;</span><br><span class="line">  <span class="type">bool</span> t;</span><br><span class="line">  ll mx, val;</span><br><span class="line">&#125;p[N], tmp[N];</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp1</span><span class="params">(item x, item y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x.a==y.a)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(x.b==y.b) <span class="keyword">return</span> x.c==y.c ? x.d &lt; y.d : x.c &lt; y.c;</span><br><span class="line">    <span class="keyword">return</span> x.b &lt; y.b;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> x.a &lt; y.a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp2</span><span class="params">(item x, item y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x.b==y.b&amp;&amp;x.c==y.c&amp;&amp;x.d==y.d) <span class="keyword">return</span> x.a &lt; y.a;</span><br><span class="line">  <span class="keyword">if</span>(x.b==y.b) <span class="keyword">return</span> x.c==y.c ? x.d &lt; y.d : x.c &lt; y.c;</span><br><span class="line">  <span class="keyword">return</span> x.b &lt; y.b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp3</span><span class="params">(item x, item y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x.c==y.c&amp;&amp;x.d==y.d) <span class="keyword">return</span> x.a==y.a ? x.b &lt; y.b : x.a &lt; y.a;</span><br><span class="line">  <span class="keyword">return</span> x.c==y.c ? x.d &lt; y.d : x.c &lt; y.c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CDQ2</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ2</span>(l, mid);</span><br><span class="line">  <span class="built_in">sort</span>(p+l, p+mid+<span class="number">1</span>, cmp3);</span><br><span class="line">  <span class="built_in">sort</span>(p+mid+<span class="number">1</span>, p+r+<span class="number">1</span>, cmp3);</span><br><span class="line">  <span class="type">int</span> i = l, j = mid+<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span>(j&lt;=r)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=mid &amp;&amp; p[i].c&lt;=p[j].c)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!p[i].t) <span class="built_in">upd</span>(p[i].d, p[i].mx);</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p[j].t) p[j].mx = <span class="built_in">max</span>(p[j].mx, <span class="built_in">ask</span>(p[j].d)+p[j].val);</span><br><span class="line">    j++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=mid; i++) <span class="keyword">if</span>(!p[i].t) <span class="built_in">clear</span>(p[i].d);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) tmp[id[p[i].id]] = p[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) p[i] = tmp[i];</span><br><span class="line">  <span class="built_in">CDQ2</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CDQ1</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(l==r) <span class="keyword">return</span>;</span><br><span class="line">  <span class="type">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">  <span class="built_in">CDQ1</span>(l, mid);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=mid; i++) p[i].t = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=mid+<span class="number">1</span>; i&lt;=r; i++) p[i].t = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">sort</span>(p+l, p+r+<span class="number">1</span>, cmp2);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) id[p[i].id] = i;</span><br><span class="line">  <span class="built_in">CDQ2</span>(l, r);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) tmp[p[i].id] = p[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=l; i&lt;=r; i++) p[i] = tmp[i];</span><br><span class="line">  <span class="built_in">CDQ1</span>(mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;p[i].a, &amp;p[i].b, &amp;p[i].c, &amp;p[i].d);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;p[i].val);</span><br><span class="line">    lsh[i] = p[i].d;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sort</span>(lsh+<span class="number">1</span>, lsh+n+<span class="number">1</span>);</span><br><span class="line">  m = <span class="built_in">unique</span>(lsh+<span class="number">1</span>, lsh+n+<span class="number">1</span>) - lsh - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    p[i].d = <span class="built_in">lower_bound</span>(lsh+<span class="number">1</span>, lsh+m+<span class="number">1</span>, p[i].d) - lsh;</span><br><span class="line">  <span class="type">int</span> tot = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">sort</span>(p+<span class="number">1</span>, p+n+<span class="number">1</span>, cmp1);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(p[i].a!=p[i<span class="number">-1</span>].a||p[i].b!=p[i<span class="number">-1</span>].b||p[i].c!=p[i<span class="number">-1</span>].c||p[i].d!=p[i<span class="number">-1</span>].d) p[++tot] = p[i];</span><br><span class="line">    <span class="keyword">else</span> p[tot].val += <span class="built_in">max</span>(p[i].val, <span class="number">0ll</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  n = tot;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    p[i].id = i;</span><br><span class="line">    p[i].mx = p[i].val;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">CDQ1</span>(<span class="number">1</span>, n);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) ans = <span class="built_in">max</span>(ans, p[i].mx);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chef and Bitwise Product è´ªå¿ƒ+ä½è¿ç®—</title>
      <link href="/2020/05/11/chef-and-bitwise-product-tan-xin-wei-yun-suan/"/>
      <url>/2020/05/11/chef-and-bitwise-product-tan-xin-wei-yun-suan/</url>
      
        <content type="html"><![CDATA[<p>ç»™ä¸¤ä¸ªæ•°x,y($x, y &lt;= 10^{12}$),è¦æ±‚æ‰¾åˆ°ä¸€ä¸ªæ•°z,æœ€å¤§åŒ–(x&amp;z)*(y&amp;z)åŒæ—¶æœ€å°åŒ–z,ä¸”$L\leq z\leq R$,Lå’ŒRç”±é¢˜ç›®ç»™å‡º($L, R \leq 10^{12}$)</p><h1>åšæ³•</h1><p>å…ˆä¸è€ƒè™‘ä¸Šä¸‹ç•Œé™åˆ¶,é‚£ä¹ˆzå…¨å–1è‚¯å®šæœ€ä¼˜,å†åŠ å…¥ä¸Šç•Œé™åˆ¶,ç„¶è€Œå¹¶ä¸æ˜¯å–Ræœ€ä¼˜,æ¯”å¦‚<br>x = 7, y = 12, l = 0, r = 8, æ­¤æ—¶z=7<br>å¯ä»¥æƒ³åˆ°ä¸€ç§è´ªå¿ƒçš„åšæ³•,è®©Rçš„æŸä¸€ä½1å˜æˆ0,ç„¶åè®©Rçš„ä½ä½å…¨å˜1,ç„¶åäº¤ä¸€å‘ä¼šå‘ç°0åˆ†<br>å…¶å®è¿™ä¸ªæ—¶å€™å·²ç»å¯ä»¥æœ€å¤§åŒ–(x&amp;z)*(y&amp;z),ä¸‹é¢è¦æœ€å°åŒ–z,å¯ä»¥å‘ç°å¦‚æœxå’Œyçš„æŸä¸€ä½åŒæ—¶ä¸º0,æ­¤æ—¶zçš„è¯¥ä½ä¸º1ä¹Ÿæ²¡ç”¨.æ‰€ä»¥åªè¦åœ¨ä¿è¯&gt;=ä¸‹ç•Œçš„æƒ…å†µä¸‹é€šè¿‡è¯¥æ¡ä»¶æœ€å°åŒ–zå³å¯.å¦å¤–å¥½åƒè¦ç‰¹åˆ¤ä¸€ä¸‹ä¸‹ç•Œä¸ºæœ€ä¼˜è§£çš„æƒ…å†µ.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">15</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ll x, y, l, r;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld%lld%lld&quot;</span>, &amp;x, &amp;y, &amp;l, &amp;r);</span><br><span class="line">  ll ans = (x&amp;r)*(y&amp;r), z = r;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">40</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> b = (r&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b)</span><br><span class="line">    &#123;</span><br><span class="line">      ll c = (r&gt;&gt;(i+<span class="number">1</span>)&lt;&lt;(i+<span class="number">1</span>)) + (<span class="number">1ll</span>&lt;&lt;i) - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">40</span>; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> aa = (x&gt;&gt;i)&amp;<span class="number">1</span>, bb = (y&gt;&gt;i)&amp;<span class="number">1</span>, cc = (c&gt;&gt;i)&amp;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(!aa &amp;&amp; !bb &amp;&amp; cc)</span><br><span class="line">          <span class="keyword">if</span>((c^(<span class="number">1ll</span>&lt;&lt;i))&gt;=l) c ^= (<span class="number">1ll</span>&lt;&lt;i);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(c&lt;l) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="keyword">if</span>((x&amp;c)*(y&amp;c)&gt;ans || (((x&amp;c)*(y&amp;c))==ans&amp;&amp;c&lt;z)) ans = (x&amp;c)*(y&amp;c), z = c;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(!ans) z = l;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Binary Land åŒæ ˆtrick</title>
      <link href="/2020/05/11/binary-land-shuang-zhan-trick/"/>
      <url>/2020/05/11/binary-land-shuang-zhan-trick/</url>
      
        <content type="html"><![CDATA[<p>è¦æ±‚åŠ¨æ€ç»´æŠ¤ä¸€ä¸ª01çŸ©é˜µ,æ”¯æŒ:<br>1.ä»é¡¶éƒ¨åˆ é™¤ä¸€è¡Œ<br>2.ä»å°¾éƒ¨æ·»åŠ ä¸€è¡Œ<br>3.è¯¢é—®å½“å‰é¡¶éƒ¨æŸåˆ—åˆ°å°¾éƒ¨æŸåˆ—çš„åˆæ³•è·¯å¾„æ•°<br>å…¶ä¸­åˆæ³•è·¯å¾„æ•°å®šä¹‰ä¸º,æ¯æ¬¡åªèƒ½ä»[i,j]âˆ’&gt;[i,jâˆ’1]or[i,j]or[i,j+1],ä¸”è¦æ±‚ä¸¤ç‚¹åŒä¸º0æˆ–1<br>çŸ©é˜µåˆ—æ•°=20,æ“ä½œæ•°=3e5</p><h1>åšæ³•</h1><p>æ˜¾ç„¶è·¯å¾„æ•°å¯ä»¥é€šè¿‡ç®€å•dpæ±‚å¾—,ä»å°¾éƒ¨æ·»åŠ ä¸€è¡Œä¹Ÿå¾ˆç®€å•,å¯ä»¥O(col)æ±‚å¾—,ä½†æ˜¯åˆ é™¤æ“ä½œå¾ˆéº»çƒ¦,å¿…é¡»å…¨éƒ¨é‡ç®—.<br>æ­¤æ—¶å°±æœ‰ä¸€ä¸ªtrickäº†,å½“è¦æ±‚çš„æ˜¯åŒç«¯é˜Ÿåˆ—æ“ä½œ,ä½†æ˜¯åªæœ‰æ·»åŠ å¯ä»¥å¿«é€Ÿåš,é‚£å°±å¯ä»¥ç”¨ä¸¤ä¸ªå¯¹é¡¶æ ˆæ¥æ“ä½œ.å¼€å£å‘ä¸Šçš„ä¸ºs1,å¼€å£å‘ä¸‹çš„ä¸ºs2<br>å°¾éƒ¨æ·»åŠ å°±è®©s2çš„æ ˆæŒ‡é’ˆ++,å¹¶ä¸”O(col)æ›´æ–°<br>é¡¶éƒ¨åˆ é™¤å°±è®©s1çš„æ ˆæŒ‡é’ˆâ€“,æ³¨æ„å¦‚æœs1çš„æ ˆæŒ‡é’ˆä¸º0,å°±æŠŠs2çš„æ‰€æœ‰å€¼æ¬åˆ°s1,æ­¤æ—¶å°±ç›¸å½“äºç»™s1æ·»åŠ ,s2åˆ é™¤.<br>åˆ—æ•°å¾ˆå°‘,æˆ‘ä»¬ç›´æ¥ä¿å­˜æ‰€æœ‰å¯èƒ½çš„$n^2$ä¸ªç­”æ¡ˆ,ç„¶åæ¯æ¬¡ä¿®æ”¹ä¹Ÿéƒ½æ˜¯$n^2$çš„.<br>è¯¢é—®çš„è¯, $n^2$å¤„ç†ä¸‹å¯¹é¡¶å¤„éƒ¨åˆ†ç­”æ¡ˆçš„åˆå¹¶å³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>, M = <span class="number">25</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, q, sta[<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> dp[<span class="number">2</span>][N][M][M];</span><br><span class="line">string p[<span class="number">2</span>][N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> idx)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> x = sta[idx];</span><br><span class="line">  <span class="keyword">if</span>(x==<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">        dp[idx][x][i][j] = (i==j);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      &#123;</span><br><span class="line">        dp[idx][x][i][j] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k=j<span class="number">-1</span>; k&lt;=j+<span class="number">1</span>; k++)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span>(k&lt;<span class="number">1</span>||k&gt;n||p[idx][x<span class="number">-1</span>][k<span class="number">-1</span>]!=p[idx][x][j<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">          dp[idx][x][i][j] += dp[idx][x<span class="number">-1</span>][i][k];</span><br><span class="line">          <span class="keyword">if</span>(dp[idx][x][i][j]&gt;=mod) dp[idx][x][i][j] -= mod;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">  cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">  cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    string op;</span><br><span class="line">    cin &gt;&gt; op;</span><br><span class="line">    <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      cin &gt;&gt; p[<span class="number">1</span>][++sta[<span class="number">1</span>]];</span><br><span class="line">      <span class="built_in">upd</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op[<span class="number">0</span>]==<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(sta[<span class="number">0</span>]==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span>(sta[<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">          p[<span class="number">0</span>][++sta[<span class="number">0</span>]] = p[<span class="number">1</span>][sta[<span class="number">1</span>]--];</span><br><span class="line">          <span class="built_in">upd</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      sta[<span class="number">0</span>]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> a, b;</span><br><span class="line">      cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">      <span class="keyword">if</span>(sta[<span class="number">0</span>]==<span class="number">0</span>) cout &lt;&lt; dp[<span class="number">1</span>][sta[<span class="number">1</span>]][a][b] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(sta[<span class="number">1</span>]==<span class="number">0</span>) cout &lt;&lt; dp[<span class="number">0</span>][sta[<span class="number">0</span>]][b][a] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">          <span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">-1</span>; j&lt;=i+<span class="number">1</span>; j++)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span>(j&lt;<span class="number">1</span>||j&gt;n||p[<span class="number">0</span>][<span class="number">1</span>][i<span class="number">-1</span>]!=p[<span class="number">1</span>][<span class="number">1</span>][j<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">            ans += <span class="number">1ll</span>*dp[<span class="number">0</span>][sta[<span class="number">0</span>]][i][a]*dp[<span class="number">1</span>][sta[<span class="number">1</span>]][j][b]%mod;</span><br><span class="line">            <span class="keyword">if</span>(ans&gt;=mod) ans -= mod;</span><br><span class="line">          &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buying a New String ACè‡ªåŠ¨æœº</title>
      <link href="/2020/05/11/buying-a-new-string-ac-zi-dong-ji/"/>
      <url>/2020/05/11/buying-a-new-string-ac-zi-dong-ji/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²A,B,<br>å†ç»™å‡ºnä¸ªå­—ç¬¦ä¸²$s_i$â€‹,æ¯ä¸ª$s_i$â€‹æœ‰ä»·å€¼$b_i$â€‹,è®©ä½ ä»Aä¸­å–ä¸€ä¸ªå­ä¸²(å¯ç©º),å†ä»Bä¸­å–ä¸€ä¸ªå­ä¸²(å¯ç©º),æ‹¼æ¥æˆä¸²C,å®šä¹‰Cçš„ä»·å€¼ä¸º$\sum cnt_iÂ©â‹…b_i$.$cnt_i$â€‹è¡¨ç¤º$s_i$â€‹åœ¨Cä¸­ä½œä¸ºå­ä¸²å‡ºç°çš„æ¬¡æ•°.è¦æ±‚è¾“å‡ºæœ€å¤§çš„ä»·å€¼.<br><strong>Constraints</strong><br>$1â‰¤Tâ‰¤10$<br>$1â‰¤|A|,|B|â‰¤10^3$<br>$1â‰¤Nâ‰¤10^4$<br>$1â‰¤|S_i|â‰¤26$ for each valid i<br>$1â‰¤b_iâ‰¤10^5$ for each valid i<br>$A,B,S_1,S_2,â€¦,S_N$â€‹ contain only lowercase English letters<br>$S_1,S_2,â€¦,S_N$â€‹ are pairwise distinct<br>the sum of |A| over all test cases does not exceed $2â‹…10^3$<br>the sum of |B| over all test cases does not exceed $2â‹…10^3$<br>the sum of N over all test cases does not exceed $2â‹…10^4$</p><h1>åšæ³•</h1><p>ç®€å•çš„è´ªå¿ƒå¯ä»¥å‘ç°,è‚¯å®šæ˜¯å–Açš„æŸä¸ªå‰ç¼€å’ŒBçš„æŸä¸ªåç¼€æ‹¼æ¥.æ­¤é¢˜çš„å…³é”®$|S_i|$å¾ˆå°,å¦‚æœå¤§äº†æˆ‘ä¸çŸ¥é“è¿˜èƒ½ä¸èƒ½åšäº†.åˆ©ç”¨è¿™ç‚¹æˆ‘ä»¬å¯ä»¥å…ˆé¢„å¤„ç†å‡ºAçš„æ¯ä¸ªå‰ç¼€çš„ä»·å€¼å’ŒBçš„æ¯ä¸ªåç¼€çš„ä»·å€¼,è¿™ä¸ªç”¨acè‡ªåŠ¨æœºå¤„ç†,ç„¶åæšä¸¾å‰ç¼€iå’Œåç¼€jæ‹¼æ¥,æ­¤æ—¶Cä¸­æ²¡æœ‰ç®—çš„å½±å“å°±æ˜¯æ‹¼æ¥å¤„å‰å26ä¸ªå­—æ¯çš„ä»·å€¼,å¯ä»¥ä»åç¼€çš„èµ·ç‚¹å¼€å§‹åœ¨acè‡ªåŠ¨æœºä¸Šèµ°25æ­¥,æ¯æ¬¡æš´åŠ›è·³failç»Ÿè®¡ä¸‹ç­”æ¡ˆ,æœ€åå–ä¸ªmax.<br>è¿™æ ·è¿˜æ˜¯ä¼št,å¤æ‚åº¦æ˜¯$O(|A|^2 * 26^2)$<br>å¤§æ¦‚6e9,æ¯æ¬¡è·³failæ˜¯O(26)çš„,é‚£å°±å†å»ºä¸ªfailæ ‘,é¢„å¤„ç†ä¸‹æŠŠè¿™ä¸ªO(26)å»æ‰å°±è¿‡äº†.</p><pre><code><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">char</span> a[N], b[N], rb[N];</span><br><span class="line"><span class="type">char</span> s[N][<span class="number">30</span>], rs[N][<span class="number">30</span>];</span><br><span class="line"><span class="type">int</span> n, val[N];</span><br><span class="line">ll pre[N], suf[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ACA</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> nxt[N][<span class="number">26</span>], fail[N], len[N], cnt, end[N];</span><br><span class="line">  ll tmp[N][<span class="number">30</span>];</span><br><span class="line">  vector &lt;<span class="type">int</span>&gt; to[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      fail[i] = end[i] = len[i] = <span class="number">0</span>;</span><br><span class="line">      to[i].<span class="built_in">clear</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="number">26</span>; j++)</span><br><span class="line">        nxt[i][j] = tmp[i][j+<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">char</span> *s, <span class="type">int</span> v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">      <span class="keyword">if</span>(!nxt[p][k]) nxt[p][k] = ++cnt;</span><br><span class="line">      p = nxt[p][k];</span><br><span class="line">    &#125;</span><br><span class="line">    end[p] = v; len[p] = n;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++) <span class="keyword">if</span>(nxt[<span class="number">0</span>][i]) q.<span class="built_in">push</span>(nxt[<span class="number">0</span>][i]);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> k = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span>(nxt[k][i])</span><br><span class="line">        &#123;</span><br><span class="line">          fail[nxt[k][i]] = nxt[fail[k]][i];</span><br><span class="line">          q.<span class="built_in">push</span>(nxt[k][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> nxt[k][i] = nxt[fail[k]][i];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">go</span><span class="params">(<span class="type">char</span> *s, ll *v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      p = nxt[p][s[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=p; j; j=fail[j])</span><br><span class="line">        v[i] += end[j];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=len[u]; i&gt;<span class="number">0</span>; i--) tmp[u][i] += end[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : to[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">26</span>; i&gt;<span class="number">0</span>; i--) tmp[v][i] += tmp[u][i];</span><br><span class="line">      <span class="built_in">dfs</span>(v);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;ac, ac2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s%s&quot;</span>, a, b);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  <span class="type">int</span> x = <span class="built_in">strlen</span>(a), y = <span class="built_in">strlen</span>(b);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;y; i++) rb[i] = b[y-i<span class="number">-1</span>];</span><br><span class="line">  ac.<span class="built_in">clear</span>(); ac2.<span class="built_in">clear</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s%d&quot;</span>, s[i], val+i);</span><br><span class="line">    <span class="type">int</span> t = <span class="built_in">strlen</span>(s[i]);</span><br><span class="line">    ac.<span class="built_in">insert</span>(s[i], val[i], t);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;t; j++) rs[i][j] = s[i][t-j<span class="number">-1</span>];</span><br><span class="line">    ac2.<span class="built_in">insert</span>(rs[i], val[i], t);</span><br><span class="line">  &#125;</span><br><span class="line">  ac.<span class="built_in">build</span>(); ac2.<span class="built_in">build</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;x; i++) pre[i] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;y; i++) suf[i] = <span class="number">0</span>;</span><br><span class="line">  ac.<span class="built_in">go</span>(a, pre, x); ac2.<span class="built_in">go</span>(rb, suf, y);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;x; i++) pre[i] += pre[i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;y; i++) suf[i] += suf[i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=ac.cnt; i++) ac.to[ac.fail[i]].<span class="built_in">pb</span>(i);</span><br><span class="line">  ac.<span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;x; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    p = ac.nxt[p][a[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;y; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      ll cur = pre[i] + suf[y-j<span class="number">-1</span>];</span><br><span class="line">      <span class="type">int</span> pp = p;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>; k&lt;<span class="number">25</span>&amp;&amp;j+k&lt;y; k++)</span><br><span class="line">      &#123;</span><br><span class="line">        pp = ac.nxt[pp][b[j+k]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        cur += ac.tmp[pp][k+<span class="number">2</span>];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(cur&gt;ans) ans = cur;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Not a real world problem æœ€å°å‰²+æ–¹æ¡ˆ</title>
      <link href="/2020/05/11/not-a-real-problem-zui-xiao-ge-fang-an/"/>
      <url>/2020/05/11/not-a-real-problem-zui-xiao-ge-fang-an/</url>
      
        <content type="html"><![CDATA[<p>æœ‰h*wçš„ç½‘æ ¼,æ¯ä¸ªç‚¹æœ‰æƒå€¼h[i][j], æœ‰nä¸ªç²’å­,å‘Šè¯‰ä½ æ¯ä¸ªç‚¹çš„åæ ‡(x,y),æƒå€¼çš„ç»å¯¹å€¼$\left| p[i]\right|$,å®šä¹‰ä»·å€¼ä¸º$\sum p[i]*h[x[i]][y[i]] + \sum p[i]*p[j]$(å¦‚æœiç‚¹å’Œjç‚¹ç›¸é‚»)<br>é—®å¦‚ä½•åˆ†é…pçš„æ­£è´Ÿå·å¯ä»¥æœ€å¤§åŒ–ä»·å€¼,å¹¶è¾“å‡ºæ–¹æ¡ˆ</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>è¿™ç§åˆ†é…åˆ°ä¸¤ä¸ªé›†åˆ,ç„¶åå®šä¹‰ä¸€ä¸‹ä»·å€¼å¹¶æœ€å¤§åŒ–çš„å¯ä»¥è€ƒè™‘è½¬åŒ–ä¸ºæœ€å°å‰²,sä»£è¡¨+å·,tä»£è¡¨-å·,é‚£ä¹ˆå¯¹äºæ¯ä¸ªç²’å­i:s-&gt;i,æƒå€¼ä¸ºp[i]*h[x[i]][y[i]](è¡¨ç¤ºå¦‚æœå‰²æ‰,åˆ™pä¸ºè´Ÿå·,ä¼š<strong>æŸå¤±</strong>è¿™ä¹ˆå¤š),åŒç†i-&gt;t,æƒå€¼ä¸º-p[i]*h[x[i]][y[i]],æ³¨æ„ä¸èƒ½æœ‰è´Ÿæƒ,æ‰€ä»¥å…¨åŠ ä¸€ä¸ªåç§»é‡offset.<br>å†è€ƒè™‘ç›¸é‚»ç‚¹,å¦‚æœç¬¦å·ç›¸åŒæœ‰ä¸€ç§æ”¶è·x,ç¬¦å·ä¸åŒæœ‰ä¸€ç§æ”¶è·y.å…¶å®åªè¦ä»iå‘jè¿è¾¹x-y,ä»jå‘iä¹Ÿè¿è¾¹x-y.å¯ä»¥é»˜è®¤ä¸¤è€…ç¬¦å·ç›¸åŒæ”¶è·x,é‚£ä¹ˆå¦‚æœå‰²æ‰iä¸jé—´çš„è¾¹,è¯´æ˜ä¸¤è€…åˆ†åˆ«å±äºså’Œt,æŸå¤±x-y.<br>å»ºå®Œå›¾æœ€å¤§æµ,è¾“å‡ºæ–¹æ¡ˆåªè¦ä»æºç‚¹èµ°æƒå€¼&gt;0çš„è¾¹,æ‰€æœ‰ç»è¿‡çš„ç‚¹å°±æ˜¯å±äºsçš„(å³ç¬¦å·ä¸ºæ­£)</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, maxn = <span class="number">1e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> h, w, n, p[maxn], a[maxn][maxn], x[maxn], y[maxn], state[maxn];</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e4</span> + <span class="number">5</span>, M = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> cnt, head[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> next, to, w;</span><br><span class="line">&#125;e[M&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  e[++cnt].next = head[u];</span><br><span class="line">  e[cnt].to = v;</span><br><span class="line">  e[cnt].w = w;</span><br><span class="line">  head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dinic</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> n, m, s, t;</span><br><span class="line">  <span class="type">int</span> dep[N], cur[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> s,<span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;s = s, <span class="keyword">this</span>-&gt;t = t, <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">    cnt = <span class="number">1</span>, m = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> cap)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(u,v,cap);</span><br><span class="line">    <span class="built_in">add</span>(v,u,<span class="number">0</span>);</span><br><span class="line">    m += <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dep,<span class="number">0</span>,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    <span class="built_in">memcpy</span>(cur,head,(n+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line">    queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s); dep[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].to;</span><br><span class="line">        <span class="keyword">if</span>(!dep[v]&amp;&amp;e[i].w&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">          q.<span class="built_in">push</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dep[t];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> flow)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(u==t||!flow) <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="type">int</span> used = flow;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=cur[u];i;i=e[i].next)</span><br><span class="line">    &#123;</span><br><span class="line">      cur[u] = i;</span><br><span class="line">      <span class="type">int</span> v = e[i].to;</span><br><span class="line">      <span class="keyword">if</span>(dep[v]==dep[u]+<span class="number">1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> low = <span class="built_in">dfs</span>(v,<span class="built_in">min</span>(flow,e[i].w));</span><br><span class="line">        e[i].w -= low; e[i^<span class="number">1</span>].w += low;</span><br><span class="line">        flow -= low;</span><br><span class="line">        <span class="keyword">if</span>(!flow) <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> used - flow;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">go</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> maxflow = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">bfs</span>()) maxflow += <span class="built_in">dfs</span>(s,INF);</span><br><span class="line">    <span class="keyword">return</span> maxflow;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = e[i].next)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (e[i].w&gt;<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[e[i].to]) <span class="keyword">continue</span>;</span><br><span class="line">        state[e[i].to] = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(e[i].to);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;MF;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;h, &amp;w, &amp;n);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=h; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=w; j++)</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, x+i, y+i, p+i);</span><br><span class="line">  MF.<span class="built_in">init</span>(n+<span class="number">2</span>, <span class="number">0</span>, n+<span class="number">1</span>);</span><br><span class="line">  <span class="type">int</span> ans = n*<span class="number">100000</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    state[i] = <span class="number">0</span>;</span><br><span class="line">    MF.<span class="built_in">addedge</span>(MF.s, i, p[i]*a[x[i]][y[i]]+<span class="number">100000</span>);</span><br><span class="line">    MF.<span class="built_in">addedge</span>(i, MF.t, -p[i]*a[x[i]][y[i]]+<span class="number">100000</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">abs</span>(x[i]-x[j])+<span class="built_in">abs</span>(y[i]-y[j])&lt;=<span class="number">1</span>)</span><br><span class="line">        MF.<span class="built_in">addedge</span>(i, j, <span class="number">2</span>*p[i]*p[j]), MF.<span class="built_in">addedge</span>(j, i, <span class="number">2</span>*p[i]*p[j]), ans += p[i]*p[j];</span><br><span class="line">  &#125;</span><br><span class="line">  ans -= MF.<span class="built_in">go</span>();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">  MF.<span class="built_in">dfs</span>(MF.s);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span>(state[i]) <span class="built_in">printf</span>(<span class="string">&quot;1%c&quot;</span>, <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;-1%c&quot;</span>, <span class="string">&quot; \n&quot;</span>[i==n]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sorting Vases æ€ç»´</title>
      <link href="/2020/05/11/sorting-vases-si-wei/"/>
      <url>/2020/05/11/sorting-vases-si-wei/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªnçš„æ’åˆ—p,æ¯æ¬¡å¯ä»¥ä»»æ„äº¤æ¢ä¸¤ä¸ªä½ç½®,èŠ±è´¹ä¸º1,ç„¶ååˆç»™å®šmç»„äº¤æ¢,èŠ±è´¹ä¸º0(å¯ä»¥ä»»æ„æ¬¡ä½¿ç”¨),é—®ä½¿è¯¥æ’åˆ—pæœ‰åºçš„æœ€å°èŠ±è´¹.(n&lt;=18, m&lt;=18)</p><h3 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h3><p>å…ˆè€ƒè™‘m=0,æ­¤æ—¶åªè¦è®©æ¯ä¸ªæ•°ç›´æ¥å‘ç›®æ ‡ä½ç½®äº¤æ¢å³å¯,ç­”æ¡ˆä¸ºn-ç¯çš„ä¸ªæ•°<br>å†è€ƒè™‘m,æ—¢ç„¶å¯ä»¥ä»»æ„äº¤æ¢,é‚£å°±ç›¸å½“äºè¿™äº›ä½ç½®æ˜¯ç­‰ä»·çš„,å¯ä»¥ç»´æŠ¤å‡ºæ¯ä¸ªç­‰ä»·çš„é›†åˆ,ç„¶åç›´æ¥å…¨æ’åˆ—æšä¸¾æ¯ä¸ªé›†åˆ,è®©pé€šè¿‡m=0çš„æ–¹å¼è½¬æ¢æˆè¯¥æ’åˆ—,æœ€åå–æœ€å°å€¼.è¿™æ ·äº¤çš„è¯å…¶å®åªä¼štleä¸€ä¸ªç‚¹.<br>å¦‚æœæŸä¸ªé›†åˆçš„å¤§å°&gt;10,å…¨æ’åˆ—æšä¸¾æ˜¾ç„¶t.ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦æšä¸¾æ¯ä¸ªé›†åˆçš„æ’åˆ—,å› ä¸ºå‰å‡ ä¸ªæ•°å½’ä½å,æœ€åä¸€ä¸ªé›†åˆçš„æ•°è‡ªç„¶å°±å½’ä½äº†.æ‰€ä»¥æˆ‘ä»¬ä¸æšä¸¾æœ€å¤§çš„é›†åˆå°±å¯ä»¥äº†,è¿™æ ·æˆ‘ä»¬æšä¸¾çš„é›†åˆçš„å¤§å°æœ€å¤šåªæœ‰9,9!(362880)å®Œå…¨å¯ä»¥æ¥å—.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, p[N], pos[N], x[N], y[N];</span><br><span class="line"><span class="type">int</span> tmpp[N];</span><br><span class="line"><span class="type">int</span> f[N], ans;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; vec;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; rt[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==f[x]) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">return</span> f[x] = <span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  x = <span class="built_in">find</span>(x), y = <span class="built_in">find</span>(y);</span><br><span class="line">  <span class="keyword">if</span>(x==y) <span class="keyword">return</span>;</span><br><span class="line">  f[x] = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cal</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    tmpp[i] = p[i];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = i;</span><br><span class="line">    <span class="keyword">while</span>(pos[tmpp[j]]&amp;&amp;pos[tmpp[j]]!=j)</span><br><span class="line">    &#123;</span><br><span class="line">      cnt++;</span><br><span class="line">      <span class="built_in">swap</span>(tmpp[j], tmpp[pos[tmpp[j]]]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==<span class="built_in">sz</span>(vec))</span><br><span class="line">  &#123;</span><br><span class="line">    ans = <span class="built_in">min</span>(ans, <span class="built_in">cal</span>());</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">idx</span><span class="params">(sz(vec[x]))</span></span>;</span><br><span class="line">  <span class="built_in">iota</span>(<span class="built_in">all</span>(idx), <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sz</span>(vec[x]); i++)</span><br><span class="line">      pos[vec[x][i]] = vec[x][idx[i]];</span><br><span class="line">    <span class="built_in">dfs</span>(x+<span class="number">1</span>);</span><br><span class="line">  &#125;<span class="keyword">while</span>(<span class="built_in">next_permutation</span>(<span class="built_in">all</span>(idx)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  ans = n - <span class="number">1</span>;</span><br><span class="line">  vec.<span class="built_in">clear</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, p+i);</span><br><span class="line">    f[i] = i;</span><br><span class="line">    pos[i] = <span class="number">0</span>;</span><br><span class="line">    rt[i].<span class="built_in">clear</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, x+i, y+i);</span><br><span class="line">    <span class="built_in">merge</span>(x[i], y[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> mx = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> r = <span class="built_in">find</span>(i);</span><br><span class="line">    rt[r].<span class="built_in">pb</span>(i);</span><br><span class="line">    mx = <span class="built_in">max</span>(mx, <span class="built_in">sz</span>(rt[r]));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">bool</span> tag = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span>(f[i]==i &amp;&amp; <span class="built_in">sz</span>(rt[i])&lt;mx) vec.<span class="built_in">pb</span>(rt[i]);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(f[i]==i &amp;&amp; <span class="built_in">sz</span>(rt[i])==mx)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!tag) tag = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">else</span> vec.<span class="built_in">pb</span>(rt[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Triple Sort æ€ç»´+æ„é€ </title>
      <link href="/2020/05/11/triple-sort-si-wei-gou-zao/"/>
      <url>/2020/05/11/triple-sort-si-wei-gou-zao/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ’åˆ—p,å®šä¹‰ä¸€ç§æ“ä½œæ–¹å¼æ˜¯,é€‰æ‹©ä¸‰ä¸ªä¸‹æ ‡a,b,c,ç„¶åè®©p[c]=p[b],p[b]=p[a],p[a]=p[c](å¾ªç¯å³ç§»ä¸€ä½),ä¸‹æ ‡a,b,cçš„å¤§å°å…³ç³»ä»»æ„,ä½†å¿…é¡»ä¸¤ä¸¤ä¸åŒ.è¦æ±‚ç”¨kæ¬¡æ“ä½œè®©pæœ‰åº,è¾“å‡ºä¸€ç§åˆæ³•è§£(ä¸è¦æ±‚æœ€å°åŒ–),æ— è§£è¾“å‡º-1<br>$n&lt;=2e5, k&lt;=\lfloor \frac{n}{2} \rfloor$</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å…ˆè€ƒè™‘ä¸€ä¸‹n=3çš„æ—¶å€™,å¯ä»¥å‘ç°è¯¥æ“ä½œä¼šå½¢æˆä¸¤ä¸ªç­‰ä»·ç±»,{(1, 2, 3), (3, 1, 2), (2, 3, 1)}ã€ {(3, 2, 1), (1, 3, 2), (2, 1, 3)},å› æ­¤ç¬¬äºŒä¸ªé›†åˆä¸­çš„æ’åˆ—å°±ä¸å¯èƒ½æ’æˆæœ‰åº. <s>ç„¶è€Œè¿™å¥½åƒæ²¡ä»€ä¹ˆç”¨</s>.<br>ä»kçš„å¤§å°å…¥æ‰‹,k&lt;=n/2,è¯´æ˜æ¯æ¬¡æ“ä½œè‡³å°‘è¦è®©ä¸¤ä¸ªå…ƒç´ å½’ä½,æ¯æ¬¡åªè¦æ“ä½œ(i, p[i], p[p[i]])å³å¯,ä½†æ˜¯æœ‰å¯èƒ½i==p[p[i]],å³ä¸ºä¸€ä¸ªäºŒå…ƒç¯.<br>ä¸‹é¢è€ƒè™‘{2, 1, 4, 3}è¿™ä¸ªæ’åˆ—,å®ƒç”±ä¸¤ä¸ªäºŒå…ƒç¯ç»„æˆ,å¯ä»¥å‘ç°åªè¦æ“ä½œ(2,3,4),(1,2,3)å³å¯,å°±æ˜¯è¯´ä¸¤ä¸ªäºŒå…ƒç¯å¯ä»¥é€šè¿‡ä¸¤æ¬¡æ“ä½œæ’æˆæœ‰åº.<br>æ‰€ä»¥æˆ‘ä»¬åªè¦å…ˆå¯¹é•¿åº¦å¤§äº2çš„ç¯è¿›è¡Œæ“ä½œ,ç„¶åæŠŠäºŒå…ƒç¯å­˜èµ·æ¥.æœ€åå¦‚æœäºŒå…ƒç¯æœ‰å¶æ•°ä¸ª,ä¸¤ä¸¤è§£å†³,å¦åˆ™æ— è§£.å¦‚æœäºŒå…ƒç¯æœ‰å¥‡æ•°ä¸ª,åˆ™é€†åºå¯¹æ•°æœ‰å¥‡æ•°ä¸ª,è€Œå¯ä»¥å‘ç°è¯¥æ“ä½œæ¯æ¬¡åªèƒ½å˜åŒ–å¶æ•°ä¸ªé€†åºå¯¹,å…¶å®å°±å¯¹åº”äº†ä¸Šé¢çš„ä¸¤ä¸ªç­‰ä»·ç±».</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, k, a[N], p[N], b[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">upd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">assert</span>(x!=y); <span class="built_in">assert</span>(y!=z); <span class="built_in">assert</span>(x!=z);</span><br><span class="line">  <span class="type">int</span> tmp = a[z];</span><br><span class="line">  a[z] = a[y];</span><br><span class="line">  p[a[y]] = z;</span><br><span class="line">  a[y] = a[x];</span><br><span class="line">  p[a[x]] = y;</span><br><span class="line">  a[x] = tmp;</span><br><span class="line">  p[tmp] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    p[a[i]] = i;</span><br><span class="line">  &#125;</span><br><span class="line">  vector &lt;array&lt;<span class="type">int</span>,3&gt;&gt; op;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    vis[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(i!=p[i])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> x = p[i], y = i, z = a[i];</span><br><span class="line">      <span class="keyword">if</span>(z==x) <span class="keyword">continue</span>;</span><br><span class="line">      op.<span class="built_in">pb</span>(&#123;y, z, x&#125;);</span><br><span class="line">      <span class="built_in">upd</span>(y, z, x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  vector &lt;pii&gt; loop;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(i!=p[i] &amp;&amp; p[i]==a[i] &amp;&amp; !vis[p[i]])</span><br><span class="line">    &#123;</span><br><span class="line">      loop.<span class="built_in">pb</span>(&#123;i, p[i]&#125;);</span><br><span class="line">      vis[i] = vis[p[i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">sz</span>(loop)&amp;<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sz</span>(loop); i+=<span class="number">2</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a = loop[i].fi, b = loop[i].se, c = loop[i+<span class="number">1</span>].fi, d = loop[i+<span class="number">1</span>].se;</span><br><span class="line">    op.<span class="built_in">pb</span>(&#123;b, c, d&#125;);</span><br><span class="line">    <span class="built_in">upd</span>(b, c, d);</span><br><span class="line">    op.<span class="built_in">pb</span>(&#123;a, b, c&#125;);</span><br><span class="line">    <span class="built_in">upd</span>(a, b, c);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">sz</span>(op)&gt;k || !<span class="built_in">is_sorted</span>(a+<span class="number">1</span>, a+n+<span class="number">1</span>)) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">sz</span>(op) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : op) <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d\n&quot;</span>, it[<span class="number">0</span>], it[<span class="number">1</span>], it[<span class="number">2</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰›å®¢ç®—æ³•å‘¨å‘¨ç»ƒ5</title>
      <link href="/2020/05/06/niu-ke-suan-fa-zhou-zhou-lian-5/"/>
      <url>/2020/05/06/niu-ke-suan-fa-zhou-zhou-lian-5/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ä¸é”™,æ‰€ä»¥åšäº†ä¸‹.</p><h1>A å¤šå½©çš„æ ‘</h1><p>ç»™å®šä¸€æ£µæ ‘,æ¯ä¸ªç‚¹æœ‰ä¸€ç§é¢œè‰²,é—®æ°å¥½åŒ…å«iç§é¢œè‰²çš„è·¯å¾„çš„æ•°é‡(iä»1-k) $k&lt;=10$<br>çœ‹è§è·¯å¾„ä¿¡æ¯ç»Ÿè®¡,æƒ³åˆ°ç‚¹åˆ†æ²»,kå¾ˆå°,çŠ¶å‹å³å¯.<br>æˆ‘ä»¬ç”¨<code>num[1&lt;&lt;10]</code>çš„æ¡¶è®°å½•è¿™ç§çŠ¶æ€çš„è·¯å¾„çš„æ•°é‡<br>ç„¶åè€ƒè™‘æ€ä¹ˆåˆå¹¶ä¸¤æ¡è·¯å¾„:<code>num[i|j] = cnt[i] * cnt[j]</code><br>æœ´ç´ æš´åŠ›æ˜¯$O(n*4^k)$çš„,5ç§’åº”è¯¥è¿‡ä¸äº†<br>å¾ˆå®¹æ˜“å‘ç°è¿™æ˜¯ä¸ªæˆ–è¿ç®—å·ç§¯,FWTä¼˜åŒ–ä¸€ä¸‹å³å¯.ä½†æ˜¯è¦æ³¨æ„å½“i==jçš„æ—¶å€™<code>num[i|j] = cnt[i] * (cnt[i]-1)/2 + cnt[i]</code>(é€‰ä¸¤ä¸ªåˆå¹¶,ä»¥åŠå’Œç©ºè·¯å¾„åˆå¹¶(å‡ä¸åˆæ³•è·¯å¾„æ—¶ä¸åŒ…å«)),ç„¶åæ³¨æ„åˆ°FWTä¸­ç®—çš„æ˜¯<code>cnt[i] * cnt[i] + 2*cnt[i]</code>,æ‰€ä»¥è¿˜è¦å‡æ‰ä¸€ä¸ªcnt[i].<br>ç”±äºæ˜¯ç‚¹æƒæ‰€ä»¥è¦æ³¨æ„äº›ç»†èŠ‚é—®é¢˜,ç‰¹åˆ«æ˜¯å‡æ‰ä¸åˆæ³•è·¯å¾„çš„æ—¶å€™,ç„¶åè¿™é¢˜å°±åšå®Œäº†<br>å…¶å®å¯ä»¥ç›´æ¥çŠ¶å‹åŒ…å«çš„é¢œè‰²æ•°,ç„¶åæ‰¾åˆ°åªåŒ…å«è¿™æ ·é¢œè‰²çš„è¿é€šå—</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">5e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, two = (mod+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line"><span class="type">int</span> n, k, a[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line">ll pw[<span class="number">15</span>];</span><br><span class="line"><span class="type">int</span> rt, sz[N], dp[N], mxsz;</span><br><span class="line">ll mask[<span class="number">1</span>&lt;&lt;<span class="number">10</span>], num[<span class="number">1</span>&lt;&lt;<span class="number">10</span>], tmp[<span class="number">1</span>&lt;&lt;<span class="number">10</span>];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FWT</span><span class="params">(ll *a, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> d=<span class="number">1</span>;d&lt;n;d&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> m=d&lt;&lt;<span class="number">1</span>,i=<span class="number">0</span>;i&lt;n;i+=m)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;d;j++)</span><br><span class="line">      &#123;</span><br><span class="line">        ll x = a[i+j], y = a[i+j+d];</span><br><span class="line">        a[i+j+d] = (x+y)%mod;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IFWT</span><span class="params">(ll *a, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> d=<span class="number">1</span>;d&lt;n;d&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> m=d&lt;&lt;<span class="number">1</span>,i=<span class="number">0</span>;i&lt;n;i+=m)</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;d;j++)</span><br><span class="line">      &#123;</span><br><span class="line">        ll x = a[i+j], y = a[i+j+d];</span><br><span class="line">        a[i+j+d] = (y-x+mod)%mod;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dp[u] = <span class="number">0</span>, sz[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[v]||v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">findroot</span>(v, u);</span><br><span class="line">    dp[u] = <span class="built_in">max</span>(dp[u],sz[v]);</span><br><span class="line">    sz[u] += sz[v];</span><br><span class="line">  &#125;</span><br><span class="line">  dp[u] = <span class="built_in">max</span>(dp[u],mxsz-sz[u]);</span><br><span class="line">  <span class="keyword">if</span>(dp[u]&lt;dp[rt]) rt = u;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getdis</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  d |= (<span class="number">1</span>&lt;&lt;a[u]);</span><br><span class="line">  mask[d]++;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[v]||v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">getdis</span>(v, u, d);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calcu</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(mask, <span class="number">0</span>, <span class="built_in">sizeof</span>(mask));</span><br><span class="line">  <span class="keyword">if</span>(!d) mask[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">getdis</span>(u, <span class="number">0</span>, d);</span><br><span class="line">  <span class="comment">// for(int i=0; i&lt;(1&lt;&lt;k); i++)</span></span><br><span class="line">  <span class="comment">// for(int j=0; j&lt;(1&lt;&lt;k); j++)</span></span><br><span class="line">  <span class="comment">// if(!d) (num[i|j] += mask[i]*mask[j]%mod)%=mod;</span></span><br><span class="line">  <span class="comment">// else (num[i|j] -= mask[i]*mask[j]%mod)%=mod;</span></span><br><span class="line">  <span class="comment">// for(int i=0; i&lt;(1&lt;&lt;k); i++)</span></span><br><span class="line">  <span class="comment">// num[i] -= mask[i]%=mod;</span></span><br><span class="line">  <span class="built_in">memcpy</span>(tmp, mask, <span class="built_in">sizeof</span>(mask));</span><br><span class="line">  <span class="built_in">FWT</span>(tmp, <span class="number">1</span>&lt;&lt;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;(<span class="number">1</span>&lt;&lt;k); i++) tmp[i] = tmp[i]*tmp[i]%mod;</span><br><span class="line">  <span class="built_in">IFWT</span>(tmp, <span class="number">1</span>&lt;&lt;k);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;(<span class="number">1</span>&lt;&lt;k); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!d) (num[i] += tmp[i] - mask[i]) %= mod;</span><br><span class="line">    <span class="keyword">else</span> (num[i] -= tmp[i] + mask[i]) %= mod;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  vis[u] = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">calcu</span>(u, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[v]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">calcu</span>(v, <span class="number">1</span>&lt;&lt;a[u]);</span><br><span class="line">    mxsz = sz[v], rt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">findroot</span>(v, u);</span><br><span class="line">    <span class="built_in">solve</span>(rt);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=k; i++) pw[i] = pw[i<span class="number">-1</span>]*<span class="number">131</span>%mod;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, a+i);</span><br><span class="line">    a[i]--;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(v); G[v].<span class="built_in">pb</span>(u);</span><br><span class="line">  &#125;</span><br><span class="line">  dp[<span class="number">0</span>] = mxsz = n;</span><br><span class="line">  <span class="built_in">findroot</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">solve</span>(rt);</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;(<span class="number">1</span>&lt;&lt;k); i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> j = __builtin_popcount(i);</span><br><span class="line">    (ans += pw[j]*num[i]%mod) %= mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(ans&lt;<span class="number">0</span>) ans += mod;</span><br><span class="line">  ans = ans*two%mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>B æ±‚å¹‚</h1><p>ç»™å®šn(n&lt;=1e6),é—®æ»¡è¶³a^b = c^dçš„å››å…ƒæœ‰åºç»„ä¸ªæ•°,å…¶ä¸­a,b,c,dåœ¨1-nä¹‹é—´<br>æœ‰ä¸€ä¸ªç»“è®ºæ˜¯å„ä¸ªéå®Œå…¨å¹³æ–¹æ•°çš„æ‰€æœ‰å¹‚æ¬¡ç»„æˆçš„é›†åˆæ˜¯æ²¡æœ‰äº¤é›†çš„,è€ƒè™‘æŒ‰æ­¤åˆ’åˆ†,æ˜¾ç„¶ä¸åŒé›†åˆé—´æ²¡æœ‰è´¡çŒ®.<br>è€ƒè™‘ä¸€ä¸ªé›†åˆä¸­çš„ä¸¤ä¸ªå…ƒç´ a^bå’Œa^c,ä»¤d=max(b,c)/__gcd(b,c),åˆ™æœ‰n/dç»„å…ƒç´ (ab,xâˆ—d,ac,y),1&lt;=x&lt;=n/d.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  ll ans = <span class="number">1ll</span>*n*n;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(vis[i]) <span class="keyword">continue</span>;</span><br><span class="line">    vector&lt;pii&gt; tmp;</span><br><span class="line">    <span class="keyword">for</span>(ll j=i, k=<span class="number">1</span>; j&lt;=n; j*=i, k++)</span><br><span class="line">    &#123;</span><br><span class="line">      vis[j] = <span class="number">1</span>;</span><br><span class="line">      tmp.<span class="built_in">pb</span>(&#123;j, k&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    ll cur = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="built_in">sz</span>(tmp); i++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="built_in">sz</span>(tmp); j++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="type">int</span> x = tmp[i].se/__gcd(tmp[i].se, tmp[j].se), y = tmp[j].se/__gcd(tmp[i].se, tmp[j].se);</span><br><span class="line">        cur += n/<span class="built_in">max</span>(x, y);</span><br><span class="line">        <span class="keyword">if</span>(cur&gt;=mod) cur -= mod;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (ans + cur)%mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(ans&lt;<span class="number">0</span>) ans += mod;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>C åºåˆ—æœ€å°åŒ–</h1><p>ç»™å®šä¸€ä¸ª1-nçš„æ’åˆ—,æ¯æ¬¡å¯ä»¥é€‰æ‹©kä¸ªè¿ç»­çš„æ•°å°†å…¶å˜æˆæœ€å°çš„é‚£ä¸ªæ•°,é—®æœ€å°‘ç»è¿‡å‡ æ¬¡æ“ä½œä½¿åºåˆ—æœ€å°.<br>æœ€åè‚¯å®šéƒ½å˜æˆäº†1,ç¬¬ä¸€æ¬¡æ“ä½œè‚¯å®šåŒ…å«äº†1è¿™ä¸ªä½ç½®,æ‰€ä»¥æšä¸¾ç¬¬ä¸€æ¬¡æ“ä½œçš„å·¦å³ç«¯ç‚¹,åˆ™åé¢çš„æ“ä½œä¸€å®šæ˜¯å·¦å³å»¶ä¼¸.</p><h1>D å°é›¨ååœ°é“</h1><p>mæ¡åœ°é“çº¿è·¯,nä¸ªè½¦ç«™,ç¬¬iæ¡åœ°é“çº¿è·¯èŠ±è´¹a[i],ç»è¿‡c[i]ä¸ªè½¦ç«™,æ¯ç«™èŠ±è´¹b[i]å…ƒ,é—®ä»sç«™åˆ°tç«™çš„æœ€å°èŠ±è´¹.å¦‚æœæœ‰å¤šæ¡åœ°é“ç»è¿‡åŒä¸€ä¸ªè½¦ç«™,å¯ä»¥æ¢ä¹˜.<br>å¯¹äºæŸä¸ªè½¦ç«™,å¦‚æœå­˜åœ¨äºå¤šä¸ªåœ°é“çº¿è·¯ä¸­,å…¶å®æ˜¯ä¸åŒçš„çŠ¶æ€,æ‰€ä»¥å¯¹äºæ¯ä¸ªåœ°é“çº¿è·¯ä¸­çš„è½¦ç«™æˆ‘ä»¬éƒ½ç”¨ä¸€ä¸ªæ–°ç‚¹æ¥è¡¨ç¤º.è¿™æ ·å°±å¯ä»¥è¿›è¡Œå»ºå›¾è·‘æœ€çŸ­è·¯äº†.<br>å¯¹äºæŸæ¡çº¿è·¯ä¸­çš„è½¦ç«™,ä¾æ¬¡è¿<strong>åŒå‘è¾¹</strong>,æƒå€¼ä¸ºb[i] (è¡¨ç¤ºç»§ç»­ä¹˜å) ,å†å‘ç»è¿‡è¯¥è½¦ç«™çš„å…¶ä»–çº¿è·¯ä¸­çš„è¯¥è½¦ç«™æ‰€ä»£è¡¨çš„ç‚¹è¿<strong>å•å‘è¾¹</strong>,æƒå€¼ä¸ºa[i] (è¡¨ç¤ºæ¢ä¹˜).<br>ç”±äºså’Œtä»£è¡¨çš„ç‚¹æœ‰å¤šä¸ª,æ‰€ä»¥åŠ ä¸Šè¶…æºå’Œè¶…æ±‡.è¶…æºå‘æ¯ä¸ªåœ°é“çº¿è·¯ä¸­çš„sè¿<strong>å•å‘è¾¹</strong>,æƒå€¼ä¸ºa[i], æ¯ä¸ªåœ°é“çº¿è·¯ä¸­çš„tå‘è¶…æ±‡è¿<strong>å•å‘è¾¹</strong>,æƒå€¼ä¸º0.<br>æ³¨æ„s=tçš„æ—¶å€™,éœ€è¦ç‰¹åˆ¤,å› ä¸ºä»¥ä¸Šå»ºå›¾æ–¹æ³•,å¦‚æœæ²¡æœ‰åœ°é“çº¿è·¯é€šè¿‡s,åˆ™è¶…æºå’Œsä¸è¿é€š,å¦‚æœä»è¶…æºè·‘dij,ä¼šè¾“å‡º-1.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e3</span> + <span class="number">5</span>, M = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, s, t, a[N], b[N], c[N], idx[<span class="number">505</span>][N], tot;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p[N], q[N];</span><br><span class="line">vector&lt;pii&gt; G[M];</span><br><span class="line">ll dis[M];</span><br><span class="line"><span class="type">bool</span> vis[M];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(dis,<span class="number">0x3f</span>,(tot+<span class="number">1</span>)*<span class="built_in">sizeof</span>(ll));</span><br><span class="line">  <span class="built_in">memset</span>(vis,<span class="number">0</span>,(tot+<span class="number">1</span>)*<span class="built_in">sizeof</span>(<span class="type">bool</span>));</span><br><span class="line">  dis[s] = <span class="number">0</span>;</span><br><span class="line">  priority_queue &lt;pli,vector&lt;pli&gt;,greater&lt;pli&gt;&gt; q;</span><br><span class="line">  q.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>,s));</span><br><span class="line">  <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">top</span>().se; q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>;</span><br><span class="line">    vis[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> v = it.fi, w = it.se;</span><br><span class="line">      <span class="keyword">if</span>(dis[v]&gt;dis[u]+w)</span><br><span class="line">      &#123;</span><br><span class="line">        dis[v] = dis[u] + w;</span><br><span class="line">        q.<span class="built_in">push</span>(<span class="built_in">mp</span>(dis[v],v));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;s, &amp;t);</span><br><span class="line">  <span class="keyword">if</span>(s==t)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  tot = m;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, a+i, b+i, c+i);</span><br><span class="line">    q[i].<span class="built_in">resize</span>(c[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> &amp;x : q[i])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">      p[x].<span class="built_in">pb</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> pre = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x : q[i])</span><br><span class="line">    &#123;</span><br><span class="line">      ++tot;</span><br><span class="line">      idx[i][x] = tot;</span><br><span class="line">      G[pre].<span class="built_in">emplace_back</span>(tot, b[i]);</span><br><span class="line">      G[tot].<span class="built_in">emplace_back</span>(pre, b[i]);</span><br><span class="line">      pre = tot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ++tot;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x : q[i])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(x==t) G[idx[i][x]].<span class="built_in">emplace_back</span>(tot, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">if</span>(x==s) G[<span class="number">0</span>].<span class="built_in">emplace_back</span>(idx[i][x], a[i]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> k : p[x])</span><br><span class="line">        G[idx[i][x]].<span class="built_in">emplace_back</span>(idx[k][x], a[k]);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="built_in">Dijkstra</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span>(dis[tot]==LINF) dis[tot] = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, dis[tot]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>E ç®€å•çæé¢˜</h1><p>æœ‰100ä¸ªæ•°,æ¯ä¸ªæ•°$x_i$â€‹æœ‰$l_i\sim r_i$â€‹çš„èŒƒå›´(&lt;=100),é—®$\sum x_i^2$â€‹çš„ç§ç±»æ•°<br>ä¸€çœ¼bitsetçš„ä¼˜åŒ–,ä½†ä»”ç»†ç®—äº†ä¸‹1e6*100*100/32,ä¼¼ä¹ä¸å¤ªè¡Œ,æƒ³äº†ä¸€ä¼šåˆ«çš„æ–¹æ³•æ²¡æƒ³å‡º,çœ‹äº†çœ¼åˆ«äººçš„ä»£ç ,ç„¶åå‘ç°å°±æ˜¯bitsetğŸ˜,<br><s>åªèƒ½è¯´æ˜ç‰›å®¢æœºå­ç‰›é€¼</s></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">bitset &lt;N&gt; f;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//100 * 100 * 1e6 / 32</span></span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">  f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">    bitset &lt;N&gt; nextf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=l; j&lt;=r; j++) nextf |= f&lt;&lt;(j*j);</span><br><span class="line">    f = nextf;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, f.<span class="built_in">count</span>());</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hdu5876 è¾¹æƒä¸º1çš„æ— å‘å›¾çš„è¡¥å›¾æœ€çŸ­è·¯</title>
      <link href="/2020/05/03/hdu5876-bian-quan-wei-1-de-wu-xiang-tu-de-bu-tu-zui-duan-lu/"/>
      <url>/2020/05/03/hdu5876-bian-quan-wei-1-de-wu-xiang-tu-de-bu-tu-zui-duan-lu/</url>
      
        <content type="html"><![CDATA[<h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å› ä¸ºè¾¹æƒæ˜¯1,æ‰€ä»¥è€ƒè™‘bfs.<br>ç”¨set s1å­˜å‚¨å½“å‰è¿˜æœªè®¿é—®è¿‡çš„ç‚¹,å¯¹äºé˜Ÿé¦–u,æšä¸¾å…¶å‡ºç‚¹v,è‹¥våœ¨s1ä¸­,åˆ™å°†å…¶ä»s1 erase,å¹¶insertå…¥s2,åˆ™æ­¤æ—¶åœ¨s1ä¸­çš„æ‰€æœ‰ç‚¹éƒ½å’Œuåœ¨è¡¥å›¾ä¸­ç›´æ¥ç›¸è¿,æ‰€ä»¥å°†å®ƒä»¬å…¥é˜Ÿå³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, s, dis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) G[i].<span class="built_in">clear</span>(); &#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) dis[i] = <span class="number">-1</span>;</span><br><span class="line">  dis[s] = <span class="number">0</span>;</span><br><span class="line">  set &lt;<span class="type">int</span>&gt; s1, s2;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="keyword">if</span>(i!=s) s1.<span class="built_in">insert</span>(i);</span><br><span class="line">  queue &lt;<span class="type">int</span>&gt; q; q.<span class="built_in">push</span>(s);</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">sz</span>(q))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">auto</span> it = s1.<span class="built_in">find</span>(v);</span><br><span class="line">      <span class="keyword">if</span>(it!=s1.<span class="built_in">end</span>())</span><br><span class="line">      &#123;</span><br><span class="line">        s2.<span class="built_in">insert</span>(v);</span><br><span class="line">        s1.<span class="built_in">erase</span>(it);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : s1) dis[it] = dis[u] + <span class="number">1</span>, q.<span class="built_in">push</span>(it);</span><br><span class="line">    <span class="built_in">swap</span>(s1, s2); s2.<span class="built_in">clear</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="built_in">init</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(v); G[v].<span class="built_in">pb</span>(u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;s);</span><br><span class="line">  <span class="built_in">bfs</span>(s);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">if</span>(i!=s)</span><br><span class="line">    &#123;</span><br><span class="line">      j++;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, dis[i], <span class="string">&quot; \n&quot;</span>[j==n<span class="number">-1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> T; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">  <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codeforces1348 E dp</title>
      <link href="/2020/05/02/codeforces1348-e-dp/"/>
      <url>/2020/05/02/codeforces1348-e-dp/</url>
      
        <content type="html"><![CDATA[<p>æœ‰nç»„ç‰©å“,æ¯ç»„ç‰©å“æœ‰ä¸¤ç§,ä¸€ç§aä¸ª,ä¸€ç§bä¸ª.å®šä¹‰åˆæˆæ–¹å¼ä¸º<strong>åŒç§</strong>kä¸ª,æˆ–è€…<strong>åŒç»„</strong>kä¸ª.é—®æœ€å¤šåˆæˆå¤šå°‘æ¬¡</p><h1>åšæ³•</h1><p>å¯¹äºæ¯ä¸€ç»„,æœ€å¤šåªæœ‰s(s&lt;k)ä¸ªç¬¬ä¸€ç§ä¸k-sä¸ªç¬¬äºŒç§è¿›è¡ŒåŒç»„ç»„åˆ,å…¶ä½™éƒ½ç”¨åœ¨åŒç§çš„åˆæˆæ–¹å¼ä¸Š.<br>è€ƒè™‘ dp[i][j]: å‰iç»„ç‰©å“ç¬¬ä¸€ç§æœ‰jä¸ªå¤šä½™çš„æƒ…å†µä¸‹,æœ€å¤šåˆæˆçš„æ¬¡æ•°.<br>å¯¹äºè¯¥çŠ¶æ€,ç›¸åº”çš„ç¬¬äºŒç§å°±æœ‰$\sum_i(a_i+b_i) - k*dp_{ij} - j = B$<br>è€ƒè™‘è½¬ç§»: æšä¸¾dp[i-1][j], å†æšä¸¾å½“å‰ç»„çš„åŒç»„ç»„åˆçŠ¶æ€sä¸ªç¬¬ä¸€ç§,k-sä¸ªç¬¬äºŒç§, åˆ™:<br>max{$dp[i][(j+a_i-s)$%$k]$, $dp[iâˆ’1][j] + (j+a_i-s)/k + (B+b_i-(k-s))/k$}</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">505</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">12</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, k;</span><br><span class="line">ll dp[N][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">cmax</span><span class="params">(ll &amp;x, ll y)</span> </span>&#123; <span class="keyword">if</span>(x&lt;y) x = y; &#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  ll pre = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;=n; i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;k; j++)</span><br><span class="line">      dp[i][j] = <span class="number">-1</span>;</span><br><span class="line">  dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;k; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(dp[i<span class="number">-1</span>][j]==<span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="built_in">cmax</span>(dp[i][(j+a)%k], dp[i<span class="number">-1</span>][j] + (j+a)/k + (pre-dp[i<span class="number">-1</span>][j]*k-j+b)/k);</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> s=<span class="number">0</span>; s&lt;=k; s++)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span>(s&gt;a || k-s&gt;b) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">cmax</span>(dp[i][(j+a-s)%k], dp[i<span class="number">-1</span>][j] + (j+a-s)/k + (pre-dp[i<span class="number">-1</span>][j]*k-j+b-(k-s))/k + <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    pre += a + b;</span><br><span class="line">  &#125;</span><br><span class="line">  ll ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;k; i++) <span class="built_in">cmax</span>(ans, dp[n][i]);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ans);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JOI2019 Final ç‹¬ç‰¹çš„åŸå¸‚ æ€ç»´+é•¿å‰–</title>
      <link href="/2020/04/30/joi2019-final-du-te-de-cheng-shi-si-wei-chang-pou/"/>
      <url>/2020/04/30/joi2019-final-du-te-de-cheng-shi-si-wei-chang-pou/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€æ£µæ ‘,å®šä¹‰åŸå¸‚yä¸ºxçš„ç‹¬ç‰¹åŸå¸‚,å½“ä¸”ä»…å½“å¯¹äºä»»æ„çš„z,$dis(x, y) \neq dis(x, z)$,æ¯ä¸ªç‚¹æœ‰ä¸ªå€¼,é—®å¯¹äºæ¯ä¸ªåŸå¸‚çš„æ‰€æœ‰ç‹¬ç‰¹åŸå¸‚çš„å€¼çš„ç§ç±»æ•°.</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>xçš„æ‰€æœ‰ç‹¬ç‰¹çš„åŸå¸‚ä¸€å®šä½äºè·ç¦»xæœ€è¿œçš„ç‚¹åˆ°xçš„é“¾ä¸Š(ç›´å¾„çš„æŸä¸ªç«¯ç‚¹).æ‰€ä»¥è€ƒè™‘ä»¥ç›´å¾„çš„ä¸¤ä¸ªç«¯ç‚¹å„æ±‚è§£ä¸€æ¬¡(å–max)<br>åœ¨dfsçš„è¿‡ç¨‹ä¸­ç”¨æ ˆå­˜å‚¨å¯¹äºå½“å‰ç‚¹uåˆæ³•çš„ç­”æ¡ˆ.åœ¨uç‚¹æ—¶,æ ˆä¸­æ‰€æœ‰ä¸uè·ç¦»&lt;=uçš„<strong>æ¬¡é•¿é“¾</strong>çš„ç­”æ¡ˆéƒ½ä¸åˆæ³•,ç›´æ¥å¼¹å‡º,å†å°†uå…¥æ ˆ,åˆ©ç”¨é•¿é“¾å‰–åˆ†,å…ˆè§£å†³é‡å„¿å­.é•¿é“¾è§£å†³å,æ ˆä¸­æ‰€æœ‰ä¸uè·ç¦»&lt;=è¯¥é•¿é“¾çš„ç‚¹å¼¹å‡º.ç„¶åä¾æ¬¡è§£å†³uçš„å„ä¸ªè½»å„¿å­å³å¯(æ³¨æ„å¦‚æœuä¸åœ¨æ ˆä¸­,è¦åŠ å…¥u).uå­æ ‘è§£å†³å,å¦‚æœuåœ¨æ ˆä¸­,å¼¹å‡º.<br>æ¯æ¬¡å…¥æ ˆå’Œå‡ºæ ˆç”¨ä¸€ä¸ªæ¡¶æ¥ç»Ÿè®¡ç­”æ¡ˆå³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n, m, c[N], cnt[N], cur;</span><br><span class="line"><span class="type">int</span> s, t, mxlen, son[N], son2[N], len[N], dep[N];</span><br><span class="line"><span class="type">int</span> sta[N], top, ans[N];</span><br><span class="line"><span class="type">int</span> head[N], tot;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> to, next;</span><br><span class="line">&#125;e[N&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  e[++tot].next = head[u];</span><br><span class="line">  e[tot].to = v;</span><br><span class="line">  head[u] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> dis)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dis&gt;mxlen)</span><br><span class="line">  &#123;</span><br><span class="line">    mxlen = dis;</span><br><span class="line">    t = u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = e[i].to;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(v, u, dis+<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">find</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  s = t;</span><br><span class="line">  mxlen = t = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">dfs</span>(s, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs2</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  dep[u] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">  son[u] = son2[u] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = e[i].to;</span><br><span class="line">    <span class="keyword">if</span>(v==fa) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="built_in">dfs2</span>(v, u);</span><br><span class="line">    <span class="keyword">if</span>(len[v]&gt;len[son[u]]) son2[u] = son[u], son[u] = v;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(len[v]&gt;len[son2[u]]) son2[u] = v;</span><br><span class="line">  &#125;</span><br><span class="line">  len[u] = len[son[u]] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cnt[c[u]]++;</span><br><span class="line">  <span class="keyword">if</span>(cnt[c[u]]==<span class="number">1</span>) cur++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cnt[c[u]]--;</span><br><span class="line">  <span class="keyword">if</span>(!cnt[c[u]]) cur--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs3</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span>(top &amp;&amp; dep[u]-dep[sta[top]]&lt;=len[son2[u]]) <span class="built_in">del</span>(sta[top--]);</span><br><span class="line">  <span class="built_in">add</span>(sta[++top]=u);</span><br><span class="line">  <span class="keyword">if</span>(son[u]) <span class="built_in">dfs3</span>(son[u], u);</span><br><span class="line">  <span class="keyword">while</span>(top &amp;&amp; dep[u]-dep[sta[top]]&lt;=len[son[u]]) <span class="built_in">del</span>(sta[top--]);</span><br><span class="line">  ans[u] = <span class="built_in">max</span>(ans[u], cur);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=head[u]; i; i=e[i].next)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> v = e[i].to;</span><br><span class="line">    <span class="keyword">if</span>(v==fa || v==son[u]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">if</span>(sta[top]!=u) <span class="built_in">add</span>(sta[++top]=u);</span><br><span class="line">    <span class="built_in">dfs3</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(sta[top]==u) <span class="built_in">del</span>(sta[top--]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    <span class="built_in">addedge</span>(u, v); <span class="built_in">addedge</span>(v, u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, c+i);</span><br><span class="line">  <span class="built_in">find</span>();</span><br><span class="line">  <span class="built_in">dfs2</span>(s, <span class="number">0</span>); <span class="built_in">dfs3</span>(s, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">dfs2</span>(t, <span class="number">0</span>); <span class="built_in">dfs3</span>(t, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i]);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>codeforces1307F</title>
      <link href="/2020/04/29/codeforces1307f/"/>
      <url>/2020/04/29/codeforces1307f/</url>
      
        <content type="html"><![CDATA[<p>æ— å‘å›¾ä¸Šæœ‰rä¸ªå…³é”®ç‚¹,ä¸€ä¸ªäººæ¯æ¬¡åªèƒ½è¿ç»­èµ°kæ­¥,å¤šæ¬¡è¯¢é—®uå’Œvä¸¤ç‚¹èƒ½å¦åˆ°è¾¾.</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>å¦‚æœä¸¤ç‚¹é—´è·ç¦»$\leq k$,å°±ç”¨å¹¶æŸ¥é›†åˆå¹¶,æ‰€ä»¥è€ƒè™‘å¯¹rä¸ªå…³é”®ç‚¹è¿›è¡Œå¤šæºbfs,ä½†æ˜¯æ³¨æ„åˆ°è¿™æ ·ä¼šä½¿å¾—ä»»æ„ä¸¤ä¸ªè·ç¦»$\leq 2\times k$çš„ç‚¹éƒ½å¯è¾¾,è€ƒè™‘<strong>æ‹†ç‚¹</strong>,å°†æ¯æ¡è¾¹æ‹†æˆu-&gt;n+i-&gt;v,ç„¶åå¤šæºbfs kæ­¥å³å¯.<br>å¯¹äºæ¯ä¸ªè¯¢é—®,å¦‚æœuå’Œvè·ç¦»$\leq 2\times k$,æ˜¾ç„¶å¯ä»¥,å¦åˆ™ä¸¤ä¸ªç‚¹å„è‡ªå‘å¯¹æ–¹èµ°kæ­¥(u-&gt;lca-&gt;v),æ­¤æ—¶ä¸¤ä¸ªç‚¹è‚¯å®šä¸ä¼šç›¸é‡(å› ä¸ºè·ç¦»$&gt;2\times k$),æœ€åçœ‹ä¸¤ä¸ªç‚¹æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­å³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">4e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> LOG = <span class="number">19</span>;</span><br><span class="line"><span class="type">int</span> n, k, r, sp[N], step[N], f[N];</span><br><span class="line">vector &lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"><span class="type">int</span> fa[N][<span class="number">22</span>], dep[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=LOG; i++)</span><br><span class="line">    fa[u][i] = fa[fa[u][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(v==fa[u][<span class="number">0</span>]) <span class="keyword">continue</span>;</span><br><span class="line">    dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">    fa[v][<span class="number">0</span>] = u;</span><br><span class="line">    <span class="built_in">dfs</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LCA</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dep[x]&gt;dep[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(dep[fa[y][i]]&gt;=dep[x]) y = fa[y][i];</span><br><span class="line">  <span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>(fa[x][i]!=fa[y][i]) x = fa[x][i], y = fa[y][i];</span><br><span class="line">  <span class="keyword">return</span> fa[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">up</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=LOG; i&gt;=<span class="number">0</span>; i--)</span><br><span class="line">    <span class="keyword">if</span>((d&gt;&gt;i)&amp;<span class="number">1</span>) x = fa[x][i];</span><br><span class="line">  <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(x==f[x]) <span class="keyword">return</span> x;</span><br><span class="line">  <span class="keyword">return</span> f[x] = <span class="built_in">find</span>(f[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  x = <span class="built_in">find</span>(x), y = <span class="built_in">find</span>(y);</span><br><span class="line">  <span class="keyword">if</span>(x!=y) f[x] = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  queue &lt;<span class="type">int</span>&gt; q;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=<span class="number">2</span>*n; i++) f[i] = i, step[i] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=r; i++) q.<span class="built_in">push</span>(sp[i]), step[sp[i]] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span>(<span class="built_in">sz</span>(q))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(step[u]&gt;=k) <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">merge</span>(u, v);</span><br><span class="line">      <span class="keyword">if</span>(step[v]==<span class="number">-1</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        step[v] = step[u] + <span class="number">1</span>;</span><br><span class="line">        q.<span class="built_in">push</span>(v);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">walk</span><span class="params">(<span class="type">int</span> &amp;u, <span class="type">int</span> v, <span class="type">int</span> w, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(dep[u]-dep[w]&gt;=k) u = <span class="built_in">up</span>(u, k);</span><br><span class="line">  <span class="keyword">else</span> u = <span class="built_in">up</span>(v, dep[v]-k+dep[u]<span class="number">-2</span>*dep[w]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">ok</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> w = <span class="built_in">LCA</span>(u, v);</span><br><span class="line">  <span class="keyword">if</span>(dep[u]+dep[v]<span class="number">-2</span>*dep[w]&lt;=<span class="number">2</span>*k) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">walk</span>(u, v, w, k); <span class="built_in">walk</span>(v, u, w, k);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">find</span>(u)==<span class="built_in">find</span>(v)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;k, &amp;r);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    G[u].<span class="built_in">pb</span>(n+i); G[v].<span class="built_in">pb</span>(n+i);</span><br><span class="line">    G[n+i].<span class="built_in">pb</span>(u); G[n+i].<span class="built_in">pb</span>(v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=r; i++) <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;sp[i]);</span><br><span class="line">  dep[<span class="number">1</span>] = <span class="number">1</span>; <span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">bfs</span>();</span><br><span class="line">  <span class="type">int</span> q; <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;q);</span><br><span class="line">  <span class="keyword">while</span>(q--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">ok</span>(u, v)) <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>uoj207 LCTç»´æŠ¤å­æ ‘ä¿¡æ¯+éšæœºåŒ–</title>
      <link href="/2020/04/29/uoj207-lct-wei-hu-zi-shu-xin-xi-sui-ji-hua/"/>
      <url>/2020/04/29/uoj207-lct-wei-hu-zi-shu-xin-xi-sui-ji-hua/</url>
      
        <content type="html"><![CDATA[<p>ç»™å®šä¸€æ£µæ ‘,è¦æ±‚æ”¯æŒåŠ è¾¹åˆ è¾¹,å¹¶ç»´æŠ¤ä¸€ä¸ªç‚¹å¯¹é›†åˆ,æ”¯æŒåŠ å…¥å’Œåˆ é™¤ç‚¹å¯¹,å¹¶è¯¢é—®ä¸€æ¡è¾¹æ˜¯å¦åœ¨æ‰€æœ‰é›†åˆä¸­çš„ç‚¹å¯¹é—´çš„è·¯å¾„ä¸Š.</p><h2 id="åšæ³•"><a class="header-anchor" href="#åšæ³•">Â¶</a>åšæ³•</h2><p>è€ƒè™‘è¯¢é—®è·¯å¾„xå’Œy:å½“xä¸ºæ ¹ä¸”é›†åˆä¸­æ¯ä¸ªç‚¹å¯¹çš„å…¶ä¸­ä¸€ä¸ªéƒ½åœ¨yå­æ ‘å†…æ—¶åˆæ³•.ç»™å­æ ‘å†…æ¯ä¸ªç‚¹å¯¹éšæœºä¸€ä¸ªæƒå€¼,ç„¶åç»´æŠ¤å­æ ‘çš„å¼‚æˆ–å’Œä¿¡æ¯,å½“yå­æ ‘å†…çš„å¼‚æˆ–å’Œç­‰äºæ•´ä¸ªé›†åˆçš„å¼‚æˆ–å’Œæ—¶åˆæ³•.ç”±äºåŠ¨æ€åŠ è¾¹å’Œåˆ è¾¹æ‰€ä»¥ç”¨lctç»´æŠ¤,å¯¹äºå­æ ‘ä¿¡æ¯,åªè¦é¢å¤–ç»´æŠ¤ä¸€ä¸‹æ¯ä¸ªç‚¹è™šå„¿å­çš„å¼‚æˆ–å’Œä¿¡æ¯å³å¯.</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> all(x) begin(x), end(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> debug(x) cerr &lt;&lt; #x &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pli = pair&lt;ll,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>, N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> ll LINF = <span class="number">1e18</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> id, n, m, tot, w[N];</span><br><span class="line">pii p[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LCT</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> ch[N][<span class="number">2</span>], fa[N], rev[N];</span><br><span class="line">  <span class="type">int</span> sum[N], sum2[N], val[N];</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    ch[x][<span class="number">0</span>] = ch[x][<span class="number">1</span>] = fa[x] = rev[x] = <span class="number">0</span>;</span><br><span class="line">    sum[x] = sum2[x] = val[x] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getch</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">noroot</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123; <span class="keyword">return</span> ch[fa[x]][<span class="number">0</span>]==x || ch[fa[x]][<span class="number">1</span>]==x; &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushup</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x) sum[x] = sum[ch[x][<span class="number">0</span>]] ^ sum[ch[x][<span class="number">1</span>]] ^ sum2[x] ^ val[x];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">swap</span>(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">    rev[x] ^= <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushdown</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(rev[x])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(ch[x][<span class="number">0</span>]) <span class="built_in">reverse</span>(ch[x][<span class="number">0</span>]);</span><br><span class="line">      <span class="keyword">if</span>(ch[x][<span class="number">1</span>]) <span class="built_in">reverse</span>(ch[x][<span class="number">1</span>]);</span><br><span class="line">      rev[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">pushall</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">noroot</span>(x)) <span class="built_in">pushall</span>(fa[x]);</span><br><span class="line">    <span class="built_in">pushdown</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">int</span> y = fa[x], z = fa[y], chx = <span class="built_in">getch</span>(x), chy = <span class="built_in">getch</span>(y);</span><br><span class="line">    fa[x] = z;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">noroot</span>(y)) ch[z][chy] = x;</span><br><span class="line">    ch[y][chx] = ch[x][chx^<span class="number">1</span>];</span><br><span class="line">    fa[ch[x][chx^<span class="number">1</span>]] = y;</span><br><span class="line">    ch[x][chx^<span class="number">1</span>] = y;</span><br><span class="line">    fa[y] = x;</span><br><span class="line">    <span class="built_in">pushup</span>(y);</span><br><span class="line">    <span class="built_in">pushup</span>(x);</span><br><span class="line">    <span class="built_in">pushup</span>(z);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">pushall</span>(x);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> f=fa[x]; f=fa[x], <span class="built_in">noroot</span>(x); <span class="built_in">rotate</span>(x))</span><br><span class="line">      <span class="keyword">if</span>(<span class="built_in">noroot</span>(f)) <span class="built_in">rotate</span>(<span class="built_in">getch</span>(x) == <span class="built_in">getch</span>(f) ? f : x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> y=<span class="number">0</span>; x; x=fa[y=x])</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">splay</span>(x);</span><br><span class="line">      sum2[x] ^= sum[ch[x][<span class="number">1</span>]] ^ sum[y];</span><br><span class="line">      ch[x][<span class="number">1</span>] = y;</span><br><span class="line">      <span class="built_in">pushup</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">makeroot</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x); <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="built_in">reverse</span>(x);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">findroot</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x); <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="keyword">while</span>(ch[x][<span class="number">0</span>]) <span class="built_in">pushdown</span>(x), x = ch[x][<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">split</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">makeroot</span>(x);</span><br><span class="line">    <span class="built_in">access</span>(y); <span class="built_in">splay</span>(y);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">link</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">makeroot</span>(x);</span><br><span class="line">    <span class="built_in">makeroot</span>(y);</span><br><span class="line">    fa[x] = y;</span><br><span class="line">    sum2[y] ^= sum[x];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">cut</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="built_in">split</span>(x,y);</span><br><span class="line">    fa[x] = ch[y][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(y);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;T;</span><br><span class="line"><span class="type">int</span> all;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">srand</span>(<span class="number">114514</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;id, &amp;n, &amp;m);</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> u, v; <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;u, &amp;v);</span><br><span class="line">    T.<span class="built_in">link</span>(u, v);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span>(m--)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> op, x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;op, &amp;x);</span><br><span class="line">    <span class="keyword">if</span>(op==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> y, u, v;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;y, &amp;u, &amp;v);</span><br><span class="line">      T.<span class="built_in">cut</span>(x, y); T.<span class="built_in">link</span>(u, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> y;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;y);</span><br><span class="line">      p[++tot] = &#123;x, y&#125;;</span><br><span class="line">      w[tot] = <span class="built_in">rand</span>();</span><br><span class="line">      T.<span class="built_in">makeroot</span>(x); T.val[x] ^= w[tot];</span><br><span class="line">      T.<span class="built_in">makeroot</span>(y); T.val[y] ^= w[tot];</span><br><span class="line">      all ^= w[tot];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(op==<span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      T.<span class="built_in">makeroot</span>(p[x].fi); T.val[p[x].fi] ^= w[x];</span><br><span class="line">      T.<span class="built_in">makeroot</span>(p[x].se); T.val[p[x].se] ^= w[x];</span><br><span class="line">      all ^= w[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">int</span> y;</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;y);</span><br><span class="line">      T.<span class="built_in">split</span>(x, y);</span><br><span class="line">      <span class="keyword">if</span>(T.sum[x]==all) <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
